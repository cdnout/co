/*!
 * Relay-Linker ver 1.1.0 - rlk.js
 * (c) any-js - https://github.com/any-js/najaxjs/
 * Released under the MIT license
 */
var $rlk={};!function(a){"use strict";function b(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b}function c(a,b,d){if(!b)return a;for(var e in b)b.hasOwnProperty(e)&&(d&&b[e]instanceof Object&&b[e].constructor===Object?(null==a[e]&&(a[e]={}),a[e]=c(a[e],b[e],d)):a[e]=b[e]);return a}function d(a,b,d){"object"==typeof b?c(a,b,!0):a[b]=d}function e(a){for(var b in a)a.hasOwnProperty(b)?delete a[b]:a[b]=null}function f(a,b){var c,d=[];if("function"!=typeof b)switch(b){case"first":d=a[0].get();break;case"value":for(c=0;c<a.length;c++)d.push(a[c].get(0));break;case"data":for(c=0;c<a.length;c++)d.push(a[c].data());break;case"relay":default:return a}else for(c=0;c<a.length;c++)d.push(b(a[c]));return d}function g(a){var b,c;for(a._rls[a._rls.length-1]===!0&&(a._rls.pop(),a.init()),c=0;c<a._rls.length;c++)if(b=a._rls[c],0!=b._active)return void console.error("cancel linker, used object.",b);for(c=0;c<a._rls.length;c++)b=a._rls[c],b._active=1,b._linker=a}function h(a){var b=a.linker();if(1==a._active){a._active=2;var c,d=!0;for(c=0;c<b._rls.length;c++)switch(b._rls[c]._state){case 0:return;case-1:case-2:d=!1}var e=f(b._rls,b._argument);if(d?(b._sccs&&b._sccs.apply(b,e),b._relay&&b._relay._linker&&b._relay.notifySuccess.apply(b._relay,b._rls)):(b._fail&&b._fail.apply(b,e),b._relay&&b._relay._linker&&b._relay.notifyFail.apply(b._relay,b._rls)),b._cmpl&&b._cmpl.apply(b,e),b._rls)for(c=0;c<b._rls.length;c++)b._rls[c]._linker=null,b._rls[c]._abort=null}}var i=function(){this._state=0,this._active=0,this._args=[],this._data=null,this._linker=null,this._abort=null};i.prototype.init=function(){return this._state=0,this._active=0,this._args=[],this._data=null,this},i.prototype.setState=function(a,b){return null!=a&&-2!=this._state&&(this._state=a),b&&b.length>0&&(this._args=b),this},i.prototype.notifySuccess=function(){return this.setState(1,b(arguments)),h(this),this},i.prototype.notifyFail=function(){return this.setState(-1,b(arguments)),h(this),this},i.prototype.abortCaller=function(a){this._abort=a},i.prototype.get=function(a){return void 0===a?this._args:this._args[a]},i.prototype.value=function(){return this._args[0]},i.prototype.data=function(a,b){return void 0===a?this._data:"object"!=typeof a&&void 0===b?this._data[a]:(null===this._data&&(this._data={}),void d(this._data,a,b))},i.prototype.state=function(){return this._state},i.prototype.isActive=function(){return this._active},i.prototype.abort=function(){return this._state=-2,this._abort&&this._abort(this),this.notifyFail(),this},i.prototype.clear=function(){for(var a,b=0;b<this._args.length;b++)a=this._args[b],a instanceof i&&a.clear&&a.clear();e(this)},i.prototype.linker=function(){return this._linker};var j=function(a){this._rls=b(a),this._argument="relay",this._sccs=null,this._fail=null,this._cmpl=null,this._lock=!1,this._relay=null,g(this)};j.prototype.init=function(){if(this._lock)return void console.error("not available");for(var a=0;a<this._rls.length;a++)this._rls[a].init();return this},j.prototype.argument=function(a){return this._lock?void console.error("not available"):(this._argument=a,this)},j.prototype.success=function(a){return this._sccs=a,this},j.prototype.fail=function(a){return this._fail=a,this},j.prototype.complete=function(a){return this._cmpl=a,this},j.prototype.done=function(a,b,c){return a&&(this._sccs=a),b&&(this._fail=b),c&&(this._cmpl=c),this._relay=new i,this._relay},j.prototype.clear=function(){for(var a=0;a<this._rls.length;a++)this._rls[a].clear&&this._rls[a].clear();e(this)},j.prototype.abort=function(){for(var a=0;a<this._rls.length;a++)this._rls[a].abort();return this},j.prototype.lock=function(){return this._lock=!0,this},a.linker=function(){return new j(arguments)},a.RelayClass=function(){return i},a.LinkerClass=function(){return j}}($rlk);
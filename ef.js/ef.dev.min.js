!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ef={})}(this,function(e){"use strict";function o(){throw new SyntaxError("Octal escape sequences are not allowed in EFML.")}function i(e){if(e=e.substr(3,e.length-4),!(e=parseInt(e,16)))throw new SyntaxError("Invalid Unicode escape sequence");try{return String.fromCodePoint(e)}catch(e){throw new SyntaxError("Undefined Unicode code-point")}}function c(e){if(e=e.substring(2),!(e=parseInt(e,16)))throw new SyntaxError("Invalid Unicode escape sequence");return String.fromCharCode(e)}function s(e){if(e="00"+e.substring(2),!(e=parseInt(e,16)))throw new SyntaxError("Invalid hexadecimal escape sequence");return String.fromCharCode(e)}function h(e){for(var t=[],n=0,r=e.split(w);n<r.length;n+=1){var a=r[n].replace(E,o).replace($,i).replace(k,c).replace(O,s).replace(D,"\b").replace(_,"\t").replace(F,"\n").replace(C,"\v").replace(j,"\f").replace(R,"\r").replace(T,"");t.push(a)}return t.join(N)}function u(e,t){for(var n=[],r=!1,a=0,o=e.split(t);a<o.length;a+=1){var i=o[a];r?n[n.length-1]+=""+t+i:n.push(i),r=(i=i)[i.length-1]===N}return n}function d(e,t){for(var e=e.split(w),n=u(e.shift(),t),r=0,a=e;r<a.length;r+=1){var o=a[r],o=u(o,t);n[n.length-1]+=w+o.shift(),n.push.apply(n,o)}return n}function m(e,t){return void 0===t&&(t=-2),"Failed to parse eft template: "+e+". at line "+(t+1)}function p(e){return-1<["number","boolean","string"].indexOf(typeof e)}function r(t){if(!t)return[t,!1];try{var e=JSON.parse(t);return-1===["number","boolean"].indexOf(typeof e)?[h(t),!0]:[e,!1]}catch(e){return[h(t),!0]}}function a(e){e=e.slice(2,e.length-2);var t=(n=d(e,"="))[0],e=n.slice(1),n=d(t.trim(),".").map(h),e=(t=r(e.join("=").trim()))[0],t=t[1];return p(e)&&(t||!t&&""!==e)?[n,e]:[n]}function v(e){var t=e.split(A);if(1===t.length)return r(e)[0];var n=[];return 2!==t.length||t[0]||t[1]?n.push(t.map(h)):n.push(0),(e=e.match(A))&&n.push.apply(n,e.map(a)),n}function l(e,t){t&&e.push(t)}function g(e){if(e=v(e),p(e))return[""+e];for(var t=e[0],n=e.slice(1),r=[],a=0;a<n.length;a++)l(r,t[a]),r.push(n[a]);return l(r,t[t.length-1]),r}function y(e){return e.replace(/\./g," ")}function f(e,t,n){var r=parseInt(n,10);if(isNaN(r))return function(e,t){switch(t){case"stop":e.s=1;break;case"stopImmediate":e.i=1;break;case"prevent":e.p=1;break;case"shift":e.h=1;break;case"alt":e.a=1;break;case"ctrl":e.c=1;break;case"meta":e.t=1;break;case"capture":e.u=1;break;default:console.warn("Dropped unsupported eft event option '"+t+"'.")}}(e,h(n)),0;t.push(r)}function b(e){var t={},n=[],e=(r=d(e,"."))[0],r=r.slice(1);t.l=h(e);for(var a=0,o=r;a<o.length;a+=1){var i=o[a];f(t,n,i)}return 0<n.length&&(t.k=n),t}function x(e){var t,n=e.line,r=e.ast,a=e.parsingInfo,o=e.i;if(n.replace(/\s/,"")){i=n,null===(e=a).offset&&(e.offset=i.match(/\s*/)[0],e.offset&&(e.offsetReg=e.offset));var i=function(e,t,n){if(t.offsetReg){var r=!1;if(e=e.replace(t.offsetReg,function(){return r=!0,""}),!r)throw new SyntaxError(m("Expected indent to be grater than 0 and less than "+(t.prevDepth+1)+", but got -1",n))}return e}(n,a,o);e=i,(n=a).indentReg||(e=e.match(I)[2])&&(n.indentReg=new RegExp(e,"g"));var c,n=function(e,t,n){var r=0;t.indentReg&&(e=e.replace(/^\s*/,function(e){return e.replace(t.indentReg,"\t")}));e=e.replace(/^\t*/,function(e){return r=e.length,""});if(/^\s/.test(e))throw new SyntaxError(m("Bad indent",n));return{depth:r,content:e}}(i,a,o),e=n.depth;if(i=n.content){if(e<0||1<e-a.prevDepth||e-a.prevDepth==1&&-1===["comment","tag"].indexOf(a.prevType)||"comment"!==a.prevType&&0===e&&a.topExists)throw new SyntaxError(m("Expected indent to be grater than 0 and less than "+(a.prevDepth+1)+", but got "+e,o));n=i[0];if(!(i=i.slice(1))&&0<=">#%@.-+".indexOf(n))throw new SyntaxError(m("Empty content",o));switch((e<a.prevDepth||e===a.prevDepth&&"tag"===a.prevType)&&(a.currentNode=function(e,t){for(var n=e,r=0;r<t;r++)n=n[n.length-1];return n}(r,e)),a.prevDepth=e,n){case">":var n=(c={},n=(s=d((n=i).replace(S,function(e){return c.ref=e.slice(1),""}),"."))[0],s=s.slice(1),c.tag=h(n),c.class=v(s.join(".")),"string"==typeof c.class?c.class=y(c.class).trim():c.class[0]&&(c.class[0]=c.class[0].map(y)),c),s=[{t:n.tag}];n.class&&(s[0].a={},s[0].a.class=n.class),n.ref&&(s[0].r=n.ref),a.currentNode.push(s),a.currentNode=s,a.prevType="tag";break;case"#":var u=function(e){e=d(e,"=");return{name:h(e.shift().trim()),value:v(e.join("=").trim())}}(i),s=u.name,u=u.value;a.currentNode[0].a||(a.currentNode[0].a={}),a.currentNode[0].a[s]=u,a.prevType="attr";break;case"%":var p=(p=d(u=i,"="),f=p.shift().trim(),l=d(f,"@"),u=l[0],f=l[1],l=d(u,"!"),u=l[0],l=l[1],f=f&&b(f),{propPath:d(u,".").map(h),value:v(p.join("=").trim()),updateOnly:l,syncTrigger:f}),l=p.updateOnly,f=p.syncTrigger,p=[p.propPath,p.value];f?(p.push(f),""===l&&p.push(!0)):""===l&&(p.push(null),p.push(!0)),a.currentNode[0].p||(a.currentNode[0].p=[]),a.currentNode[0].p.push(p),a.prevType="prop";break;case"@":var f=function(e){e=d(e,"=");return{name:e.shift().trim(),value:e.join("=").trim()}}(i),l=f.name,p=f.value;a.currentNode[0].e||(a.currentNode[0].e=[]);f=b(l),p=(l=(p=d(l=p,":"))[0],p=p.slice(1).join(":"),l=h(l.trim()),p?[l,v(p)]:[l]),l=p[0],p=p[1];f.m=l,p&&(f.v=p),a.currentNode[0].e.push(f),a.prevType="event";break;case".":(t=a.currentNode).push.apply(t,g(i)),a.prevType="text";break;case"|":1<a.currentNode.length&&(i="\n"+i),(t=a.currentNode).push.apply(t,g(i)),a.prevType="multiline-text";break;case"-":if(-1!==P.indexOf(i))throw new SyntaxError(m("Reserved name '"+i+"' should not be used",o));a.currentNode.push({n:i,t:0}),a.prevType="node";break;case"+":a.currentNode.push({n:i,t:1}),a.prevType="list";break;default:a.prevType="comment"}}}}function n(e){if(!e)throw new TypeError(m("Template required, but nothing given"));var t=typeof e;if("string"!=t)throw new TypeError(m("Expected a string, but got a(n) "+t));for(var n=e.split(/\r?\n/),r=[{t:0}],a={indentReg:null,prevDepth:0,offset:null,offsetReg:null,prevType:"comment",currentNode:r,topExists:!1},o=0;o<n.length;o++)x({line:n[o],ast:r,parsingInfo:a,i:o});if(r.length<=1)throw new SyntaxError(m("Nothing to be parsed",n.length-1));return 2===r.length&&Array.isArray(r[1])&&Object.hasOwnProperty.call(r[1][0],"t")?r[1]:r}var N="&",w=N+N,E=new RegExp("\\&[0-7]{1,3}","g"),$=new RegExp("\\&u\\[.*?\\]","g"),k=new RegExp("\\&u.{0,4}","g"),O=new RegExp("\\&x.{0,2}","g"),T=new RegExp("\\&","g"),D=new RegExp("\\&b","g"),_=new RegExp("\\&t","g"),F=new RegExp("\\&n","g"),C=new RegExp("\\&v","g"),j=new RegExp("\\&f","g"),R=new RegExp("\\&r","g"),P=["$ctx","$refs","$data","$methods","$mount","$umount","$subscribe","$unsubscribe","$update","$dispatch","$emit","$on","$off","$destroy","__DIRECTMOUNT__"],A=/\{\{.+?\}\}/g,I=/^(\t*)( *).*/,S=/#([^}]|}[^}])*$/,M=Array,U=M.prototype,q={copy:function(e){return U.slice.call(e,0)},empty:function(e){return e.length=0,e},equals:function(e,t){if(!M.isArray(t))return!1;if(e===t)return!0;if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0},pop:function(e){return U.pop.call(e)},push:function(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];return U.push.apply(e,t)},remove:function(e,t){var n=U.indexOf.call(e,t);if(-1<n)return U.splice.call(e,n,1),t},reverse:function(e){return U.reverse.call(e)},rightUnique:function(e){for(var t=[],n=0;n<e.length;n++){for(var r=n+1;r<e.length;r++)e[n]===e[r]&&(r=n+=1);t.push(e[n])}return t},shift:function(e){return U.shift.call(e)},slice:function(e,t,n){return U.slice.call(e,t,n)},sort:function(e,t){return U.sort.call(e,t)},splice:function(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];return U.splice.apply(e,t)},unshift:function(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];return U.unshift.apply(e,t)},isArray:function(e){return M.isArray(e)}};"undefined"!=typeof Set&&M.from?q.unique=function(e){return M.from(new Set(e))}:q.unique=q.rightUnique;function L(e){return q.isArray(e)?"array":typeof e}function B(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];for(var r="",a=0;a<t.length;a++)void 0===t[a]?r+=e[a]:r+=e[a]+t[a];return r+e[e.length-1]}function K(e){return void 0===(e=e.dataNode[e._key])?"":e}function Z(e){return te.push.apply(te,e)}function G(e){return ne.push(e)}function V(){return ae+=1}function t(){if(0!==re.length){var e=q.unique(re);q.empty(re);for(var t=0,n=e;t<n.length;t+=1)(0,n[t])()}}function z(e){return!e&&0<--ae||((ae=0)<te.length&&function(){if(0!==te.length){var e=q.unique(te);q.empty(te);for(var t=0,n=e;t<n.length;t+=1)(0,n[t])()}}(),0<ne.length&&function(){if(0!==ne.length){var e=q.rightUnique(ne);q.empty(ne);for(var t=0,n=e;t<n.length;t+=1)(0,n[t])()}}(),0<re.length&&setTimeout(t,0)),ae}function J(e,t){for(var n in t)e[n]=t[n];return e}function W(e,t){for(var n=0,r=e;n<r.length;n+=1){var a=r[n];t=t[a]||function(e,t){var n={};return Object.defineProperty(t,e,{get:function(){return n},set:function(e){V(),oe(n,e),z()},configurable:!1,enumerable:!0}),n}(a,t)}return t}function H(e){return e!=e}function X(e){var r,a,o,i,c,s,t=e.bind,n=e.ctx,u=e.handlers,p=e.subscribers,l=e.innerData,f=(d=q.copy(t[0])).pop(),l=(u=(h={_path:d,_key:f,data:n.data,handlers:u,subscribers:p,innerData:l},e=h._path,d=h._key,u=h.data,p=h.handlers,l=h.subscribers,h=h.innerData,u=W(e,u),p=function(e){for(var t=e._path,n=e.handlers,r=e.subscribers,a=e.innerData,o=0,i=t;o<i.length;o+=1){var c=i[o];n[c]||(n[c]={}),r[c]||(r[c]={}),a[c]||(a[c]={}),n=n[c],r=r[c],a=a[c]}return{handlerNode:n,subscriberNode:r,dataNode:a}}({_path:e,handlers:p,subscribers:l,innerData:h}),l=p.handlerNode,h=p.subscriberNode,p=p.dataNode,l[d]||(l[d]=[]),h[d]||(h[d]=[]),Object.prototype.hasOwnProperty.call(p,d)||(p[d]=void 0),{parentNode:u,handlerNode:l[d],subscriberNode:h[d],dataNode:p})).parentNode,h=u.handlerNode,d=u.subscriberNode,p=u.dataNode;return Object.prototype.hasOwnProperty.call(l,f)||(n=(u={parentNode:l,dataNode:p,handlerNode:h,subscriberNode:d,ctx:n,_key:f}).parentNode,r=u.dataNode,a=u.handlerNode,o=u.subscriberNode,i=u.ctx,c=u._key,s=!1,Object.defineProperty(n,c,{get:function(){return r[c]},set:function(e){if(!s)if(s=!0,r[c]===e||H(r[c])&&H(e))s=!1;else{if(r[c]=e,V(),Z(a),z(),0<o.length){V();try{for(var t=0,n=o;t<n.length;t+=1)(0,n[t])({state:i.state,value:e})}catch(e){ce.error("Error caught when executing subscribers:\n",e)}z()}s=!1}},enumerable:!0})),1<t.length&&(l[f]=t[1]),{dataNode:p,parentNode:l,handlerNode:h,subscriberNode:d,_key:f}}function Q(e,t){return e.constructor===t}function Y(e,t){for(var n=0,r=t;n<r.length;n+=1){var a=r[n];Object.defineProperty(e.prototype,a,{enumerable:!1})}return e}function ee(e,t){return e=q.copy(e),q.unshift(e,t),e}var te=[],ne=[],re=[],ae=0,oe=Object.assign||J,ie="[EF] %s",ce={log:console.log.bind(console,ie),info:console.info.bind(console,ie),warn:console.warn.bind(console,ie),error:console.error.bind(console,ie)},se="undefined"!=typeof document&&"undefined"!=typeof Node;se?ce.info("Running in browser mode."):ce.info("Running in non-browser mode, please be sure to set a DOM simulation using `setDOMImpl`. See https://github.com/TheNeuronProject/ef.js#server-side-rendering for detail.");function ue(e,t){var e=(n=e.$ctx.nodeInfo).element,n=n.placeholder;he.append(t,e,n)}function pe(e,t){if(3===e.nodeType){e=fe.get(e);if(e){e=e.node;if(e)if(q.isArray(e))for(var n=0,r=e;n<r.length;n+=1){var a=r[n];ue(a,t)}else ue(e,t)}}}var le={},fe=new WeakMap,he={},de=function(){function e(){this.$children=[],this.$safeZone=he.document.createDocumentFragment()}return e.prototype.append=function(){for(var e,t=[],n=arguments.length;n--;)t[n]=arguments[n];return he.append.apply(null,ee(t,this.$safeZone)),(e=this.$children).push.apply(e,t)},e.prototype.appendTo=function(e){he.append.apply(null,ee(this.$children,e))},e.prototype.removeChild=function(e){he.remove(e),q.remove(this.$children,e)},e.prototype.remove=function(){for(var e=0,t=this.$children;e<t.length;e+=1){var n=t[e];he.append(this.$safeZone,n)}},e}();he.before=function(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];var r=he.document.createDocumentFragment();V();for(var a=0,o=t;a<o.length;a+=1){var i=o[a];i instanceof le.EFBaseComponent?i.$mount({target:r}):Q(i,de)?i.appendTo(r):(he.Node.prototype.appendChild.call(r,i),pe(i,r))}he.Node.prototype.insertBefore.call(e.parentNode,r,e),z()},he.after=function(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];var r=he.document.createDocumentFragment();V();for(var a=0,o=t;a<o.length;a+=1){var i=o[a];i instanceof le.EFBaseComponent?i.$mount({target:r}):Q(i,de)?i.appendTo(r):he.Node.prototype.appendChild.call(r,i)}e.nextSibling?he.Node.prototype.insertBefore.call(e.parentNode,r,e.nextSibling):he.Node.prototype.appendChild.call(e.parentNode,r),z()},he.append=function(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];if(Q(e,de))return e.append.apply(e,t);if(e instanceof le.EFBaseComponent)if(q.isArray(e.children)){V();for(var r=0,a=t;r<a.length;r+=1){var o=a[r],o=new le.toEFComponent(o);e.children.push(o)}z()}else ce.warn(e,"has no `children` list mount point! Child nodes are all ignored!");else if(-1!==[1,9,11].indexOf(e.nodeType)){for(var i=he.document.createDocumentFragment(),c=0,s=t;c<s.length;c+=1){var u=s[c];Q(u,de)?u.appendTo(i):u instanceof he.Node?(he.Node.prototype.appendChild.call(i,u),pe(u,i)):u instanceof le.EFBaseComponent&&u.$mount({target:i})}he.Node.prototype.appendChild.call(e,i)}},he.remove=function(e){Q(e,de)?e.remove():e instanceof le.EFBaseComponent?e.$umount():he.Node.prototype.removeChild.call(e.parentNode,e)};ie=function(e){return oe(he,e)};se&&ie({Node:Node,document:document});function me(e,t){void 0===t&&(t={bubbles:!1,cancelable:!1});var n=t.bubbles,r=t.cancelable;return(t=he.document.createEvent("CustomEvent")).initEvent(e,n,r),t}function ve(e){if(De[e])return De[e];throw new Error('[EF] Namespace "'+e+'" has not been declared.')}function ge(e){return-1<["number","boolean","string"].indexOf(typeof e)}function ye(e){var t=e.tagName,n=e.tagContent,r=e.attrs,a=e.ref,o=e.refs,e=function(e){var t=e.tagName,n=e.tagContent,r=e.attrs,a=e.namespace;switch(typeof n){case"string":e={};return t===n&&r&&r.is&&"string"==typeof r.is&&(e.is=r.is),a?he.document.createElementNS(a,n,e):he.document.createElement(n,e);case"function":return new n;default:return n.tag&&(t=n.tag),a?he.document.createElementNS(a,t,{is:n.is}):he.document.createElement(t,{is:n.is})}}({tagName:t,tagContent:n,attrs:r,namespace:e.namespace});return a&&Object.defineProperty(o,a,{value:e,enumerable:!0}),e}function be(e){var t=e.val,r=e.ctx,a=e.handlers,o=e.subscribers,i=e.innerData,n=e.handler;if(q.isArray(t)){var c=t[0],e=t.slice(1),s=[c],u=function(){return n(function(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];if(!e)return K(t[0]);e=[e];return e.push.apply(e,t.map(K)),B.apply(void 0,e)}.apply(void 0,s))};return s.push.apply(s,e.map(function(e){var t=X({bind:e,ctx:r,handlers:a,subscribers:o,innerData:i}),n=t.dataNode,e=t.handlerNode,t=t._key;return e.push(u),{dataNode:n,_key:t}})),u}return function(){return t}}function xe(e){var t=e.element,n=e.attr,r=e.key,a=e.ctx,o=e.handlers,i=e.subscribers,c=e.innerData,s=e.custom;if(ge(n)){if(s)return t[r]=""===n||n,0;if("is"===r)return;if(-1<r.indexOf(":")){e=r.split(":")[0];if("xmlns"!==e)return t.setAttributeNS(a.localNamespaces[e]||ve(e),r,n)}return t.setAttribute(r,n)}s=function(e){var t=e.element,n=e.key,r=e.custom,e=e.ctx;if(r)return function(e){t[n]=e};if("class"===n)return function(e){if(!(e=(""+e).replace(/\s+/g," ").trim()))return t.removeAttribute(n);t.setAttribute(n,e)};if(-1<n.indexOf(":")){var r=n.split(":")[0],a=e.localNamespaces[r]||ve(r);return function(e){if(""===e)return t.removeAttributeNS(a,n);t.setAttributeNS(a,n,e)}}return function(e){if(""===e)return t.removeAttribute(n);t.setAttribute(n,e)}}({element:t,key:r,custom:s,ctx:a}),Z([be({val:n,ctx:a,handlers:o,subscribers:i,innerData:c,handler:s})])}function Ne(e){var t=e.element,n=e.propPath,r=e.value,a=e.syncTrigger,o=e.updateOnly,i=e.ctx,c=e.handlers,s=e.subscribers,u=e.innerData,p=e.custom,l=(e=q.copy(n)).pop();p&&e.unshift("$data");var f,h,d,m,v,g,y,b,x,N,w,E,$,k,O,T,D=function(e,t){for(var n=0,r=e;n<r.length;n+=1){var a=r[n];t[a]||(t[a]={}),t=t[a]}return t}(e,t);function _(){w.locked=!0,V(),O[T]=$[k],z()}ge(r)?D[l]=r:(f={locked:!1},o=be({val:r,ctx:i,handlers:c,subscribers:s,innerData:u,handler:o?function(){f.locked=!1}:function(e){f.locked||D[l]===e||(D[l]=e),f.locked=!1}}),!a&&(1!==n.length||"value"!==l&&"checked"!==l||r[0])||(i={ctx:i,syncTrigger:a,updateLock:f,handlers:c,subscribers:s,innerData:u,element:t,lastNode:D,key:l,expr:r[1],custom:p},a=i.ctx,c=i.syncTrigger,w=i.updateLock,s=i.handlers,u=i.subscribers,t=i.innerData,E=i.element,$=i.lastNode,k=i.key,r=i.expr,p=i.custom,i=p?"$on":"addEventListener",u=X({bind:r,ctx:a,handlers:s,subscribers:u,innerData:t}),O=u.parentNode,T=u._key,c?(t=c.l,h=c.s,d=c.i,m=c.p,v=c.h,g=c.a,y=c.c,b=c.t,u=c.u,x=c.k,E[i](t,function(e){!!v!=!!e.shiftKey||!!g!=!!e.altKey||!!y!=!!e.ctrlKey||!!b!=!!e.metaKey||x&&-1===x.indexOf(e.which)||(h&&e.stopPropagation(),d&&e.stopImmediatePropagation(),m&&e.preventDefault(),_())},!!u)):"value"===k?(E[i]("input",_,!0),E[i]("keyup",_,!0),E[i]("change",_,!0)):(N=p?"$dispatch":"dispatchEvent",E[i]("change",function(){if(E[N](me("--ef-change-event--"),{bubbles:!0,canceoable:!1}),"INPUT"===E.tagName&&"radio"===E.type&&""!==E.name){var e=he.document.querySelectorAll("input[name="+E.name+"][type=radio]");if(e){e=q.copy(e);q.remove(e,E);for(var t=0,n=e;t<n.length;t+=1)n[t].dispatchEvent(me("--ef-change-event--"))}}},!0),E[i]("--ef-change-event--",_))),Z([o]))}function we(e){return e}function Ee(e){var t=e.info,n=e.ctx,r=e.innerData,a=e.refs,o=e.handlers,i=e.subscribers,c=e.namespace,s=e.fragment,u=e.custom;if(s)return new de;var p=t.t,l=t.a,f=t.p,e=t.e,s=t.r,t=n.scope[p]||p,h=ye({tagName:p,tagContent:t,attrs:l,ref:s,refs:a,namespace:c});if(l)for(var d in l)xe({element:h,custom:u,attr:l[d],key:d,ctx:n,handlers:o,subscribers:i,innerData:r});if(f)for(var m=0,v=f;m<v.length;m+=1){var g=v[m],y=g[0],b=g[1],x=g[2],g=g[3];Ne({element:h,custom:u,value:b,propPath:y,syncTrigger:x,updateOnly:g,ctx:n,handlers:o,subscribers:i,innerData:r})}if(e)for(var N=0,w=e;N<w.length;N+=1)!function(e){var t=e.element,n=e.event,r=e.ctx,a=e.handlers,o=e.subscribers,i=e.innerData,c=e.custom?"$on":"addEventListener",s=n.l,u=n.m,p=n.s,l=n.i,f=n.p,h=n.h,d=n.a,m=n.c,v=n.t,e=n.u,g=n.k,n=n.v,y=be({val:n,ctx:r,handlers:a,subscribers:o,innerData:i,handler:we});t[c](s,function(e){!!h!=!!e.shiftKey||!!d!=!!e.altKey||!!m!=!!e.ctrlKey||!!v!=!!e.metaKey||g&&-1===g.indexOf(e.which)||(p&&e.stopPropagation(),l&&e.stopImmediatePropagation(),f&&e.preventDefault(),r.methods[u]?r.methods[u]({e:e,value:y(),state:r.state}):ce.warn("Method named '"+u+"' not found! Value been passed is:",y()))},!!e)}({element:h,custom:u,event:w[N],ctx:n,handlers:o,subscribers:i,innerData:r});return h}function $e(e){if(!e.$ctx)throw new Error("[EF] This component has been destroyed!")}function ke(e){var t,n=e.ctx,r=e.key,a=e.anchor,o=n.children,i=n.isFragment;o[r]={node:(t=[],e={ctx:n,key:r,anchor:a},Object.defineProperties(t,{empty:{value:_e.empty},clear:{value:_e.clear},pop:{value:_e.pop},push:{value:_e.push.bind(t,e)},remove:{value:_e.remove},reverse:{value:_e.reverse.bind(t,e)},shift:{value:_e.shift},sort:{value:_e.sort.bind(t,e)},splice:{value:_e.splice},unshift:{value:_e.unshift.bind(t,e)}}),t),anchor:a},fe.set(a,o[r]),i&&he.append(n.safeZone,a)}function Oe(e){var t,n,r,a,o,i,c,s,u=e.node,p=e.nodeType,l=e.element,f=e.ctx,h=e.innerData,d=e.refs,m=e.handlers,v=e.subscribers,g=e.namespace,e=e.create;if(u instanceof he.Node)he.append(l,u);else switch(p){case"string":he.append(l,he.document.createTextNode(u));break;case"array":"object"===L(u[0])?he.append(l,e({node:u,ctx:f,innerData:h,refs:d,handlers:m,subscribers:v,namespace:g})):(y=(t={node:u,ctx:f,handlers:m,subscribers:v,innerData:h,element:l}).node,n=t.ctx,r=t.handlers,a=t.subscribers,o=t.innerData,t=t.element,i=he.document.createTextNode(""),a=X({bind:y,ctx:n,handlers:r,subscribers:a,innerData:o}),c=a.dataNode,o=a.handlerNode,s=a._key,a=function(){var e=c[s];i.textContent=void 0!==e?e:""},o.push(a),Z([a]),he.append(t,i));break;case"object":var y=he.document.createTextNode("");0===u.t?(n={ctx:f,key:u.n,anchor:y},r=n.ctx,o=n.key,a=n.anchor,t=r.children,n=r.isFragment,t[o]={anchor:a},fe.set(a,t[o]),n&&he.append(r.safeZone,a)):ke({ctx:f,key:u.n,anchor:y}),he.append(l,he.document.createComment("EF MOUNTING POINT '"+u.n+"' START")),he.append(l,y),he.append(l,he.document.createComment("EF MOUNTING POINT '"+u.n+"' END"))}}function Te(e){return e.$data}var De={xml:"http://www.w3.org/XML/1998/namespace",html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML",xlink:"http://www.w3.org/1999/xlink"},_e={empty:function(){V();for(var e=0,t=q.copy(this);e<t.length;e+=1)t[e].$destroy();z(),q.empty(this)},clear:function(){V();for(var e=0,t=q.copy(this);e<t.length;e+=1)t[e].$umount();z(),q.empty(this)},pop:function(){if(0!==this.length){var e=q.pop(this);return e.$umount(),e}},push:function(e){for(var t=e.ctx,n=e.key,e=e.anchor,r=[],a=arguments.length-1;0<a--;)r[a]=arguments[a+1];r=r.map(le.toEFComponent);var o=[];V();for(var i=0,c=r;i<c.length;i+=1){var s=c[i];q.push(o,s.$mount({parent:t.state,key:n}))}return 0===this.length?he.after.apply(he,[e].concat(o)):he.after.apply(he,[this[this.length-1].$ctx.nodeInfo.placeholder].concat(o)),z(),q.push.apply(q,[this].concat(r))},remove:function(e){if(-1!==this.indexOf(e))return e.$umount(),e},reverse:function(e){var t=e.ctx,n=e.key,e=e.anchor;if(0===this.length)return this;var r=q.copy(this),a=[];V();for(var o=r.length-1;0<=o;o--)r[o].$umount(),q.push(a,r[o].$mount({parent:t.state,key:n}));return q.push.apply(q,[this].concat(q.reverse(r))),he.after.apply(he,[e].concat(a)),z(),this},shift:function(){if(0!==this.length){var e=q.shift(this);return e.$umount(),e}},sort:function(e,t){var n=e.ctx,r=e.key,e=e.anchor;if(0===this.length)return this;var t=q.copy(q.sort(this,t)),a=[];V();for(var o=0,i=t;o<i.length;o+=1){var c=i[o];c.$umount(),q.push(a,c.$mount({parent:n.state,key:r}))}return q.push.apply(q,[this].concat(t)),he.after.apply(he,[e].concat(a)),z(),this},splice:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(0===this.length)return this;var n=q.splice.apply(q,[q.copy(this)].concat(e));V();for(var r=0,a=n;r<a.length;r+=1)a[r].$umount();return z(),n},unshift:function(e){for(var t=e.ctx,n=e.key,r=e.anchor,a=[],o=arguments.length-1;0<o--;)a[o]=arguments[o+1];if(0===this.length)return(e=this).push.apply(e,a).length;a=a.map(le.toEFComponent);var i=[];V();for(var c=0,s=a;c<s.length;c+=1){var u=s[c];q.push(i,u.$mount({parent:t.state,key:n}))}return he.after.apply(he,[r].concat(i)),z(),q.unshift.apply(q,[this].concat(a))}},Fe={BEFORE:"before",AFTER:"after",APPEND:"append",REPLACE:"replace"},Ce=ve("svg"),je=ve("math"),Re=ve("html"),Pe=Object.create(null),Ae=[function(e){var t=e.ctx,n=e.key,r=e.value,a=t.children[n],o=a.anchor,e=a.node;e!==r&&(r=le.toEFComponent(r),V(),e&&(r===Pe?r=null:e.$umount()),(a.node=r)&&r.$mount({target:o,parent:t.state,option:Fe.BEFORE,key:n}),z())},function(e){var t=e.ctx,n=e.key,r=e.value,a=t.children[n],e=a.anchor,a=a.node;if(!q.equals(a,r)){r=r?q.copy(r):[];var o=he.document.createDocumentFragment();if(V(),a){a.clear();for(var i=0,c=r;i<c.length;i+=1){var s=c[i];(s=le.toEFComponent(s)).$ctx.nodeInfo.parent&&s.$umount(),he.append(o,s.$mount({parent:t.state,key:n}))}}else for(var u=0,p=r;u<p.length;u+=1){var l=p[u];he.append(o,l.$mount({parent:t.state,key:n}))}a.length=0,q.push.apply(q,[a].concat(r)),he.after(e,o),z()}}],Ie=function(e){var t=e.node,n=e.ctx,r=e.innerData,a=e.refs,o=e.handlers,i=e.subscribers,c=e.namespace,s=t[0],u=t.slice(1),p=c,l=s.t,f=!1,h=0===l,e=Object.isPrototypeOf.call(le.EFBaseComponent,n.scope[l]||l);if(!h&&!e)if(n.scope[l]&&("string"==typeof(d=n.scope[l])?l=d:d.tag&&(l=d.tag,d.namespaceURI&&(c=d.namespaceURI))),-1<l.indexOf(":")){var t=l.split(":"),d=t[0],t=t[1];n.localNamespaces[d]?(c=n.localNamespaces[d],f=!0):c=ve(d),l=t}else if(s.a&&s.a.xmlns&&ge(s.a.xmlns))c=s.a.xmlns;else if(!c)switch(l=l.toLowerCase()){case"svg":c=Ce;break;case"math":c=je}c===Re&&(c="");var m=Ee({info:s,ctx:n,innerData:r,refs:a,handlers:o,subscribers:i,namespace:c,fragment:h,custom:e});h&&m.append(he.document.createComment("EF FRAGMENT START")),c&&c===Ce&&-1<["foreignobject","desc","title"].indexOf(l.toLowerCase())&&(c=""),f&&(c=p);for(var v=0,g=u;v<g.length;v+=1){var y=g[v];y instanceof le.EFBaseComponent?y.$mount({target:m}):Oe({node:y,nodeType:L(y),element:m,ctx:n,innerData:r,refs:a,handlers:o,subscribers:i,namespace:c,create:Ie})}return h&&m.append(he.document.createComment("EF FRAGMENT END")),m},se=function(e,t){for(var n in t){var r=t[n],a={base:function(r){return r?"function"==typeof r?r:("string"==typeof r&&(r=r.split(".")),function(e){for(var t=0,n=r;t<n.length;t+=1)e=e[n[t]];return e}):Te}(r.base),key:r.key||n},o=function(e,t){var n=e.base,r=e.key,a=t.checkTrue,e=t.get,t=t.set;if(e){if(!t)throw new Error("[EF] Setter must be defined when getter exists");return e}return a?function(){return a(n(this)[r],this)}:function(){return n(this)[r]}}(a,r),r=function(e,t){var a=e.base,o=e.key,n=t.checkTrue,i=t.trueVal,c=t.falseVal,e=t.get,t=t.set;if(t){if(!e)throw new Error("[EF] Getter must be defined when setter exists");return t}return n?function(e){var t=a(this),n=i,r=c;"function"!=typeof i&&(i=function(){return n}),"function"!=typeof c&&(c=function(){return r}),t[o]=(e?i:c)(this)}:function(e){a(this)[o]=e}}(a,r);Object.defineProperty(e.prototype,n,{get:o,set:r,enumerable:!0,configurable:!1})}return e},Se=function(){function e(e,t){void 0===t&&(t={});var n={},r={},a={},o={},i={placeholder:null,replace:[],parent:null,key:null},c=he.document.createDocumentFragment();i.placeholder=he.document.createComment("EF COMPONENT PLACEHOLDER");function s(){if(0<i.replace.length){for(var e=0,t=i.replace;e<t.length;e+=1){var n=t[e];he.remove(n)}q.empty(i.replace)}he.before(i.placeholder,i.element)}t={scope:t,mount:s,refs:n,data:{},innerData:r,methods:{},handlers:a,subscribers:o,nodeInfo:i,safeZone:c,children:{},state:this,isFragment:0===e[0].t,localNamespaces:this.constructor.__local_namespaces};Object.defineProperty(this,"$ctx",{value:t,enumerable:!1,configurable:!0}),V(),i.element=Ie({node:e,ctx:t,innerData:r,refs:n,handlers:a,subscribers:o,namespace:""}),he.append(c,i.placeholder),G(s),z()}var t={$data:{configurable:!0},$methods:{configurable:!0},$refs:{configurable:!0}};return t.$data.get=function(){return $e(this),this.$ctx.data},t.$data.set=function(e){$e(this),V(),oe(this.$ctx.data,e),z()},t.$methods.get=function(){return $e(this),this.$ctx.methods},t.$methods.set=function(e){$e(this),this.$ctx.methods=e},t.$refs.get=function(){return $e(this),this.$ctx.refs},e.prototype.$mount=function(e){var t=e.target,n=e.option,r=e.parent,a=e.key;$e(this);var o=this.$ctx,e=o.nodeInfo,o=o.mount;if("string"==typeof t&&(t=document.querySelector(t)),V(),e.parent&&(this.$umount(),ce.warn("Component detached from previous mounting point.")),r=r||t,a=a||"__DIRECTMOUNT__",e.parent=r,e.key=a,G(o),!t)return z(),e.placeholder;switch(n){case Fe.BEFORE:he.before(t,e.placeholder);break;case Fe.AFTER:he.after(t,e.placeholder);break;case Fe.REPLACE:he.before(t,e.placeholder),e.replace.push(t);break;case Fe.APPEND:default:Q(r,de)?he.append(t,e.element):he.append(t,e.placeholder)}return z()},e.prototype.$umount=function(){$e(this);var e=this.$ctx,t=e.nodeInfo,n=e.safeZone,r=e.mount,a=t.parent,e=t.key;return t.parent=null,t.key=null,V(),a&&("__DIRECTMOUNT__"!==e?a[e]&&(q.isArray(a[e])?q.remove(a[e],this):a[e]=Pe):Q(a,de)&&a.$ctx.nodeInfo.element.removeChild(t.element)),he.append(n,t.placeholder),G(r),z()},e.prototype.$subscribe=function(e,t){$e(this);var n=this.$ctx,r=n.handlers,a=n.subscribers,o=n.innerData,e=e.split("."),o=X({bind:[e],ctx:n,handlers:r,subscribers:a,innerData:o}),i=o.dataNode,c=o.subscriberNode,s=o._key;V();try{t({state:this,value:i[s]}),c.push(t)}catch(e){ce.error("Error caught when registering subscriber:\n",e)}z()},e.prototype.$unsubscribe=function(e,t){$e(this),function(e,t,n){n=function(e,t){for(var n=e.split("."),e=n.pop(),r=0,a=n;r<a.length;r+=1){var o=a[r];t[o]||(t[o]={}),t=t[o]}return t[e]}(e,n);q.remove(n,t)}(e,t,this.$ctx.subscribers)},e.prototype.$update=function(e){$e(this),V(),J(this,e),z()},e.prototype.$dispatch=function(e){return $e(this),this.$ctx.nodeInfo.placeholder.dispatchEvent(e)},e.prototype.$emit=function(e,t){return $e(this),this.$dispatch(me(e,t))},e.prototype.$on=function(){for(var e,t=[],n=arguments.length;n--;)t[n]=arguments[n];return $e(this),(e=this.$ctx.nodeInfo.placeholder).addEventListener.apply(e,t)},e.prototype.$off=function(){for(var e,t=[],n=arguments.length;n--;)t[n]=arguments[n];return $e(this),(e=this.$ctx.nodeInfo.placeholder).removeEventListener.apply(e,t)},e.prototype.$destroy=function(){$e(this);var e,t,n=this.$ctx,r=n.nodeInfo,a=n.children;for(e in V(),this.$umount(),a)fe.delete(a[e].anchor);for(t in this)"array"===L(this[t])?this[t].clear():this[t]=null;return delete this.$ctx,G(function(){he.remove(r.element),he.remove(r.placeholder)}),z()},Object.defineProperties(e.prototype,t),e}(),Me=[{t:0}],Ue=function(a){function e(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];a.call(this,Me);var n=this.$ctx.nodeInfo.element,r=n.$children;n.append.apply(n,e),n.append(q.remove(r,r[1])),this.$ctx.elements=e}a&&(e.__proto__=a),(e.prototype=Object.create(a&&a.prototype)).constructor=e;var t={$el:{configurable:!0}};return t.$el.get=function(){return this.$ctx.elements},Object.defineProperties(e.prototype,t),e}(Se),qe=function(n){function e(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];n.call(this,[{t:0}].concat(e))}return n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e}(Se),Le=[{t:0},[["text"]]],Be=function(t){function e(e){V(),t.call(this,Le),this.text=e,z()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(Se);se(Be,{text:{}}),Y(Se,["$mount","$umount","$subscribe","$unsubscribe","$update","$dispatch","$emit","$on","$off","$destroy"]),Y(Ue,["$el"]);function Ke(e){return null==e||e instanceof Se?e:e!==Pe?e instanceof Node?new Ue(e):new Be("string"==typeof e?e:JSON.stringify(e)):void 0}le.EFBaseComponent=Se,le.toEFComponent=Ke;function Ze(e,t){return q.isArray(t)?e.push.apply(e,t.map(Ke)):e.push(Ke(t)),e}var Ge=function(e,t){var n,r,a=L(e);switch(a){case"array":var o=e[0],i=e.slice(1);if("object"===L(o)){o.a&&function(e,t){for(var n in e){var r;0===n.indexOf("xmlns:")&&(r=n.split(":")[1],t.__local_namespaces[r]=e[n])}}(o.a,t);for(var c=0,s=i;c<s.length;c+=1){var u=s[c];Ge(u,t)}}break;case"object":if(1<e.t)throw new TypeError("[EF] Not a standard ef.js AST: Unknown mounting point type '"+e.t+"'");n=e.t,r=e.n,e=t,Object.defineProperty(e.prototype,r,{get:function(){return $e(this),this.$ctx.children[r].node},set:function(e){$e(this);var t=this.$ctx;Ae[n]({ctx:t,key:r,value:e})},enumerable:!0});break;case"string":break;default:throw new TypeError("[EF] Not a standard ef.js AST: Unknown node type '"+a+"'")}};ce.info("ef-core v0.13.4+debug initialized!");function Ve(e){var r,t=L(e);if("string"===t)e=(ze||n)(e);else if("array"!==t)throw new TypeError("Cannot create new component without proper template or AST!");return r=e,e=function(n){function e(e,t){V(),n.call(this,r,t),e&&this.$update(e),z()}return n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e}(Se),Object.defineProperty(e.prototype,"constructor",{enumerable:!1}),Object.defineProperty(e,"__local_namespaces",{enumerable:!1,value:{}}),Ge(r,e),e}var ze=n;e.version="0.13.4",e.version="0.13.4+debug",console.info("[EF] ef.js v"+e.version+" initialized!"),e.EFNodeWrapper=Ue,e.EFTextFragment=Be,e.Fragment=qe,e.bundle=function(e){V();try{z(e(V,z))}catch(e){return z(),e}},e.create=Ve,e.createElement=function(e,t){for(var n=[],r=arguments.length-2;0<r--;)n[r]=arguments[r+2];if(e===qe)return new(Function.prototype.bind.apply(qe,[null].concat(n)));if(Object.isPrototypeOf.call(Se,e))return n.length<=0?new e(t):new e(oe({children:n.reduce(Ze,[])},t||{}));var a,o=oe({},t);for(a in o)!0===o[a]&&(o[a]="");return new Se([{t:e,a:o}].concat(n))},e.declareNamespace=function(e,t){if(De[e])throw new Error('[EF] Namespace "'+e+'" has already been declared as "'+De[e]+'".');De[e]=t},e.exec=z,e.inform=V,e.isPaused=function(){return 0<ae},e.mapAttrs=se,e.mountOptions=Fe,e.onNextRender=function(e){return re.push(e)},e.parseEft=n,e.scoped=function(e,a){return function(r){function e(e,t){void 0===t&&(t={});var n=oe({},a);r.call(this,e,oe(n,t))}return r&&(e.__proto__=r),(e.prototype=Object.create(r&&r.prototype)).constructor=e}(e)},e.setDOMImpl=ie,e.setParser=function(e){ze=e},e.t=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return Ve(B.apply(void 0,e))},Object.defineProperty(e,"__esModule",{value:!0})});
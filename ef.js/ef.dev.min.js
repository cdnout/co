!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ef={})}(this,function(e){"use strict";function o(){throw new SyntaxError("Octal escape sequences are not allowed in EFML.")}function i(e){if(e=e.substr(3,e.length-4),!(e=parseInt(e,16)))throw new SyntaxError("Invalid Unicode escape sequence");try{return String.fromCodePoint(e)}catch(e){throw new SyntaxError("Undefined Unicode code-point")}}function c(e){if(e=e.substring(2),!(e=parseInt(e,16)))throw new SyntaxError("Invalid Unicode escape sequence");return String.fromCharCode(e)}function s(e){if(e="00"+e.substring(2),!(e=parseInt(e,16)))throw new SyntaxError("Invalid hexadecimal escape sequence");return String.fromCharCode(e)}function Z(e){for(var t=[],n=0,r=e.split(g);n<r.length;n+=1){var a=r[n].replace(b,o).replace(x,i).replace(N,c).replace($,s).replace(k,"\b").replace(O,"\t").replace(T,"\n").replace(D,"\v").replace(_,"\f").replace(F,"\r").replace(w,"");t.push(a)}return t.join(y)}function u(e,t){for(var n,r=[],a=!1,o=0,i=e.split(t);o<i.length;o+=1){var c=i[o];a?r[r.length-1]+=""+t+c:r.push(c),a=(n=c)[n.length-1]===y}return r}function G(e,t){for(var n=e.split(g),r=u(n.shift(),t),a=0,o=n;a<o.length;a+=1){var i=o[a],c=u(i,t);r[r.length-1]+=g+c.shift(),r.push.apply(r,c)}return r}function K(e,t){return void 0===t&&(t=-2),"Failed to parse eft template: "+e+". at line "+(t+1)}function p(e){return-1<["number","boolean","string"].indexOf(typeof e)}function l(t){if(!t)return[t,!1];try{var e=JSON.parse(t);return-1===["number","boolean"].indexOf(typeof e)?[Z(t),!0]:[e,!1]}catch(e){return[Z(t),!0]}}function a(e){e=e.slice(2,e.length-2);var t=G(e,"="),n=t[0],r=t.slice(1),a=G(n.trim(),".").map(Z),o=l(r.join("=").trim()),i=o[0],c=o[1];return p(i)&&(c||!c&&""!==i)?[a,i]:[a]}function V(e){var t=e.split(C);if(1===t.length)return l(e)[0];var n=[];2!==t.length||t[0]||t[1]?n.push(t.map(Z)):n.push(0);var r=e.match(C);return r&&n.push.apply(n,r.map(a)),n}function f(e,t){t&&e.push(t)}function z(e){var t=V(e);if(p(t))return[""+t];for(var n=t[0],r=t.slice(1),a=[],o=0;o<r.length;o++)f(a,n[o]),a.push(r[o]);return f(a,n[n.length-1]),a}function J(e){return e.replace(/\./g," ")}function W(e,t,n){var r=parseInt(n,10);if(isNaN(r))return function(e,t){switch(t){case"stop":e.s=1;break;case"stopImmediate":e.i=1;break;case"prevent":e.p=1;break;case"shift":e.h=1;break;case"alt":e.a=1;break;case"ctrl":e.c=1;break;case"meta":e.t=1;break;case"capture":e.u=1;break;default:console.warn("Abandoned unsupported eft event option '"+t+"'.")}}(e,Z(n));t.push(r)}function h(e){var t,n,r,a,o=e.line,i=e.ast,c=e.parsingInfo,s=e.i;if(o.replace(/\s/,"")){r=o,null===(a=c).offset&&(a.offset=r.match(/\s*/)[0],a.offset&&(a.offsetReg=a.offset));var u,p,l,f=function(e,t,n){if(t.offsetReg){var r=!1;if(e=e.replace(t.offsetReg,function(){return r=!0,""}),!r)throw new SyntaxError(K("Expected indent to be grater than 0 and less than "+(t.prevDepth+1)+", but got -1",n))}return e}(o,c,s);u=f,(p=c).indentReg||(l=u.match(Q)[2])&&(p.indentReg=new RegExp(l,"g"));var h,d,v,m,y,g,b,x,N,$,E,w=function(e,t,n){var r=0;t.indentReg&&(e=e.replace(/^\s*/,function(e){return e.replace(t.indentReg,"\t")}));var a=e.replace(/^\t*/,function(e){return r=e.length,""});if(/^\s/.test(a))throw new SyntaxError(K("Bad indent",n));return{depth:r,content:a}}(f,c,s),k=w.depth;if(O=w.content){if(k<0||1<k-c.prevDepth||k-c.prevDepth==1&&-1===["comment","tag"].indexOf(c.prevType)||"comment"!==c.prevType&&0===k&&c.topExists)throw new SyntaxError(K("Expected indent to be grater than 0 and less than "+(c.prevDepth+1)+", but got "+k,s));var O,T=O[0];if(!(O=O.slice(1))&&0<=">#%@.-+".indexOf(T))throw new SyntaxError(K("Empty content",s));switch((k<c.prevDepth||k===c.prevDepth&&"tag"===c.prevType)&&(c.currentNode=function(e,t){for(var n=e,r=0;r<t;r++)n=n[n.length-1];return n}(i,k)),c.prevDepth=k,T){case">":var D=(x={},N=G(O.replace(X,function(e){return x.ref=e.slice(1),""}),"."),$=N[0],E=N.slice(1),x.tag=Z($),x.class=V(E.join(".")),"string"==typeof x.class?x.class=J(x.class).trim():x.class[0]&&(x.class[0]=x.class[0].map(J)),x),_=[{t:D.tag}];D.class&&(_[0].a={},_[0].a.class=D.class),D.ref&&(_[0].r=D.ref),c.currentNode.push(_),c.currentNode=_,c.prevType="tag";break;case"#":var F=(b=G(O,"="),{name:Z(b.shift().trim()),value:V(b.join("=").trim())}),C=F.name,A=F.value;c.currentNode[0].a||(c.currentNode[0].a={}),c.currentNode[0].a[C]=A,c.prevType="attr";break;case"%":var R=(g=G(O,"="),{propPath:G(g.shift().trim(),".").map(Z),value:V(g.join("=").trim())}),j=R.propPath,P=R.value;c.currentNode[0].p||(c.currentNode[0].p=[]),c.currentNode[0].p.push([j,P]),c.prevType="prop";break;case"@":var I={name:(y=G(O,"=")).shift().trim(),value:y.join("=").trim()},S=I.name,M=I.value;c.currentNode[0].e||(c.currentNode[0].e=[]);var U=function(e){var t={},n=[],r=G(e,"."),a=r[0],o=r.slice(1);t.l=Z(a);for(var i=0,c=o;i<c.length;i+=1){var s=c[i];W(t,n,s)}return 0<n.length&&(t.k=n),t}(S),q=(h=G(M,":"),d=h[0],v=h.slice(1).join(":"),m=Z(d.trim()),v?[m,V(v)]:[m]),B=q[0],L=q[1];U.m=B,L&&(U.v=L),c.currentNode[0].e.push(U),c.prevType="event";break;case".":(t=c.currentNode).push.apply(t,z(O)),c.prevType="text";break;case"|":1<c.currentNode.length&&(O="\n"+O),(n=c.currentNode).push.apply(n,z(O)),c.prevType="multiline-text";break;case"-":if(-1!==H.indexOf(O))throw new SyntaxError(K("Reserved name '"+O+"' should not be used",s));c.currentNode.push({n:O,t:0}),c.prevType="node";break;case"+":c.currentNode.push({n:O,t:1}),c.prevType="list";break;default:c.prevType="comment"}}}}function d(e){if(!e)throw new TypeError(K("Template required, but nothing given"));var t=typeof e;if("string"!=t)throw new TypeError(K("Expected a string, but got a(n) "+t));for(var n=e.split(/\r?\n/),r=[{t:0}],a={indentReg:null,prevDepth:0,offset:null,offsetReg:null,prevType:"comment",currentNode:r,topExists:!1},o=0;o<n.length;o++)h({line:n[o],ast:r,parsingInfo:a,i:o});if(r.length<=1)throw new SyntaxError(K("Nothing to be parsed",n.length-1));return 2===r.length&&Array.isArray(r[1])&&Object.hasOwnProperty.call(r[1][0],"t")?r[1]:r}function E(e){return Array.isArray(e)?"array":typeof e}function v(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];for(var r="",a=0;a<t.length;a++)void 0===t[a]?r+=e[a]:r+=e[a]+t[a];return r+e[e.length-1]}function m(e){var t=e.dataNode[e._key];return void 0===t?"":t}var y="&",g=y+y,b=new RegExp("\\&[0-7]{1,3}","g"),x=new RegExp("\\&u\\[.*?\\]","g"),N=new RegExp("\\&u.{0,4}","g"),$=new RegExp("\\&x.{0,2}","g"),w=new RegExp("\\&","g"),k=new RegExp("\\&b","g"),O=new RegExp("\\&t","g"),T=new RegExp("\\&n","g"),D=new RegExp("\\&v","g"),_=new RegExp("\\&f","g"),F=new RegExp("\\&r","g"),H=["$ctx","$refs","$data","$methods","$mount","$umount","$subscribe","$unsubscribe","$update","$dispatch","$emit","$on","$off","$destroy","__DIRECTMOUNT__"],C=/\{\{.+?\}\}/g,Q=/^(\t*)( *).*/,X=/#([^}]|}[^}])*$/,r=Array.prototype,A={copy:function(e){return r.slice.call(e,0)},empty:function(e){return e.length=0,e},equals:function(e,t){if(!Array.isArray(t))return!1;if(e===t)return!0;if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0},pop:function(e){return r.pop.call(e)},push:function(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];return r.push.apply(e,t)},remove:function(e,t){var n=r.indexOf.call(e,t);if(-1<n)return r.splice.call(e,n,1),t},reverse:function(e){return r.reverse.call(e)},rightUnique:function(e){for(var t=[],n=0;n<e.length;n++){for(var r=n+1;r<e.length;r++)e[n]===e[r]&&(r=n+=1);t.push(e[n])}return t},shift:function(e){return r.shift.call(e)},slice:function(e,t,n){return r.slice.call(e,t,n)},sort:function(e,t){return r.sort.call(e,t)},splice:function(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];return r.splice.apply(e,t)},unshift:function(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];return r.unshift.apply(e,t)}};"undefined"!=typeof Set&&Array.from?A.unique=function(e){return Array.from(new Set(e))}:A.unique=A.rightUnique;function R(e){return ee.push.apply(ee,e)}function j(e){return te.push(e)}function P(){return re+=1}function t(){if(0!==ne.length){var e=A.unique(ne);A.empty(ne);for(var t=0,n=e;t<n.length;t+=1){(0,n[t])()}}}function I(e){return!e&&0<--re||((re=0)<ee.length&&function(){if(0!==ee.length){var e=A.unique(ee);A.empty(ee);for(var t=0,n=e;t<n.length;t+=1){(0,n[t])()}}}(),0<te.length&&function(){if(0!==te.length){var e=A.rightUnique(te);A.empty(te);for(var t=0,n=e;t<n.length;t+=1){(0,n[t])()}}}(),0<ne.length&&setTimeout(t,0)),re}function n(e,t){for(var n in t)e[n]=t[n];return e}function S(e,t){var n={};return Object.defineProperty(t,e,{get:function(){return n},set:function(e){P(),ae(n,e),I()},configurable:!1,enumerable:!0}),n}function M(e){var t=e._path,n=e._key,r=e.data,a=e.handlers,o=e.subscribers,i=e.innerData,c=function(e,t){for(var n=0,r=e;n<r.length;n+=1){var a=r[n];t=t[a]?t[a]:S(a,t)}return t}(t,r),s=function(e){for(var t=e._path,n=e.handlers,r=e.subscribers,a=e.innerData,o=0,i=t;o<i.length;o+=1){var c=i[o];n[c]||(n[c]={}),r[c]||(r[c]={}),a[c]||(a[c]={}),n=n[c],r=r[c],a=a[c]}return{handlerNode:n,subscriberNode:r,dataNode:a}}({_path:t,handlers:a,subscribers:o,innerData:i}),u=s.handlerNode,p=s.subscriberNode,l=s.dataNode;return u[n]||(u[n]=[]),p[n]||(p[n]=[]),Object.prototype.hasOwnProperty.call(l,n)||(l[n]=void 0),{parentNode:c,handlerNode:u[n],subscriberNode:p[n],dataNode:l}}function U(e){return e!=e}function q(e){var t,n,r,a,o,i,c,s,u=e.bind,p=e.ctx,l=e.handlers,f=e.subscribers,h=e.innerData,d=A.copy(u[0]),v=d.pop(),m=M({_path:d,_key:v,data:p.data,handlers:l,subscribers:f,innerData:h}),y=m.parentNode,g=m.handlerNode,b=m.subscriberNode,x=m.dataNode;return Object.prototype.hasOwnProperty.call(y,v)||(n=(t={parentNode:y,dataNode:x,handlerNode:g,subscriberNode:b,ctx:p,_key:v}).parentNode,r=t.dataNode,a=t.handlerNode,o=t.subscriberNode,i=t.ctx,c=t._key,s=!1,Object.defineProperty(n,c,{get:function(){return r[c]},set:function(e){if(!s&&!(r[c]===e||U(r[c])&&U(e))&&(r[c]=e,P(),R(a),I(),0<o.length)){s=!0,P();try{for(var t=0,n=o;t<n.length;t+=1){(0,n[t])({state:i.state,value:e})}}catch(e){ie.error("Error caught when executing subscribers:\n",e)}I(),s=!1}},enumerable:!0})),1<u.length&&(y[v]=u[1]),{dataNode:x,parentNode:y,handlerNode:g,subscriberNode:b,_key:v}}function B(e,t){return e.constructor===t}function L(e,t){for(var n=0,r=t;n<r.length;n+=1){var a=r[n];Object.defineProperty(e.prototype,a,{enumerable:!1})}return e}function Y(e,t){var n=A.copy(e);return A.unshift(n,t),n}var ee=[],te=[],ne=[],re=0,ae=Object.assign||n,oe="[EF] %s",ie={log:console.log.bind(console,oe),info:console.info.bind(console,oe),warn:console.warn.bind(console,oe),error:console.error.bind(console,oe)},ce="undefined"!=typeof document&&"undefined"!=typeof Node;ce?ie.info("Running in browser mode."):ie.info("Running in non-browser mode, please be sure to set a DOM simulation using `setDOMImpl`.");function se(e,t){var n=e.$ctx.nodeInfo,r=n.element,a=n.placeholder;fe.append(t,r,a)}function ue(e,t){if(3===e.nodeType){var n=le.get(e);if(n){var r=n.node;if(r)if(Array.isArray(r))for(var a=0,o=r;a<o.length;a+=1){var i=o[a];se(i,t)}else se(r,t)}}}var pe={},le=new WeakMap,fe={},he=function(){function e(){this.$children=[],this.$safeZone=fe.document.createDocumentFragment()}return e.prototype.append=function(){for(var e,t=[],n=arguments.length;n--;)t[n]=arguments[n];return fe.append.apply(null,Y(t,this.$safeZone)),(e=this.$children).push.apply(e,t)},e.prototype.appendTo=function(e){fe.append.apply(null,Y(this.$children,e))},e.prototype.removeChild=function(e){fe.remove(e),A.remove(this.$children,e)},e.prototype.remove=function(){for(var e=0,t=this.$children;e<t.length;e+=1){var n=t[e];fe.append(this.$safeZone,n)}},e}();fe.before=function(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];var r=fe.document.createDocumentFragment();P();for(var a=0,o=t;a<o.length;a+=1){var i=o[a];i instanceof pe.EFBaseComponent?i.$mount({target:r}):B(i,he)?i.appendTo(r):(fe.Node.prototype.appendChild.call(r,i),ue(i,r))}fe.Node.prototype.insertBefore.call(e.parentNode,r,e),I()},fe.after=function(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];var r=fe.document.createDocumentFragment();P();for(var a=0,o=t;a<o.length;a+=1){var i=o[a];i instanceof pe.EFBaseComponent?i.$mount({target:r}):B(i,he)?i.appendTo(r):fe.Node.prototype.appendChild.call(r,i)}e.nextSibling?fe.Node.prototype.insertBefore.call(e.parentNode,r,e.nextSibling):fe.Node.prototype.appendChild.call(e.parentNode,r),I()},fe.append=function(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];if(B(e,he))return e.append.apply(e,t);if(e instanceof pe.EFBaseComponent){if(!Array.isArray(e.children))return void ie.warn(e,"has no `children` list mount point! Child nodes are all ignored!");P();for(var r=0,a=t;r<a.length;r+=1){var o=a[r],o=new pe.toEFComponent(o);e.children.push(o)}I()}else if(-1!==[1,9,11].indexOf(e.nodeType)){for(var i=fe.document.createDocumentFragment(),c=0,s=t;c<s.length;c+=1){var u=s[c];B(u,he)?u.appendTo(i):u instanceof fe.Node?(fe.Node.prototype.appendChild.call(i,u),ue(u,i)):u instanceof pe.EFBaseComponent&&u.$mount({target:i})}fe.Node.prototype.appendChild.call(e,i)}},fe.remove=function(e){B(e,he)?e.remove():e instanceof pe.EFBaseComponent?e.$umount():fe.Node.prototype.removeChild.call(e.parentNode,e)};function de(e){return ae(fe,e)}ce&&de({Node:Node,document:document});function ve(e,t){void 0===t&&(t={bubbles:!1,cancelable:!1});var n=t.bubbles,r=t.cancelable,a=fe.document.createEvent("CustomEvent");return a.initEvent(e,n,r),a}function me(e){if(Re[e])return Re[e];throw new Error('[EF] Namespace "'+e+'" has not been declared.')}function ye(e){return-1<["number","boolean","string"].indexOf(typeof e)}function ge(e){var t=e.tagName,n=e.tagContent,r=e.attrs,a=e.ref,o=e.refs,i=function(e){var t=e.tagName,n=e.tagContent,r=e.attrs,a=e.namespace;switch(typeof n){case"string":var o={};return t===n&&r&&r.is&&"string"==typeof r.is&&(o.is=r.is),a?fe.document.createElementNS(a,n,o):fe.document.createElement(n,o);case"function":return new n;default:return n.tag&&(t=n.tag),a?fe.document.createElementNS(a,t,{is:n.is}):fe.document.createElement(t,{is:n.is})}}({tagName:t,tagContent:n,attrs:r,namespace:e.namespace});return a&&Object.defineProperty(o,a,{value:i,enumerable:!0}),i}function be(e){var t=e.val,o=e.ctx,i=e.handlers,c=e.subscribers,s=e.innerData,n=e.handler;if(Array.isArray(t)){var r=t[0],a=t.slice(1),u=[r],p=function(){return n(function(e){for(var t=[],n=arguments.length-1;0<n--;)t[n]=arguments[n+1];if(!e)return m(t[0]);var r=[e];return r.push.apply(r,t.map(m)),v.apply(void 0,r)}.apply(void 0,u))};return u.push.apply(u,a.map(function(e){var t=q({bind:e,ctx:o,handlers:i,subscribers:c,innerData:s}),n=t.dataNode,r=t.handlerNode,a=t._key;return r.push(p),{dataNode:n,_key:a}})),p}return function(){return t}}function xe(e){var t=e.element,n=e.attr,r=e.key,a=e.ctx,o=e.handlers,i=e.subscribers,c=e.innerData,s=e.custom;if(ye(n)){if(s)return void(t[r]=""===n||n);if("is"===r)return;if(-1<r.indexOf(":")){var u=r.split(":")[0];if("xmlns"!==u)return t.setAttributeNS(a.localNamespaces[u]||me(u),r,n)}return t.setAttribute(r,n)}var p=function(e){var t=e.element,n=e.key,r=e.custom,a=e.ctx;if(r)return function(e){t[n]=e};if("class"===n)return function(e){if(!(e=(""+e).replace(/\s+/g," ").trim()))return t.removeAttribute(n);t.setAttribute(n,e)};if(-1<n.indexOf(":")){var o=n.split(":")[0],i=a.localNamespaces[o]||me(o);return function(e){if(""===e)return t.removeAttributeNS(i,n);t.setAttributeNS(i,n,e)}}return function(e){if(""===e)return t.removeAttribute(n);t.setAttribute(n,e)}}({element:t,key:r,custom:s,ctx:a});R([be({val:n,ctx:a,handlers:o,subscribers:i,innerData:c,handler:p})])}function Ne(e){var t=e.element,n=e.propPath,r=e.value,a=e.ctx,o=e.handlers,i=e.subscribers,c=e.innerData,s=e.custom,u=A.copy(n),p=u.pop();s&&u.unshift("$data");var l,f,h,d,v,m,y,g,b,x,N,$,E,w,k,O=function(e,t){for(var n=0,r=e;n<r.length;n+=1){var a=r[n];t[a]||(t[a]={}),t=t[a]}return t}(u,t);function T(){P(),w[k]=x?y.$data.value:y.value,I()}ye(r)?O[p]=r:(l=be({val:r,ctx:a,handlers:o,subscribers:i,innerData:c,handler:function(e){O[p]=e}}),1!==n.length||"value"!==p&&"checked"!==p||r[0]||(f={ctx:a,handlers:o,subscribers:i,innerData:c,element:t,key:p,expr:r[1],custom:s},h=f.ctx,d=f.handlers,v=f.subscribers,m=f.innerData,y=f.element,g=f.key,b=f.expr,x=f.custom,N=x?"$on":"addEventListener",$=x?"$dispatch":"dispatchEvent",E=q({bind:b,ctx:h,handlers:d,subscribers:v,innerData:m}),w=E.parentNode,k=E._key,"value"===g?(y[N]("input",T,!0),y[N]("keyup",T,!0),y[N]("change",T,!0)):(y[N]("change",function(){if(y[$](ve("ef-change-event"),{bubbles:!0,canceoable:!1}),"INPUT"===y.tagName&&"radio"===y.type&&""!==y.name){var e=fe.document.querySelectorAll("input[name="+y.name+"][type=radio]");if(e){var t=A.copy(e);A.remove(t,y);for(var n=0,r=t;n<r.length;n+=1){r[n].dispatchEvent(ve("ef-change-event"))}}}},!0),y[N]("ef-change-event",function(){P(),w[k]=x?y.$data.checked:y.checked,I()}))),R([l]))}function $e(e){return e}function Ee(e){var t=e.element,n=e.event,r=e.ctx,a=e.handlers,o=e.subscribers,i=e.innerData,c=e.custom?"$on":"addEventListener",s=n.l,u=n.m,p=n.s,l=n.i,f=n.p,h=n.h,d=n.a,v=n.c,m=n.t,y=n.u,g=n.k,b=n.v,x=be({val:b,ctx:r,handlers:a,subscribers:o,innerData:i,handler:$e});t[c](s,function(e){!!h!=!!e.shiftKey||!!d!=!!e.altKey||!!v!=!!e.ctrlKey||!!m!=!!e.metaKey||g&&-1===g.indexOf(e.which)||(p&&e.stopPropagation(),l&&e.stopImmediatePropagation(),f&&e.preventDefault(),r.methods[u]?r.methods[u]({e:e,value:x(),state:r.state}):ie.warn("Method named '"+u+"' not found! Value been passed is:",x()))},!!y)}function we(e){if(!e.$ctx)throw new Error("[EF] This component has been destroyed!")}function ke(e){function t(){var e=p[f];s.textContent=void 0!==e?e:""}var n=e.node,r=e.ctx,a=e.handlers,o=e.subscribers,i=e.innerData,c=e.element,s=fe.document.createTextNode(""),u=q({bind:n,ctx:r,handlers:a,subscribers:o,innerData:i}),p=u.dataNode,l=u.handlerNode,f=u._key;l.push(t),R([t]),fe.append(c,s)}function Oe(e){var t,n,r=e.ctx,a=e.key,o=e.anchor,i=r.children,c=r.isFragment;i[a]={node:(t=[],n={ctx:r,key:a,anchor:o},Object.defineProperties(t,{empty:{value:je.empty},clear:{value:je.clear},pop:{value:je.pop},push:{value:je.push.bind(t,n)},remove:{value:je.remove},reverse:{value:je.reverse.bind(t,n)},shift:{value:je.shift},sort:{value:je.sort.bind(t,n)},splice:{value:je.splice},unshift:{value:je.unshift.bind(t,n)}}),t),anchor:o},le.set(o,i[a]),c&&fe.append(r.safeZone,o)}function Te(e){var t,n,r,a,o,i,c=e.node,s=e.nodeType,u=e.element,p=e.ctx,l=e.innerData,f=e.refs,h=e.handlers,d=e.subscribers,v=e.namespace,m=e.create;if(c instanceof fe.Node)fe.append(u,c);else switch(s){case"string":fe.append(u,fe.document.createTextNode(c));break;case"array":"object"===E(c[0])?fe.append(u,m({node:c,ctx:p,innerData:l,refs:f,handlers:h,subscribers:d,namespace:v})):ke({node:c,ctx:p,handlers:h,subscribers:d,innerData:l,element:u});break;case"object":var y=fe.document.createTextNode("");0===c.t?(t={ctx:p,key:c.n,anchor:y},n=t.ctx,r=t.key,a=t.anchor,o=n.children,i=n.isFragment,o[r]={anchor:a},le.set(a,o[r]),i&&fe.append(n.safeZone,a)):Oe({ctx:p,key:c.n,anchor:y}),fe.append(u,fe.document.createComment("EF MOUNTING POINT '"+c.n+"' START")),fe.append(u,y),fe.append(u,fe.document.createComment("EF MOUNTING POINT '"+c.n+"' END"))}}function De(e,t){var n=e.base,r=e.key,a=t.checkTrue,o=t.get,i=t.set;if(o){if(!i)throw new Error("[EF] Setter must be defined when getter exists");return o}return a?function(){return a(n(this)[r],this)}:function(){return n(this)[r]}}function _e(e,t){var a=e.base,o=e.key,n=t.checkTrue,i=t.trueVal,c=t.falseVal,r=t.get,s=t.set;if(s){if(!r)throw new Error("[EF] Getter must be defined when setter exists");return s}return n?function(e){var t=a(this),n=i,r=c;"function"!=typeof i&&(i=function(){return n}),"function"!=typeof c&&(c=function(){return r}),t[o]=(e?i:c)(this)}:function(e){a(this)[o]=e}}function Fe(e){return e.$data}function Ce(r){return r?"function"==typeof r?r:("string"==typeof r&&(r=r.split(".")),function(e){for(var t=0,n=r;t<n.length;t+=1){e=e[n[t]]}return e}):Fe}function Ae(e,t){for(var n in t){var r=t[n],a={base:Ce(r.base),key:r.key||n},o=De(a,r),i=_e(a,r);Object.defineProperty(e.prototype,n,{get:o,set:i,enumerable:!0,configurable:!1})}return e}var Re={html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML",xlink:"http://www.w3.org/1999/xlink"},je={empty:function(){P();for(var e=0,t=A.copy(this);e<t.length;e+=1){t[e].$destroy()}I(),A.empty(this)},clear:function(){P();for(var e=0,t=A.copy(this);e<t.length;e+=1){t[e].$umount()}I(),A.empty(this)},pop:function(){if(0!==this.length){var e=A.pop(this);return e.$umount(),e}},push:function(e){for(var t=e.ctx,n=e.key,r=e.anchor,a=[],o=arguments.length-1;0<o--;)a[o]=arguments[o+1];a=a.map(pe.toEFComponent);var i=[];P();for(var c=0,s=a;c<s.length;c+=1){var u=s[c];A.push(i,u.$mount({parent:t.state,key:n}))}return 0===this.length?fe.after.apply(fe,[r].concat(i)):fe.after.apply(fe,[this[this.length-1].$ctx.nodeInfo.placeholder].concat(i)),I(),A.push.apply(A,[this].concat(a))},remove:function(e){if(-1!==this.indexOf(e))return e.$umount(),e},reverse:function(e){var t=e.ctx,n=e.key,r=e.anchor;if(0===this.length)return this;var a=A.copy(this),o=[];P();for(var i=a.length-1;0<=i;i--)a[i].$umount(),A.push(o,a[i].$mount({parent:t.state,key:n}));return A.push.apply(A,[this].concat(A.reverse(a))),fe.after.apply(fe,[r].concat(o)),I(),this},shift:function(){if(0!==this.length){var e=A.shift(this);return e.$umount(),e}},sort:function(e,t){var n=e.ctx,r=e.key,a=e.anchor;if(0===this.length)return this;var o=A.copy(A.sort(this,t)),i=[];P();for(var c=0,s=o;c<s.length;c+=1){var u=s[c];u.$umount(),A.push(i,u.$mount({parent:n.state,key:r}))}return A.push.apply(A,[this].concat(o)),fe.after.apply(fe,[a].concat(i)),I(),this},splice:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(0===this.length)return this;var n=A.splice.apply(A,[A.copy(this)].concat(e));P();for(var r=0,a=n;r<a.length;r+=1){a[r].$umount()}return I(),n},unshift:function(e){for(var t,n=e.ctx,r=e.key,a=e.anchor,o=[],i=arguments.length-1;0<i--;)o[i]=arguments[i+1];if(0===this.length)return(t=this).push.apply(t,o).length;o=o.map(pe.toEFComponent);var c=[];P();for(var s=0,u=o;s<u.length;s+=1){var p=u[s];A.push(c,p.$mount({parent:n.state,key:r}))}return fe.after.apply(fe,[a].concat(c)),I(),A.unshift.apply(A,[this].concat(o))}},Pe={BEFORE:"before",AFTER:"after",APPEND:"append",REPLACE:"replace"},Ie=me("svg"),Se=me("math"),Me=me("html"),Ue=Object.create(null),qe=[function(e){var t=e.ctx,n=e.key,r=e.value,a=t.children[n],o=a.anchor,i=a.node;i!==r&&(r=pe.toEFComponent(r),P(),i&&(r===Ue?r=null:i.$umount()),(a.node=r)&&r.$mount({target:o,parent:t.state,option:Pe.BEFORE,key:n}),I())},function(e){var t=e.ctx,n=e.key,r=e.value,a=t.children[n],o=a.anchor,i=a.node;if(!A.equals(i,r)){r=r?A.copy(r):[];var c=fe.document.createDocumentFragment();if(P(),i){i.clear();for(var s=0,u=r;s<u.length;s+=1){var p=u[s];(p=pe.toEFComponent(p)).$ctx.nodeInfo.parent&&p.$umount(),fe.append(c,p.$mount({parent:t.state,key:n}))}}else for(var l=0,f=r;l<f.length;l+=1){var h=f[l];fe.append(c,h.$mount({parent:t.state,key:n}))}i.length=0,A.push.apply(A,[i].concat(r)),fe.after(o,c),I()}}],Be=function(e){var t,n=e.node,r=e.ctx,a=e.innerData,o=e.refs,i=e.handlers,c=e.subscribers,s=e.namespace,u=n[0],p=n.slice(1),l=s,f=u.t,h=!1,d=0===f,v=Object.isPrototypeOf.call(pe.EFBaseComponent,r.scope[f]||f);if(!d&&!v)if(r.scope[f]&&("string"==typeof(t=r.scope[f])?f=t:t.tag&&(f=t.tag,t.namespaceURI&&(s=t.namespaceURI))),-1<f.indexOf(":")){var m=f.split(":"),y=m[0],g=m[1];r.localNamespaces[y]?(s=r.localNamespaces[y],h=!0):s=me(y),f=g}else if(u.a&&u.a.xmlns&&ye(u.a.xmlns))s=u.a.xmlns;else if(!s)switch(f=f.toLowerCase()){case"svg":s=Ie;break;case"math":s=Se}s===Me&&(s="");var b=function(e){var t=e.info,n=e.ctx,r=e.innerData,a=e.refs,o=e.handlers,i=e.subscribers,c=e.namespace,s=e.fragment,u=e.custom;if(s)return new he;var p=t.t,l=t.a,f=t.p,h=t.e,d=t.r,v=n.scope[p]||p,m=ge({tagName:p,tagContent:v,attrs:l,ref:d,refs:a,namespace:c});if(l)for(var y in l)xe({element:m,custom:u,attr:l[y],key:y,ctx:n,handlers:o,subscribers:i,innerData:r});if(f)for(var g=0,b=f;g<b.length;g+=1){var x=b[g],N=x[0],$=x[1];Ne({element:m,custom:u,value:$,propPath:N,ctx:n,handlers:o,subscribers:i,innerData:r})}if(h)for(var E=0,w=h;E<w.length;E+=1){var k=w[E];Ee({element:m,custom:u,event:k,ctx:n,handlers:o,subscribers:i,innerData:r})}return m}({info:u,ctx:r,innerData:a,refs:o,handlers:i,subscribers:c,namespace:s,fragment:d,custom:v});d&&b.append(fe.document.createComment("EF FRAGMENT START")),s&&s===Ie&&-1<["foreignobject","desc","title"].indexOf(f.toLowerCase())&&(s=""),h&&(s=l);for(var x=0,N=p;x<N.length;x+=1){var $=N[x];$ instanceof pe.EFBaseComponent?$.$mount({target:b}):Te({node:$,nodeType:E($),element:b,ctx:r,innerData:a,refs:o,handlers:i,subscribers:c,namespace:s,create:Be})}return d&&b.append(fe.document.createComment("EF FRAGMENT END")),b},Le=function(){function e(e,t){void 0===t&&(t={});var n={},r={},a={},o={},i={placeholder:null,replace:[],parent:null,key:null},c=fe.document.createDocumentFragment();i.placeholder=fe.document.createComment("EF COMPONENT PLACEHOLDER");function s(){if(0<i.replace.length){for(var e=0,t=i.replace;e<t.length;e+=1){var n=t[e];fe.remove(n)}A.empty(i.replace)}fe.before(i.placeholder,i.element)}var u={scope:t,mount:s,refs:n,data:{},innerData:r,methods:{},handlers:a,subscribers:o,nodeInfo:i,safeZone:c,children:{},state:this,isFragment:0===e[0].t,localNamespaces:this.constructor.__local_namespaces};Object.defineProperty(this,"$ctx",{value:u,enumerable:!1,configurable:!0}),P(),i.element=Be({node:e,ctx:u,innerData:r,refs:n,handlers:a,subscribers:o,namespace:""}),fe.append(c,i.placeholder),j(s),I()}var t={$data:{configurable:!0},$methods:{configurable:!0},$refs:{configurable:!0}};return t.$data.get=function(){return we(this),this.$ctx.data},t.$data.set=function(e){we(this),P(),ae(this.$ctx.data,e),I()},t.$methods.get=function(){return we(this),this.$ctx.methods},t.$methods.set=function(e){we(this),this.$ctx.methods=e},t.$refs.get=function(){return we(this),this.$ctx.refs},e.prototype.$mount=function(e){var t=e.target,n=e.option,r=e.parent,a=e.key;we(this);var o=this.$ctx,i=o.nodeInfo,c=o.mount;if("string"==typeof t&&(t=document.querySelector(t)),P(),i.parent&&(this.$umount(),ie.warn("Component detached from previous mounting point.")),r=r||t,a=a||"__DIRECTMOUNT__",i.parent=r,i.key=a,j(c),!t)return I(),i.placeholder;switch(n){case Pe.BEFORE:fe.before(t,i.placeholder);break;case Pe.AFTER:fe.after(t,i.placeholder);break;case Pe.REPLACE:fe.before(t,i.placeholder),i.replace.push(t);break;case Pe.APPEND:default:B(r,he)?fe.append(t,i.element):fe.append(t,i.placeholder)}return I()},e.prototype.$umount=function(){we(this);var e=this.$ctx,t=e.nodeInfo,n=e.safeZone,r=e.mount,a=t.parent,o=t.key;return t.parent=null,t.key=null,P(),a&&("__DIRECTMOUNT__"!==o?a[o]&&(Array.isArray(a[o])?A.remove(a[o],this):a[o]=Ue):B(a,he)&&a.$ctx.nodeInfo.element.removeChild(t.element)),fe.append(n,t.placeholder),j(r),I()},e.prototype.$subscribe=function(e,t){we(this);var n=this.$ctx,r=n.handlers,a=n.subscribers,o=n.innerData,i=e.split("."),c=q({bind:[i],ctx:n,handlers:r,subscribers:a,innerData:o}),s=c.dataNode,u=c.subscriberNode,p=c._key;P();try{t({state:this,value:s[p]}),u.push(t)}catch(e){ie.error("Error caught when registering subscriber:\n",e)}I()},e.prototype.$unsubscribe=function(e,t){we(this);var n,r,a=this.$ctx.subscribers;n=t,r=function(e,t){for(var n=e.split("."),r=n.pop(),a=0,o=n;a<o.length;a+=1){var i=o[a];t[i]||(t[i]={}),t=t[i]}return t[r]}(e,a),A.remove(r,n)},e.prototype.$update=function(e){we(this),P(),n(this,e),I()},e.prototype.$dispatch=function(e){return we(this),this.$ctx.nodeInfo.placeholder.dispatchEvent(e)},e.prototype.$emit=function(e,t){return we(this),this.$dispatch(ve(e,t))},e.prototype.$on=function(){for(var e,t=[],n=arguments.length;n--;)t[n]=arguments[n];return we(this),(e=this.$ctx.nodeInfo.placeholder).addEventListener.apply(e,t)},e.prototype.$off=function(){for(var e,t=[],n=arguments.length;n--;)t[n]=arguments[n];return we(this),(e=this.$ctx.nodeInfo.placeholder).removeEventListener.apply(e,t)},e.prototype.$destroy=function(){we(this);var e=this.$ctx,t=e.nodeInfo,n=e.children;for(var r in P(),this.$umount(),n)le.delete(n[r].anchor);for(var a in this)"array"===E(this[a])?this[a].clear():this[a]=null;return delete this.$ctx,j(function(){fe.remove(t.element),fe.remove(t.placeholder)}),I()},Object.defineProperties(e.prototype,t),e}(),Ze=[{t:0}],Ge=function(a){function e(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];a.call(this,Ze);var n=this.$ctx.nodeInfo.element,r=n.$children;n.append.apply(n,e),n.append(A.remove(r,r[1])),this.$ctx.elements=e}a&&(e.__proto__=a),(e.prototype=Object.create(a&&a.prototype)).constructor=e;var t={$el:{configurable:!0}};return t.$el.get=function(){return this.$ctx.elements},Object.defineProperties(e.prototype,t),e}(Le),Ke=function(n){function e(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];n.call(this,[{t:0}].concat(e))}return n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e}(Le),Ve=[{t:0},[["text"]]],ze=function(t){function e(e){P(),t.call(this,Ve),this.text=e,I()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(Le);Ae(ze,{text:{}}),L(Le,["$mount","$umount","$subscribe","$unsubscribe","$update","$dispatch","$emit","$on","$off","$destroy"]),L(Ge,["$el"]);function Je(e){return null==e||e instanceof Le?e:e!==Ue?e instanceof Node?new Ge(e):new ze("string"==typeof e?e:JSON.stringify(e)):void 0}pe.EFBaseComponent=Le,pe.toEFComponent=Je;function We(e,t){return Array.isArray(t)?e.push.apply(e,t.map(Je)):e.push(Je(t)),e}var He=function(e,t){var n,r,a,o=E(e);switch(o){case"array":var i=e[0],c=e.slice(1);if("object"===E(i)){i.a&&function(e,t){for(var n in e){var r;0===n.indexOf("xmlns:")&&(r=n.split(":")[1],t.__local_namespaces[r]=e[n])}}(i.a,t);for(var s=0,u=c;s<u.length;s+=1){var p=u[s];He(p,t)}}break;case"object":if(1<e.t)throw new TypeError("[EF] Not a standard ef.js AST: Unknown mounting point type '"+e.t+"'");n=e.t,r=e.n,a=t,Object.defineProperty(a.prototype,r,{get:function(){return we(this),this.$ctx.children[r].node},set:function(e){we(this);var t=this.$ctx;qe[n]({ctx:t,key:r,value:e})},enumerable:!0});break;case"string":break;default:throw new TypeError("[EF] Not a standard ef.js AST: Unknown node type '"+o+"'")}};ie.info("ef-core v0.12.5 initialized!");function Qe(e){var r,t,n=E(e);if("string"===n)e=(Xe||d)(e);else if("array"!==n)throw new TypeError("Cannot create new component without proper template or AST!");return r=e,t=function(n){function e(e,t){P(),n.call(this,r,t),e&&this.$update(e),I()}return n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e}(Le),Object.defineProperty(t.prototype,"constructor",{enumerable:!1}),Object.defineProperty(t,"__local_namespaces",{enumerable:!1,value:{}}),He(r,t),t}var Xe=d;console.info("[EF] ef.js v0.12.5 initialized!"),e.EFNodeWrapper=Ge,e.EFTextFragment=ze,e.Fragment=Ke,e.bundle=function(e){P();try{I(e(P,I))}catch(e){return I(),e}},e.create=Qe,e.createElement=function(e,t){for(var n=[],r=arguments.length-2;0<r--;)n[r]=arguments[r+2];if(e===Ke)return new(Function.prototype.bind.apply(Ke,[null].concat(n)));if(Object.isPrototypeOf.call(Le,e))return n.length<=0?new e(t):new e(ae({children:n.reduce(We,[])},t||{}));var a=ae({},t);for(var o in a)!0===a[o]&&(a[o]="");return new Le([{t:e,a:a}].concat(n))},e.declareNamespace=function(e,t){if(Re[e])throw new Error('[EF] Namespace "'+e+'" has already been declared as "'+Re[e]+'".');Re[e]=t},e.exec=I,e.inform=P,e.isPaused=function(){return 0<re},e.mapAttrs=Ae,e.mountOptions=Pe,e.onNextRender=function(e){return ne.push(e)},e.parseEft=d,e.scoped=function(e,a){return function(r){function e(e,t){void 0===t&&(t={});var n=ae({},a);r.call(this,e,ae(n,t))}return r&&(e.__proto__=r),(e.prototype=Object.create(r&&r.prototype)).constructor=e}(e)},e.setDOMImpl=de,e.setParser=function(e){Xe=e},e.t=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return Qe(v.apply(void 0,e))},e.version="0.12.5",Object.defineProperty(e,"__esModule",{value:!0})});
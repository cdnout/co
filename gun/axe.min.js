!function(){function r(n,t){return t?require(n):n.slice?r[o(n)]:function(t,e){n(t={exports:{}}),r[o(e)]=t.exports};function o(t){return t.split("/").slice(-1).toString().replace(".js","")}}var n;"undefined"!=typeof module&&(n=module),r(function(t){"undefined"!=typeof window&&(t.window=window);var e=(t.window||t).AXE||function(){};(e.window=t.window)&&(e.window.AXE=e);try{void 0!==n&&(n.exports=e)}catch(t){}t.exports=e})(r,"./root"),r(function(t){var e=r("./root"),p=(e.window||{}).Gun||r("./gun",1);(p.AXE=e).GUN=e.Gun=p;var v=0;p.on("opt",function(t){!function(d){if(d.axe)return;var l=d.opt,i=l.peers;if(!1===l.axe)return;if("undefined"!=typeof process&&"false"==""+(process.env||{}).AXE)return;var u,y=d.axe={};l.mob=l.mob||9876;var h=l.mesh=l.mesh||p.Mesh(d);function t(t,e){var n,o=+new Date,r=Object.keys(e.put)[0],u=t(r);u&&(n=[],p.obj.map(u.split(","),function(t){t in i&&(n.push(t),h.say(e,i[t]))}),l.super&&t(r,n.join(",")),console.STAT&&console.STAT(o,new Date-o,"axe verify"))}function a(t){var e;if(t&&"string"==typeof(e=t["#"]))return e}console.log("AXE enabled.");var e=(p.window||{}).Radix||r("./lib/radix",1);{d.opt.dht=e(),d.on("in",function(t){var e,n,o=this.to,r=(t._||"").via,u=l.dht,i=y.routes||(y.routes={}),s=t.get;s&&l.super&&r&&(n=a(s))&&((((i[e=n]||(i[e]={}))[r.id]=r).routes||(r.routes={}))[e]=i[e]),(n=t["@"])&&(n=d.dup.s[n])&&(n.ack=(n.ack||0)+1),o.next(t),l.rtc&&t.dht&&p.obj.map(t.dht,function(t,e){u(e,t),p.obj.map(t.split(","),function(t){!t||t in l.peers||t===l.pid||l.announce[t]||(l.announce[t]=!0,l.announce(t))})})}),h.hear.opt=function(t,e){if(t.ok)return l.log(t);var n,o=t.opt;(o=o&&o.peers)&&p.text.is(o)&&(y.up[o]||6<=Object.keys(y.up).length||(n=o,d.$.opt(n),(n=i[o])&&(n.retry=9,h.wire(n),e&&h.say({dam:"opt",ok:1,"@":t["#"]},e))))},setInterval(function(t){(t=d.stats&&d.stats.stay)&&((t.axe=t.axe||{}).up=Object.keys(y.up||{}))},6e4),setTimeout(function(t){(t=d.stats&&d.stats.stay)&&p.obj.map((t.axe||{}).up,function(t){h.hear.opt({opt:{peers:t}})})},1e3),d.opt.super?h.way=function(f){if(f.rtc&&f.rtc.to){var t=r?r[f.rtc.to]:null;t&&h.say(f,t)}else{if(f.get&&h.say(f,y.up),f.get&&(u=a(f.get))){var e=u,o=y.routes||(y.routes={});return function t(e,n){if(!e)return t(l.peers);var o=+new Date,r=Object.keys(e),u=f._||w;clearTimeout(u.lack);for(var i,s,a=1;(i=r[u.turn||0])&&a--;)s=e[i],u.turn=(u.turn||0)+1,(n&&n[i]||!1===h.say(f,s))&&++a;if(console.STAT&&9<(v=new Date-o)&&console.STAT(o,v,"axe chat"),0<a){if(e===l.peers)return;return u.turn=0,t(l.peers,e)}var p=f["##"],c=u.ack||d.dup.s[f["#"]];u.lack=setTimeout(function(){c&&p&&p===f["##"]||u.turn>=(y.turns||3)||t(e,n)},25)}(r=o[e])}if(f.put){var n=+new Date,o=y.routes||(y.routes={}),r={};return p.obj.map(f.put,function(t,e){var n=o[e];n&&p.obj.to(n,r)}),console.STAT&&9<(v=new Date-n)&&console.STAT(n,v,"axe put"),void h.say(f,r)}h.say(f,l.peers)}}:h.route=function(e){e.rtc,e.put?(t(l.dht,e),p.obj.map(i,function(t){t.url&&h.say(e,t)})):h.say(e)}}y.up={},d.on("hi",function(t){this.to.next(t),t.url&&(y.up[t.id]=t)}),d.on("bye",function(n){this.to.next(n),n.url&&delete y.up[n.id];var t=+new Date;p.obj.map(n.routes,function(t,e){delete t[n.id],p.obj.empty(t)&&delete y.routes[e]}),console.STAT&&console.STAT(t,new Date-t,"axe bye")}),d.on("hi",function(t){var e,n;this.to.next(t),t.url||(e=Object.keys(l.peers).length,l.mob>=e||(n=Object.keys(y.up)).length&&h.say({dam:"mob",mob:e,peers:n},t))}),d.on("bye",function(t){this.to.next(t)}),d.on("hi",function(e){this.to.next(e),setTimeout(function(){e.pid!==l.pid&&!p.obj.map(y.up,function(t){if(e.pid===t.pid&&e!==t)return w=!0})||(h.say({dam:"-"},e),delete d.dup.s[e.last])},100*Math.random())}),h.hear["-"]=function(t,e){h.bye(e),e.url=""}}(t),this.to.next(t)});var w=!0;t.exports=e})(r,"./axe")}();
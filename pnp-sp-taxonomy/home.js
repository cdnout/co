/**
 * @license
 * v1.3.11
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2020 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https://github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@pnp/sp-clientsvc"),require("@pnp/common"),require("@pnp/sp")):"function"==typeof define&&define.amd?define(["exports","@pnp/sp-clientsvc","@pnp/common","@pnp/sp"],t):t((e.pnp=e.pnp||{},e.pnp["sp-taxonomy"]={}),e.pnp["sp-clientsvc"],e.pnp.common,e.pnp.sp)}(this,function(e,a,u,t){"use strict";var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function r(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o,i=(r(s,o=a.ClientSvcQueryable),s.prototype.getByValue=function(e){var t=a.MethodParams.build().string(e);return this.getChild(p,"GetByValue",t)},s.prototype.get=function(){var t=this;return this.sendGetCollection(function(e){if(!u.stringIsNullOrEmpty(e.Value))return t.getByValue(e.Value);throw Error("Could not find Value in Labels.get(). You must include at least one of these in your select fields.")})},s);function s(e,t){void 0===e&&(e=""),void 0===t&&(t=null);var r=o.call(this,e,t)||this;return r._objectPaths.add(a.property("Labels")),r}var d,p=(r(l,d=a.ClientSvcQueryable),l.prototype.get=function(){return this.sendGet(l)},l.prototype.setAsDefaultForLanguage=function(){return this.invokeNonQuery("SetAsDefaultForLanguage")},l.prototype.delete=function(){return this.invokeNonQuery("DeleteObject")},l);function l(){return null!==d&&d.apply(this,arguments)||this}var c,h=(r(y,c=a.ClientSvcQueryable),y.prototype.get=function(){var t=this;return this.sendGetCollection(function(e){if(!u.stringIsNullOrEmpty(e.Name))return t.getByName(e.Name);if(!u.stringIsNullOrEmpty(e.Id))return t.getById(e.Id);throw Error("Could not find Name or Id in Terms.get(). You must include at least one of these in your select fields.")})},y.prototype.getById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(g,"GetById",t)},y.prototype.getByName=function(e){var t=a.MethodParams.build().string(e);return this.getChild(g,"GetByName",t)},y);function y(){return null!==c&&c.apply(this,arguments)||this}var m,g=(r(f,m=a.ClientSvcQueryable),f.prototype.addTerm=function(e,t,r,n){var o=this;void 0===r&&(r=!0),void 0===n&&(n=u.getGUID());var i=a.MethodParams.build().string(e).number(t).string(u.sanitizeGuid(n));return this._useCaching=!1,this.invokeMethod("CreateTerm",i,a.setProperty("IsAvailableForTagging","Boolean",""+r)).then(function(e){return u.extend(o.termSet.getTermById(e.Id),e)})},Object.defineProperty(f.prototype,"terms",{get:function(){return this.getChildProperty(h,"Terms")},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"labels",{get:function(){return new i(this)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"parent",{get:function(){return this.getChildProperty(f,"Parent")},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"pinSourceTermSet",{get:function(){return this.getChildProperty(T,"PinSourceTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"reusedTerms",{get:function(){return this.getChildProperty(h,"ReusedTerms")},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"sourceTerm",{get:function(){return this.getChildProperty(f,"SourceTerm")},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"termSet",{get:function(){return this.getChildProperty(T,"TermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"termSets",{get:function(){return this.getChildProperty(v,"TermSets")},enumerable:!0,configurable:!0}),f.prototype.createLabel=function(t,e,r){var n=this;void 0===r&&(r=!1);var o=a.MethodParams.build().string(t).number(e).boolean(r);return this._useCaching=!1,this.invokeMethod("CreateLabel",o).then(function(e){return u.extend(n.labels.getByValue(t),e)})},f.prototype.deprecate=function(e){var t=a.MethodParams.build().boolean(e);return this.invokeNonQuery("Deprecate",t)},f.prototype.get=function(){return this.sendGet(f)},f.prototype.getDescription=function(e){var t=a.MethodParams.build().number(e);return this.invokeMethodAction("GetDescription",t)},f.prototype.setDescription=function(e,t){var r=a.MethodParams.build().string(e).number(t);return this.invokeNonQuery("SetDescription",r)},f.prototype.setLocalCustomProperty=function(e,t){var r=a.MethodParams.build().string(e).string(t);return this.invokeNonQuery("SetLocalCustomProperty",r)},f.prototype.update=function(e){return this.invokeUpdate(e,f)},f.prototype.delete=function(){return this.invokeNonQuery("DeleteObject")},f);function f(){return null!==m&&m.apply(this,arguments)||this}var b,v=(r(P,b=a.ClientSvcQueryable),P.prototype.get=function(){var t=this;return this.sendGetCollection(function(e){if(!u.stringIsNullOrEmpty(e.Name))return t.getByName(e.Name);if(!u.stringIsNullOrEmpty(e.Id))return t.getById(e.Id);throw Error("Could not find Value in Labels.get(). You must include at least one of these in your select fields.")})},P.prototype.getById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(T,"GetById",t)},P.prototype.getByName=function(e){var t=a.MethodParams.build().string(e);return this.getChild(T,"GetByName",t)},P);function P(){return null!==b&&b.apply(this,arguments)||this}var C,T=(r(S,C=a.ClientSvcQueryable),Object.defineProperty(S.prototype,"group",{get:function(){return this.getChildProperty(j,"Group")},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"terms",{get:function(){return this.getChild(h,"GetAllTerms",null)},enumerable:!0,configurable:!0}),S.prototype.addStakeholder=function(e){var t=a.MethodParams.build().string(e);return this.invokeNonQuery("DeleteStakeholder",t)},S.prototype.deleteStakeholder=function(e){var t=a.MethodParams.build().string(e);return this.invokeNonQuery("AddStakeholder",t)},S.prototype.get=function(){return this.sendGet(S)},S.prototype.getTermById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(g,"GetTerm",t)},S.prototype.addTerm=function(e,t,r,n){var o=this;void 0===r&&(r=!0),void 0===n&&(n=u.getGUID());var i=a.MethodParams.build().string(e).number(t).string(u.sanitizeGuid(n));return this._useCaching=!1,this.invokeMethod("CreateTerm",i,a.setProperty("IsAvailableForTagging","Boolean",""+r)).then(function(e){return u.extend(o.getTermById(e.Id),e)})},S.prototype.copy=function(){return this.invokeMethod("Copy",null)},S.prototype.update=function(e){return this.invokeUpdate(e,S)},S);function S(){return null!==C&&C.apply(this,arguments)||this}var G,I=(r(M,G=a.ClientSvcQueryable),M.prototype.get=function(){var t=this;return this.sendGetCollection(function(e){if(!u.stringIsNullOrEmpty(e.Name))return t.getByName(e.Name);if(!u.stringIsNullOrEmpty(e.Id))return t.getById(e.Id);throw Error("Could not find Name or Id in TermGroups.get(). You must include at least one of these in your select fields.")})},M.prototype.getById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(j,"GetById",t)},M.prototype.getByName=function(e){var t=a.MethodParams.build().string(e);return this.getChild(j,"GetByName",t)},M);function M(){return null!==G&&G.apply(this,arguments)||this}var N,j=(r(B,N=a.ClientSvcQueryable),Object.defineProperty(B.prototype,"termSets",{get:function(){return this.getChildProperty(v,"TermSets")},enumerable:!0,configurable:!0}),B.prototype.addContributor=function(e){var t=a.MethodParams.build().string(e);return this.invokeNonQuery("AddContributor",t)},B.prototype.addGroupManager=function(e){var t=a.MethodParams.build().string(e);return this.invokeNonQuery("AddGroupManager",t)},B.prototype.createTermSet=function(e,t,r){var n=this;void 0===r&&(r=u.getGUID());var o=a.MethodParams.build().string(e).string(u.sanitizeGuid(r)).number(t);return this._useCaching=!1,this.invokeMethod("CreateTermSet",o).then(function(e){return u.extend(n.store.getTermSetById(e.Id),e)})},B.prototype.get=function(){return this.sendGet(B)},B.prototype.update=function(e){return this.invokeUpdate(e,B)},B);function B(e,t){void 0===e&&(e="");var r=N.call(this,e,t)||this;return r.store=e instanceof D?e:null,r}var O,k=(r(Q,O=a.ClientSvcQueryable),Q.prototype.get=function(){var t=this;return this.sendGetCollection(function(e){if(!u.stringIsNullOrEmpty(e.Name))return t.getByName(e.Name);if(!u.stringIsNullOrEmpty(e.Id))return t.getById(e.Id);throw Error("Could not find Name or Id in TermStores.get(). You must include at least one of these in your select fields.")})},Q.prototype.getByName=function(e){return this.getChild(D,"GetByName",a.MethodParams.build().string(e))},Q.prototype.getById=function(e){return this.getChild(D,"GetById",a.MethodParams.build().string(u.sanitizeGuid(e)))},Q);function Q(e){void 0===e&&(e="");var t=O.call(this,e)||this;return t._objectPaths.add(a.property("TermStores",a.objectPath())),t}var _,D=(r(w,_=a.ClientSvcQueryable),Object.defineProperty(w.prototype,"hashTagsTermSet",{get:function(){return this.getChildProperty(T,"HashTagsTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"keywordsTermSet",{get:function(){return this.getChildProperty(T,"KeywordsTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"orphanedTermsTermSet",{get:function(){return this.getChildProperty(T,"OrphanedTermsTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"systemGroup",{get:function(){return this.getChildProperty(j,"SystemGroup")},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"groups",{get:function(){return this.getChildProperty(I,"Groups")},enumerable:!0,configurable:!0}),w.prototype.get=function(){return this.sendGet(w)},w.prototype.getTermSetsByName=function(e,t){var r=a.MethodParams.build().string(e).number(t);return this.getChild(v,"GetTermSetsByName",r)},w.prototype.getTermSetById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(T,"GetTermSet",t)},w.prototype.getTermById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(g,"GetTerm",t)},w.prototype.getTermsById=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=a.MethodParams.build().strArray(e.map(function(e){return u.sanitizeGuid(e)}));return this.getChild(h,"GetTermsById",r)},w.prototype.getTermInTermSet=function(e,t){var r=a.MethodParams.build().string(u.sanitizeGuid(e)).string(u.sanitizeGuid(t));return this.getChild(g,"GetTermInTermSet",r)},w.prototype.getTermGroupById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(j,"GetGroup",t)},w.prototype.getTerms=function(e){var t=this._objectPaths.copy(),r=t.lastIndex,n=a.objConstructor.apply(void 0,["{61a1d689-2744-4ea3-a88b-c95bee9803aa}",a.objectPath()].concat(a.objectProperties(e))),o=t.add(n),i=a.MethodParams.build().objectPath(o),u=t.add(a.method("GetTerms",i,a.objectPath()));return t.addChildRelationship(r,u),new h(this,t)},w.prototype.getSiteCollectionGroup=function(e){void 0===e&&(e=!1);var t=this._objectPaths.copy(),r=t.lastIndex,n=t.siteIndex,o=a.MethodParams.build().objectPath(n).boolean(e),i=t.add(a.method("GetSiteCollectionGroup",o,a.objectPath()));return t.addChildRelationship(r,i),new j(this,t)},w.prototype.addLanguage=function(e){var t=a.MethodParams.build().number(e);return this.invokeNonQuery("AddLanguage",t)},w.prototype.addGroup=function(e,t){var r=this;void 0===t&&(t=u.getGUID());var n=a.MethodParams.build().string(e).string(u.sanitizeGuid(t));return this._useCaching=!1,this.invokeMethod("CreateGroup",n).then(function(e){return u.extend(r.getTermGroupById(e.Id),e)})},w.prototype.commitAll=function(){return this.invokeNonQuery("CommitAll")},w.prototype.deleteLanguage=function(e){var t=a.MethodParams.build().number(e);return this.invokeNonQuery("DeleteLanguage",t)},w.prototype.rollbackAll=function(){return this.invokeNonQuery("RollbackAll")},w.prototype.updateCache=function(){return this.invokeNonQuery("UpdateCache")},w.prototype.update=function(e){return this.invokeUpdate(e,w)},w.prototype.updateUsedTermsOnSite=function(){var e=this._objectPaths.copy(),t=e.lastIndex,r=e.siteIndex,n=a.MethodParams.build().objectPath(r),o=e.add(a.method("UpdateUsedTermsOnSite",n));return e.addChildRelationship(t,o),this.send(e)},w.prototype.getChanges=function(e){var t=this._objectPaths.copy(),r=t.lastIndex,n=t.add(a.objConstructor.apply(void 0,["{1f849fb0-4fcb-4a54-9b01-9152b9e482d3}",a.objectPath()].concat(a.objectProperties(e)))),o=a.MethodParams.build().objectPath(n),i=t.add(a.method("GetChanges",o,a.objectPath(),a.opQuery([],this.getSelects())));return t.addChildRelationship(r,i),this.send(t)},w);function w(e,t){return void 0===e&&(e=""),void 0===t&&(t=null),_.call(this,e,t)||this}var x,A,E,z,U=(r(L,x=a.ClientSvcQueryable),Object.defineProperty(L.prototype,"termStores",{get:function(){return new k(this)},enumerable:!0,configurable:!0}),L.prototype.setup=function(e){t.sp.setup(e)},L.prototype.createBatch=function(){return new a.ObjectPathBatch(this.toUrl())},L.prototype.getDefaultKeywordTermStore=function(){return this.getChild(D,"GetDefaultKeywordsTermStore",null)},L.prototype.getDefaultSiteCollectionTermStore=function(){return this.getChild(D,"GetDefaultSiteCollectionTermStore",null)},L);function L(e){void 0===e&&(e="");var t=x.call(this,e)||this;return t._objectPaths.add(a.staticMethod("GetTaxonomySession","{981cbc68-9edc-4f8d-872f-71146fcbb84f}",a.objectPath())),t}(A=e.StringMatchOption||(e.StringMatchOption={}))[A.StartsWith=0]="StartsWith",A[A.ExactMatch=1]="ExactMatch",(E=e.ChangedItemType||(e.ChangedItemType={}))[E.Unknown=0]="Unknown",E[E.Term=1]="Term",E[E.TermSet=2]="TermSet",E[E.Group=3]="Group",E[E.TermStore=4]="TermStore",E[E.Site=5]="Site",(z=e.ChangedOperationType||(e.ChangedOperationType={}))[z.Unknown=0]="Unknown",z[z.Add=1]="Add",z[z.Edit=2]="Edit",z[z.DeleteObject=3]="DeleteObject",z[z.Move=4]="Move",z[z.Copy=5]="Copy",z[z.PathChange=6]="PathChange",z[z.Merge=7]="Merge",z[z.ImportObject=8]="ImportObject",z[z.Restore=9]="Restore";var V=new U;e.taxonomy=V,e.Labels=i,e.Label=p,e.Session=U,e.TermGroups=I,e.TermGroup=j,e.Terms=h,e.Term=g,e.TermSets=v,e.TermSet=T,e.TermStores=k,e.TermStore=D,e.setItemMetaDataField=function(e,t,r){if(!u.objectDefinedNotNull(r))return Promise.resolve(null);var n={};return n[t]={Label:r.Name,TermGuid:u.sanitizeGuid(r.Id),WssId:"-1",__metadata:{type:"SP.Taxonomy.TaxonomyFieldValue"}},e.update(n)},e.setItemMetaDataMultiField=function(r,e){for(var n=[],t=2;t<arguments.length;t++)n[t-2]=arguments[t];return n.length<1?Promise.resolve(null):r.list.fields.getByTitle(e+"_0").select("InternalName").get().then(function(e){var t={};return t[e.InternalName]=n.map(function(e){return"-1;#"+e.Name+"|"+u.sanitizeGuid(e.Id)+";#"}).join(""),r.update(t)})},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=sp-taxonomy.es5.umd.min.js.map

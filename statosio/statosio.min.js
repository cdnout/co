d3.statosio=((e,t,l,r={})=>{let s=((e,t,a,l)=>{let r=null,s=((e,t,a)=>{const l=(e,t)=>{let a="",l=t.join("__");switch(allow=!1,t.length){case 1:a=e[t[0]];break;case 2:a=e[t[0]][t[1]];break;case 3:a=e[t[0]][t[1]][t[2]];break;case 4:a=e[t[0]][t[1]][t[2]][t[3]]}return null!==a&&(allow=!0),allow?s.allow.push(l):s.block.push(l),allow},r=(e,t)=>{const a=e=>l(e)&&e instanceof Array,l=e=>e&&"object"==typeof e;let r=null;switch(t.length){case 1:r=e[t[0]];break;case 2:r=e[t[0]][t[1]];break;case 3:r=e[t[0]][t[1]][t[2]];break;case 4:r=e[t[0]][t[1]][t[2]][t[3]]}let s={null:null,string:null,array:null,object:null};return s.null=null!==r,s.string="string"==typeof r,a(r)?s.object=!1:l(r)&&(s.object=!0),a(r)?s.array=!0:s.array=!1,s};let s={allow:[],block:[]},n={data__x__key:t,data__y__keys:a},i={};return Object.keys(e).forEach(t=>{let a=[t];r(e,a).object?Object.keys(e[t]).forEach(a=>{let s=[t,a],n=r(e,s);n.array&&l(e,s),n.object?Object.keys(e[t][a]).forEach(s=>{let n=[t,a,s],i=r(e,n);i.array&&l(e,n),i.object?Object.keys(e[t][a][s]).forEach(n=>{let i=[t,a,s,n],o=r(e,i);o.array&&l(e,i),o.object||l(e,i)}):l(e,n)}):l(e,s)}):l(e,a)}),Object.keys(s).forEach(e=>{s[e].forEach(t=>{i[t]={},i[t].type="allow"===e,i[t].names=[];let a=t.split("__").join("---").split("_").join("---").split("---");i[t].names.push(t);let l=[];a.forEach((e,t)=>{let a="";0!=t?(a+=e.charAt(0).toUpperCase(),a+=e.slice(1).toLowerCase()):a=e,l.push(a)}),i[t].names.push(l.join(""))})}),result={required:n,access:s,alias:i},result})(r=e,t,a),n=((e,t)=>{let a={margin_top:null,title:{translate:null,offset:null,show:null},legend:{translate:null,offset:null,show:null}},l=Object.keys(a).filter(e=>!e.includes("margin_top"));return a.title.offset=e.style.font.size.title*t,a.title.show=e.show.title,a.legend.offset=e.style.font.size.text*t,a.legend.show=e.show.legend,a.margin_top=1*e.view.margin.top,a.margin_top+=l.map(e=>a[e].show?a[e].offset:0).reduce((e,t)=>e+t),l.forEach(e=>a[e].translate=-(a.margin_top-a[e].offset)),result={canvas__margin__top:a.margin_top,canvas__translate__title:a.title.translate,canvas__translate__legend:a.legend.translate},result})(r=((e,t,a)=>{const l=(e,t,a)=>{let l=t.split("__");switch(l.length){case 1:e[l[0]]=a;break;case 2:e[l[0]][l[1]]=a;break;case 3:e[l[0]][l[1]][l[2]]=a;break;case 4:e[l[0]][l[1]][l[2]][l[3]]=a}return e};return Object.keys(t.required).forEach(a=>{t.required=((e,t)=>("data__y__keys"===t&&"string"==typeof e[t]&&(-1==e[t].indexOf(",")?e[t]=[e[t]]:e[t]=e[t].split(",").map(e=>e.trim())),e))(t.required,a),null==a&&console.log('Key "'+a+'" is empty!'),e=l(e,a,t.required[a])}),Object.keys(a).forEach(r=>{let s=r,n={key:null,add:!1};Object.keys(t.alias).forEach(e=>{t.alias[e].names.includes(s)&&t.alias[e].type&&(n.key=t.alias[e].names[0],n.add=!0)}),n.add&&(insert=a[s],e=l(e,n.key,insert))}),e})(r,s,l),r.view.translate.multiplicator);return r.view.margin.top=n.canvas__margin__top,r.view.translate.title=n.canvas__translate__title,r.view.translate.legend=n.canvas__translate__legend,r.view.width.inner=r.view.width.outer-r.view.margin.left-r.view.margin.right,r.view.height.inner=r.view.height.outer-r.view.margin.top-r.view.margin.bottom,r.style.legend.rect_size.half=Math.floor(r.style.legend.rect_size.full/2),r.view.translate.legend_text=Math.floor(r.style.legend.rect_size.full/100*80),r.style.legend.padding.before=r.style.legend.rect_size.half,r.style.legend.padding.after=r.style.legend.rect_size.full,r.data.legend.names.keys=r.data.y.keys,r.data.legend.names.titleized=r.data.legend.names.keys.map(e=>((e,t)=>(result=e.split(t).map(e=>{let t="";return t+=e.charAt(0).toUpperCase(),t+=e.slice(1).toLowerCase()}).join(" "),result))(e,r.data.legend.text.separater)),r.view.translate.title_and_legend=(e=>{const t=(e,t)=>{let a=document.createElement("div");a.style.position="absolute",a.style.float="left",a.style.whiteSpace="nowrap",a.style.visibility="hidden",a.style.font=e+"px "+t,a.innerHTML=this;let l=(a=document.body.appendChild(a)).offsetWidth;return a.parentNode.removeChild(a),l};let a=e.data.legend.names.titleized.map(a=>t(e.style.font.size.text,e.style.font.family)).map(t=>e.style.legend.rect_size.full+e.style.legend.rect_size.half+t+e.style.legend.padding.after);a.unshift(0);let l=[];return l.push(0),a.forEach(e=>{l.push(l[l.length-1]+e)}),l.shift(0),l})(r),r.view.translate.top_global=Math.floor((r.view.width.inner-r.view.translate.title_and_legend[r.view.translate.title_and_legend.length-1])/2),r})({show:{title:!1,legend:!1,average:!0,range_y_log:!1,data_as_circle:!1},view:{title:"Statosio Demo",dom_id:"d3_statosio",margin:{top:20,right:40,bottom:100,left:60},width:{outer:600,inner:null},height:{outer:300,inner:null},translate:{multiplicator:1.5,title:null,legend:null,title_and_legend:null,top_global:null,legend_text:null}},data:{x:{key:"",selectors:[],text:{length:25,placeholder:"..."}},y:{keys:[],ticks:5},sort:{current:"none",by:{values:"decending",names:"ascending"},selection:"none"},legend:{names:{keys:null,titleized:null},text:{separater:"_"}}},style:{color:{average:"#000000",canvas_background:"white",font:"#000000",legends:["#5186EC","#D95040","#F2BD42"],gridline:"#E5E5E5",selectors:{chart:["#EE752F","#5186EC"],text:["#000000","#000000"]}},font:{size:{text:10,title:18},family:"arial",format:{selectors:["bold","normal"]}},stroke:{average:2,gridline:2},legend:{rect_size:{full:16,half:null},padding:{before:null,after:null}},other:{legend_padding_text_after:null,legend_padding_text_before:null,circle_chart_radius:4,range_x_text_rotation:-45}}},t,l,r),n=((e,t)=>{let a={};return a.type=1!=t.data.y.keys.length?"stacked":"single",a.view=t.show.data_as_circle?"circle":"bar",a.points=((e,t,a)=>{const l=e=>{"true"===e?e=1:!0===e?e=1:"false"===e?e=0:!1===e&&(e=0);let t=parseInt(e);return t=Number.isNaN(t)?0:t};return e.map((e,r)=>{let s={name_full:null,name_trimmed:null,color_chart:null,color_text:null,font_format:null,value:null,average:null};switch(e[t.data.x.key].length>t.data.x.text.length?(s.name_full=e[t.data.x.key],s.name_trimmed=s.name_full.substring(0,t.data.x.text.length)+t.data.x.text.placeholder):(s.name_full=e[t.data.x.key],s.name_trimmed=s.name_full),a.type){case"stacked":let r=[];t.data.y.keys.forEach(t=>{s[t]=l(e[t]),r.push(s[t])}),s.value=r.reduce((e,t)=>e+t);break;case"single":s.value=l(e[t.data.y.keys[0]])}return s.color_chart=t.data.x.selectors.includes(e[t.data.x.key])?t.style.color.selectors.chart[0]:t.style.color.selectors.chart[1],s.color_text=t.data.x.selectors.includes(e[t.data.x.key])?t.style.color.selectors.text[0]:t.style.color.selectors.text[1],s.font_format=t.data.x.selectors.includes(e[t.data.x.key])?t.style.font.format.selectors[0]:t.style.font.format.selectors[1],s})})(e,t,a),a.points=((e,t)=>{if("none"!==e.data.sort.current&&["values","names"].includes(e.data.sort.current))switch(e.data.sort.current){case"values":let a="none"!==e.data.sort.by.values,l=["ascending","decending"].includes(e.data.sort.by.values);if(a&&l)switch(t.sort((e,t)=>parseFloat(e.value)-parseFloat(t.value)),e.data.sort.by.values){case"ascending":break;case"decending":t.reverse()}break;case"names":let r="none"!==e.data.sort.by.names,s=["ascending","decending"].includes(e.data.sort.by.names);if(r&&s)switch(t.sort((e,t)=>e.name_full.localeCompare(t.name_full)),e.data.sort.by.names){case"ascending":break;case"decending":t.reverse()}}if("none"!==e.data.sort.selection&&["start","end"].includes(e.data.sort.selection)){let a=[],l=[],r=e.data.x.selectors;switch(r.forEach(e=>{let s=t.findIndex(t=>t.name_full===e),n=t[s];a.push(n),t.forEach(e=>{!r.includes(e.name_full)&&l.push(e)})}),e.data.sort.selection){case"start":t=a.concat(l);break;case"end":t=l.concat(a)}}return t})(t,a.points),a.average=((e,t)=>{let a=null;if(t.show.average){let l=e.points.map(a=>{let l=null;switch(e.type){case"stacked":l=t.data.y.keys.map(e=>a[e]).reduce((e,t)=>e+t);break;case"single":l=a.value}return l});a=l.reduce((e,t)=>e+t)/l.length,a=Math.round(100*(a+Number.EPSILON))/100}return a})(a,t),a.points.forEach((e,t)=>{a.points[t].average=a.average}),a})(e,s);((e,t,a)=>{((e,t,a)=>{a.grid=document.createElement("div"),a.grid.setAttribute("id",e.view.dom_id),document.body.appendChild(a.grid),a.svg=d3.select("#"+e.view.dom_id).append("svg").attr("width",e.view.width.outer).attr("height",e.view.height.outer).style("background-color",e.style.color.canvas_background).append("g").attr("transform","translate("+e.view.margin.left+","+e.view.margin.top+")"),a.svg.append("g").attr("class","x axis-grid").attr("transform","translate(0,"+e.view.height.inner+")"),a.svg.append("g").call(a.y_axis_grid).selectAll("g.tick").select("line").attr("class","quadrantBorder").style("stroke-width",e.style.stroke.gridline).style("color",e.style.color.gridline),a.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+e.view.height.inner+")").call(a.x_axis_range).selectAll("text").data(t.points).attr("font-family",e.style.font.family).style("fill",e=>e.color_text).attr("font-size",e.style.font.size.text).style("font-weight",e=>e.font_format).style("text-anchor","end").attr("dx","-.8em").attr("dy","-.55em").attr("transform","translate(8,0) rotate("+e.style.other.range_x_text_rotation+")"),a.svg.append("g").attr("class","y axis").call(a.y_axis_range).selectAll("text").attr("font-family",e.style.font.family).style("fill",e.style.color.font).attr("font-size",e.style.font.size.text),document.querySelectorAll("g.y.axis g.tick line").forEach(e=>{e.remove()}),document.querySelectorAll("g.x.axis g.tick line").forEach(e=>{e.remove()}),document.querySelectorAll(".domain").forEach(e=>{e.remove()})})(e,t,a),((e,t,a)=>{switch(t.type){case"single":switch(t.view){case"bar":a.svg.selectAll("bar").data(t.points).enter().append("rect").attr("class","bar").style("fill",e=>e.color_chart).attr("x",e=>a.x(e.name_trimmed)).attr("transform","translate(3,0)").attr("width",a.x.bandwidth()-6).attr("y",e=>a.y(e.value)).attr("height",t=>e.view.height.inner-a.y(t.value));break;case"circle":a.svg.selectAll("circle").data(t.points).enter().append("circle").style("stroke-width",0).style("fill",e=>e.color_chart).attr("transform","translate("+a.x.bandwidth()/2+",0)").attr("r",e.style.other.circle_chart_radius).attr("cx",e=>a.x(e.name_trimmed)).attr("cy",e=>a.y(e.value))}break;case"stacked":let l=d3.scaleOrdinal().domain(e.data.legend.names.keys).range(e.style.color.legends),r=d3.stack().keys(e.data.legend.names.keys)(t.points);a.svg.append("g").selectAll("g").data(r).enter().append("g").attr("fill",e=>l(e.key)).selectAll("rect").data(e=>e).enter().append("rect").attr("x",e=>a.x(e.data.name_trimmed)).attr("y",e=>a.y(e[1])).attr("height",e=>a.y(e[0])-a.y(e[1])).attr("transform","translate(3,0)").attr("width",a.x.bandwidth()-6)}})(e,t,a),((e,t,a)=>{e.show.average&&(a.svg.append("path").datum(t.points).attr("stroke",e.style.color.average).attr("stroke-width",e.style.stroke.average).attr("transform","translate("+a.x.bandwidth()/2+",0)").attr("d",d3.line().x(e=>a.x(e.name_trimmed)).y(e=>a.y(e.average))),a.svg.append("text").attr("font-family",e.style.font.family).style("fill",e.style.color.font).attr("font-size",e.style.font.size.text).attr("transform","translate("+(e.view.width.inner+e.style.legend.padding.before)+","+a.y(t.average)+")").attr("dy",".35em").attr("text-anchor","start").text(t.average))})(e,t,a),((e,t)=>{e.show.title&&t.svg.append("text").attr("x",0).attr("y",e.view.translate.title).style("fill",e.style.color.font).text(e.view.title).attr("font-family",e.style.font.family).attr("font-size",e.style.font.size.title)})(e,a),((e,t)=>{if(e.show.legend){let a=t.svg.selectAll(".legend").data(e.data.legend.names.titleized).enter().append("g").attr("transform",(t,a)=>"translate("+e.view.translate.title_and_legend[a]+",0)").attr("class","legend");a.append("rect").attr("width",e.style.legend.rect_size.full).attr("height",e.style.legend.rect_size.full).attr("fill",(t,a)=>e.style.color.legends[a]).attr("transform","translate("+e.view.translate.top_global+", -20 )"),a.append("text").attr("font-size",e.style.font.size.text).attr("font-family",e.style.font.family).style("fill",e.style.color.font).attr("x",e.style.legend.rect_size.full).attr("y",e.view.translate.legend_text).text(e=>e).attr("transform","translate("+(e.view.translate.top_global+e.style.legend.rect_size.half)+", -20 )")}})(e,a)})(s,n,((e,t)=>{let l=((e,t)=>{let l=null;switch(e.type){case"single":l=e.points.map(e=>e.value);break;case"stacked":l=e.points.map(e=>(a=t.data.y.keys.map(t=>e[t]),a.reduce((e,t)=>e+t)))}const r=d3.scaleBand().domain(e.points.map(e=>e.name_trimmed)).range([0,t.view.width.inner]);let s=null,n=[0,1.05*Math.max(...l)];return s=t.show.range_y_log?d3.scaleSqrt().domain(n).range([t.view.height.inner,0]).nice():d3.scaleLinear().domain(n).range([t.view.height.inner,0]).nice(),result={x:r,y:s},result})(t,e);return l.x_axis_range=d3.axisBottom(l.x).ticks(e.data.y.ticks),l.x_axis_range=d3.axisBottom(l.x).ticks(e.data.y.ticks),l.y_axis_range=d3.axisLeft(l.y).ticks(e.data.y.ticks),l.y_axis_grid=d3.axisLeft(l.y).tickSize(-e.view.width.inner).tickFormat("").ticks(e.data.y.ticks),l})(s,n))});
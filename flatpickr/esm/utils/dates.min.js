import{tokenRegex,revFormat,formats}from"./formatting";import{defaults}from"../types/options";import{english}from"../l10n/default";export const createDateFormatter=({config:e=defaults,l10n:t=english,isMobile:n=!1})=>(o,a,r)=>{const s=r||t;return void 0===e.formatDate||n?a.split("").map((t,n,a)=>formats[t]&&"\\"!==a[n-1]?formats[t](o,s,e):"\\"!==t?t:"").join(""):e.formatDate(o,a,s)};export const createDateParser=({config:e=defaults,l10n:t=english})=>(n,o,a,r)=>{if(0!==n&&!n)return;const s=r||t;let i;const f=n;if(n instanceof Date)i=new Date(n.getTime());else if("string"!=typeof n&&void 0!==n.toFixed)i=new Date(n);else if("string"==typeof n){const t=o||(e||defaults).dateFormat,r=String(n).trim();if("today"===r)i=new Date,a=!0;else if(/Z$/.test(r)||/GMT$/.test(r))i=new Date(n);else if(e&&e.parseDate)i=e.parseDate(n,t);else{i=e&&e.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0);let o,a=[];for(let e=0,r=0,f="";e<t.length;e++){const m=t[e],u="\\"===m,g="\\"===t[e-1]||u;if(tokenRegex[m]&&!g){f+=tokenRegex[m];const e=new RegExp(f).exec(n);e&&(o=!0)&&a["Y"!==m?"push":"unshift"]({fn:revFormat[m],val:e[++r]})}else u||(f+=".");a.forEach(({fn:e,val:t})=>i=e(i,t,s)||i)}i=o?i:void 0}}if(i instanceof Date&&!isNaN(i.getTime()))return!0===a&&i.setHours(0,0,0,0),i;e.errorHandler(new Error(`Invalid date provided: ${f}`))};export function compareDates(e,t,n=!0){return!1!==n?new Date(e.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):e.getTime()-t.getTime()};export function compareTimes(e,t){return 3600*(e.getHours()-t.getHours())+60*(e.getMinutes()-t.getMinutes())+e.getSeconds()-t.getSeconds()};export const isBetween=(e,t,n)=>e>Math.min(t,n)&&e<Math.max(t,n);export const duration={DAY:864e5};export function getDefaultHours(e){let t=e.defaultHour,n=e.defaultMinute,o=e.defaultSeconds;if(void 0!==e.minDate){const a=e.minDate.getHours(),r=e.minDate.getMinutes(),s=e.minDate.getSeconds();t<a&&(t=a),t===a&&n<r&&(n=r),t===a&&n===r&&o<s&&(o=e.minDate.getSeconds())}if(void 0!==e.maxDate){const a=e.maxDate.getHours(),r=e.maxDate.getMinutes();(t=Math.min(t,a))===a&&(n=Math.min(r,n)),t===a&&n===r&&(o=e.maxDate.getSeconds())}return{hours:t,minutes:n,seconds:o}};
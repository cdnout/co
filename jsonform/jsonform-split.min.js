!function(e,n,f){e&&!f&&(f=require("underscore"));n.JSONForm=n.JSONForm||{},n.JSONForm.split=function(e,r,u){if(u=u||{},r=r||[],!e||!e.form)return{included:{},excluded:{}};f.isString(r)&&(r=[r]);var i={included:{schema:{properties:{}},form:[]},excluded:{schema:{properties:{}},form:[]}};f.each(e,function(e,n){"schema"!==n&&"form"!==n&&(i.included[n]=e,i.excluded[n]=e)});var d=function(e){return n=e,!!(i=f.isString(n)?n:n.key)&&(f.include(r,i)||!!f.find(r,function(e){return 0===i.indexOf(e+".")||0===i.indexOf(e+"[]")}))||e.items&&!!f.some(e.items,function(e){return d(e)});var n,i},o=function(e){return n=e,!!(i=f.isString(n)?n:n.key)&&(!f.include(r,i)&&!f.find(r,function(e){return 0===i.indexOf(e+".")||0===i.indexOf(e+"[]")}))||e.items&&!!f.some(e.items,function(e){return o(e)});var n,i},c=function(e,n,i){var r=null,i=e.root||"all"===n||i&&i.key&&"selectfieldset"===i.type||e.type&&"help"===e.type;if((i=i||"included"===n&&d(e))||(i="excluded"===n&&o(e))&&!u.excludeCoupledKeys&&(i=!d(e)),!i)return null;var t=n;return"included"!==t||u.excludeCoupledKeys||e.root||(t="all"),(r=f.clone(e)).items&&(r.items=f.map(r.items,function(e){return c(e,t,r)}),r.items=f.compact(r.items)),r},t=function(e,n){return!!e&&(!!n&&(f.isString(e)?e===n||0===e.indexOf(n+".")||0===e.indexOf(n+"[]"):!(!e.key||e.key!==n&&0!==e.key.indexOf(n+".")&&0!==e.key.indexOf(n+"[]"))||!!f.some(e.items,function(e){return t(e,n)})))},n=null;(n=c({items:e.form,root:!0},"included"))&&(i.included.form=n.items),(n=c({items:e.form,root:!0},"excluded"))&&(i.excluded.form=n.items);e=e.schema;return e.properties&&(e=e.properties),f.each(e,function(e,n){f.some(i.included.form,function(e){return t(e,n)})?i.included.schema.properties[n]=e:i.excluded.schema.properties[n]=e}),i}}("undefined"!=typeof exports,"undefined"!=typeof exports?exports:window,"undefined"!=typeof _?_:null);
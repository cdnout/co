import*as React from"react";import View from"../View";import createElement from"../createElement";import StyleSheet from"../StyleSheet";import UIManager from"../UIManager";import ExecutionEnvironment from"fbjs/lib/ExecutionEnvironment";var canUseDOM=ExecutionEnvironment.canUseDOM,FocusBracket=function(){return createElement("div",{accessibilityRole:"none",tabIndex:0,style:styles.focusBracket})};function attemptFocus(e){if(!canUseDOM)return!1;try{e.focus()}catch(e){}return document.activeElement===e}function focusFirstDescendant(e){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(attemptFocus(n)||focusFirstDescendant(n))return!0}return!1}function focusLastDescendant(e){for(var t=e.childNodes.length-1;0<=t;t--){var n=e.childNodes[t];if(attemptFocus(n)||focusLastDescendant(n))return!0}return!1}var ModalFocusTrap=function(e){var t=e.active,e=e.children,n=React.useRef(),c=React.useRef({trapFocusInProgress:!1,lastFocusedElement:null});return React.useEffect(function(){if(canUseDOM){function e(){if(null!=n.current&&!c.current.trapFocusInProgress&&t){try{var e;c.current.trapFocusInProgress=!0,document.activeElement instanceof Node&&!n.current.contains(document.activeElement)&&(e=focusFirstDescendant(n.current),!(e=c.current.lastFocusedElement===document.activeElement?focusLastDescendant(n.current):e)&&null!=n.current&&document.activeElement&&UIManager.focus(n.current))}finally{c.current.trapFocusInProgress=!1}c.current.lastFocusedElement=document.activeElement}}return e(),document.addEventListener("focus",e,!0),function(){return document.removeEventListener("focus",e,!0)}}},[t]),React.useEffect(function(){if(canUseDOM){var e=document.activeElement;return function(){e&&document.contains(e)&&UIManager.focus(e)}}},[]),React.createElement(React.Fragment,null,React.createElement(FocusBracket,null),React.createElement(View,{ref:n},e),React.createElement(FocusBracket,null))};export default ModalFocusTrap;var styles=StyleSheet.create({focusBracket:{outlineStyle:"none"}});
import React,{useRef,useEffect}from"react";import{canUseDOM}from"fbjs/lib/ExecutionEnvironment";import View from"../View";import createElement from"../createElement";import StyleSheet from"../StyleSheet";import UIManager from"../UIManager";var FocusBracket=function(){return createElement("div",{accessibilityRole:"none",tabIndex:0,style:styles.focusBracket})};function attemptFocus(e){if(!canUseDOM)return!1;try{e.focus()}catch(e){}return document.activeElement===e}function focusFirstDescendant(e){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(attemptFocus(n)||focusFirstDescendant(n))return!0}return!1}function focusLastDescendant(e){for(var t=e.childNodes.length-1;t>=0;t--){var n=e.childNodes[t];if(attemptFocus(n)||focusLastDescendant(n))return!0}return!1}var ModalFocusTrap=function(e){var t=e.active,n=e.children,r=useRef(),c=useRef({trapFocusInProgress:!1,lastFocusedElement:null});return useEffect(function(){if(canUseDOM){var e=function(){if(null!=r.current&&!c.current.trapFocusInProgress&&t){try{if(c.current.trapFocusInProgress=!0,document.activeElement instanceof Node&&!r.current.contains(document.activeElement)){var e=focusFirstDescendant(r.current);c.current.lastFocusedElement===document.activeElement&&(e=focusLastDescendant(r.current)),!e&&null!=r.current&&document.activeElement&&UIManager.focus(r.current)}}finally{c.current.trapFocusInProgress=!1}c.current.lastFocusedElement=document.activeElement}};return e(),document.addEventListener("focus",e,!0),function(){return document.removeEventListener("focus",e,!0)}}},[t]),useEffect(function(){if(canUseDOM){var e=document.activeElement;return function(){e&&document.contains(e)&&UIManager.focus(e)}}},[]),React.createElement(React.Fragment,null,React.createElement(FocusBracket,null),React.createElement(View,{ref:r},n),React.createElement(FocusBracket,null))};export default ModalFocusTrap;var styles=StyleSheet.create({focusBracket:{outlineStyle:"none"}});
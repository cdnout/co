import React,{forwardRef,useCallback,useMemo,useEffect,useState}from"react";import ModalPortal from"./ModalPortal";import ModalAnimation from"./ModalAnimation";import ModalContent from"./ModalContent";import ModalFocusTrap from"./ModalFocusTrap";var uniqueModalIdentifier=0,activeModalStack=[],activeModalListeners={};function notifyActiveModalListeners(){if(0!==activeModalStack.length){var e=activeModalStack[activeModalStack.length-1];activeModalStack.forEach(function(t){t in activeModalListeners&&activeModalListeners[t](t===e)})}}function removeActiveModal(e){e in activeModalListeners&&(activeModalListeners[e](!1),delete activeModalListeners[e]);var t=activeModalStack.indexOf(e);-1!==t&&(activeModalStack.splice(t,1),notifyActiveModalListeners())}function addActiveModal(e,t){removeActiveModal(e),activeModalStack.push(e),activeModalListeners[e]=t,notifyActiveModalListeners()}var Modal=forwardRef(function(e,t){var a=e.animationType,o=e.children,i=e.onDismiss,n=e.onRequestClose,c=e.onShow,l=e.transparent,r=e.visible,d=void 0===r||r,s=useMemo(function(){return uniqueModalIdentifier++},[]),M=useState(!1),v=M[0],u=M[1],f=useCallback(function(){removeActiveModal(s),i&&i()},[s,i]),m=useCallback(function(){addActiveModal(s,u),c&&c()},[s,c]);return useEffect(function(){return function(){return removeActiveModal(s)}},[s]),React.createElement(ModalPortal,null,React.createElement(ModalAnimation,{animationType:a,onDismiss:f,onShow:m,visible:d},React.createElement(ModalFocusTrap,{active:v},React.createElement(ModalContent,{active:v,onRequestClose:n,ref:t,transparent:l},o))))});export default Modal;
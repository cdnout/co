function _defineProperties(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}import{canUseDOM}from"fbjs/lib/ExecutionEnvironment";import findIndex from"array-find-index";import invariant from"fbjs/lib/invariant";var isPrefixed=canUseDOM&&!document.hasOwnProperty("hidden")&&document.hasOwnProperty("webkitHidden"),EVENT_TYPES=["change","memoryWarning"],VISIBILITY_CHANGE_EVENT=isPrefixed?"webkitvisibilitychange":"visibilitychange",VISIBILITY_STATE_PROPERTY=isPrefixed?"webkitVisibilityState":"visibilityState",AppStates={BACKGROUND:"background",ACTIVE:"active"},listeners=[],AppState=function(){function e(){}return e.addEventListener=function(n,t){if(e.isAvailable&&(invariant(-1!==EVENT_TYPES.indexOf(n),'Trying to subscribe to unknown event: "%s"',n),"change"===n)){var i=function(){return t(e.currentState)};listeners.push([t,i]),document.addEventListener(VISIBILITY_CHANGE_EVENT,i,!1)}},e.removeEventListener=function(n,t){if(e.isAvailable&&(invariant(-1!==EVENT_TYPES.indexOf(n),'Trying to remove listener for unknown event: "%s"',n),"change"===n)){var i=findIndex(listeners,function(e){return e[0]===t});invariant(-1!==i,"Trying to remove AppState listener for unregistered handler");var r=listeners[i][1];document.removeEventListener(VISIBILITY_CHANGE_EVENT,r,!1),listeners.splice(i,1)}},_createClass(e,null,[{key:"currentState",get:function(){if(!e.isAvailable)return AppStates.ACTIVE;switch(document[VISIBILITY_STATE_PROPERTY]){case"hidden":case"prerender":case"unloaded":return AppStates.BACKGROUND;default:return AppStates.ACTIVE}}}]),e}();AppState.isAvailable=canUseDOM&&document[VISIBILITY_STATE_PROPERTY];export{AppState as default};
function ownKeys(t,e){var o,r=Object.keys(t);return Object.getOwnPropertySymbols&&(o=Object.getOwnPropertySymbols(t),e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,o)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(o),!0).forEach(function(e){_defineProperty(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}function _defineProperty(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}import*as React from"react";import createElement from"../createElement";import*as forwardedProps from"../../modules/forwardedProps";import pick from"../../modules/pick";import useElementLayout from"../../modules/useElementLayout";import useLayoutEffect from"../../modules/useLayoutEffect";import useMergeRefs from"../../modules/useMergeRefs";import usePlatformMethods from"../../modules/usePlatformMethods";import useResponderEvents from"../../modules/useResponderEvents";import{getLocaleDirection,useLocaleContext}from"../../modules/useLocale";import StyleSheet from"../StyleSheet";import TextInputState from"../../modules/TextInputState";var isSelectionStale=function(e,t){var o=e.selectionEnd,r=e.selectionStart,e=t.start,t=t.end;return e!==r||t!==o},setSelection=function(e,t){if(isSelectionStale(e,t)){var o=t.start,t=t.end;try{e.setSelectionRange(o,t||o)}catch(e){}}},forwardPropsList=_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},forwardedProps.defaultProps),forwardedProps.accessibilityProps),forwardedProps.clickProps),forwardedProps.focusProps),forwardedProps.keyboardProps),forwardedProps.mouseProps),forwardedProps.touchProps),forwardedProps.styleProps),{},{autoCapitalize:!0,autoComplete:!0,autoCorrect:!0,autoFocus:!0,defaultValue:!0,disabled:!0,lang:!0,maxLength:!0,onChange:!0,onScroll:!0,placeholder:!0,pointerEvents:!0,readOnly:!0,rows:!0,spellCheck:!0,value:!0,type:!0}),pickProps=function(e){return pick(e,forwardPropsList)};function isEventComposing(e){return e.isComposing||229===e.keyCode}var focusTimeout=null,TextInput=React.forwardRef(function(e,t){var o,r,n=e.autoCapitalize,a=void 0===n?"sentences":n,l=e.autoComplete,u=e.autoCompleteType,s=e.autoCorrect,i=void 0===s||s,c=e.blurOnSubmit,d=e.clearTextOnFocus,p=e.dir,f=e.editable,S=void 0===f||f,m=e.keyboardType,h=e.multiline,v=void 0!==h&&h,y=e.numberOfLines,b=void 0===y?1:y,R=e.onBlur,g=e.onChange,C=e.onChangeText,P=e.onContentSizeChange,w=e.onFocus,x=e.onKeyPress,T=e.onLayout,E=e.onMoveShouldSetResponder,j=e.onMoveShouldSetResponderCapture,k=e.onResponderEnd,O=e.onResponderGrant,L=e.onResponderMove,M=e.onResponderReject,_=e.onResponderRelease,I=e.onResponderStart,F=e.onResponderTerminate,D=e.onResponderTerminationRequest,z=e.onScrollShouldSetResponder,K=e.onScrollShouldSetResponderCapture,N=e.onSelectionChange,q=e.onSelectionChangeShouldSetResponder,A=e.onSelectionChangeShouldSetResponderCapture,B=e.onStartShouldSetResponder,n=e.onStartShouldSetResponderCapture,G=e.onSubmitEditing,s=e.placeholderTextColor,f=e.returnKeyType,h=e.secureTextEntry,y=void 0!==h&&h,H=e.selection,W=e.selectTextOnFocus,h=e.spellCheck;switch(void 0===m?"default":m){case"email-address":o="email";break;case"number-pad":case"numeric":r="numeric";break;case"decimal-pad":r="decimal";break;case"phone-pad":o="tel";break;case"search":case"web-search":o="search";break;case"url":o="url";break;default:o="text"}y&&(o="password");var $=React.useRef({height:null,width:null}),V=React.useRef(null),J=React.useCallback(function(e){var t;v&&P&&null!=e&&(t=e.scrollHeight,e=e.scrollWidth,t===$.current.height&&e===$.current.width||($.current.height=t,$.current.width=e,P({nativeEvent:{contentSize:{height:$.current.height,width:$.current.width}}})))},[v,P]),m=React.useMemo(function(){return function(e){null!=e&&(e.clear=function(){null!=e&&(e.value="")},e.isFocused=function(){return null!=e&&TextInputState.currentlyFocusedField()===e},J(e))}},[J]);useLayoutEffect(function(){var e=V.current;null!=e&&null!=H&&setSelection(e,H),document.activeElement===e&&(TextInputState._currentlyFocusedNode=e)},[V,H]);y=v?"textarea":"input";useElementLayout(V,T),useResponderEvents(V,{onMoveShouldSetResponder:E,onMoveShouldSetResponderCapture:j,onResponderEnd:k,onResponderGrant:O,onResponderMove:L,onResponderReject:M,onResponderRelease:_,onResponderStart:I,onResponderTerminate:F,onResponderTerminationRequest:D,onScrollShouldSetResponder:z,onScrollShouldSetResponderCapture:K,onSelectionChangeShouldSetResponder:q,onSelectionChangeShouldSetResponderCapture:A,onStartShouldSetResponder:B,onStartShouldSetResponderCapture:n});B=useLocaleContext().direction,n=pickProps(e);n.autoCapitalize=a,n.autoComplete=l||u||"on",n.autoCorrect=i?"on":"off",n.dir=void 0!==p?p:"auto",n.enterKeyHint=f,n.inputMode=r,n.onBlur=function(e){TextInputState._currentlyFocusedNode=null,R&&(e.nativeEvent.text=e.target.value,R(e))},n.onChange=function(e){var t=e.target,o=t.value;e.nativeEvent.text=o,J(t),g&&g(e),C&&C(o)},n.onFocus=function(e){var t=e.target;w&&(e.nativeEvent.text=t.value,w(e)),null!=t&&(TextInputState._currentlyFocusedNode=t,d&&(t.value=""),W&&(null!=focusTimeout&&clearTimeout(focusTimeout),focusTimeout=setTimeout(function(){null!=t&&t.select()},0)))},n.onKeyDown=function(e){var t=e.target;e.stopPropagation();var o=null==c?!v:c,r=e.nativeEvent,n=isEventComposing(r);x&&x(e),"Enter"!==e.key||e.shiftKey||n||e.isDefaultPrevented()||(!c&&v||!G||(e.preventDefault(),r.text=e.target.value,G(e)),o&&null!=t&&t.blur())},n.onSelect=function(e){if(N)try{var t=e.target,o=t.selectionStart,r=t.selectionEnd;e.nativeEvent.selection={start:o,end:r},e.nativeEvent.text=e.target.value,N(e)}catch(e){}},n.readOnly=!S,n.rows=v?b:void 0,n.spellCheck=null!=h?h:i,n.style=[{"--placeholderTextColor":s},styles.textinput$raw,styles.placeholder,e.style],n.type=v?void 0:o;s=usePlatformMethods(n),t=useMergeRefs(V,s,m,t);n.ref=t;t=null!=e.lang?getLocaleDirection(e.lang):null,B=e.dir||t||B;return createElement(y,n,{writingDirection:B})});TextInput.displayName="TextInput",TextInput.State=TextInputState;var styles=StyleSheet.create({textinput$raw:{MozAppearance:"textfield",WebkitAppearance:"none",backgroundColor:"transparent",border:"0 solid black",borderRadius:0,boxSizing:"border-box",font:"14px System",margin:0,padding:0,resize:"none"},placeholder:{placeholderTextColor:"var(--placeholderTextColor)"}});export default TextInput;
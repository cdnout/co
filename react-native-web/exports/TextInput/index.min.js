function ownKeys(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,r)}return o}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(o),!0).forEach(function(t){_defineProperty(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function _defineProperty(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}import{forwardRef,useCallback,useMemo,useRef}from"react";import createElement from"../createElement";import css from"../StyleSheet/css";import*as forwardedProps from"../../modules/forwardedProps";import pick from"../../modules/pick";import useElementLayout from"../../modules/useElementLayout";import useLayoutEffect from"../../modules/useLayoutEffect";import useMergeRefs from"../../modules/useMergeRefs";import usePlatformMethods from"../../modules/usePlatformMethods";import useResponderEvents from"../../modules/useResponderEvents";import StyleSheet from"../StyleSheet";import TextInputState from"../../modules/TextInputState";var isSelectionStale=function(e,t){var o=e.selectionEnd,r=e.selectionStart,n=t.start,a=t.end;return n!==r||a!==o},setSelection=function(e,t){if(isSelectionStale(e,t)){var o=t.start,r=t.end;try{e.setSelectionRange(o,r||o)}catch(e){}}},forwardPropsList=_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},forwardedProps.defaultProps),forwardedProps.accessibilityProps),forwardedProps.clickProps),forwardedProps.focusProps),forwardedProps.keyboardProps),forwardedProps.mouseProps),forwardedProps.touchProps),forwardedProps.styleProps),{},{autoCapitalize:!0,autoComplete:!0,autoCorrect:!0,autoFocus:!0,defaultValue:!0,disabled:!0,lang:!0,maxLength:!0,onChange:!0,onScroll:!0,placeholder:!0,pointerEvents:!0,readOnly:!0,rows:!0,spellCheck:!0,value:!0,type:!0}),pickProps=function(e){return pick(e,forwardPropsList)};function isEventComposing(e){return e.isComposing||229===e.keyCode}var TextInput=forwardRef(function(e,t){var o,r,n=e.autoCapitalize,a=void 0===n?"sentences":n,s=e.autoComplete,u=e.autoCompleteType,l=e.autoCorrect,c=void 0===l||l,d=e.blurOnSubmit,i=e.clearTextOnFocus,p=e.dir,f=e.editable,S=void 0===f||f,m=e.keyboardType,h=void 0===m?"default":m,v=e.multiline,y=void 0!==v&&v,b=e.numberOfLines,R=void 0===b?1:b,g=e.onBlur,C=e.onChange,P=e.onChangeText,w=e.onContentSizeChange,x=e.onFocus,E=e.onKeyPress,T=e.onLayout,k=e.onMoveShouldSetResponder,j=e.onMoveShouldSetResponderCapture,O=e.onResponderEnd,M=e.onResponderGrant,_=e.onResponderMove,I=e.onResponderReject,L=e.onResponderRelease,F=e.onResponderStart,z=e.onResponderTerminate,K=e.onResponderTerminationRequest,D=e.onScrollShouldSetResponder,N=e.onScrollShouldSetResponderCapture,q=e.onSelectionChange,A=e.onSelectionChangeShouldSetResponder,B=e.onSelectionChangeShouldSetResponderCapture,G=e.onStartShouldSetResponder,H=e.onStartShouldSetResponderCapture,W=e.onSubmitEditing,V=e.placeholderTextColor,J=e.returnKeyType,Q=e.secureTextEntry,U=void 0!==Q&&Q,X=e.selection,Y=e.selectTextOnFocus,Z=e.spellCheck;switch(h){case"email-address":o="email";break;case"number-pad":case"numeric":r="numeric";break;case"decimal-pad":r="decimal";break;case"phone-pad":o="tel";break;case"search":case"web-search":o="search";break;case"url":o="url";break;default:o="text"}U&&(o="password");var $=useRef({height:null,width:null}),ee=useRef(null),te=useCallback(function(){var e=ee.current;if(y&&w&&null!=e){var t=e.scrollHeight,o=e.scrollWidth;t===$.current.height&&o===$.current.width||($.current.height=t,$.current.width=o,w({nativeEvent:{contentSize:{height:$.current.height,width:$.current.width}}}))}},[ee,y,w]),oe=useMemo(function(){return function(e){null!=e&&(e.clear=function(){null!=e&&(e.value="")},e.isFocused=function(){return null!=e&&TextInputState.currentlyFocusedField()===e},te())}},[te]);useLayoutEffect(function(){var e=ee.current;null!=e&&null!=X&&setSelection(e,X),document.activeElement===e&&(TextInputState._currentlyFocusedNode=e)},[ee,X]);var re=y?"textarea":"input",ne=[classes.textinput],ae=StyleSheet.compose(e.style,V&&{placeholderTextColor:V});useElementLayout(ee,T),useResponderEvents(ee,{onMoveShouldSetResponder:k,onMoveShouldSetResponderCapture:j,onResponderEnd:O,onResponderGrant:M,onResponderMove:_,onResponderReject:I,onResponderRelease:L,onResponderStart:F,onResponderTerminate:z,onResponderTerminationRequest:K,onScrollShouldSetResponder:D,onScrollShouldSetResponderCapture:N,onSelectionChangeShouldSetResponder:A,onSelectionChangeShouldSetResponderCapture:B,onStartShouldSetResponder:G,onStartShouldSetResponderCapture:H});var se=pickProps(e);se.autoCapitalize=a,se.autoComplete=s||u||"on",se.autoCorrect=c?"on":"off",se.classList=ne,se.dir=void 0!==p?p:"auto",se.enterKeyHint=J,se.onBlur=function(e){TextInputState._currentlyFocusedNode=null,g&&(e.nativeEvent.text=e.target.value,g(e))},se.onChange=function(e){var t=e.target.value;e.nativeEvent.text=t,te(),C&&C(e),P&&P(t)},se.onFocus=function(e){var t=ee.current;null!=t&&(TextInputState._currentlyFocusedNode=t,x&&(e.nativeEvent.text=e.target.value,x(e)),i&&(t.value=""),Y&&setTimeout(function(){t.select()},0))},se.onKeyDown=function(e){e.stopPropagation();var t=null==d?!y:d,o=e.nativeEvent,r=isEventComposing(o);E&&E(e),"Enter"!==e.key||e.shiftKey||r||e.isDefaultPrevented()||(!d&&y||!W||(e.preventDefault(),o.text=e.target.value,W(e)),t&&null!=ee.current&&ee.current.blur())},se.onSelect=function(e){if(q)try{var t=e.target,o=t.selectionStart,r=t.selectionEnd;e.nativeEvent.selection={start:o,end:r},e.nativeEvent.text=e.target.value,q(e)}catch(e){}},se.readOnly=!S,se.rows=y?R:void 0,se.spellCheck=null!=Z?Z:c,se.style=ae,se.type=y?void 0:o,se.inputMode=r;var ue=usePlatformMethods(se),le=useMergeRefs(ee,ue,oe,t);return se.ref=le,createElement(re,se)});TextInput.displayName="TextInput",TextInput.State=TextInputState;var classes=css.create({textinput:{MozAppearance:"textfield",WebkitAppearance:"none",backgroundColor:"transparent",border:"0 solid black",borderRadius:0,boxSizing:"border-box",font:"14px System",margin:0,padding:0,resize:"none"}});export default TextInput;
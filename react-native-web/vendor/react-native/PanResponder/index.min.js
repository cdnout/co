"use strict";import InteractionManager from"../../../exports/InteractionManager";import TouchHistoryMath from"../TouchHistoryMath";var currentCentroidXOfTouchesChangedAfter=TouchHistoryMath.currentCentroidXOfTouchesChangedAfter,currentCentroidYOfTouchesChangedAfter=TouchHistoryMath.currentCentroidYOfTouchesChangedAfter,previousCentroidXOfTouchesChangedAfter=TouchHistoryMath.previousCentroidXOfTouchesChangedAfter,previousCentroidYOfTouchesChangedAfter=TouchHistoryMath.previousCentroidYOfTouchesChangedAfter,currentCentroidX=TouchHistoryMath.currentCentroidX,currentCentroidY=TouchHistoryMath.currentCentroidY,PanResponder={_initializeGestureState:function(e){e.moveX=0,e.moveY=0,e.x0=0,e.y0=0,e.dx=0,e.dy=0,e.vx=0,e.vy=0,e.numberActiveTouches=0,e._accountsForMovesUpTo=0},_updateGestureStateOnMove:function(e,n){e.numberActiveTouches=n.numberActiveTouches,e.moveX=currentCentroidXOfTouchesChangedAfter(n,e._accountsForMovesUpTo),e.moveY=currentCentroidYOfTouchesChangedAfter(n,e._accountsForMovesUpTo);var o=e._accountsForMovesUpTo,t=previousCentroidXOfTouchesChangedAfter(n,o),r=currentCentroidXOfTouchesChangedAfter(n,o),a=previousCentroidYOfTouchesChangedAfter(n,o),o=currentCentroidYOfTouchesChangedAfter(n,o),t=e.dx+(r-t),o=e.dy+(o-a),a=n.mostRecentTimeStamp-e._accountsForMovesUpTo;e.vx=(t-e.dx)/a,e.vy=(o-e.dy)/a,e.dx=t,e.dy=o,e._accountsForMovesUpTo=n.mostRecentTimeStamp},create:function(o){var t={handle:null,shouldCancelClick:!1,timeout:null},r={stateID:Math.random(),moveX:0,moveY:0,x0:0,y0:0,dx:0,dy:0,vx:0,vy:0,numberActiveTouches:0,_accountsForMovesUpTo:0};return{panHandlers:{onStartShouldSetResponder:function(e){return null!=o.onStartShouldSetPanResponder&&o.onStartShouldSetPanResponder(e,r)},onMoveShouldSetResponder:function(e){return null!=o.onMoveShouldSetPanResponder&&o.onMoveShouldSetPanResponder(e,r)},onStartShouldSetResponderCapture:function(e){return 1===e.nativeEvent.touches.length&&PanResponder._initializeGestureState(r),r.numberActiveTouches=e.touchHistory.numberActiveTouches,null!=o.onStartShouldSetPanResponderCapture&&o.onStartShouldSetPanResponderCapture(e,r)},onMoveShouldSetResponderCapture:function(e){var n=e.touchHistory;return r._accountsForMovesUpTo!==n.mostRecentTimeStamp&&(PanResponder._updateGestureStateOnMove(r,n),!!o.onMoveShouldSetPanResponderCapture&&o.onMoveShouldSetPanResponderCapture(e,r))},onResponderGrant:function(e){return t.handle||(t.handle=InteractionManager.createInteractionHandle()),t.timeout&&clearInteractionTimeout(t),t.shouldCancelClick=!0,r.x0=currentCentroidX(e.touchHistory),r.y0=currentCentroidY(e.touchHistory),r.dx=0,r.dy=0,o.onPanResponderGrant&&o.onPanResponderGrant(e,r),null==o.onShouldBlockNativeResponder||o.onShouldBlockNativeResponder(e,r)},onResponderReject:function(e){clearInteractionHandle(t,o.onPanResponderReject,e,r)},onResponderRelease:function(e){clearInteractionHandle(t,o.onPanResponderRelease,e,r),setInteractionTimeout(t),PanResponder._initializeGestureState(r)},onResponderStart:function(e){var n=e.touchHistory;r.numberActiveTouches=n.numberActiveTouches,o.onPanResponderStart&&o.onPanResponderStart(e,r)},onResponderMove:function(e){var n=e.touchHistory;r._accountsForMovesUpTo!==n.mostRecentTimeStamp&&(PanResponder._updateGestureStateOnMove(r,n),o.onPanResponderMove&&o.onPanResponderMove(e,r))},onResponderEnd:function(e){var n=e.touchHistory;r.numberActiveTouches=n.numberActiveTouches,clearInteractionHandle(t,o.onPanResponderEnd,e,r)},onResponderTerminate:function(e){clearInteractionHandle(t,o.onPanResponderTerminate,e,r),setInteractionTimeout(t),PanResponder._initializeGestureState(r)},onResponderTerminationRequest:function(e){return null==o.onPanResponderTerminationRequest||o.onPanResponderTerminationRequest(e,r)},onClickCapture:function(e){!0===t.shouldCancelClick&&(e.stopPropagation(),e.preventDefault())}},getInteractionHandle:function(){return t.handle}}}};function clearInteractionHandle(e,n,o,t){e.handle&&(InteractionManager.clearInteractionHandle(e.handle),e.handle=null),n&&n(o,t)}function clearInteractionTimeout(e){clearTimeout(e.timeout)}function setInteractionTimeout(e){e.timeout=setTimeout(function(){e.shouldCancelClick=!1},250)}export default PanResponder;
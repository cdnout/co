import NativeAnimatedNonTurboModule from"./NativeAnimatedModule";import NativeAnimatedTurboModule from"./NativeAnimatedTurboModule";import NativeEventEmitter from"../NativeEventEmitter";import Platform from"../../../exports/Platform";import invariant from"fbjs/lib/invariant";var nativeEventEmitter,NativeAnimatedModule="ios"===Platform.OS&&global.RN$Bridgeless?NativeAnimatedTurboModule:NativeAnimatedNonTurboModule,__nativeAnimatedNodeTagCount=1,__nativeAnimationIdCount=1,waitingForQueuedOperations=new Set,queueOperations=!1,queue=[],API={getValue:function(e,t){invariant(NativeAnimatedModule,"Native animated module is not available"),NativeAnimatedModule.getValue&&NativeAnimatedModule.getValue(e,t)},setWaitingForIdentifier:function(e){waitingForQueuedOperations.add(e),queueOperations=!0},unsetWaitingForIdentifier:function(e){waitingForQueuedOperations.delete(e),0===waitingForQueuedOperations.size&&(queueOperations=!1,API.disableQueue())},disableQueue:function(){invariant(NativeAnimatedModule,"Native animated module is not available"),"android"===Platform.OS&&NativeAnimatedModule.startOperationBatch();for(var e=0,t=queue.length;e<t;e++)queue[e]();queue.length=0,"android"===Platform.OS&&NativeAnimatedModule.finishOperationBatch()},queueOperation:function(e){queueOperations?queue.push(e):e()},createAnimatedNode:function(e,t){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.createAnimatedNode(e,t)})},startListeningToAnimatedNodeValue:function(e){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.startListeningToAnimatedNodeValue(e)})},stopListeningToAnimatedNodeValue:function(e){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.stopListeningToAnimatedNodeValue(e)})},connectAnimatedNodes:function(e,t){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.connectAnimatedNodes(e,t)})},disconnectAnimatedNodes:function(e,t){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.disconnectAnimatedNodes(e,t)})},startAnimatingNode:function(e,t,a,i){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.startAnimatingNode(e,t,a,i)})},stopAnimation:function(e){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.stopAnimation(e)})},setAnimatedNodeValue:function(e,t){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.setAnimatedNodeValue(e,t)})},setAnimatedNodeOffset:function(e,t){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.setAnimatedNodeOffset(e,t)})},flattenAnimatedNodeOffset:function(e){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.flattenAnimatedNodeOffset(e)})},extractAnimatedNodeOffset:function(e){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.extractAnimatedNodeOffset(e)})},connectAnimatedNodeToView:function(e,t){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.connectAnimatedNodeToView(e,t)})},disconnectAnimatedNodeFromView:function(e,t){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.disconnectAnimatedNodeFromView(e,t)})},restoreDefaultValues:function(e){invariant(NativeAnimatedModule,"Native animated module is not available"),null!=NativeAnimatedModule.restoreDefaultValues&&API.queueOperation(function(){return NativeAnimatedModule.restoreDefaultValues(e)})},dropAnimatedNode:function(e){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.dropAnimatedNode(e)})},addAnimatedEventToView:function(e,t,a){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.addAnimatedEventToView(e,t,a)})},removeAnimatedEventFromView:function(e,t,a){invariant(NativeAnimatedModule,"Native animated module is not available"),API.queueOperation(function(){return NativeAnimatedModule.removeAnimatedEventFromView(e,t,a)})}},SUPPORTED_STYLES={opacity:!0,transform:!0,borderRadius:!0,borderBottomEndRadius:!0,borderBottomLeftRadius:!0,borderBottomRightRadius:!0,borderBottomStartRadius:!0,borderTopEndRadius:!0,borderTopLeftRadius:!0,borderTopRightRadius:!0,borderTopStartRadius:!0,elevation:!0,zIndex:!0,shadowOpacity:!0,shadowRadius:!0,scaleX:!0,scaleY:!0,translateX:!0,translateY:!0},SUPPORTED_TRANSFORMS={translateX:!0,translateY:!0,scale:!0,scaleX:!0,scaleY:!0,rotate:!0,rotateX:!0,rotateY:!0,rotateZ:!0,perspective:!0},SUPPORTED_INTERPOLATION_PARAMS={inputRange:!0,outputRange:!0,extrapolate:!0,extrapolateRight:!0,extrapolateLeft:!0};function addWhitelistedStyleProp(e){SUPPORTED_STYLES[e]=!0}function addWhitelistedTransformProp(e){SUPPORTED_TRANSFORMS[e]=!0}function addWhitelistedInterpolationParam(e){SUPPORTED_INTERPOLATION_PARAMS[e]=!0}function validateTransform(e){e.forEach(function(e){if(!SUPPORTED_TRANSFORMS.hasOwnProperty(e.property))throw new Error("Property '"+e.property+"' is not supported by native animated module")})}function validateStyles(e){for(var t in e)if(!SUPPORTED_STYLES.hasOwnProperty(t))throw new Error("Style property '"+t+"' is not supported by native animated module")}function validateInterpolation(e){for(var t in e)if(!SUPPORTED_INTERPOLATION_PARAMS.hasOwnProperty(t))throw new Error("Interpolation property '"+t+"' is not supported by native animated module")}function generateNewNodeTag(){return __nativeAnimatedNodeTagCount++}function generateNewAnimationId(){return __nativeAnimationIdCount++}function assertNativeAnimatedModule(){invariant(NativeAnimatedModule,"Native animated module is not available")}var _warnedMissingNativeAnimated=!1;function shouldUseNativeDriver(e){return null==e.useNativeDriver&&console.warn("Animated: `useNativeDriver` was not specified. This is a required option and must be explicitly set to `true` or `false`"),!0!==e.useNativeDriver||NativeAnimatedModule?e.useNativeDriver||!1:(_warnedMissingNativeAnimated||(console.warn("Animated: `useNativeDriver` is not supported because the native animated module is missing. Falling back to JS-based animation. To resolve this, add `RCTAnimation` module to this app, or remove `useNativeDriver`. Make sure to run `pod install` first. Read more about autolinking: https://github.com/react-native-community/cli/blob/master/docs/autolinking.md"),_warnedMissingNativeAnimated=!0),!1)}function transformDataType(e){return"string"==typeof e&&/deg$/.test(e)?(parseFloat(e)||0)*Math.PI/180:e}export default{API:API,addWhitelistedStyleProp:addWhitelistedStyleProp,addWhitelistedTransformProp:addWhitelistedTransformProp,addWhitelistedInterpolationParam:addWhitelistedInterpolationParam,validateStyles:validateStyles,validateTransform:validateTransform,validateInterpolation:validateInterpolation,generateNewNodeTag:generateNewNodeTag,generateNewAnimationId:generateNewAnimationId,assertNativeAnimatedModule:assertNativeAnimatedModule,shouldUseNativeDriver:shouldUseNativeDriver,transformDataType:transformDataType,get nativeEventEmitter(){return nativeEventEmitter=nativeEventEmitter||new NativeEventEmitter(NativeAnimatedModule)}};export{generateNewAnimationId,shouldUseNativeDriver};
"use strict";exports.__esModule=!0,exports.default=void 0;var _createReactClass=_interopRequireDefault(require("create-react-class")),_dismissKeyboard=_interopRequireDefault(require("../../modules/dismissKeyboard")),_invariant=_interopRequireDefault(require("fbjs/lib/invariant")),_mergeRefs=_interopRequireDefault(require("../../modules/mergeRefs")),_ScrollResponder=_interopRequireDefault(require("../../modules/ScrollResponder")),_ScrollViewBase=_interopRequireDefault(require("./ScrollViewBase")),_StyleSheet=_interopRequireDefault(require("../StyleSheet")),_View=_interopRequireDefault(require("../View")),_react=_interopRequireDefault(require("react"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ownKeys(r,e){var t,o=Object.keys(r);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(r),e&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),o.push.apply(o,t)),o}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(e){_defineProperty(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _extends(){return(_extends=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t,o=arguments[r];for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])}return e}).apply(this,arguments)}function _objectWithoutPropertiesLoose(e,r){if(null==e)return{};for(var t,o={},n=Object.keys(e),l=0;l<n.length;l++)t=n[l],0<=r.indexOf(t)||(o[t]=e[t]);return o}var emptyObject={},ScrollView=(0,_createReactClass.default)({displayName:"ScrollView",mixins:[_ScrollResponder.default.Mixin],getInitialState:function(){return this.scrollResponderMixinGetInitialState()},flashScrollIndicators:function(){this.scrollResponderFlashScrollIndicators()},getScrollResponder:function(){return this},getScrollableNode:function(){return this._scrollNodeRef},getInnerViewRef:function(){return this._innerViewRef},getInnerViewNode:function(){return this._innerViewRef},getNativeScrollRef:function(){return this._scrollNodeRef},scrollTo:function(e,r,t){var o;"number"==typeof e?console.warn("`scrollTo(y, x, animated)` is deprecated. Use `scrollTo({x: 5, y: 5, animated: true})` instead."):(r=(o=e||emptyObject).x,e=o.y,t=o.animated),this.getScrollResponder().scrollResponderScrollTo({x:r||0,y:e||0,animated:!1!==t})},scrollToEnd:function(e){var r=!1!==(e&&e.animated),t=this.props.horizontal,o=this.getScrollResponder(),n=o.scrollResponderGetScrollableNode(),e=t?n.scrollWidth:0,n=t?0:n.scrollHeight;o.scrollResponderScrollTo({x:e,y:n,animated:r})},render:function(){var r,e=this.props,t=e.contentContainerStyle,o=e.horizontal,n=e.onContentSizeChange,l=e.refreshControl,s=e.stickyHeaderIndices,i=e.pagingEnabled,e=(e.forwardedRef,e.keyboardDismissMode,e.onScroll,_objectWithoutPropertiesLoose(e,["contentContainerStyle","horizontal","onContentSizeChange","refreshControl","stickyHeaderIndices","pagingEnabled","forwardedRef","keyboardDismissMode","onScroll"]));"production"!==process.env.NODE_ENV&&this.props.style&&(r=_StyleSheet.default.flatten(this.props.style),a=["alignItems","justifyContent"].filter(function(e){return r&&void 0!==r[e]}),(0,_invariant.default)(0===a.length,"ScrollView child layout ("+JSON.stringify(a)+") must be applied through the contentContainerStyle prop."));var a={};n&&(a={onLayout:this._handleContentOnLayout});var c=!o&&Array.isArray(s),n=c||i?_react.default.Children.map(this.props.children,function(e,r){r=c&&-1<s.indexOf(r);return null!=e&&(r||i)?_react.default.createElement(_View.default,{style:_StyleSheet.default.compose(r&&styles.stickyHeader,i&&styles.pagingEnabledChild)},e):e}):this.props.children,n=_react.default.createElement(_View.default,_extends({},a,{children:n,collapsable:!1,ref:this._setInnerViewRef,style:_StyleSheet.default.compose(o&&styles.contentContainerHorizontal,t)})),t=o?styles.baseHorizontal:styles.baseVertical,o=o?styles.pagingEnabledHorizontal:styles.pagingEnabledVertical,t=_objectSpread(_objectSpread({},e),{},{style:[t,i&&o,this.props.style],onTouchStart:this.scrollResponderHandleTouchStart,onTouchMove:this.scrollResponderHandleTouchMove,onTouchEnd:this.scrollResponderHandleTouchEnd,onScrollBeginDrag:this.scrollResponderHandleScrollBeginDrag,onScrollEndDrag:this.scrollResponderHandleScrollEndDrag,onMomentumScrollBegin:this.scrollResponderHandleMomentumScrollBegin,onMomentumScrollEnd:this.scrollResponderHandleMomentumScrollEnd,onStartShouldSetResponder:this.scrollResponderHandleStartShouldSetResponder,onStartShouldSetResponderCapture:this.scrollResponderHandleStartShouldSetResponderCapture,onScrollShouldSetResponder:this.scrollResponderHandleScrollShouldSetResponder,onScroll:this._handleScroll,onResponderGrant:this.scrollResponderHandleResponderGrant,onResponderTerminationRequest:this.scrollResponderHandleTerminationRequest,onResponderTerminate:this.scrollResponderHandleTerminate,onResponderRelease:this.scrollResponderHandleResponderRelease,onResponderReject:this.scrollResponderHandleResponderReject}),o=_ScrollViewBase.default;(0,_invariant.default)(void 0!==o,"ScrollViewClass must not be undefined");n=_react.default.createElement(o,_extends({},t,{ref:this._setScrollNodeRef}),n);return l?_react.default.cloneElement(l,{style:t.style},n):n},_handleContentOnLayout:function(e){var r=e.nativeEvent.layout,e=r.width,r=r.height;this.props.onContentSizeChange(e,r)},_handleScroll:function(e){"production"!==process.env.NODE_ENV&&this.props.onScroll&&null==this.props.scrollEventThrottle&&console.log("You specified `onScroll` on a <ScrollView> but not `scrollEventThrottle`. You will only receive one event. Using `16` you get all the events but be aware that it may cause frame drops, use a bigger number if you don't need as much precision."),"on-drag"===this.props.keyboardDismissMode&&(0,_dismissKeyboard.default)(),this.scrollResponderHandleScroll(e)},_setInnerViewRef:function(e){this._innerViewRef=e},_setScrollNodeRef:function(e){null!=(this._scrollNodeRef=e)&&(e.getScrollResponder=this.getScrollResponder,e.getInnerViewNode=this.getInnerViewNode,e.getInnerViewRef=this.getInnerViewRef,e.getNativeScrollRef=this.getNativeScrollRef,e.getScrollableNode=this.getScrollableNode,e.scrollTo=this.scrollTo,e.scrollToEnd=this.scrollToEnd,e.flashScrollIndicators=this.flashScrollIndicators,e.scrollResponderZoomTo=this.scrollResponderZoomTo,e.scrollResponderScrollNativeHandleToKeyboard=this.scrollResponderScrollNativeHandleToKeyboard),(0,_mergeRefs.default)(this.props.forwardedRef)(e)}}),commonStyle={flexGrow:1,flexShrink:1,transform:[{translateZ:0}],WebkitOverflowScrolling:"touch"},styles=_StyleSheet.default.create({baseVertical:_objectSpread(_objectSpread({},commonStyle),{},{flexDirection:"column",overflowX:"hidden",overflowY:"auto"}),baseHorizontal:_objectSpread(_objectSpread({},commonStyle),{},{flexDirection:"row",overflowX:"auto",overflowY:"hidden"}),contentContainerHorizontal:{flexDirection:"row"},stickyHeader:{position:"sticky",top:0,zIndex:10},pagingEnabledHorizontal:{scrollSnapType:"x mandatory"},pagingEnabledVertical:{scrollSnapType:"y mandatory"},pagingEnabledChild:{scrollSnapAlign:"start"}}),ForwardedScrollView=_react.default.forwardRef(function(e,r){return _react.default.createElement(ScrollView,_extends({},e,{forwardedRef:r}))});ForwardedScrollView.displayName="ScrollView";var _default=ForwardedScrollView;exports.default=_default,module.exports=exports.default;
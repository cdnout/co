"use strict";exports.__esModule=!0,exports.default=void 0;var _compiler=require("./compiler"),_dom=require("./dom"),_transformLocalizeStyle=require("styleq/dist/transform-localize-style"),_preprocess=require("./preprocess"),_styleq=require("styleq"),_validate=require("./validate"),_ExecutionEnvironment=_interopRequireDefault(require("fbjs/lib/ExecutionEnvironment"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ownKeys(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var canUseDOM=_ExecutionEnvironment.default.canUseDOM,staticStyleMap=new WeakMap,sheet=(0,_dom.createSheet)();function customStyleq(e,r){return _styleq.styleq.factory({transform:function(e){if(staticStyleMap.has(e)){var t=staticStyleMap.get(e);return(0,_transformLocalizeStyle.localizeStyle)(t,r)}return e}})(e)}function insertRules(e){e.forEach(function(e){var t=e[0],r=e[1];null!=sheet&&t.forEach(function(e){sheet.insert(e,r)})})}function compileAndInsertAtomic(e){var t=(0,_compiler.atomic)((0,_preprocess.preprocess)(e)),e=t[0];return insertRules(t[1]),e}function compileAndInsertReset(e,t){e=(0,_compiler.classic)(e,t),t=e[0];return insertRules(e[1]),t}var absoluteFillObject={position:"absolute",left:0,right:0,top:0,bottom:0},absoluteFill=create({x:_objectSpread({},absoluteFillObject)}).x;function create(r){return Object.keys(r).forEach(function(e){var t=r[e];null!=t&&!0!==t.$$css&&(e=-1<e.indexOf("$raw")?compileAndInsertReset(t,e.split("$raw")[0]):("production"!==process.env.NODE_ENV&&((0,_validate.validate)(t),r[e]=Object.freeze(t)),compileAndInsertAtomic(t)),staticStyleMap.set(t,e))}),r}function compose(e,t){if("production"!==process.env.NODE_ENV){var r=arguments.length;if(2<r){var n=Array.prototype.slice.call(arguments).map(function(e){return flatten(e)});throw new Error("StyleSheet.compose() only accepts 2 arguments, received "+r+": "+JSON.stringify(n))}}return e&&t?[e,t]:e||t}function flatten(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=t.flat(1/0),o={},l=0;l<n.length;l++){var i=n[l];null!=i&&"object"==typeof i&&Object.assign(o,i)}return o}function getSheet(){return{id:sheet.id,textContent:sheet.getTextContent()}}function StyleSheet(e,t){t=null!=t&&"rtl"===t.writingDirection,e=customStyleq(e,t);return Array.isArray(e)&&null!=e[1]&&(e[1]=(0,_compiler.inline)((0,_preprocess.preprocess)(e[1]),t)),e}StyleSheet.absoluteFill=absoluteFill,StyleSheet.absoluteFillObject=absoluteFillObject,StyleSheet.create=create,StyleSheet.compose=compose,StyleSheet.flatten=flatten,StyleSheet.getSheet=getSheet,StyleSheet.hairlineWidth=1,canUseDOM&&window.__REACT_DEVTOOLS_GLOBAL_HOOK__&&(window.__REACT_DEVTOOLS_GLOBAL_HOOK__.resolveRNStyle=StyleSheet.flatten);var stylesheet=StyleSheet,_default=StyleSheet;exports.default=_default,module.exports=exports.default;
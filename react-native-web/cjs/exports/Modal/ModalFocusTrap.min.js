"use strict";exports.__esModule=!0,exports.default=void 0;var React=_interopRequireWildcard(require("react")),_View=_interopRequireDefault(require("../View")),_createElement=_interopRequireDefault(require("../createElement")),_StyleSheet=_interopRequireDefault(require("../StyleSheet")),_UIManager=_interopRequireDefault(require("../UIManager")),_ExecutionEnvironment=_interopRequireDefault(require("fbjs/lib/ExecutionEnvironment"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache();if(t&&t.has(e))return t.get(e);var r,n,c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&((n=u?Object.getOwnPropertyDescriptor(e,r):null)&&(n.get||n.set)?Object.defineProperty(c,r,n):c[r]=e[r]);return c.default=e,t&&t.set(e,c),c}var canUseDOM=_ExecutionEnvironment.default.canUseDOM,FocusBracket=function(){return(0,_createElement.default)("div",{accessibilityRole:"none",tabIndex:0,style:styles.focusBracket})};function attemptFocus(e){if(!canUseDOM)return!1;try{e.focus()}catch(e){}return document.activeElement===e}function focusFirstDescendant(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(attemptFocus(r)||focusFirstDescendant(r))return!0}return!1}function focusLastDescendant(e){for(var t=e.childNodes.length-1;0<=t;t--){var r=e.childNodes[t];if(attemptFocus(r)||focusLastDescendant(r))return!0}return!1}var ModalFocusTrap=function(e){var t=e.active,e=e.children,r=React.useRef(),n=React.useRef({trapFocusInProgress:!1,lastFocusedElement:null});return React.useEffect(function(){if(canUseDOM){var e=function(){if(null!=r.current&&!n.current.trapFocusInProgress&&t){try{var e;n.current.trapFocusInProgress=!0,document.activeElement instanceof Node&&!r.current.contains(document.activeElement)&&(e=focusFirstDescendant(r.current),!(e=n.current.lastFocusedElement===document.activeElement?focusLastDescendant(r.current):e)&&null!=r.current&&document.activeElement&&_UIManager.default.focus(r.current))}finally{n.current.trapFocusInProgress=!1}n.current.lastFocusedElement=document.activeElement}};return e(),document.addEventListener("focus",e,!0),function(){return document.removeEventListener("focus",e,!0)}}},[t]),React.useEffect(function(){if(canUseDOM){var e=document.activeElement;return function(){e&&document.contains(e)&&_UIManager.default.focus(e)}}},[]),React.createElement(React.Fragment,null,React.createElement(FocusBracket,null),React.createElement(_View.default,{ref:r},e),React.createElement(FocusBracket,null))},_default=ModalFocusTrap;exports.default=_default;var styles=_StyleSheet.default.create({focusBracket:{outlineStyle:"none"}});module.exports=exports.default;
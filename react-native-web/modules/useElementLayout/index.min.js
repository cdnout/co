import useLayoutEffect from"../useLayoutEffect";import UIManager from"../../exports/UIManager";import ExecutionEnvironment from"fbjs/lib/ExecutionEnvironment";var canUseDOM=ExecutionEnvironment.canUseDOM,DOM_LAYOUT_HANDLER_NAME="__reactLayoutHandler",didWarn=!canUseDOM,resizeObserver=null;function getResizeObserver(){return canUseDOM&&void 0!==window.ResizeObserver?null==resizeObserver&&(resizeObserver=new window.ResizeObserver(function(e){e.forEach(function(u){var e=u.target,s=e[DOM_LAYOUT_HANDLER_NAME];"function"==typeof s&&UIManager.measure(e,function(e,n,r,t,o,i){i={nativeEvent:{layout:{x:e,y:n,width:r,height:t,left:o,top:i}},timeStamp:Date.now()};Object.defineProperty(i.nativeEvent,"target",{enumerable:!0,get:function(){return u.target}}),s(i)})})})):didWarn||"production"!==process.env.NODE_ENV&&"test"!==process.env.NODE_ENV&&(console.warn("onLayout relies on ResizeObserver which is not supported by your browser. Please include a polyfill, e.g., https://github.com/que-etc/resize-observer-polyfill."),didWarn=!0),resizeObserver}export default function useElementLayout(n,r){var t=getResizeObserver();useLayoutEffect(function(){var e=n.current;null!=e&&(e[DOM_LAYOUT_HANDLER_NAME]=r)},[n,r]),useLayoutEffect(function(){var e=n.current;return null!=e&&null!=t&&("function"==typeof e[DOM_LAYOUT_HANDLER_NAME]?t.observe(e):t.unobserve(e)),function(){null!=e&&null!=t&&t.unobserve(e)}},[n,t])}
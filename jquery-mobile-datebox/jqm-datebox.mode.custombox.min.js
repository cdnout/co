/*
 * jQuery Mobile Framework : plugin to provide a date and time picker.
 * Copyright (c) JTSage
 * CC 3.0 Attribution.  May be relicensed without permission/notification.
 * https://github.com/jtsage/jquery-mobile-datebox
 */
(function(a){a.extend(a.mobile.datebox.prototype.options,{themeButton:"a",themeInput:"a",useSetButton:true,customData:[{input:true,name:"Letter",data:["a","b","c","d","e"]},{input:true,name:"Text",data:["some","bull","shtuff","here"]},{input:false,name:"Image",data:['<img src="img/slot1.png" />','<img src="img/slot2.png" />','<img src="img/slot3.png" />','<img src="img/slot4.png" />']}],customDefault:[0,0,0],customFormat:false,customboxlang:{customSet:"Looks Good"}});a.extend(a.mobile.datebox.prototype,{_cbox_offset:function(e,d){var c=this,b,f=this.options;tmp=(c.customCurrent[e]+d)%f.customData[e]["data"].length;if(tmp<0){tmp=f.customData[e]["data"].length+tmp}c.customCurrent[e]=tmp;if(f.useImmediate){c.d.input.trigger("datebox",{method:"set",value:c._formatter(f.customFormat,c.customCurrent),date:c.customCurrent})}c.refresh()}});a.extend(a.mobile.datebox.prototype._parser,{custombox:function(b){return(b.length<1||!b.match(/,/))?this.options.customDefault:b.split(",")}});a.extend(a.mobile.datebox.prototype._customformat,{custombox:function(c,b){return b[c-1]}});a.extend(a.mobile.datebox.prototype._build,{custombox:function(){var t=this,f=this.options,l,s,m,g=-2,q="ui-datebox-",r=a("<div>"),c=a("<fieldset>"),j=r.clone(),k=c.clone(),n=this._makeDate(this.d.input.val()),e=a("<input type='text' />").addClass("ui-input-text ui-corner-all ui-shadow-inset ui-body-"+f.themeInput),h=a("<div>").addClass("ui-input-text ui-corner-all ui-shadow-inset ui-body-"+f.themeInput).css({padding:".4em",margin:".5em 0","text-align":"center"}),p=a("<div>"),b={theme:f.themeButton,icon:"plus",iconpos:"bottom",corners:true,shadow:true},d=a.extend({},b,{icon:"minus",iconpos:"top"});if(typeof t.customCurrent==="undefined"){t.customCurrent=n}if(f.customFormat===false){m=[];for(l=0;l<f.customData.length;l++){m.push("%X"+(l+1))}f.customFormat=m.join(",")}if(typeof t.d.intHTML!=="boolean"){t.d.intHTML.empty().remove()}t.d.headerText=((t._grabLabel()!==false)?t._grabLabel():((f.mode==="datebox")?t.__("titleDateDialogLabel"):t.__("titleTimeDialogLabel")));t.d.intHTML=a("<span>");for(l=0;l<f.customData.length;l++){m=["a","b","c","d","e","f"][l];if(f.customData[l]["input"]===true){a("<div>").append(e.clone().attr("value",f.customData[l]["data"][t.customCurrent[l]])).addClass("ui-block-"+m).appendTo(j)}else{a("<div>").append(h.clone().html(f.customData[l]["data"][t.customCurrent[l]])).addClass("ui-block-"+m).appendTo(j)}t._makeEl(p,{attr:{field:l,amount:1}}).addClass("ui-block-"+m).buttonMarkup(b).appendTo(c);t._makeEl(p,{attr:{field:l,amount:1}}).addClass("ui-block-"+m).buttonMarkup(d).appendTo(k);g++}c.addClass("ui-grid-"+["a","b","c","d","e"][g]).appendTo(t.d.intHTML);j.addClass("ui-datebox-dboxin").addClass("ui-grid-"+["a","b","c","d","e"][g]).appendTo(t.d.intHTML);k.addClass("ui-grid-"+["a","b","c","d","e"][g]).appendTo(t.d.intHTML);if(f.mobVer>=140){k.find("div").css({"min-height":"2.3em"});c.find("div").css({"min-height":"2.3em"})}if(f.mobVer>=140){k.find("div").css({"min-height":"2.3em"});c.find("div").css({"min-height":"2.3em"})}if(f.useSetButton||f.useClearButton){s=a("<div>",{"class":q+"controls"});if(f.useSetButton){a('<a href="#">'+t.__("customSet")+"</a>").appendTo(s).buttonMarkup({theme:f.theme,icon:"check",iconpos:"left",corners:true,shadow:true}).on(f.clickEventAlt,function(i){i.preventDefault();t.d.input.trigger("datebox",{method:"set",value:t._formatter(f.customFormat,t.customCurrent),date:t.customCurrent});t.d.input.trigger("datebox",{method:"close"})})}if(f.useClearButton){a('<a href="#">'+t.__("clearButton")+"</a>").appendTo(s).buttonMarkup({theme:f.theme,icon:"delete",iconpos:"left",corners:true,shadow:true}).on(f.clickEventAlt,function(i){i.preventDefault();t.d.input.val("");t.d.input.trigger("datebox",{method:"clear"});t.d.input.trigger("datebox",{method:"close"})})}if(f.useCollapsedBut){s.addClass("ui-datebox-collapse")}s.appendTo(t.d.intHTML)}j.on("change","input",function(){t.refresh()});c.on(f.clickEvent,"div",function(i){i.preventDefault();t._cbox_offset(a(this).jqmData("field"),a(this).jqmData("amount"))});k.on(f.clickEvent,"div",function(i){i.preventDefault();t._cbox_offset(a(this).jqmData("field"),a(this).jqmData("amount")*-1)})}})})(jQuery);
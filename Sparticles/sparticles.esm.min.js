function ownKeys(e,t){var i,s=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)),s}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(i),!0).forEach(function(t){_defineProperty(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var AnimationFrame=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){};this.fps=1<arguments.length&&void 0!==arguments[1]?arguments[1]:60,this.handler=t;var h=0;this.start=function(){var s,r,n,t,a=this;this.started||(s=performance.now(),r=1e3/this.fps,n=0,t=function t(e){var i=e-s;h=requestAnimationFrame(t),r-n<=i&&(a.handler(i),s=e-i%r)},h=requestAnimationFrame(t),this.started=!0)},this.stop=function(){cancelAnimationFrame(h),this.started=!1}},cartesian=function(t){return[Math.cos(radian(t-90)),Math.sin(radian(t-90))]},clamp=function(t){return Math.max(1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,Math.min(2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,t))},radian=function(t){return t*Math.PI/180},random=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:Math.random();return e<=t?i=t:(0!==t||1!==e)&&t<e&&(i=i*(e-t)+t),i},randomArray=function(t){return t[Math.floor(random(0,t.length))]},randomHsl=function(){var t=round(random(0,360)),e=round(random(90,100)),i=round(random(45,85));return"hsl(".concat(t,",").concat(e,"%,").concat(i,"%)")},roll=function(t){return t>random()},round=function(t){return.5+t|0},Sparticle=function(t){return t?(this.canvas=t.canvas,this.settings=t.settings,this.colors=t.colors,this.shapes=t.shapes,this.images=t.images,this.styles=t.styles,this.ctx=t.canvas.getContext("2d"),this.setup(),this.init()):console.warn("Invalid parameters given to Sparticle()",arguments),this};Sparticle.prototype.setup=function(){var t=this.settings;this.frame=0,this.frameoffset=round(random(0,360)),this.size=round(random(t.minSize,t.maxSize)),this.da=this.getAlphaDelta(),this.dx=this.getDeltaX(),this.dy=this.getDeltaY(),this.dd=this.getDriftDelta(),this.dr=this.getRotationDelta(),this.color=this.getColor(),this.shape=this.getShape(),this.image=this.getImage(),this.style=this.getStyle(),this.rotation=t.rotate?radian(random(0,360)):0,this.vertical=150<t.direction&&t.direction<210||330<t.direction&&t.direction<390||-30<t.direction&&t.direction<30,this.horizontal=60<t.direction&&t.direction<120||240<t.direction&&t.direction<300},Sparticle.prototype.init=function(){var t=this.settings,e=this.canvas;((this.alpha=0)<t.speed||0===t.alphaSpeed)&&(this.alpha=random(t.minAlpha,t.maxAlpha)),t.bounce?(this.px=round(random(2,e.width-this.size-2)),this.py=round(random(2,e.height-this.size-2))):(this.px=round(random(2*-this.size,e.width+this.size)),this.py=round(random(2*-this.size,e.height+this.size)))},Sparticle.prototype.reset=function(){this.setup(),this.py<0?this.py=this.canvas.height+2*this.size:this.py>this.canvas.height&&(this.py=0-2*this.size),this.px<0?this.px=this.canvas.width+2*this.size:this.px>this.canvas.width&&(this.px=0-2*this.size)},Sparticle.prototype.bounce=function(){this.settings.direction;(this.py<=0||this.py+this.size>=this.canvas.height)&&(this.dy=-this.dy,this.horizontal&&(this.dd=-this.dd)),(this.px<=0||this.px+this.size>=this.canvas.width)&&(this.dx=-this.dx,this.vertical&&(this.dd=-this.dd))},Sparticle.prototype.isOffCanvas=function(){var t=0-2*this.size,e=this.canvas.height+2*this.size,i=this.canvas.width+2*this.size;return this.px<t||this.px>i||this.py<t||this.py>e},Sparticle.prototype.isTouchingEdge=function(){var t=this.canvas.height-this.size,e=this.canvas.width-this.size;return this.px<0||this.px>e||this.py<0||this.py>t},Sparticle.prototype.getColor=function(){return"random"===this.settings.color?randomArray(this.colors):Array.isArray(this.settings.color)?randomArray(this.settings.color):this.settings.color},Sparticle.prototype.getShape=function(){return"random"===this.settings.shape?randomArray(this.shapes):Array.isArray(this.settings.shape)?randomArray(this.settings.shape):this.settings.shape},Sparticle.prototype.getImage=function(){return Array.isArray(this.settings.imageUrl)?randomArray(this.settings.imageUrl):this.settings.imageUrl},Sparticle.prototype.getStyle=function(){return randomArray(this.styles)},Sparticle.prototype.getDelta=function(){var t=.1*this.settings.speed;return this.settings.speed&&this.settings.parallax?t+this.size*this.settings.parallax/50:t},Sparticle.prototype.getDeltaVariance=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=this.settings.speed||10;return 0<t?random(-t,t)*e/100:0},Sparticle.prototype.getDeltaX=function(){var t=this.getDelta(),e=this.getDeltaVariance(this.settings.xVariance);return cartesian(this.settings.direction)[0]*t+e},Sparticle.prototype.getDeltaY=function(){var t=this.getDelta(),e=this.getDeltaVariance(this.settings.yVariance);return cartesian(this.settings.direction)[1]*t+e},Sparticle.prototype.getAlphaDelta=function(){var t=this.settings.alphaVariance,t=random(1,t+1);return t=roll(.5)?-t:t},Sparticle.prototype.getDriftDelta=function(){return this.settings.drift?random(this.settings.drift-this.settings.drift/2,this.settings.drift+this.settings.drift/2):0},Sparticle.prototype.getRotationDelta=function(){var t=0;return this.settings.rotate&&this.settings.rotation&&(t=radian(random(.5,1.5)*this.settings.rotation),roll(.5)&&(t=-t)),t},Sparticle.prototype.update=function(){return this.frame+=1,this.updatePosition(),this.updateAlpha(),this},Sparticle.prototype.updateAlpha=function(){return 0<this.settings.alphaSpeed&&(this.settings.twinkle?this.alpha=this.updateTwinkle():this.alpha=this.updateFade()),this.alpha},Sparticle.prototype.updateFade=function(){var t=this.da/1e3*this.settings.alphaSpeed*.5,e=this.alpha+t,i=0<this.da&&e>this.settings.maxAlpha,t=this.da<0&&e<this.settings.minAlpha;return(i||t)&&(this.da=-this.da,e=this.settings.maxAlpha,t&&(e=this.settings.minAlpha)),e},Sparticle.prototype.updateTwinkle=function(){var t=this.alpha,e=Math.abs(this.da),i=t>this.settings.maxAlpha,s=t<this.settings.minAlpha,r=e/1e3*this.settings.alphaSpeed*.5,n=roll(1/30),e=roll(1/30);return this.resettingTwinkle?t+=5*r:n?t+=50*r:t-=e?25*r:r,s?(this.resettingTwinkle=!0,t=this.settings.minAlpha):i&&(this.resettingTwinkle=!1,t=this.settings.maxAlpha),t},Sparticle.prototype.updatePosition=function(){if(this.settings.bounce&&this.isTouchingEdge())this.bounce();else if(this.isOffCanvas())return void this.reset();this.px+=this.dx,this.py+=this.dy,this.updateDrift(),this.updateRotation()},Sparticle.prototype.updateRotation=function(){this.settings.rotate&&this.settings.rotation&&(this.rotation+=this.dr)},Sparticle.prototype.updateDrift=function(){var t=this.settings;t.direction;t.drift&&t.speed&&(this.vertical?this.px+=cartesian(this.frame+this.frameoffset)[0]*this.dd/(15*this.getDelta()):this.horizontal&&(this.py+=cartesian(this.frame+this.frameoffset)[1]*this.dd/(15*this.getDelta())))},Sparticle.prototype.render=function(t){var e="image"!==this.shape?t[this.color][this.shape][this.style]:t[this.color][this.shape][this.image],i=e.width,s=this.size/i,r=this.px/s,t=this.py/s;return this.ctx.globalAlpha=clamp(this.alpha,0,1),this.renderRotate(),this.ctx.transform(s,0,0,s,0,0),this.ctx.drawImage(e,0,0,i,i,r,t,i,i),this.ctx.setTransform(1,0,0,1,0,0),this},Sparticle.prototype.renderRotate=function(){var t,e;"circle"!==this.shape&&this.settings.rotate&&(t=this.px+this.size/2,e=this.py+this.size/2,this.ctx.translate(t,e),this.ctx.rotate(this.rotation),this.ctx.translate(-t,-e))};var Sparticles=function(t,e,i,s){1<=arguments.length&&!(arguments[0]instanceof HTMLElement)&&(e=arguments[0],i=arguments[1],s=arguments[2],t=void 0),i&&!s&&(s=i);var r={alphaSpeed:10,alphaVariance:1,bounce:!1,color:"random",randomColor:randomHsl,randomColorCount:3,composition:"source-over",count:50,direction:180,drift:1,glow:0,imageUrl:"",maxAlpha:1,maxSize:10,minAlpha:0,minSize:1,parallax:1,rotate:!0,rotation:1,shape:"circle",speed:10,style:"fill",twinkle:!1,xVariance:2,yVariance:2};return this.el=t||document.body,this.settings=_objectSpread2(_objectSpread2({},r),e),this.resizable=!i&&!s,this.width=this.resizable?this.el.clientWidth:i,this.height=this.resizable?this.el.clientHeight:s,this.init=function(){var t=this;return this.sparticles=[],this.colors=this.getColorArray(),this.shapes=this.getShapeArray(),this.styles=this.getStyleArray(),this.imageUrls=this.getImageArray(),this.setupMainCanvas(),this.setupOffscreenCanvasses(function(){t.createSparticles(),t.start()}),window.addEventListener("resize",this),this},this.handleEvent=function(t){var e=this;"resize"===t.type&&(clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(function(){e.resizable&&(e.width=e.el.clientWidth,e.height=e.el.clientHeight,e.setCanvasSize().resetSparticles())},200))},this.start=function(){var e=this;return this.loop||(this.loop=new AnimationFrame(function(t){e.drawFrame(t)})),this.loop.start(),this},this.stop=function(){return this.loop.stop(),this},this.destroy=function(){for(var t in this.stop(),this.el.removeChild(this.canvas),window.removeEventListener("resize",this),this)this.hasOwnProperty(t)&&delete this[t];return this},this.setCanvasSize=function(t,e){return t&&(this.resizable=!1),this.width=t||this.width,this.height=e||this.height,this.canvas.width=this.width,this.canvas.height=this.height,this},this.resetSparticles=this.createSparticles=function(){this.sparticles=[],this.ctx.globalCompositeOperation=this.settings.composition;for(var t=0;t<this.settings.count;t++)this.sparticles.push(new Sparticle(this,t));return this.sort(),this.sparticles},this.sort=function(){this.settings.parallax&&this.sparticles.sort(function(t,e){return t.size-e.size})},this.init()};Sparticles.prototype.getColorArray=function(){var t=Array.isArray(this.settings.color)?this.settings.color:[this.settings.color];if(t.some(function(t){return"random"===t}))for(var e=0;e<this.settings.randomColorCount;e++)t[e]=this.settings.randomColor(e,this.settings.randomColorCount);return t},Sparticles.prototype.getShapeArray=function(){var t=Array.isArray(this.settings.shape)?this.settings.shape:[this.settings.shape];return t=t.some(function(t){return"random"===t})?["square","circle","triangle"]:t},Sparticles.prototype.getImageArray=function(){return Array.isArray(this.settings.imageUrl)?this.settings.imageUrl:[this.settings.imageUrl]},Sparticles.prototype.getStyleArray=function(){var t=this.settings.style;return t="fill"!==t&&"stroke"!==t?["fill","stroke"]:[t]},Sparticles.prototype.setupMainCanvas=function(){return this.canvas=document.createElement("canvas"),this.canvas.setAttribute("class","sparticles"),this.ctx=this.canvas.getContext("2d"),this.setCanvasSize(),this.el.appendChild(this.canvas),this.canvas},Sparticles.prototype.setupOffscreenCanvasses=function(a){var h=this,t=this.colors.filter(function(t,e){return h.colors.indexOf(t)===e}),e=this.shapes.filter(function(t,e){return h.shapes.indexOf(t)===e}),i=this.styles.filter(function(t,e){return h.styles.indexOf(t)===e}),s=this.imageUrls.filter(function(t,e){return h.imageUrls.indexOf(t)===e}),o=t.length*s.length,l=t.length*e.length*i.length,c=0,p=0;this.canvasses=this.canvasses||{},t.forEach(function(n){h.canvasses[n]=h.canvasses[n]||{},e.forEach(function(r){h.canvasses[n][r]=h.canvasses[n][r]||{},"image"===r?s.forEach(function(t,e){var i=new Image,s=document.createElement("canvas");h.canvasses[n][r][t]=s,i.onload=function(){c++,h.drawOffscreenCanvasForImage(i,n,s),a&&c===o&&a()},i.onerror=function(){console.error("failed to load source image: ",t)},i.src=t}):i.forEach(function(t){var e=document.createElement("canvas");h.canvasses[n][r][t]=e,p++,h.drawOffscreenCanvas(r,t,n,e),a&&p===l&&a()})})})},Sparticles.prototype.getGlowSize=function(t){return this.settings.glow},Sparticles.prototype.getLineSize=function(t){return clamp(t/20,1,5)},Sparticles.prototype.getOffscreenCanvasSize=function(){return clamp(this.settings.maxSize,this.settings.minSize,this.settings.maxSize)},Sparticles.prototype.renderStyle=function(t,e,i,s){"fill"===s?t.fillStyle=e:(t.lineWidth=i,t.strokeStyle=e)},Sparticles.prototype.renderGlow=function(t,e,i){i=this.getGlowSize(i)/2;t.shadowColor=e,t.shadowBlur=i},Sparticles.prototype.renderColor=function(t,e,i){"fill"===e?i?t.fill(i):t.fill():i?t.stroke(i):t.stroke()},Sparticles.prototype.drawOffscreenCanvas=function(t,e,i,s){return this.offScreenCanvas[t].call(this,e,i,s)},Sparticles.prototype.offScreenCanvas={},Sparticles.prototype.offScreenCanvas.circle=function(t,e,i){var s=i.getContext("2d"),r=this.getOffscreenCanvasSize(),n=this.getLineSize(r),a=r+2*n+this.getGlowSize(r),h="stroke"===t?r-n:r;return i.width=a,i.height=a,this.renderGlow(s,e,r),this.renderStyle(s,e,n,t),s.beginPath(),s.ellipse(a/2,a/2,h/2,h/2,0,0,360),this.renderColor(s,t),i},Sparticles.prototype.offScreenCanvas.square=function(t,e,i){var s=i.getContext("2d"),r=this.getOffscreenCanvasSize(),n=this.getLineSize(r),a=r+2*n+this.getGlowSize(r),h="stroke"===t?r-n:r;return i.width=a,i.height=a,this.renderGlow(s,e,r),this.renderStyle(s,e,n,t),s.beginPath(),s.rect(a/2-h/2,a/2-h/2,h,h),this.renderColor(s,t),i},Sparticles.prototype.offScreenCanvas.line=function(t,e,i){var s=i.getContext("2d"),r=1.5*this.getOffscreenCanvasSize(),n=this.getLineSize(r),a=r+2*n+this.getGlowSize(r),h=a/2-r/2,o=a/2-r/2;return i.width=a,i.height=a,this.renderGlow(s,e,r),s.lineWidth=n,s.strokeStyle=e,s.beginPath(),s.moveTo(h,o),s.lineTo(h+r,o+r),s.stroke(),s.closePath(),i},Sparticles.prototype.offScreenCanvas.triangle=function(t,e,i){var s=i.getContext("2d"),r=this.getOffscreenCanvasSize(),n=this.getLineSize(r),a=r+2*n+this.getGlowSize(r),h="stroke"===t?r-n:r,o=h*(Math.sqrt(3)/2),l=a/2,c=a/2-h/2;return i.width=a,i.height=a,this.renderGlow(s,e,r),this.renderStyle(s,e,n,t),s.beginPath(),s.moveTo(l,c),s.lineTo(l-h/2,c+o),s.lineTo(l+h/2,c+o),s.closePath(),this.renderColor(s,t),i},Sparticles.prototype.offScreenCanvas.diamond=function(t,e,i){var s=new Path2D("M43,83.74,48.63,99a1.46,1.46,0,0,0,2.74,0L57,83.74A45.09,45.09,0,0,1,83.74,57L99,51.37a1.46,1.46,0,0,0,0-2.74L83.74,43A45.11,45.11,0,0,1,57,16.26L51.37,1a1.46,1.46,0,0,0-2.74,0L43,16.26A45.11,45.11,0,0,1,16.26,43L1,48.63a1.46,1.46,0,0,0,0,2.74L16.26,57A45.09,45.09,0,0,1,43,83.74Z"),r=i.getContext("2d"),n=this.getOffscreenCanvasSize(),a=this.getLineSize(n),h=this.getGlowSize(n),o=n+2*a+h,l=o/(1.1*(100+h));return i.width=o,i.height=o,this.renderGlow(r,e,n),this.renderStyle(r,e,a/l,t),r.scale(l,l),r.translate(5+.5*h,5+.5*h),this.renderColor(r,t,s),i},Sparticles.prototype.offScreenCanvas.star=function(t,e,i){var s=new Path2D("M99.86,36.45a2.94,2.94,0,0,0-2.37-2l-31-4.54L52.63,1.64a2.93,2.93,0,0,0-5.26,0L33.51,29.91l-31,4.54a3,3,0,0,0-2.37,2,3,3,0,0,0,.74,3l22.44,22L18,92.55A2.94,2.94,0,0,0,20.91,96a2.86,2.86,0,0,0,1.36-.34L50,81,77.73,95.66a2.91,2.91,0,0,0,3.08-.22A3,3,0,0,0,82,92.55l-5.3-31.07,22.44-22A3,3,0,0,0,99.86,36.45Z"),r=i.getContext("2d"),n=this.getOffscreenCanvasSize(),a=this.getLineSize(n),h=this.getGlowSize(n),o=n+2*a+h,l=o/(1.1*(100+h));return i.width=o,i.height=o,r.scale(l,l),this.renderGlow(r,e,n),this.renderStyle(r,e,a/l,t),r.translate(5+.5*h,5+.5*h),this.renderColor(r,t,s),i},Sparticles.prototype.drawOffscreenCanvasForImage=function(t,e,i){var s=t.width,r=i.getContext("2d");return i.width=s,i.height=s,r.drawImage(t,0,0,s,s,0,0,s,s),r.globalCompositeOperation="source-atop",r.fillStyle=e,r.fillRect(0,0,s,s),i},Sparticles.prototype.drawFrame=function(){this.ctx.clearRect(0,0,this.width,this.height);for(var t=0;t<this.sparticles.length;t++)this.sparticles[t].update().render(this.canvasses);return this.sort(),this.sparticles};export default Sparticles;
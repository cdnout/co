"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.PureCustomizableCalendarDay=exports.selectedStyles=exports.lastInRangeStyles=exports.selectedSpanStyles=exports.hoveredSpanStyles=exports.blockedOutOfRangeStyles=exports.blockedCalendarStyles=exports.blockedMinNightsStyles=exports.highlightedCalendarStyles=exports.outsideStyles=exports.defaultStyles=void 0;var _enzymeShallowEqual=_interopRequireDefault(require("enzyme-shallow-equal")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized")),_inheritsLoose2=_interopRequireDefault(require("@babel/runtime/helpers/inheritsLoose")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_react=_interopRequireDefault(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_reactMomentProptypes=_interopRequireDefault(require("react-moment-proptypes")),_airbnbPropTypes=require("airbnb-prop-types"),_reactWithStyles=require("react-with-styles"),_moment=_interopRequireDefault(require("moment")),_raf=_interopRequireDefault(require("raf")),_defaultPhrases=require("../defaultPhrases"),_getPhrasePropTypes=_interopRequireDefault(require("../utils/getPhrasePropTypes")),_getCalendarDaySettings=_interopRequireDefault(require("../utils/getCalendarDaySettings")),_constants=require("../constants"),_DefaultTheme=_interopRequireDefault(require("../theme/DefaultTheme"));function ownKeys(t,e){var o,r=Object.keys(t);return Object.getOwnPropertySymbols&&(o=Object.getOwnPropertySymbols(t),e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,o)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(o),!0).forEach(function(e){(0,_defineProperty2.default)(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}var color=_DefaultTheme.default.reactDates.color;function getStyles(e,t){if(!e)return null;var o=e.hover;return t&&o?o:e}var DayStyleShape="production"!==process.env.NODE_ENV?_propTypes.default.shape({background:_propTypes.default.string,border:(0,_airbnbPropTypes.or)([_propTypes.default.string,_propTypes.default.number]),color:_propTypes.default.string,hover:_propTypes.default.shape({background:_propTypes.default.string,border:(0,_airbnbPropTypes.or)([_propTypes.default.string,_propTypes.default.number]),color:_propTypes.default.string})}):{},propTypes="production"!==process.env.NODE_ENV?(0,_airbnbPropTypes.forbidExtraProps)(_objectSpread({},_reactWithStyles.withStylesPropTypes,{day:_reactMomentProptypes.default.momentObj,daySize:_airbnbPropTypes.nonNegativeInteger,isOutsideDay:_propTypes.default.bool,modifiers:_propTypes.default.instanceOf(Set),isFocused:_propTypes.default.bool,tabIndex:_propTypes.default.oneOf([0,-1]),onDayClick:_propTypes.default.func,onDayMouseEnter:_propTypes.default.func,onDayMouseLeave:_propTypes.default.func,renderDayContents:_propTypes.default.func,ariaLabelFormat:_propTypes.default.string,defaultStyles:DayStyleShape,outsideStyles:DayStyleShape,todayStyles:DayStyleShape,firstDayOfWeekStyles:DayStyleShape,lastDayOfWeekStyles:DayStyleShape,highlightedCalendarStyles:DayStyleShape,blockedMinNightsStyles:DayStyleShape,blockedCalendarStyles:DayStyleShape,blockedOutOfRangeStyles:DayStyleShape,hoveredSpanStyles:DayStyleShape,selectedSpanStyles:DayStyleShape,lastInRangeStyles:DayStyleShape,selectedStyles:DayStyleShape,selectedStartStyles:DayStyleShape,selectedEndStyles:DayStyleShape,afterHoveredStartStyles:DayStyleShape,hoveredStartFirstPossibleEndStyles:DayStyleShape,hoveredStartBlockedMinNightsStyles:DayStyleShape,phrases:_propTypes.default.shape((0,_getPhrasePropTypes.default)(_defaultPhrases.CalendarDayPhrases))})):{},defaultStyles={border:"1px solid ".concat(color.core.borderLight),color:color.text,background:color.background,hover:{background:color.core.borderLight,border:"1px solid ".concat(color.core.borderLight),color:"inherit"}};exports.defaultStyles=defaultStyles;var outsideStyles={background:color.outside.backgroundColor,border:0,color:color.outside.color};exports.outsideStyles=outsideStyles;var highlightedCalendarStyles={background:color.highlighted.backgroundColor,color:color.highlighted.color,hover:{background:color.highlighted.backgroundColor_hover,color:color.highlighted.color_active}};exports.highlightedCalendarStyles=highlightedCalendarStyles;var blockedMinNightsStyles={background:color.minimumNights.backgroundColor,border:"1px solid ".concat(color.minimumNights.borderColor),color:color.minimumNights.color,hover:{background:color.minimumNights.backgroundColor_hover,color:color.minimumNights.color_active}};exports.blockedMinNightsStyles=blockedMinNightsStyles;var blockedCalendarStyles={background:color.blocked_calendar.backgroundColor,border:"1px solid ".concat(color.blocked_calendar.borderColor),color:color.blocked_calendar.color,hover:{background:color.blocked_calendar.backgroundColor_hover,border:"1px solid ".concat(color.blocked_calendar.borderColor),color:color.blocked_calendar.color_active}};exports.blockedCalendarStyles=blockedCalendarStyles;var blockedOutOfRangeStyles={background:color.blocked_out_of_range.backgroundColor,border:"1px solid ".concat(color.blocked_out_of_range.borderColor),color:color.blocked_out_of_range.color,hover:{background:color.blocked_out_of_range.backgroundColor_hover,border:"1px solid ".concat(color.blocked_out_of_range.borderColor),color:color.blocked_out_of_range.color_active}};exports.blockedOutOfRangeStyles=blockedOutOfRangeStyles;var hoveredSpanStyles={background:color.hoveredSpan.backgroundColor,border:"1px double ".concat(color.hoveredSpan.borderColor),color:color.hoveredSpan.color,hover:{background:color.hoveredSpan.backgroundColor_hover,border:"1px double ".concat(color.hoveredSpan.borderColor),color:color.hoveredSpan.color_active}};exports.hoveredSpanStyles=hoveredSpanStyles;var selectedSpanStyles={background:color.selectedSpan.backgroundColor,border:"1px double ".concat(color.selectedSpan.borderColor),color:color.selectedSpan.color,hover:{background:color.selectedSpan.backgroundColor_hover,border:"1px double ".concat(color.selectedSpan.borderColor),color:color.selectedSpan.color_active}};exports.selectedSpanStyles=selectedSpanStyles;var lastInRangeStyles={};exports.lastInRangeStyles=lastInRangeStyles;var selectedStyles={background:color.selected.backgroundColor,border:"1px double ".concat(color.selected.borderColor),color:color.selected.color,hover:{background:color.selected.backgroundColor_hover,border:"1px double ".concat(color.selected.borderColor),color:color.selected.color_active}};exports.selectedStyles=selectedStyles;var defaultProps={day:(0,_moment.default)(),daySize:_constants.DAY_SIZE,isOutsideDay:!1,modifiers:new Set,isFocused:!1,tabIndex:-1,onDayClick:function(){},onDayMouseEnter:function(){},onDayMouseLeave:function(){},renderDayContents:null,ariaLabelFormat:"dddd, LL",defaultStyles:defaultStyles,outsideStyles:outsideStyles,todayStyles:{},highlightedCalendarStyles:highlightedCalendarStyles,blockedMinNightsStyles:blockedMinNightsStyles,blockedCalendarStyles:blockedCalendarStyles,blockedOutOfRangeStyles:blockedOutOfRangeStyles,hoveredSpanStyles:hoveredSpanStyles,selectedSpanStyles:selectedSpanStyles,lastInRangeStyles:lastInRangeStyles,selectedStyles:selectedStyles,selectedStartStyles:{},selectedEndStyles:{},afterHoveredStartStyles:{},firstDayOfWeekStyles:{},lastDayOfWeekStyles:{},hoveredStartFirstPossibleEndStyles:{},hoveredStartBlockedMinNightsStyles:{},phrases:_defaultPhrases.CalendarDayPhrases},CustomizableCalendarDay=function(l){(0,_inheritsLoose2.default)(t,l);var e=t.prototype;function t(){for(var e,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return(e=l.call.apply(l,[this].concat(o))||this).state={isHovered:!1},e.setButtonRef=e.setButtonRef.bind((0,_assertThisInitialized2.default)(e)),e}return e[!_react.default.PureComponent&&"shouldComponentUpdate"]=function(e,t){return!(0,_enzymeShallowEqual.default)(this.props,e)||!(0,_enzymeShallowEqual.default)(this.state,t)},e.componentDidUpdate=function(e){var t=this,o=this.props,r=o.isFocused,l=o.tabIndex;0===l&&(!r&&l===e.tabIndex||(0,_raf.default)(function(){t.buttonRef&&t.buttonRef.focus()}))},e.onDayClick=function(e,t){var o=this.props.onDayClick;o(e,t)},e.onDayMouseEnter=function(e,t){var o=this.props.onDayMouseEnter;this.setState({isHovered:!0}),o(e,t)},e.onDayMouseLeave=function(e,t){var o=this.props.onDayMouseLeave;this.setState({isHovered:!1}),o(e,t)},e.onKeyDown=function(e,t){var o=this.props.onDayClick,r=t.key;"Enter"!==r&&" "!==r||o(e,t)},e.setButtonRef=function(e){this.buttonRef=e},e.render=function(){var t=this,e=this.props,o=e.day,r=e.ariaLabelFormat,l=e.daySize,a=e.isOutsideDay,s=e.modifiers,n=e.tabIndex,d=e.renderDayContents,c=e.styles,i=e.phrases,u=e.defaultStyles,y=e.outsideStyles,p=e.todayStyles,S=e.firstDayOfWeekStyles,h=e.lastDayOfWeekStyles,b=e.highlightedCalendarStyles,f=e.blockedMinNightsStyles,g=e.blockedCalendarStyles,_=e.blockedOutOfRangeStyles,v=e.hoveredSpanStyles,D=e.selectedSpanStyles,k=e.lastInRangeStyles,C=e.selectedStyles,m=e.selectedStartStyles,x=e.selectedEndStyles,O=e.afterHoveredStartStyles,P=e.hoveredStartFirstPossibleEndStyles,T=e.hoveredStartBlockedMinNightsStyles,R=this.state.isHovered;if(!o)return _react.default.createElement("td",null);var q=(0,_getCalendarDaySettings.default)(o,r,l,s,i),E=q.daySizeStyles,M=q.useDefaultCursor,w=q.selected,N=q.hoveredSpan,z=q.isOutsideRange,I=q.ariaLabel;return _react.default.createElement("td",(0,_extends2.default)({},(0,_reactWithStyles.css)(c.CalendarDay,M&&c.CalendarDay__defaultCursor,E,getStyles(u,R),a&&getStyles(y,R),s.has("today")&&getStyles(p,R),s.has("first-day-of-week")&&getStyles(S,R),s.has("last-day-of-week")&&getStyles(h,R),s.has("hovered-start-first-possible-end")&&getStyles(P,R),s.has("hovered-start-blocked-minimum-nights")&&getStyles(T,R),s.has("highlighted-calendar")&&getStyles(b,R),s.has("blocked-minimum-nights")&&getStyles(f,R),s.has("blocked-calendar")&&getStyles(g,R),N&&getStyles(v,R),s.has("after-hovered-start")&&getStyles(O,R),s.has("selected-span")&&getStyles(D,R),s.has("last-in-range")&&getStyles(k,R),w&&getStyles(C,R),s.has("selected-start")&&getStyles(m,R),s.has("selected-end")&&getStyles(x,R),z&&getStyles(_,R)),{role:"button",ref:this.setButtonRef,"aria-disabled":s.has("blocked"),"aria-label":I,onMouseEnter:function(e){t.onDayMouseEnter(o,e)},onMouseLeave:function(e){t.onDayMouseLeave(o,e)},onMouseUp:function(e){e.currentTarget.blur()},onClick:function(e){t.onDayClick(o,e)},onKeyDown:function(e){t.onKeyDown(o,e)},tabIndex:n}),d?d(o,s):o.format("D"))},t}(_react.default.PureComponent||_react.default.Component);(exports.PureCustomizableCalendarDay=CustomizableCalendarDay).propTypes="production"!==process.env.NODE_ENV?propTypes:{},CustomizableCalendarDay.defaultProps=defaultProps;var _default=(0,_reactWithStyles.withStyles)(function(e){return{CalendarDay:{boxSizing:"border-box",cursor:"pointer",fontSize:e.reactDates.font.size,textAlign:"center",":active":{outline:0}},CalendarDay__defaultCursor:{cursor:"default"}}},{pureComponent:void 0!==_react.default.PureComponent})(CustomizableCalendarDay);exports.default=_default;
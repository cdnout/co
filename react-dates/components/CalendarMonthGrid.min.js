"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _enzymeShallowEqual=_interopRequireDefault(require("enzyme-shallow-equal")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized")),_inheritsLoose2=_interopRequireDefault(require("@babel/runtime/helpers/inheritsLoose")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_react=_interopRequireDefault(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_reactMomentProptypes=_interopRequireDefault(require("react-moment-proptypes")),_airbnbPropTypes=require("airbnb-prop-types"),_reactWithStyles=require("react-with-styles"),_moment=_interopRequireDefault(require("moment")),_consolidatedEvents=require("consolidated-events"),_defaultPhrases=require("../defaultPhrases"),_getPhrasePropTypes=_interopRequireDefault(require("../utils/getPhrasePropTypes")),_noflip=_interopRequireDefault(require("../utils/noflip")),_CalendarMonth=_interopRequireDefault(require("./CalendarMonth")),_isTransitionEndSupported=_interopRequireDefault(require("../utils/isTransitionEndSupported")),_getTransformStyles=_interopRequireDefault(require("../utils/getTransformStyles")),_getCalendarMonthWidth=_interopRequireDefault(require("../utils/getCalendarMonthWidth")),_toISOMonthString=_interopRequireDefault(require("../utils/toISOMonthString")),_isPrevMonth=_interopRequireDefault(require("../utils/isPrevMonth")),_isNextMonth=_interopRequireDefault(require("../utils/isNextMonth")),_ModifiersShape=_interopRequireDefault(require("../shapes/ModifiersShape")),_ScrollableOrientationShape=_interopRequireDefault(require("../shapes/ScrollableOrientationShape")),_DayOfWeekShape=_interopRequireDefault(require("../shapes/DayOfWeekShape")),_constants=require("../constants");function ownKeys(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){(0,_defineProperty2.default)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var propTypes="production"!==process.env.NODE_ENV?(0,_airbnbPropTypes.forbidExtraProps)(_objectSpread({},_reactWithStyles.withStylesPropTypes,{enableOutsideDays:_propTypes.default.bool,firstVisibleMonthIndex:_propTypes.default.number,horizontalMonthPadding:_airbnbPropTypes.nonNegativeInteger,initialMonth:_reactMomentProptypes.default.momentObj,isAnimating:_propTypes.default.bool,numberOfMonths:_propTypes.default.number,modifiers:_propTypes.default.objectOf(_propTypes.default.objectOf(_ModifiersShape.default)),orientation:_ScrollableOrientationShape.default,onDayClick:_propTypes.default.func,onDayMouseEnter:_propTypes.default.func,onDayMouseLeave:_propTypes.default.func,onMonthTransitionEnd:_propTypes.default.func,onMonthChange:_propTypes.default.func,onYearChange:_propTypes.default.func,renderMonthText:(0,_airbnbPropTypes.mutuallyExclusiveProps)(_propTypes.default.func,"renderMonthText","renderMonthElement"),renderCalendarDay:_propTypes.default.func,renderDayContents:_propTypes.default.func,translationValue:_propTypes.default.number,renderMonthElement:(0,_airbnbPropTypes.mutuallyExclusiveProps)(_propTypes.default.func,"renderMonthText","renderMonthElement"),daySize:_airbnbPropTypes.nonNegativeInteger,focusedDate:_reactMomentProptypes.default.momentObj,isFocused:_propTypes.default.bool,firstDayOfWeek:_DayOfWeekShape.default,setMonthTitleHeight:_propTypes.default.func,isRTL:_propTypes.default.bool,transitionDuration:_airbnbPropTypes.nonNegativeInteger,verticalBorderSpacing:_airbnbPropTypes.nonNegativeInteger,monthFormat:_propTypes.default.string,phrases:_propTypes.default.shape((0,_getPhrasePropTypes.default)(_defaultPhrases.CalendarDayPhrases)),dayAriaLabelFormat:_propTypes.default.string})):{},defaultProps={enableOutsideDays:!1,firstVisibleMonthIndex:0,horizontalMonthPadding:13,initialMonth:(0,_moment.default)(),isAnimating:!1,numberOfMonths:1,modifiers:{},orientation:_constants.HORIZONTAL_ORIENTATION,onDayClick:function(){},onDayMouseEnter:function(){},onDayMouseLeave:function(){},onMonthChange:function(){},onYearChange:function(){},onMonthTransitionEnd:function(){},renderMonthText:null,renderCalendarDay:void 0,renderDayContents:null,translationValue:null,renderMonthElement:null,daySize:_constants.DAY_SIZE,focusedDate:null,isFocused:!1,firstDayOfWeek:null,setMonthTitleHeight:null,isRTL:!1,transitionDuration:200,verticalBorderSpacing:void 0,monthFormat:"MMMM YYYY",phrases:_defaultPhrases.CalendarDayPhrases,dayAriaLabelFormat:void 0};function getMonths(e,t,n){var r=e.clone();n||(r=r.subtract(1,"month"));for(var o=[],a=0;a<(n?t:t+2);a+=1)o.push(r),r=r.clone().add(1,"month");return o}var CalendarMonthGrid=function(r){(0,_inheritsLoose2.default)(t,r);var e=t.prototype;function t(e){var t=r.call(this,e)||this,n=e.orientation===_constants.VERTICAL_SCROLLABLE;return t.state={months:getMonths(e.initialMonth,e.numberOfMonths,n)},t.isTransitionEndSupported=(0,_isTransitionEndSupported.default)(),t.onTransitionEnd=t.onTransitionEnd.bind((0,_assertThisInitialized2.default)(t)),t.setContainerRef=t.setContainerRef.bind((0,_assertThisInitialized2.default)(t)),t.locale=_moment.default.locale(),t.onMonthSelect=t.onMonthSelect.bind((0,_assertThisInitialized2.default)(t)),t.onYearSelect=t.onYearSelect.bind((0,_assertThisInitialized2.default)(t)),t}return e[!_react.default.PureComponent&&"shouldComponentUpdate"]=function(e,t){return!(0,_enzymeShallowEqual.default)(this.props,e)||!(0,_enzymeShallowEqual.default)(this.state,t)},e.componentDidMount=function(){this.removeEventListener=(0,_consolidatedEvents.addEventListener)(this.container,"transitionend",this.onTransitionEnd)},e.componentWillReceiveProps=function(e){var t=this,n=e.initialMonth,r=e.numberOfMonths,o=e.orientation,a=this.state.months,i=this.props,s=i.initialMonth,l=i.numberOfMonths!==r,u=a;s.isSame(n,"month")||l||((0,_isNextMonth.default)(s,n)?(u=a.slice(1)).push(a[a.length-1].clone().add(1,"month")):(0,_isPrevMonth.default)(s,n)?(u=a.slice(0,a.length-1)).unshift(a[0].clone().subtract(1,"month")):u=getMonths(n,r,o===_constants.VERTICAL_SCROLLABLE)),l&&(u=getMonths(n,r,o===_constants.VERTICAL_SCROLLABLE));var d=_moment.default.locale();this.locale!==d&&(this.locale=d,u=u.map(function(e){return e.locale(t.locale)})),this.setState({months:u})},e.componentDidUpdate=function(){var e=this.props,t=e.isAnimating,n=e.transitionDuration,r=e.onMonthTransitionEnd;this.isTransitionEndSupported&&n||!t||r()},e.componentWillUnmount=function(){this.removeEventListener&&this.removeEventListener()},e.onTransitionEnd=function(){(0,this.props.onMonthTransitionEnd)()},e.onMonthSelect=function(e,t){var n=e.clone(),r=this.props,o=r.onMonthChange,a=r.orientation,i=this.state.months,s=a===_constants.VERTICAL_SCROLLABLE,l=i.indexOf(e);s||--l,n.set("month",t).subtract(l,"months"),o(n)},e.onYearSelect=function(e,t){var n=e.clone(),r=this.props,o=r.onYearChange,a=r.orientation,i=this.state.months,s=a===_constants.VERTICAL_SCROLLABLE,l=i.indexOf(e);s||--l,n.set("year",t).subtract(l,"months"),o(n)},e.setContainerRef=function(e){this.container=e},e.render=function(){var i=this,e=this.props,s=e.enableOutsideDays,l=e.firstVisibleMonthIndex,u=e.horizontalMonthPadding,d=e.isAnimating,p=e.modifiers,h=e.numberOfMonths,f=e.monthFormat,c=e.orientation,_=e.translationValue,y=e.daySize,m=e.onDayMouseEnter,M=e.onDayMouseLeave,b=e.onDayClick,T=e.renderMonthText,D=e.renderCalendarDay,g=e.renderDayContents,C=e.renderMonthElement,t=e.onMonthTransitionEnd,S=e.firstDayOfWeek,v=e.focusedDate,O=e.isFocused,E=e.isRTL,P=e.styles,q=e.phrases,R=e.dayAriaLabelFormat,n=e.transitionDuration,L=e.verticalBorderSpacing,I=e.setMonthTitleHeight,r=this.state.months,A=c===_constants.VERTICAL_ORIENTATION,o=c===_constants.VERTICAL_SCROLLABLE,x=c===_constants.HORIZONTAL_ORIENTATION,z=(0,_getCalendarMonthWidth.default)(y,u),a=A||o?z:(h+2)*z,G="".concat(A||o?"translateY":"translateX","(").concat(_,"px)");return _react.default.createElement("div",(0,_extends2.default)({},(0,_reactWithStyles.css)(P.CalendarMonthGrid,x&&P.CalendarMonthGrid__horizontal,A&&P.CalendarMonthGrid__vertical,o&&P.CalendarMonthGrid__vertical_scrollable,d&&P.CalendarMonthGrid__animating,d&&n&&{transition:"transform ".concat(n,"ms ease-in-out")},_objectSpread({},(0,_getTransformStyles.default)(G),{width:a})),{ref:this.setContainerRef,onTransitionEnd:t}),r.map(function(e,t){var n=l<=t&&t<l+h,r=0===t&&!n,o=0===t&&d&&n,a=(0,_toISOMonthString.default)(e);return _react.default.createElement("div",(0,_extends2.default)({key:a},(0,_reactWithStyles.css)(x&&P.CalendarMonthGrid_month__horizontal,r&&P.CalendarMonthGrid_month__hideForAnimation,o&&!A&&!E&&{position:"absolute",left:-z},o&&!A&&E&&{position:"absolute",right:0},o&&A&&{position:"absolute",top:-_},!n&&!d&&P.CalendarMonthGrid_month__hidden)),_react.default.createElement(_CalendarMonth.default,{month:e,isVisible:n,enableOutsideDays:s,modifiers:p[a],monthFormat:f,orientation:c,onDayMouseEnter:m,onDayMouseLeave:M,onDayClick:b,onMonthSelect:i.onMonthSelect,onYearSelect:i.onYearSelect,renderMonthText:T,renderCalendarDay:D,renderDayContents:g,renderMonthElement:C,firstDayOfWeek:S,daySize:y,focusedDate:n?v:null,isFocused:O,phrases:q,setMonthTitleHeight:I,dayAriaLabelFormat:R,verticalBorderSpacing:L,horizontalMonthPadding:u}))}))},t}(_react.default.PureComponent||_react.default.Component);CalendarMonthGrid.propTypes="production"!==process.env.NODE_ENV?propTypes:{},CalendarMonthGrid.defaultProps=defaultProps;var _default=(0,_reactWithStyles.withStyles)(function(e){var t=e.reactDates,n=t.color,r=t.spacing,o=t.zIndex;return{CalendarMonthGrid:{background:n.background,textAlign:(0,_noflip.default)("left"),zIndex:o},CalendarMonthGrid__animating:{zIndex:o+1},CalendarMonthGrid__horizontal:{position:"absolute",left:(0,_noflip.default)(r.dayPickerHorizontalPadding)},CalendarMonthGrid__vertical:{margin:"0 auto"},CalendarMonthGrid__vertical_scrollable:{margin:"0 auto"},CalendarMonthGrid_month__horizontal:{display:"inline-block",verticalAlign:"top",minHeight:"100%"},CalendarMonthGrid_month__hideForAnimation:{position:"absolute",zIndex:o-1,opacity:0,pointerEvents:"none"},CalendarMonthGrid_month__hidden:{visibility:"hidden"}}},{pureComponent:void 0!==_react.default.PureComponent})(CalendarMonthGrid);exports.default=_default;
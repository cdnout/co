"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _enzymeShallowEqual=_interopRequireDefault(require("enzyme-shallow-equal")),_assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized")),_inheritsLoose2=_interopRequireDefault(require("@babel/runtime/helpers/inheritsLoose")),_react=_interopRequireDefault(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_moment=_interopRequireDefault(require("moment")),_reactMomentProptypes=_interopRequireDefault(require("react-moment-proptypes")),_airbnbPropTypes=require("airbnb-prop-types"),_OpenDirectionShape=_interopRequireDefault(require("../shapes/OpenDirectionShape")),_defaultPhrases=require("../defaultPhrases"),_getPhrasePropTypes=_interopRequireDefault(require("../utils/getPhrasePropTypes")),_DateRangePickerInput=_interopRequireDefault(require("./DateRangePickerInput")),_IconPositionShape=_interopRequireDefault(require("../shapes/IconPositionShape")),_DisabledShape=_interopRequireDefault(require("../shapes/DisabledShape")),_toMomentObject=_interopRequireDefault(require("../utils/toMomentObject")),_toLocalizedDateString=_interopRequireDefault(require("../utils/toLocalizedDateString")),_isInclusivelyAfterDay=_interopRequireDefault(require("../utils/isInclusivelyAfterDay")),_isBeforeDay=_interopRequireDefault(require("../utils/isBeforeDay")),_constants=require("../constants"),propTypes="production"!==process.env.NODE_ENV?(0,_airbnbPropTypes.forbidExtraProps)({children:_propTypes.default.node,startDate:_reactMomentProptypes.default.momentObj,startDateId:_propTypes.default.string,startDatePlaceholderText:_propTypes.default.string,isStartDateFocused:_propTypes.default.bool,startDateAriaLabel:_propTypes.default.string,endDate:_reactMomentProptypes.default.momentObj,endDateId:_propTypes.default.string,endDatePlaceholderText:_propTypes.default.string,isEndDateFocused:_propTypes.default.bool,endDateAriaLabel:_propTypes.default.string,screenReaderMessage:_propTypes.default.string,showClearDates:_propTypes.default.bool,showCaret:_propTypes.default.bool,showDefaultInputIcon:_propTypes.default.bool,inputIconPosition:_IconPositionShape.default,disabled:_DisabledShape.default,required:_propTypes.default.bool,readOnly:_propTypes.default.bool,openDirection:_OpenDirectionShape.default,noBorder:_propTypes.default.bool,block:_propTypes.default.bool,small:_propTypes.default.bool,regular:_propTypes.default.bool,verticalSpacing:_airbnbPropTypes.nonNegativeInteger,keepOpenOnDateSelect:_propTypes.default.bool,reopenPickerOnClearDates:_propTypes.default.bool,withFullScreenPortal:_propTypes.default.bool,minimumNights:_airbnbPropTypes.nonNegativeInteger,isOutsideRange:_propTypes.default.func,displayFormat:_propTypes.default.oneOfType([_propTypes.default.string,_propTypes.default.func]),onFocusChange:_propTypes.default.func,onClose:_propTypes.default.func,onDatesChange:_propTypes.default.func,onKeyDownArrowDown:_propTypes.default.func,onKeyDownQuestionMark:_propTypes.default.func,customInputIcon:_propTypes.default.node,customArrowIcon:_propTypes.default.node,customCloseIcon:_propTypes.default.node,isFocused:_propTypes.default.bool,phrases:_propTypes.default.shape((0,_getPhrasePropTypes.default)(_defaultPhrases.DateRangePickerInputPhrases)),isRTL:_propTypes.default.bool}):{},defaultProps={children:null,startDate:null,startDateId:_constants.START_DATE,startDatePlaceholderText:"Start Date",isStartDateFocused:!1,startDateAriaLabel:void 0,endDate:null,endDateId:_constants.END_DATE,endDatePlaceholderText:"End Date",isEndDateFocused:!1,endDateAriaLabel:void 0,screenReaderMessage:"",showClearDates:!1,showCaret:!1,showDefaultInputIcon:!1,inputIconPosition:_constants.ICON_BEFORE_POSITION,disabled:!1,required:!1,readOnly:!1,openDirection:_constants.OPEN_DOWN,noBorder:!1,block:!1,small:!1,regular:!1,verticalSpacing:void 0,keepOpenOnDateSelect:!1,reopenPickerOnClearDates:!1,withFullScreenPortal:!1,minimumNights:1,isOutsideRange:function(e){return!(0,_isInclusivelyAfterDay.default)(e,(0,_moment.default)())},displayFormat:function(){return _moment.default.localeData().longDateFormat("L")},onFocusChange:function(){},onClose:function(){},onDatesChange:function(){},onKeyDownArrowDown:function(){},onKeyDownQuestionMark:function(){},customInputIcon:null,customArrowIcon:null,customCloseIcon:null,isFocused:!1,phrases:_defaultPhrases.DateRangePickerInputPhrases,isRTL:!1},DateRangePickerInputController=function(a){(0,_inheritsLoose2.default)(t,a);var e=t.prototype;function t(e){var t=a.call(this,e)||this;return t.onClearFocus=t.onClearFocus.bind((0,_assertThisInitialized2.default)(t)),t.onStartDateChange=t.onStartDateChange.bind((0,_assertThisInitialized2.default)(t)),t.onStartDateFocus=t.onStartDateFocus.bind((0,_assertThisInitialized2.default)(t)),t.onEndDateChange=t.onEndDateChange.bind((0,_assertThisInitialized2.default)(t)),t.onEndDateFocus=t.onEndDateFocus.bind((0,_assertThisInitialized2.default)(t)),t.clearDates=t.clearDates.bind((0,_assertThisInitialized2.default)(t)),t}return e[!_react.default.PureComponent&&"shouldComponentUpdate"]=function(e,t){return!(0,_enzymeShallowEqual.default)(this.props,e)||!(0,_enzymeShallowEqual.default)(this.state,t)},e.onClearFocus=function(){var e=this.props,t=e.onFocusChange,a=e.onClose,o=e.startDate,n=e.endDate;t(null),a({startDate:o,endDate:n})},e.onEndDateChange=function(e){var t=this.props,a=t.startDate,o=t.isOutsideRange,n=t.minimumNights,r=t.keepOpenOnDateSelect,s=t.onDatesChange,i=(0,_toMomentObject.default)(e,this.getDisplayFormat());i&&!o(i)&&!(a&&(0,_isBeforeDay.default)(i,a.clone().add(n,"days")))?(s({startDate:a,endDate:i}),r||this.onClearFocus()):s({startDate:a,endDate:null})},e.onEndDateFocus=function(){var e=this.props,t=e.startDate,a=e.onFocusChange,o=e.withFullScreenPortal,n=e.disabled;t||!o||n&&n!==_constants.END_DATE?n&&n!==_constants.START_DATE||a(_constants.END_DATE):a(_constants.START_DATE)},e.onStartDateChange=function(e){var t=this.props.endDate,a=this.props,o=a.isOutsideRange,n=a.minimumNights,r=a.onDatesChange,s=a.onFocusChange,i=a.disabled,l=(0,_toMomentObject.default)(e,this.getDisplayFormat()),u=l&&(0,_isBeforeDay.default)(t,l.clone().add(n,"days"));l&&!o(l)&&!(i===_constants.END_DATE&&u)?(u&&(t=null),r({startDate:l,endDate:t}),s(_constants.END_DATE)):r({startDate:null,endDate:t})},e.onStartDateFocus=function(){var e=this.props,t=e.disabled,a=e.onFocusChange;t&&t!==_constants.END_DATE||a(_constants.START_DATE)},e.getDisplayFormat=function(){var e=this.props.displayFormat;return"string"==typeof e?e:e()},e.getDateString=function(e){var t=this.getDisplayFormat();return e&&t?e&&e.format(t):(0,_toLocalizedDateString.default)(e)},e.clearDates=function(){var e=this.props,t=e.onDatesChange,a=e.reopenPickerOnClearDates,o=e.onFocusChange;t({startDate:null,endDate:null}),a&&o(_constants.START_DATE)},e.render=function(){var e=this.props,t=e.children,a=e.startDate,o=e.startDateId,n=e.startDatePlaceholderText,r=e.isStartDateFocused,s=e.startDateAriaLabel,i=e.endDate,l=e.endDateId,u=e.endDatePlaceholderText,p=e.endDateAriaLabel,d=e.isEndDateFocused,c=e.screenReaderMessage,D=e.showClearDates,_=e.showCaret,f=e.showDefaultInputIcon,h=e.inputIconPosition,y=e.customInputIcon,T=e.customArrowIcon,g=e.customCloseIcon,m=e.disabled,b=e.required,I=e.readOnly,P=e.openDirection,C=e.isFocused,S=e.phrases,q=e.onKeyDownArrowDown,F=e.onKeyDownQuestionMark,E=e.isRTL,R=e.noBorder,w=e.block,O=e.small,A=e.regular,v=e.verticalSpacing,k=this.getDateString(a),N=this.getDateString(i);return _react.default.createElement(_DateRangePickerInput.default,{startDate:k,startDateId:o,startDatePlaceholderText:n,isStartDateFocused:r,startDateAriaLabel:s,endDate:N,endDateId:l,endDatePlaceholderText:u,isEndDateFocused:d,endDateAriaLabel:p,isFocused:C,disabled:m,required:b,readOnly:I,openDirection:P,showCaret:_,showDefaultInputIcon:f,inputIconPosition:h,customInputIcon:y,customArrowIcon:T,customCloseIcon:g,phrases:S,onStartDateChange:this.onStartDateChange,onStartDateFocus:this.onStartDateFocus,onStartDateShiftTab:this.onClearFocus,onEndDateChange:this.onEndDateChange,onEndDateFocus:this.onEndDateFocus,showClearDates:D,onClearDates:this.clearDates,screenReaderMessage:c,onKeyDownArrowDown:q,onKeyDownQuestionMark:F,isRTL:E,noBorder:R,block:w,small:O,regular:A,verticalSpacing:v},t)},t}(_react.default.PureComponent||_react.default.Component);(exports.default=DateRangePickerInputController).propTypes="production"!==process.env.NODE_ENV?propTypes:{},DateRangePickerInputController.defaultProps=defaultProps;
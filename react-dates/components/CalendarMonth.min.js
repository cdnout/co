"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _enzymeShallowEqual=_interopRequireDefault(require("enzyme-shallow-equal")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized")),_inheritsLoose2=_interopRequireDefault(require("@babel/runtime/helpers/inheritsLoose")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_react=_interopRequireDefault(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_reactMomentProptypes=_interopRequireDefault(require("react-moment-proptypes")),_airbnbPropTypes=require("airbnb-prop-types"),_reactWithStyles=require("react-with-styles"),_moment=_interopRequireDefault(require("moment")),_defaultPhrases=require("../defaultPhrases"),_getPhrasePropTypes=_interopRequireDefault(require("../utils/getPhrasePropTypes")),_CalendarWeek=_interopRequireDefault(require("./CalendarWeek")),_CalendarDay=_interopRequireDefault(require("./CalendarDay")),_calculateDimension=_interopRequireDefault(require("../utils/calculateDimension")),_getCalendarMonthWeeks=_interopRequireDefault(require("../utils/getCalendarMonthWeeks")),_isSameDay=_interopRequireDefault(require("../utils/isSameDay")),_toISODateString=_interopRequireDefault(require("../utils/toISODateString")),_ModifiersShape=_interopRequireDefault(require("../shapes/ModifiersShape")),_ScrollableOrientationShape=_interopRequireDefault(require("../shapes/ScrollableOrientationShape")),_DayOfWeekShape=_interopRequireDefault(require("../shapes/DayOfWeekShape")),_constants=require("../constants");function ownKeys(t,e){var r,a=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)),a}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){(0,_defineProperty2.default)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var propTypes="production"!==process.env.NODE_ENV?(0,_airbnbPropTypes.forbidExtraProps)(_objectSpread({},_reactWithStyles.withStylesPropTypes,{month:_reactMomentProptypes.default.momentObj,horizontalMonthPadding:_airbnbPropTypes.nonNegativeInteger,isVisible:_propTypes.default.bool,enableOutsideDays:_propTypes.default.bool,modifiers:_propTypes.default.objectOf(_ModifiersShape.default),orientation:_ScrollableOrientationShape.default,daySize:_airbnbPropTypes.nonNegativeInteger,onDayClick:_propTypes.default.func,onDayMouseEnter:_propTypes.default.func,onDayMouseLeave:_propTypes.default.func,onMonthSelect:_propTypes.default.func,onYearSelect:_propTypes.default.func,renderMonthText:(0,_airbnbPropTypes.mutuallyExclusiveProps)(_propTypes.default.func,"renderMonthText","renderMonthElement"),renderCalendarDay:_propTypes.default.func,renderDayContents:_propTypes.default.func,renderMonthElement:(0,_airbnbPropTypes.mutuallyExclusiveProps)(_propTypes.default.func,"renderMonthText","renderMonthElement"),firstDayOfWeek:_DayOfWeekShape.default,setMonthTitleHeight:_propTypes.default.func,verticalBorderSpacing:_airbnbPropTypes.nonNegativeInteger,focusedDate:_reactMomentProptypes.default.momentObj,isFocused:_propTypes.default.bool,monthFormat:_propTypes.default.string,phrases:_propTypes.default.shape((0,_getPhrasePropTypes.default)(_defaultPhrases.CalendarDayPhrases)),dayAriaLabelFormat:_propTypes.default.string})):{},defaultProps={month:(0,_moment.default)(),horizontalMonthPadding:13,isVisible:!0,enableOutsideDays:!1,modifiers:{},orientation:_constants.HORIZONTAL_ORIENTATION,daySize:_constants.DAY_SIZE,onDayClick:function(){},onDayMouseEnter:function(){},onDayMouseLeave:function(){},onMonthSelect:function(){},onYearSelect:function(){},renderMonthText:null,renderCalendarDay:function(e){return _react.default.createElement(_CalendarDay.default,e)},renderDayContents:null,renderMonthElement:null,firstDayOfWeek:null,setMonthTitleHeight:null,focusedDate:null,isFocused:!1,monthFormat:"MMMM YYYY",phrases:_defaultPhrases.CalendarDayPhrases,dayAriaLabelFormat:void 0,verticalBorderSpacing:void 0},CalendarMonth=function(r){(0,_inheritsLoose2.default)(t,r);var e=t.prototype;function t(e){var t=r.call(this,e)||this;return t.state={weeks:(0,_getCalendarMonthWeeks.default)(e.month,e.enableOutsideDays,null==e.firstDayOfWeek?_moment.default.localeData().firstDayOfWeek():e.firstDayOfWeek)},t.setCaptionRef=t.setCaptionRef.bind((0,_assertThisInitialized2.default)(t)),t.setMonthTitleHeight=t.setMonthTitleHeight.bind((0,_assertThisInitialized2.default)(t)),t}return e[!_react.default.PureComponent&&"shouldComponentUpdate"]=function(e,t){return!(0,_enzymeShallowEqual.default)(this.props,e)||!(0,_enzymeShallowEqual.default)(this.state,t)},e.componentDidMount=function(){this.setMonthTitleHeightTimeout=setTimeout(this.setMonthTitleHeight,0)},e.componentWillReceiveProps=function(e){var t=e.month,r=e.enableOutsideDays,a=e.firstDayOfWeek,n=this.props,o=n.month,i=n.enableOutsideDays,l=n.firstDayOfWeek;t.isSame(o)&&r===i&&a===l||this.setState({weeks:(0,_getCalendarMonthWeeks.default)(t,r,null==a?_moment.default.localeData().firstDayOfWeek():a)})},e.componentWillUnmount=function(){this.setMonthTitleHeightTimeout&&clearTimeout(this.setMonthTitleHeightTimeout)},e.setMonthTitleHeight=function(){var e=this.props.setMonthTitleHeight;e&&e((0,_calculateDimension.default)(this.captionRef,"height",!0,!0))},e.setCaptionRef=function(e){this.captionRef=e},e.render=function(){var e=this.props,r=e.dayAriaLabelFormat,a=e.daySize,n=e.focusedDate,t=e.horizontalMonthPadding,o=e.isFocused,i=e.isVisible,l=e.modifiers,s=e.month,u=e.monthFormat,p=e.onDayClick,d=e.onDayMouseEnter,c=e.onDayMouseLeave,f=e.onMonthSelect,h=e.onYearSelect,_=e.orientation,y=e.phrases,m=e.renderCalendarDay,D=e.renderDayContents,b=e.renderMonthElement,M=e.renderMonthText,S=e.styles,T=e.verticalBorderSpacing,g=this.state.weeks,C=M?M(s):s.format(u),O=_===_constants.VERTICAL_SCROLLABLE;return _react.default.createElement("div",(0,_extends2.default)({},(0,_reactWithStyles.css)(S.CalendarMonth,{padding:"0 ".concat(t,"px")}),{"data-visible":i}),_react.default.createElement("div",(0,_extends2.default)({ref:this.setCaptionRef},(0,_reactWithStyles.css)(S.CalendarMonth_caption,O&&S.CalendarMonth_caption__verticalScrollable)),b?b({month:s,onMonthSelect:f,onYearSelect:h,isVisible:i}):_react.default.createElement("strong",null,C)),_react.default.createElement("table",(0,_extends2.default)({},(0,_reactWithStyles.css)(!T&&S.CalendarMonth_table,T&&S.CalendarMonth_verticalSpacing,T&&{borderSpacing:"0px ".concat(T,"px")}),{role:"presentation"}),_react.default.createElement("tbody",null,g.map(function(e,t){return _react.default.createElement(_CalendarWeek.default,{key:t},e.map(function(e,t){return m({key:t,day:e,daySize:a,isOutsideDay:!e||e.month()!==s.month(),tabIndex:i&&(0,_isSameDay.default)(e,n)?0:-1,isFocused:o,onDayMouseEnter:d,onDayMouseLeave:c,onDayClick:p,renderDayContents:D,phrases:y,modifiers:l[(0,_toISODateString.default)(e)],ariaLabelFormat:r})}))}))))},t}(_react.default.PureComponent||_react.default.Component);CalendarMonth.propTypes="production"!==process.env.NODE_ENV?propTypes:{},CalendarMonth.defaultProps=defaultProps;var _default=(0,_reactWithStyles.withStyles)(function(e){var t=e.reactDates,r=t.color,a=t.font,n=t.spacing;return{CalendarMonth:{background:r.background,textAlign:"center",verticalAlign:"top",userSelect:"none"},CalendarMonth_table:{borderCollapse:"collapse",borderSpacing:0},CalendarMonth_verticalSpacing:{borderCollapse:"separate"},CalendarMonth_caption:{color:r.text,fontSize:a.captionSize,textAlign:"center",paddingTop:n.captionPaddingTop,paddingBottom:n.captionPaddingBottom,captionSide:"initial"},CalendarMonth_caption__verticalScrollable:{paddingTop:12,paddingBottom:7}}},{pureComponent:void 0!==_react.default.PureComponent})(CalendarMonth);exports.default=_default;
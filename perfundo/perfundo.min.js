!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.perfundo=t()}(this,function(){"use strict";"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var e,n=(function(e,t){e.exports=function(){function o(e,t){return void 0!==e?e:t}return function(t,e){var i,r,a={min_move_x:o((e=e||{}).min_move_x,20),min_move_y:o(e.min_move_y,20),wipeLeft:e.wipeLeft||function(){},wipeRight:e.wipeRight||function(){},wipeUp:e.wipeUp||function(){},wipeDown:e.wipeDown||function(){},preventDefaultEvents:o(e.preventDefaultEvents,!0)},c=!1;function l(){t.removeEventListener("touchmove",n),i=null,c=!1}function n(e){if(a.preventDefaultEvents&&e.preventDefault(),c){var t=e.touches[0].pageX,n=e.touches[0].pageY,s=i-t,o=r-n;Math.abs(s)>=a.min_move_x?(l(),0<s?a.wipeLeft(e):a.wipeRight(e)):Math.abs(o)>=a.min_move_y&&(l(),0<o?a.wipeDown(e):a.wipeUp(e))}}function s(e){1===e.touches.length&&(i=e.touches[0].pageX,r=e.touches[0].pageY,c=!0,t.addEventListener("touchmove",n))}return t.addEventListener("touchstart",s),{unbind:function(){t.removeEventListener("touchstart",s)}}}}()}(e={exports:{}},e.exports),e.exports);function s(s,o,i){return Object.keys(i).reduce(function(e,t){var n=s.getAttribute("data-"+t.toLowerCase());return e[t]=null!==n?n:t in o?o[t]:i[t],e},{})}var o={disableHistory:!1,swipe:!0,keyboard:!0,rootAttribute:"data-perfundo",classNames:{link:"js-perfundo-link",overlay:"js-perfundo-overlay",close:"js-perfundo-close",prev:"js-perfundo-prev",next:"js-perfundo-next",active:"is-active"}};function l(t,e){var i=this,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},s=t.configure,o=t.context,r=t.defaultOptions,a=t.swipe,c="string"==typeof e?o.querySelectorAll(e):e;return 1<c.length?[].slice.call(c).map(function(e){return new l(t,e,n)}):(this.context=o,this.element=c[0]||c,this.options=s(this.element,n,r),this.hasPrev=null!==this.element.querySelector("."+this.options.classNames.prev),this.hasNext=null!==this.element.querySelector("."+this.options.classNames.next),this.element.setAttribute(this.options.rootAttribute,!0),this.options.disableHistory&&this.element.addEventListener("click",function(e){e.preventDefault();var t=e.target.classList.contains(i.options.classNames.link)||e.target.parentElement.classList.contains(i.options.classNames.link),n=e.target.classList.contains(i.options.classNames.close)||e.target.classList.contains(i.options.classNames.overlay),s=e.target.classList.contains(i.options.classNames.prev),o=e.target.classList.contains(i.options.classNames.next);t?i.open():n?i.close():s?i.prev():o&&i.next()}),this.options.keyboard&&this.element.addEventListener("keyup",function(e){i.hasPrev&&37===e.keyCode?i.prev():i.hasNext&&39===e.keyCode&&i.next()}),this.options.swipe&&a(this.element,{wipeLeft:function(){return i.next()},wipeRight:function(){return i.prev()},preventDefaultEvents:this.options.disableHistory}),this)}l.prototype.open=function(){this.element.querySelector("."+this.options.classNames.link).focus(),this.element.querySelector("."+this.options.classNames.overlay).classList.add(this.options.classNames.active)},l.prototype.close=function(){this.element.querySelector("."+this.options.classNames.overlay).classList.remove(this.options.classNames.active)},l.prototype.prev=function(){try{var e=this.element.querySelector("."+this.options.classNames.prev),t=this.context.querySelector(""+e.getAttribute("href")),n=this.getRootElement(t);this.close(),n.querySelector("."+this.options.classNames.link).click()}catch(e){throw new Error("Previous item not found.")}},l.prototype.next=function(){try{var e=this.element.querySelector("."+this.options.classNames.next),t=this.context.querySelector(""+e.getAttribute("href")),n=this.getRootElement(t);this.close(),n.querySelector("."+this.options.classNames.link).click()}catch(e){throw new Error("Next item not found.")}},l.prototype.getRootElement=function(e){for(var t=e.parentElement;t&&t!==this.context;){if(t.hasAttribute(this.options.rootAttribute))return t;t=t.parentElement}return null};return function(e,t){return new l({configure:s,context:2<arguments.length&&void 0!==arguments[2]?arguments[2]:document,defaultOptions:o,swipe:n},e,t)}});
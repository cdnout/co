function FrequencyAnalyzerVisualization(){this.id="frequency_analyzer_visualization",this.name="Frequency Analyzer Visualization",this.container="",this.preferences={width:500,height:500,inherit:!0,type:"gradient",red:50,green:240,blue:50},this.analyser="",this.canvas=document.createElement("canvas"),this.canvasHeight="",this.canvasWidth="",this.buffer="",this.audioArray="",this.context="",this.barWidth="",this.barHeight="",this.x=0,this.requestAnimation="",this.getID=function(){return this.id},this.getName=function(){return this.name},this.setPreferences=function(t){for(var i in this.preferences)null!=t[i]&&(this.preferences[i]=t[i])},this.startVisualization=function(t){switch(this.analyser=Amplitude.getAnalyser(),this.container=t,this.preferences.inherit&&(this.preferences.width=this.container.offsetWidth,this.preferences.height=this.container.offsetHeight),this.canvas.height=this.preferences.height,this.canvas.width=this.preferences.width,this.analyser.fftSize=256,this.canvasHeight=this.canvas.height,this.canvasWidth=this.canvas.width,this.buffer=this.analyser.frequencyBinCount,this.audioArray=new Uint8Array(this.buffer),this.context=this.canvas.getContext("2d"),this.barWidth=this.canvasWidth/this.buffer*2,this.container.appendChild(this.canvas),this.preferences.type){case"gradient":this.renderGradientAnimation();break;case"dynamic":this.renderDynamicColorAnimation();break;case"single":this.renderSingleColorAnimation()}},this.renderGradientAnimation=function(){this.requestAnimation=requestAnimationFrame(this.renderGradientAnimation.bind(this)),this.x=0,this.analyser.getByteFrequencyData(this.audioArray),this.context.fillStyle="black",this.context.fillRect(0,0,this.canvasWidth,this.canvasHeight);var t=this.context.createLinearGradient(0,0,0,this.canvasHeight);t.addColorStop(1,"#00ff00"),t.addColorStop(.5,"#ff8000"),t.addColorStop(0,"#e60000");for(var i=0;i<this.buffer;i++)this.barHeight=this.audioArray[i]-50,this.context.fillStyle=t,this.context.fillRect(this.x,this.canvasHeight-this.canvasWidth,this.barWidth,this.barHeight),this.x+=this.barWidth+1},this.renderDynamicColorAnimation=function(){this.requestAnimation=requestAnimationFrame(this.renderDynamicColorAnimation.bind(this)),this.x=0,this.analyser.getByteFrequencyData(this.audioArray),this.context.fillStyle="#000",this.context.fillRect(0,0,this.canvasWidth,this.canvasHeight);for(var t=0;t<this.buffer;t++)this.barHeight=this.audioArray[t]/2,this.preferences.red=t/this.buffer*100,this.preferences.blue=150,this.preferences.green=this.barHeight+t/this.buffer*100,this.context.fillStyle="rgb("+this.preferences.red+", "+this.preferences.green+", "+this.preferences.blue+")",this.context.fillRect(this.x,this.canvasHeight-this.barHeight,this.barWidth,this.barHeight),this.x+=this.barWidth+1},this.renderSingleColorAnimation=function(){this.requestAnimation=requestAnimationFrame(this.renderSingleColorAnimation.bind(this)),this.x=0,this.analyser.getByteFrequencyData(this.audioArray),this.context.fillStyle="#000",this.context.fillRect(0,0,this.canvasWidth,this.canvasHeight);for(var t=0;t<this.buffer;t++)this.barHeight=this.audioArray[t]/2,this.context.fillStyle="rgb("+this.preferences.red+", "+this.preferences.green+", "+this.preferences.blue+")",this.context.fillRect(this.x,this.canvasHeight-this.barHeight,this.barWidth,this.barHeight),this.x+=this.barWidth+1},this.stopVisualization=function(){cancelAnimationFrame(this.requestAnimation),this.container.innerHTML=""}}
function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const GeneralWorker=require("../GeneralWorker"),AsyncFunction=Object.getPrototypeOf(async function(){}).constructor;class SimulatedWorker extends GeneralWorker{constructor(e){super(...arguments),_defineProperty(this,"postMessage",e=>{this._debug&&this._log({taskId:e.id,action:"send_task_to_actual_worker",message:`sending taskId(${e.id}) to worker process`});let t=[],r=Object.keys(e).filter(function(e){return e.match(/^argument/)}).sort(function(e,t){return parseInt(e.slice(8),10)-parseInt(t.slice(8),10)}).map(function(r){return t.push(r),e[r]});new AsyncFunction(...t,`\n\t\t\tthis.global.global = this.global;\n\n\n\t\t\twith (this.global) {\n\t\t\t\treturn (${e.func})(...arguments);\n\t\t\t}`).bind(this._context)(...r).then(t=>{this.handleWorkerMessage({id:e.id,result:t})}).catch(t=>{this.handleWorkerMessage({id:e.id,error:t.stack})})}),_defineProperty(this,"terminate",()=>{this._debug&&this._log({action:"terminated"})}),e=e||{},this._context={global:{require:require,Promise:Promise}},this._alive=!0,this._debug&&this._log({action:"initialized"})}_log(e){let t={source:"worker_thread",managerId:this.managerId,workerId:this.id,processId:"SIMULATED"};Object.keys(e).forEach(r=>{t[r]=e[r]}),t.message||(t.message=t.action),this._logger(t)}}module.exports=SimulatedWorker;
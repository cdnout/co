!function(A){A.extend(!0,window,{Slick:{Plugins:{RowDetailView:function(e){var r,d,u,c,p="id",n=null,o=this,i=null,l=[],t=new Slick.EventHandler,s=5,a=0,w={columnId:"_detail_selector",cssClass:"detailView-toggle",expandedClass:null,collapsedClass:null,keyPrefix:"_",loadOnce:!1,collapseAllOnSort:!0,saveDetailViewOnScroll:!0,singleRowExpand:!1,useSimpleViewportCalc:!1,alwaysRenderColumn:!0,toolTip:"",width:30,maxRows:null},g=w.keyPrefix,f=0,m=[],R=A.extend(!0,{},w,e);"function"==typeof R.expandableOverride&&k(R.expandableOverride);function v(e,t){if(e)for(var i=0;i<e.length;i++)if(e[i]===t)return i;return-1}function h(e,t){var i=r.getDataItem(t.row);if(E(t.row,i,r)&&(R.useRowClick||r.getColumns()[t.cell].id===R.columnId&&A(e.target).hasClass(R.cssClass))){if(r.getEditorLock().isActive()&&!r.getEditorLock().commitCurrentEdit())return e.preventDefault(),void e.stopImmediatePropagation();o.onBeforeRowDetailToggle.notify({grid:r,item:i},e,o),E(t.row,t=i,r)&&(c.beginUpdate(),function(e){e&&(e[g+"collapsed"]?I:V)(e)}(t),c.endUpdate()),o.onAfterRowDetailToggle.notify({grid:r,item:i,expandedRows:l},e,o),e.stopPropagation(),e.stopImmediatePropagation()}}function b(e,t){(R.useSimpleViewportCalc?function(){{var i;r&&(i=r.getRenderedRange(),l.forEach(function(e){var t=function(e,t){if(Math.abs(t.bottom-f-e)>2*a)return!0;return!1}(c.getRowById(e[p]),i);!t&&0<=v(m,e[p])?y(e,e[p]):t&&x(e,e[p])}))}}:function(){if(r){var o=r.getRenderedRange();if(0<l.length){var a="DOWN";if(i){if(i.top===o.top&&i.bottom===o.bottom)return;(i.top>o.top||0===i.top&&0===o.top&&i.bottom>o.bottom)&&(a="UP")}}l.forEach(function(e){var t=c.getRowById(e[p]),i=e[g+"sizePadding"],n=0<=v(m,e[p]);"UP"===a?(R.saveDetailViewOnScroll&&t>=o.bottom-f&&P(e),n&&t-s<o.top&&t>=o.top?y(e,e[p]):!n&&t+i>o.bottom&&x(e,e[p])):"DOWN"===a&&(R.saveDetailViewOnScroll&&t<=o.top+f&&P(e),n&&t+i+s>o.bottom&&t<t+i?y(e,e[p]):!n&&t<o.top&&x(e,e[p]))}),i=o}})()}function x(e,t){var i=e.rowIndex||c.getRowById(e[p]);o.onRowOutOfViewportRange.notify({grid:r,item:e,rowId:t,rowIndex:i,expandedRows:l,rowIdsOutOfViewport:C(t,!0)},null,o)}function y(e,t){var i=e.rowIndex||c.getRowById(e[p]);setTimeout(function(){A(".cellDetailView_"+e[p]).length&&o.onRowBackToViewportRange.notify({grid:r,item:e,rowId:t,rowIndex:i,expandedRows:l,rowIdsOutOfViewport:C(t,!1)},null,o)},100)}function C(e,t){var i=v(m,e);return t&&i<0?m.push(e):!t&&0<=i&&m.splice(i,1),m}function D(){c.beginUpdate();for(var e=l.length-1;0<=e;e--)V(l[e],!0);c.endUpdate()}function V(t,e){e||c.beginUpdate(),R.loadOnce&&P(t),t[g+"collapsed"]=!0;for(var i=1;i<=t[g+"sizePadding"];i++)c.deleteItem(t[p]+"."+i);t[g+"sizePadding"]=0,c.updateItem(t[p],t),l=l.filter(function(e){return e[p]!==t[p]}),e||c.endUpdate()}function I(e){if(R&&R.singleRowExpand&&D(),e[g+"collapsed"]=!1,l.push(e),e[g+"detailContent"]||(e[g+"detailViewLoaded"]=!1),e[g+"detailViewLoaded"]&&!0===R.loadOnce)return o.onAsyncResponse.notify({item:e,itemDetail:e,detailView:e[g+"detailContent"]},void 0,this),S(e),void c.updateItem(e[p],e);e[g+"detailContent"]=R.preTemplate(e),S(e),c.updateItem(e[p],e),R.process(e)}function P(e){var t;!A("."+u+" .innerDetailView_"+e[p])||void 0!==(t=A("."+u+" .innerDetailView_"+e[p]).html())&&(e[g+"detailContent"]=t)}var O=function(e,t){var i,n={};for(i in r.getData())n[i]=null;return n[p]=e[p]+"."+t,n[g+"collapsed"]=!0,n[g+"isPadding"]=!0,n[g+"parent"]=e,n[g+"offset"]=t,n};function S(e){var t=R.panelRows;e[g+"sizePadding"]=Math.ceil(2*t*13/d.rowHeight),e[g+"height"]=e[g+"sizePadding"]*d.rowHeight;for(var i=c.getIdxById(e[p]),n=1;n<=e[g+"sizePadding"];n++)c.insertItem(i+n,O(e,n))}function z(e,t,i,n,o,a){if(!E(e,o,a))return null;if(null==o[g+"collapsed"]&&(o[g+"collapsed"]=!0,o[g+"sizePadding"]=0,o[g+"height"]=0,o[g+"isPadding"]=!1,o[g+"parent"]=void 0,o[g+"offset"]=0),o[g+"isPadding"])return null;if(o[g+"collapsed"]){var l=R.cssClass+" expand ";return R.collapsedClass&&(l+=R.collapsedClass),'<div class="'+l+'"></div>'}var s=[],e=d.rowHeight,a=o[g+"sizePadding"]*d.rowHeight;null!==R.maxRows&&o[g+"sizePadding"]>R.maxRows&&(a=R.maxRows*e,o[g+"sizePadding"]=R.maxRows);l=R.cssClass+" collapse ";return R.expandedClass&&(l+=R.expandedClass),s.push('<div class="'+l+'"></div></div>'),s.push('<div class="dynamic-cell-detail cellDetailView_',o[p],'" '),s.push('style="height:',a,"px;"),s.push("top:",e,'px">'),s.push('<div class="detail-container detailViewContainer_',o[p],'">'),s.push('<div class="innerDetailView_',o[p],'">',o[g+"detailContent"],"</div></div>"),s.join("")}function E(e,t,i){return"function"!=typeof n||n(e,t,i)}function k(e){n=e}A.extend(this,{init:function(e){if(!e)throw new Error('RowDetailView Plugin requires the Grid instance to be passed as argument to the "init()" method');u=(r=e).getUID(),d=e.getOptions()||{},c=r.getData(),g=R&&R.keyPrefix||"_",f=r.getOptions().minRowBuffer,r.getOptions().minRowBuffer=R.panelRows+3,t.subscribe(r.onClick,h).subscribe(r.onScroll,b),R.collapseAllOnSort&&(t.subscribe(r.onSort,D),l=[],m=[]),t.subscribe(r.getData().onRowCountChanged,function(){r.updateRowCount(),r.render()}),t.subscribe(r.getData().onRowsChanged,function(e,t){r.invalidateRows(t.rows),r.render()}),o.onAsyncResponse.subscribe(function(e,t){if(!t||!t.item&&!t.itemDetail)throw'Slick.RowDetailView plugin requires the onAsyncResponse() to supply "args.item" property.';var i=t.item||t.itemDetail;t.detailView?i[g+"detailContent"]=t.detailView:i[g+"detailContent"]=R.postTemplate(i),i[g+"detailViewLoaded"]=!0,c.updateItem(i[p],i),o.onAsyncEndUpdate.notify({grid:r,item:i,itemDetail:i},e,o)}),t.subscribe(c.onSetItemsCalled,function(e,t){p=c&&c.getIdPropertyName()||"id"}),R.useSimpleViewportCalc&&t.subscribe(r.onRendered,function(e,t){t&&t.endRow&&(a=t.endRow-t.startRow)})},destroy:function(){t.unsubscribeAll(),o.onAsyncResponse.unsubscribe(),o.onAsyncEndUpdate.unsubscribe(),o.onAfterRowDetailToggle.unsubscribe(),o.onBeforeRowDetailToggle.unsubscribe(),o.onRowOutOfViewportRange.unsubscribe(),o.onRowBackToViewportRange.unsubscribe()},pluginName:"RowDetailView",collapseAll:D,collapseDetailView:V,expandDetailView:I,expandableOverride:k,getColumnDefinition:function(){return{id:R.columnId,name:"",toolTip:R.toolTip,field:"sel",width:R.width,resizable:!1,sortable:!1,alwaysRenderColumn:R.alwaysRenderColumn,cssClass:R.cssClass,formatter:z}},getExpandedRows:function(){return l},getFilterItem:function(e){return e=e[g+"isPadding"]&&e[g+"parent"]?e[g+"parent"]:e},getOptions:function(){return R},resizeDetailView:function(e){if(e){var t=document.querySelector("."+u+" .detailViewContainer_"+e[p]),i=document.querySelector("."+u+" .cellDetailView_"+e[p]),n=document.querySelector("."+u+" .innerDetailView_"+e[p]);if(t&&i&&n){for(var o=1;o<=e[g+"sizePadding"];o++)c.deleteItem(e[p]+"."+o);var a=d.rowHeight;t.style.minHeight=null;var l=t.scrollHeight,n=Math.ceil(l/a);e[g+"sizePadding"]=Math.ceil(2*n*13/a),e[g+"height"]=l;l=e[g+"sizePadding"]*a;null!==R.maxRows&&e[g+"sizePadding"]>R.maxRows&&(l=R.maxRows*a,e[g+"sizePadding"]=R.maxRows),r.getOptions().minRowBuffer<e[g+"sizePadding"]&&(r.getOptions().minRowBuffer=e[g+"sizePadding"]+3),t.setAttribute("style","min-height: "+e[g+"height"]+"px"),i&&i.setAttribute("style","height: "+l+"px; top:"+a+"px");for(var s=c.getIdxById(e[p]),o=1;o<=e[g+"sizePadding"];o++)c.insertItem(s+o,O(e,o));P(e)}}},saveDetailView:P,setOptions:function(e){(R=A.extend(!0,{},R,e))&&R.singleRowExpand&&D()},onAsyncResponse:new Slick.Event,onAsyncEndUpdate:new Slick.Event,onAfterRowDetailToggle:new Slick.Event,onBeforeRowDetailToggle:new Slick.Event,onRowOutOfViewportRange:new Slick.Event,onRowBackToViewportRange:new Slick.Event})}}}})}(jQuery);
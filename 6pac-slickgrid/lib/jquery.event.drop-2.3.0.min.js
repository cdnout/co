!function(h){h.fn.drop=function(t,e,a){var n="string"==typeof t?t:"",i=h.isFunction(t)?t:h.isFunction(e)?e:null;return 0!==n.indexOf("drop")&&(n="drop"+n),a=(t==i?e:a)||{},i?this.on(n,a,i):this.trigger(n)},h.drop=function(t){f.multi=!0===(t=t||{}).multi?1/0:!1===t.multi?1:(isNaN(t.multi)?f:t).multi,f.delay=t.delay||f.delay,f.tolerance=h.isFunction(t.tolerance)?t.tolerance:null===t.tolerance?null:f.tolerance,f.mode=t.mode||f.mode||"intersect"};var m=h.event.special,f=h.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(t){h.data(this,f.datakey).related+=1},remove:function(){--h.data(this,f.datakey).related},setup:function(){h.data(this,f.datakey)||(h.data(this,f.datakey,{related:0,active:[],anyactive:0,winner:0,location:{}}),f.targets.push(this))},teardown:function(){var e;(h.data(this,f.datakey)||{}).related||(h.removeData(this,f.datakey),e=this,f.targets=h.grep(f.targets,function(t){return t!==e}))},handler:function(t,e){var a;if(e)switch(t.type){case"mousedown":case"touchstart":a=h(f.targets),(a="string"==typeof e.drop?a.filter(e.drop):a).each(function(){var t=h.data(this,f.datakey);t.active=[],t.anyactive=0,t.winner=0}),e.droppable=a,m.drag.hijack(t,"dropinit",e);break;case"mousemove":case"touchmove":f.event=t,f.timer||f.tolerate(e);break;case"mouseup":case"touchend":f.timer=clearTimeout(f.timer),e.propagates&&(m.drag.hijack(t,"drop",e),m.drag.hijack(t,"dropend",e))}},locate:function(t,e){var a=h.data(t,f.datakey),n=h(t),i=n.length&&!n.is(document)?n.offset():{},o=n.outerHeight(),n=n.outerWidth(),o={elem:t,width:n,height:o,top:i.top,left:i.left,right:i.left+n,bottom:i.top+o};return a&&(a.location=o,a.index=e,a.elem=t),o},contains:function(t,e){return(e[0]||e.left)>=t.left&&(e[0]||e.right)<=t.right&&(e[1]||e.top)>=t.top&&(e[1]||e.bottom)<=t.bottom},modes:{intersect:function(t,e,a){return this.contains(a,[t.pageX,t.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(t,e,a){return Math.max(0,Math.min(a.bottom,e.bottom)-Math.max(a.top,e.top))*Math.max(0,Math.min(a.right,e.right)-Math.max(a.left,e.left))},fit:function(t,e,a){return this.contains(a,e)?1:0},middle:function(t,e,a){return this.contains(a,[e.left+.5*e.width,e.top+.5*e.height])?1:0}},sort:function(t,e){return e.winner-t.winner||t.index-e.index},tolerate:function(t){var e,a,n,i,o,r,d,c,l=0,s=t.interactions.length,u=[f.event.pageX,f.event.pageY],p=f.tolerance||f.modes[f.mode];do{if(c=t.interactions[l]){if(!c)return;c.drop=[],o=[],r=c.droppable.length,p&&(n=f.locate(c.proxy)),e=0;do{if(d=c.droppable[e]){if(!(a=(i=h.data(d,f.datakey)).location))continue;i.winner=p?p.call(f,f.event,n,a):f.contains(a,u)?1:0,o.push(i)}}while(++e<r);for(o.sort(f.sort),e=0;(i=o[e])&&(i.winner&&c.drop.length<f.multi?(i.active[l]||i.anyactive||(!1!==m.drag.hijack(f.event,"dropstart",t,l,i.elem)[0]?(i.active[l]=1,i.anyactive+=1):i.winner=0),i.winner&&c.drop.push(i.elem)):i.active[l]&&1==i.anyactive&&(m.drag.hijack(f.event,"dropend",t,l,i.elem),i.active[l]=0,--i.anyactive)),++e<r;);}}while(++l<s);f.last&&u[0]==f.last.pageX&&u[1]==f.last.pageY?delete f.timer:f.timer=setTimeout(function(){f.tolerate(t)},f.delay),f.last=f.event}};m.dropinit=m.dropstart=m.dropend=f}(jQuery);
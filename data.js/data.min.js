/*!
 * data.js v0.3.0 (https://github.com/yanhaijing/data.js)
 * Copyright 2013 yanhaijing. All Rights Reserved
 * Licensed under MIT (https://github.com/yanhaijing/data.js/blob/master/MIT-LICENSE.txt)
 */
(function(a,c){var d=c(a);if(typeof define==="function"&&define.amd){define("data",function(){return d})}else{if(typeof exports==="object"){module.exports=d}else{var b=a.Data;d.noConflict=function(){if(a.Data===d){a.Data=b}return d};a.Data=d}}}(this,function(n){var q=[].slice;var i={};var b=i.toString;var k=i.hasOwnProperty;var c=0;function l(r){if(r===null){return"null"}var s=typeof r;if(s!=="object"){return s}var v;try{v=b.call(r).slice(8,-1).toLowerCase()}catch(u){return"unknow"}if(v!=="object"){return v}if(r.constructor===Object){return v}return"unknow"}function j(r){return l(r)==="function"}function g(r){return Array.isArray?Array.isArray(r):l(r)==="array"}function e(r){return l(r)==="object"}function m(){var x=arguments[0]||{};var z=q.call(arguments,1);var w=z.length;var A;var y;for(var u=0;u<w;u++){var v=z[u];for(var t in v){var r=x[t];var s=v[t];if(x===s){continue}if(!k.call(v,t)){continue}if(s&&(e(s)||(A=g(s)))){if(A){A=false;y=r&&g(r)?r:[]}else{y=r&&e(r)?r:{}}x[t]=m(y,s)}else{if(typeof s!=="undefined"){x[t]=s}}}}return x}function f(t,u,s,v){t=t[u][s];if(e(t)){for(var r in t){if(t.hasOwnProperty(r)){t[r]({type:u,key:s,data:v})}}}}function d(y,A,u,r){var v;for(var t in r){var B=u[t];var s=r[t];var z;var x=false;var w=false;if(u===s){continue}if(!k.call(r,t)){continue}if(typeof s==="undefined"){w=true}else{if(typeof u[t]==="undefined"){x=true}}v=(typeof y==="undefined"?"":(y+"."))+t;if(s&&(e(s)||(z=g(s)))){if(z){z=false;u[t]=B&&g(B)?B:[]}else{u[t]=B&&e(B)?B:{}}u[t]=d(v,A,u[t],s)}else{u[t]=s}f(A,"set",v,u[t]);if(w){f(A,"delete",v,u[t])}else{if(x){f(A,"add",v,u[t])}else{f(A,"update",v,u[t])}}}return u}function a(r){return r.split(".")}function p(r){if(e(r)){return m({},r)}if(g(r)){return m([],r)}return r}var o=function(){if(!(this instanceof o)){return new o()}this._init()};m(o.prototype,{_init:function(){this._context={};this._events={set:{},"delete":{},add:{},update:{}}},set:function(v,y){var s=this._context;if(typeof v!=="string"){return false}var w=a(v);var r=w.length;var u=0;var t;var x;if(r<2){x={};x[v]=y;d(undefined,this._events,s,x);return true}for(;u<r-1;u++){t=w[u];if(!g(s[t])&&!e(s[t])){if(typeof y==="undefined"){return false}s[t]=isNaN(Number(t))?{}:[]}s=s[t]}t=w.pop();x=g(s)?[]:{};x[t]=y;s=d(w.join("."),this._events,s,x);return true},get:function(v){if(typeof v!=="string"){return undefined}var w=a(v);var r=w.length;var u=0;var s=this._context;var t;for(;u<r;u++){t=w[u];s=s[t];if(typeof s==="undefined"||s===null){return s}}return p(s)},has:function(r){return typeof this.get(r)==="undefined"?false:true},sub:function(t,s,u){if(typeof t!=="string"||typeof s!=="string"||!j(u)){return -1}if(!(t in this._events)){return -2}var r=this._events[t];r[s]=r[s]||{};r[s][c++]=u;return c-1},unsub:function(t,s,u){if(typeof t!=="string"||typeof s!=="string"){return false}if(!(t in this._events)){return false}var r=this._events[t];if(!e(r[s])){return false}if(typeof u!=="number"){delete r[s];return true}delete r[s][u];return true},_clear:function(){return this._init()}});var h=new o();m(o,{version:"0.3.0",has:function(r){return h.has(r)},get:function(r){return h.get(r)},set:function(r,s){return h.set(r,s)},sub:function(s,r,t){return h.sub(s,r,t)},unsub:function(s,r,t){return h.unsub(s,r,t)},_clear:function(){return h._clear()}});return o}));
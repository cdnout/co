!function(n){"use strict";"function"==typeof define&&define.amd?define(function(e,r,t){t.exports=n(e("devextreme/core/utils/ajax"),e("jquery").Deferred,e("jquery").extend,e("devextreme/data/custom_store"),e("devextreme/data/utils"))}):"object"==typeof module&&module.exports?module.exports=n(require("devextreme/core/utils/ajax"),require("jquery").Deferred,require("jquery").extend,require("devextreme/data/custom_store"),require("devextreme/data/utils")):DevExpress.data.AspNet=n(DevExpress.utils.ajax||{sendRequest:jQuery.ajax},jQuery.Deferred,jQuery.extend,DevExpress.data.CustomStore,DevExpress.data.utils)}(function(m,g,v,r,x){"use strict";var j=["onLoading","onLoaded","onInserting","onInserted","onUpdating","onUpdated","onRemoving","onRemoved","onModifying","onModified","onPush","loadMode","cacheRawData","errorHandler"];function t(t){var d=t.key,n=t.loadUrl,o=t.loadMethod||"GET",a=t.loadParams,e="raw"===t.loadMode,u=t.updateUrl,r=t.insertUrl,i=t.deleteUrl,s=t.onBeforeSend,f=t.onAjaxError;function l(e,r,t,n){var o,u,a=g();function i(){m.sendRequest(t).then(function(e,r,t){n?n(a,e,t):a.resolve()},function(e,r){var t,n=function(e){var r=e.getResponseHeader("Content-Type"),e=e.responseText;if(!r)return null;if(0===r.indexOf("text/plain"))return e;if(0!==r.indexOf("application/json"))return null;var t=function(e){try{return JSON.parse(e)}catch(e){return null}}(e);if("string"==typeof t)return t;if("object"==typeof t)for(var n in t)if("string"==typeof t[n])return t[n];return e}(e);f&&(f(t={xhr:e,error:n}),n=t.error),n?a.reject(n):a.reject(e,r)})}return r&&!d?a.reject(new Error("Primary key is not specified (operation: '"+e+"', url: '"+t.url+"')")):("load"===e?(t.cache=!1,t.dataType="json"):t.dataType="text",s&&(u=s(e,t))&&"function"==typeof u.then&&(o=u),o?o.then(i,function(e){a.reject(e)}):i()),a.promise()}function c(r,e){var t,n,o,u={};return e&&(u.isCountQuery=e),r&&(["skip","take","requireTotalCount","requireGroupCount"].forEach(function(e){void 0!==r[e]&&(u[e]=r[e])}),t=x.normalizeSortingInfo,n=r.group,o=r.filter,e=r.select,r.sort&&(u.sort=JSON.stringify(t(r.sort))),n&&(function(e){if(!Array.isArray(e))return!1;for(var r=0;r<e.length;r++)if("groupInterval"in e[r]||"isExpanded"in e[r])return!0;return!1}(n)||(n=t(n)),u.group=JSON.stringify(n)),Array.isArray(o)&&(function t(n){n.forEach(function(e,r){Array.isArray(e)?t(e):"[object Date]"===Object.prototype.toString.call(e)&&(n[r]=O(e))})}(o=v(!0,[],o)),u.filter=JSON.stringify(o)),r.totalSummary&&(u.totalSummary=JSON.stringify(r.totalSummary)),r.groupSummary&&(u.groupSummary=JSON.stringify(r.groupSummary)),e&&(Array.isArray(e)||(e=[e]),u.select=JSON.stringify(e))),v(u,a),u}function y(e,r,t){t=t.getResponseHeader("Content-Type"),t=t&&-1<t.indexOf("application/json");e.resolve(t?JSON.parse(r):r)}var p={key:d,useDefaultSearch:!0,load:function(e){return l("load",!1,{url:n,method:o,data:c(e)},function(e,r){h(e,r,function(e){return[e.data,{totalCount:"totalCount"in(e=e)?e.totalCount:-1,groupCount:"groupCount"in e?e.groupCount:-1,summary:e.summary||null}]})})},totalCount:!e&&function(e){return l("load",!1,{url:n,method:o,data:c(e,!0)},function(e,r){h(e,r,function(e){return[e.totalCount]})})},byKey:!e&&function(e){return l("load",!0,{url:n,method:o,data:c({filter:(r=e,Array.isArray(d)?d.map(function(e){return[e,r[e]]}):[d,r])})},function(e,r){h(e,r,function(e){return[e.data[0]]})});var r},update:u&&function(e,r){return l("update",!0,{url:u,method:t.updateMethod||"PUT",data:{key:S(e),values:JSON.stringify(r)}},y)},insert:r&&function(e){return l("insert",!0,{url:r,method:t.insertMethod||"POST",data:{values:JSON.stringify(e)}},y)},remove:i&&function(e){return l("delete",!0,{url:i,method:t.deleteMethod||"DELETE",data:{key:S(e)}})}};return j.forEach(function(e){var r=t[e];void 0!==r&&(p[e]=r)}),p}function h(e,r,t){var n;n=r,(r=Array.isArray(n)?{data:n}:"number"==typeof n?{totalCount:n}:n)&&"object"==typeof r?e.resolve.apply(e,t(r)):e.reject(new Error("Unexpected response received"))}function S(e){return"object"==typeof e?JSON.stringify(e):e}function O(e){function r(e,r){for(e=String(e);e.length<r;)e="0"+e;return e}var t=[1+e.getMonth(),"/",e.getDate(),"/",e.getFullYear()],n=e.getHours(),o=e.getMinutes(),u=e.getSeconds(),e=e.getMilliseconds();return 0<n+o+u+e&&t.push(" ",r(n,2),":",r(o,2),":",r(u,2),".",r(e,3)),t.join("")}return{createStore:function(e){return new r(t(e))}}});
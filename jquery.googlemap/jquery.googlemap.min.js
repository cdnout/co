$(function(){$.fn.googleMap=function(o){switch((o=$.extend({zoom:10,coords:[48.895651,2.290569],type:"ROADMAP",debug:!1,langage:"english",overviewMapControl:!1,streetViewControl:!1,scrollwheel:!1,mapTypeControl:!1},o)).type){case"ROADMAP":case"SATELLITE":case"HYBRID":case"TERRAIN":o.type=google.maps.MapTypeId[o.type];break;default:o.type=google.maps.MapTypeId.ROADMAP}return this.each(function(){var e=new google.maps.Map(this,{zoom:o.zoom,center:new google.maps.LatLng(o.coords[0],o.coords[1]),mapTypeId:o.type,scrollwheel:o.scrollwheel,streetViewControl:o.streetViewControl,overviewMapControl:o.overviewMapControl,mapTypeControl:o.mapTypeControl});$(this).data("googleMap",e),$(this).data("googleLang",o.langage),$(this).data("googleDebug",o.debug),$(this).data("googleMarker",new Array),$(this).data("googleBound",new google.maps.LatLngBounds)}),this},$.fn.addMarker=function(l){return l=$.extend({coords:!1,address:!1,url:!1,id:!1,icon:!1,draggable:!1,title:"",text:"",success:function(){}},l),this.each(function(){if($this=$(this),!$this.data("googleMap"))return $this.data("googleDebug")&&console.error("jQuery googleMap : Unable to add a marker where there is no map !"),!1;if(!l.coords&&!l.address)return $this.data("googleDebug")&&console.error("jQuery googleMap : Unable to add a marker if you don't tell us where !"),!1;if(l.address&&"string"==typeof l.address)s=$this,(new google.maps.Geocoder).geocode({address:l.address,bounds:s.data("googleBound"),language:s.data("googleLang")},function(e,o){if(o==google.maps.GeocoderStatus.OK){if(s.data("googleBound").extend(e[0].geometry.location),l.icon)var a=new google.maps.Marker({map:$this.data("googleMap"),position:e[0].geometry.location,title:l.title,icon:l.icon,draggable:l.draggable});else a=new google.maps.Marker({map:s.data("googleMap"),position:e[0].geometry.location,title:l.title,draggable:l.draggable});if(l.draggable&&google.maps.event.addListener(a,"dragend",function(){var e=a.getPosition(),o={};o.lat=e.lat(),o.lon=e.lng(),l.success(o,$this)}),""==l.title||""==l.text||l.url)l.url&&google.maps.event.addListener(a,"click",function(){document.location=l.url});else{var t=new google.maps.InfoWindow({content:"<h1>"+l.title+"</h1>"+l.text}),g=s.data("googleMap");previous_infowindow=null,google.maps.event.addListener(a,"click",function(){null!==previous_infowindow&&previous_infowindow.close(g,a),t.open(g,a),previous_infowindow=t})}l.id?s.data("googleMarker")[l.id]=a:s.data("googleMarker").push(a),1==s.data("googleMarker").length?(s.data("googleMap").setCenter(e[0].geometry.location),s.data("googleMap").setZoom(s.data("googleMap").getZoom())):s.data("googleMap").fitBounds(s.data("googleBound"));var n={};for(var r in n.lat=e[0].geometry.location.lat(),n.lon=e[0].geometry.location.lng(),e[0].address_components)-1<e[0].address_components[r].types.indexOf("postal_code")&&(n.zipcode=e[0].address_components[r].long_name);l.success(n,$this)}else $this.data("googleDebug")&&console.error("jQuery googleMap : Unable to find the place asked for the marker ("+o+")")});else{if($this.data("googleBound").extend(new google.maps.LatLng(l.coords[0],l.coords[1])),l.icon)var a=new google.maps.Marker({map:$this.data("googleMap"),position:new google.maps.LatLng(l.coords[0],l.coords[1]),title:l.title,icon:l.icon,draggable:l.draggable});else a=new google.maps.Marker({map:$this.data("googleMap"),position:new google.maps.LatLng(l.coords[0],l.coords[1]),title:l.title,draggable:l.draggable});if(""==l.title||""==l.text||l.url)l.url&&google.maps.event.addListener(a,"click",function(){document.location=l.url});else{var e=new google.maps.InfoWindow({content:"<h1>"+l.title+"</h1>"+l.text}),o=$this.data("googleMap");previous_infowindow=null,google.maps.event.addListener(a,"click",function(){null!==previous_infowindow&&previous_infowindow.close(o,a),e.open(o,a),previous_infowindow=e})}l.draggable&&google.maps.event.addListener(a,"dragend",function(){var e=a.getPosition(),o={};o.lat=e.lat(),o.lon=e.lng(),l.success(o,$this)}),l.id?$this.data("googleMarker")[l.id]=a:$this.data("googleMarker").push(a),1==$this.data("googleMarker").length?($this.data("googleMap").setCenter(new google.maps.LatLng(l.coords[0],l.coords[1])),$this.data("googleMap").setZoom($this.data("googleMap").getZoom())):$this.data("googleMap").fitBounds($this.data("googleBound")),l.success({lat:l.coords[0],lon:l.coords[1]},$this)}var s}),this},$.fn.removeMarker=function(a){this.each(function(){var e=$(this);if(!e.data("googleMap"))return e.data("googleDebug")&&console.log("jQuery googleMap : Unable to delete a marker where there is no map !"),!1;var o=e.data("googleMarker");return void 0!==o[a]?(o[a].setMap(null),e.data("googleDebug")&&console.log("jQuery googleMap : marker deleted"),!0):(e.data("googleDebug")&&console.error("jQuery googleMap : Unable to delete a marker if it not exists !"),!1)})},$.fn.addWay=function(t){t=$.extend({start:!1,end:!1,step:[],route:!1,langage:"english"},t);var g=new google.maps.DirectionsService({region:"fr"}),n=new google.maps.DirectionsRenderer({draggable:!0,map:$(this).data("googleMap"),panel:document.getElementById(t.route),provideTripAlternatives:!0});document.getElementById.innerHTML="";var r,s=[];for(var e in t.step){var o;o="object"==typeof t.step[e]?new google.maps.LatLng(t.step[e][0],t.step[e][1]):t.step[e],s.push({location:o,stopover:!0})}if("object"!=typeof t.end)r=$(this),(new google.maps.Geocoder).geocode({address:t.end,bounds:r.data("googleBound"),language:t.langage},function(e,o){if(o==google.maps.GeocoderStatus.OK){var a={origin:t.start,destination:e[0].geometry.location,travelMode:google.maps.DirectionsTravelMode.DRIVING,region:"fr",waypoints:s};g.route(a,function(e,o){o==google.maps.DirectionsStatus.OK?n.setDirections(e):r.data("googleDebug")&&console.error("jQuery googleMap : Unable to find the place asked for the route ("+e+")")})}else r.data("googleDebug")&&console.error("jQuery googleMap : Address not found")});else{var a={origin:t.start,destination:new google.maps.LatLng(t.end[0],t.end[1]),travelMode:google.maps.DirectionsTravelMode.DRIVING,region:"fr",waypoints:s};g.route(a,function(e,o){o==google.maps.DirectionsStatus.OK?n.setDirections(e):$(this).data("googleDebug")&&console.error("jQuery googleMap : Address not found")})}return this}});
Array.prototype.map||(Array.prototype.map=function(e){"use strict";var n,t,r,o;if(null==this)throw new TypeError;if(t=(n=Object(this)).length>>>0,"function"!=typeof e)throw new TypeError;r=new Array(t),o=2<=arguments.length?arguments[1]:void 0;for(var i=0;i<t;i++)i in n&&(r[i]=e.call(o,n[i],i,n));return r}),Wkt.Wkt.prototype.isRectangle=!1,Wkt.Wkt.prototype.construct={point:function(e,n){var t=n||this.components;return t instanceof Array&&(t=t[0]),e&&(t.spatialReference=e.spatialReference||e.srs),new esri.geometry.Point(t)},multipoint:function(e){return!(e=e||{}).spatialReference&&e.srs&&(e.spatialReference=e.srs),new esri.geometry.Multipoint({points:this.components.map(function(e){return Wkt.isArray(e)&&(e=e[0]),[e.x,e.y]}),spatialReference:e.spatialReference})},linestring:function(e){return!(e=e||{}).spatialReference&&e.srs&&(e.spatialReference=e.srs),new esri.geometry.Polyline({paths:[this.components.map(function(e){return[e.x,e.y]})],spatialReference:e.spatialReference})},multilinestring:function(e){return!(e=e||{}).spatialReference&&e.srs&&(e.spatialReference=e.srs),new esri.geometry.Polyline({paths:this.components.map(function(e){return e.map(function(e){return[e.x,e.y]})}),spatialReference:e.spatialReference})},polygon:function(e){return!(e=e||{}).spatialReference&&e.srs&&(e.spatialReference=e.srs),new esri.geometry.Polygon({rings:this.components.map(function(e){return e.map(function(e){return[e.x,e.y]})}),spatialReference:e.spatialReference})},multipolygon:function(e){var o=this;return!(e=e||{}).spatialReference&&e.srs&&(e.spatialReference=e.srs),new esri.geometry.Polygon({rings:function(){var e,n,t,r;for(r=o.components.map(function(e){var n=e.map(function(e){return e.map(function(e){return[e.x,e.y]})});return n.length,n}),t=[],e=0;e<r.length;e+=1)if(1<r[e].length)for(n=0;n<r[e].length;n+=1)t.push(r[e][n]);else t.push(r[e][0]);return t}(),spatialReference:e.spatialReference})}},Wkt.isInnerRingOf=function(e,n,t){var r,o,i,s;for(r=!0,i=new esri.geometry.Polygon({rings:n.map(function(e){return e.map(function(e){return[e.x,e.y]})}),spatialReference:t}),o=0;o<e.length;o+=1)if(s=new esri.geometry.Point(e[o].x,e[o].y,t),!i.contains(s)){r=!1;break}return r},Wkt.Wkt.prototype.deconstruct=function(e){var n,t,r,o,i;if(e.constructor===esri.geometry.Point)return{type:"point",components:[{x:e.x,y:e.y}]};if(e.constructor===esri.geometry.Multipoint){for(i=[],n=0;n<e.points.length;n+=1)i.push([{x:e.points[n][0],y:e.points[n][1]}]);return{type:"multipoint",components:i}}if(e.constructor===esri.geometry.Polyline){for(r=[],n=0;n<e.paths.length;n+=1){for(i=[],t=0;t<e.paths[n].length;t+=1)i.push({x:e.paths[n][t][0],y:e.paths[n][t][1]});r.push(i)}return 1<e.paths.length?{type:"multilinestring",components:r}:{type:"linestring",components:i}}if(e.constructor===esri.geometry.Polygon||e.constructor===esri.geometry.Circle){for(o=[],n=0;n<e.rings.length;n+=1){for(i=[],t=0;t<e.rings[n].length;t+=1)i.push({x:e.rings[n][t][0],y:e.rings[n][t][1]});0<n&&Wkt.isInnerRingOf(i,o[o.length-1],e.spatialReference)?o[o.length-1].push(i):o.push([i])}return 1<o.length?{type:"multipolygon",components:o}:{type:"polygon",components:o[0]}}};
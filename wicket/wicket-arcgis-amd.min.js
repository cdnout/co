define(["esri/geometry/Multipoint","esri/geometry/Point","esri/geometry/Polygon","esri/geometry/Polyline"],function(e,p,a,n){Array.prototype.map||(Array.prototype.map=function(e){"use strict";var n,t,r,i;if(null==this)throw new TypeError;if(t=(n=Object(this)).length>>>0,"function"!=typeof e)throw new TypeError;r=new Array(t),i=2<=arguments.length?arguments[1]:void 0;for(var s=0;s<t;s++)s in n&&(r[s]=e.call(i,n[s],s,n));return r}),Wkt.Wkt.prototype.isRectangle=!1,Wkt.Wkt.prototype.construct={point:function(e,n){var t=n||this.components;return t instanceof Array&&(t=t[0]),e&&(t.spatialReference=e.spatialReference||e.srs),new p(t)},multipoint:function(e){return!(e=e||{}).spatialReference&&e.srs&&(e.spatialReference=e.srs),new this.Multipoint({points:this.components.map(function(e){return Wkt.isArray(e)&&(e=e[0]),[e.x,e.y]}),spatialReference:e.spatialReference})},linestring:function(e){return!(e=e||{}).spatialReference&&e.srs&&(e.spatialReference=e.srs),new n({paths:[this.components.map(function(e){return[e.x,e.y]})],spatialReference:e.spatialReference})},multilinestring:function(e){return!(e=e||{}).spatialReference&&e.srs&&(e.spatialReference=e.srs),new this.Polyline({paths:this.components.map(function(e){return e.map(function(e){return[e.x,e.y]})}),spatialReference:e.spatialReference})},polygon:function(e){return!(e=e||{}).spatialReference&&e.srs&&(e.spatialReference=e.srs),new a({rings:this.components.map(function(e){return e.map(function(e){return[e.x,e.y]})}),spatialReference:e.spatialReference})},multipolygon:function(e){var s=this;return!(e=e||{}).spatialReference&&e.srs&&(e.spatialReference=e.srs),new a({rings:function(){var e,n,t,r,i;if(t=!1,i=s.components.map(function(e){var n=e.map(function(e){return e.map(function(e){return[e.x,e.y]})});return t=1<n.length,n}),!t&&1<i[0].length)return i;for(r=[],e=0;e<i.length;e+=1)if(1<i[e].length)for(n=0;n<i[e].length;n+=1)r.push(i[e][n]);else r.push(i[e][0]);return r}(),spatialReference:e.spatialReference})}},Wkt.isInnerRingOf=function(e,n,t){var r,i,s,o;for(r=!0,s=new a({rings:n.map(function(e){return e.map(function(e){return[e.x,e.y]})}),spatialReference:t}),i=0;i<e.length;i+=1)if(o=new p(e[i].x,e[i].y,t),!s.contains(o)){r=!1;break}return r},Wkt.Wkt.prototype.deconstruct=function(e){var n,t,r,i,s;if("point"===e.type)return{type:"point",components:[{x:e.x,y:e.y}]};if("multipoint"===e.type){for(s=[],n=0;n<e.points.length;n+=1)s.push([{x:e.points[n][0],y:e.points[n][1]}]);return{type:"multipoint",components:s}}if("polyline"===e.type){for(r=[],n=0;n<e.paths.length;n+=1){for(s=[],t=0;t<e.paths[n].length;t+=1)s.push({x:e.paths[n][t][0],y:e.paths[n][t][1]});r.push(s)}return 1<e.paths.length?{type:"multilinestring",components:r}:{type:"linestring",components:s}}if("polygon"===e.type||"circle"===e.type){for(i=[],n=0;n<e.rings.length;n+=1){for(s=[],t=0;t<e.rings[n].length;t+=1)s.push({x:e.rings[n][t][0],y:e.rings[n][t][1]});0<n&&Wkt.isInnerRingOf(s,i[i.length-1],e.spatialReference)?i[i.length-1].push(s):i.push([s])}return 1<i.length?{type:"multipolygon",components:i}:{type:"polygon",components:i[0]}}}});
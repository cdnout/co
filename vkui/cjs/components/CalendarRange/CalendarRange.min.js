"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault").default,_interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard").default,_jsxRuntime=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.CalendarRange=void 0,require("../../lib/jsxRuntime")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),React=_interopRequireWildcard(require("react")),_date=require("../../lib/date"),_CalendarHeader=require("../CalendarHeader/CalendarHeader"),_CalendarDays=require("../CalendarDays/CalendarDays"),_calendar=require("../../lib/calendar"),_useCalendar2=require("../../hooks/useCalendar"),_excluded=["value","onChange","disablePast","disableFuture","shouldDisableDate","onClose","weekStartsOn","getRootRef","disablePickers","prevMonthAriaLabel","nextMonthAriaLabel","changeMonthAriaLabel","changeYearAriaLabel","changeDayAriaLabel"],getIsDaySelected=function(e,a){return!(null==a||!a[0]||!a[1])&&Boolean((0,_date.isWithinInterval)(e,(0,_date.startOfDay)(a[0]),(0,_date.endOfDay)(a[1])))},CalendarRange=function(e){var n=e.value,a=e.onChange,t=e.disablePast,r=e.disableFuture,i=e.shouldDisableDate,l=(e.onClose,e.weekStartsOn),l=void 0===l?1:l,s=e.getRootRef,d=e.disablePickers,o=e.prevMonthAriaLabel,u=e.nextMonthAriaLabel,c=e.changeMonthAriaLabel,D=e.changeYearAriaLabel,_=e.changeDayAriaLabel,_=void 0===_?"Изменить день":_,e=(0,_objectWithoutProperties2.default)(e,_excluded),r=(0,_useCalendar2.useCalendar)({value:n,disableFuture:r,disablePast:t,shouldDisableDate:i}),b=r.viewDate,y=r.setViewDate,t=r.setPrevMonth,i=r.setNextMonth,h=r.focusedDay,C=r.setFocusedDay,v=r.isDayFocused,R=r.isDayDisabled,r=r.resetSelectedDay,S=React.useState(),S=(0,_slicedToArray2.default)(S,2),f=S[0],m=S[1],S=(0,_date.addMonths)(b,1),p=React.useCallback(function(e){["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)&&e.preventDefault();e=(0,_calendar.navigateDate)(null!=h?h:null==n?void 0:n[1],e.key);!e||(0,_date.isSameMonth)(e,b)||(0,_date.isSameMonth)(e,(0,_date.addMonths)(b,1))||y(e),C(e)},[h,C,y,n,b]),g=React.useCallback(function(e){if(!n)return[e,null];var a=n[0],t=n[1];return a&&(0,_date.isSameDay)(e,a)||t&&(0,_date.isSameDay)(e,t)?[(0,_calendar.setTimeEqual)(e,a),(0,_calendar.setTimeEqual)(e,t)]:a&&(0,_date.isBefore)(e,a)?[(0,_calendar.setTimeEqual)(e,a),t]:a&&(0,_date.isAfter)(e,a)?[a,(0,_calendar.setTimeEqual)(e,t)]:n},[n]),k=React.useCallback(function(e){null!=a&&a(g(e)),m(void 0)},[a,g]),A=React.useCallback(function(e){return getIsDaySelected(e,n)},[n]),x=React.useCallback(function(e){return Boolean((null==n?void 0:n[0])&&(0,_date.isSameDay)(e,n[0])||(null==n?void 0:n[1])&&(0,_date.isSameDay)(e,n[1]))},[n]),q=React.useCallback(function(e,a){return Boolean((0,_calendar.isLastDay)(e,a)||(null==n?void 0:n[1])&&(0,_date.isSameDay)(e,n[1]))},[n]),L=React.useCallback(function(e,a){return Boolean((0,_calendar.isLastDay)(e,a)||(null==f?void 0:f[1])&&(0,_date.isSameDay)(e,f[1]))},[f]),M=React.useCallback(function(e,a){return Boolean((0,_calendar.isFirstDay)(e,a)||(null==n?void 0:n[0])&&(0,_date.isSameDay)(e,n[0]))},[n]),w=React.useCallback(function(e,a){return Boolean((0,_calendar.isFirstDay)(e,a)||(null==f?void 0:f[0])&&(0,_date.isSameDay)(e,f[0]))},[f]),E=React.useCallback(function(e){return m(g(e))},[m,g]),j=React.useCallback(function(){return m(void 0)},[m]),H=React.useCallback(function(e){return getIsDaySelected(e,f)},[f]);return(0,_jsxRuntime.createScopedElement)("div",(0,_extends2.default)({},e,{ref:s,vkuiClass:"CalendarRange"}),(0,_jsxRuntime.createScopedElement)("div",{vkuiClass:"CalendarRange__inner"},(0,_jsxRuntime.createScopedElement)(_CalendarHeader.CalendarHeader,{viewDate:b,onChange:y,nextMonth:!1,onPrevMonth:t,disablePickers:d,vkuiClass:"CalendarRange__header",prevMonthAriaLabel:o,nextMonthAriaLabel:u,changeMonthAriaLabel:c,changeYearAriaLabel:D}),(0,_jsxRuntime.createScopedElement)(_CalendarDays.CalendarDays,{viewDate:b,value:n,weekStartsOn:l,onKeyDown:p,isDayFocused:v,onDayChange:k,isDaySelected:A,isDayActive:x,isDaySelectionEnd:q,isDaySelectionStart:M,isDayHinted:H,onDayEnter:E,onDayLeave:j,isHintedDaySelectionEnd:L,isHintedDaySelectionStart:w,isDayDisabled:R,"aria-label":_})),(0,_jsxRuntime.createScopedElement)("div",{vkuiClass:"CalendarRange__inner"},(0,_jsxRuntime.createScopedElement)(_CalendarHeader.CalendarHeader,{viewDate:S,onChange:y,prevMonth:!1,onNextMonth:i,disablePickers:d,vkuiClass:"CalendarRange__header",prevMonthAriaLabel:o,nextMonthAriaLabel:u,changeMonthAriaLabel:c,changeYearAriaLabel:D}),(0,_jsxRuntime.createScopedElement)(_CalendarDays.CalendarDays,{viewDate:S,value:n,weekStartsOn:l,"aria-label":_,onKeyDown:p,isDayFocused:v,onDayChange:k,isDaySelected:A,isDayActive:x,isDaySelectionEnd:q,isDaySelectionStart:M,isDayHinted:H,onDayEnter:E,onDayLeave:j,isHintedDaySelectionEnd:L,isHintedDaySelectionStart:w,isDayDisabled:R,tabIndex:0,onBlur:r})))};exports.CalendarRange=CalendarRange;
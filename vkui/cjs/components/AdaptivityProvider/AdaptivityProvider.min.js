"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard").default,_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault").default,_jsxRuntime=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.TABLET_SIZE=exports.SMALL_TABLET_SIZE=exports.MOBILE_SIZE=exports.MOBILE_LANDSCAPE_HEIGHT=exports.MEDIUM_HEIGHT=exports.DESKTOP_SIZE=exports.AdaptivityProvider=void 0,require("../../lib/jsxRuntime")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),React=_interopRequireWildcard(require("react")),_vkjs=require("@vkontakte/vkjs"),_AdaptivityContext=require("./AdaptivityContext"),_dom=require("../../lib/dom"),_useBridgeAdaptivity=require("../../hooks/useBridgeAdaptivity"),DESKTOP_SIZE=1280,TABLET_SIZE=(exports.DESKTOP_SIZE=DESKTOP_SIZE,1024),SMALL_TABLET_SIZE=(exports.TABLET_SIZE=TABLET_SIZE,768),MOBILE_SIZE=(exports.SMALL_TABLET_SIZE=SMALL_TABLET_SIZE,320),MOBILE_LANDSCAPE_HEIGHT=(exports.MOBILE_SIZE=MOBILE_SIZE,414),MEDIUM_HEIGHT=(exports.MOBILE_LANDSCAPE_HEIGHT=MOBILE_LANDSCAPE_HEIGHT,720),AdaptivityProvider=(exports.MEDIUM_HEIGHT=MEDIUM_HEIGHT,function(a){var A=React.useRef(null),e=React.useState({}),E=(0,_slicedToArray2.default)(e,2)[1],v=(0,_useBridgeAdaptivity.useBridgeAdaptivity)(),p=(0,_dom.useDOM)().window;return A.current||(A.current=calculateAdaptivity(a,v,p)),React.useEffect(function(){function e(){var e,t,i,r,o,d,_;null!==A.current&&(e=calculateAdaptivity(a,v,p),t=(_=A.current).viewWidth,i=_.viewHeight,r=_.sizeX,o=_.sizeY,d=_.hasMouse,_=_.deviceHasHover,t===e.viewWidth&&i===e.viewHeight&&r===e.sizeX&&o===e.sizeY&&d===e.hasMouse&&_===e.deviceHasHover||(A.current=e,E({})))}return e(),p.addEventListener("resize",e,!1),function(){p.removeEventListener("resize",e,!1)}},[a.viewWidth,a.viewHeight,a.sizeX,a.sizeY,a.hasMouse,a.deviceHasHover,p,a,v]),(0,_jsxRuntime.createScopedElement)(_AdaptivityContext.AdaptivityContext.Provider,{value:A.current},a.children)});function calculateAdaptivity(e,t,i){var r=0,o=0,i=("adaptive"===t.type?(r=t.viewportWidth,o=t.viewportHeight):i&&(r=i.innerWidth,o=i.innerHeight),_AdaptivityContext.ViewWidth.SMALL_MOBILE),d=_AdaptivityContext.ViewHeight.SMALL,_=_AdaptivityContext.SizeType.REGULAR,a=_AdaptivityContext.SizeType.REGULAR,A=_vkjs.hasMouse,E=_vkjs.hasHover,i=DESKTOP_SIZE<=r?_AdaptivityContext.ViewWidth.DESKTOP:TABLET_SIZE<=r?_AdaptivityContext.ViewWidth.TABLET:SMALL_TABLET_SIZE<=r?_AdaptivityContext.ViewWidth.SMALL_TABLET:MOBILE_SIZE<=r?_AdaptivityContext.ViewWidth.MOBILE:_AdaptivityContext.ViewWidth.SMALL_MOBILE,d=MEDIUM_HEIGHT<=o?_AdaptivityContext.ViewHeight.MEDIUM:MOBILE_LANDSCAPE_HEIGHT<o?_AdaptivityContext.ViewHeight.SMALL:_AdaptivityContext.ViewHeight.EXTRA_SMALL;return t.type||(e.viewWidth&&(i=e.viewWidth),e.viewHeight&&(d=e.viewHeight),A=null!=(r=e.hasMouse)?r:A,E=null!=(o=e.deviceHasHover)?o:E),i<=_AdaptivityContext.ViewWidth.MOBILE&&(a=_AdaptivityContext.SizeType.COMPACT),(i>=_AdaptivityContext.ViewWidth.SMALL_TABLET&&A||d<=_AdaptivityContext.ViewHeight.EXTRA_SMALL)&&(_=_AdaptivityContext.SizeType.COMPACT),t.type||(e.sizeX&&(a=e.sizeX),e.sizeY&&(_=e.sizeY)),"force_mobile"!==t.type&&"force_mobile_compact"!==t.type||(i=_AdaptivityContext.ViewWidth.MOBILE,a=_AdaptivityContext.SizeType.COMPACT,_="force_mobile_compact"===t.type?_AdaptivityContext.SizeType.COMPACT:_AdaptivityContext.SizeType.REGULAR),{viewWidth:i,viewHeight:d,sizeX:a,sizeY:_,hasMouse:A,deviceHasHover:E}}exports.AdaptivityProvider=AdaptivityProvider;
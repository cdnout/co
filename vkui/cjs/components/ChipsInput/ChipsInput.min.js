"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault").default,_interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard").default,_jsxRuntime=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.chipsInputDefaultProps=exports.ChipsInput=void 0,require("../../lib/jsxRuntime")),_typeof2=_interopRequireDefault(require("@babel/runtime/helpers/typeof")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_objectSpread2=_interopRequireDefault(require("@babel/runtime/helpers/objectSpread2")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),React=_interopRequireWildcard(require("react")),_FormField=require("../FormField/FormField"),_classNames=require("../../lib/classNames"),_Chip=require("../Chip/Chip"),_utils=require("../../lib/utils"),_useChipsInput2=require("./useChipsInput"),_useAdaptivity2=require("../../hooks/useAdaptivity"),_prefixClass=require("../../lib/prefixClass"),_useExternRef=require("../../hooks/useExternRef"),_excluded=["disabled","value","label"],_excluded2=["style","value","onChange","onInputChange","onKeyDown","onBlur","onFocus","children","className","inputValue","getRef","getRootRef","placeholder","getOptionValue","getOptionLabel","getNewOptionData","renderChip","after","inputAriaLabel"],chipsInputDefaultProps={type:"text",onChange:_utils.noop,onInputChange:_utils.noop,onKeyDown:_utils.noop,onBlur:_utils.noop,onFocus:_utils.noop,value:[],inputValue:"",inputAriaLabel:"Введите ваше значение...",getOptionValue:function(e){return e.value},getOptionLabel:function(e){return e.label},getNewOptionData:function(e,t){return{value:t,label:t}},renderChip:function(e){if(!e)return null;var t=e.disabled,i=e.value,n=e.label,e=(0,_objectWithoutProperties2.default)(e,_excluded);return(0,_jsxRuntime.createScopedElement)(_Chip.Chip,(0,_extends2.default)({value:i,removable:!t},e),n)}},ChipsInput=(exports.chipsInputDefaultProps=chipsInputDefaultProps,function(e){function n(e,t){void 0!==t&&g(t)}var e=(0,_objectSpread2.default)((0,_objectSpread2.default)({},chipsInputDefaultProps),e),t=e.style,i=(e.value,e.onChange,e.onInputChange,e.onKeyDown),u=e.onBlur,r=e.onFocus,a=(e.children,e.className),l=(e.inputValue,e.getRef),o=e.getRootRef,p=e.placeholder,s=e.getOptionValue,d=e.getOptionLabel,c=(e.getNewOptionData,e.renderChip),f=e.after,h=e.inputAriaLabel,_=(0,_objectWithoutProperties2.default)(e,_excluded2),b=(0,_useAdaptivity2.useAdaptivity)().sizeY,C=React.useState(!1),C=(0,_slicedToArray2.default)(C,2),m=C[0],v=C[1],C=(0,_useChipsInput2.useChipsInput)(e),R=C.fieldValue,x=C.addOptionFromInput,g=C.removeOption,q=C.selectedOptions,e=C.handleInputChange,I=(0,_useExternRef.useExternRef)(l),y=_.disabled||_.readOnly;return(0,_jsxRuntime.createScopedElement)(_FormField.FormField,{getRootRef:o,vkuiClass:(0,_classNames.classNames)("ChipsInput","ChipsInput--sizeY-".concat(b),m&&"ChipsInput--focused",!!q.length&&"ChipsInput--withChips"),className:a,style:t,disabled:_.disabled,after:f,onClick:function(e){y?e.preventDefault():null===(null==I?void 0:I.current)||m||I.current.focus()},role:"application","aria-disabled":_.disabled,"aria-readonly":_.readOnly},(0,_jsxRuntime.createScopedElement)("div",{vkuiClass:"ChipsInput__container",role:"presentation"},q.map(function(e){var t=s(e),i=d(e);return(0,_jsxRuntime.createScopedElement)(React.Fragment,{key:"".concat((0,_typeof2.default)(t),"-").concat(t)},c({option:e,value:t,label:i,onRemove:n,disabled:Boolean(_.disabled),className:(0,_prefixClass.prefixClass)("ChipsInput__chip")}))}),(0,_jsxRuntime.createScopedElement)("label",{vkuiClass:"ChipsInput__input-container","aria-label":h},(0,_jsxRuntime.createScopedElement)("input",(0,_extends2.default)({ref:I,value:R,autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",vkuiClass:"ChipsInput__el",onChange:e,onKeyDown:function(e){y?e.preventDefault():(i(e),"Backspace"!==e.key||e.defaultPrevented||R||!q.length||(g(s(q[q.length-1])),e.preventDefault()),"Enter"===e.key&&!e.defaultPrevented&&R&&(x(),e.preventDefault()))},onFocus:function(e){m||v(!0),r(e)},onBlur:function(e){m&&v(!1),u(e)},placeholder:q.length?void 0:p},_)))))});exports.ChipsInput=ChipsInput;
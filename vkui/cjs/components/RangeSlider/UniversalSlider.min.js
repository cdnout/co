"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault").default,_interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard").default,_jsxRuntime=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.UniversalSlider=void 0,require("../../lib/jsxRuntime")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),React=_interopRequireWildcard(require("react")),_Touch=require("../Touch/Touch"),_getClassName=require("../../helpers/getClassName"),_classNames=require("../../lib/classNames"),_math=require("../../helpers/math"),_withAdaptivity=require("../../hoc/withAdaptivity"),_useExternRef=require("../../hooks/useExternRef"),_usePlatform=require("../../hooks/usePlatform"),_excluded=["min","max","step","value","defaultValue","onChange","getRootRef","sizeY","disabled"],UniversalSliderDumb=function(e){function l(e){return(0,_math.rescale)(e,[0,h.containerWidth],[i,a],{step:u})}function n(e){if(null==p)return[null,e];var t=h.dragging;return"start"===t?f<e?(h.dragging="end",[f,e]):[e,f]:"end"===t?e<p?(h.dragging="start",[e,p]):[p,e]:s}function t(e){return(e-i)/(a-i)*100}var r=e.min,i=void 0===r?0:r,r=e.max,a=void 0===r?100:r,u=e.step,r=e.value,s=void 0===r?[0,0]:r,o=(e.defaultValue,e.onChange),r=e.getRootRef,d=e.sizeY,c=e.disabled,e=(0,_objectWithoutProperties2.default)(e,_excluded),_=(0,_usePlatform.usePlatform)(),m=(0,_slicedToArray2.default)(s,2),p=m[0],f=m[1],m=null!=p,h=React.useRef({dragging:!1,startX:0,containerWidth:0}).current,g=(0,_useExternRef.useExternRef)(r),v=React.useRef(null),R=React.useRef(null),r=m?{width:"".concat(t(f)-t(null!=p?p:0),"%"),left:"".concat(t(null!=p?p:0),"%")}:{width:"".concat(t(f),"%")};return(0,_jsxRuntime.createScopedElement)(_Touch.Touch,(0,_extends2.default)({"data-value":m?s.join(","):s},e,c?{}:{onStart:function(e){var t,r,i=null==(i=g.current)?void 0:i.getBoundingClientRect(),i=(h.containerWidth=null!=(a=null==i?void 0:i.width)?a:0,e.startX-(null!=(a=null==i?void 0:i.left)?a:0)),a=l(i);h.dragging=(t=a,(r=e.originalEvent.target)===v.current||r!==R.current&&Math.abs((null!=p?p:0)-t)<=Math.abs(f-t)?"start":"end"),h.startX=i,null!=o&&o(n(a),e),e.originalEvent.stopPropagation()},onMove:function(e){null!=o&&o(n(l(h.startX+(e.shiftX||0))),e),e.originalEvent.stopPropagation(),e.originalEvent.preventDefault()},onEnd:function(e){h.dragging=!1,e.originalEvent.stopPropagation()}},{vkuiClass:(0,_classNames.classNames)((0,_getClassName.getClassName)("Slider",_),"Slider--sizeY-".concat(d),c&&"Slider--disabled")}),(0,_jsxRuntime.createScopedElement)("div",{ref:g,vkuiClass:"Slider__in"},(0,_jsxRuntime.createScopedElement)("div",{vkuiClass:"Slider__dragger",style:r},m&&(0,_jsxRuntime.createScopedElement)("span",{vkuiClass:(0,_classNames.classNames)("Slider__thumb","Slider__thumb--start"),ref:v}),(0,_jsxRuntime.createScopedElement)("span",{vkuiClass:(0,_classNames.classNames)("Slider__thumb","Slider__thumb--end"),ref:R}))))},UniversalSlider=(0,_withAdaptivity.withAdaptivity)(UniversalSliderDumb,{sizeY:!0});exports.UniversalSlider=UniversalSlider;
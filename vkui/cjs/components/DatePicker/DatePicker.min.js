"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault").default,_interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard").default,_jsxRuntime=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,require("../../lib/jsxRuntime")),_objectSpread2=_interopRequireDefault(require("@babel/runtime/helpers/objectSpread2")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),React=_interopRequireWildcard(require("react")),_Input=require("../Input/Input"),_withAdaptivity=require("../../hoc/withAdaptivity"),_utils=require("../../lib/utils"),_CustomSelect=require("../CustomSelect/CustomSelect"),_excluded=["name","min","max","dayPlaceholder","monthPlaceholder","yearPlaceholder","popupDirection","defaultValue","hasMouse","monthNames","day","month","year","onDateChange","disabled"],_excluded2=["min","max","dayPlaceholder","monthPlaceholder","yearPlaceholder","popupDirection","defaultValue","hasMouse","day","month","year","onDateChange"],_excluded3=["hasMouse","defaultValue"],DefaultMonths=["Января","Февраля","Марта","Апреля","Мая","Июня","Июля","Августа","Сентября","Октября","Ноября","Декабря"];function convertToInputFormat(e){var t=e.day,t=void 0===t?0:t,a=e.month,a=void 0===a?0:a,e=e.year;return"".concat(void 0===e?0:e,"-").concat((0,_utils.leadingZero)(a),"-").concat((0,_utils.leadingZero)(t))}function parseInputDate(e){e=e.split("-");return{day:Number(e[2]),month:Number(e[1]),year:Number(e[0])}}function getMonthMaxDay(e,t){return e?new Date(t||2016,e,0).getDate():31}var range=function(e,t){for(var a=t<e,r=[],n=Math.min(e,t);n<=Math.max(e,t);n++)r.push(n);return a?r.reverse():r},DatePickerCustom=function(e){function t(e){null!=h&&h((0,_defineProperty2.default)({day:s,month:m,year:p},e.target.name,Number(e.target.value)))}var a=e.name,r=e.min,r=void 0===r?{day:0,month:0,year:0}:r,n=e.max,n=void 0===n?{day:31,month:12,year:2100}:n,o=e.dayPlaceholder,u=e.monthPlaceholder,i=e.yearPlaceholder,l=e.popupDirection,d=(e.defaultValue,e.hasMouse,e.monthNames),c=e.day,s=void 0===c?0:c,c=e.month,m=void 0===c?0:c,c=e.year,p=void 0===c?0:c,h=e.onDateChange,c=e.disabled,e=(0,_objectWithoutProperties2.default)(e,_excluded),_=range(1,getMonthMaxDay(m,p)).map(function(e){return{label:String(e),value:e}}),d=(d||DefaultMonths).map(function(e,t){return{label:e,value:t+1}}),n=range(n.year,r.year).map(function(e){return{label:String(e),value:e}});return(0,_jsxRuntime.createScopedElement)("div",(0,_extends2.default)({vkuiClass:"DatePicker"},e),(0,_jsxRuntime.createScopedElement)("div",{vkuiClass:"DatePicker__container"},(0,_jsxRuntime.createScopedElement)("div",{vkuiClass:"DatePicker__day"},(0,_jsxRuntime.createScopedElement)(_CustomSelect.CustomSelect,{name:"day",value:s,options:_,placeholder:o,popupDirection:l,onChange:t,disabled:c})),(0,_jsxRuntime.createScopedElement)("div",{vkuiClass:"DatePicker__month"},(0,_jsxRuntime.createScopedElement)(_CustomSelect.CustomSelect,{vkuiClass:"DatePicker__monthSelect",name:"month",value:m,options:d,placeholder:u,popupDirection:l,onChange:t,disabled:c})),(0,_jsxRuntime.createScopedElement)("div",{vkuiClass:"DatePicker__year"},(0,_jsxRuntime.createScopedElement)(_CustomSelect.CustomSelect,{name:"year",value:p,options:n,placeholder:i,popupDirection:l,onChange:t,disabled:c}))),(0,_jsxRuntime.createScopedElement)("input",{type:"hidden",name:a,value:convertToInputFormat({day:s,month:m,year:p})}))},DatePickerNative=function(e){var t=e.min,t=void 0===t?{day:0,month:0,year:0}:t,a=e.max,a=void 0===a?{day:31,month:12,year:2100}:a,r=(e.dayPlaceholder,e.monthPlaceholder,e.yearPlaceholder,e.popupDirection,e.defaultValue,e.hasMouse,e.day),n=e.month,o=e.year,u=e.onDateChange,e=(0,_objectWithoutProperties2.default)(e,_excluded2),r=r&&n&&o?{defaultValue:convertToInputFormat({day:r,month:n,year:o})}:{},n=React.useCallback(function(e){null!=u&&u(parseInputDate(e.currentTarget.value))},[u]);return(0,_jsxRuntime.createScopedElement)(_Input.Input,(0,_extends2.default)({},e,{type:"date",onChange:n,min:convertToInputFormat(t),max:convertToInputFormat(a)},r))},DatePicker=function(e){var t=e.hasMouse,a=e.defaultValue,r=(0,_objectWithoutProperties2.default)(e,_excluded3),e=React.useState(function(){return{day:(null==a?void 0:a.day)||0,month:(null==a?void 0:a.month)||0,year:(null==a?void 0:a.year)||0}}),e=(0,_slicedToArray2.default)(e,2),n=e[0],o=e[1],e=React.useCallback(function(e){o(e),r.onDateChange&&r.onDateChange((0,_objectSpread2.default)({},e))},[r]);return(0,_jsxRuntime.createScopedElement)(t?DatePickerCustom:DatePickerNative,(0,_extends2.default)({},r,n,{onDateChange:e}))},_default=(0,_withAdaptivity.withAdaptivity)(DatePicker,{hasMouse:!0});exports.default=_default;
"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard").default,_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault").default,_slicedToArray2=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.useBridgeAdaptivity=useBridgeAdaptivity,_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"))),React=_interopRequireWildcard(require("react")),_vkBridge=_interopRequireDefault(require("@vkontakte/vk-bridge")),_useIsomorphicLayoutEffect=require("../lib/useIsomorphicLayoutEffect"),initialState={type:"",viewportWidth:0,viewportHeight:0};function resolveAdaptivity(e){var e=e.detail,i=e.type,e=e.data;if("VKWebAppUpdateConfig"!==i||!e)return null;var t=e.adaptivity,i=e.viewport_width,e=e.viewport_height,r={type:"",viewportWidth:isFinite(i)?+i:0,viewportHeight:isFinite(e)?+e:0};switch(t){case"force_mobile":case"force_mobile_compact":case"adaptive":r.type=t}return r}function useBridgeAdaptivity(){var e=React.useState(initialState),e=(0,_slicedToArray2.default)(e,2),i=e[0],t=e[1];return(0,_useIsomorphicLayoutEffect.useIsomorphicLayoutEffect)(function(){function e(e){e=resolveAdaptivity(e);e&&t(e)}return _vkBridge.default.subscribe(e),function(){_vkBridge.default.unsubscribe(e)}},[]),i}_vkBridge.default.subscribe(function(e){e=resolveAdaptivity(e);e&&(initialState=e)});
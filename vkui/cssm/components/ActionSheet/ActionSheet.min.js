import _extends from"@babel/runtime/helpers/extends";import _slicedToArray from"@babel/runtime/helpers/slicedToArray";import _objectWithoutProperties from"@babel/runtime/helpers/objectWithoutProperties";var _excluded=["children","className","header","text","style","iosCloseItem"];import{createScopedElement}from"../../lib/jsxRuntime";import*as React from"react";import{PopoutWrapper}from"../PopoutWrapper/PopoutWrapper";import{ViewWidth,ViewHeight}from"../../hoc/withAdaptivity";import{IOS}from"../../lib/platform";import{ActionSheetDropdownDesktop}from"./ActionSheetDropdownDesktop";import{ActionSheetDropdown}from"./ActionSheetDropdown";import{hasReactNode,noop}from"../../lib/utils";import{ActionSheetContext}from"./ActionSheetContext";import{Caption}from"../Typography/Caption/Caption";import{usePlatform}from"../../hooks/usePlatform";import{useTimeout}from"../../hooks/useTimeout";import{useAdaptivity}from"../../hooks/useAdaptivity";import{useObjectMemo}from"../../hooks/useObjectMemo";import{warnOnce}from"../../lib/warnOnce";import"./ActionSheet.css";var warn=warnOnce("ActionSheet"),ActionSheet=function(e){function t(){return l(!0)}var o=e.children,r=e.className,i=e.header,n=e.text,c=e.style,s=e.iosCloseItem,a=_objectWithoutProperties(e,_excluded),e=usePlatform(),p=React.useState(!1),p=_slicedToArray(p,2),m=p[0],l=p[1],u=React.useRef(noop),p=("development"!==process.env.NODE_ENV||a.onClose||warn("can't close on outer click without onClose","error"),useAdaptivity()),h=p.viewWidth,d=p.viewHeight,p=p.hasMouse,h=h>=ViewWidth.SMALL_TABLET&&(p||d>=ViewHeight.MEDIUM),p=e===IOS?300:200,f=useTimeout(function(){var e;null!=(e=a.onClose)&&e.call(a),u.current(),u.current=noop},p=h?0:p),d=(React.useEffect(function(){m?f.set():f.clear()},[m,f]),React.useCallback(function(t,o,r){return function(e){e.persist(),o&&o(e),r?(u.current=function(){return t&&t(e)},l(!0)):t&&t(e)}},[])),d=useObjectMemo({onItemClick:d,isDesktop:h}),d=createScopedElement(ActionSheetContext.Provider,{value:d},createScopedElement(h?ActionSheetDropdownDesktop:ActionSheetDropdown,_extends({closing:m,timeout:p},a,{onClose:t,className:h?r:void 0,style:h?c:void 0}),(hasReactNode(i)||hasReactNode(n))&&createScopedElement("header",{vkuiClass:"ActionSheet__header"},hasReactNode(i)&&createScopedElement(Caption,{weight:e===IOS?"1":"2",vkuiClass:"ActionSheet__title"},i),hasReactNode(n)&&createScopedElement(Caption,{vkuiClass:"ActionSheet__text"},n)),o,e===IOS&&!h&&s));return h?d:createScopedElement(PopoutWrapper,{closing:m,alignY:"bottom",className:r,style:c,onClick:t,hasMask:!0,fixed:!0},d)};ActionSheet.defaultProps={popupDirection:"bottom"};export{ActionSheet};
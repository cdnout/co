import _extends from"@babel/runtime/helpers/extends";import _slicedToArray from"@babel/runtime/helpers/slicedToArray";import _objectWithoutProperties from"@babel/runtime/helpers/objectWithoutProperties";var _excluded=["min","max","step","value","defaultValue","onChange","getRootRef","sizeY","disabled"];import{createScopedElement}from"../../lib/jsxRuntime";import*as React from"react";import{Touch}from"../Touch/Touch";import{getClassName}from"../../helpers/getClassName";import{classNames}from"../../lib/classNames";import{rescale}from"../../helpers/math";import{withAdaptivity}from"../../hoc/withAdaptivity";import{useExternRef}from"../../hooks/useExternRef";import{usePlatform}from"../../hooks/usePlatform";import"../Slider/Slider.css";var UniversalSliderDumb=function(e){function n(e){return rescale(e,[0,v.containerWidth],[i,a],{step:o})}function l(e){if(null==f)return[null,e];var t=v.dragging;return"start"===t?g<e?(v.dragging="end",[g,e]):[e,g]:"end"===t?e<f?(v.dragging="start",[e,f]):[f,e]:s}function t(e){return(e-i)/(a-i)*100}var r=e.min,i=void 0===r?0:r,r=e.max,a=void 0===r?100:r,o=e.step,r=e.value,s=void 0===r?[0,0]:r,u=(e.defaultValue,e.onChange),r=e.getRootRef,d=e.sizeY,c=e.disabled,e=_objectWithoutProperties(e,_excluded),m=usePlatform(),p=_slicedToArray(s,2),f=p[0],g=p[1],p=null!=f,v=React.useRef({dragging:!1,startX:0,containerWidth:0}).current,h=useExternRef(r),b=React.useRef(null),S=React.useRef(null),r=p?{width:"".concat(t(g)-t(null!=f?f:0),"%"),left:"".concat(t(null!=f?f:0),"%")}:{width:"".concat(t(g),"%")};return createScopedElement(Touch,_extends({"data-value":p?s.join(","):s},e,c?{}:{onStart:function(e){var t,r,i=null==(i=h.current)?void 0:i.getBoundingClientRect(),i=(v.containerWidth=null!=(a=null==i?void 0:i.width)?a:0,e.startX-(null!=(a=null==i?void 0:i.left)?a:0)),a=n(i);v.dragging=(t=a,(r=e.originalEvent.target)===b.current||r!==S.current&&Math.abs((null!=f?f:0)-t)<=Math.abs(g-t)?"start":"end"),v.startX=i,null!=u&&u(l(a),e),e.originalEvent.stopPropagation()},onMove:function(e){null!=u&&u(l(n(v.startX+(e.shiftX||0))),e),e.originalEvent.stopPropagation(),e.originalEvent.preventDefault()},onEnd:function(e){v.dragging=!1,e.originalEvent.stopPropagation()}},{vkuiClass:classNames(getClassName("Slider",m),"Slider--sizeY-".concat(d),c&&"Slider--disabled")}),createScopedElement("div",{ref:h,vkuiClass:"Slider__in"},createScopedElement("div",{vkuiClass:"Slider__dragger",style:r},p&&createScopedElement("span",{vkuiClass:classNames("Slider__thumb","Slider__thumb--start"),ref:b}),createScopedElement("span",{vkuiClass:classNames("Slider__thumb","Slider__thumb--end"),ref:S}))))},UniversalSlider=withAdaptivity(UniversalSliderDumb,{sizeY:!0});export{UniversalSlider};
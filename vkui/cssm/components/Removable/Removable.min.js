import _extends from"@babel/runtime/helpers/extends";import _objectWithoutProperties from"@babel/runtime/helpers/objectWithoutProperties";import _slicedToArray from"@babel/runtime/helpers/slicedToArray";var _excluded=["getRootRef","children","onRemove","removePlaceholder","align"];import{createScopedElement}from"../../lib/jsxRuntime";import*as React from"react";import{classNames}from"../../lib/classNames";import{getTitleFromChildren,noop}from"../../lib/utils";import{useExternRef}from"../../hooks/useExternRef";import{usePlatform}from"../../hooks/usePlatform";import{getClassName}from"../../helpers/getClassName";import{useAdaptivity}from"../../hooks/useAdaptivity";import{useDOM}from"../../lib/dom";import{ANDROID,IOS,VKCOM}from"../../lib/platform";import{Icon24Cancel}from"@vkontakte/icons";import IconButton from"../IconButton/IconButton";import{useGlobalEventListener}from"../../hooks/useGlobalEventListener";import Tappable from"../Tappable/Tappable";import"./Removable.css";var RemovableIos=function(e){var o=e.onRemove,t=e.removePlaceholder,r=e.removePlaceholderString,e=e.children,a=useDOM().window,l=React.useRef(null),n=React.useRef(!0),i=React.useState(0),i=_slicedToArray(i,2),s=i[0],c=i[1];useGlobalEventListener(a,"click",function(){0<s&&c(0)},{capture:!0});return createScopedElement("div",{vkuiClass:"Removable__content",style:{transform:"translateX(-".concat(null!=s?s:0,"px)")},onTransitionEnd:function(){var e;0<s?null!=l&&null!=(e=l.current)&&e.focus():n.current=!0}},createScopedElement(IconButton,{hasActive:!1,hasHover:!1,"aria-label":r,vkuiClass:"Removable__action Removable__toggle",onClick:function(e){e.stopPropagation(),l.current&&(e=l.current.offsetWidth,n.current=!1,c(e))},disabled:0<s},createScopedElement("i",{vkuiClass:"Removable__toggle-in",role:"presentation"})),e,createScopedElement("span",{vkuiClass:"Removable__offset","aria-hidden":"true"}),createScopedElement(Tappable,{Component:"button",hasActive:!1,hasHover:!1,disabled:n.current,getRootRef:l,vkuiClass:"Removable__remove",onClick:o},createScopedElement("span",{vkuiClass:"Removable__remove-in"},t)))},Removable=function(e){function o(e){e.preventDefault(),l(e)}var t=e.getRootRef,r=e.children,a=e.onRemove,l=void 0===a?noop:a,a=e.removePlaceholder,a=void 0===a?"Удалить":a,n=e.align,n=void 0===n?"center":n,e=_objectWithoutProperties(e,_excluded),i=usePlatform(),s=useAdaptivity().sizeY,t=useExternRef(t),c=getTitleFromChildren(a);return createScopedElement("div",_extends({},e,{ref:t,vkuiClass:classNames(getClassName("Removable",i),"Removable--".concat(n),"Removable--sizeY-".concat(s))}),(i===ANDROID||i===VKCOM)&&createScopedElement("div",{vkuiClass:"Removable__content"},r,createScopedElement(IconButton,{activeMode:"opacity",hoverMode:"opacity",vkuiClass:"Removable__action",onClick:o,"aria-label":c},createScopedElement(Icon24Cancel,{role:"presentation"}))),i===IOS&&createScopedElement(RemovableIos,{onRemove:o,removePlaceholder:a,removePlaceholderString:c},r))};export{Removable};
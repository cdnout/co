import _slicedToArray from"@babel/runtime/helpers/slicedToArray";import{createScopedElement}from"../../lib/jsxRuntime";import*as React from"react";import{hasMouse as _hasMouse,hasHover as _hasHover}from"@vkontakte/vkjs";import{AdaptivityContext,SizeType,ViewHeight,ViewWidth}from"./AdaptivityContext";import{useDOM}from"../../lib/dom";import{useBridgeAdaptivity}from"../../hooks/useBridgeAdaptivity";var DESKTOP_SIZE=1280,TABLET_SIZE=1024,SMALL_TABLET_SIZE=768,MOBILE_SIZE=320,MOBILE_LANDSCAPE_HEIGHT=414,MEDIUM_HEIGHT=720,AdaptivityProvider=function(s){var v=React.useRef(null),e=React.useState({}),d=_slicedToArray(e,2)[1],L=useBridgeAdaptivity(),A=useDOM().window;return v.current||(v.current=calculateAdaptivity(s,L,A)),React.useEffect(function(){function e(){var e,i,t,r,o,a,E;null!==v.current&&(e=calculateAdaptivity(s,L,A),i=(E=v.current).viewWidth,t=E.viewHeight,r=E.sizeX,o=E.sizeY,a=E.hasMouse,E=E.deviceHasHover,i===e.viewWidth&&t===e.viewHeight&&r===e.sizeX&&o===e.sizeY&&a===e.hasMouse&&E===e.deviceHasHover||(v.current=e,d({})))}return e(),A.addEventListener("resize",e,!1),function(){A.removeEventListener("resize",e,!1)}},[s.viewWidth,s.viewHeight,s.sizeX,s.sizeY,s.hasMouse,s.deviceHasHover,A,s,L]),createScopedElement(AdaptivityContext.Provider,{value:v.current},s.children)};function calculateAdaptivity(e,i,t){var r=0,o=0,t=("adaptive"===i.type?(r=i.viewportWidth,o=i.viewportHeight):t&&(r=t.innerWidth,o=t.innerHeight),ViewWidth.SMALL_MOBILE),a=ViewHeight.SMALL,E=SizeType.REGULAR,s=SizeType.REGULAR,v=_hasMouse,d=_hasHover,t=DESKTOP_SIZE<=r?ViewWidth.DESKTOP:TABLET_SIZE<=r?ViewWidth.TABLET:SMALL_TABLET_SIZE<=r?ViewWidth.SMALL_TABLET:MOBILE_SIZE<=r?ViewWidth.MOBILE:ViewWidth.SMALL_MOBILE,a=MEDIUM_HEIGHT<=o?ViewHeight.MEDIUM:MOBILE_LANDSCAPE_HEIGHT<o?ViewHeight.SMALL:ViewHeight.EXTRA_SMALL;return i.type||(e.viewWidth&&(t=e.viewWidth),e.viewHeight&&(a=e.viewHeight),v=null!=(r=e.hasMouse)?r:v,d=null!=(o=e.deviceHasHover)?o:d),t<=ViewWidth.MOBILE&&(s=SizeType.COMPACT),(t>=ViewWidth.SMALL_TABLET&&v||a<=ViewHeight.EXTRA_SMALL)&&(E=SizeType.COMPACT),i.type||(e.sizeX&&(s=e.sizeX),e.sizeY&&(E=e.sizeY)),"force_mobile"!==i.type&&"force_mobile_compact"!==i.type||(t=ViewWidth.MOBILE,s=SizeType.COMPACT,E="force_mobile_compact"===i.type?SizeType.COMPACT:SizeType.REGULAR),{viewWidth:t,viewHeight:a,sizeX:s,sizeY:E,hasMouse:v,deviceHasHover:d}}export{DESKTOP_SIZE,TABLET_SIZE,SMALL_TABLET_SIZE,MOBILE_SIZE,MOBILE_LANDSCAPE_HEIGHT,MEDIUM_HEIGHT,AdaptivityProvider};
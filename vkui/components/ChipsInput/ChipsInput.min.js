import _typeof from"@babel/runtime/helpers/typeof";import _slicedToArray from"@babel/runtime/helpers/slicedToArray";import _objectSpread from"@babel/runtime/helpers/objectSpread2";import _extends from"@babel/runtime/helpers/extends";import _objectWithoutProperties from"@babel/runtime/helpers/objectWithoutProperties";var _excluded=["disabled","value","label"],_excluded2=["style","value","onChange","onInputChange","onKeyDown","onBlur","onFocus","children","className","inputValue","getRef","getRootRef","placeholder","getOptionValue","getOptionLabel","getNewOptionData","renderChip","after","inputAriaLabel"];import{createScopedElement}from"../../lib/jsxRuntime";import*as React from"react";import{FormField}from"../FormField/FormField";import{classNames}from"../../lib/classNames";import{Chip}from"../Chip/Chip";import{noop}from"../../lib/utils";import{useChipsInput}from"./useChipsInput";import{useAdaptivity}from"../../hooks/useAdaptivity";import{prefixClass}from"../../lib/prefixClass";import{useExternRef}from"../../hooks/useExternRef";var chipsInputDefaultProps={type:"text",onChange:noop,onInputChange:noop,onKeyDown:noop,onBlur:noop,onFocus:noop,value:[],inputValue:"",inputAriaLabel:"Введите ваше значение...",getOptionValue:function(e){return e.value},getOptionLabel:function(e){return e.label},getNewOptionData:function(e,t){return{value:t,label:t}},renderChip:function(e){if(!e)return null;var t=e.disabled,o=e.value,n=e.label,e=_objectWithoutProperties(e,_excluded);return createScopedElement(Chip,_extends({value:o,removable:!t},e),n)}},ChipsInput=function(e){function n(e,t){void 0!==t&&I(t)}var e=_objectSpread(_objectSpread({},chipsInputDefaultProps),e),t=e.style,o=(e.value,e.onChange,e.onInputChange,e.onKeyDown),a=e.onBlur,r=e.onFocus,i=(e.children,e.className),l=(e.inputValue,e.getRef),p=e.getRootRef,u=e.placeholder,s=e.getOptionValue,c=e.getOptionLabel,d=(e.getNewOptionData,e.renderChip),m=e.after,f=e.inputAriaLabel,h=_objectWithoutProperties(e,_excluded2),b=useAdaptivity().sizeY,C=React.useState(!1),C=_slicedToArray(C,2),v=C[0],g=C[1],C=useChipsInput(e),_=C.fieldValue,y=C.addOptionFromInput,I=C.removeOption,x=C.selectedOptions,e=C.handleInputChange,R=useExternRef(l),D=h.disabled||h.readOnly;return createScopedElement(FormField,{getRootRef:p,vkuiClass:classNames("ChipsInput","ChipsInput--sizeY-".concat(b),v&&"ChipsInput--focused",!!x.length&&"ChipsInput--withChips"),className:i,style:t,disabled:h.disabled,after:m,onClick:function(e){D?e.preventDefault():null===(null==R?void 0:R.current)||v||R.current.focus()},role:"application","aria-disabled":h.disabled,"aria-readonly":h.readOnly},createScopedElement("div",{vkuiClass:"ChipsInput__container",role:"presentation"},x.map(function(e){var t=s(e),o=c(e);return createScopedElement(React.Fragment,{key:"".concat(_typeof(t),"-").concat(t)},d({option:e,value:t,label:o,onRemove:n,disabled:Boolean(h.disabled),className:prefixClass("ChipsInput__chip")}))}),createScopedElement("label",{vkuiClass:"ChipsInput__input-container","aria-label":f},createScopedElement("input",_extends({ref:R,value:_,autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",vkuiClass:"ChipsInput__el",onChange:e,onKeyDown:function(e){D?e.preventDefault():(o(e),"Backspace"!==e.key||e.defaultPrevented||_||!x.length||(I(s(x[x.length-1])),e.preventDefault()),"Enter"===e.key&&!e.defaultPrevented&&_&&(y(),e.preventDefault()))},onFocus:function(e){v||g(!0),r(e)},onBlur:function(e){v&&g(!1),a(e)},placeholder:x.length?void 0:u},h)))))};export{chipsInputDefaultProps,ChipsInput};
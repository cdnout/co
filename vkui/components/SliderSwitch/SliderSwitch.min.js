import _extends from"@babel/runtime/helpers/extends";import _slicedToArray from"@babel/runtime/helpers/slicedToArray";import _objectWithoutProperties from"@babel/runtime/helpers/objectWithoutProperties";import _classCallCheck from"@babel/runtime/helpers/classCallCheck";import _createClass from"@babel/runtime/helpers/createClass";import _assertThisInitialized from"@babel/runtime/helpers/assertThisInitialized";import _inherits from"@babel/runtime/helpers/inherits";import _createSuper from"@babel/runtime/helpers/createSuper";import _defineProperty from"@babel/runtime/helpers/defineProperty";var _excluded=["name","options","activeValue","onSwitch"];import{createScopedElement}from"../../lib/jsxRuntime";import*as React from"react";import{SliderSwitchButton}from"./SliderSwitchButton";import{classNames}from"../../lib/classNames";import{warnOnce}from"../../lib/warnOnce";var warn=warnOnce("SliderSwitch"),SliderSwitch=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var r;return _classCallCheck(this,i),r=t.call(this,e),_defineProperty(_assertThisInitialized(r),"firstButton",void 0),_defineProperty(_assertThisInitialized(r),"secondButton",void 0),_defineProperty(_assertThisInitialized(r),"onSwitch",function(e){var t=r.props.onSwitch;r.setState(function(){return{activeValue:e}},function(){t&&t(e)})}),_defineProperty(_assertThisInitialized(r),"handleFirstClick",function(){var e=r.props.options[0].value;r.onSwitch(e)}),_defineProperty(_assertThisInitialized(r),"handleSecondClick",function(){var e=r.props.options[1].value;r.onSwitch(e)}),_defineProperty(_assertThisInitialized(r),"handleFirstHover",function(){r.setState(function(){return{hoveredOptionId:0}})}),_defineProperty(_assertThisInitialized(r),"handleSecondHover",function(){r.setState(function(){return{hoveredOptionId:1}})}),_defineProperty(_assertThisInitialized(r),"resetFocusedOption",function(){r.setState(function(){return{hoveredOptionId:-1}})}),_defineProperty(_assertThisInitialized(r),"switchByKey",function(e){var t,i;"Enter"!==e.key&&"Spacebar"!==e.key&&" "!==e.key||(e.preventDefault(),e=r.props.options,t=r.state.activeValue,void 0!==(i=null==(i=e.find(function(e){return e.value!==t}))?void 0:i.value)&&r.onSwitch(i),e[0].value===i?null!=(e=r.firstButton.current)&&e.focus():null!=(i=r.secondButton.current)&&i.focus())}),r.state={activeValue:null!=(e=e.activeValue)?e:"",hoveredOptionId:-1},r.firstButton=React.createRef(),r.secondButton=React.createRef(),r}return _createClass(i,[{key:"componentDidMount",value:function(){"development"===process.env.NODE_ENV&&warn("Этот компонент устарел и будет удален в 5.0.0. Используйте SegmentedControl.")}},{key:"render",value:function(){var e=this.props,t=e.name,i=e.options,e=(e.activeValue,e.onSwitch,_objectWithoutProperties(e,_excluded)),r=this.state,n=r.activeValue,r=r.hoveredOptionId,i=_slicedToArray(i,2),o=i[0],i=i[1],a=o.value===n,s=i.value===n;return createScopedElement("div",_extends({},e,{vkuiClass:"SliderSwitch",onKeyDown:this.switchByKey,onMouseLeave:this.resetFocusedOption}),!a&&!s&&createScopedElement("div",{vkuiClass:"SliderSwitch__border"}),createScopedElement("div",{vkuiClass:classNames("SliderSwitch__slider",(_defineProperty(e={},"SliderSwitch--firstActive",a),_defineProperty(e,"SliderSwitch--secondActive",s),e))}),createScopedElement("input",{type:"hidden",name:t,value:n}),createScopedElement(SliderSwitchButton,{active:a,hovered:0===r,"aria-pressed":a,onClick:this.handleFirstClick,onMouseEnter:this.handleFirstHover,getRootRef:this.firstButton},o.name),createScopedElement(SliderSwitchButton,{active:s,hovered:1===r,onClick:this.handleSecondClick,onMouseEnter:this.handleSecondHover,getRootRef:this.secondButton},i.name))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.activeValue&&e.activeValue!==t.activeValue?{activeValue:e.activeValue}:null}}]),i}(React.Component);_defineProperty(SliderSwitch,"defaultProps",{options:[{name:"",value:""},{name:"",value:""}]});export{SliderSwitch};
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@aitmed/ecos-lvl2-sdk"),require("@aitmed/protorepo/js/ecos/v1beta1/types_pb"),require("pako"),require("@jsmanifest/utils"),require("noodl-types"),require("loglevel"),require("immer"),require("dot-object"),require("vercel-toast"),require("moment"),require("humanize-duration"),require("axios"),require("crypto-js/sha256"),require("crypto-js/enc-base64"),require("jsbi"),require("yaml"),require("sql.js"),require("wuzzy")):"function"==typeof define&&define.amd?define(["exports","@aitmed/ecos-lvl2-sdk","@aitmed/protorepo/js/ecos/v1beta1/types_pb","pako","@jsmanifest/utils","noodl-types","loglevel","immer","dot-object","vercel-toast","moment","humanize-duration","axios","crypto-js/sha256","crypto-js/enc-base64","jsbi","yaml","sql.js","wuzzy"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).CADL={},e.lvl2,e.types_pb,e.pako,e.u,e.nt,e.loglevel,e.immer,e.dot,e.vercelToast,e.moment,e.humanizeDuration,e.axios,e.sha256,e.Base64,e.jsbi,e.YAML,e.initSqlJs,e.wuzzy)}(this,function(e,E,I,t,r,x,j,N,k,C,R,V,W,n,G,H,J,$,Y){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function X(r){if(r&&r.__esModule)return r;var n=Object.create(null);return r&&Object.keys(r).forEach(function(e){var t;"default"!==e&&(t=Object.getOwnPropertyDescriptor(r,e),Object.defineProperty(n,e,t.get?t:{enumerable:!0,get:function(){return r[e]}}))}),n.default=r,Object.freeze(n)}var Q=i(E),Z=i(t),A=X(r),O=X(x),L=i(j),ee=i(N),te=i(k),f=i(R),re=i(V),ne=i(W),ie=i(n),oe=i(G),ae=i(H),le=i(J),ue=X($),se=i(Y),ce=((t={})[t.UNKNOW_ERROR=-1]="UNKNOW_ERROR",t[t.PERMISSION_DENIED=1]="PERMISSION_DENIED",t[t.UNREGISTERED=2]="UNREGISTERED",t[t.REGISTERED=3]="REGISTERED",t[t.PHONE_NUMBER_INVALID=1e3]="PHONE_NUMBER_INVALID",t[t.PASSWORD_INVALID=1001]="PASSWORD_INVALID",t[t.VERIFICATION_CODE_INVALID=1002]="VERIFICATION_CODE_INVALID",t[t.REQUIRED_VERIFICATION_CODE=1003]="REQUIRED_VERIFICATION_CODE",t[t.REQUIRED_PASSWORD=1004]="REQUIRED_PASSWORD",t[t.USER_NOT_FOUND=1005]="USER_NOT_FOUND",t[t.PROFILE_NOT_FOUND=1006]="PROFILE_NOT_FOUND",t[t.UID_INVALID=1007]="UID_INVALID",t[t.PROFILE_PHOTO_INVALID=1008]="PROFILE_PHOTO_INVALID",t[t.LOGIN_REQUIRED=1009]="LOGIN_REQUIRED",t[t.EDGE_DOES_NOT_EXIST=2e3]="EDGE_DOES_NOT_EXIST",t[t.NOTEBOOK_PERMISSION_DENIED=2001]="NOTEBOOK_PERMISSION_DENIED",t[t.NOT_A_NOTEBOOk=2002]="NOT_A_NOTEBOOk",t[t.ROOT_NOTEBOOK_EXIST=2003]="ROOT_NOTEBOOK_EXIST",t[t.ROOT_NOTEBOOK_NOT_EXIST=2004]="ROOT_NOTEBOOK_NOT_EXIST",t[t.ROOT_NOTEBOOK_CANNOT_BE_REMOVED=2005]="ROOT_NOTEBOOK_CANNOT_BE_REMOVED",t[t.NOTEBOOK_TYPE_INVALID=2006]="NOTEBOOK_TYPE_INVALID",t[t.NOT_AN_INVITE=2007]="NOT_AN_INVITE",t[t.NOT_AN_ACCEPTED_INVITE=2008]="NOT_AN_ACCEPTED_INVITE",t[t.NOTE_NOT_EXIST=3e3]="NOTE_NOT_EXIST",t[t.NOTE_PERMISSION_DENIED=3001]="NOTE_PERMISSION_DENIED",t[t.NOTE_CONTENT_INVALID=3002]="NOTE_CONTENT_INVALID",t[t.NOT_A_NOTE=3003]="NOT_A_NOTE",t[t.NOTEBOOK_ID_NOT_MATCH=3004]="NOTEBOOK_ID_NOT_MATCH",t[t.CONTENT_TOO_LARGE=3005]="CONTENT_TOO_LARGE",t[t.DOWNLOAD_FROM_S3_FAIL=3006]="DOWNLOAD_FROM_S3_FAIL",t[t.DECRYPTING_NOTES_FAIL=3007]="DECRYPTING_NOTES_FAIL",t[t.YAML_PARSE_FAILED=4e3]="YAML_PARSE_FAILED",t[t.NO_DATA_MODELS_AVAILABLE=4001]="NO_DATA_MODELS_AVAILABLE",t[t.INVALID_DATAMODEL_KEY=4002]="INVALID_DATAMODEL_KEY",t[t.ERROR_RETRIEVING_UIDL_DATA=4003]="ERROR_RETRIEVING_UIDL_DATA",t[t.INVALID_ROOT_TYPE=4004]="INVALID_ROOT_TYPE",t[t.INVALID_LINK=5e3]="INVALID_LINK",t[t.LINK_DOES_NOT_EXIST=5001]="LINK_DOES_NOT_EXIST",t[t.NOT_AN_INBOX=6e3]="NOT_AN_INBOX",t[t.ROOT_INBOX_EXISTS=6001]="ROOT_INBOX_EXISTS",t[t.ROOT_INBOX_DOES_NOT_EXIST=6002]="ROOT_INBOX_DOES_NOT_EXIST",t[t.ERROR_CREATING_ESAK=7e3]="ERROR_CREATING_ESAK",t[t.ERROR_DECRYPTING_DATA=7001]="ERROR_DECRYPTING_DATA",t);const de={UNKNOW_ERROR:"error occurred",PERMISSION_DENIED:"permission denied",UNREGISTERED:"account is not registered",REGISTERED:"account is already registered",PHONE_NUMBER_INVALID:"phone number is invalid",PASSWORD_INVALID:"password is invalid",VERIFICATION_CODE_INVALID:"verification code is invalid",REQUIRED_VERIFICATION_CODE:"verification code is required",REQUIRED_PASSWORD:"password is required",USER_NOT_FOUND:"user is not found",PROFILE_NOT_FOUND:"profile note found",UID_INVALID:"uid is invalid",PROFILE_PHOTO_INVALID:"profile photo is invalid",LOGIN_REQUIRED:"There is no secretKey present in localStorage. Please log In.",EDGE_DOES_NOT_EXIST:"The requested edge does not exist",NOTEBOOK_PERMISSION_DENIED:"notebook permission denied",NOT_A_NOTEBOOk:"not a notebook",ROOT_NOTEBOOK_EXIST:"the root notebook is already exist",ROOT_NOTEBOOK_NOT_EXIST:"the root notebook is not exist",ROOT_NOTEBOOK_CANNOT_BE_REMOVED:"the root notebook cannot be removed",NOTEBOOK_TYPE_INVALID:"notebook type is invalid",NOT_AN_INVITE:"this is not an invite",NOT_AN_ACCEPTED_INVITE:" this is not an accepted invite",NOTE_NOT_EXIST:"note is not exist",NOTE_PERMISSION_DENIED:"note permission denied",NOTE_CONTENT_INVALID:"note content is invalid",NOT_A_NOTE:"not a note",NOTEBOOK_ID_NOT_MATCH:"notebook id is not match",CONTENT_TOO_LARGE:"content is too large [maximum 32KB]",DOWNLOAD_FROM_S3_FAIL:"download document from s3 fail",DECRYPTING_NOTES_FAIL:"an error occurred while decrypting the shared notes",INVALID_LINK:"this is not a valid Link type",LINK_DOES_NOT_EXIST:"Link does not exist",NOT_AN_INBOX:"This is not a valid inbox/relation.",ROOT_INBOX_EXISTS:"Root inbox already exists.",ROOT_INBOX_DOES_NOT_EXIST:"There is no root inbox for the user.",YAML_PARSE_FAILED:"failed to parse yaml data",NO_DATA_MODELS_AVAILABLE:"There are no dataModels for this uidl",INVALID_DATAMODEL_KEY:"Please provide a valid dataModel key",ERROR_RETRIEVING_UIDL_DATA:"Could not retrieve data for UIDL dataModel.",INVALID_ROOT_TYPE:"The root type provided is invalid",ERROR_CREATING_ESAK:"Error happened while creating an esak",ERROR_DECRYPTING_DATA:"Error happened while decrypting data."},fe=Object.keys(ce).filter(e=>"number"==typeof ce[e]),pe=fe.map(e=>parseInt(ce[e]));class P extends Error{constructor({code:e,name:t,message:r}){super(),void 0===e&&void 0!==t?(this.name=t,this.code=he(t)):void 0!==e&&void 0===t?(this.name=(t=e,pe.includes(t)?ce[t]:ce.UNKNOW_ERROR.toString()),this.code=he(this.name)):(this.code=-1,this.name=ce[this.code]),this.message=void 0===r?de[this.name]:r,this.source="lv-3"}}function he(e){return fe.includes(e)?parseInt(ce[e]):-1}function ve(t,r){if(t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==r[e])return!1;return!0}const ye=e=>e,ge=e=>{var t=he(e.name);throw-1===t&&"UNKNOW_ERROR"!==e.name?e:new P({code:t,message:e.message})};var B=new class{constructor({apiVersion:e,apiHost:t,env:r,configUrl:n}){this.responseCatcher=ye,this.errorCatcher=ge,this._env=r;this.level2SDK=new Q.default({apiVersion:e,apiHost:t,env:"test"===r?"development":"production",configUrl:n});this.utils={idToBase64:e=>"string"==typeof e?e:this.level2SDK.utilServices.uint8ArrayToBase64(e),idToUint8Array:e=>"string"==typeof e?this.level2SDK.utilServices.base64ToUint8Array(e):e,compareUint8Arrays:ve}}set apiVersion(e){this.level2SDK.apiVersion=e}get apiVersion(){return this.level2SDK.apiVersion}set env(e){this._env=e}get env(){return this._env}get apiHost(){return this.level2SDK.apiHost}set apiHost(e){this.level2SDK.apiHost=e}get configUrl(){return this.level2SDK.configUrl}set configUrl(e){this.level2SDK.configUrl=e}getConfig(){return this.level2SDK.getConfigData()}}({env:"test",configUrl:"https://public.aitmed.com/config"});class me extends Error{constructor(e,t){super(e),this.error=t,this.name="UnableToExecuteFn",Object.setPrototypeOf(this,me.prototype)}}class be extends Error{constructor(e,t){super(e),this.error=t,this.name="UnableToParseYAML",Object.setPrototypeOf(this,be.prototype)}}class _e extends Error{constructor(e,t){super(e),this.error=t,this.name="UnableToRetrieveYAML",Object.setPrototypeOf(this,_e.prototype)}}class Se extends Error{constructor(e,t){super(e),this.error=t,this.name="UnableToLocateValue",Object.setPrototypeOf(this,Se.prototype)}}class Ee extends Error{constructor(e,t){super(e),this.name="PopulateError",this.kind=t||""}}class Oe extends Error{constructor(e,t){super(e),this.error=t,this.name="UnableToLoadConfig",Object.setPrototypeOf(this,Oe.prototype)}}class Te extends Error{constructor(e,t){super(e),this.error=t,this.name="UnableToMakeAnotherRequest",Object.setPrototypeOf(this,Te.prototype)}}var we=function(e,t,r){var n=-1,i=e.length;(r=i<r?i:r)<0&&(r+=i),i=r<(t=t<0?i<-t?0:i+t:t)?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o};var Ae=function(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&n<=r?e:we(e,t,r)},De=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Ie=function(e){return De.test(e)};var xe=function(e){return e.split("")},r="\\ud800-\\udfff",j="["+r+"]",k="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",R="\\ud83c[\\udffb-\\udfff]",V="[^"+r+"]",W="(?:\\ud83c[\\udde6-\\uddff]){2}",n="[\\ud800-\\udbff][\\udc00-\\udfff]",G="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",H="[\\ufe0e\\ufe0f]?",J=H+G+("(?:\\u200d(?:"+[V,W,n].join("|")+")"+H+G+")*"),$="(?:"+[V+k+"?",k,W,n,j].join("|")+")",je=RegExp(R+"(?="+R+")|"+$+J,"g");var Ne=function(e){return e.match(je)||[]};var ke=function(e){return(Ie(e)?Ne:xe)(e)},Ce="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Re(e,t,r){return e(r={path:t,exports:{},require:function(e,t){throw null==t&&r.path,new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}},r.exports),r.exports}var Pe="object"==typeof Ce&&Ce&&Ce.Object===Object&&Ce,Y="object"==typeof self&&self&&self.Object===Object&&self,Le=Pe||Y||Function("return this")(),t=Le.Symbol;var Be=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i},h=Array.isArray,r=Object.prototype,Ue=r.hasOwnProperty,Fe=r.toString,Ke=t?t.toStringTag:void 0;var Me=function(e){var t=Ue.call(e,Ke),r=e[Ke];try{var n=!(e[Ke]=void 0)}catch(e){}var i=Fe.call(e);return n&&(t?e[Ke]=r:delete e[Ke]),i},ze=Object.prototype.toString;var qe=function(e){return ze.call(e)},Ve=t?t.toStringTag:void 0;var We=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":(Ve&&Ve in Object(e)?Me:qe)(e)};var Ge=function(e){return null!=e&&"object"==typeof e};var He=function(e){return"symbol"==typeof e||Ge(e)&&"[object Symbol]"==We(e)},H=t?t.prototype:void 0,Je=H?H.toString:void 0;var $e=function e(t){if("string"==typeof t)return t;if(h(t))return Be(t,e)+"";if(He(t))return Je?Je.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r};var Ye=function(e){return null==e?"":$e(e)};var Xe=function(n){return function(e){e=Ye(e);var t=Ie(e)?ke(e):void 0,r=t?t[0]:e.charAt(0),t=t?Ae(t,1).join(""):e.slice(1);return r[n]()+t}}("toUpperCase");const Qe=e=>Z.default.ungzip(e);function Ze(e){return null!=e&&(e&&"object"==typeof e&&!Array.isArray(e))}function U(r){return r?A.isStr(r)||A.isArr(r)?A.reduce(A.array(r),(e,t)=>A.isStr(t)&&(x.Identify.reference(t)||t.startsWith("$"))?(L.default.error(`%c[Lvl3 - getIdList] A reference "${r}" was being passed to idList. It will not be included in the request`,"color:#ec0000;font-weight:bold;"),e):t?e.concat(t):e,[]):A.isObj(r)&&("id"in r||"ids"in r)?U([r.ids||r.id].filter(Boolean)):A.array(r).filter(Boolean):[]}function et(r){return function(e,t){return B.level2SDK[r+"Services"]["retrieve"+Xe(r)]({idList:U(e),options:t})}}L.default.setDefaultLevel("DEBUG");const F=et("edge"),tt=et("document"),rt=et("vertex"),nt=e=>F(U("EDGE"===function(e){switch((192&(null==(e="string"==typeof e?B.utils.idToUint8Array(e):e)?void 0:e[8]))>>6){case 0:return"VERTEX";case 1:return"DOCUMENT";case 2:return"EDGE";case 3:return"FILE";default:return"UNKNOWN"}}(null==e?void 0:e.eid)?null==e?void 0:e.eid:null==e?void 0:e.esig));var it=Object.defineProperty,ot=Object.defineProperties,at=Object.getOwnPropertyDescriptors,lt=Object.getOwnPropertySymbols,ut=Object.prototype.hasOwnProperty,st=Object.prototype.propertyIsEnumerable,ct=(e,t,r)=>t in e?it(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,dt=(e,t)=>{for(var r in t=t||{})ut.call(t,r)&&ct(e,r,t[r]);if(lt)for(var r of lt(t))st.call(t,r)&&ct(e,r,t[r]);return e},ft=(e,t)=>ot(e,at(t)),pt=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});const ht=(n,i,o,a,l=1)=>pt(window,null,function*(){var e=yield mt(),t=e["code"],e=((e,t)=>{var r={};for(n in e)ut.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&lt)for(var n of lt(e))t.indexOf(n)<0&&st.call(e,n)&&(r[n]=e[n]);return r})(e,["code"]);let r;return r=3===t?(t=(yield B.level2SDK.Account.createInvitedUser({id:null==e?void 0:e.data.user_id,phone_number:n,password:i,userInfo:ft(dt({},a),{phoneNumber:n})}).then(B.responseCatcher).catch(B.errorCatcher))["data"],t):(e=(yield B.level2SDK.Account.createUser({phone_number:n,password:i,verification_code:Number(o),userInfo:ft(dt({},a),{phoneNumber:n}),type:"string"==typeof l?parseInt(l):l}).then(B.responseCatcher).catch(B.errorCatcher))["data"],e)}),vt=(i,o,a)=>pt(window,null,function*(){var e,t=yield gt(i,a);if(t instanceof E.Status)return yield B.level2SDK.Account.login(),t;t=yield yt(o);if(t.id){const r=yield rt(t.id),n=null!=(e=null==r?void 0:r.data)&&e.length?r.data[0]:null;return null!=(e=null==n?void 0:n.name)&&e.username&&(n.name.userName=n.name.username,delete n.name.username),n}return t}),yt=i=>pt(window,null,function*(){var e=(yield B.level2SDK.Account.login({password:i}).then(B.responseCatcher).catch(B.errorCatcher),yield mt())["data"]["user_id"];let t;if(e){const r=yield rt(e),n=null!=(e=null==r?void 0:r.data)&&e.length?r.data[0]:null;null!=(e=null==n?void 0:n.name)&&e.username&&(n.name.userName=n.name.username,delete n.name.username),t=n}return t}),gt=(e,t)=>pt(window,null,function*(){return yield B.level2SDK.Account.loginNewDevice({phone_number:e,verification_code:Number(t)}).then(B.responseCatcher).catch(B.errorCatcher)}),mt=()=>pt(window,null,function*(){B.configUrl||(B.configUrl="https://public.aitmed.com/config");var t=yield B.level2SDK.Account.getStatus();try{var e=localStorage.getItem("uid");if(null===e)throw new Error("uid is null");var{userId:r,phone_number:n}=function(e){var t=e.lastIndexOf("+");if(t<0)throw new P({name:"UID_INVALID"});return{userId:e.slice(0,t),phone_number:e.slice(t)}}(B.level2SDK.utilServices.base64ToUTF8(e));return ft(dt({},t),{userId:r,phone_number:n})}catch(e){return L.default.error(e instanceof Error?e:new Error(String(e))),ft(dt({},t),{userId:"",phone_number:""})}});G=Object.freeze({__proto__:null,requestVerificationCode:r=>pt(window,null,function*(){if(B.noodlInstance){if(0<B.noodlInstance.verificationRequest.timer&&B.noodlInstance.verificationRequest.phoneNumber===r)throw new Te("User must wait 60 sec to make another verification code request.");{B.noodlInstance.verificationRequest.timer=60,B.noodlInstance.verificationRequest.phoneNumber=r;const t=setInterval(()=>{0===B.noodlInstance.verificationRequest.timer?clearInterval(t):B.noodlInstance.verificationRequest.timer--},1e3)}}var e=yield B.level2SDK.Account.requestVerificationCode({phone_number:r}).then(B.responseCatcher).catch(B.errorCatcher);return Number(null==(e=null==e?void 0:e.data)?void 0:e.verification_code)}),create:ht,login:vt,loginByPassword:yt,loginByVerificationCode:gt,logout:(t=!1)=>pt(window,null,function*(){if(t)B.level2SDK.Account.logoutClean(),localStorage.removeItem("Global");else{var e=yield mt();if(1===e.code)return e;B.level2SDK.Account.logout(),localStorage.removeItem("Global")}return yield mt()}),getStatus:mt});const bt=(e,t,r)=>t?e|1<<r:e&~(1<<r),o=(e,t)=>e&1<<t?1:0,_t=["data","profile","vital"],St=["others","application","audio","font","image","message","model","multipart","text","video"];class Et{constructor(e=0){this._flags=0,this._dataType=0,this._mediaType=0,this.value=e}set value(e){this.flags=e<<22>>>22,this.dataType=e<<5>>>22,this.mediaType=e>>>27}get value(){var e=this._mediaType<<27;return(e|=this._dataType<<17)|this.flags}getFlags(){return{isOnServer:this.isOnServer,isGzip:this.isGzip,isBinary:this.isBinary,isEncrypted:this.isEncrypted,hasExtraKey:this.hasExtraKey,isEditable:this.isEditable,notification:this.notification,ringToneNotify:this.ringToneNotify,sendtoSelf:this.sendtoSelf}}set flags(e){this.isOnServer=!!o(e,0),this.isGzip=!!o(e,1),this.isBinary=!!o(e,2),this.isEncrypted=!!o(e,3),this.hasExtraKey=!!o(e,4),this.isEditable=!!o(e,5),this.notification=!!o(e,7),this.ringToneNotify=!!o(e,8),this.sendtoSelf=!!o(e,9)}get flags(){return this._flags}set isOnServer(e){this._flags=bt(this._flags,e,0)}get isOnServer(){return!!o(this._flags,0)}set isGzip(e){this._flags=bt(this._flags,e,1)}get isGzip(){return!!o(this._flags,1)}set isBinary(e){this._flags=bt(this._flags,e,2)}get isBinary(){return!!o(this._flags,2)}set isEncrypted(e){this._flags=bt(this._flags,e,3)}get isEncrypted(){return!!o(this._flags,3)}set hasExtraKey(e){this._flags=bt(this._flags,e,4)}get hasExtraKey(){return!!o(this._flags,4)}set isEditable(e){this._flags=bt(this._flags,e,5)}get isEditable(){return!!o(this._flags,5)}set notification(e){this._flags=bt(this._flags,e,7)}get notification(){return!!o(this._flags,7)}set ringToneNotify(e){this._flags=bt(this._flags,e,8)}get ringToneNotify(){return!!o(this._flags,8)}set sendtoSelf(e){this._flags=bt(this._flags,e,9)}get sendtoSelf(){return!!o(this._flags,9)}set dataType(e){this._dataType=e}get dataType(){return this._dataType}getDataType(){return _t[this._dataType]}set mediaType(e){e=e<0||e>=St.length?0:e;this._mediaType=e}get mediaType(){return this._mediaType}setMediaType(t){var e=St.findIndex(e=>RegExp(`^${e}/`).test(t));this._mediaType=-1===e?0:e}getMediaType(){return St[this.mediaType]}}var Ot=Object.defineProperty,Tt=Object.defineProperties,wt=Object.getOwnPropertyDescriptors,At=Object.getOwnPropertySymbols,Dt=Object.prototype.hasOwnProperty,It=Object.prototype.propertyIsEnumerable,xt=(e,t,r)=>t in e?Ot(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,jt=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});const Nt=(r,n,i)=>jt(window,null,function*(){let e=r instanceof Blob?yield B.level2SDK.utilServices.blobToUint8Array(r):r,t=!1;if(void 0!==n&&""!==n&&i)try{e=yield B.level2SDK.commonServices.encryptData(n,i,e),t=!0}catch(e){}return{data:e,isEncrypt:t}}),kt=n=>jt(window,null,function*(){var e=n instanceof Blob?yield B.level2SDK.utilServices.blobToUint8Array(n):n,t=Z.default.gzip(e),r=t.length<e.length;return{data:r?t:e,isGzip:r}}),Ct=(e,t)=>{let r;if("string"==typeof e)r=new Blob([e],{type:t});else if(e instanceof Blob)r=e;else try{var n=JSON.stringify(e);r=new Blob([n],{type:"application/json"})}catch(e){throw new P({name:"NOTE_CONTENT_INVALID",message:(e instanceof Error?e:new Error(String(e))).message})}return r},Rt=e=>jt(window,[e],function*({document:e,esakOfCurrentUser:i}){var t,o,a,l,r=(e=e||{}).name||{},u=0===parseInt(r.type)?"text/plain":r.type,s=e.deat,c=new Et(e.subtype);let d=null;try{let n;if(c.isOnServer){if(void 0===r.data)throw new P({name:"UNKNOW_ERROR",message:"name.data is undefined"});n=yield B.level2SDK.utilServices.base64ToUint8Array(r.data)}else{if(null===s||!s.url)throw"deat.url is missing";var f=yield B.level2SDK.documentServices.downloadDocumentFromS3({url:s.url}).then(B.responseCatcher).catch(B.errorCatcher);if(!f)throw"no response";n=c.isBinary?f.data:yield B.level2SDK.utilServices.base64ToUint8Array(f.data)}if(c.isEncrypted){var p=yield nt(e),h=null!=(o=null==(t=null==p?void 0:p.data)?void 0:t.edge)&&o.length?p.data.edge[0]:null;if(null===h)throw new P({name:"UNKNOW_ERROR",message:"Document -> documentToNote -> retrieveEdge -> edge is null"});const E=localStorage.getItem("user_vid"),O=h.besak&&""!==h.besak,T=h.eesak&&""!==h.eesak;let r;if(9999<h.type&&B.level2SDK.utilServices.uint8ArrayToBase64(h.bvid)!==E){const w=yield F(null==h?void 0:h.eid,{type:1053,xfname:"refid"}),A=(w||{})["data"],D=A["edge"],I=D.filter(e=>B.level2SDK.utilServices.uint8ArrayToBase64(e.evid)===E);r=0<I.length?I.shift():""}if(c.isEncrypted&&(O||T||r.eesak)){let e;var v,y,g=(h.bvid instanceof Uint8Array?B.level2SDK.utilServices.uint8ArrayToBase64(h.evid):h.evid)===localStorage.getItem("user_vid")?B.level2SDK.utilServices.uint8ArrayToBase64(h.bvid):h.bvid;e=r?r.eesak:i||(O?h.besak:h.eesak);let t;if(r){var m=(yield B.level2SDK.vertexServices.retrieveVertex({idList:U(null==r?void 0:r.bvid)}))["data"],b=null==(a=null==m?void 0:m.vertex)?void 0:a[0];t=B.level2SDK.utilServices.uint8ArrayToBase64(null==b?void 0:b.pk);try{n=yield B.level2SDK.commonServices.decryptData(e,t,n)}catch(e){L.default.error(e instanceof Error?e:new Error(String(e)))}}else n=(t=g?10001===h.type?localStorage.getItem("pk")||"":1e4===h.type?localStorage.getItem("pk")||"":localStorage.getItem("pk")||"":(v=(yield B.level2SDK.vertexServices.retrieveVertex({idList:U(null==h?void 0:h.bvid)}))["data"],y=null==(l=null==v?void 0:v.vertex)?void 0:l[0],B.level2SDK.utilServices.uint8ArrayToBase64(null==y?void 0:y.pk)),yield B.level2SDK.commonServices.decryptData(e,t,n))}}c.isGzip&&(n=Qe(n));var _=yield B.level2SDK.utilServices.uint8ArrayToBlob(n,u);if(/^text\//.test(_.type))d=yield new Response(_).text();else if("application/json"===_.type){var S=yield new Response(_).text();try{d=JSON.parse(S)}catch(e){d=S}}else d=_}catch(e){"string"==typeof e&&new P({name:"DOWNLOAD_FROM_S3_FAIL",message:"Document -> documentToNote -> "+e}),d=null}return d instanceof Blob&&(d=yield B.level2SDK.utilServices.blobToBase64(d)),s=((e,t)=>{for(var r in t=t||{})Dt.call(t,r)&&xt(e,r,t[r]);if(At)for(var r of At(t))It.call(t,r)&&xt(e,r,t[r]);return e})({},e),f={name:{title:r.title,nonce:null==r?void 0:r.nonce,targetRoomName:null==r?void 0:r.targetRoomName,user:null==r?void 0:r.user,sesk:null==r?void 0:r.sesk,notification:null==r?void 0:r.notification,aesk:null==r?void 0:r.aesk,type:"text/plain"===u?"application/json":u,data:d,tags:r.tags||[]},created_at:1e3*e.ctime,modified_at:1e3*e.mtime,subtype:{isOnServer:c.isOnServer,isZipped:c.isGzip,isBinary:c.isBinary,isEncrypted:c.isEncrypted,isEditable:c.isEditable,applicationDataType:c.dataType,notification:c.notification,ringToneNotify:c.ringToneNotify,sendtoSelf:c.sendtoSelf,mediaType:c.mediaType,size:e.size}},Tt(s,wt(f))});var Pt=function(e,t){return e===t||e!=e&&t!=t};var Lt=function(e,t){for(var r=e.length;r--;)if(Pt(e[r][0],t))return r;return-1},Bt=Array.prototype.splice;function Ut(e){var t=this.__data__;return!((e=Lt(t,e))<0)&&(e==t.length-1?t.pop():Bt.call(t,e,1),--this.size,!0)}function Ft(e){var t=this.__data__;return(e=Lt(t,e))<0?void 0:t[e][1]}function Kt(e){return-1<Lt(this.__data__,e)}function Mt(e,t){var r=this.__data__,n=Lt(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function zt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}zt.prototype.clear=function(){this.__data__=[],this.size=0},zt.prototype.delete=Ut,zt.prototype.get=Ft,zt.prototype.has=Kt,zt.prototype.set=Mt;var qt=zt;function Vt(){this.__data__=new qt,this.size=0}function Wt(e){var t=this.__data__,e=t.delete(e);return this.size=t.size,e}function Gt(e){return this.__data__.get(e)}function Ht(e){return this.__data__.has(e)}var v=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var Jt=function(e){return!!v(e)&&("[object Function]"==(e=We(e))||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e)},V=Le["__core-js_shared__"],$t=(k=/[^.]+$/.exec(V&&V.keys&&V.keys.IE_PROTO||""))?"Symbol(src)_1."+k:"";var Yt=function(e){return!!$t&&$t in e},Xt=Function.prototype.toString;var Qt=function(e){if(null!=e){try{return Xt.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Zt=/^\[object .+?Constructor\]$/,W=Function.prototype,n=Object.prototype,j=W.toString,R=n.hasOwnProperty,er=RegExp("^"+j.call(R).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var tr=function(e){return!(!v(e)||Yt(e))&&(Jt(e)?er:Zt).test(Qt(e))};var rr=function(e,t){return null==e?void 0:e[t]};var nr=function(e,t){return e=rr(e,t),tr(e)?e:void 0},ir=nr(Le,"Map"),or=nr(Object,"create");function ar(e){return e=this.has(e)&&delete this.__data__[e],this.size-=e?1:0,e}var lr=Object.prototype.hasOwnProperty;function ur(e){var t,r=this.__data__;return or?"__lodash_hash_undefined__"===(t=r[e])?void 0:t:lr.call(r,e)?r[e]:void 0}var sr=Object.prototype.hasOwnProperty;function cr(e){var t=this.__data__;return or?void 0!==t[e]:sr.call(t,e)}function dr(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=or&&void 0===t?"__lodash_hash_undefined__":t,this}function fr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}fr.prototype.clear=function(){this.__data__=or?or(null):{},this.size=0},fr.prototype.delete=ar,fr.prototype.get=ur,fr.prototype.has=cr,fr.prototype.set=dr;var pr=fr;var hr=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var vr=function(e,t){return e=e.__data__,hr(t)?e["string"==typeof t?"string":"hash"]:e.map};function yr(e){return e=vr(this,e).delete(e),this.size-=e?1:0,e}function gr(e){return vr(this,e).get(e)}function mr(e){return vr(this,e).has(e)}function br(e,t){var r=vr(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function _r(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}_r.prototype.clear=function(){this.size=0,this.__data__={hash:new pr,map:new(ir||qt),string:new pr}},_r.prototype.delete=yr,_r.prototype.get=gr,_r.prototype.has=mr,_r.prototype.set=br;var Sr=_r;function Er(e,t){var r=this.__data__;if(r instanceof qt){var n=r.__data__;if(!ir||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Sr(n)}return r.set(e,t),this.size=r.size,this}function Or(e){e=this.__data__=new qt(e);this.size=e.size}Or.prototype.clear=Vt,Or.prototype.delete=Wt,Or.prototype.get=Gt,Or.prototype.has=Ht,Or.prototype.set=Er;var Tr=Or;var wr=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e},Ar=function(){try{var e=nr(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var Dr=function(e,t,r){"__proto__"==t&&Ar?Ar(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},Ir=Object.prototype.hasOwnProperty;var xr=function(e,t,r){var n=e[t];Ir.call(e,t)&&Pt(n,r)&&(void 0!==r||t in e)||Dr(e,t,r)};var jr=function(e,t,r,n){var i=!r;r=r||{};for(var o=-1,a=t.length;++o<a;){var l=t[o],u=n?n(r[l],e[l],l,r,e):void 0;void 0===u&&(u=e[l]),(i?Dr:xr)(r,l,u)}return r};var Nr=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var $=function(e){return Ge(e)&&"[object Arguments]"==We(e)},J=Object.prototype,kr=J.hasOwnProperty,Cr=J.propertyIsEnumerable,Rr=$(function(){return arguments}())?$:function(e){return Ge(e)&&kr.call(e,"callee")&&!Cr.call(e,"callee")};function Pr(){return!1}var Lr=Re(function(e,t){var t=t&&!t.nodeType&&t,r=t&&e&&!e.nodeType&&e,r=r&&r.exports===t?Le.Buffer:void 0,t=r?r.isBuffer:void 0;e.exports=t||Pr}),Br=/^(?:0|[1-9]\d*)$/;var Ur=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Br.test(e))&&-1<e&&e%1==0&&e<t};var Fr=function(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=9007199254740991},a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1;function Kr(e){return Ge(e)&&Fr(e.length)&&!!a[We(e)]}var Mr=function(t){return function(e){return t(e)}},Y=Re(function(e,t){var t=t&&!t.nodeType&&t,r=t&&e&&!e.nodeType&&e,n=r&&r.exports===t&&Pe.process,t=function(){try{return r&&r.require&&r.require("util").types||n&&n.binding&&n.binding("util")}catch(e){}}();e.exports=t}),r=Y&&Y.isTypedArray,zr=r?Mr(r):Kr,qr=Object.prototype.hasOwnProperty;var Vr=function(e,t){var r,n=h(e),i=!n&&Rr(e),o=!n&&!i&&Lr(e),a=!n&&!i&&!o&&zr(e),l=n||i||o||a,u=l?Nr(e.length,String):[],s=u.length;for(r in e)!t&&!qr.call(e,r)||l&&("length"==r||o&&("offset"==r||"parent"==r)||a&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||Ur(r,s))||u.push(r);return u},Wr=Object.prototype;var Gr=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Wr)};var H=function(t,r){return function(e){return t(r(e))}},Hr=H(Object.keys,Object),Jr=Object.prototype.hasOwnProperty;var $r=function(e){if(!Gr(e))return Hr(e);var t,r=[];for(t in Object(e))Jr.call(e,t)&&"constructor"!=t&&r.push(t);return r};var Yr=function(e){return null!=e&&Fr(e.length)&&!Jt(e)};var Xr=function(e){return(Yr(e)?Vr:$r)(e)};var Qr=function(e,t){return e&&jr(t,Xr(t),e)};var Zr=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},en=Object.prototype.hasOwnProperty;var tn=function(e){if(!v(e))return Zr(e);var t,r=Gr(e),n=[];for(t in e)("constructor"!=t||!r&&en.call(e,t))&&n.push(t);return n};var rn=function(e){return Yr(e)?Vr(e,!0):tn(e)};var nn=function(e,t){return e&&jr(t,rn(t),e)},on=Re(function(e,t){var t=t&&!t.nodeType&&t,r=t&&e&&!e.nodeType&&e,r=r&&r.exports===t?Le.Buffer:void 0,n=r?r.allocUnsafe:void 0;e.exports=function(e,t){return t?e.slice():(t=e.length,t=n?n(t):new e.constructor(t),e.copy(t),t)}});var an=function(e,t){var r=-1,n=e.length;for(t=t||Array(n);++r<n;)t[r]=e[r];return t};var ln=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o};function un(){return[]}var sn=Object.prototype.propertyIsEnumerable,cn=Object.getOwnPropertySymbols,dn=cn?function(t){return null==t?[]:(t=Object(t),ln(cn(t),function(e){return sn.call(t,e)}))}:un;var fn=function(e,t){return jr(e,dn(e),t)};var pn=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e},hn=H(Object.getPrototypeOf,Object),vn=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)pn(t,dn(e)),e=hn(e);return t}:un;var yn=function(e,t){return jr(e,vn(e),t)};var gn=function(e,t,r){return t=t(e),h(e)?t:pn(t,r(e))};var mn=function(e){return gn(e,Xr,dn)};function bn(e){return gn(e,rn,vn)}var V=nr(Le,"DataView"),k=nr(Le,"Promise"),_n=nr(Le,"Set"),W=nr(Le,"WeakMap"),Sn="[object Map]",En="[object Promise]",On="[object Set]",Tn="[object WeakMap]",wn="[object DataView]",An=Qt(V),Dn=Qt(ir),In=Qt(k),xn=Qt(_n),jn=Qt(W),n=We,Nn=n=V&&n(new V(new ArrayBuffer(1)))!=wn||ir&&n(new ir)!=Sn||k&&n(k.resolve())!=En||_n&&n(new _n)!=On||W&&n(new W)!=Tn?function(e){var t=We(e),e="[object Object]"==t?e.constructor:void 0,e=e?Qt(e):"";if(e)switch(e){case An:return wn;case Dn:return Sn;case In:return En;case xn:return On;case jn:return Tn}return t}:n,kn=Object.prototype.hasOwnProperty;var Cn=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&kn.call(e,"index")&&(r.index=e.index,r.input=e.input),r},Rn=Le.Uint8Array;var Pn=function(e){var t=new e.constructor(e.byteLength);return new Rn(t).set(new Rn(e)),t};var Ln=function(e,t){return t=t?Pn(e.buffer):e.buffer,new e.constructor(t,e.byteOffset,e.byteLength)},Bn=/\w*$/;var Un=function(e){var t=new e.constructor(e.source,Bn.exec(e));return t.lastIndex=e.lastIndex,t},j=t?t.prototype:void 0,Fn=j?j.valueOf:void 0;var Kn=function(e){return Fn?Object(Fn.call(e)):{}};var Mn=function(e,t){return t=t?Pn(e.buffer):e.buffer,new e.constructor(t,e.byteOffset,e.length)};var zn=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return Pn(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return Ln(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Mn(e,r);case"[object Map]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return Un(e);case"[object Set]":return new n;case"[object Symbol]":return Kn(e)}},qn=Object.create,Vn=function(e){if(!v(e))return{};if(qn)return qn(e);Wn.prototype=e;e=new Wn;return Wn.prototype=void 0,e};function Wn(){}var Gn=function(e){return"function"!=typeof e.constructor||Gr(e)?{}:Vn(hn(e))};function Hn(e){return Ge(e)&&"[object Map]"==Nn(e)}var R=Y&&Y.isMap,Jn=R?Mr(R):Hn;function $n(e){return Ge(e)&&"[object Set]"==Nn(e)}var J=Y&&Y.isSet,Yn=J?Mr(J):$n,Xn="[object Arguments]",Qn="[object Function]",Zn="[object Object]",y={};y[Xn]=y["[object Array]"]=y["[object ArrayBuffer]"]=y["[object DataView]"]=y["[object Boolean]"]=y["[object Date]"]=y["[object Float32Array]"]=y["[object Float64Array]"]=y["[object Int8Array]"]=y["[object Int16Array]"]=y["[object Int32Array]"]=y["[object Map]"]=y["[object Number]"]=y[Zn]=y["[object RegExp]"]=y["[object Set]"]=y["[object String]"]=y["[object Symbol]"]=y["[object Uint8Array]"]=y["[object Uint8ClampedArray]"]=y["[object Uint16Array]"]=y["[object Uint32Array]"]=!0,y["[object Error]"]=y[Qn]=y["[object WeakMap]"]=!1;var ei=function r(n,i,o,e,t,a){var l,u=1&i,s=2&i,c=4&i;if(void 0!==(l=o?t?o(n,e,t,a):o(n):l))return l;if(!v(n))return n;e=h(n);if(e){if(l=Cn(n),!u)return an(n,l)}else{var d=Nn(n),f=d==Qn||"[object GeneratorFunction]"==d;if(Lr(n))return on(n,u);if(d==Zn||d==Xn||f&&!t){if(l=s||f?{}:Gn(n),!u)return s?yn(n,nn(l,n)):fn(n,Qr(l,n))}else{if(!y[d])return t?n:{};l=zn(n,d,u)}}f=(a=a||new Tr).get(n);if(f)return f;a.set(n,l),Yn(n)?n.forEach(function(e){l.add(r(e,i,o,e,n,a))}):Jn(n)&&n.forEach(function(e,t){l.set(t,r(e,i,o,t,n,a))});var p=e?void 0:(c?s?bn:mn:s?rn:Xr)(n);return wr(p||n,function(e,t){p&&(e=n[t=e]),xr(l,t,r(e,i,o,t,n,a))}),l};var K=function(e){return ei(e,5)};function M(e){if("function"==typeof e)return!0;let t=K(e),r=!0;if(A.isObj(t))for(var n of Object.keys(t)){if(!r)return r;if(A.isObj(t[n]))r=M(t[n]);else if(Array.isArray(t[n]))for(var i of t[n])r=A.isObj(i)?M(i):("string"==typeof i&&(i.startsWith(".")||i.startsWith(".."))&&(r=!1),!0);else if("string"==typeof t[n]){const o=t[n].toString();(o.startsWith(".")||o.startsWith("..")||o.startsWith("=.")||o.startsWith("~"))&&(r=!1)}}else"string"==typeof e&&(e.startsWith(".")||e.startsWith("..")||e.startsWith("=.")||e.startsWith("~"))&&(r=!1);return r}var ti=ri;function ri(e,t){if(!e)throw new Error(t||"Assertion failed")}function ni(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function ii(e){return 1===e.length?"0"+e:e}function oi(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}ri.equal=function(e,t,r){if(e!=t)throw new Error(r||"Assertion failed: "+e+" != "+t)};var l={inherits:Re(function(e){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){var r;t&&(e.super_=t,(r=function(){}).prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e)}}),toArray:function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r,n,i=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),a=0;a<e.length;a+=2)i.push(parseInt(e[a]+e[a+1],16))}else for(var o=0,a=0;a<e.length;a++){var l=e.charCodeAt(a);l<128?i[o++]=l:l<2048?(i[o++]=l>>6|192,i[o++]=63&l|128):(n=a,55296!=(64512&(r=e).charCodeAt(n))||n<0||n+1>=r.length||56320!=(64512&r.charCodeAt(n+1))?i[o++]=l>>12|224:(l=65536+((1023&l)<<10)+(1023&e.charCodeAt(++a)),i[o++]=l>>18|240,i[o++]=l>>12&63|128),i[o++]=l>>6&63|128,i[o++]=63&l|128)}else for(a=0;a<e.length;a++)i[a]=0|e[a];return i},toHex:function(e){for(var t="",r=0;r<e.length;r++)t+=ii(e[r].toString(16));return t},htonl:ni,toHex32:function(e,t){for(var r="",n=0;n<e.length;n++){var i=e[n];r+=oi((i="little"===t?ni(i):i).toString(16))}return r},zero2:ii,zero8:oi,join32:function(e,t,r,n){ti((r-=t)%4==0);for(var i=new Array(r/4),o=0,a=t;o<i.length;o++,a+=4){var l="big"===n?e[a]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3]:e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a];i[o]=l>>>0}return i},split32:function(e,t){for(var r=new Array(4*e.length),n=0,i=0;n<e.length;n++,i+=4){var o=e[n];"big"===t?(r[i]=o>>>24,r[i+1]=o>>>16&255,r[i+2]=o>>>8&255,r[i+3]=255&o):(r[i+3]=o>>>24,r[i+2]=o>>>16&255,r[i+1]=o>>>8&255,r[i]=255&o)}return r},rotr32:function(e,t){return e>>>t|e<<32-t},rotl32:function(e,t){return e<<t|e>>>32-t},sum32:function(e,t){return e+t>>>0},sum32_3:function(e,t,r){return e+t+r>>>0},sum32_4:function(e,t,r,n){return e+t+r+n>>>0},sum32_5:function(e,t,r,n,i){return e+t+r+n+i>>>0},sum64:function(e,t,r,n){var i=e[t],o=n+e[t+1]>>>0;e[t]=(o<n?1:0)+r+i>>>0,e[t+1]=o},sum64_hi:function(e,t,r,n){return(t+n>>>0<t?1:0)+e+r>>>0},sum64_lo:function(e,t,r,n){return t+n>>>0},sum64_4_hi:function(e,t,r,n,i,o,a,l){var u=0;return e+r+i+a+((u+=(e=t+n>>>0)<t?1:0)+((e=e+o>>>0)<o?1:0)+(e+l>>>0<l?1:0))>>>0},sum64_4_lo:function(e,t,r,n,i,o,a,l){return t+n+o+l>>>0},sum64_5_hi:function(e,t,r,n,i,o,a,l,u,s){var c=0;return e+r+i+a+u+(c+((e=t+n>>>0)<t?1:0)+((e=e+o>>>0)<o?1:0)+((e=e+l>>>0)<l?1:0)+(e+s>>>0<s?1:0))>>>0},sum64_5_lo:function(e,t,r,n,i,o,a,l,u,s){return t+n+o+l+s>>>0},rotr64_hi:function(e,t,r){return(t<<32-r|e>>>r)>>>0},rotr64_lo:function(e,t,r){return(e<<32-r|t>>>r)>>>0},shr64_hi:function(e,t,r){return e>>>r},shr64_lo:function(e,t,r){return(e<<32-r|t>>>r)>>>0}};function ai(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var $=ai,li=(ai.prototype.update=function(e,t){if(e=l.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){t=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-t,e.length),0===this.pending.length&&(this.pending=null),e=l.join32(e,0,e.length-t,this.endian);for(var r=0;r<e.length;r+=this._delta32)this._update(e,r,r+this._delta32)}return this},ai.prototype.digest=function(e){return this.update(this._pad()),ti(null===this.pending),this._digest(e)},ai.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,r=t-(e+this.padLength)%t,n=new Array(r+this.padLength);n[0]=128;for(var i=1;i<r;i++)n[i]=0;if(e<<=3,"big"===this.endian){for(var o=8;o<this.padLength;o++)n[i++]=0;n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=e>>>24&255,n[i++]=e>>>16&255,n[i++]=e>>>8&255,n[i++]=255&e}else for(n[i++]=255&e,n[i++]=e>>>8&255,n[i++]=e>>>16&255,n[i++]=e>>>24&255,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,o=8;o<this.padLength;o++)n[i++]=0;return n},{BlockHash:$}),ui=l.rotr32;function si(e,t,r){return e&t^~e&r}function ci(e,t,r){return e&t^e&r^t&r}function di(e,t,r){return e^t^r}var r={ft_1:function(e,t,r,n){return 0===e?si(t,r,n):1===e||3===e?t^r^n:2===e?ci(t,r,n):void 0},ch32:si,maj32:ci,p32:di,s0_256:function(e){return ui(e,2)^ui(e,13)^ui(e,22)},s1_256:function(e){return ui(e,6)^ui(e,11)^ui(e,25)},g0_256:function(e){return ui(e,7)^ui(e,18)^e>>>3},g1_256:function(e){return ui(e,17)^ui(e,19)^e>>>10}},fi=l.rotl32,pi=l.sum32,hi=l.sum32_5,vi=r.ft_1,yi=li.BlockHash,gi=[1518500249,1859775393,2400959708,3395469782];function mi(){if(!(this instanceof mi))return new mi;yi.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}l.inherits(mi,yi);var H=mi,bi=(mi.blockSize=512,mi.outSize=160,mi.hmacStrength=80,mi.padLength=64,mi.prototype._update=function(e,t){for(var r=this.W,n=0;n<16;n++)r[n]=e[t+n];for(;n<r.length;n++)r[n]=fi(r[n-3]^r[n-8]^r[n-14]^r[n-16],1);for(var i=this.h[0],o=this.h[1],a=this.h[2],l=this.h[3],u=this.h[4],n=0;n<r.length;n++)var s=~~(n/20),s=hi(fi(i,5),vi(s,o,a,l),u,r[n],gi[s]),u=l,l=a,a=fi(o,30),o=i,i=s;this.h[0]=pi(this.h[0],i),this.h[1]=pi(this.h[1],o),this.h[2]=pi(this.h[2],a),this.h[3]=pi(this.h[3],l),this.h[4]=pi(this.h[4],u)},mi.prototype._digest=function(e){return"hex"===e?l.toHex32(this.h,"big"):l.split32(this.h,"big")},l.sum32),_i=l.sum32_4,Si=l.sum32_5,Ei=r.ch32,Oi=r.maj32,Ti=r.s0_256,wi=r.s1_256,Ai=r.g0_256,Di=r.g1_256,Ii=li.BlockHash,xi=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function ji(){if(!(this instanceof ji))return new ji;Ii.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=xi,this.W=new Array(64)}l.inherits(ji,Ii);var Ni=ji;function ki(){if(!(this instanceof ki))return new ki;Ni.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}ji.blockSize=512,ji.outSize=256,ji.hmacStrength=192,ji.padLength=64,ji.prototype._update=function(e,t){for(var r=this.W,n=0;n<16;n++)r[n]=e[t+n];for(;n<r.length;n++)r[n]=_i(Di(r[n-2]),r[n-7],Ai(r[n-15]),r[n-16]);var i=this.h[0],o=this.h[1],a=this.h[2],l=this.h[3],u=this.h[4],s=this.h[5],c=this.h[6],d=this.h[7];for(ti(this.k.length===r.length),n=0;n<r.length;n++)var f=Si(d,wi(u),Ei(u,s,c),this.k[n],r[n]),p=bi(Ti(i),Oi(i,o,a)),d=c,c=s,s=u,u=bi(l,f),l=a,a=o,o=i,i=bi(f,p);this.h[0]=bi(this.h[0],i),this.h[1]=bi(this.h[1],o),this.h[2]=bi(this.h[2],a),this.h[3]=bi(this.h[3],l),this.h[4]=bi(this.h[4],u),this.h[5]=bi(this.h[5],s),this.h[6]=bi(this.h[6],c),this.h[7]=bi(this.h[7],d)},ji.prototype._digest=function(e){return"hex"===e?l.toHex32(this.h,"big"):l.split32(this.h,"big")},l.inherits(ki,Ni);var V=ki,Ci=(ki.blockSize=512,ki.outSize=224,ki.hmacStrength=192,ki.padLength=64,ki.prototype._digest=function(e){return"hex"===e?l.toHex32(this.h.slice(0,7),"big"):l.split32(this.h.slice(0,7),"big")},l.rotr64_hi),Ri=l.rotr64_lo,Pi=l.shr64_hi,Li=l.shr64_lo,Bi=l.sum64,Ui=l.sum64_hi,Fi=l.sum64_lo,Ki=l.sum64_4_hi,Mi=l.sum64_4_lo,zi=l.sum64_5_hi,qi=l.sum64_5_lo,Vi=li.BlockHash,Wi=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Gi(){if(!(this instanceof Gi))return new Gi;Vi.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=Wi,this.W=new Array(160)}l.inherits(Gi,Vi);var Hi=Gi;function Ji(){if(!(this instanceof Ji))return new Ji;Hi.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}Gi.blockSize=1024,Gi.outSize=512,Gi.hmacStrength=192,Gi.padLength=128,Gi.prototype._prepareBlock=function(e,t){for(var r,n=this.W,i=0;i<32;i++)n[i]=e[t+i];for(;i<n.length;i+=2){r=n[i-4],a=n[i-3],u=o=void 0,o=Ci(r,a,19),u=Ci(a,r,29),r=Pi(r,a,6),(a=o^u^r)<0&&(a+=4294967296);var o=a,a=(u=n[i-4],r=n[i-3],l=a=void 0,a=Ri(u,r,19),l=Ri(r,u,29),u=Li(u,r,6),(r=a^l^u)<0&&(r+=4294967296),r),l=n[i-14],u=n[i-13],s=(r=n[i-30],c=n[i-29],f=s=void 0,s=Ci(r,c,1),f=Ci(r,c,8),r=Pi(r,c,7),(c=s^f^r)<0&&(c+=4294967296),c),c=(f=n[i-30],r=n[i-29],d=c=void 0,c=Ri(f,r,1),d=Ri(f,r,8),f=Li(f,r,7),(r=c^d^f)<0&&(r+=4294967296),r),d=n[i-32],f=n[i-31];n[i]=Ki(o,a,l,u,s,c,d,f),n[i+1]=Mi(o,a,l,u,s,c,d,f)}},Gi.prototype._update=function(e,t){this._prepareBlock(e,t);var r=this.W,n=this.h[0],i=this.h[1],o=this.h[2],a=this.h[3],l=this.h[4],u=this.h[5],s=this.h[6],c=this.h[7],d=this.h[8],f=this.h[9],p=this.h[10],h=this.h[11],v=this.h[12],y=this.h[13],g=this.h[14],m=this.h[15];ti(this.k.length===r.length);for(var b=0;b<r.length;b+=2)var _=g,S=m,E=(O=E=void 0,E=Ci(A=d,T=f,14),O=Ci(A,T,18),T=Ci(T,A,9),(A=E^O^T)<0&&(A+=4294967296),A),O=(T=O=void 0,O=Ri(A=d,w=f,14),T=Ri(A,w,18),w=Ri(w,A,9),(A=O^T^w)<0&&(A+=4294967296),A),T=function(e,t,r){t=e&t^~e&r;return t<0&&(t+=4294967296),t}(d,p,v),w=function(e,t,r){t=e&t^~e&r;return t<0&&(t+=4294967296),t}(f,h,y),A=this.k[b],D=this.k[b+1],I=r[b],x=r[b+1],j=zi(_,S,E,O,T,w,A,D,I,x),T=qi(_,S,E,O,T,w,A,D,I,x),D=(A=w=void 0,w=Ci(D=n,I=i,28),A=Ci(I,D,2),I=Ci(I,D,7),(D=w^A^I)<0&&(D+=4294967296),_=D,w=x=void 0,x=Ri(A=n,I=i,28),w=Ri(I,A,2),I=Ri(I,A,7),(A=x^w^I)<0&&(A+=4294967296),E=function(e,t,r){e=e&t^e&r^t&r;return e<0&&(e+=4294967296),e}(n,o,l),O=function(e,t,r){e=e&t^e&r^t&r;return e<0&&(e+=4294967296),e}(i,a,u),Ui(_,S=A,E,O)),x=Fi(_,S,E,O),g=v,m=y,v=p,y=h,p=d,h=f,d=Ui(s,c,j,T),f=Fi(c,c,j,T),s=l,c=u,l=o,u=a,o=n,a=i,n=Ui(j,T,D,x),i=Fi(j,T,D,x);Bi(this.h,0,n,i),Bi(this.h,2,o,a),Bi(this.h,4,l,u),Bi(this.h,6,s,c),Bi(this.h,8,d,f),Bi(this.h,10,p,h),Bi(this.h,12,v,y),Bi(this.h,14,g,m)},Gi.prototype._digest=function(e){return"hex"===e?l.toHex32(this.h,"big"):l.split32(this.h,"big")},l.inherits(Ji,Hi);k=Ji;Ji.blockSize=1024,Ji.outSize=384,Ji.hmacStrength=192,Ji.padLength=128,Ji.prototype._digest=function(e){return"hex"===e?l.toHex32(this.h.slice(0,12),"big"):l.split32(this.h.slice(0,12),"big")};var $i={sha1:H,sha224:V,sha256:Ni,sha384:k,sha512:Hi},Yi=l.rotl32,Xi=l.sum32,Qi=l.sum32_3,Zi=l.sum32_4,eo=li.BlockHash;function to(){if(!(this instanceof to))return new to;eo.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}l.inherits(to,eo);W=to;function ro(e,t,r,n){return e<=15?t^r^n:e<=31?t&r|~t&n:e<=47?(t|~r)^n:e<=63?t&n|r&~n:t^(r|~n)}to.blockSize=512,to.outSize=160,to.hmacStrength=192,to.padLength=64,to.prototype._update=function(e,t){for(var r,n=c=this.h[0],i=h=this.h[1],o=p=this.h[2],a=f=this.h[3],l=d=this.h[4],u=0;u<80;u++)var s=Xi(Yi(Zi(c,ro(u,h,p,f),e[no[u]+t],(r=u)<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838),oo[u]),d),c=d,d=f,f=Yi(p,10),p=h,h=s,s=Xi(Yi(Zi(n,ro(79-u,i,o,a),e[io[u]+t],(r=u)<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0),ao[u]),l),n=l,l=a,a=Yi(o,10),o=i,i=s;s=Qi(this.h[1],p,a),this.h[1]=Qi(this.h[2],f,l),this.h[2]=Qi(this.h[3],d,n),this.h[3]=Qi(this.h[4],c,i),this.h[4]=Qi(this.h[0],h,o),this.h[0]=s},to.prototype._digest=function(e){return"hex"===e?l.toHex32(this.h,"little"):l.split32(this.h,"little")};var no=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],io=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],oo=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],ao=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],lo={ripemd160:W};function uo(e,t,r){if(!(this instanceof uo))return new uo(e,t,r);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(l.toArray(t,r))}var so=uo,co=(uo.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),ti(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},uo.prototype.update=function(e,t){return this.inner.update(e,t),this},uo.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)},Re(function(e,t){t.utils=l,t.common=li,t.sha=$i,t.ripemd=lo,t.hmac=so,t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160})),fo=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())}),po={signature({message:e,eskSign:t,sk:r}){let n="";return!t||t.length<100||(console.log("test",{eskSign:t}),n=B.level2SDK.utilServices.signature({message:e,eskSign:t,sk:r})),n},verifySignature(e,t){return B.level2SDK.utilServices.verifySignature(e,t)},generate16Dkey(){var e=Math.floor(1e16*Math.random());return String(e).toString()},decryptAES({key:e,message:t}){e=B.level2SDK.utilServices.normalizeStringTo32BitArray(e),t=B.level2SDK.utilServices.base64ToUint8Array(t),e=B.level2SDK.utilServices.sKeyDecrypt(e,t);let r;return r=e instanceof Uint8Array?B.level2SDK.utilServices.uint8ArrayToBase64(e):r},encryptAES({key:e,message:t}){e=B.level2SDK.utilServices.normalizeStringTo32BitArray(e),t=B.level2SDK.utilServices.base64ToUint8Array(t),e=B.level2SDK.utilServices.sKeyEncrypt(e,t);let r;return r=e instanceof Uint8Array?B.level2SDK.utilServices.uint8ArrayToBase64(e):r},decryptASK({sendPk:e,recvSk:t,eData:r}){e=B.level2SDK.utilServices.base64ToUint8Array(e),t=B.level2SDK.utilServices.base64ToUint8Array(t);return B.level2SDK.utilServices.aKeyDecrypt_str(e,t,r)},encryptASK({recvPk:e,sendSk:t,data:r}){e=B.level2SDK.utilServices.base64ToUint8Array(e),t=B.level2SDK.utilServices.base64ToUint8Array(t);return B.level2SDK.utilServices.aKeyEncrypt_str(e,t,r)},skCheck({pk:e,sk:t}){let r=e,n=t,i;if("string"==typeof e)try{r=B.level2SDK.utilServices.base64ToUint8Array(e)}catch(e){i=!1}if("string"==typeof t)try{n=B.level2SDK.utilServices.base64ToUint8Array(t)}catch(e){i=!1}try{i=B.level2SDK.utilServices.aKeyCheck(r,n)}catch(e){i=!1}return i},generateESAK({pk:e}){var t=localStorage.getItem("sk");if(null===e)throw new P({name:"ERROR_CREATING_ESAK"});if(null===t)throw new P({name:"LOGIN_REQUIRED",message:"There is no secretKey present in localStorage. Please log In."});let r;r="string"==typeof e?B.level2SDK.utilServices.base64ToUint8Array(e):e;e=B.level2SDK.utilServices.base64ToUint8Array(t),t=B.level2SDK.utilServices.generateSKey().slice(0,16),e=B.level2SDK.utilServices.aKeyEncrypt(r,e,t);return B.level2SDK.utilServices.uint8ArrayToBase64(e)},decryptData({esak:e,publicKey:t,secretKey:r,data:n}){if(null===t)throw new P({name:"LOGIN_REQUIRED",message:"There is no publicKey present in localStorage. Please log In."});if(null===r)throw new P({name:"LOGIN_REQUIRED",message:"There is no secretKey present in localStorage. Please log In."});let i;i="string"==typeof e?B.level2SDK.utilServices.base64ToUint8Array(e):e;e=B.level2SDK.utilServices.base64ToUint8Array(t),t=B.level2SDK.utilServices.base64ToUint8Array(r),r=B.level2SDK.utilServices.aKeyDecrypt(e,t,i),e=co.sha256().update(r).digest(),t=new Uint8Array(e),r=B.level2SDK.utilServices.sKeyDecrypt(t,n);if(null!==r)return r;throw new P({name:"ERROR_DECRYPTING_DATA"})},decryptESAK({esak:e,publicKey:t,secretKey:r}){if(null===t)throw new P({name:"LOGIN_REQUIRED",message:"There is no publicKey present in localStorage. Please log In."});if(null===r)throw new P({name:"LOGIN_REQUIRED",message:"There is no secretKey present in localStorage. Please log In."});let n;n="string"==typeof e?B.level2SDK.utilServices.base64ToUint8Array(e):e;e=B.level2SDK.utilServices.base64ToUint8Array(t),t=B.level2SDK.utilServices.base64ToUint8Array(r),r=B.level2SDK.utilServices.aKeyDecrypt(e,t,n),e=co.sha256().update(r).digest(),t=new Uint8Array(e);return B.level2SDK.utilServices.uint8ArrayToBase64(t)},isEdgeEncrypted(e){return fo(this,arguments,function*({id:e}){var e=yield F(e),t=null!=(t=null==(t=null==e?void 0:e.data)?void 0:t.edge)&&t.length?e.data.edge[0]:null;if(t)return!!(null!=t&&t.besak||null!=t&&t.eesak);throw new P({name:"EDGE_DOES_NOT_EXIST"})})},getSAKFromEdge(e){return fo(this,arguments,function*({id:e}){var t,e=yield F(e);if(null!=(t=null==(t=null==e?void 0:e.data)?void 0:t.edge)&&t.length&&e.data.edge[0])return"";throw new P({name:"EDGE_DOES_NOT_EXIST"})})}};const z={ADD_FUNCTION:"ADD_FUNCTION",EVAL_OBJECT:"EVAL_OBJECT",GET_CACHE:"GET_CACHE",GET_DATA:"GET_DATA",INSERT_TO_INDEX_TABLE:"INSERT_TO_INDEX_TABLE",INSERT_TO_OBJECT_TABLE:"INSERT_TO_OBJECT_TABLE",POPULATE:"POPULATE",POPULATE_OBJECT:"POPULATE_OBJECT",IF_OBJECT:"IF_OBJECT",SEARCH_CACHE:"SEARCH_CACHE",SET_API_BUFFER:"SET_API_BUFFER",SET_CACHE:"SET_CACHE",UPDATE_DATA:"UPDATE_DATA",UPDATE_LOCAL_STORAGE:"UPDATE_LOCAL_STORAGE",FONTDB_OPREATE:"FONTDB_OPREATE",PULL_INDEX_TABLE:"PULL_INDEX_TABLE",PUSH_INDEX_TABLE:"PUSH_INDEX_TABLE"},T={ADD_BUILTIN_FNS:"ADD_BUILTIN_FNS",DELETE_PAGE:"DELETE_PAGE",EDIT_DRAFT:"EDIT_DRAFT",SET_CACHE:"SET_CACHE",SET_ROOT_PROPERTIES:"SET_ROOT_PROPERTIES",SET_LOCAL_PROPERTIES:"SET_LOCAL_PROPERTIES",SET_VALUE:"SET_VALUE"},ho={QUEUE_START:"QUEUE_START",QUEUE_END:"QUEUE_END"};var vo=Object.defineProperty,yo=Object.defineProperties,go=Object.getOwnPropertyDescriptors,mo=Object.getOwnPropertySymbols,bo=Object.prototype.hasOwnProperty,_o=Object.prototype.propertyIsEnumerable,So=(e,t,r)=>t in e?vo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Eo=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())}),D=Object.freeze({__proto__:null,create:e=>Eo(window,[e],function*({edge_id:t,title:e,tags:r=[],content:n,tage:i,type:o,user:a,sesk:l,aesk:u,targetRoomName:s,notification:c,fid:d,reid:f,mediaType:p,dataType:h=0,dTypeProps:v,paymentNonce:y,jwt:g,dispatch:m}){if(!M(t))throw new Se("Missing reference "+t);var t=yield F(t),t=(null==(t=null==(t=null==t?void 0:t.data)?void 0:t.edge)?void 0:t[0])||null;if(!t)throw new P({name:"EDGE_DOES_NOT_EXIST"});const b=new Et;b.dataType=(null==v?void 0:v.applicationDataType)||(null==v?void 0:v.dataType)||h,b.isEditable=!!+(null==v?void 0:v.isEditable)||!0;var h=yield Ct(n,p),{data:n,isGzip:p}=(b.setMediaType(p||h.type),yield kt(h));b.isGzip=!!+(null==v?void 0:v.isGzip)||p,b.notification=!!+(null==v?void 0:v.notification),b.ringToneNotify=!!+(null==v?void 0:v.ringToneNotify),b.sendtoSelf=!!+(null==v?void 0:v.sendtoSelf),b.isOnServer=!!+(null==v?void 0:v.isOnServer)||n.length<32768,b.isEncrypted=!!+(null==v?void 0:v.isEncrypted);let _="",S="";const E=t.bvid instanceof Uint8Array?B.level2SDK.utilServices.uint8ArrayToBase64(t.bvid):t.bvid,O=t.evid instanceof Uint8Array?B.level2SDK.utilServices.uint8ArrayToBase64(t.evid):t.evid,T=localStorage.getItem("user_vid"),w=E===T,A=E===O,D=localStorage.getItem("pk")||"",I=4e4===(null==t?void 0:t.type);if(w){if(t.besak&&(+(null==v?void 0:v.isEncrypted)||"undefined"===(null==v?void 0:v.isEncrypted)))b.isEncrypted=!0,_=t.besak,S=D;else if(!t.besak&&+(null==v?void 0:v.isEncrypted)){b.isEncrypted=!0;let e;S=D,_=po.generateESAK({pk:D});try{e=yield B.level2SDK.edgeServices.updateEdge({besak:_,id:t.eid,type:t.type,name:t.name})}catch(e){L.default.error(e instanceof Error?e:new Error(String(e))),_=""}e&&null!=(p=null==e?void 0:e.data)&&p.edge||(_="")}}else if(I&&!w){const N=yield F(t.eid,{type:1053,xfname:"refid"}),k=((null==N?void 0:N.data)||{})["edge"],C=k.filter(e=>B.level2SDK.utilServices.uint8ArrayToBase64(e.evid)===T),R=0<C.length?C.shift():"";R&&(_=R.eesak),R||(_="");var p=(yield B.level2SDK.vertexServices.retrieveVertex({idList:U(null==t?void 0:t.bvid)}))["data"],p=null==(p=null==p?void 0:p.vertex)?void 0:p[0];S=null==(p=null==p?void 0:p.deat)?void 0:p.pk}else A&&t.eesak&&(+(null==v?void 0:v.isEncrypted)||"undefined"===(null==v?void 0:v.isEncrypted))&&(b.isEncrypted=!0,_=t.eesak,p=(yield B.level2SDK.vertexServices.retrieveVertex({idList:U(null==t?void 0:t.bvid)}))["data"],p=null==(v=null==p?void 0:p.vertex)?void 0:v[0],S=null==(v=null==p?void 0:p.deat)?void 0:v.pk);let x=n;b.isEncrypted&&(p=(yield Nt(n,_,S))["data"],x=p);v=yield B.level2SDK.utilServices.uint8ArrayToBase64(x);b.isBinary=!1;const j={title:e,tags:r,type:h.type};a&&(j.user=a),s&&(j.targetRoomName=s),l&&(j.sesk=l),u&&(j.aesk=u),b.isOnServer&&(j.data=v),y&&(j.nonce=y),c&&(j.notification=c);n=yield B.level2SDK.documentServices.createDocument({eid:t.eid,eSig:f,type:o,subtype:b.value,name:j,tage:i,size:h.size,fid:d,jwt:g}).then(B.responseCatcher).catch(B.errorCatcher);if(!n||!n.data)throw new P({name:"UNKNOW_ERROR",message:"Document -> create -> createDocument -> no response"});e=null==(p=n.data)?void 0:p.document;if(!e)return n;r=e.deat,!b.isOnServer&&null!==r&&r&&r.url&&r.sig&&(yield B.level2SDK.documentServices.uploadDocumentToS3({url:r.url,sig:r.sig,data:v}).then(B.responseCatcher).catch(B.errorCatcher)),m&&(yield m({type:z.INSERT_TO_OBJECT_TABLE,payload:{doc:e}})),a=yield Rt({document:e});return{jwt:null==(s=null==n?void 0:n.data)?void 0:s.jwt,error:null==(l=null==n?void 0:n.data)?void 0:l.error,doc:a,code:null==(u=null==n?void 0:n.data)?void 0:u.code}}),nocheckcreate:e=>Eo(window,[e],function*({edge_id:e,title:t,tags:r=[],content:n,tage:i,type:o,user:a,sesk:l,aesk:u,targetRoomName:s,fid:c,reid:d,mediaType:f,dataType:p=0,dTypeProps:h,notification:v,paymentNonce:y,jwt:g,dispatch:m}){const b=new Et;b.dataType=(null==h?void 0:h.applicationDataType)||(null==h?void 0:h.dataType)||p,b.isEditable=!!+(null==h?void 0:h.isEditable)||!0;var p=yield Ct(n,f),{data:n,isGzip:f}=(b.setMediaType(f||p.type),yield kt(p));b.isGzip=!!+(null==h?void 0:h.isGzip)||f,b.isOnServer=!!+(null==h?void 0:h.isOnServer)||n.length<32768,b.isEncrypted=!!+(null==h?void 0:h.isEncrypted);localStorage.getItem("user_vid");let _=n;b.isEncrypted&&(f=(yield Nt(n,"",""))["data"],_=f);h=yield B.level2SDK.utilServices.uint8ArrayToBase64(_);b.isBinary=!1;const S={title:t,tags:r,type:p.type};a&&(S.user=a),s&&(S.targetRoomName=s),l&&(S.sesk=l),u&&(S.aesk=u),b.isOnServer&&(S.data=h),y&&(S.nonce=y),v&&(S.notification=v);n=yield B.level2SDK.documentServices.createDocument({eid:e,eSig:d,type:o,subtype:b.value,name:S,tage:i,size:p.size,fid:c,jwt:g}).then(B.responseCatcher).catch(B.errorCatcher);if(!n||!n.data)throw new P({name:"UNKNOW_ERROR",message:"Document -> create -> createDocument -> no response"});t=null==(f=n.data)?void 0:f.document;if(!t)return n;r=t.deat,!b.isOnServer&&null!==r&&r&&r.url&&r.sig&&(yield B.level2SDK.documentServices.uploadDocumentToS3({url:r.url,sig:r.sig,data:h}).then(B.responseCatcher).catch(B.errorCatcher)),m&&(yield m({type:z.INSERT_TO_OBJECT_TABLE,payload:{doc:t}})),a=yield Rt({document:t});return{jwt:null==(s=null==n?void 0:n.data)?void 0:s.jwt,error:null==(l=null==n?void 0:n.data)?void 0:l.error,doc:a,code:null==(u=null==n?void 0:n.data)?void 0:u.code}}),retrieve:(r,n)=>Eo(window,null,function*(){var e,t=yield tt(r),t=null!=(e=null==(e=null==t?void 0:t.data)?void 0:e.document)&&e.length?null==(e=null==t?void 0:t.data)?void 0:e.document[0]:null;if(t)return yield Rt({document:t,_edge:n});throw new P({name:"NOT_A_NOTE"})}),update:(e,t)=>Eo(window,[e,t],function*(e,{edge_id:n,title:i,content:o,mediaType:a,tags:l,type:u,dTypeProps:s,jwt:c,reid:d,fid:f}){var p=yield tt(e),p=null!=(h=null==(h=null==p?void 0:p.data)?void 0:h.document)&&h.length?null==(h=null==p?void 0:p.data)?void 0:h.document[0]:null;if(!p)throw new P({name:"NOT_A_NOTE"});var h=(null==(h=null==(h=null==(h=void 0!==n?yield F(n):yield F(null==p?void 0:p.eid))?void 0:h.data)?void 0:h.edge)?void 0:h[0])||null;if(!h)throw new P({name:"EDGE_DOES_NOT_EXIST"});const v={id:p.id,eid:h.eid},y=p.name,g=(void 0!==i&&(y.title=i),void 0!==l&&Array.isArray(y.tags)&&Array.isArray(l)&&(i=new Set([...y.tags,...l]),y.tags=Array.from(i)),void 0===l||Array.isArray(y.tags)&&Array.isArray(l)||(y.tags=[]),void 0!==y.isOnS3||void 0!==y.isGzip||void 0!==y.isBinary||void 0!==y.isEncrypt||void 0!==y.edit_mode?new Et:new Et(p.type));let m,b;if(void 0===o){if(v.name=y,!(b=yield B.level2SDK.documentServices.updateDocument((i=((e,t)=>{for(var r in t=t||{})bo.call(t,r)&&So(e,r,t[r]);if(mo)for(var r of mo(t))_o.call(t,r)&&So(e,r,t[r]);return e})({},v),l={subtype:g.value,jwt:c},yo(i,go(l)))).then(B.responseCatcher).catch(B.errorCatcher))||0!==b.code)throw new P({name:"UNKNOW_ERROR",message:"Document -> update -> updateDocument -> no response"});var i=yield tt(e),e=null!=(e=null==(l=null==i?void 0:i.data)?void 0:l.document)&&e.length?null==(l=null==i?void 0:i.data)?void 0:l.document[0]:null;m=yield Rt({document:e})}else{var i=yield Ct(o,a),{data:l,isGzip:e}=yield kt(i);g.isGzip=e,g.isOnServer=!!+(null==s?void 0:s.isOnServer)||l.length<32768;let t="",r="";if(h.besak&&h.sig)t=h.besak,r=h.sig instanceof Uint8Array?yield B.level2SDK.utilServices.uint8ArrayToBase64(h.sig):h.sig;else if(h.eesak&&h.sig)t=h.eesak,r=h.sig instanceof Uint8Array?yield B.level2SDK.utilServices.uint8ArrayToBase64(h.sig):h.sig;else if(+(null==s?void 0:s.isEncrypted)&&!h.besak){var o=localStorage.getItem("pk");if(o){let e;r=o,t=po.generateESAK({pk:o});try{e=yield B.level2SDK.edgeServices.updateEdge({besak:t,id:h.eid,type:h.type,name:h.name,sig:o})}catch(e){L.default.error(e instanceof Error?e:new Error(String(e))),t=""}e&&null!=(a=null==e?void 0:e.data)&&a.edge||(t="")}}var{data:e,isEncrypt:s}=yield Nt(l,t,r),h=(g.isEncrypted=s,yield B.level2SDK.utilServices.uint8ArrayToBase64(e));if(g.isBinary=!1,y.type=i.type,v.size=i.size,g.isOnServer?(y.data=h,v.name=y):void 0!==y.data&&delete y.data,!(b=yield B.level2SDK.documentServices.updateDocument({id:p.id,eid:n,subtype:g.value,name:v.name,size:i.size,type:u,jwt:c,eSig:d,fid:f}))||0!==b.code)throw new P({name:"UNKNOW_ERROR",message:"Document -> update -> updateDocument -> no response"});a=null==(o=b.data)?void 0:o.document,l=a["deat"],s=(null!==l&&l&&l.url&&l.sig&&!g.isOnServer&&(yield B.level2SDK.documentServices.uploadDocumentToS3({url:l.url,sig:l.sig,data:h}).then(B.responseCatcher).catch(B.errorCatcher)),yield tt(a.id)),i=null!=(p=null==(e=null==s?void 0:s.data)?void 0:e.document)&&p.length?null==(n=null==s?void 0:s.data)?void 0:n.document[0]:null;m=yield Rt({document:i})}return{jwt:null==(u=null==b?void 0:b.data)?void 0:u.jwt,error:null==(c=null==b?void 0:b.data)?void 0:c.error,doc:m,code:null==(d=null==b?void 0:b.data)?void 0:d.code}}),retrieveUncachedDocs:e=>Eo(window,null,function*(){let t;return yield B.level2SDK.documentServices.retrieveDocument({idList:[e],options:{xfname:"id"}}).then(e=>{t=null==e?void 0:e.data}),t}),retrieveAllVisibleEcosDocs:e=>Eo(window,null,function*(){let t;return yield B.level2SDK.documentServices.retrieveDocument({idList:[e],options:{ObjType:8,scondition:"E.type>9999 AND D.type not in (1793)",asc:!0,obfname:"D.mtime"}}).then(e=>{t=null==e?void 0:e.data}),t}),retrieveAllNewVisibleEcosDocs:(e,r)=>Eo(window,null,function*(){let t;return yield B.level2SDK.documentServices.retrieveDocument({idList:[e],options:{ObjType:8,scondition:"E.type>9999 AND D.type not in (1793)",asc:!0,obfname:"D.mtime",loid:r}}).then(e=>{t=null==e?void 0:e.data}),t}),docUploadToS3:(t,r)=>Eo(window,null,function*(){var e=null==t?void 0:t.deat;null!==e&&e&&e.url&&r&&(0==(null==(e=yield B.level2SDK.documentServices.uploadDocumentToS3({url:e.url,sig:e.sig,data:r}).then(B.responseCatcher).catch(B.errorCatcher))?void 0:e.code)?console.log("upload doc success"):console.log("upload doc failed"))})});const g={pages:{},refs:{}};var Oo=function(e){return ei(e,4)},To=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,wo=/^\w*$/;var Ao=function(e,t){if(h(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!He(e))||(wo.test(e)||!To.test(e)||null!=t&&e in Object(t))};function Do(n,i){if("function"!=typeof n||null!=i&&"function"!=typeof i)throw new TypeError("Expected a function");function o(){var e=arguments,t=i?i.apply(this,e):e[0],r=o.cache;return r.has(t)?r.get(t):(e=n.apply(this,e),o.cache=r.set(t,e)||r,e)}return o.cache=new(Do.Cache||Sr),o}Do.Cache=Sr;var Io=Do;var xo=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,jo=/\\(\\)?/g,No=function(e){var t=(e=Io(e,function(e){return 500===t.size&&t.clear(),e})).cache;return e}(function(e){var i=[];return 46===e.charCodeAt(0)&&i.push(""),e.replace(xo,function(e,t,r,n){i.push(r?n.replace(jo,"$1"):t||e)}),i});var ko=function(e,t){return h(e)?e:Ao(e,t)?[e]:No(Ye(e))};var Co=function(e){if("string"==typeof e||He(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t};var Ro=function(e,t){for(var r=0,n=(t=ko(t,e)).length;null!=e&&r<n;)e=e[Co(t[r++])];return r&&r==n?e:void 0};var m=function(e,t,r){return void 0===(e=null==e?void 0:Ro(e,t))?r:e};var Po=function(e,t,r,n){if(!v(e))return e;for(var i=-1,o=(t=ko(t,e)).length,a=o-1,l=e;null!=l&&++i<o;){var u,s=Co(t[i]),c=r;if("__proto__"===s||"constructor"===s||"prototype"===s)return e;i!=a&&(u=l[s],void 0===(c=n?n(u,s,l):void 0)&&(c=v(u)?u:Ur(t[i+1])?[]:{})),xr(l,s,c),l=l[s]}return e};var p=function(e,t,r){return null==e?e:Po(e,t,r)};function Lo(){return"undefined"!=typeof window}function Bo(t,r){let n=t;return A.isObj(t)&&A.isObj(r)&&Object.keys(r).forEach(e=>{A.isObj(r[e])?e in t&&A.isObj(t[e])?n[e]=Bo(t[e],r[e]):n[e]=r[e]:null===r[e]&&null!==t[e]?n[e]=t[e]:n[e]=r[e]}),n}function Uo({source:e,lookFor:t,skip:r,locations:n=[],path:i,dispatch:o,shouldAttachRef:a,pageName:l}){if(r&&r.includes(e)||!e.startsWith(t))return e;let u=e,s;if("~"===t)u=".myBaseUrl";else{if("_"===t&&u.includes(".")){let e=u.split(""),t=Oo(i)||[],r=e.shift();for(;"."!==r&&0<e.length;)"_"===r&&t.pop(),r=e.shift();return s="."+t.concat(e.join("")).join(".")}".."===t?u=u.slice(1):"="===t&&(e.startsWith("=..")?u=u.slice(2):e.startsWith("=.")&&(u=u.slice(1)))}(u=u.startsWith(".")?u.slice(1):u).startsWith("$")&&(u=u.slice(1));for(var c of n)try{if(s=te.default.pick(u,c),(s=".myBaseUrl"!==u||s?s:te.default.pick(".baseUrl",c))&&"~"==t){s+=e.substring(2);break}if((s||""===s||0===s)&&s!==e){if(A.isStr(s)&&s.startsWith(t))return Uo({source:s,lookFor:t,skip:r,locations:[...n],path:i,pageName:l,dispatch:o,shouldAttachRef:a});break}}catch(e){if(e instanceof Se)continue;throw e}return A.isUnd(s)||s===e?(M(e)&&"test"===B.env&&i&&L.default.info("%cReference Not Found in "+l,"background: orange; color: black; display: block;",{[i.join(".")]:e}),e):s}var Fo=Object.defineProperty,Ko=Object.defineProperties,Mo=Object.getOwnPropertyDescriptors,zo=Object.getOwnPropertySymbols,qo=Object.prototype.hasOwnProperty,Vo=Object.prototype.propertyIsEnumerable,Wo=(e,t,r)=>t in e?Fo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Go=(e,t)=>{for(var r in t=t||{})qo.call(t,r)&&Wo(e,r,t[r]);if(zo)for(var r of zo(t))Vo.call(t,r)&&Wo(e,r,t[r]);return e},Ho=(e,t)=>Ko(e,Mo(t)),Jo=(e,t)=>{var r={};for(n in e)qo.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&zo)for(var n of zo(e))t.indexOf(n)<0&&Vo.call(e,n)&&(r[n]=e[n]);return r};function $o(e,t,r){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:r,set(){}})}function Yo(e,t,r){const n=r,{_path_:i,_ref_:o}=n,a=Jo(n,["_path_","_ref_"]),l=t[e];$o(e,t,()=>Uo(Ho(Go({},a),{source:l}))),r.pageName&&o&&(g.refs[r.pageName]||(g.refs[r.pageName]={}),g.refs[r.pageName][o]||(g.refs[r.pageName][o]={key:e,ref:o,path:i,isLocal:x.Identify.localReference(o)})),Object.getOwnPropertyDescriptor(t,"_ref_")||($o("_key_",t,()=>e),i&&$o("_path_",t,()=>i),o&&$o("_ref_",t,()=>o))}var Xo=Object.defineProperty,Qo=Object.defineProperties,Zo=Object.getOwnPropertyDescriptors,ea=Object.getOwnPropertySymbols,ta=Object.prototype.hasOwnProperty,ra=Object.prototype.propertyIsEnumerable,na=(e,t,r)=>t in e?Xo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;function ia(e){let t=Object.assign({},e);var r,n=t["eid"];return n?(n=B.utils.idToBase64(n),delete(t=(r=((e,t)=>{for(var r in t=t||{})ta.call(t,r)&&na(e,r,t[r]);if(ea)for(var r of ea(t))ra.call(t,r)&&na(e,r,t[r]);return e})({},t),Qo(r,Zo({id:n})))).eid,t):e}var oa=Re(function(x,j){!function(){var Mo,zo="Expected a function",ma="__lodash_hash_undefined__",ba="__lodash_placeholder__",qo=128,Vo=9007199254740991,_a=NaN,Wo=4294967295,Sa=[["ary",qo],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],Go="[object Arguments]",Ea="[object Array]",Ho="[object Boolean]",Jo="[object Date]",Oa="[object Error]",Ta="[object Function]",wa="[object GeneratorFunction]",$o="[object Map]",Yo="[object Number]",Xo="[object Object]",Aa="[object Promise]",Qo="[object RegExp]",Zo="[object Set]",ea="[object String]",Da="[object Symbol]",ta="[object WeakMap]",Ia="[object ArrayBuffer]",ra="[object DataView]",xa="[object Float32Array]",ja="[object Float64Array]",Na="[object Int8Array]",ka="[object Int16Array]",Ca="[object Int32Array]",Ra="[object Uint8Array]",Pa="[object Uint8ClampedArray]",La="[object Uint16Array]",Ba="[object Uint32Array]",Ua=/\b__p \+= '';/g,Fa=/\b(__p \+=) '' \+/g,Ka=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ma=/&(?:amp|lt|gt|quot|#39);/g,za=/[&<>"']/g,qa=RegExp(Ma.source),Va=RegExp(za.source),Wa=/<%-([\s\S]+?)%>/g,Ga=/<%([\s\S]+?)%>/g,Ha=/<%=([\s\S]+?)%>/g,Ja=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$a=/^\w*$/,Ya=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Xa=/[\\^$.*+?()[\]{}|]/g,Qa=RegExp(Xa.source),Za=/^\s+/,o=/\s/,el=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,tl=/\{\n\/\* \[wrapped with (.+)\] \*/,rl=/,? & /,nl=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,il=/[()=,{}\[\]\/\s]/,ol=/\\(\\)?/g,al=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ll=/\w*$/,ul=/^[-+]0x[0-9a-f]+$/i,sl=/^0b[01]+$/i,cl=/^\[object .+?Constructor\]$/,dl=/^0o[0-7]+$/i,fl=/^(?:0|[1-9]\d*)$/,pl=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,hl=/($^)/,vl=/['\n\r\u2028\u2029\\]/g,a="\\ud800-\\udfff",l="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",u="\\u2700-\\u27bf",e="a-z\\xdf-\\xf6\\xf8-\\xff",t="A-Z\\xc0-\\xd6\\xd8-\\xde",s="\\ufe0e\\ufe0f",c="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",d="['’]",r="["+a+"]",f="["+c+"]",p="["+l+"]",h="["+u+"]",v="["+e+"]",c="[^"+a+c+"\\d+"+u+e+t+"]",u="\\ud83c[\\udffb-\\udfff]",e="[^"+a+"]",y="(?:\\ud83c[\\udde6-\\uddff]){2}",n="[\\ud800-\\udbff][\\udc00-\\udfff]",t="["+t+"]",g="\\u200d",m="(?:"+v+"|"+c+")",c="(?:"+t+"|"+c+")",b="(?:['’](?:d|ll|m|re|s|t|ve))?",_="(?:['’](?:D|LL|M|RE|S|T|VE))?",S="(?:"+p+"|"+u+")"+"?",E="["+s+"]?",E=E+S+("(?:"+g+"(?:"+[e,y,n].join("|")+")"+E+S+")*"),S="(?:"+[h,y,n].join("|")+")"+E,h="(?:"+[e+p+"?",p,y,n,r].join("|")+")",yl=RegExp(d,"g"),gl=RegExp(p,"g"),O=RegExp(u+"(?="+u+")|"+h+E,"g"),ml=RegExp([t+"?"+v+"+"+b+"(?="+[f,t,"$"].join("|")+")",c+"+"+_+"(?="+[f,t+m,"$"].join("|")+")",t+"?"+m+"+"+b,t+"+"+_,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",S].join("|"),"g"),T=RegExp("["+g+a+l+s+"]"),bl=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,_l=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Sl=-1,na={},ia=(na[xa]=na[ja]=na[Na]=na[ka]=na[Ca]=na[Ra]=na[Pa]=na[La]=na[Ba]=!0,na[Go]=na[Ea]=na[Ia]=na[Ho]=na[ra]=na[Jo]=na[Oa]=na[Ta]=na[$o]=na[Yo]=na[Xo]=na[Qo]=na[Zo]=na[ea]=na[ta]=!1,{}),w=(ia[Go]=ia[Ea]=ia[Ia]=ia[ra]=ia[Ho]=ia[Jo]=ia[xa]=ia[ja]=ia[Na]=ia[ka]=ia[Ca]=ia[$o]=ia[Yo]=ia[Xo]=ia[Qo]=ia[Zo]=ia[ea]=ia[Da]=ia[Ra]=ia[Pa]=ia[La]=ia[Ba]=!0,ia[Oa]=ia[Ta]=ia[ta]=!1,{"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"}),El=parseFloat,Ol=parseInt,e="object"==typeof Ce&&Ce&&Ce.Object===Object&&Ce,y="object"==typeof self&&self&&self.Object===Object&&self,oa=e||y||Function("return this")(),n=j&&!j.nodeType&&j,i=n&&x&&!x.nodeType&&x,Tl=i&&i.exports===n,A=Tl&&e.process,r=function(){try{return i&&i.require&&i.require("util").types||A&&A.binding&&A.binding("util")}catch(e){}}(),wl=r&&r.isArrayBuffer,Al=r&&r.isDate,Dl=r&&r.isMap,Il=r&&r.isRegExp,xl=r&&r.isSet,jl=r&&r.isTypedArray;function aa(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function Nl(e,t,r,n){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(n,a,r(a),e)}return n}function la(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}function kl(e,t){for(var r=null==e?0:e.length;r--&&!1!==t(e[r],r,e););return e}function Cl(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}function ua(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o}function Rl(e,t){return!!(null==e?0:e.length)&&-1<da(e,t,0)}function Pl(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}function sa(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}function ca(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}function Ll(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}function Bl(e,t,r,n){var i=null==e?0:e.length;for(n&&i&&(r=e[--i]);i--;)r=t(r,e[i],i,e);return r}function Ul(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var D=Vl("length");function Fl(e,n,t){var i;return t(e,function(e,t,r){if(n(e,t,r))return i=t,!1}),i}function Kl(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function da(e,t,r){if(t!=t)return Kl(e,zl,r);for(var n=e,i=t,o=r-1,a=n.length;++o<a;)if(n[o]===i)return o;return-1}function Ml(e,t,r,n){for(var i=r-1,o=e.length;++i<o;)if(n(e[i],t))return i;return-1}function zl(e){return e!=e}function ql(e,t){var r=null==e?0:e.length;return r?Gl(e,t)/r:_a}function Vl(t){return function(e){return null==e?Mo:e[t]}}function I(t){return function(e){return null==t?Mo:t[e]}}function Wl(e,n,i,o,t){return t(e,function(e,t,r){i=o?(o=!1,e):n(i,e,t,r)}),i}function Gl(e,t){for(var r,n=-1,i=e.length;++n<i;){var o=t(e[n]);o!==Mo&&(r=r===Mo?o:r+o)}return r}function Hl(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function Jl(e){return e&&e.slice(0,ou(e)+1).replace(Za,"")}function fa(t){return function(e){return t(e)}}function $l(t,e){return sa(e,function(e){return t[e]})}function Yl(e,t){return e.has(t)}function Xl(e,t){for(var r=-1,n=e.length;++r<n&&-1<da(t,e[r],0););return r}function Ql(e,t){for(var r=e.length;r--&&-1<da(t,e[r],0););return r}var Zl=I({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),eu=I({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function tu(e){return"\\"+w[e]}function pa(e){return T.test(e)}function ru(e){var r=-1,n=Array(e.size);return e.forEach(function(e,t){n[++r]=[t,e]}),n}function nu(t,r){return function(e){return t(r(e))}}function ha(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var a=e[r];a!==t&&a!==ba||(e[r]=ba,o[i++]=r)}return o}function iu(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}function va(e){return(pa(e)?function(e){for(var t=O.lastIndex=0;O.test(e);)++t;return t}:D)(e)}function ya(e){return pa(e)?e.match(O)||[]:e.split("")}function ou(e){for(var t=e.length;t--&&o.test(e.charAt(t)););return t}var au=I({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var ga=function i(e){var E=(e=null==e?oa:ga.defaults(oa.Object(),e,ga.pick(oa,_l))).Array,B=e.Date,U=e.Error,F=e.Function,K=e.Math,y=e.Object,M=e.RegExp,z=e.String,m=e.TypeError,q=E.prototype,V=F.prototype,W=y.prototype,G=e["__core-js_shared__"],H=V.toString,b=W.hasOwnProperty,J=0,$=(V=/[^.]+$/.exec(G&&G.keys&&G.keys.IE_PROTO||""))?"Symbol(src)_1."+V:"",Y=W.toString,X=H.call(y),Q=oa._,Z=M("^"+H.call(b).replace(Xa,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),V=Tl?e.Buffer:Mo,t=e.Symbol,ee=e.Uint8Array,te=V?V.allocUnsafe:Mo,re=nu(y.getPrototypeOf,y),ne=y.create,ie=W.propertyIsEnumerable,oe=q.splice,ae=t?t.isConcatSpreadable:Mo,le=t?t.iterator:Mo,ue=t?t.toStringTag:Mo,se=function(){try{var e=Xr(y,"defineProperty");return e({},"",{}),e}catch(e){}}(),ce=e.clearTimeout!==oa.clearTimeout&&e.clearTimeout,de=B&&B.now!==oa.Date.now&&B.now,fe=e.setTimeout!==oa.setTimeout&&e.setTimeout,pe=K.ceil,he=K.floor,ve=y.getOwnPropertySymbols,V=V?V.isBuffer:Mo,ye=e.isFinite,ge=q.join,me=nu(y.keys,y),_=K.max,O=K.min,be=B.now,_e=e.parseInt,Se=K.random,Ee=q.reverse,B=Xr(e,"DataView"),Oe=Xr(e,"Map"),Te=Xr(e,"Promise"),we=Xr(e,"Set"),e=Xr(e,"WeakMap"),Ae=Xr(y,"create"),De=e&&new e,Ie={},xe=On(B),je=On(Oe),Ne=On(Te),ke=On(we),Ce=On(e),t=t?t.prototype:Mo,Re=t?t.valueOf:Mo,Pe=t?t.toString:Mo;function h(e){if(o(e)&&!D(e)&&!(e instanceof g)){if(e instanceof v)return e;if(b.call(e,"__wrapped__"))return Tn(e)}return new v(e)}var Le=function(e){if(!x(e))return{};if(ne)return ne(e);Be.prototype=e;e=new Be;return Be.prototype=Mo,e};function Be(){}function Ue(){}function v(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=Mo}function g(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Wo,this.__views__=[]}function Fe(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ke(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Me(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ze(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Me;++t<r;)this.add(e[t])}function S(e){e=this.__data__=new Ke(e);this.size=e.size}function qe(e,t){var r,n=D(e),i=!n&&gi(e),o=!n&&!i&&bi(e),a=!n&&!i&&!o&&ji(e),l=n||i||o||a,u=l?Hl(e.length,z):[],s=u.length;for(r in e)!t&&!b.call(e,r)||l&&("length"==r||o&&("offset"==r||"parent"==r)||a&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||nn(r,s))||u.push(r);return u}function Ve(e){var t=e.length;return t?e[Ut(0,t-1)]:Mo}function We(e,t){return bn(w(e),et(t,0,e.length))}function Ge(e){return bn(w(e))}function He(e,t,r){(r===Mo||p(e[t],r))&&(r!==Mo||t in e)||Qe(e,t,r)}function Je(e,t,r){var n=e[t];b.call(e,t)&&p(n,r)&&(r!==Mo||t in e)||Qe(e,t,r)}function $e(e,t){for(var r=e.length;r--;)if(p(e[r][0],t))return r;return-1}function Ye(e,n,i,o){return it(e,function(e,t,r){n(o,e,i(e),r)}),o}function Xe(e,t){return e&&vr(t,R(t),e)}function Qe(e,t,r){"__proto__"==t&&se?se(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function Ze(e,t){for(var r=-1,n=t.length,i=E(n),o=null==e;++r<n;)i[r]=o?Mo:Vi(e,t[r]);return i}function et(e,t,r){return e==e&&(r!==Mo&&(e=e<=r?e:r),t!==Mo&&(e=t<=e?e:t)),e}function T(r,n,i,e,t,o){var a,l=1&n,u=2&n,s=4&n;if((a=i?t?i(r,e,t,o):i(r):a)!==Mo)return a;if(!x(r))return r;var c,d,f,e=D(r);if(e){if(p=(h=r).length,f=new h.constructor(p),p&&"string"==typeof h[0]&&b.call(h,"index")&&(f.index=h.index,f.input=h.input),a=f,!l)return w(r,a)}else{var p=A(r),h=p==Ta||p==wa;if(bi(r))return sr(r,l);if(p==Xo||p==Go||h&&!t){if(a=u||h?{}:tn(r),!l)return u?(d=f=r,d=(c=a)&&vr(d,P(d),c),vr(f,Zr(f),d)):(d=Xe(a,c=r),vr(c,Qr(c),d))}else{if(!ia[p])return t?r:{};a=function(e,t,r){var n=e.constructor;switch(t){case Ia:return cr(e);case Ho:case Jo:return new n(+e);case ra:return function(e,t){t=t?cr(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}(e,r);case xa:case ja:case Na:case ka:case Ca:case Ra:case Pa:case La:case Ba:return dr(e,r);case $o:return new n;case Yo:case ea:return new n(e);case Qo:return function(e){var t=new e.constructor(e.source,ll.exec(e));return t.lastIndex=e.lastIndex,t}(e);case Zo:return new n;case Da:return function(e){return Re?y(Re.call(e)):{}}(e)}}(r,p,l)}}t=(o=o||new S).get(r);if(t)return t;o.set(r,a),Ii(r)?r.forEach(function(e){a.add(T(e,n,i,e,r,o))}):Ti(r)&&r.forEach(function(e,t){a.set(t,T(e,n,i,t,r,o))});var v=e?Mo:(s?u?Wr:Vr:u?P:R)(r);return la(v||r,function(e,t){v&&(e=r[t=e]),Je(a,t,T(e,n,i,t,r,o))}),a}function tt(e,t,r){var n=r.length;if(null==e)return!n;for(e=y(e);n--;){var i=r[n],o=t[i],a=e[i];if(a===Mo&&!(i in e)||!o(a))return!1}return!0}function rt(e,t,r){if("function"!=typeof e)throw new m(zo);return vn(function(){e.apply(Mo,r)},t)}function nt(e,t,r,n){var i=-1,o=Rl,a=!0,l=e.length,u=[],s=t.length;if(!l)return u;r&&(t=sa(t,fa(r))),n?(o=Pl,a=!1):200<=t.length&&(o=Yl,a=!1,t=new ze(t));e:for(;++i<l;){var c=e[i],d=null==r?c:r(c),c=n||0!==c?c:0;if(a&&d==d){for(var f=s;f--;)if(t[f]===d)continue e;u.push(c)}else o(t,d,n)||u.push(c)}return u}h.templateSettings={escape:Wa,evaluate:Ga,interpolate:Ha,variable:"",imports:{_:h}},(h.prototype=Ue.prototype).constructor=h,(v.prototype=Le(Ue.prototype)).constructor=v,(g.prototype=Le(Ue.prototype)).constructor=g,Fe.prototype.clear=function(){this.__data__=Ae?Ae(null):{},this.size=0},Fe.prototype.delete=function(e){return e=this.has(e)&&delete this.__data__[e],this.size-=e?1:0,e},Fe.prototype.get=function(e){var t,r=this.__data__;return Ae?(t=r[e])===ma?Mo:t:b.call(r,e)?r[e]:Mo},Fe.prototype.has=function(e){var t=this.__data__;return Ae?t[e]!==Mo:b.call(t,e)},Fe.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Ae&&t===Mo?ma:t,this},Ke.prototype.clear=function(){this.__data__=[],this.size=0},Ke.prototype.delete=function(e){var t=this.__data__;return!((e=$e(t,e))<0)&&(e==t.length-1?t.pop():oe.call(t,e,1),--this.size,!0)},Ke.prototype.get=function(e){var t=this.__data__;return(e=$e(t,e))<0?Mo:t[e][1]},Ke.prototype.has=function(e){return-1<$e(this.__data__,e)},Ke.prototype.set=function(e,t){var r=this.__data__,n=$e(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},Me.prototype.clear=function(){this.size=0,this.__data__={hash:new Fe,map:new(Oe||Ke),string:new Fe}},Me.prototype.delete=function(e){return e=$r(this,e).delete(e),this.size-=e?1:0,e},Me.prototype.get=function(e){return $r(this,e).get(e)},Me.prototype.has=function(e){return $r(this,e).has(e)},Me.prototype.set=function(e,t){var r=$r(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},ze.prototype.add=ze.prototype.push=function(e){return this.__data__.set(e,ma),this},ze.prototype.has=function(e){return this.__data__.has(e)},S.prototype.clear=function(){this.__data__=new Ke,this.size=0},S.prototype.delete=function(e){var t=this.__data__,e=t.delete(e);return this.size=t.size,e},S.prototype.get=function(e){return this.__data__.get(e)},S.prototype.has=function(e){return this.__data__.has(e)},S.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Ke){var n=r.__data__;if(!Oe||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Me(n)}return r.set(e,t),this.size=r.size,this};var it=mr(dt),ot=mr(ft,!0);function at(e,n){var i=!0;return it(e,function(e,t,r){return i=!!n(e,t,r)}),i}function lt(e,t,r){for(var n=-1,i=e.length;++n<i;){var o,a,l=e[n],u=t(l);null!=u&&(o===Mo?u==u&&!j(u):r(u,o))&&(o=u,a=l)}return a}function ut(e,n){var i=[];return it(e,function(e,t,r){n(e,t,r)&&i.push(e)}),i}function u(e,t,r,n,i){var o=-1,a=e.length;for(r=r||rn,i=i||[];++o<a;){var l=e[o];0<t&&r(l)?1<t?u(l,t-1,r,n,i):ca(i,l):n||(i[i.length]=l)}return i}var st=br(),ct=br(!0);function dt(e,t){return e&&st(e,t,R)}function ft(e,t){return e&&ct(e,t,R)}function pt(t,e){return ua(e,function(e){return Si(t[e])})}function ht(e,t){for(var r=0,n=(t=or(t,e)).length;null!=e&&r<n;)e=e[En(t[r++])];return r&&r==n?e:Mo}function vt(e,t,r){t=t(e);return D(e)?t:ca(t,r(e))}function r(e){{if(null==e)return e===Mo?"[object Undefined]":"[object Null]";if(ue&&ue in y(e)){var t=e,r=b.call(t,ue),n=t[ue];try{t[ue]=Mo;var i=!0}catch(e){}var o=Y.call(t);return i&&(r?t[ue]=n:delete t[ue]),o}return Y.call(e)}}function yt(e,t){return t<e}function gt(e,t){return null!=e&&b.call(e,t)}function mt(e,t){return null!=e&&t in y(e)}function bt(e,t,r){for(var n=r?Pl:Rl,i=e[0].length,o=e.length,a=o,l=E(o),u=1/0,s=[];a--;){var c=e[a];a&&t&&(c=sa(c,fa(t))),u=O(c.length,u),l[a]=!r&&(t||120<=i&&120<=c.length)?new ze(a&&c):Mo}var c=e[0],d=-1,f=l[0];e:for(;++d<i&&s.length<u;){var p=c[d],h=t?t(p):p,p=r||0!==p?p:0;if(!(f?Yl(f,h):n(s,h,r))){for(a=o;--a;){var v=l[a];if(!(v?Yl(v,h):n(e[a],h,r)))continue e}f&&f.push(h),s.push(p)}}return s}function _t(e,t,r){t=null==(e=fn(e,t=or(t,e)))?e:e[En(n(t))];return null==t?Mo:aa(t,e,r)}function St(e){return o(e)&&r(e)==Go}function Et(e,t,r,n,i){return e===t||(null==e||null==t||!o(e)&&!o(t)?e!=e&&t!=t:function(e,t,r,n,i,o){var a=D(e),l=D(t),u=a?Ea:A(e),l=l?Ea:A(t),s=(u=u==Go?Xo:u)==Xo,c=(l=l==Go?Xo:l)==Xo,l=u==l;if(l&&bi(e)){if(!bi(t))return!1;s=!(a=!0)}if(l&&!s)return o=o||new S,a||ji(e)?zr(e,t,r,n,i,o):function(e,t,r,n,i,o,a){switch(r){case ra:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ia:return!(e.byteLength!=t.byteLength||!o(new ee(e),new ee(t)));case Ho:case Jo:case Yo:return p(+e,+t);case Oa:return e.name==t.name&&e.message==t.message;case Qo:case ea:return e==t+"";case $o:var l=ru;case Zo:var u=1&n;if(l=l||iu,e.size!=t.size&&!u)return!1;u=a.get(e);if(u)return u==t;n|=2,a.set(e,t);u=zr(l(e),l(t),n,i,o,a);return a.delete(e),u;case Da:if(Re)return Re.call(e)==Re.call(t)}return!1}(e,t,u,r,n,i,o);if(!(1&r)){a=s&&b.call(e,"__wrapped__"),u=c&&b.call(t,"__wrapped__");if(a||u)return s=a?e.value():e,c=u?t.value():t,o=o||new S,i(s,c,r,n,o)}return l&&(o=o||new S,function(e,t,r,n,i,o){var a=1&r,l=Vr(e),u=l.length,s=Vr(t).length;if(u!=s&&!a)return!1;for(var c=u;c--;){var d=l[c];if(!(a?d in t:b.call(t,d)))return!1}var s=o.get(e),f=o.get(t);if(s&&f)return s==t&&f==e;var p=!0;o.set(e,t),o.set(t,e);for(var h=a;++c<u;){d=l[c];var v,y=e[d],g=t[d];if(!((v=n?a?n(g,y,d,t,e,o):n(y,g,d,e,t,o):v)===Mo?y===g||i(y,g,r,n,o):v)){p=!1;break}h=h||"constructor"==d}p&&!h&&(s=e.constructor,f=t.constructor,s!=f&&"constructor"in e&&"constructor"in t&&!("function"==typeof s&&s instanceof s&&"function"==typeof f&&f instanceof f)&&(p=!1));return o.delete(e),o.delete(t),p}(e,t,r,n,i,o))}(e,t,r,n,Et,i))}function Ot(e,t,r,n){var i=r.length,o=i,a=!n;if(null==e)return!o;for(e=y(e);i--;){var l=r[i];if(a&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++i<o;){var u=(l=r[i])[0],s=e[u],c=l[1];if(a&&l[2]){if(s===Mo&&!(u in e))return!1}else{var d,f=new S;if(!((d=n?n(s,c,u,e,t,f):d)===Mo?Et(c,s,3,n,f):d))return!1}}return!0}function Tt(e){return!(!x(e)||(t=e,$&&$ in t))&&(Si(e)?Z:cl).test(On(e));var t}function wt(e){return"function"==typeof e?e:null==e?L:"object"==typeof e?D(e)?Nt(e[0],e[1]):jt(e):Io(e)}function At(e){if(!un(e))return me(e);var t,r=[];for(t in y(e))b.call(e,t)&&"constructor"!=t&&r.push(t);return r}function Dt(e){if(x(e)){var t,r=un(e),n=[];for(t in e)("constructor"!=t||!r&&b.call(e,t))&&n.push(t);return n}var i=e,o=[];if(null!=i)for(var a in y(i))o.push(a);return o}function It(e,t){return e<t}function xt(e,n){var i=-1,o=c(e)?E(e.length):[];return it(e,function(e,t,r){o[++i]=n(e,t,r)}),o}function jt(t){var r=Yr(t);return 1==r.length&&r[0][2]?cn(r[0][0],r[0][1]):function(e){return e===t||Ot(e,t,r)}}function Nt(r,n){return on(r)&&sn(n)?cn(En(r),n):function(e){var t=Vi(e,r);return t===Mo&&t===n?Wi(e,r):Et(n,t,3)}}function kt(v,y,g,m,b){v!==y&&st(y,function(e,t){var r,n,i,o,a,l,u,s,c,d,f,p,h;b=b||new S,x(e)?(n=y,o=g,a=kt,l=m,u=b,f=pn(r=v,i=t),p=pn(n,i),(h=u.get(p))?He(r,i,h):(h=l?l(f,p,i+"",r,n,u):Mo,(n=h===Mo)&&(s=D(p),c=!s&&bi(p),d=!s&&!c&&ji(p),h=p,s||c||d?h=D(f)?f:I(f)?w(f):c?sr(p,!(n=!1)):d?dr(p,!(n=!1)):[]:Ai(p)||gi(p)?gi(h=f)?h=Li(f):x(f)&&!Si(f)||(h=tn(p)):n=!1),n&&(u.set(p,h),a(h,p,o,l,u),u.delete(p)),He(r,i,h))):(s=m?m(pn(v,t),e,t+"",v,y,b):Mo,He(v,t,s=s===Mo?e:s))},P)}function Ct(e,t){var r=e.length;if(r)return nn(t+=t<0?r:0,r)?e[t]:Mo}function Rt(e,n,c){n=n.length?sa(n,function(t){return D(t)?function(e){return ht(e,1===t.length?t[0]:t)}:t}):[L];var i=-1;n=sa(n,fa(d()));var t=xt(e,function(t,e,r){return{criteria:sa(n,function(e){return e(t)}),index:++i,value:t}}),e=function(e,t){for(var r=c,n=-1,i=e.criteria,o=t.criteria,a=i.length,l=r.length;++n<a;){var u=fr(i[n],o[n]);if(u){if(l<=n)return u;var s=r[n];return u*("desc"==s?-1:1)}}return e.index-t.index},r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}function Pt(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var a=t[n],l=ht(e,a);r(l,a)&&zt(o,or(a,e),l)}return o}function Lt(e,t,r,n){var i=n?Ml:da,o=-1,a=t.length,l=e;for(e===t&&(t=w(t)),r&&(l=sa(e,fa(r)));++o<a;)for(var u=0,s=t[o],c=r?r(s):s;-1<(u=i(l,c,u,n));)l!==e&&oe.call(l,u,1),oe.call(e,u,1);return e}function Bt(e,t){for(var r=e?t.length:0,n=r-1;r--;){var i,o=t[r];r!=n&&o===i||(nn(i=o)?oe.call(e,o,1):Xt(e,o))}}function Ut(e,t){return e+he(Se()*(t-e+1))}function Ft(e,t){var r="";if(!e||t<1||Vo<t)return r;for(;t%2&&(r+=e),(t=he(t/2))&&(e+=e),t;);return r}function a(e,t){return yn(dn(e,t,L),e+"")}function Kt(e){return Ve(ro(e))}function Mt(e,t){e=ro(e);return bn(e,et(t,0,e.length))}function zt(e,t,r,n){if(!x(e))return e;for(var i=-1,o=(t=or(t,e)).length,a=o-1,l=e;null!=l&&++i<o;){var u,s=En(t[i]),c=r;if("__proto__"===s||"constructor"===s||"prototype"===s)return e;i!=a&&(u=l[s],(c=n?n(u,s,l):Mo)===Mo&&(c=x(u)?u:nn(t[i+1])?[]:{})),Je(l,s,c),l=l[s]}return e}var qt=De?function(e,t){return De.set(e,t),e}:L,t=se?function(e,t){return se(e,"toString",{configurable:!0,enumerable:!1,value:go(t),writable:!0})}:L;function Vt(e){return bn(ro(e))}function l(e,t,r){var n=-1,i=e.length;(r=i<r?i:r)<0&&(r+=i),i=r<(t=t<0?i<-t?0:i+t:t)?0:r-t>>>0,t>>>=0;for(var o=E(i);++n<i;)o[n]=e[n+t];return o}function Wt(e,n){var i;return it(e,function(e,t,r){return!(i=n(e,t,r))}),!!i}function Gt(e,t,r){var n=0,i=null==e?n:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;n<i;){var o=n+i>>>1,a=e[o];null!==a&&!j(a)&&(r?a<=t:a<t)?n=1+o:i=o}return i}return Ht(e,t,L,r)}function Ht(e,t,r,n){var i=0,o=null==e?0:e.length;if(0===o)return 0;for(var a=(t=r(t))!=t,l=null===t,u=j(t),s=t===Mo;i<o;){var c=he((i+o)/2),d=r(e[c]),f=d!==Mo,p=null===d,h=d==d,v=j(d),h=a?n||h:s?h&&(n||f):l?h&&f&&(n||!p):u?h&&f&&!p&&(n||!v):!p&&!v&&(n?d<=t:d<t);h?i=c+1:o=c}return O(o,4294967294)}function Jt(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var a,l=e[r],u=t?t(l):l;r&&p(u,a)||(a=u,o[i++]=0===l?0:l)}return o}function $t(e){return"number"==typeof e?e:j(e)?_a:+e}function s(e){if("string"==typeof e)return e;if(D(e))return sa(e,s)+"";if(j(e))return Pe?Pe.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Yt(e,t,r){var n=-1,i=Rl,o=e.length,a=!0,l=[],u=l;if(r)a=!1,i=Pl;else if(200<=o){var s=t?null:Lr(e);if(s)return iu(s);a=!1,i=Yl,u=new ze}else u=t?[]:l;e:for(;++n<o;){var c=e[n],d=t?t(c):c,c=r||0!==c?c:0;if(a&&d==d){for(var f=u.length;f--;)if(u[f]===d)continue e;t&&u.push(d),l.push(c)}else i(u,d,r)||(u!==l&&u.push(d),l.push(c))}return l}function Xt(e,t){return null==(e=fn(e,t=or(t,e)))||delete e[En(n(t))]}function Qt(e,t,r,n){return zt(e,t,r(ht(e,t)),n)}function Zt(e,t,r,n){for(var i=e.length,o=n?i:-1;(n?o--:++o<i)&&t(e[o],o,e););return r?l(e,n?0:o,n?o+1:i):l(e,n?o+1:0,n?i:o)}function er(e,t){var r=e;return Ll(t,function(e,t){return t.func.apply(t.thisArg,ca([e],t.args))},r=e instanceof g?e.value():r)}function tr(e,t,r){var n=e.length;if(n<2)return n?Yt(e[0]):[];for(var i=-1,o=E(n);++i<n;)for(var a=e[i],l=-1;++l<n;)l!=i&&(o[i]=nt(o[i]||a,e[l],t,r));return Yt(u(o,1),t,r)}function rr(e,t,r){for(var n=-1,i=e.length,o=t.length,a={};++n<i;){var l=n<o?t[n]:Mo;r(a,e[n],l)}return a}function nr(e){return I(e)?e:[]}function ir(e){return"function"==typeof e?e:L}function or(e,t){return D(e)?e:on(e,t)?[e]:Sn(C(e))}var ar=a;function lr(e,t,r){var n=e.length;return r=r===Mo?n:r,!t&&n<=r?e:l(e,t,r)}var ur=ce||function(e){return oa.clearTimeout(e)};function sr(e,t){if(t)return e.slice();t=e.length,t=te?te(t):new e.constructor(t);return e.copy(t),t}function cr(e){var t=new e.constructor(e.byteLength);return new ee(t).set(new ee(e)),t}function dr(e,t){t=t?cr(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}function fr(e,t){if(e!==t){var r=e!==Mo,n=null===e,i=e==e,o=j(e),a=t!==Mo,l=null===t,u=t==t,s=j(t);if(!l&&!s&&!o&&t<e||o&&a&&u&&!l&&!s||n&&a&&u||!r&&u||!i)return 1;if(!n&&!o&&!s&&e<t||s&&r&&i&&!n&&!o||l&&r&&i||!a&&i||!u)return-1}return 0}function pr(e,t,r,n){for(var i=-1,o=e.length,a=r.length,l=-1,u=t.length,s=_(o-a,0),c=E(u+s),d=!n;++l<u;)c[l]=t[l];for(;++i<a;)(d||i<o)&&(c[r[i]]=e[i]);for(;s--;)c[l++]=e[i++];return c}function hr(e,t,r,n){for(var i=-1,o=e.length,a=-1,l=r.length,u=-1,s=t.length,c=_(o-l,0),d=E(c+s),f=!n;++i<c;)d[i]=e[i];for(var p=i;++u<s;)d[p+u]=t[u];for(;++a<l;)(f||i<o)&&(d[p+r[a]]=e[i++]);return d}function w(e,t){var r=-1,n=e.length;for(t=t||E(n);++r<n;)t[r]=e[r];return t}function vr(e,t,r,n){var i=!r;r=r||{};for(var o=-1,a=t.length;++o<a;){var l=t[o],u=n?n(r[l],e[l],l,r,e):Mo;(i?Qe:Je)(r,l,u=u===Mo?e[l]:u)}return r}function yr(i,o){return function(e,t){var r=D(e)?Nl:Ye,n=o?o():{};return r(e,i,d(t,2),n)}}function gr(l){return a(function(e,t){var r=-1,n=t.length,i=1<n?t[n-1]:Mo,o=2<n?t[2]:Mo,i=3<l.length&&"function"==typeof i?(n--,i):Mo;for(o&&f(t[0],t[1],o)&&(i=n<3?Mo:i,n=1),e=y(e);++r<n;){var a=t[r];a&&l(e,a,r,i)}return e})}function mr(o,a){return function(e,t){if(null==e)return e;if(!c(e))return o(e,t);for(var r=e.length,n=a?r:-1,i=y(e);(a?n--:++n<r)&&!1!==t(i[n],n,i););return e}}function br(u){return function(e,t,r){for(var n=-1,i=y(e),o=r(e),a=o.length;a--;){var l=o[u?a:++n];if(!1===t(i[l],l,i))break}return e}}function _r(n){return function(e){var t=pa(e=C(e))?ya(e):Mo,r=t?t[0]:e.charAt(0),t=t?lr(t,1).join(""):e.slice(1);return r[n]()+t}}function Sr(t){return function(e){return Ll(ho(oo(e).replace(yl,"")),t,"")}}function Er(n){return function(){var e=arguments;switch(e.length){case 0:return new n;case 1:return new n(e[0]);case 2:return new n(e[0],e[1]);case 3:return new n(e[0],e[1],e[2]);case 4:return new n(e[0],e[1],e[2],e[3]);case 5:return new n(e[0],e[1],e[2],e[3],e[4]);case 6:return new n(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new n(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var t=Le(n.prototype),r=n.apply(t,e);return x(r)?r:t}}function Or(o,a,l){var u=Er(o);return function e(){for(var t=arguments.length,r=E(t),n=t,i=Jr(e);n--;)r[n]=arguments[n];i=t<3&&r[0]!==i&&r[t-1]!==i?[]:ha(r,i);return(t-=i.length)<l?Rr(o,a,Ar,e.placeholder,Mo,r,i,Mo,Mo,l-t):aa(this&&this!==oa&&this instanceof e?u:o,this,r)}}function Tr(o){return function(e,t,r){var n,i=y(e),t=(c(e)||(n=d(t,3),e=R(e),t=function(e){return n(i[e],e,i)}),o(e,t,r));return-1<t?i[n?e[t]:t]:Mo}}function wr(u){return qr(function(i){var o=i.length,e=o,t=v.prototype.thru;for(u&&i.reverse();e--;){var r=i[e];if("function"!=typeof r)throw new m(zo);t&&!l&&"wrapper"==Hr(r)&&(l=new v([],!0))}for(e=l?e:o;++e<o;)var n=Hr(r=i[e]),a="wrapper"==n?Gr(r):Mo,l=a&&an(a[0])&&424==a[1]&&!a[4].length&&1==a[9]?l[Hr(a[0])].apply(l,a[3]):1==r.length&&an(r)?l[n]():l.thru(r);return function(){var e=arguments,t=e[0];if(l&&1==e.length&&D(t))return l.plant(t).value();for(var r=0,n=o?i[r].apply(this,e):t;++r<o;)n=i[r].call(this,n);return n}})}function Ar(a,l,u,s,c,d,f,p,h,v){var y=l&qo,g=1&l,m=2&l,b=24&l,_=512&l,S=m?Mo:Er(a);return function e(){for(var t=E(o=arguments.length),r=o;r--;)t[r]=arguments[r];if(b&&(i=function(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n}(t,n=Jr(e))),s&&(t=pr(t,s,c,b)),d&&(t=hr(t,d,f,b)),o-=i,b&&o<v)return i=ha(t,n),Rr(a,l,Ar,e.placeholder,u,t,i,p,h,v-o);var n=g?u:this,i=m?n[a]:a,o=t.length;return p?t=function(e,t){for(var r=e.length,n=O(t.length,r),i=w(e);n--;){var o=t[n];e[n]=nn(o,r)?i[o]:Mo}return e}(t,p):_&&1<o&&t.reverse(),y&&h<o&&(t.length=h),(i=this&&this!==oa&&this instanceof e?S||Er(i):i).apply(n,t)}}function Dr(r,a){return function(e,t){return e=e,n=r,i=a(t),o={},dt(e,function(e,t,r){n(o,i(e),t,r)}),o;var n,i,o}}function Ir(n,i){return function(e,t){var r;if(e===Mo&&t===Mo)return i;if(e!==Mo&&(r=e),t!==Mo){if(r===Mo)return t;t="string"==typeof e||"string"==typeof t?(e=s(e),s(t)):(e=$t(e),$t(t)),r=n(e,t)}return r}}function xr(n){return qr(function(e){return e=sa(e,fa(d())),a(function(t){var r=this;return n(e,function(e){return aa(e,r,t)})})})}function jr(e,t){var r=(t=t===Mo?" ":s(t)).length;if(r<2)return r?Ft(t,e):t;r=Ft(t,pe(e/va(t)));return pa(t)?lr(ya(r),0,e).join(""):r.slice(0,e)}function Nr(l,e,u,s){var c=1&e,d=Er(l);return function e(){for(var t=-1,r=arguments.length,n=-1,i=s.length,o=E(i+r),a=this&&this!==oa&&this instanceof e?d:l;++n<i;)o[n]=s[n];for(;r--;)o[n++]=arguments[++t];return aa(a,c?u:this,o)}}function kr(s){return function(e,t,r){r&&"number"!=typeof r&&f(e,t,r)&&(t=r=Mo),e=Ri(e),t===Mo?(t=e,e=0):t=Ri(t),r=r===Mo?e<t?1:-1:Ri(r);for(var n=e,i=r,o=s,a=-1,l=_(pe((t-n)/(i||1)),0),u=E(l);l--;)u[o?l:++a]=n,n+=i;return u}}function Cr(r){return function(e,t){return"string"==typeof e&&"string"==typeof t||(e=k(e),t=k(t)),r(e,t)}}function Rr(e,t,r,n,i,o,a,l,u,s){var c=8&t,i=(4&(t=(t|(c?32:64))&~(c?64:32))||(t&=-4),[e,t,i,c?o:Mo,c?a:Mo,c?Mo:o,c?Mo:a,l,u,s]),o=r.apply(Mo,i);return an(e)&&hn(o,i),o.placeholder=n,gn(o,e,t)}function Pr(e){var n=K[e];return function(e,t){var r;return e=k(e),(t=null==t?0:O(N(t),292))&&ye(e)?(r=(C(e)+"e").split("e"),+((r=(C(n(r[0]+"e"+(+r[1]+t)))+"e").split("e"))[0]+"e"+(+r[1]-t))):n(e)}}var Lr=we&&1/iu(new we([,-0]))[1]==1/0?function(e){return new we(e)}:To;function Br(o){return function(e){var t,r,n,i=A(e);return i==$o?ru(e):i==Zo?(i=e,r=-1,n=Array(i.size),i.forEach(function(e){n[++r]=[e,e]}),n):sa(o(t=e),function(e){return[e,t[e]]})}}function Ur(e,t,r,n,i,o,a,l){var u=2&t;if(!u&&"function"!=typeof e)throw new m(zo);var s,c,d,f,p,h=n?n.length:0,v=(h||(t&=-97,n=i=Mo),a=a===Mo?a:_(N(a),0),l=l===Mo?l:N(l),h-=i?i.length:0,64&t&&(y=n,s=i,n=i=Mo),u?Mo:Gr(e)),y=[e,t,r,n,i,y,s,o,a,l];return v&&function(e,t){var r=e[1],n=t[1],i=r|n,o=i<131,a=n==qo&&8==r||n==qo&&256==r&&e[7].length<=t[8]||384==n&&t[7].length<=t[8]&&8==r;if(!o&&!a)return;1&n&&(e[2]=t[2],i|=1&r?0:4);o=t[3];{var l;o&&(l=e[3],e[3]=l?pr(l,o,t[4]):o,e[4]=l?ha(e[3],ba):t[4])}(o=t[5])&&(l=e[5],e[5]=l?hr(l,o,t[6]):o,e[6]=l?ha(e[5],ba):t[6]),(o=t[7])&&(e[7]=o),n&qo&&(e[8]=null==e[8]?t[8]:O(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(y,v),e=y[0],t=y[1],r=y[2],n=y[3],i=y[4],!(l=y[9]=y[9]===Mo?u?0:e.length:_(y[9]-h,0))&&24&t&&(t&=-25),s=t&&1!=t?8==t||16==t?Or(e,t,l):32!=t&&33!=t||i.length?Ar.apply(Mo,y):Nr(e,t,r,n):(d=r,f=1&t,p=Er(c=e),function e(){return(this&&this!==oa&&this instanceof e?p:c).apply(f?d:this,arguments)}),gn((v?qt:hn)(s,y),e,t)}function Fr(e,t,r,n){return e===Mo||p(e,W[r])&&!b.call(n,r)?t:e}function Kr(e,t,r,n,i,o){return x(e)&&x(t)&&(o.set(t,e),kt(e,t,Mo,Kr,o),o.delete(t)),e}function Mr(e){return Ai(e)?Mo:e}function zr(e,t,r,n,i,o){var a=1&r,l=e.length,u=t.length;if(l!=u&&!(a&&l<u))return!1;var u=o.get(e),s=o.get(t);if(u&&s)return u==t&&s==e;var c=-1,d=!0,f=2&r?new ze:Mo;for(o.set(e,t),o.set(t,e);++c<l;){var p,h=e[c],v=t[c];if((p=n?a?n(v,h,c,t,e,o):n(h,v,c,e,t,o):p)!==Mo){if(p)continue;d=!1;break}if(f){if(!Ul(t,function(e,t){return!Yl(f,t)&&(h===e||i(h,e,r,n,o))&&f.push(t)})){d=!1;break}}else if(h!==v&&!i(h,v,r,n,o)){d=!1;break}}return o.delete(e),o.delete(t),d}function qr(e){return yn(dn(e,Mo,Dn),e+"")}function Vr(e){return vt(e,R,Qr)}function Wr(e){return vt(e,P,Zr)}var Gr=De?function(e){return De.get(e)}:To;function Hr(e){for(var t=e.name+"",r=Ie[t],n=b.call(Ie,t)?r.length:0;n--;){var i=r[n],o=i.func;if(null==o||o==e)return i.name}return t}function Jr(e){return(b.call(h,"placeholder")?h:e).placeholder}function d(){var e=(e=h.iteratee||_o)===_o?wt:e;return arguments.length?e(arguments[0],arguments[1]):e}function $r(e,t){var r,n,e=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?e["string"==typeof t?"string":"hash"]:e.map}function Yr(e){for(var t=R(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,sn(i)]}return t}function Xr(e,t){t=t;e=null==(e=e)?Mo:e[t];return Tt(e)?e:Mo}var Qr=ve?function(t){return null==t?[]:(t=y(t),ua(ve(t),function(e){return ie.call(t,e)}))}:No,Zr=ve?function(e){for(var t=[];e;)ca(t,Qr(e)),e=re(e);return t}:No,A=r;function en(e,t,r){for(var n=-1,i=(t=or(t,e)).length,o=!1;++n<i;){var a=En(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&Oi(i)&&nn(a,i)&&(D(e)||gi(e))}function tn(e){return"function"!=typeof e.constructor||un(e)?{}:Le(re(e))}function rn(e){return D(e)||gi(e)||!!(ae&&e&&e[ae])}function nn(e,t){var r=typeof e;return!!(t=null==t?Vo:t)&&("number"==r||"symbol"!=r&&fl.test(e))&&-1<e&&e%1==0&&e<t}function f(e,t,r){if(!x(r))return!1;var n=typeof t;return!!("number"==n?c(r)&&nn(t,r.length):"string"==n&&t in r)&&p(r[t],e)}function on(e,t){var r;if(!D(e))return r=typeof e,"number"==r||"symbol"==r||"boolean"==r||null==e||j(e)||($a.test(e)||!Ja.test(e)||null!=t&&e in y(t))}function an(e){var t=Hr(e),r=h[t];if("function"==typeof r&&t in g.prototype){if(e===r)return 1;t=Gr(r);return t&&e===t[0]}}(B&&A(new B(new ArrayBuffer(1)))!=ra||Oe&&A(new Oe)!=$o||Te&&A(Te.resolve())!=Aa||we&&A(new we)!=Zo||e&&A(new e)!=ta)&&(A=function(e){var t=r(e),e=t==Xo?e.constructor:Mo,e=e?On(e):"";if(e)switch(e){case xe:return ra;case je:return $o;case Ne:return Aa;case ke:return Zo;case Ce:return ta}return t});var ln=G?Si:ko;function un(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||W)}function sn(e){return e==e&&!x(e)}function cn(t,r){return function(e){return null!=e&&(e[t]===r&&(r!==Mo||t in y(e)))}}function dn(o,a,l){return a=_(a===Mo?o.length-1:a,0),function(){for(var e=arguments,t=-1,r=_(e.length-a,0),n=E(r);++t<r;)n[t]=e[a+t];for(var t=-1,i=E(a+1);++t<a;)i[t]=e[t];return i[a]=l(n),aa(o,this,i)}}function fn(e,t){return t.length<2?e:ht(e,l(t,0,-1))}function pn(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var hn=mn(qt),vn=fe||function(e,t){return oa.setTimeout(e,t)},yn=mn(t);function gn(e,t,r){var n,i,t=t+"";return yn(e,function(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(1<r?"& ":"")+t[n],t=t.join(2<r?", ":" "),e.replace(el,`{
/* [wrapped with `+t+`] */
`)}(t,(n=(e=(e=t).match(tl))?e[1].split(rl):[],i=r,la(Sa,function(e){var t="_."+e[0];i&e[1]&&!Rl(n,t)&&n.push(t)}),n.sort())))}function mn(r){var n=0,i=0;return function(){var e=be(),t=16-(e-i);if(i=e,0<t){if(800<=++n)return arguments[0]}else n=0;return r.apply(Mo,arguments)}}function bn(e,t){var r=-1,n=e.length,i=n-1;for(t=t===Mo?n:t;++r<t;){var o=Ut(r,i),a=e[o];e[o]=e[r],e[r]=a}return e.length=t,e}_n=(ce=ci(ce=function(e){var i=[];return 46===e.charCodeAt(0)&&i.push(""),e.replace(Ya,function(e,t,r,n){i.push(r?n.replace(ol,"$1"):t||e)}),i},function(e){return 500===_n.size&&_n.clear(),e})).cache;var _n,Sn=ce;function En(e){if("string"==typeof e||j(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function On(e){if(null!=e){try{return H.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Tn(e){if(e instanceof g)return e.clone();var t=new v(e.__wrapped__,e.__chain__);return t.__actions__=w(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}B=a(function(e,t){return I(e)?nt(e,u(t,1,I,!0)):[]}),Te=a(function(e,t){var r=n(t);return I(r)&&(r=Mo),I(e)?nt(e,u(t,1,I,!0),d(r,2)):[]}),e=a(function(e,t){var r=n(t);return I(r)&&(r=Mo),I(e)?nt(e,u(t,1,I,!0),Mo,r):[]});function wn(e,t,r){var n=null==e?0:e.length;if(!n)return-1;r=null==r?0:N(r);return r<0&&(r=_(n+r,0)),Kl(e,d(t,3),r)}function An(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=n-1;return r!==Mo&&(i=N(r),i=r<0?_(n+i,0):O(i,n-1)),Kl(e,d(t,3),i,!0)}function Dn(e){return(null==e?0:e.length)?u(e,1):[]}function In(e){return e&&e.length?e[0]:Mo}G=a(function(e){var t=sa(e,nr);return t.length&&t[0]===e[0]?bt(t):[]}),fe=a(function(e){var t=n(e),r=sa(e,nr);return t===n(r)?t=Mo:r.pop(),r.length&&r[0]===e[0]?bt(r,d(t,2)):[]}),t=a(function(e){var t=n(e),r=sa(e,nr);return(t="function"==typeof t?t:Mo)&&r.pop(),r.length&&r[0]===e[0]?bt(r,Mo,t):[]});function n(e){var t=null==e?0:e.length;return t?e[t-1]:Mo}ce=a(xn);function xn(e,t){return e&&e.length&&t&&t.length?Lt(e,t):e}var jn=qr(function(e,t){var r=null==e?0:e.length,n=Ze(e,t);return Bt(e,sa(t,function(e){return nn(e,r)?+e:e}).sort(fr)),n});function Nn(e){return null==e?e:Ee.call(e)}var kn=a(function(e){return Yt(u(e,1,I,!0))}),Cn=a(function(e){var t=n(e);return I(t)&&(t=Mo),Yt(u(e,1,I,!0),d(t,2))}),Rn=a(function(e){var t="function"==typeof(t=n(e))?t:Mo;return Yt(u(e,1,I,!0),Mo,t)});function Pn(t){if(!t||!t.length)return[];var r=0;return t=ua(t,function(e){return I(e)&&(r=_(e.length,r),1)}),Hl(r,function(e){return sa(t,Vl(e))})}function Ln(e,t){if(!e||!e.length)return[];e=Pn(e);return null==t?e:sa(e,function(e){return aa(t,Mo,e)})}var Bn=a(function(e,t){return I(e)?nt(e,t):[]}),Un=a(function(e){return tr(ua(e,I))}),Fn=a(function(e){var t=n(e);return I(t)&&(t=Mo),tr(ua(e,I),d(t,2))}),Kn=a(function(e){var t="function"==typeof(t=n(e))?t:Mo;return tr(ua(e,I),Mo,t)}),Mn=a(Pn);var zn=a(function(e){var t=e.length,t="function"==typeof(t=1<t?e[t-1]:Mo)?(e.pop(),t):Mo;return Ln(e,t)});function qn(e){e=h(e);return e.__chain__=!0,e}function Vn(e,t){return t(e)}var Wn=qr(function(t){function e(e){return Ze(e,t)}var r=t.length,n=r?t[0]:0,i=this.__wrapped__;return!(1<r||this.__actions__.length)&&i instanceof g&&nn(n)?((i=i.slice(n,+n+(r?1:0))).__actions__.push({func:Vn,args:[e],thisArg:Mo}),new v(i,this.__chain__).thru(function(e){return r&&!e.length&&e.push(Mo),e})):this.thru(e)});var Gn=yr(function(e,t,r){b.call(e,r)?++e[r]:Qe(e,r,1)});var Hn=Tr(wn),Jn=Tr(An);function $n(e,t){return(D(e)?la:it)(e,d(t,3))}function Yn(e,t){return(D(e)?kl:ot)(e,d(t,3))}var Xn=yr(function(e,t,r){b.call(e,r)?e[r].push(t):Qe(e,r,[t])});var Qn=a(function(e,t,r){var n=-1,i="function"==typeof t,o=c(e)?E(e.length):[];return it(e,function(e){o[++n]=i?aa(t,e,r):_t(e,t,r)}),o}),Zn=yr(function(e,t,r){Qe(e,r,t)});function ei(e,t){return(D(e)?sa:xt)(e,d(t,3))}var ti=yr(function(e,t,r){e[r?0:1].push(t)},function(){return[[],[]]});var ri=a(function(e,t){if(null==e)return[];var r=t.length;return 1<r&&f(e,t[0],t[1])?t=[]:2<r&&f(t[0],t[1],t[2])&&(t=[t[0]]),Rt(e,u(t,1),[])}),ni=de||function(){return oa.Date.now()};function ii(e,t,r){return t=r?Mo:t,t=e&&null==t?e.length:t,Ur(e,qo,Mo,Mo,Mo,Mo,t)}function oi(e,t){var r;if("function"!=typeof t)throw new m(zo);return e=N(e),function(){return 0<--e&&(r=t.apply(this,arguments)),e<=1&&(t=Mo),r}}var ai=a(function(e,t,r){var n,i=1;return r.length&&(n=ha(r,Jr(ai)),i|=32),Ur(e,i,t,r,n)}),li=a(function(e,t,r){var n,i=3;return r.length&&(n=ha(r,Jr(li)),i|=32),Ur(t,i,e,r,n)});function ui(n,r,e){var i,o,a,l,u,s,c=0,d=!1,f=!1,t=!0;if("function"!=typeof n)throw new m(zo);function p(e){var t=i,r=o;return i=o=Mo,c=e,l=n.apply(r,t)}function h(e){var t=e-s;return s===Mo||r<=t||t<0||f&&a<=e-c}function v(){var e,t=ni();if(h(t))return y(t);u=vn(v,(e=r-((t=t)-s),f?O(e,a-(t-c)):e))}function y(e){return u=Mo,t&&i?p(e):(i=o=Mo,l)}function g(){var e=ni(),t=h(e);if(i=arguments,o=this,s=e,t){if(u===Mo)return c=e=s,u=vn(v,r),d?p(e):l;if(f)return ur(u),u=vn(v,r),p(s)}return u===Mo&&(u=vn(v,r)),l}return r=k(r)||0,x(e)&&(d=!!e.leading,f="maxWait"in e,a=f?_(k(e.maxWait)||0,r):a,t="trailing"in e?!!e.trailing:t),g.cancel=function(){u!==Mo&&ur(u),c=0,i=s=o=u=Mo},g.flush=function(){return u===Mo?l:y(ni())},g}var de=a(function(e,t){return rt(e,1,t)}),si=a(function(e,t,r){return rt(e,k(t)||0,r)});function ci(n,i){if("function"!=typeof n||null!=i&&"function"!=typeof i)throw new m(zo);function o(){var e=arguments,t=i?i.apply(this,e):e[0],r=o.cache;return r.has(t)?r.get(t):(e=n.apply(this,e),o.cache=r.set(t,e)||r,e)}return o.cache=new(ci.Cache||Me),o}function di(t){if("function"!=typeof t)throw new m(zo);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}ci.Cache=Me;var ar=ar(function(n,i){var o=(i=1==i.length&&D(i[0])?sa(i[0],fa(d())):sa(u(i,1),fa(d()))).length;return a(function(e){for(var t=-1,r=O(e.length,o);++t<r;)e[t]=i[t].call(this,e[t]);return aa(n,this,e)})}),fi=a(function(e,t){var r=ha(t,Jr(fi));return Ur(e,32,Mo,t,r)}),pi=a(function(e,t){var r=ha(t,Jr(pi));return Ur(e,64,Mo,t,r)}),hi=qr(function(e,t){return Ur(e,256,Mo,Mo,Mo,t)});function p(e,t){return e===t||e!=e&&t!=t}var vi=Cr(yt),yi=Cr(function(e,t){return t<=e}),gi=St(function(){return arguments}())?St:function(e){return o(e)&&b.call(e,"callee")&&!ie.call(e,"callee")},D=E.isArray,mi=wl?fa(wl):function(e){return o(e)&&r(e)==Ia};function c(e){return null!=e&&Oi(e.length)&&!Si(e)}function I(e){return o(e)&&c(e)}var bi=V||ko,V=Al?fa(Al):function(e){return o(e)&&r(e)==Jo};function _i(e){if(!o(e))return!1;var t=r(e);return t==Oa||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!Ai(e)}function Si(e){if(!x(e))return!1;e=r(e);return e==Ta||e==wa||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Ei(e){return"number"==typeof e&&e==N(e)}function Oi(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=Vo}function x(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function o(e){return null!=e&&"object"==typeof e}var Ti=Dl?fa(Dl):function(e){return o(e)&&A(e)==$o};function wi(e){return"number"==typeof e||o(e)&&r(e)==Yo}function Ai(e){if(!o(e)||r(e)!=Xo)return!1;e=re(e);if(null===e)return!0;e=b.call(e,"constructor")&&e.constructor;return"function"==typeof e&&e instanceof e&&H.call(e)==X}var Di=Il?fa(Il):function(e){return o(e)&&r(e)==Qo};var Ii=xl?fa(xl):function(e){return o(e)&&A(e)==Zo};function xi(e){return"string"==typeof e||!D(e)&&o(e)&&r(e)==ea}function j(e){return"symbol"==typeof e||o(e)&&r(e)==Da}var ji=jl?fa(jl):function(e){return o(e)&&Oi(e.length)&&!!na[r(e)]};var Ni=Cr(It),ki=Cr(function(e,t){return e<=t});function Ci(e){if(!e)return[];if(c(e))return(xi(e)?ya:w)(e);var t;{if(le&&e[le]){for(var r,n=e[le](),i=[];!(r=n.next()).done;)i.push(r.value);return i}return((t=A(e))==$o?ru:t==Zo?iu:ro)(e)}}function Ri(e){return e?(e=k(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function N(e){var e=Ri(e),t=e%1;return e==e?t?e-t:e:0}function Pi(e){return e?et(N(e),0,Wo):0}function k(e){if("number"==typeof e)return e;if(j(e))return _a;if("string"!=typeof(e=x(e)?x(t="function"==typeof e.valueOf?e.valueOf():e)?t+"":t:e))return 0===e?e:+e;e=Jl(e);var t=sl.test(e);return t||dl.test(e)?Ol(e.slice(2),t?2:8):ul.test(e)?_a:+e}function Li(e){return vr(e,P(e))}function C(e){return null==e?"":s(e)}var Bi=gr(function(e,t){if(un(t)||c(t))vr(t,R(t),e);else for(var r in t)b.call(t,r)&&Je(e,r,t[r])}),Ui=gr(function(e,t){vr(t,P(t),e)}),Fi=gr(function(e,t,r,n){vr(t,P(t),e,n)}),Ki=gr(function(e,t,r,n){vr(t,R(t),e,n)}),Mi=qr(Ze);var zi=a(function(e,t){e=y(e);var r=-1,n=t.length,i=2<n?t[2]:Mo;for(i&&f(t[0],t[1],i)&&(n=1);++r<n;)for(var o=t[r],a=P(o),l=-1,u=a.length;++l<u;){var s=a[l],c=e[s];(c===Mo||p(c,W[s])&&!b.call(e,s))&&(e[s]=o[s])}return e}),qi=a(function(e){return e.push(Mo,Kr),aa(Yi,Mo,e)});function Vi(e,t,r){e=null==e?Mo:ht(e,t);return e===Mo?r:e}function Wi(e,t){return null!=e&&en(e,t,mt)}var Gi=Dr(function(e,t,r){e[t=null!=t&&"function"!=typeof t.toString?Y.call(t):t]=r},go(L)),Hi=Dr(function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=Y.call(t)),b.call(e,t)?e[t].push(r):e[t]=[r]},d),Ji=a(_t);function R(e){return(c(e)?qe:At)(e)}function P(e){return c(e)?qe(e,!0):Dt(e)}var $i=gr(function(e,t,r){kt(e,t,r)}),Yi=gr(function(e,t,r,n){kt(e,t,r,n)}),Xi=qr(function(t,e){var r={};if(null==t)return r;var n=!1;e=sa(e,function(e){return e=or(e,t),n=n||1<e.length,e}),vr(t,Wr(t),r),n&&(r=T(r,7,Mr));for(var i=e.length;i--;)Xt(r,e[i]);return r});var Qi=qr(function(e,t){return null==e?{}:Pt(r=e,t,function(e,t){return Wi(r,t)});var r});function Zi(e,r){if(null==e)return{};var t=sa(Wr(e),function(e){return[e]});return r=d(r),Pt(e,t,function(e,t){return r(e,t[0])})}var eo=Br(R),to=Br(P);function ro(e){return null==e?[]:$l(e,R(e))}var no=Sr(function(e,t,r){return t=t.toLowerCase(),e+(r?io(t):t)});function io(e){return po(C(e).toLowerCase())}function oo(e){return(e=C(e))&&e.replace(pl,Zl).replace(gl,"")}var ao=Sr(function(e,t,r){return e+(r?"-":"")+t.toLowerCase()}),lo=Sr(function(e,t,r){return e+(r?" ":"")+t.toLowerCase()}),uo=_r("toLowerCase");var so=Sr(function(e,t,r){return e+(r?"_":"")+t.toLowerCase()});var co=Sr(function(e,t,r){return e+(r?" ":"")+po(t)});var fo=Sr(function(e,t,r){return e+(r?" ":"")+t.toUpperCase()}),po=_r("toUpperCase");function ho(e,t,r){return e=C(e),(t=r?Mo:t)===Mo?(r=e,bl.test(r)?e.match(ml)||[]:e.match(nl)||[]):e.match(t)||[]}var vo=a(function(e,t){try{return aa(e,Mo,t)}catch(e){return _i(e)?e:new U(e)}}),yo=qr(function(t,e){return la(e,function(e){e=En(e),Qe(t,e,ai(t[e],t))}),t});function go(e){return function(){return e}}var mo=wr(),bo=wr(!0);function L(e){return e}function _o(e){return wt("function"==typeof e?e:T(e,1))}var So=a(function(t,r){return function(e){return _t(e,t,r)}}),Eo=a(function(t,r){return function(e){return _t(t,e,r)}});function Oo(n,t,e){var r=R(t),i=pt(t,r),o=(null!=e||x(t)&&(i.length||!r.length)||(e=t,t=n,n=this,i=pt(t,R(t))),!(x(e)&&"chain"in e&&!e.chain)),a=Si(n);return la(i,function(e){var r=t[e];n[e]=r,a&&(n.prototype[e]=function(){var e,t=this.__chain__;return o||t?(((e=n(this.__wrapped__)).__actions__=w(this.__actions__)).push({func:r,args:arguments,thisArg:n}),e.__chain__=t,e):r.apply(n,ca([this.value()],arguments))})}),n}function To(){}var wo=xr(sa),Ao=xr(Cl),Do=xr(Ul);function Io(e){return on(e)?Vl(En(e)):(t=e,function(e){return ht(e,t)});var t}var xo=kr(),jo=kr(!0);function No(){return[]}function ko(){return!1}var Co=Ir(function(e,t){return e+t},0),Ro=Pr("ceil"),Po=Ir(function(e,t){return e/t},1),Lo=Pr("floor");var Bo,Uo=Ir(function(e,t){return e*t},1),Fo=Pr("round"),Ko=Ir(function(e,t){return e-t},0);return h.after=function(e,t){if("function"!=typeof t)throw new m(zo);return e=N(e),function(){if(--e<1)return t.apply(this,arguments)}},h.ary=ii,h.assign=Bi,h.assignIn=Ui,h.assignInWith=Fi,h.assignWith=Ki,h.at=Mi,h.before=oi,h.bind=ai,h.bindAll=yo,h.bindKey=li,h.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return D(e)?e:[e]},h.chain=qn,h.chunk=function(e,t,r){t=(r?f(e,t,r):t===Mo)?1:_(N(t),0);var n=null==e?0:e.length;if(!n||t<1)return[];for(var i=0,o=0,a=E(pe(n/t));i<n;)a[o++]=l(e,i,i+=t);return a},h.compact=function(e){for(var t=-1,r=null==e?0:e.length,n=0,i=[];++t<r;){var o=e[t];o&&(i[n++]=o)}return i},h.concat=function(){var e=arguments.length;if(!e)return[];for(var t=E(e-1),r=arguments[0],n=e;n--;)t[n-1]=arguments[n];return ca(D(r)?w(r):[r],u(t,1))},h.cond=function(n){var i=null==n?0:n.length,t=d();return n=i?sa(n,function(e){if("function"!=typeof e[1])throw new m(zo);return[t(e[0]),e[1]]}):[],a(function(e){for(var t=-1;++t<i;){var r=n[t];if(aa(r[0],this,e))return aa(r[1],this,e)}})},h.conforms=function(e){return t=T(e,1),r=R(t),function(e){return tt(e,t,r)};var t,r},h.constant=go,h.countBy=Gn,h.create=function(e,t){return e=Le(e),null==t?e:Xe(e,t)},h.curry=function e(t,r,n){t=Ur(t,8,Mo,Mo,Mo,Mo,Mo,r=n?Mo:r);return t.placeholder=e.placeholder,t},h.curryRight=function e(t,r,n){t=Ur(t,16,Mo,Mo,Mo,Mo,Mo,r=n?Mo:r);return t.placeholder=e.placeholder,t},h.debounce=ui,h.defaults=zi,h.defaultsDeep=qi,h.defer=de,h.delay=si,h.difference=B,h.differenceBy=Te,h.differenceWith=e,h.drop=function(e,t,r){var n=null==e?0:e.length;return n?l(e,(t=r||t===Mo?1:N(t))<0?0:t,n):[]},h.dropRight=function(e,t,r){var n=null==e?0:e.length;return n?l(e,0,(t=n-(t=r||t===Mo?1:N(t)))<0?0:t):[]},h.dropRightWhile=function(e,t){return e&&e.length?Zt(e,d(t,3),!0,!0):[]},h.dropWhile=function(e,t){return e&&e.length?Zt(e,d(t,3),!0):[]},h.fill=function(e,t,r,n){var i=null==e?0:e.length;if(i){r&&"number"!=typeof r&&f(e,t,r)&&(r=0,n=i);var o=e,a=t,l=r,u=n,i=o.length;for((l=N(l))<0&&(l=i<-l?0:i+l),(u=u===Mo||i<u?i:N(u))<0&&(u+=i),u=u<l?0:Pi(u);l<u;)o[l++]=a;return o}return[]},h.filter=function(e,t){return(D(e)?ua:ut)(e,d(t,3))},h.flatMap=function(e,t){return u(ei(e,t),1)},h.flatMapDeep=function(e,t){return u(ei(e,t),1/0)},h.flatMapDepth=function(e,t,r){return r=r===Mo?1:N(r),u(ei(e,t),r)},h.flatten=Dn,h.flattenDeep=function(e){return(null==e?0:e.length)?u(e,1/0):[]},h.flattenDepth=function(e,t){return(null==e?0:e.length)?u(e,t=t===Mo?1:N(t)):[]},h.flip=function(e){return Ur(e,512)},h.flow=mo,h.flowRight=bo,h.fromPairs=function(e){for(var t=-1,r=null==e?0:e.length,n={};++t<r;){var i=e[t];n[i[0]]=i[1]}return n},h.functions=function(e){return null==e?[]:pt(e,R(e))},h.functionsIn=function(e){return null==e?[]:pt(e,P(e))},h.groupBy=Xn,h.initial=function(e){return(null==e?0:e.length)?l(e,0,-1):[]},h.intersection=G,h.intersectionBy=fe,h.intersectionWith=t,h.invert=Gi,h.invertBy=Hi,h.invokeMap=Qn,h.iteratee=_o,h.keyBy=Zn,h.keys=R,h.keysIn=P,h.map=ei,h.mapKeys=function(e,n){var i={};return n=d(n,3),dt(e,function(e,t,r){Qe(i,n(e,t,r),e)}),i},h.mapValues=function(e,n){var i={};return n=d(n,3),dt(e,function(e,t,r){Qe(i,t,n(e,t,r))}),i},h.matches=function(e){return jt(T(e,1))},h.matchesProperty=function(e,t){return Nt(e,T(t,1))},h.memoize=ci,h.merge=$i,h.mergeWith=Yi,h.method=So,h.methodOf=Eo,h.mixin=Oo,h.negate=di,h.nthArg=function(t){return t=N(t),a(function(e){return Ct(e,t)})},h.omit=Xi,h.omitBy=function(e,t){return Zi(e,di(d(t)))},h.once=function(e){return oi(2,e)},h.orderBy=function(e,t,r,n){return null==e?[]:Rt(e,t=D(t)?t:null==t?[]:[t],r=D(r=n?Mo:r)?r:null==r?[]:[r])},h.over=wo,h.overArgs=ar,h.overEvery=Ao,h.overSome=Do,h.partial=fi,h.partialRight=pi,h.partition=ti,h.pick=Qi,h.pickBy=Zi,h.property=Io,h.propertyOf=function(t){return function(e){return null==t?Mo:ht(t,e)}},h.pull=ce,h.pullAll=xn,h.pullAllBy=function(e,t,r){return e&&e.length&&t&&t.length?Lt(e,t,d(r,2)):e},h.pullAllWith=function(e,t,r){return e&&e.length&&t&&t.length?Lt(e,t,Mo,r):e},h.pullAt=jn,h.range=xo,h.rangeRight=jo,h.rearg=hi,h.reject=function(e,t){return(D(e)?ua:ut)(e,di(d(t,3)))},h.remove=function(e,t){var r=[];if(!e||!e.length)return r;var n=-1,i=[],o=e.length;for(t=d(t,3);++n<o;){var a=e[n];t(a,n,e)&&(r.push(a),i.push(n))}return Bt(e,i),r},h.rest=function(e,t){if("function"!=typeof e)throw new m(zo);return a(e,t=t===Mo?t:N(t))},h.reverse=Nn,h.sampleSize=function(e,t,r){return t=(r?f(e,t,r):t===Mo)?1:N(t),(D(e)?We:Mt)(e,t)},h.set=function(e,t,r){return null==e?e:zt(e,t,r)},h.setWith=function(e,t,r,n){return n="function"==typeof n?n:Mo,null==e?e:zt(e,t,r,n)},h.shuffle=function(e){return(D(e)?Ge:Vt)(e)},h.slice=function(e,t,r){var n=null==e?0:e.length;return n?(r=r&&"number"!=typeof r&&f(e,t,r)?(t=0,n):(t=null==t?0:N(t),r===Mo?n:N(r)),l(e,t,r)):[]},h.sortBy=ri,h.sortedUniq=function(e){return e&&e.length?Jt(e):[]},h.sortedUniqBy=function(e,t){return e&&e.length?Jt(e,d(t,2)):[]},h.split=function(e,t,r){return r&&"number"!=typeof r&&f(e,t,r)&&(t=r=Mo),(r=r===Mo?Wo:r>>>0)?(e=C(e))&&("string"==typeof t||null!=t&&!Di(t))&&(!(t=s(t))&&pa(e))?lr(ya(e),0,r):e.split(t,r):[]},h.spread=function(r,n){if("function"!=typeof r)throw new m(zo);return n=null==n?0:_(N(n),0),a(function(e){var t=e[n],e=lr(e,0,n);return t&&ca(e,t),aa(r,this,e)})},h.tail=function(e){var t=null==e?0:e.length;return t?l(e,1,t):[]},h.take=function(e,t,r){return e&&e.length?l(e,0,(t=r||t===Mo?1:N(t))<0?0:t):[]},h.takeRight=function(e,t,r){var n=null==e?0:e.length;return n?l(e,(t=n-(t=r||t===Mo?1:N(t)))<0?0:t,n):[]},h.takeRightWhile=function(e,t){return e&&e.length?Zt(e,d(t,3),!1,!0):[]},h.takeWhile=function(e,t){return e&&e.length?Zt(e,d(t,3)):[]},h.tap=function(e,t){return t(e),e},h.throttle=function(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new m(zo);return x(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),ui(e,t,{leading:n,maxWait:t,trailing:i})},h.thru=Vn,h.toArray=Ci,h.toPairs=eo,h.toPairsIn=to,h.toPath=function(e){return D(e)?sa(e,En):j(e)?[e]:w(Sn(C(e)))},h.toPlainObject=Li,h.transform=function(e,n,i){var t,r=D(e),o=r||bi(e)||ji(e);return n=d(n,4),null==i&&(t=e&&e.constructor,i=o?r?new t:[]:x(e)&&Si(t)?Le(re(e)):{}),(o?la:dt)(e,function(e,t,r){return n(i,e,t,r)}),i},h.unary=function(e){return ii(e,1)},h.union=kn,h.unionBy=Cn,h.unionWith=Rn,h.uniq=function(e){return e&&e.length?Yt(e):[]},h.uniqBy=function(e,t){return e&&e.length?Yt(e,d(t,2)):[]},h.uniqWith=function(e,t){return t="function"==typeof t?t:Mo,e&&e.length?Yt(e,Mo,t):[]},h.unset=function(e,t){return null==e||Xt(e,t)},h.unzip=Pn,h.unzipWith=Ln,h.update=function(e,t,r){return null==e?e:Qt(e,t,ir(r))},h.updateWith=function(e,t,r,n){return n="function"==typeof n?n:Mo,null==e?e:Qt(e,t,ir(r),n)},h.values=ro,h.valuesIn=function(e){return null==e?[]:$l(e,P(e))},h.without=Bn,h.words=ho,h.wrap=function(e,t){return fi(ir(t),e)},h.xor=Un,h.xorBy=Fn,h.xorWith=Kn,h.zip=Mn,h.zipObject=function(e,t){return rr(e||[],t||[],Je)},h.zipObjectDeep=function(e,t){return rr(e||[],t||[],zt)},h.zipWith=zn,h.entries=eo,h.entriesIn=to,h.extend=Ui,h.extendWith=Fi,Oo(h,h),h.add=Co,h.attempt=vo,h.camelCase=no,h.capitalize=io,h.ceil=Ro,h.clamp=function(e,t,r){return r===Mo&&(r=t,t=Mo),r!==Mo&&(r=(r=k(r))==r?r:0),t!==Mo&&(t=(t=k(t))==t?t:0),et(k(e),t,r)},h.clone=function(e){return T(e,4)},h.cloneDeep=function(e){return T(e,5)},h.cloneDeepWith=function(e,t){return T(e,5,t="function"==typeof t?t:Mo)},h.cloneWith=function(e,t){return T(e,4,t="function"==typeof t?t:Mo)},h.conformsTo=function(e,t){return null==t||tt(e,t,R(t))},h.deburr=oo,h.defaultTo=function(e,t){return null==e||e!=e?t:e},h.divide=Po,h.endsWith=function(e,t,r){e=C(e),t=s(t);var n=e.length,n=r=r===Mo?n:et(N(r),0,n);return 0<=(r-=t.length)&&e.slice(r,n)==t},h.eq=p,h.escape=function(e){return(e=C(e))&&Va.test(e)?e.replace(za,eu):e},h.escapeRegExp=function(e){return(e=C(e))&&Qa.test(e)?e.replace(Xa,"\\$&"):e},h.every=function(e,t,r){return(D(e)?Cl:at)(e,d(t=r&&f(e,t,r)?Mo:t,3))},h.find=Hn,h.findIndex=wn,h.findKey=function(e,t){return Fl(e,d(t,3),dt)},h.findLast=Jn,h.findLastIndex=An,h.findLastKey=function(e,t){return Fl(e,d(t,3),ft)},h.floor=Lo,h.forEach=$n,h.forEachRight=Yn,h.forIn=function(e,t){return null==e?e:st(e,d(t,3),P)},h.forInRight=function(e,t){return null==e?e:ct(e,d(t,3),P)},h.forOwn=function(e,t){return e&&dt(e,d(t,3))},h.forOwnRight=function(e,t){return e&&ft(e,d(t,3))},h.get=Vi,h.gt=vi,h.gte=yi,h.has=function(e,t){return null!=e&&en(e,t,gt)},h.hasIn=Wi,h.head=In,h.identity=L,h.includes=function(e,t,r,n){return e=c(e)?e:ro(e),r=r&&!n?N(r):0,n=e.length,r<0&&(r=_(n+r,0)),xi(e)?r<=n&&-1<e.indexOf(t,r):!!n&&-1<da(e,t,r)},h.indexOf=function(e,t,r){var n=null==e?0:e.length;return n?(r=null==r?0:N(r),da(e,t,r=r<0?_(n+r,0):r)):-1},h.inRange=function(e,t,r){return t=Ri(t),r===Mo?(r=t,t=0):r=Ri(r),(e=e=k(e))>=O(t=t,r=r)&&e<_(t,r)},h.invoke=Ji,h.isArguments=gi,h.isArray=D,h.isArrayBuffer=mi,h.isArrayLike=c,h.isArrayLikeObject=I,h.isBoolean=function(e){return!0===e||!1===e||o(e)&&r(e)==Ho},h.isBuffer=bi,h.isDate=V,h.isElement=function(e){return o(e)&&1===e.nodeType&&!Ai(e)},h.isEmpty=function(e){if(null==e)return!0;if(c(e)&&(D(e)||"string"==typeof e||"function"==typeof e.splice||bi(e)||ji(e)||gi(e)))return!e.length;var t,r=A(e);if(r==$o||r==Zo)return!e.size;if(un(e))return!At(e).length;for(t in e)if(b.call(e,t))return!1;return!0},h.isEqual=function(e,t){return Et(e,t)},h.isEqualWith=function(e,t,r){var n=(r="function"==typeof r?r:Mo)?r(e,t):Mo;return n===Mo?Et(e,t,Mo,r):!!n},h.isError=_i,h.isFinite=function(e){return"number"==typeof e&&ye(e)},h.isFunction=Si,h.isInteger=Ei,h.isLength=Oi,h.isMap=Ti,h.isMatch=function(e,t){return e===t||Ot(e,t,Yr(t))},h.isMatchWith=function(e,t,r){return r="function"==typeof r?r:Mo,Ot(e,t,Yr(t),r)},h.isNaN=function(e){return wi(e)&&e!=+e},h.isNative=function(e){if(ln(e))throw new U("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Tt(e)},h.isNil=function(e){return null==e},h.isNull=function(e){return null===e},h.isNumber=wi,h.isObject=x,h.isObjectLike=o,h.isPlainObject=Ai,h.isRegExp=Di,h.isSafeInteger=function(e){return Ei(e)&&-Vo<=e&&e<=Vo},h.isSet=Ii,h.isString=xi,h.isSymbol=j,h.isTypedArray=ji,h.isUndefined=function(e){return e===Mo},h.isWeakMap=function(e){return o(e)&&A(e)==ta},h.isWeakSet=function(e){return o(e)&&"[object WeakSet]"==r(e)},h.join=function(e,t){return null==e?"":ge.call(e,t)},h.kebabCase=ao,h.last=n,h.lastIndexOf=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=n;if(r!==Mo&&(i=(i=N(r))<0?_(n+i,0):O(i,n-1)),t!=t)return Kl(e,zl,i,!0);for(var o=e,a=t,l=i+1;l--;)if(o[l]===a)return l;return l},h.lowerCase=lo,h.lowerFirst=uo,h.lt=Ni,h.lte=ki,h.max=function(e){return e&&e.length?lt(e,L,yt):Mo},h.maxBy=function(e,t){return e&&e.length?lt(e,d(t,2),yt):Mo},h.mean=function(e){return ql(e,L)},h.meanBy=function(e,t){return ql(e,d(t,2))},h.min=function(e){return e&&e.length?lt(e,L,It):Mo},h.minBy=function(e,t){return e&&e.length?lt(e,d(t,2),It):Mo},h.stubArray=No,h.stubFalse=ko,h.stubObject=function(){return{}},h.stubString=function(){return""},h.stubTrue=function(){return!0},h.multiply=Uo,h.nth=function(e,t){return e&&e.length?Ct(e,N(t)):Mo},h.noConflict=function(){return oa._===this&&(oa._=Q),this},h.noop=To,h.now=ni,h.pad=function(e,t,r){e=C(e);var n=(t=N(t))?va(e):0;return!t||t<=n?e:jr(he(t=(t-n)/2),r)+e+jr(pe(t),r)},h.padEnd=function(e,t,r){e=C(e);var n=(t=N(t))?va(e):0;return t&&n<t?e+jr(t-n,r):e},h.padStart=function(e,t,r){e=C(e);var n=(t=N(t))?va(e):0;return t&&n<t?jr(t-n,r)+e:e},h.parseInt=function(e,t,r){return t=r||null==t?0:t&&+t,_e(C(e).replace(Za,""),t||0)},h.random=function(e,t,r){var n;return r&&"boolean"!=typeof r&&f(e,t,r)&&(t=r=Mo),r===Mo&&("boolean"==typeof t?(r=t,t=Mo):"boolean"==typeof e&&(r=e,e=Mo)),e===Mo&&t===Mo?(e=0,t=1):(e=Ri(e),t===Mo?(t=e,e=0):t=Ri(t)),t<e&&(n=e,e=t,t=n),r||e%1||t%1?(n=Se(),O(e+n*(t-e+El("1e-"+((n+"").length-1))),t)):Ut(e,t)},h.reduce=function(e,t,r){var n=D(e)?Ll:Wl,i=arguments.length<3;return n(e,d(t,4),r,i,it)},h.reduceRight=function(e,t,r){var n=D(e)?Bl:Wl,i=arguments.length<3;return n(e,d(t,4),r,i,ot)},h.repeat=function(e,t,r){return t=(r?f(e,t,r):t===Mo)?1:N(t),Ft(C(e),t)},h.replace=function(){var e=arguments,t=C(e[0]);return e.length<3?t:t.replace(e[1],e[2])},h.result=function(e,t,r){var n=-1,i=(t=or(t,e)).length;for(i||(i=1,e=Mo);++n<i;){var o=null==e?Mo:e[En(t[n])];o===Mo&&(n=i,o=r),e=Si(o)?o.call(e):o}return e},h.round=Fo,h.runInContext=i,h.sample=function(e){return(D(e)?Ve:Kt)(e)},h.size=function(e){if(null==e)return 0;if(c(e))return xi(e)?va(e):e.length;var t=A(e);return t==$o||t==Zo?e.size:At(e).length},h.snakeCase=so,h.some=function(e,t,r){return(D(e)?Ul:Wt)(e,d(t=r&&f(e,t,r)?Mo:t,3))},h.sortedIndex=function(e,t){return Gt(e,t)},h.sortedIndexBy=function(e,t,r){return Ht(e,t,d(r,2))},h.sortedIndexOf=function(e,t){var r=null==e?0:e.length;if(r){var n=Gt(e,t);if(n<r&&p(e[n],t))return n}return-1},h.sortedLastIndex=function(e,t){return Gt(e,t,!0)},h.sortedLastIndexBy=function(e,t,r){return Ht(e,t,d(r,2),!0)},h.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var r=Gt(e,t,!0)-1;if(p(e[r],t))return r}return-1},h.startCase=co,h.startsWith=function(e,t,r){return e=C(e),r=null==r?0:et(N(r),0,e.length),t=s(t),e.slice(r,r+t.length)==t},h.subtract=Ko,h.sum=function(e){return e&&e.length?Gl(e,L):0},h.sumBy=function(e,t){return e&&e.length?Gl(e,d(t,2)):0},h.template=function(a,e,t){var l,u,r=h.templateSettings;t&&f(a,e,t)&&(e=Mo),a=C(a),e=Fi({},e,r,Fr);var n=R(t=Fi({},e.imports,r.imports,Fr)),i=$l(t,n),s=0,r=e.interpolate||hl,c="__p += '",t=M((e.escape||hl).source+"|"+r.source+"|"+(r===Ha?al:hl).source+"|"+(e.evaluate||hl).source+"|$","g"),o="//# sourceURL="+(b.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Sl+"]")+`
`;if(a.replace(t,function(e,t,r,n,i,o){return r=r||n,c+=a.slice(s,o).replace(vl,tu),t&&(l=!0,c+=`' +
__e(`+t+`) +
'`),i&&(u=!0,c+=`';
`+i+`;
__p += '`),r&&(c+=`' +
((__t = (`+r+`)) == null ? '' : __t) +
'`),s=o+e.length,e}),c+=`';
`,r=b.call(e,"variable")&&e.variable){if(il.test(r))throw new U("Invalid `variable` option passed into `_.template`")}else c=`with (obj) {
`+c+`
}
`;if(c=(u?c.replace(Ua,""):c).replace(Fa,"$1").replace(Ka,"$1;"),c="function("+(r||"obj")+`) {
`+(r?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(l?", __e = _.escape":"")+(u?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+c+`return __p
}`,(t=vo(function(){return F(n,o+"return "+c).apply(Mo,i)})).source=c,_i(t))throw t;return t},h.times=function(e,t){if((e=N(e))<1||Vo<e)return[];var r=Wo,n=O(e,Wo);for(t=d(t),e-=Wo,n=Hl(n,t);++r<e;)t(r);return n},h.toFinite=Ri,h.toInteger=N,h.toLength=Pi,h.toLower=function(e){return C(e).toLowerCase()},h.toNumber=k,h.toSafeInteger=function(e){return e?et(N(e),-Vo,Vo):0===e?e:0},h.toString=C,h.toUpper=function(e){return C(e).toUpperCase()},h.trim=function(e,t,r){return(e=C(e))&&(r||t===Mo)?Jl(e):e&&(t=s(t))?(r=ya(e),e=ya(t),lr(r,Xl(r,e),Ql(r,e)+1).join("")):e},h.trimEnd=function(e,t,r){return(e=C(e))&&(r||t===Mo)?e.slice(0,ou(e)+1):e&&(t=s(t))?lr(r=ya(e),0,Ql(r,ya(t))+1).join(""):e},h.trimStart=function(e,t,r){return(e=C(e))&&(r||t===Mo)?e.replace(Za,""):e&&(t=s(t))?lr(r=ya(e),Xl(r,ya(t))).join(""):e},h.truncate=function(e,t){var r,n=30,i="...",t=(x(t)&&(r="separator"in t?t.separator:r,n="length"in t?N(t.length):n,i="omission"in t?s(t.omission):i),(e=C(e)).length);if((t=pa(e)?(o=ya(e)).length:t)<=n)return e;if((t=n-va(i))<1)return i;var o,n=o?lr(o,0,t).join(""):e.slice(0,t);if(r===Mo)return n+i;if(o&&(t+=n.length-t),Di(r)){if(e.slice(t).search(r)){var a,l=n;for((r=r.global?r:M(r.source,C(ll.exec(r))+"g")).lastIndex=0;a=r.exec(l);)var u=a.index;n=n.slice(0,u===Mo?t:u)}}else e.indexOf(s(r),t)==t||-1<(o=n.lastIndexOf(r))&&(n=n.slice(0,o));return n+i},h.unescape=function(e){return(e=C(e))&&qa.test(e)?e.replace(Ma,au):e},h.uniqueId=function(e){var t=++J;return C(e)+t},h.upperCase=fo,h.upperFirst=po,h.each=$n,h.eachRight=Yn,h.first=In,Oo(h,(Bo={},dt(h,function(e,t){b.call(h.prototype,t)||(Bo[t]=e)}),Bo),{chain:!1}),h.VERSION="4.17.21",la(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){h[e].placeholder=h}),la(["drop","take"],function(r,n){g.prototype[r]=function(e){e=e===Mo?1:_(N(e),0);var t=this.__filtered__&&!n?new g(this):this.clone();return t.__filtered__?t.__takeCount__=O(e,t.__takeCount__):t.__views__.push({size:O(e,Wo),type:r+(t.__dir__<0?"Right":"")}),t},g.prototype[r+"Right"]=function(e){return this.reverse()[r](e).reverse()}}),la(["filter","map","takeWhile"],function(e,t){var r=t+1,n=1==r||3==r;g.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:d(e,3),type:r}),t.__filtered__=t.__filtered__||n,t}}),la(["head","last"],function(e,t){var r="take"+(t?"Right":"");g.prototype[e]=function(){return this[r](1).value()[0]}}),la(["initial","tail"],function(e,t){var r="drop"+(t?"":"Right");g.prototype[e]=function(){return this.__filtered__?new g(this):this[r](1)}}),g.prototype.compact=function(){return this.filter(L)},g.prototype.find=function(e){return this.filter(e).head()},g.prototype.findLast=function(e){return this.reverse().find(e)},g.prototype.invokeMap=a(function(t,r){return"function"==typeof t?new g(this):this.map(function(e){return _t(e,t,r)})}),g.prototype.reject=function(e){return this.filter(di(d(e)))},g.prototype.slice=function(e,t){e=N(e);var r=this;return r.__filtered__&&(0<e||t<0)?new g(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),r=t!==Mo?(t=N(t))<0?r.dropRight(-t):r.take(t-e):r)},g.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},g.prototype.toArray=function(){return this.take(Wo)},dt(g.prototype,function(s,e){var c=/^(?:filter|find|map|reject)|While$/.test(e),d=/^(?:head|last)$/.test(e),f=h[d?"take"+("last"==e?"Right":""):e],p=d||/^find/.test(e);f&&(h.prototype[e]=function(){function e(e){return e=f.apply(h,ca([e],n)),d&&l?e[0]:e}var t,r=this.__wrapped__,n=d?[1]:arguments,i=r instanceof g,o=n[0],a=i||D(r),l=(a&&c&&"function"==typeof o&&1!=o.length&&(i=a=!1),this.__chain__),o=!!this.__actions__.length,u=p&&!l,i=i&&!o;return!p&&a?(r=i?r:new g(this),(t=s.apply(r,n)).__actions__.push({func:Vn,args:[e],thisArg:Mo}),new v(t,l)):u&&i?s.apply(this,n):(t=this.thru(e),u?d?t.value()[0]:t.value():t)})}),la(["pop","push","shift","sort","splice","unshift"],function(e){var r=q[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);h.prototype[e]=function(){var e,t=arguments;return i&&!this.__chain__?(e=this.value(),r.apply(D(e)?e:[],t)):this[n](function(e){return r.apply(D(e)?e:[],t)})}}),dt(g.prototype,function(e,t){var r,n=h[t];n&&(r=n.name+"",b.call(Ie,r)||(Ie[r]=[]),Ie[r].push({name:t,func:n}))}),Ie[Ar(Mo,2).name]=[{name:"wrapper",func:Mo}],g.prototype.clone=function(){var e=new g(this.__wrapped__);return e.__actions__=w(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=w(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=w(this.__views__),e},g.prototype.reverse=function(){var e;return this.__filtered__?((e=new g(this)).__dir__=-1,e.__filtered__=!0):(e=this.clone()).__dir__*=-1,e},g.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,r=D(e),n=t<0,i=r?e.length:0,o=function(e,t,r){for(var n=-1,i=r.length;++n<i;){var o=r[n],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=O(t,e+a);break;case"takeRight":e=_(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,l=(o=o.end)-a,u=n?o:a-1,s=this.__iteratees__,c=s.length,d=0,f=O(l,this.__takeCount__);if(!r||!n&&i==l&&f==l)return er(e,this.__actions__);var p=[];e:for(;l--&&d<f;){for(var h=-1,v=e[u+=t];++h<c;){var y=s[h],g=y.iteratee,y=y.type,g=g(v);if(2==y)v=g;else if(!g){if(1==y)continue e;break e}}p[d++]=v}return p},h.prototype.at=Wn,h.prototype.chain=function(){return qn(this)},h.prototype.commit=function(){return new v(this.value(),this.__chain__)},h.prototype.next=function(){this.__values__===Mo&&(this.__values__=Ci(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?Mo:this.__values__[this.__index__++]}},h.prototype.plant=function(e){for(var t,r=this;r instanceof Ue;)var n=Tn(r),i=(n.__index__=0,n.__values__=Mo,t?i.__wrapped__=n:t=n,n),r=r.__wrapped__;return i.__wrapped__=e,t},h.prototype.reverse=function(){var e=this.__wrapped__;return e instanceof g?(e=e,(e=(e=this.__actions__.length?new g(this):e).reverse()).__actions__.push({func:Vn,args:[Nn],thisArg:Mo}),new v(e,this.__chain__)):this.thru(Nn)},h.prototype.toJSON=h.prototype.valueOf=h.prototype.value=function(){return er(this.__wrapped__,this.__actions__)},h.prototype.first=h.prototype.head,le&&(h.prototype[le]=function(){return this}),h}();i?((i.exports=ga)._=ga,n._=ga):oa._=ga}.call(Ce)}),aa=Object.defineProperty,la=Object.defineProperties,ua=Object.getOwnPropertyDescriptors,sa=Object.getOwnPropertySymbols,ca=Object.prototype.hasOwnProperty,da=Object.prototype.propertyIsEnumerable,fa=(e,t,r)=>t in e?aa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const pa=e=>((e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())}))(window,[e],function*({document:e,esakOfCurrentUser:i}){var t,o,a,l,r=(e=e||{}).name||{},u=0===parseInt(r.type)?"text/plain":r.type,s=e.deat,c=new Et(e.subtype);let d=null;try{let n;if(c.isOnServer){if(void 0===r.data)throw new P({name:"UNKNOW_ERROR",message:"name.data is undefined"});n=yield B.level2SDK.utilServices.base64ToUint8Array(r.data)}else{if(null===s||!s.url)throw"deat.url is missing";var f=yield B.level2SDK.documentServices.downloadDocumentFromS3({url:s.url}).then(B.responseCatcher).catch(B.errorCatcher);if(!f)throw"no response";n=c.isBinary?f.data:yield B.level2SDK.utilServices.base64ToUint8Array(f.data)}if(c.isEncrypted){var p=yield nt(e),h=null!=(o=null==(t=null==p?void 0:p.data)?void 0:t.edge)&&o.length?p.data.edge[0]:null;if(null===h)throw new P({name:"UNKNOW_ERROR",message:"Document -> documentToNote -> retrieveEdge -> edge is null"});const E=localStorage.getItem("user_vid"),O=h.besak&&""!==h.besak,T=h.eesak&&""!==h.eesak;let r;if(9999<h.type&&B.level2SDK.utilServices.uint8ArrayToBase64(h.bvid)!==E){const w=yield F(null==h?void 0:h.eid,{type:1053,xfname:"refid"}),A=(w||{})["data"],D=A["edge"],I=D.filter(e=>B.level2SDK.utilServices.uint8ArrayToBase64(e.evid)===E);r=0<I.length?I.shift():""}if(c.isEncrypted&&(O||T||r.eesak)){let e;var v,y,g=(h.bvid instanceof Uint8Array?B.level2SDK.utilServices.uint8ArrayToBase64(h.evid):h.evid)===localStorage.getItem("user_vid")?B.level2SDK.utilServices.uint8ArrayToBase64(h.bvid):h.bvid;e=r?r.eesak:i||(O?h.besak:h.eesak);let t;if(r){var m=(yield B.level2SDK.vertexServices.retrieveVertex({idList:U(null==r?void 0:r.bvid)}))["data"],b=null==(a=null==m?void 0:m.vertex)?void 0:a[0];t=B.level2SDK.utilServices.uint8ArrayToBase64(null==b?void 0:b.pk);try{n=yield B.level2SDK.commonServices.decryptData(e,t,n)}catch(e){L.default.error(e instanceof Error?e:new Error(String(e)))}}else n=(t=g?10001===h.type?localStorage.getItem("pk")||"":1e4===h.type?localStorage.getItem("pk")||"":localStorage.getItem("pk")||"":(v=(yield B.level2SDK.vertexServices.retrieveVertex({idList:U(null==h?void 0:h.bvid)}))["data"],y=null==(l=null==v?void 0:v.vertex)?void 0:l[0],B.level2SDK.utilServices.uint8ArrayToBase64(null==y?void 0:y.pk)),yield B.level2SDK.commonServices.decryptData(e,t,n))}}c.isGzip&&(n=Qe(n));var _=yield B.level2SDK.utilServices.uint8ArrayToBlob(n,u);if(/^text\//.test(_.type))d=yield new Response(_).text();else if("application/json"===_.type){var S=yield new Response(_).text();try{d=JSON.parse(S)}catch(e){d=S}}else d=_}catch(e){"string"==typeof e&&new P({name:"DOWNLOAD_FROM_S3_FAIL",message:"Document -> documentToNote -> "+e}),d=null}return d instanceof Blob&&(d=yield B.level2SDK.utilServices.blobToBase64(d)),s=((e,t)=>{for(var r in t=t||{})ca.call(t,r)&&fa(e,r,t[r]);if(sa)for(var r of sa(t))da.call(t,r)&&fa(e,r,t[r]);return e})({},e),f={name:{title:r.title,nonce:null==r?void 0:r.nonce,targetRoomName:null==r?void 0:r.targetRoomName,user:null==r?void 0:r.user,sesk:null==r?void 0:r.sesk,notification:null==r?void 0:r.notification,aesk:null==r?void 0:r.aesk,type:"text/plain"===u?"application/json":u,data:d,tags:r.tags||[]},created_at:1e3*e.ctime,modified_at:1e3*e.mtime,subtype:{isOnServer:c.isOnServer,isZipped:c.isGzip,isBinary:c.isBinary,isEncrypted:c.isEncrypted,isEditable:c.isEditable,applicationDataType:c.dataType,notification:c.notification,ringToneNotify:c.ringToneNotify,sendtoSelf:c.sendtoSelf,mediaType:c.mediaType,size:e.size}},la(s,ua(f))});var ha={getFCMToken({token:e}){return e},getAPPID({appName:e}){e=co.sha256().update(e).digest(),e=new Uint8Array(e).slice(0,16);return B.level2SDK.utilServices.uint8ArrayToBase64(e)},getFCMTokenSHA256Half({token:e}){e=co.sha256().update(e).digest(),e=new Uint8Array(e).slice(0,16);return B.level2SDK.utilServices.uint8ArrayToBase64(e)}},va=Object.defineProperty,ya=Object.getOwnPropertySymbols,ga=Object.prototype.hasOwnProperty,ma=Object.prototype.propertyIsEnumerable,ba=(e,t,r)=>t in e?va(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_a=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())}),Sa={base64ToBlob({data:e,type:t="application/pdf"}){if(e&&"string"==typeof e&&M(e))return e=B.level2SDK.utilServices.base64ToBlob(e,t),console.dir(e),URL.createObjectURL(e)},exists(e){for(var t of Object.values(e))if(""===t||void 0===t||null===t)return!1;return!0},log({value:e}){L.default.debug(e)},prepareDoc(e){return _a(this,arguments,function*({doc:e}){let t;if("string"!=typeof e){const r=(t=A.isObj(e.subtype)?e:yield pa({document:e}))["name"];if(null==r||!r.data||"string"!=typeof(null==r?void 0:r.data)||!M(null==r?void 0:r.data))return e;if("string"==typeof(null==r?void 0:r.data)&&(null==r||!r.data.match(/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$/g)))return t;e=B.level2SDK.utilServices.base64ToBlob(null==r?void 0:r.data,null==r?void 0:r.type),e=URL.createObjectURL(e);return r.data=e,t}})},prepareDocToPath(i){return _a(this,null,function*(){var e,t;let r,n;if(i&&"string"==typeof i&&!i.includes("."))return t=null!=(e=null==(e=null==(t=yield tt(i))?void 0:t.data)?void 0:e.document)&&e.length?null==(e=null==t?void 0:t.data)?void 0:e.document[0]:null,yield pa({document:t}).then(e=>{var t=B.level2SDK.utilServices.base64ToBlob(null==(t=null==e?void 0:e.name)?void 0:t.data,null==(t=null==e?void 0:e.name)?void 0:t.type);n=null==(e=null==e?void 0:e.name)?void 0:e.type,r=URL.createObjectURL(t)},e=>{"test"===B.env&&L.default.error(e instanceof Error?e:new Error(String(e)))}),n,{type:n,url:r}})},toaster({toastMessage:e}){q(""+e,{type:"error"})},getCountryCode({uid:e}){return e.split(" ")[0]},getPhoneNumber({uid:e}){return e.split(" ")[1]},getTempParams(){let e=localStorage.getItem("tempParams");return e="string"==typeof e?JSON.parse(e):{}},setTempParams({Object:r}){if(r){let t=localStorage.getItem("tempParams");t="string"==typeof t?JSON.parse(t):{};var n=r.keys(r);for(let e=0;e<n.length;e++)t[n[e]]=r[n[e]];localStorage.setItem("tempParams",JSON.stringify(t))}},setTimer({timeUnix:e}){for(var t=(new Date).getTime();(new Date).getTime()-t<e;);},removeTempParams(){localStorage.removeItem("tempParams")},removeKeyTempParams({key:e}){let t=localStorage.getItem("tempParams");delete(t="string"==typeof t?JSON.parse(t):{})[e],localStorage.setItem("tempParams",JSON.stringify(t))},getFileSize({object:e,units:t="kb"}){var r=parseFloat(e.size);if(r&&t)switch(t){case"kb":return(r/1024).toFixed(1);case"mb":return(r/1048576).toFixed(1)}return 0},getFileName({object:e}){return e.name},copyToClip({object:e}){L.default.debug("copy to clipboard!! "+e);var e=""+e,t=document.createElement("textarea");return document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy"),document.body.removeChild(t),1},setLocalStorage({key:e,value:t}){A.isBrowser()&&window.localStorage.setItem(e,t)},getLocalStorage({key:e}){return window.localStorage.getItem(e)},cloneDeepData({data:e}){return oa.cloneDeep(e)},getUrl(){return A.isBrowser()?window.location.href:""},usernameCheck({username:e}){return/^[a-zA-Z_][a-zA-Z0-9_]{6,16}$/.test(e)},judgeAll({value:e,index:t}){return e.some(e=>{if(e===t)return!0})},areTheyIdentical({data:e,comData:t}){return JSON.stringify(e)===JSON.stringify(t)},isImageFile({file:e}){return!(!e||!e.startsWith("image"))},addArrayValue({array:t}){let r=0;for(let e=0;e<t.length;e++)r+=t[e];return r},AWSOCR({}){return{DATE_OF_BIRTH:"",FIRST_NAME:"",LAST_NAME:"",MIDDLE_NAME:"",CITY_IN_ADDRESS:"",COUNTY:"",ADDRESS:"",ADDRESS_SECOND_LINE:"",STATE_IN_ADDRESS:"",ZIP_CODE_IN_ADDRESS:"",DOCUMENT_NUMBER:"",ID_TYPE:""}},gethashCode({hashFields:e,hashtime:t=Date.now()}){return ha.getAPPID({appName:[...e,t].join(",")})},setEmpty({variable:e,identifier:t}){return"object"===t?e.map(e=>new Object):"array"===t?e.map(e=>new Array):void 0}};function q(e,t){var r;if(e){var n=document.getElementsByClassName("toast-container")[0];if(null!=(r=null==n?void 0:n.childNodes)&&r.length)for(const i of n.children)i.remove();null!=(r=C.createToast)&&r(String(e),((e,t)=>{for(var r in t=t||{})ga.call(t,r)&&ba(e,r,t[r]);if(ya)for(var r of ya(t))ma.call(t,r)&&ba(e,r,t[r]);return e})({cancel:"Close",timeout:8e3},t))}}var Ea=Object.defineProperty,Oa=Object.defineProperties,Ta=Object.getOwnPropertyDescriptors,wa=Object.getOwnPropertySymbols,Aa=Object.prototype.hasOwnProperty,Da=Object.prototype.propertyIsEnumerable,Ia=(e,t,r)=>t in e?Ea(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,xa=(e,t)=>{for(var r in t=t||{})Aa.call(t,r)&&Ia(e,r,t[r]);if(wa)for(var r of wa(t))Da.call(t,r)&&Ia(e,r,t[r]);return e},ja=(e,t)=>Oa(e,Ta(t)),Na=(e,t)=>{var r={};for(n in e)Aa.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&wa)for(var n of wa(e))t.indexOf(n)<0&&Da.call(e,n)&&(r[n]=e[n]);return r},ka=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});function Ca({apiObject:b,pageName:_,dispatch:S}){return function(){return ka(this,null,function*(){let e={},t=K(b||{}),{dataKey:r,dataIn:n,dataOut:i}=t,o=Na(t,["api","dataKey","dataIn","dataOut"]),a=[],l=xa({},o),u=null==o?void 0:o.maxcount,s=null==o?void 0:o.type,c=null==o?void 0:o.sCondition,d=null,f=yield S({type:z.GET_DATA,payload:{pageName:_,dataKey:n||r}});if(n){var p=yield S({type:z.POPULATE_OBJECT,payload:{object:f,pageName:_,copy:!0}}),{id:h,_nonce:v}=p,p=Na(p,["deat","id","_nonce"]);if(!M(h))return L.default.error(new Se(`Missing reference ${h} at page `+_));a=U(h),d=v,l=xa(xa({},l),p),u=null==p?void 0:p.maxcount,s=null==p?void 0:p.type,c=null==p?void 0:p.sCondition}else o.id&&(a=U(o.id));var y,h=yield S({type:z.POPULATE_OBJECT,payload:{object:l,pageName:_}}),v=h["_handledCode"],p=Na(h,["deat","id","_handledCode","_nonce"]),{pass:h,cacheIndex:p}=(u&&(l.maxcount=parseInt(u)),l=xa(xa({},l),p),c&&(l.scondition=c),s&&(l.type=parseInt(s)),yield S({type:z.SET_API_BUFFER,payload:{apiObject:{idList:a,options:l,nonce:d}}}));try{"test"===B.env&&L.default.info("%cGet Edge Request","background: purple; color: white; display: block;",{idList:a,options:l}),h?(y=yield F(a,l),yield S({type:z.SET_CACHE,payload:{data:(null==y?void 0:y.data)||null,cacheIndex:p}}),e=(null==y?void 0:y.data)||null):(e=yield S({type:z.GET_CACHE,payload:{cacheIndex:p}}),"test"===B.env&&L.default.debug("%cUsing Cached Data for","background:#7268A6; color: white; display: block;",b))}catch(e){throw e}if(null!=(h=null==e?void 0:e.edge)&&h.length||"test"!==B.env){if(e.edge=A.reduce(A.array(null==e?void 0:e.edge),(e,t)=>t?e.concat(ia(t)):e,[]),"test"===B.env){if(v){const g=hc(v);null!=e&&e.code&&"all"!==g[0]&&-1===g.indexOf(null==e?void 0:e.code)&&q(`${null==e?void 0:e.code}:`+(null==e?void 0:e.error),{type:"error"})}else null!=e&&e.code&&q(`${null==e?void 0:e.code}:`+(null==e?void 0:e.error),{type:"error"});L.default.info("%cGet Edge Response","background: purple; color: white; display: block;",e)}e.jwt&&(yield S({type:z.UPDATE_DATA,payload:{dataKey:"Global.currentUser.JWT",data:e.jwt}})),yield S({type:z.UPDATE_DATA,payload:{pageName:_,dataKey:i||r,data:e}})}else{if(v){const m=hc(v);null!=e&&e.code&&"all"!==m[0]&&-1===m.indexOf(null==e?void 0:e.code)&&q(`${null==e?void 0:e.code}:`+(null==e?void 0:e.error),{type:"error"})}else null!=e&&e.code&&q(`${null==e?void 0:e.code}:`+(null==e?void 0:e.error),{type:"error"});L.default.info("%cGet Edge Response","background: purple; color: white; display: block;",e)}return e})}}function Ra({pageName:C,apiObject:R,dispatch:P}){return function(k){return ka(this,null,function*(){var e,t,i,o;const{dataKey:r,dataIn:n,dataOut:a}=K(R||{}),l=yield P({type:z.GET_DATA,payload:{pageName:C,dataKey:n||r}}),{id:u,_handledCode:s}=l,c=Na(l,["deat","id","_handledCode"]);let d=yield P({type:z.POPULATE_OBJECT,payload:{object:c,pageName:C,copy:!0}});if(1090===d.type&&(d.subtype=2),!M(u))throw new Se(`Missing reference ${u} at page `+C);let f=parseInt(d.type),p;if(!Number.isNaN(f)&&0!==f){if(d=ja(xa({},d),{type:f}),k&&(d=Bo(d,{name:k})),u&&!u.startsWith("."))try{if("test"===B.env&&L.default.info("%cUpdate Edge Request","background: purple; color: white; display: block;",ja(xa({},d),{id:u})),p=null==(e=yield B.level2SDK.edgeServices.updateEdge(ja(xa({},d),{id:u})))?void 0:e.data,"test"===B.env){if(s){const x=hc(s);null!=p&&p.code&&"all"!==x[0]&&-1===x.indexOf(null==p?void 0:p.code)&&q(`${null==p?void 0:p.code}:`+(null==p?void 0:p.error),{type:"error"})}else null!=p&&p.code&&q(`${null==p?void 0:p.code}:`+(null==p?void 0:p.error),{type:"error"});L.default.info("%cUpdate Edge Response","background: purple; color: white; display: block;",p)}}catch(e){throw e}else try{"test"===B.env&&L.default.info("%cCreate Edge Request","background: purple; color: white; display: block;",d);var h=(yield B.level2SDK.edgeServices.createEdge(d))["data"];if(1053===(null==(t=null==h?void 0:h.edge)?void 0:t.type)){var v,y,g,m,b=localStorage.getItem("pk"),_=localStorage.getItem("sk"),S=yield F(null==(i=null==h?void 0:h.edge)?void 0:i.refid),E=null==(o=null==S?void 0:S.data)?void 0:o.edge;let e=null==E?void 0:E[0],t=null==e?void 0:e.besak;null!=e&&e.besak||(v=B.level2SDK.commonServices.generateEsak(b),y=localStorage.getItem("facility_vid")?localStorage.getItem("facility_vid"):localStorage.getItem("user_vid"),yield B.level2SDK.edgeServices.createEdge({type:1030,bvid:e.bvid}),g={type:4e4,bvid:e.bvid,besak:v,name:e.name},m=(yield B.level2SDK.edgeServices.updateEdge(xa({id:e.eid},g)))["data"],y&&(yield B.level2SDK.edgeServices.createEdge({type:1030,bvid:y})),null!=m&&m.edge&&(t=v));let r,n;b&&_&&(r=B.level2SDK.utilServices.base64ToUint8Array(b),n=B.level2SDK.utilServices.base64ToUint8Array(_));var O,T,w=B.level2SDK.utilServices.aKeyDecrypt(r,n,t),A=null==h?void 0:h.edge,D=A.deat.evPK||A.deat.eePK,I=B.level2SDK.utilServices.base64ToUint8Array(D);w&&(O=B.level2SDK.utilServices.aKeyEncrypt(I,n,w),T=(yield B.level2SDK.edgeServices.updateEdge({id:A.eid,type:1053,eesak:O,name:A.name}))["data"],p=T)}else p=h;if("test"===B.env){if(s){const j=hc(s);null!=p&&p.code&&"all"!==j[0]&&-1===j.indexOf(null==p?void 0:p.code)&&q(`${null==p?void 0:p.code}:`+(null==p?void 0:p.error),{type:"error"})}else{const N=[10316,10317,3001,1005,2002];null!=p&&p.code&&-1==N.indexOf(null==p?void 0:p.code)&&q(`${null==p?void 0:p.code}:`+(null==p?void 0:p.error),{type:"error"})}L.default.info("%cCreate Edge Response","background: purple; color: white; display: block;",p)}}catch(e){throw e}return p&&(p.edge=ia(p.edge),p.jwt&&(yield P({type:z.UPDATE_DATA,payload:{dataKey:"Global.currentUser.JWT",data:p.jwt}})),yield P({type:z.UPDATE_DATA,payload:{pageName:C,dataKey:a||r,data:p}}),yield P({type:z.POPULATE,payload:{pageName:C}})),p}})}}var Pa=Object.defineProperty,La=Object.defineProperties,Ba=Object.getOwnPropertyDescriptors,Ua=Object.getOwnPropertySymbols,Fa=Object.prototype.hasOwnProperty,Ka=Object.prototype.propertyIsEnumerable,Ma=(e,t,r)=>t in e?Pa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,za=(e,t)=>{for(var r in t=t||{})Fa.call(t,r)&&Ma(e,r,t[r]);if(Ua)for(var r of Ua(t))Ka.call(t,r)&&Ma(e,r,t[r]);return e},qa=(e,t)=>La(e,Ba(t)),Va=(e,t)=>{var r={};for(n in e)Fa.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&Ua)for(var n of Ua(e))t.indexOf(n)<0&&Ka.call(e,n)&&(r[n]=e[n]);return r},Wa=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});function Ga({pageName:_,apiObject:S,dispatch:E}){return function(){return Wa(this,null,function*(){var e=K(S||{}),{dataKey:t,dataIn:r,dataOut:n}=e,e=Va(e,["api","dataKey","dataIn","dataOut"]);let i={},o,a,l=e,u=void(null!=e&&e.sCondition),s=yield E({type:z.GET_DATA,payload:{pageName:_,dataKey:r||t}}),c=yield E({type:z.POPULATE_OBJECT,payload:{object:s,pageName:_,copy:!0}}),{id:d,_handledCode:f,_nonce:p}=c,h=Va(c,["deat","id","_handledCode","_nonce"]);if(a=p,!M(d))throw new Se(`Missing reference ${d} at page `+_);o=U(d),l=za(za({},l),h),u=null==h?void 0:h.sCondition;try{"test"===B.env&&L.default.info("%cGet Vertex Request","background: purple; color: white; display: block;",{idList:o,options:l}),u&&(l.scondition=u);var{pass:v,cacheIndex:y}=yield E({type:z.SET_API_BUFFER,payload:{apiObject:{idList:o,options:l,nonce:a}}});if(v){l.sCondition&&(l.scondition=l.sCondition,delete l.sCondition),L.default.debug(A.cyan("store.level2SDK"),B);var g=(yield B.level2SDK.vertexServices.retrieveVertex({idList:o,options:l}))["data"];if(yield E({type:z.SET_CACHE,payload:{data:g,cacheIndex:y}}),i=g,"test"===B.env){if(f){const m=hc(f);null!=i&&i.code&&"all"!==m[0]&&-1===m.indexOf(null==i?void 0:i.code)&&q(`${null==i?void 0:i.code}:`+(null==i?void 0:i.error),{type:"error"})}else null!=i&&i.code&&q(`${null==i?void 0:i.code}:`+(null==i?void 0:i.error),{type:"error"});L.default.info("%cGet Vertex Response","background: purple; color: white; display: block;",i)}}else i=yield E({type:z.GET_CACHE,payload:{cacheIndex:y}}),"test"===B.env&&L.default.debug("%cUsing Cached Data for","background:#7268A6; color: white; display: block;",S)}catch(e){throw e}if(i){if("test"===B.env){if(f){const b=hc(f);null!=i&&i.code&&"all"!==b[0]&&-1===b.indexOf(null==i?void 0:i.code)&&q(`${null==i?void 0:i.code}:`+(null==i?void 0:i.error),{type:"error"})}else null!=i&&i.code&&q(`${null==i?void 0:i.code}:`+(null==i?void 0:i.error),{type:"error"});L.default.info("%cGet Vertex Response","background: purple; color: white; display: block;",i)}i.jwt&&(yield E({type:z.UPDATE_DATA,payload:{dataKey:"Global.currentUser.JWT",data:i.jwt}})),yield E({type:z.UPDATE_DATA,payload:{pageName:_,dataKey:n||t,data:i}})}return i})}}function Ha({pageName:h,apiObject:v,dispatch:y}){return function(p){return Wa(this,null,function*(){var e,{dataKey:t,dataIn:r,dataOut:n}=K(v||{}),r=yield y({type:z.GET_DATA,payload:{dataKey:r||t,pageName:h}}),r=Va(r,["deat"]),r=yield y({type:z.POPULATE_OBJECT,payload:{object:r,pageName:h,copy:!0}}),{id:i,_handledCode:o}=r,r=Va(r,["id","_handledCode"]);if(!M(i))return e=new Se(`Missing reference ${i} at page `+h),L.default.error(e);let a=r;const l=a=p?Bo(a,{name:p}):a,u=Va(l,["api","store","get"]);let s;if(i)try{"test"===B.env&&L.default.info("%cUpdate Vertex Request","background: purple; color: white; display: block;",qa(za({},u),{id:i})),u.type&&(u.type=parseInt(null==u?void 0:u.type)),u.tage&&(u.tage=parseInt(null==u?void 0:u.tage));var c=(yield B.level2SDK.vertexServices.updateVertex(qa(za({},u),{id:i})))["data"];if(s=c,"test"===B.env){if(o){const d=hc(o);null!=s&&s.code&&"all"!==d[0]&&-1===d.indexOf(null==s?void 0:s.code)&&q(`${null==s?void 0:s.code}:`+(null==s?void 0:s.error),{type:"error"})}else null!=s&&s.code&&q(`${null==s?void 0:s.code}:`+(null==s?void 0:s.error),{type:"error"});L.default.info("%cUpdate Vertex Response","background: purple; color: white; display: block;",s)}}catch(e){throw e}else{u.type&&(u.type=parseInt(null==u?void 0:u.type)),u.tage&&(u.tage=parseInt(null==u?void 0:u.tage));try{if("test"===B.env&&L.default.info("%cCreate Vertex Request","background: purple; color: white; display: block;",za({},u)),s=yield B.level2SDK.vertexServices.createVertex(za({},u)),"test"===B.env){if(o){const f=hc(o);null!=s&&s.code&&"all"!==f[0]&&-1===f.indexOf(null==s?void 0:s.code)&&q(`${null==s?void 0:s.code}:`+(null==s?void 0:s.error),{type:"error"})}else null!=s&&s.code&&q(`${null==s?void 0:s.code}:`+(null==s?void 0:s.error),{type:"error"});L.default.info("%cCreate Vertex Response","background: purple; color: white; display: block;",s)}}catch(e){throw e}}return s&&(s.jwt&&(yield y({type:z.UPDATE_DATA,payload:{dataKey:"Global.currentUser.JWT",data:s.jwt}})),yield y({type:z.UPDATE_DATA,payload:{pageName:h,dataKey:n||t,data:s}})),s})}}var Ja=Object.defineProperty,$a=Object.defineProperties,Ya=Object.getOwnPropertyDescriptors,Xa=Object.getOwnPropertySymbols,Qa=Object.prototype.hasOwnProperty,Za=Object.prototype.propertyIsEnumerable,el=(e,t,r)=>t in e?Ja(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,tl=(e,t)=>{for(var r in t=t||{})Qa.call(t,r)&&el(e,r,t[r]);if(Xa)for(var r of Xa(t))Za.call(t,r)&&el(e,r,t[r]);return e},rl=(e,t)=>{var r={};for(n in e)Qa.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&Xa)for(var n of Xa(e))t.indexOf(n)<0&&Za.call(e,n)&&(r[n]=e[n]);return r},nl=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});function il({pageName:m,apiObject:b,dispatch:_}){return function(){return nl(this,null,function*(){let e;var t=K(b||{}),{dataKey:r,dataIn:n,dataOut:i}=t,t=rl(t,["api","dataKey","dataIn","dataOut","subtype"]);let o=tl({},t),a=null==t?void 0:t.maxcount,l=null==t?void 0:t.type,u=null==t?void 0:t.sCondition,s,c=[],d;if(n){var t=yield _({type:z.GET_DATA,payload:{pageName:m,dataKey:n||r}}),n=yield _({type:z.POPULATE_OBJECT,payload:{object:t,pageName:m,copy:!0}}),{id:t,ids:f,_nonce:p,ObjType:h,key:v}=n,n=rl(n,["deat","id","ids","_nonce","ObjType","key"]);if(h&&3===h&&v){let t=[];const y=yield _({type:z.SEARCH_CACHE,payload:{key:v,sCondition:null==n?void 0:n.sCondition}});return y.length&&(v=y.map(e=>nl(this,null,function*(){if(e)return yield pa({document:e})})),yield Promise.all(v).then(e=>{t=e}).catch(e=>{L.default.error(e instanceof Error?e:new Error(String(e)))})),void(yield _({type:z.UPDATE_DATA,payload:{pageName:m,dataKey:i||r,data:{doc:t,searchResult:!0}}}))}if(d=h,c=U(f||t),s=p,!M(t))return v=new Se(`Missing reference ${t} at page `+m),L.default.error(v);o=n,a=null==n?void 0:n.maxcount,l=null==n?void 0:n.type,u=null==n?void 0:n.sCondition}else{var h=yield _({type:z.POPULATE_OBJECT,payload:{object:o,pageName:m}}),{_nonce:f,id:p,ids:t}=h,v=rl(h,["deat","_nonce","id","ids"]);c=U(t||p),s=f,o=v}a&&(o.maxcount=parseInt(a)),l&&(o.type=parseInt(l)),u&&(o.scondition=u);var n=null==o?void 0:o._handledCode,{pass:h,cacheIndex:t}=(d&&(o.ObjType=d),yield _({type:z.SET_API_BUFFER,payload:{apiObject:{idList:c,options:o,nonce:s}}}));try{if("test"===B.env&&L.default.info("%cGet Document Request","background: purple; color: white; display: block;",{idList:c,options:o}),h){let n;yield B.level2SDK.documentServices.retrieveDocument({idList:c,options:o}).then(r=>nl(this,null,function*(){n=r.data;var e,t=A.reduce(A.array(null==(t=null==r?void 0:r.data)?void 0:t.document),(e,t)=>A.isNil(t)?e:e.concat(t),[]);return Promise.allSettled(null==(e=t.map)?void 0:e.call(t,n=>nl(this,null,function*(){if(yield _({type:z.INSERT_TO_OBJECT_TABLE,payload:{doc:n}}),null!=(r=null==n?void 0:n.deat)&&r.url)return n;{let t;try{t=yield pa({document:n})}catch(e){var r=e instanceof Error?e:new Error(String(e));L.default.error(r,{note:t,error:r,document:n})}return t}})))})).then(e=>{n.doc=e.reduce((e,t)=>{var{status:t,value:r}=t;return"fulfilled"!==t||A.isNil(r)?e:e.concat(r)},[]),delete n.document}).catch(e=>{L.default.error(e instanceof Error?e:new Error(String(e)))}),yield _({type:z.SET_CACHE,payload:{data:n,cacheIndex:t}}),e=n}else e=yield _({type:z.GET_CACHE,payload:{cacheIndex:t}}),"test"===B.env&&L.default.debug("%cUsing Cached Data for","background:#7268A6; color: white; display: block;",b)}catch(e){throw e}if(e){if("test"===B.env){if(n){const g=hc(n);null!=e&&e.code&&"all"!==g[0]&&-1===g.indexOf(null==e?void 0:e.code)&&q(`${null==e?void 0:e.code}:`+(null==e?void 0:e.error),{type:"error"})}else null!=e&&e.code&&null!=e&&e.code&&q(`${null==e?void 0:e.code}:`+(null==e?void 0:e.error),{type:"error"});L.default.info("%cGet Document Response","background: purple; color: white; display: block;",e)}e.jwt&&(yield _({type:z.UPDATE_DATA,payload:{dataKey:"Global.currentUser.JWT",data:e.jwt}})),yield _({type:z.UPDATE_DATA,payload:{pageName:m,dataKey:i||r,data:e}}),yield _({type:z.INSERT_TO_INDEX_TABLE,payload:{doc:e}})}return e})}}function ol({pageName:O,apiObject:T,dispatch:w}){return function(){return nl(this,null,function*(){const{dataKey:e,dataIn:t,dataOut:r}=K(T||{}),n=yield w({type:z.GET_DATA,payload:{dataKey:t||e,pageName:O}}),i=yield w({type:z.POPULATE_OBJECT,payload:{object:n,pageName:O}}),{id:o,_handledCode:a}=i,l=rl(i,["deat","id","_handledCode","_nonce"]);if(!M(o))throw new Se(`Missing reference ${o} at page `+O);var u,s;"2000"==l.type&&"function"==typeof l.name.nonce&&(l.name=(u=tl({},l.name),s={nonce:l.name.nonce()},$a(u,Ya(s))));let c;if(o)try{var d=l,{eid:f,name:p,subtype:h}=d,v=rl(d,["eid","name","subtype"]);if("test"===B.env&&L.default.info("%cUpdate Document Request","background: purple; color: white; display: block;",o,{edge_id:f,content:null==p?void 0:p.data,mediaType:null==p?void 0:p.type,title:null==p?void 0:p.title,targetRoomName:null==p?void 0:p.targetRoomName,tags:null==p?void 0:p.tags,user:null==p?void 0:p.user,sesk:null==p?void 0:p.sesk,aesk:null==p?void 0:p.aesk,tage:null==v?void 0:v.tage,type:null==v?void 0:v.type,fid:null==v?void 0:v.fid,reid:null==v?void 0:v.reid,jwt:null==v?void 0:v.jwt,dTypeProps:h}),c=yield D.update(o,{edge_id:f,content:null==p?void 0:p.data,mediaType:null==p?void 0:p.type,title:null==p?void 0:p.title,targetRoomName:null==p?void 0:p.targetRoomName,tags:null==p?void 0:p.tags,user:null==p?void 0:p.user,sesk:null==p?void 0:p.sesk,sfname:null==p?void 0:p.sfname,aesk:null==p?void 0:p.aesk,tage:null==v?void 0:v.tage,type:null==v?void 0:v.type,fid:null==v?void 0:v.fid,reid:null==v?void 0:v.reid,jwt:null==v?void 0:v.jwt,dTypeProps:h}),"test"===B.env){if(a){const y=hc(a);null!=c&&c.code&&"all"!==y[0]&&-1===y.indexOf(null==c?void 0:c.code)&&q(`${null==c?void 0:c.code}:`+(null==c?void 0:c.error),{type:"error"})}else null!=c&&c.code&&null!=c&&c.code&&q(`${null==c?void 0:c.code}:`+(null==c?void 0:c.error),{type:"error"});L.default.info("%cUpdate Document Response","background: purple; color: white; display: block;",c)}}catch(e){throw e}else try{const g=l,{subtype:m,eid:b,name:_}=g,S=rl(g,["subtype","eid","name"]);if(A.isStr(S.type)&&(S.type=parseInt(S.type)),"test"===B.env&&L.default.info("%cCreate Document Request","background: purple; color: white; display: block;",{edge_id:b,content:null==_?void 0:_.data,targetRoomName:null==_?void 0:_.targetRoomName,paymentNonce:null==_?void 0:_.nonce,mediaType:null==_?void 0:_.type,title:null==_?void 0:_.title,user:null==_?void 0:_.user,sesk:null==_?void 0:_.sesk,aesk:null==_?void 0:_.aesk,notification:null==_?void 0:_.notification,tage:null==S?void 0:S.tage,type:null==S?void 0:S.type,fid:null==S?void 0:S.fid,reid:null==S?void 0:S.reid,jwt:null==S?void 0:S.jwt,dTypeProps:m}),c=yield D.create({edge_id:b,content:null==_?void 0:_.data,targetRoomName:null==_?void 0:_.targetRoomName,paymentNonce:null==_?void 0:_.nonce,mediaType:null==_?void 0:_.type,title:null==_?void 0:_.title,user:null==_?void 0:_.user,sesk:null==_?void 0:_.sesk,sfname:null==_?void 0:_.sfname,aesk:null==_?void 0:_.aesk,notification:null==_?void 0:_.notification,tage:null==S?void 0:S.tage,type:null==S?void 0:S.type,fid:null==S?void 0:S.fid,reid:null==S?void 0:S.reid,jwt:null==S?void 0:S.jwt,dTypeProps:m,dispatch:w}),"test"===B.env){if(a){const E=hc(a);null!=c&&c.code&&"all"!==E[0]&&-1===E.indexOf(null==c?void 0:c.code)&&q(`${null==c?void 0:c.code}:`+(null==c?void 0:c.error),{type:"error"})}else null!=c&&c.code&&q(`${null==c?void 0:c.code}:`+(null==c?void 0:c.error),{type:"error"});L.default.info("%cCreate Document Response","background: purple; color: white; display: block;",c)}}catch(e){throw e}return c&&(c.jwt&&(yield w({type:z.UPDATE_DATA,payload:{dataKey:"Global.currentUser.JWT",data:c.jwt}})),yield w({type:z.UPDATE_DATA,payload:{pageName:O,dataKey:r||e,data:c}}),yield w({type:z.INSERT_TO_INDEX_TABLE,payload:{doc:[c.doc]}})),c})}}function al(e){return e*Math.PI/180}var ll={formatTimer(e,t="hh:mm:ss"){return f.default(e).format(t)},formatUnixtimeSecond(e){return f.default(1e3*e).format("L hh:mm:ss")},formatNowTime(){return f.default().format("lll")},formatUnixtime_en(e){return"--"!==e?f.default(1e3*e).format("lll"):"--"},formatUnixtimeL_en(e){return f.default(1e3*e).format("l")},formatUnixtimeLT_en(e){return f.default(1e3*e).format("LT")},formatDurationInSecond(e){return re.default(1e3*e)},formatDurationInMicroSecond(e){return f.default(e).format("lll")},concat(e){return Array.isArray(e)?e.join(""):""},concatTrim(e){return Array.isArray(e)?e.filter(e=>{if(e)return e}).join(""):""},split16DkeytoArray(e){return 16!==e.length?[]:[].concat(e.substring(0,4),e.substring(4,8),e.substring(8,12),e.substring(12))},split16Dkey(e){return 16!==e.length?e+" length:"+e.length:"Please let your friend enter this code on their side: "+e.substring(0,4)+"-"+e.substring(4,8)+"-"+e.substring(8,12)+"-"+e.substring(12)},equal({string1:e,string2:t}){return e==t},getFirstChar({value:e}){if(e)return e.charAt(0).toUpperCase()},getLength(e){return e.toString().length},retainNumber({value:e}){return parseInt(e)},phoneVerification({countryCode:t,phoneNumber:r}){L.default.debug("test phoneVerificatio",{countryCode:t,phoneNumber:r});const n=/^(\+?0?86\-?)?1[345789]\d{9}$/,i=/^(\+?965)[569]\d{7}$/,o=/^(\+?1)?[2-9]\d{2}[2-9](?!11)\d{6}$/,a=/^(\+?52)?\d{6,12}$/;if(t&&r){r=r.toString(10),t=t.trim(),r=r.trim();let e;if("+86"==t)r=t+""+r,e=r.match(n);else if("+1"==t){if(("888"==r.substring(0,3)||"886"==r.substring(0,3))&&10===r.length)return!0;r=t+""+r,e=r.match(o)}else"+965"==t?(r=t+""+r,e=r.match(i)):"+52"==t&&(r=t+""+r,e=r.match(a));if(null!=e)return!0}return!1},phoneNumberSplit({phoneNumber:e,sign:t}){return null==e?[]:String(e).toString().split(t)},judgeMultipleEqual(t){for(let e=1;e<t.length;e++)if(t[e-1]!==t[e])return!1;return!0},judgeSelectTime(t){for(let e=0;e<t.length;e++)if(t[e].startsWith("$"))return!1;return!0},judgeFillinAll(t){if(0===t.length)return!0;for(let e=0;e<t.length;e++)if(""==t[e]||"-- --"==t[e]||"Select"==t[e])return!0;return!1},judgeIsAllEmpty(t){L.default.debug(t);for(let e=0;e<t.length;e++)if(""!=t[e])return!1;return!0},judgeAllTrue({str1:e,str2:t,str3:r}){return e&&t&&r},judgesFillinAll(r){let n=!1;return Object.keys(r).forEach(t=>{null!==r[t]&&""!==r[t]&&Object.keys(r[t]).forEach(e=>{null!=r[t][e]&&""!=r[t][e]||(L.default.debug(r[t][e]),n=!0)})}),!n},strLenx({obj:e}){let t="",r=0;for(var n of Object.values(e))if(""!==n){if(2===++r||4===r){t+=n+" ";continue}t+=n+","}return""===t?"":t.substr(0,t.length-1)},distanceByPosition(o){if(null!=o||void 0!==o){var a=B.currentLatitude,l=B.currentLongitude;if(null!=a&&null!=l&&void 0!==l&&void 0!==a){let e=al(a),t=al(o[0]),r=e-t,n=al(l)-al(o[1]),i=2*Math.asin(Math.sqrt(Math.pow(Math.sin(r/2),2)+Math.cos(e)*Math.cos(t)*Math.pow(Math.sin(n/2),2)));return i*=6378.137,(i=Math.round(1e4*i)/1e4).toFixed(2)+" km"}}},getAddress({object:e}){var t;let r={address:"",city:"",state:"",zipCode:"",location:"",geoCode:[],country:"",county:"",firsLine:"",SecondLine:"",distance:""};return e&&(e.context.forEach(e=>{var t=e.id.split(".")[0];switch(L.default.debug(t),t){case"postcode":r.zipCode=e.text;break;case"place":r.city=e.text;break;case"region":r.state=e.short_code.split("-")[1];break;case"country":r.country=e.text;break;case"district":r.county=e.text}}),r.distance=function(o,a=[39.2946,-76.6252]){if(a&&o){let e=al(o[0]),t=al(a[0]),r=e-t,n=al(o[1])-al(a[1]),i=2*Math.asin(Math.sqrt(Math.pow(Math.sin(r/2),2)+Math.cos(e)*Math.cos(t)*Math.pow(Math.sin(n/2),2)));return i*=6378.137,(i=Math.round(1e4*i)/1e4).toFixed(2)+" km"}return"0km"}(null==e?void 0:e.center),r.geoCode=e.center,r.location=e.place_name,null!=(t=null==e?void 0:e.properties)&&t.address?r.address=e.text+", "+e.properties.address:r.address=e.text,r.address=e.address?e.address+" "+r.address:r.address,"poi"==(null==e?void 0:e.place_type[0])||"address"==(null==e?void 0:e.place_type[0])?(r.firsLine=e.text,e.properties.address?r.SecondLine=null==(t=null==e?void 0:e.properties)?void 0:t.address:r.SecondLine=""):(r.firsLine="",r.SecondLine=""),"place"==(null==e?void 0:e.place_type[0])&&(r.city=e.text,r.address=""),"region"==(null==e?void 0:e.place_type[0])&&(r.state=e.text,r.address=""),"postcode"==(null==e?void 0:e.place_type[0])&&(r.zipCode=e.text,r.address=""),"district"==(null==e?void 0:e.place_type[0])&&(r.county=e.text,r.address="")),r},generateID({facilityID:e,locationID:t,roomID:r}){return""!=r?(r=r.toString().toLowerCase().replace(/\s*/g,"").substring(0,6),t.substring(0,25).concat("_").concat(r)):""!=t?(r=t.toString().toLowerCase().replace(/\s*/g,"").substring(0,8),e.substring(0,16).concat("_").concat(r)):e.toString().toLocaleLowerCase().replace(/\s*/g,"").substring(0,16)},bitFormatting(e){if(0===e)return"0 B";var t=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,t)).toFixed(2)+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][t]},equalsLenString({stringOne:t,stringTwo:r,len:n}){for(let e=0;e<n;e++)if(t[e]!==r[e])return!1;return!0},dollarFormat(e){return e=String(e),/^(\-?)\d+(\.\d+)?$/.test(e)?/[\.]/.test(e)?e.startsWith("-")?"-$"+e.substring(1):"$"+e:e.startsWith("-")?"-$"+e.substring(1)/100:"$"+e/100:e},parseSpliceString({value:t,objArr:e,path:r="text",pathItem:n="_source.specialty"}){let i="";return null!=e&&e.forEach(e=>{new RegExp(String(t),"ig").test(m(e,r))&&(i+=m(e,n)+" ")}),i.trim()},addValue({value1:e,value2:t}){return e+t}};var ul=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};var sl=function(e,t){return t.length<2?e:Ro(e,we(t,0,-1))};var cl=function(e,t){return t=ko(t,e),null==(e=sl(e,t))||delete e[Co(ul(t))]};var dl=function(e,t){return null==e||cl(e,t)};var fl=function(e,t,r){for(var n=-1,i=e.length,o=t.length,a={};++n<i;){var l=n<o?t[n]:void 0;r(a,e[n],l)}return a};var pl=function(e,t){return fl(e||[],t||[],xr)},hl={remove({object:e,key:t}){A.isObj(e)&&dl(e,t)},clear({object:e,key:t}){A.isObj(e)&&(e[t]="")},set({object:e,key:t,value:r}){A.isObj(e)&&p(e,t,r)},setObjectKey({objectArr:e,key:t,value:r}){return Array.from(e).forEach(e=>{A.isObj(e)&&p(e,t,r)}),e},get({object:e,key:t}){if(A.isObj(e))return""==e[t]&&(e[t]=" "),e[t]},has({object:e,key:t}){if(A.isObj(e))return t in e&&!!e[t]},objectHasValue({objArr:e,valPath:t}){let r=!1;return Array.from(e).forEach(e=>r=!1!==e[t]||r),r},clearAndSetKey({object:t,item:e,key:r,value:n}){if(A.isArr(t)){for(let e=0;e<t.length;e++)t[e][r]="";e[r]=n}},extract({array:e,field:t}){let r=[];return e.forEach(e=>{r.push(m(e,t))}),r},extractArray({obj:e,arr:r}){if(A.isArr(e)){let t=new Array;return e.forEach(e=>{let n={};r.forEach(t=>{let r=e;if(-1===t.indexOf("."))n[t]=r.hasOwnProperty(t)?r[t]:"";else{let e=t.split(".");e.forEach(e=>{r=r.hasOwnProperty(e)?r[e]:""}),r&&(n[e[e.length-1]]=r.toString())}}),t.push(n)}),t}return""},authToSubType({auth:n,authList:i}){let o=[];return Object.keys(n).forEach(t=>{var e;let r=0;Object.keys(i).forEach(e=>{t===e&&(r=1e4*i[e])}),!0===(null==(e=null==n?void 0:n[t])?void 0:e.create)&&(r+=4),!0===(null==(e=null==n?void 0:n[t])?void 0:e.edit)&&(r+=2),!0===(null==(e=null==n?void 0:n[t])?void 0:e.review)&&(r+=1),o.push(parseInt(r.toString(),16))}),o},findTrue({object:r}){let n={Settings:!1,UserManagement:!1,Schedule:!1};return Object.keys(r).forEach(t=>{Object.keys(r[t]).forEach(e=>{"MFI"!==t&&"TDT"!==t||!0!==r[t][e]?"staff"!==t&&"patient"!==t&&"provider"!==t||!0!==r[t][e]?"scheduleInfo"!==t&&"PAT"!==t||!0!==r[t][e]||(n.Schedule=!0):n.UserManagement=!0:n.Settings=!0})}),n},setAuthAllTrue({object:r}){return Object.keys(r).forEach(t=>{Object.keys(r[t]).forEach(e=>{r[t][e]=!0})}),r},isEmpty({object:e}){return""===e},setByKey({object:t,key:r,value:n}){Object.keys(t).forEach(e=>{r===e&&(t[e]=n)})},getObjValueAndKey({objects:t,objStr:r}){let n=Object.keys(t),i={};for(let e=0;e<n.length;e++)r[e]in t&&(i[r[e]]=t[r[e]]);return i},getObjKey({objects:e}){return e?Object.keys(e):[]},getObjWithKV({object:e}){var t,r,n=[];for(r in e)t={key:r,value:e[r]},n.push(t);return n},setProperty({obj:t,label:r,text:n,arr:i,valueArr:o,errorArr:a}){var l;for(let e=0;e<t.length;e++)for(var u in i)(null==(l=null==t?void 0:t[e])?void 0:l[r])===n?t[e][i[u]]=o[u]:t[e][i[u]]=a[u];return t},setTimeProperty({obj:e}){let t=JSON.parse(JSON.stringify(e));return t.forEach(e=>{var t=((983040&e.subtype)>>16)%2;0==t&&e.name.hasOwnProperty("visitReason")?(p(e,"name.backgroundColor","0xfff7e3"),p(e,"name.borderColor","0xfff7e3"),p(e,"name.fontColor","0xf8ae29")):1==t&&e.name.hasOwnProperty("visitReason")?(p(e,"name.backgroundColor","0xe4f5e9"),p(e,"name.borderColor","0xe4f5e9"),p(e,"name.fontColor","0x17a05d")):(p(e,"name.visitReason","Avaliable"),p(e,"name.visitType",""),p(e,"name.backgroundColor","0xffffff"),p(e,"name.borderColor","0xeeeeee"))}),t},clearAll({object:t}){Object.keys(t).forEach(e=>{A.isArr(t[e])?t[e]=[]:t[e]=" "})},extractingFeatureStrings({objArrs:e,pathObj:r,bool:t}){let n=[],i=[],o=[],a=[],l={},u=[];if(0===e.length)return[];if(e.forEach(t=>{r.forEach(e=>{o.push(e.split(".")[e.split(".").length-1]),i.push(m(t,e,"default"))}),n.push(m(t,r[0],"default")),a.push(pl(o,i))}),0===n.length)return"The array is empty";t&&n.map((e,t,r)=>{r[t]=e[0].toLocaleUpperCase()+e.slice(1),n=r}),n.sort();for(var s of n)s in u||!/[a-zA-Z]+/.test(s.charAt(0))||u.push(s.charAt(0));let c=u.length,d=[];for(let t=0;t<c;t++)l[u[t]]=new Array,a.forEach(e=>{e[o[0]].charAt(0).toLocaleUpperCase()===u[t]&&/[a-zA-Z]+/.test(e[o[0]].charAt(0))&&l[u[t]].push(e)});a.forEach(e=>{/[a-zA-Z]+/.test(e[o[0]].charAt(0))||d.push(e)}),n=[];for(var[f,p]of Object.entries(l))n.push(pl(["index","data"],[f,p]));return 0!==d.length&&n.unshift(pl(["index","data"],["#",d])),n},addKey({object:e,key:t,value:r}){return e.forEach(e=>{e[t]=r}),e},deleteKey({object:t,path:e}){return e.forEach(e=>{dl(t,e)}),t},hasMultipleKeys({object:t,keyArr:r}){if(A.isObj(t))for(let e=0;e<r.length;e++)if(!1===t.hasOwnProperty(r[e]))return!1;return!0},transformStatus(e,t="type",r="deat.state"){if(e){if(2002===m(e,t))return"COMPLETED"===m(e,r)?"Refunded":"PENDING"===m(e,r)?"Refund Pending":"Refunded fail";if(2001===m(e,t))return"COMPLETED"===m(e,r)?"Paid":"Paid Fail";if(2003===m(e,t))return"Cash Out"}return"Unpaid"},judgeAllTrue({object:n}){let i=!0;return Object.keys(n).forEach(r=>{Object.keys(null==n?void 0:n[r]).forEach(e=>{var t;!1===(null==(t=null==n?void 0:n[r])?void 0:t[e])&&(i=!1)})}),i},setMultipleProperty({obj:e,label:t,checkValue:r,arr:n,valueArr:i,errorArr:o}){var a;let l=JSON.parse(JSON.stringify(e));if(r.hasOwnProperty(t))for(let e=0;e<l.length;e++)for(var u in n)(null==(a=null==l?void 0:l[e])?void 0:a[t])===r[t]&&(l[e].hasOwnProperty(n[u])&&(null==(a=null==l?void 0:l[e])?void 0:a[null==n?void 0:n[u]])===i[u]?l[e][n[u]]=o[u]:l[e][n[u]]=i[u]);else for(let e=0;e<l.length;e++)for(var s in n)l[e][n[s]]=o[s];return l},eEncapsulatedObj({originalObjArr:e,pathArr:r}){let n=[],i=[],o=r.map(e=>e.includes(".")?e.split(".").at(-1):e);return e.forEach(t=>{r.forEach(e=>{i.push(m(t,e)),L.default.debug(i)}),n.push(pl(o,i)),i=[]}),n},toCsvFormat({arrObj:e}){if(A.isArr(e)){let t="";return e.forEach(e=>{t=Object.values(e).toString()+`\r
`+t}),t}return e},matchSearchValue({objArr:e,paths:r,value:t}){let n=[],i=t.split("");return i.forEach((e,t)=>{i[t]=/\W/.test(e)?"\\"+e:e}),null!=e&&e.forEach(t=>{r.forEach(e=>{new RegExp(i.join(""),"ig").test(m(t,e))&&n.push(t)})}),n},clearObject({obj:e}){for(var t in e)delete e[t]},difference({object:t,baseObject:r}){let n={},i=[],o=(e,t,r)=>{for(var n in e)"object"==typeof e[n]?o(e[n],t[n],r):"basicInfo"===r&&["avatar","fullName"].includes(n)||"number"!=typeof e[n]&&"string"!=typeof e[n]&&"boolean"!=typeof e[n]||e[n]===t[n]||i.push({key:n,value:e[n]})};return["basicInfo","contactInfo","emergencyContact","employment"].forEach(e=>{o(t[e],r[e],e),i.length?n[e]=oa.cloneDeep(i):n[e]=[],i.length=0}),n},modifyObjectProperties({obj:e,keyArr:t,bool:r}){let n=JSON.stringify(e);return t.forEach(e=>{n=n.replace(new RegExp(`"${e}":(false|true)`,"g"),`"${e}":`+r)}),JSON.parse(n)},setObjDisplayAndColor({obj:e}){let t={};let r=JSON.stringify(e);return["prodAppSchedule","roomAppSchedule","documentNotes","paymentSetting","mailMessage"].forEach(e=>{new RegExp(`"${e}":{{1}"view":(false)[a-zA-Z:",]*}{1}`,"g").test(r)?t[""+e]="none":new RegExp(`"${e}":{{1}"view":(true)[a-zA-Z:",]*}{1}`,"g").test(r)&&(t[""+e]="block")}),r=JSON.parse(r.replace(new RegExp('{{1}"view":(false)[a-zA-Z:",]*}{1}',"g"),'"0xf4f4f4"').replace(new RegExp('{{1}"view":(true)[a-zA-Z:",]*}{1}',"g"),'"0xffffff"')),{controlColor:t,controlDisplay:t}}};var vl=function(e,t,r){if(!v(r))return!1;var n=typeof t;return!!("number"==n?Yr(r)&&Ur(t,r.length):"string"==n&&t in r)&&Pt(r[t],e)},yl=/\s/;var gl=function(e){for(var t=e.length;t--&&yl.test(e.charAt(t)););return t},ml=/^\s+/;var bl=function(e){return e&&e.slice(0,gl(e)+1).replace(ml,"")},_l=/^[-+]0x[0-9a-f]+$/i,Sl=/^0b[01]+$/i,El=/^0o[0-7]+$/i,Ol=parseInt;var Tl=function(e){if("number"==typeof e)return e;if(He(e))return NaN;if(v(e)&&(t="function"==typeof e.valueOf?e.valueOf():e,e=v(t)?t+"":t),"string"!=typeof e)return 0===e?e:+e;e=bl(e);var t=Sl.test(e);return t||El.test(e)?Ol(e.slice(2),t?2:8):_l.test(e)?NaN:+e};var wl=function(e){return e?(e=Tl(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};var Al=function(e){var t=(e=wl(e))%1;return e==e?t?e-t:e:0},Dl=Math.ceil,Il=Math.max;var xl=function(e,t,r){t=(r?vl(e,t,r):void 0===t)?1:Il(Al(t),0);var n=null==e?0:e.length;if(!n||t<1)return[];for(var i=0,o=0,a=Array(Dl(n/t));i<n;)a[o++]=we(e,i,i+=t);return a};function jl(e){return this.__data__.has(e)}function Nl(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Sr;++t<r;)this.add(e[t])}Nl.prototype.add=Nl.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Nl.prototype.has=jl;var kl=Nl;var Cl=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var Rl=function(e,t){return e.has(t)};var Pl=function(e,t,r,n,i,o){var a=1&r,l=e.length,u=t.length;if(l!=u&&!(a&&l<u))return!1;var u=o.get(e),s=o.get(t);if(u&&s)return u==t&&s==e;var c=-1,d=!0,f=2&r?new kl:void 0;for(o.set(e,t),o.set(t,e);++c<l;){var p,h=e[c],v=t[c];if(void 0!==(p=n?a?n(v,h,c,t,e,o):n(h,v,c,e,t,o):p)){if(p)continue;d=!1;break}if(f){if(!Cl(t,function(e,t){if(!Rl(f,t)&&(h===e||i(h,e,r,n,o)))return f.push(t)})){d=!1;break}}else if(h!==v&&!i(h,v,r,n,o)){d=!1;break}}return o.delete(e),o.delete(t),d};function Ll(e){var r=-1,n=Array(e.size);return e.forEach(function(e,t){n[++r]=[t,e]}),n}var Bl=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r},n=t?t.prototype:void 0,Ul=n?n.valueOf:void 0;var Fl=function(e,t,r,n,i,o,a){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new Rn(e),new Rn(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Pt(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var l=Ll;case"[object Set]":l=l||Bl;if(e.size!=t.size&&!(1&n))return!1;var u=a.get(e);if(u)return u==t;n|=2,a.set(e,t);u=Pl(l(e),l(t),n,i,o,a);return a.delete(e),u;case"[object Symbol]":if(Ul)return Ul.call(e)==Ul.call(t)}return!1},Kl=Object.prototype.hasOwnProperty;var Ml=function(e,t,r,n,i,o){var a=1&r,l=mn(e),u=l.length;if(u!=mn(t).length&&!a)return!1;for(var s=u;s--;){var c=l[s];if(!(a?c in t:Kl.call(t,c)))return!1}var d=o.get(e),f=o.get(t);if(d&&f)return d==t&&f==e;var p=!0;o.set(e,t),o.set(t,e);for(var h=a;++s<u;){var v,y=e[c=l[s]],g=t[c];if(!(void 0===(v=n?a?n(g,y,c,t,e,o):n(y,g,c,e,t,o):v)?y===g||i(y,g,r,n,o):v)){p=!1;break}h=h||"constructor"==c}return p&&!h&&(d=e.constructor)!=(f=t.constructor)&&"constructor"in e&&"constructor"in t&&!("function"==typeof d&&d instanceof d&&"function"==typeof f&&f instanceof f)&&(p=!1),o.delete(e),o.delete(t),p},zl="[object Arguments]",ql="[object Array]",Vl="[object Object]",Wl=Object.prototype.hasOwnProperty;var Gl=function(e,t,r,n,i,o){var a=h(e),l=h(t),u=a?ql:Nn(e),l=l?ql:Nn(t),s=(u=u==zl?Vl:u)==Vl,c=(l=l==zl?Vl:l)==Vl;if((l=u==l)&&Lr(e)){if(!Lr(t))return!1;s=!(a=!0)}if(l&&!s)return o=o||new Tr,a||zr(e)?Pl(e,t,r,n,i,o):Fl(e,t,u,r,n,i,o);if(!(1&r)){a=s&&Wl.call(e,"__wrapped__"),u=c&&Wl.call(t,"__wrapped__");if(a||u)return i(a?e.value():e,u?t.value():t,r,n,o=o||new Tr)}return l&&(o=o||new Tr,Ml(e,t,r,n,i,o))};var Hl=function e(t,r,n,i,o){return t===r||(null==t||null==r||!Ge(t)&&!Ge(r)?t!=t&&r!=r:Gl(t,r,n,i,e,o))};var Jl=function(e,t,r,n){var i=r.length,o=i,a=!n;if(null==e)return!o;for(e=Object(e);i--;){var l=r[i];if(a&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++i<o;){var u=(l=r[i])[0],s=e[u],c=l[1];if(a&&l[2]){if(void 0===s&&!(u in e))return!1}else{var d,f=new Tr;if(!(void 0===(d=n?n(s,c,u,e,t,f):d)?Hl(c,s,3,n,f):d))return!1}}return!0};var $l=function(e){return e==e&&!v(e)};var Yl=function(e){for(var t=Xr(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,$l(i)]}return t};var Xl=function(t,r){return function(e){return null!=e&&(e[t]===r&&(void 0!==r||t in Object(e)))}};var Ql=function(t){var r=Yl(t);return 1==r.length&&r[0][2]?Xl(r[0][0],r[0][1]):function(e){return e===t||Jl(e,t,r)}};function Zl(e,t){return null!=e&&t in Object(e)}var eu=function(e,t,r){for(var n=-1,i=(t=ko(t,e)).length,o=!1;++n<i;){var a=Co(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&Fr(i)&&Ur(a,i)&&(h(e)||Rr(e))};var tu=function(e,t){return null!=e&&eu(e,t,Zl)};var ru=function(r,n){return Ao(r)&&$l(n)?Xl(Co(r),n):function(e){var t=m(e,r);return void 0===t&&t===n?tu(e,r):Hl(n,t,3)}};function nu(e){return e}var iu=function(t){return function(e){return null==e?void 0:e[t]}};var ou=function(t){return function(e){return Ro(e,t)}};var au=function(e){return Ao(e)?iu(Co(e)):ou(e)};var lu=function(e){return"function"==typeof e?e:null==e?nu:"object"==typeof e?h(e)?ru(e[0],e[1]):Ql(e):au(e)};var uu=function(u){return function(e,t,r){for(var n=-1,i=Object(e),o=r(e),a=o.length;a--;){var l=o[u?a:++n];if(!1===t(i[l],l,i))break}return e}}();var su=function(o,a){return function(e,t){if(null==e)return e;if(!Yr(e))return o(e,t);for(var r=e.length,n=a?r:-1,i=Object(e);(a?n--:++n<r)&&!1!==t(i[n],n,i););return e}}(function(e,t){return e&&uu(e,t,Xr)});var cu=function(e,n){var i=-1,o=Yr(e)?Array(e.length):[];return su(e,function(e,t,r){o[++i]=n(e,t,r)}),o};var du=function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e};var fu=function(e,t){if(e!==t){var r=void 0!==e,n=null===e,i=e==e,o=He(e),a=void 0!==t,l=null===t,u=t==t,s=He(t);if(!l&&!s&&!o&&t<e||o&&a&&u&&!l&&!s||n&&a&&u||!r&&u||!i)return 1;if(!n&&!o&&!s&&e<t||s&&r&&i&&!n&&!o||l&&r&&i||!a&&i||!u)return-1}return 0};var pu=function(e,t,r){for(var n=-1,i=e.criteria,o=t.criteria,a=i.length,l=r.length;++n<a;){var u=fu(i[n],o[n]);if(u)return l<=n?u:u*("desc"==r[n]?-1:1)}return e.index-t.index};var hu=function(e,n,r){n=n.length?Be(n,function(t){return h(t)?function(e){return Ro(e,1===t.length?t[0]:t)}:t}):[nu];var i=-1,e=(n=Be(n,Mr(lu)),cu(e,function(t,e,r){return{criteria:Be(n,function(e){return e(t)}),index:++i,value:t}}));return du(e,function(e,t){return pu(e,t,r)})};var vu=function(e,t,r,n){return null==e?[]:(h(t)||(t=null==t?[]:[t]),h(r=n?void 0:r)||(r=null==r?[]:[r]),hu(e,t,r))},yu=t?t.isConcatSpreadable:void 0;function gu(e){return h(e)||Rr(e)||!!(yu&&e&&e[yu])}var mu=function e(t,r,n,i,o){var a=-1,l=t.length;for(n=n||gu,o=o||[];++a<l;){var u=t[a];0<r&&n(u)?1<r?e(u,r-1,n,i,o):pn(o,u):i||(o[o.length]=u)}return o};var bu=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},_u=Math.max;var Su=function(o,a,l){return a=_u(void 0===a?o.length-1:a,0),function(){for(var e=arguments,t=-1,r=_u(e.length-a,0),n=Array(r);++t<r;)n[t]=e[a+t];for(var t=-1,i=Array(a+1);++t<a;)i[t]=e[t];return i[a]=l(n),bu(o,this,i)}};var Eu=function(e){return function(){return e}},Ou=Date.now;var Tu=function(r){var n=0,i=0;return function(){var e=Ou(),t=16-(e-i);if(i=e,0<t){if(800<=++n)return arguments[0]}else n=0;return r.apply(void 0,arguments)}}(Ar?function(e,t){return Ar(e,"toString",{configurable:!0,enumerable:!1,value:Eu(t),writable:!0})}:nu);var wu=function(e,t){return Tu(Su(e,t,nu),e+"")},Au=wu(function(e,t){if(null==e)return[];var r=t.length;return 1<r&&vl(e,t[0],t[1])?t=[]:2<r&&vl(t[0],t[1],t[2])&&(t=[t[0]]),hu(e,mu(t,1),[])});var Du=function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1};function Iu(e){return e!=e}var xu=function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1};var ju=function(e,t,r){return t==t?xu(e,t,r):Du(e,Iu,r)};function Nu(e,t){return!!(null==e?0:e.length)&&-1<ju(e,t,0)}function ku(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}function Cu(){}var Ru=_n&&1/Bl(new _n([,-0]))[1]==1/0?function(e){return new _n(e)}:Cu;var Pu=function(e,t,r){var n=-1,i=Nu,o=e.length,a=!0,l=[],u=l;if(r)a=!1,i=ku;else if(200<=o){var s=t?null:Ru(e);if(s)return Bl(s);a=!1,i=Rl,u=new kl}else u=t?[]:l;e:for(;++n<o;){var c=e[n],d=t?t(c):c,c=r||0!==c?c:0;if(a&&d==d){for(var f=u.length;f--;)if(u[f]===d)continue e;t&&u.push(d),l.push(c)}else i(u,d,r)||(u!==l&&u.push(d),l.push(c))}return l};var Lu=function(e,t){return e&&e.length?Pu(e,lu(t)):[]},Bu=Object.prototype.hasOwnProperty;var Uu=function(e){if(null==e)return!0;if(Yr(e)&&(h(e)||"string"==typeof e||"function"==typeof e.splice||Lr(e)||zr(e)||Rr(e)))return!e.length;var t,r=Nn(e);if("[object Map]"==r||"[object Set]"==r)return!e.size;if(Gr(e))return!$r(e).length;for(t in e)if(Bu.call(e,t))return!1;return!0},Fu=Object.defineProperty,Ku=Object.getOwnPropertySymbols,Mu=Object.prototype.hasOwnProperty,zu=Object.prototype.propertyIsEnumerable,qu=(e,t,r)=>t in e?Fu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Vu=(e,t)=>{for(var r in t=t||{})Mu.call(t,r)&&qu(e,r,t[r]);if(Ku)for(var r of Ku(t))zu.call(t,r)&&qu(e,r,t[r]);return e},Wu={add({object:e,value:t}){A.isArr(e)&&t&&(t=K(t),e.push(t))},addByIndex({object:t,value:r,index:n}){var e;if(A.isArr(t)&&r){r=K(r);if(null==t[parseInt(n)]||0===Object.keys(t[parseInt(n)]).length&&(null==(e=t[parseInt(n)])?void 0:e.constructor)===Object){let e=new Array;e.push(r),t[parseInt(n)]=e}else{let e=t[parseInt(n)];e.push(r),t[parseInt(n)]=e}}},SortBy({object:e,iterate:t,orders:r}){return A.isArr(e)?vu(e,t,r):"object is not array"},clear({object:e}){A.isArr(e)&&(e.length=0)},removeByKey({object:t,key:r}){var n;if(A.isArr(t))for(let e=0;e<t.length;e++){if((null==(n=t[e])?void 0:n.key)===r)return void t.splice(e,1);"test"===B.env&&L.default.debug("false","color: red")}},removeByName({object:t,key:r,name:n}){var i;if(A.isArr(t))for(let e=0;e<t.length;e++){if((null==(i=t[e])?void 0:i[r])==n||""==(null==(i=t[e])?void 0:i[r]))return void t.splice(e,1);"test"===B.env&&L.default.debug("false","color: red")}},removeByValue({object:t,value:r}){if(A.isArr(t))for(let e=0;e<t.length;e++)if(t[e]==r)return void t.splice(e,1)},removeObjectByValue({object:t,values:r,value:n}){if(A.isArr(t))for(let e=0;e<t.length;e++)if(m(t[e],r)==n)return void t.splice(e,1)},removeById({object:t,id:r}){var n;if(A.isArr(t))for(let e=0;e<t.length;e++)if((null==(n=t[e])?void 0:n.id)==r)return void t.splice(e,1)},removeByIndex({object:e,index:t}){A.isArr(e)&&e.splice(t,1)},removeWeekByIndexs({object1:t,object2:r,index:n,duration:i}){var o,a;if(A.isArr(t)&&A.isArr(r)){for(let e=0;e<t.length;e++)(null==(o=t[e])?void 0:o.index)===n&&(null==(o=t[e])?void 0:o.duration)===i?t.splice(e,1):"test"===B.env&&L.default.debug("false","color: red");for(let e=0;e<r[n].length;e++)r[n][e]===i?null!=(a=r[n])&&a.splice(e,1):"test"===B.env&&L.default.debug("false","color: red")}},append({newMessage:e,messages:t}){A.isArr(t)&&e&&(e=K(e),t.push(e))},appendUnique({newMessage:r,messages:n,uniqueKey:i,currentBackgroundColor:o,backgroundColor:a,fontColor:l,currentFontColor:u}){if(r&&i){let t=!1;var e;n.forEach(e=>{e[i]==r[i]&&(t=!0)}),t||(e=K(r),n.push(e));for(let e=0;e<n.length/2;e++){var s=n[e];n[e]=n[n.length-e-1],n[n.length-e-1]=s}for(let e=0;e<n.length;e++)0==e?(n[e].backgroundColor=o,n[e].fontColor=u):(n[e].backgroundColor=a,n[e].fontColor=l)}},addColor({messages:t,id:r,currentBackgroundColor:n,backgroundColor:i,fontColor:o,currentFontColor:a}){var l;if(A.isArr(t))for(let e=0;e<t.length;e++)(null==(l=t[e])?void 0:l.id)==r?(t[e].backgroundColor=n,t[e].fontColor=a):(t[e].backgroundColor=i,t[e].fontColor=o)},has({object:t,value:r}){if(A.isArr(t))for(let e=0;e<t.length;e++)if(t[e]===r)return!0;return!1},judgeListLength({array:e,len:t}){return!!A.isArr(e)&&e.length===t},hasKey({object:t,key:r}){var n;if(A.isArr(t))for(let e=0;e<t.length;e++)if((null==(n=t[e])?void 0:n.key)===r||t[e][r])return!0;return!1},AddWeek({object:e,duration:t,location:r,index:n,key:i}){null==typeof n?L.default.debug("index is undefined"):null==typeof i?L.default.debug("key is undefined"):null==typeof t?L.default.debug("duration is undefined"):e[e.length]={duration:t,location:r,index:n,key:i}},push({newMessage:e,messages:t}){if(A.isArr(t))return e&&(e=K(e),t.unshift(e)),t},pushAny({newMessage:r,messages:n}){if(A.isArr(n)){if(r){let e=K(r),t=K(n);return h(e)?t.push(...e):t.push(e),t}return n}return[]},covertToJsonArray({array:t}){let r=[];if(A.isArr(t)){for(let e=0;e<t.length;e++)r.push({key:t[e]});return console.dir(r),r}return t+"is not an array"},getListLength({object:e}){return A.isArr(e)?null==(e=null==e?void 0:e.length)?void 0:e.toString():"0"},copyByKey({array1:t,array2:r,key:n}){var i;if(A.isArr(t)&&A.isArr(r))for(let e=0;e<t.length;e++)if((null==(i=t[e])?void 0:i.key)===n)return r.push(t[e]),r;return r},changeColorByKey({array:t,key:r,value:n}){var i;if(A.isArr(t)&&r)for(let e=0;e<t.length;e++)if((null==(i=t[e])?void 0:i.key)===r)return void(t[e].color=n)},convertToList({array:t,key:r}){var n;let i=[];if(A.isArr(t)&&r){for(let e=0;e<t.length;e++)i.push(null==(n=t[e])?void 0:n[r]);return i}},getByKey({array:e,key1:t,value:r,key2:n}){var i,o=K(e);if(A.isArr(o))for(let e=0;e<o.length;e++)if((null==(i=o[e])?void 0:i[t])===r)return null==(i=o[e])?void 0:i[n]},getIndex({array:e,key:t}){if(A.isArr(e))return e.indexOf(t)},getListByKey({array:t,keyId:r}){var n;let i=[];if(A.isArr(t)){for(let e=0;e<t.length;e++)i.push(null==(n=t[e])?void 0:n[r]);return i}},getConnection({array1:e,array2:t}){let r,n=[],i;return"string"==typeof e||"string"==typeof t?A.isArr(e)?(e.forEach(e=>{var t;i=5==(null==e?void 0:e.subtype)||4==(null==e?void 0:e.subtype),r={name:null==(t=null==e?void 0:e.name)?void 0:t.inviterName,category:null==(t=null==e?void 0:e.name)?void 0:t.inviterCategory,userId:null==e?void 0:e.evid,phone:null==(t=null==e?void 0:e.name)?void 0:t.inviterPhoneNumber,favorite:i,connectId:null==e?void 0:e.id,status:null==(t=null==e?void 0:e.name)?void 0:t.status},n.push(r)}),n):A.isArr(t)?(t.forEach(e=>{var t;i=5==(null==e?void 0:e.subtype)||3==(null==e?void 0:e.subtype),r={name:null==(t=null==e?void 0:e.name)?void 0:t.inviteeName,category:null==(t=null==e?void 0:e.name)?void 0:t.inviteeCategory,userId:null==e?void 0:e.bvid,phone:null==(t=null==e?void 0:e.name)?void 0:t.inviteePhoneNumber,favorite:i,connectId:null==e?void 0:e.id,status:null==(t=null==e?void 0:e.name)?void 0:t.status},n.push(r)}),n):[]:(e.forEach(e=>{var t;i=5==(null==e?void 0:e.subtype)||4==(null==e?void 0:e.subtype),r={name:null==(t=null==e?void 0:e.name)?void 0:t.inviterName,category:null==(t=null==e?void 0:e.name)?void 0:t.inviterCategory,userId:null==e?void 0:e.evid,phone:null==(t=null==e?void 0:e.name)?void 0:t.inviterPhoneNumber,favorite:i,connectId:null==e?void 0:e.id,status:null==(t=null==e?void 0:e.name)?void 0:t.status},n.push(r)}),t.forEach(e=>{var t;i=5==(null==e?void 0:e.subtype)||3==(null==e?void 0:e.subtype),r={name:null==(t=null==e?void 0:e.name)?void 0:t.inviteeName,category:null==(t=null==e?void 0:e.name)?void 0:t.inviteeCategory,userId:null==e?void 0:e.bvid,phone:null==(t=null==e?void 0:e.name)?void 0:t.inviteePhoneNumber,favorite:i,connectId:null==e?void 0:e.id,status:null==(t=null==e?void 0:e.name)?void 0:t.status},n.push(r)}),n)},getFavorites({object:e}){let t=[];return A.isArr(e)&&e.forEach(e=>{1==(null==e?void 0:e.favorite)&&t.push(e)}),t},getFirstItem({array:e}){if(A.isArr(e))return e[0]},concatArray({array1:e,array2:t,sortby:r,orders:n}){var i;return A.isArr(e)&&A.isArr(t)?r?(i=e.concat(t),vu(i,r,n||"desc")):e.concat(t):A.isArr(e)&&!A.isArr(t)?e:A.isArr(t)&&!A.isArr(e)?t:[]},isExist({array:e,phoneNumber:t}){let r=0;return!!A.isArr(e)&&(e.forEach(e=>{t===(null==(e=null==(e=e.name)?void 0:e.data)?void 0:e.phone)&&(r=1)}),1===r)},createBySubtype(e){return a=this,l=arguments,u=function*({subtypelist:e,createModel:t}){if(L.default.debug("test createBySubtype",{subtypelist:e,createModel:t}),A.isArr(e))for(const n of e){t&&(t.subtype=n);try{"test"===B.env&&L.default.info("%cCreate Edge Request","background: purple; color: white; display: block;",Vu({},t));var r=(yield B.level2SDK.edgeServices.createEdge(Vu({},t)))["data"];"test"===B.env&&L.default.info("%cCreate Edge Response","background: purple; color: white; display: block;",r)}catch(e){throw e}}},new Promise((t,r)=>{var n=e=>{try{o(u.next(e))}catch(e){r(e)}},i=e=>{try{o(u.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((u=u.apply(a,l)).next())});var a,l,u},WeekSchedule({planObject:o}){var a;if("test"==B._env&&L.default.debug("test WeekSchedule",o),null!=o&&null!=typeof o&&0!=o.length&&A.isArr(o)){let e=[],n,i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];for(let r=0;r<7;r++)if(0==Object.keys(o[r]).length)e.push({info:"not settings",weekDay:i[r]});else{n=o[r].length;let t="";for(let e=0;e<n;e++)t=t+" "+(null==(a=o[r])?void 0:a[e]);e.push({info:t,weekDay:i[r]})}return e}},concat({array1:e,array2:t}){if(A.isArr(e)&&A.isArr(t))return e.concat(t)},getIdByUserName({array:e,userName:r}){let n="";if(A.isArr(e))return e.forEach(e=>{var t;(null==(t=null==(t=null==e?void 0:e.name)?void 0:t.data)?void 0:t.fullName)===r&&(n=null==e?void 0:e.bsig)}),n},removeByArray({parentObject:r,subObject:n,key:i}){var o;if(A.isArr(r)&&A.isArr(n)){for(let t=0;t<n.length;t++)for(let e=0;e<r.length;e++)(null==(o=r[e])?void 0:o[i])===(null==(o=n[t])?void 0:o[i])&&r.splice(e,1);return r}},toggleStatus({object:e,key:t,flag:r}){A.isArr(e)&&e.forEach(e=>{e[t]=r})},toggleSelect({object:e,key:t,value:r,newKey:n,flag:i,type:o}){A.isArr(e)&&e.forEach(e=>{"Multi"===o?e[t]===r&&(e[n]=i):e[t]===r?e[n]=i:e[n]=!i})},getPage({array:n,pageCount:i,currentPage:e}){let o=[];if(A.isArr(n)&&n){var t=Math.ceil(n.length/i);for(let e=1;e<=t;e++){let t=(e-1)*i,r=[];for(let e=t;e<t+i&&void 0!==n[e];e++)r.push(n[e]);o.push(r)}}return o[e-1]},getPageIndex({array:e,pageCount:t,currentPage:r,select:n}){let i=Array.from(new Array(Math.ceil(e.length/t)+1).keys()).slice(1),o=xl(i,t),a=[];return o[r-1].forEach(e=>{let t={key:0,fontColor:"0x000000",backgroundColor:"0xFFFFFF"};n===e&&(t.fontColor="0xFFFFFF",t.backgroundColor="#003d68"),t.key=e,a.push(t)}),a},elementUnique({arr:e}){return Array.from(new Set(e))},addProvider({object:e,provider:t}){p(t,"name.basicInfo",{medicalFacilityName:"Me"}),p(t,"isSelected",!0);t=K(t);e.push(t)},handleData({Object:s,timeLimit:i=10,timeSpan:c="day",increaseColor:d="0x3DD598",decreaseColor:f="0xF0142F"}){if(A.isArr(s)){let o=864e5,a=("day"==c?o=+o:"week"==c?o*=7:"month"==c&&(o*=30),[]),l=[];var p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"];let u=new Date;for(let e=0;e<i;e++){let t,r,n;if("day"==c)t=new Date(u.getFullYear(),u.getMonth(),u.getDate()).getTime(),r=t+864e5,n=new Date(t).getFullYear()+"-"+new Date(t).getMonth()+"-"+new Date(t).getDate();else if("week"==c){let e=new Date(u.getTime()-24*u.getDay()*60*60*1e3);t=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime(),r=t+6048e5,n=new Date(t).getFullYear()+"-"+new Date(t).getMonth()+"-"+u.getDate()}else if("month"==c){let e=new Date(u.getTime()-24*(u.getDate()-1)*60*60*1e3);t=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime();var h=new Date(e.getFullYear(),e.getMonth(),0).getDate();r=t+24*h*60*60*1e3,n=new Date(t).getFullYear()+"-"+p[new Date(t).getMonth()]}let i=0;s.forEach(e=>{1e3*e.ctime>t&&1e3*e.ctime<r&&(i+=1)}),a.push(n),l.push(i),u=new Date(u.getTime()-o)}let e=l[0],t;t=0!=l[1]?100*(l[0]/l[1]-1):0;let r,n;return r=0<=t?(n=t.toFixed(2)+"% ↑",d):(n=(-t).toFixed(2)+"% ↓",f),L.default.debug({currentNum:e,currentRadio:t.toFixed(2),radioString:n,color:r}),{currentNum:e,currentRadio:t.toFixed(2),radioString:n,color:r,data_x:a,data_y:l}}},transformNull({dayObject:t}){if(A.isArr(t))for(let e=0;e<t.length;e++)0==Object.keys(t[e]).length&&(t[e]=null)},isEmpty({array:e}){let t=0;return e.forEach(e=>{null!=typeof e&&null!=e&&0!=e.length||t++}),7<=t},selectOneToArr({arr:t,key:r}){t&&!A.isArr(t)&&(t=[t]);let n=new Array;for(let e=0;e<t.length;e++){var i=m(t[e],r);n.push(i)}return n},matchInArray({arr:t,value:r,key:n,key1:i}){A.isArr(t)||(t=A.array(t));for(let e=0;e<t.length;e++){var o=m(t[e],n);if(console.log(o),o===r)return m(t[e],i)}},toString({arr:e}){return A.isFnc(null==e?void 0:e.toString)?e.toString():String(e)},getKeyByArray({array:e,path:t}){if(A.isArr(e)&&t){let r=t.split("."),n=[];return e.forEach(e=>{let t=e;r.forEach(e=>{t=null==t?void 0:t[e]}),n.push(t)}),n}},SelectKeyByArray({array:e,matchPath:r,selectpath:i,value:o}){if(A.isArr(e)&&r&&i&&o){let t=r.split("."),n=i.split(".");e.forEach(e=>{let r=e;if(t.forEach(e=>{r=null==r?void 0:r[e]}),r==o){let t=e;return n.forEach(e=>{t=null==r?void 0:r[e]}),t}})}},addSelect({array:e}){let t=K(e);return t.unshift("please select"),t},getObjectByArray({array:t,key:r,value:n}){var i;A.isArr(t)||(t=A.array(t));for(let e=0;e<t.length;e++)if((null==(i=t[e])?void 0:i[r])==n)return t[e]},checkElememtExist({objArr:e,values:t}){let r=[];return A.array(e).forEach(e=>{let n=[];(function e(t){for(var r in t)"number"==typeof t[r]||"string"==typeof t[r]?n.push(t[r]):e(t[r])})(e),r.push(!!n.includes(t))}),!!r.includes(!0)},splitTableList({arrObj:r,numX:n,numY:i}){var o=xl(r,n).length;if(0===o)return[[],o];{let e=xl(r,n)[i-1],t=[];return t.push(e,o),t}},isArrayEmpty({array:e=[]}){return 0===e.length},transformPage({array:e,type:t,dataKey:r}){let n={"New Patient Forms":"NewPatForm","COVID-19 Testing Consent - New Patient":"Cov19TestNewPat","COVID-19 Testing Consent Form":"Cov19TestForm","Pifzer-BioNTech Vaccine - First Dose":"PfizerVaccineFirDose","Pifzer-BioNTech Vaccine - Second Dose":"PfizerVaccineSecDose","Pfizer-BioNTech Vaccine - First Dose":"PfizerVaccineFirDose","Pfizer-BioNTech Vaccine - Second Dose":"PfizerVaccineSecDose","Moderna Vaccine Form - First Dose":"ModernaVaccineFirDose","Moderna Vaccine Form - Second Dose":"ModernaVaccineSecDose","Flu Vaccination Consent form 2020-2021(English)":"FluVaccinationConsentFormEnglish","Surgery Authorization":"SurgeryAuthorization","Financial Responsibility form":"FinancialForm","Flu Vaccination Consent Form":"FluVaccinationConsentForm"},i,o;return A.isArr(e)?(e.forEach(e=>{(i=m(e,r))&&(i=i.trim(),1!=(o=i.split(" ")).length?e.pageName=n[i]+""+t+"Page1":e.pageName=i+""+t+"Page1")}),e):[]},transformArray({array:e}){let t=[];return A.isArr(e)?(e.forEach(e=>{t.push({key:e})}),t):[]},ComparisonSettingProperties({objArrOne:e=[],strOnePath:r,objArrTwo:n=[],strTwoPath:i,strValue:o,newValue:a,status:l="status"}){return e.forEach(t=>{n.forEach(e=>{m(t,r)===m(e,i)&&p(e,o,a||m(t,l))})}),n},uniqueByObjectKey({objArr:e,path:t}){return Lu(e,t)},allComplete(t){let e=!0;return!(e=A.isArr(t)?["","Select","-- --"].some(e=>t.includes(e)):e)},formatStringFill({strArr:e=[],sfill:t}){return Array.isArray(e)?e.filter(e=>{if(e)return e}).join(t):""},findSelectAtl({arrObject:e,value:t,keyAtl:r}){return e.some(e=>(null==e?void 0:e[r])===t)},filterByTag({sourceDoc:e,tagCategory:r,tagName:n}){let i=[];return"All"===n?e:(e.forEach(e=>{var t;null==e?L.default.warn("array.filterTag itemDoc is undefined"):null==(null==e?void 0:e.name)?L.default.warn("array.filterByTag itemDoc.name is underfined"):null==(null==(t=null==e?void 0:e.name)?void 0:t.data)?L.default.warn("array.filterByTag itemDoc.name.data is underfined"):null==(null==(t=null==e?void 0:e.name)?void 0:t.data[r])?L.default.warn("array.filterByTag itemDoc.name.data.tag is underfined"):(null==(t=null==(t=null==(t=null==e?void 0:e.name)?void 0:t.data)?void 0:t[r])?void 0:t.name)===n&&i.push(e)}),i)},initMeetingStyle({sourceEdgeList:e}){let t=K(e);return A.isArr(t)&&t.forEach(e=>{(null!=e&&e.tage||0==(null==e?void 0:e.tage))&&("test"===B.env&&console.error("tage: "+e.tage),p(e,"name.statusStyle",{borderColor:"#dededf",boxShadow:"1px 1px 4px 1px #dededf"}),0==(e.tage>>1&1)?p(e,"name.statusStyle",{borderColor:"0xfc3a3a",boxShadow:"1px 1px 4px 1px #fc3a3a"}):!+m(e,"name.fee")||1==(e.tage>>5&1)?p(e,"name.statusStyle",{borderColor:"#dededf",boxShadow:"1px 1px 4px 1px #dededf"}):0==(e.tage>>4&1)&&p(e,"name.statusStyle",{borderColor:"0xfc3a3a",boxShadow:"1px 1px 4px 1px #fc3a3a"}))}),t},filterArrayByPath({objArr:e,path:t,compareStr:r=[]}){let n=[];return null!=e&&e.forEach(e=>{r.includes(m(e,t))&&n.push(e)}),n},getValueByKey({array:e,key1:t,value:r,key2:n}){var i=K(e);if(A.isArr(i))for(let e=0;e<i.length;e++)if(m(i[e],t)==r)return m(i[e],n)},checkType({objArr:e,path:t}){return e.forEach(e=>{m(e,t)%2==0&&p(e,t,m(e,t)+1)}),e},addWeekDuration({objArr:t,index:r,strPath:n,key:i,location:o}){var a;if(0===t.length)return t.push({duration:[n],key:i,index:r}),t;for(let e=0;e<t.length;e++)if((null==(a=t[e])?void 0:a.index)===r)return t[e].duration.push(n),t[e].key=i,t[e].location=o,t[e].index=r,t;return t.push({duration:[n],key:i,index:r}),t},removeValueInDoubleList({objArr:t,value:r,key:n,objArr1:i,index:o}){var a,e;let l;for(let e=0;e<(null==(a=t[o])?void 0:a[n].length);e++)console.error(t[o][n][e]),(null==(a=null==(a=t[o])?void 0:a[n])?void 0:a[e])==r&&(t[o][n].splice(e,1),l=e);if("0"==t[o][n].length&&t.splice(o,1),null!=(e=i[l])&&e.length){let e=0;if(e<i[l].length)return i[l].splice(e,1),void(i[l].length||(i[l]=null))}},formaDuration({arr:e,indexParam:r,keyParam:n,strParam:i}){let o=[],a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return e.length&&e.forEach((e,t)=>{A.isArr(e)&&(o[t]={},p(o[t],i,e),p(o[t],r,t),p(o[t],n,a[t]))}),o=o.filter(e=>e)},formatProfile({objArr:e}){return e.forEach(e=>{let t=null==(e=null==e?void 0:e.name)?void 0:e.data;t.version||(t.basicInfo={},t.contactInfo={},p(t,"basicInfo.avatar",t.avatar),p(t,"basicInfo.firstName",t.firstName),p(t,"basicInfo.middleName",t.middleName),p(t,"basicInfo.lastName",t.lastName),p(t,"basicInfo.dateOfBirth",t.dateOfBirth||t.birth),p(t,"basicInfo.gender",t.gender),p(t,"basicInfo.fullName",t.fullName),p(t,"basicInfo.phone",t.phone),p(t,"basicInfo.userName",t.userName),p(t,"basicInfo.email",t.email),p(t,"basicInfo.address",{}),p(t,"basicInfo.address.secondLine",null==(e=null==t?void 0:t.Address)?void 0:e.line2),p(t,"contactInfo.address.city",null==(e=null==t?void 0:t.Address)?void 0:e.city),p(t,"contactInfo.address.state",null==(e=null==t?void 0:t.Address)?void 0:e.state),p(t,"contactInfo.address.zip",null==(e=null==t?void 0:t.Address)?void 0:e.zip),p(t,"contactInfo.address.St",null==(e=null==t?void 0:t.Address)?void 0:e.St)),p(t,"basicInfo.fullName",null!=(e=null==t?void 0:t.basicInfo)&&e.middleName?(null==(e=null==t?void 0:t.basicInfo)?void 0:e.firstName)+" "+(null==(e=null==t?void 0:t.basicInfo)?void 0:e.middleName)+(null==(e=null==t?void 0:t.basicInfo)?void 0:e.lastName):(null==(e=null==t?void 0:t.basicInfo)?void 0:e.firstName)+" "+(null==(e=null==t?void 0:t.basicInfo)?void 0:e.lastName))}),e},setPropertyInterlacedChange({arrIn:t,arr:r,valueArr:n,errorArr:i}){if(Uu(t)||Uu(r))return[];for(let e=0;e<t.length;e++)for(var o in r)e%2==0?t[e][r[o]]=n[o]:t[e][r[o]]=i[o];return t},setFormJumpPage({objArry:e,docFormObj:n}){return JSON.parse(JSON.stringify(e)).map((t={})=>{var e,r;return"Admin"==(null==(e=null==(e=null==(e=null==t?void 0:t.name)?void 0:e.data)?void 0:e.classTag)?void 0:e.name)?null!=(e=null==n?void 0:n.Admin)&&e.map(e=>{t.type.toString().substr(0,t.type.toString().length-1)==e.type.toString().substr(0,e.type.toString().length-1)&&(1==(1&t.type)?t.pageName=e.releaseJump:t.pageName=e.privateJump)}):"Provider"==(null==(e=null==(e=null==(e=t.name)?void 0:e.data)?void 0:e.classTag)?void 0:e.name)?n.Provider.map(e=>{t.type.toString().substr(0,t.type.toString().length-1)==e.type.toString().substr(0,e.type.toString().length-1)&&(1==(1&t.type)?t.pageName=e.releaseJump:t.pageName=e.privateJump)}):null!=(r=null==(e=n.Patient)?void 0:e.map)&&r.call(e,e=>{t.type.toString().substr(0,t.type.toString().length-1)==e.type.toString().substr(0,e.type.toString().length-1)&&(1==(1&t.type)?t.pageName=e.releaseJump:t.pageName=e.privateJump)}),t})},sortArray({arr:e}){return h(e)?Au(e):"arr is not array"},splitArrString({arr:e}){let n=[];return e.forEach(e=>{var t=e,e=e.split(","),[e,r]=[e[0],e[1]],e={dayConcat:e,HourConcat:r,concat:t};n.push(e)}),n},keepLatestDoc({docList:e,path:t}){return Lu(e,t)},setMeetingStatus({object:e,type:t="subtype",tage:r="tage"}){return Uu(e)?[]:(e&&e.forEach(e=>{(3840&m(e,r))>>8==1?(e.status="Completed",e.fontColor="#999999",e.textDeco="none"):6==(255&m(e,t))||100==(255&m(e,t))?(e.status="Approved",e.fontColor="#30b354",e.textDeco="none"):11==(255&m(e,t))?(e.status="Canceled",e.fontColor="#e24445",e.textDeco="underline"):15==(255&m(e,t))&&(e.status="Changed",e.fontColor="#f8ae29",e.textDeco="none")}),e)},judgeArr({array:e,len:t}){return!!A.isArr(e)&&e.length<=t},ChangeAnItemInArray({array:r,path:n,obj:i}){A.isArr(r)&&r.forEach((e,t)=>{e[n]===i[n]&&(r[t]=i)})},GetSomeData({dataArray:e,index:t=-1}){return e.at(t)},arrTageTypeIsValid({docs:t,local:r,binary:n}){let i=[];for(let e=0;e<t.length;e++)(t[e].tage>>r-1&1)!==n&&i.push(t.slice(e,e+1)[0]);return i},judgeKeyAndReturnValue({objArr:e,pathKey:r,pathValue:n,valueArr:i}){let o=[];return null!=e&&e.forEach(e=>{var t;0!==(null==(t=null==e?void 0:e[n])?void 0:t.length)&&!i.includes(null==e?void 0:e[n])||o.push(null==e?void 0:e[r])}),o},objArrFormatStringFill({objArr:e=[],sfill:t}){if(Array.isArray(e)){let r=[];return e.forEach(e=>{for(var t in e)""!==e[t]&&r.push(e[t])}),r.join(t)}return""},getSpecifiedObject({objArr:e,path:t,value:r}){let n=[];return null!=e&&e.forEach(e=>{m(e,t)===r&&n.push(e)}),n},setObjectByKey({objectArr:e,keyOne:t,keyTwo:r,valueOne:n,valueTwo:i}){return null!=e&&e.forEach(e=>{m(e,t)===n&&p(e,r,i)}),e},recoverModifiers({array:e}){if(A.isArr(e)){let t=[],r=1;return e.forEach(e=>{t.push({index:"Mode "+r,value:e}),r++}),t}return[]},folderMatching({parentFiles:e,childFiles:r}){let n=[],i=[];return null!=e&&e.forEach(t=>{null!=r&&r.forEach(e=>{m(t,"name.data.hashCode")===m(e,"name.data.folderHashCode")&&i.push(m(e,"name.data"))}),n.push({displayStyle:"none",category:m(t,"name.data.category"),hashCode:m(t,"name.data.hashCode"),secondList:i}),i=[]}),n},containingValue({object:e,value:t,key:r}){return null==e?void 0:e.some(e=>m(e,r)===t)},setList({arr:e,level:r,title:n}){return e.forEach(t=>{var e;1===r?t.title===n&&("block"===t.hasChildren?(t.childList[0].backgroundColor="0x1871b3",t.isExpand="block"):"none"===t.hasChildren&&(t.backgroundColor="0x1871b3")):2===r&&null!=(e=t.childList)&&e.forEach(e=>{e.title===n&&(e.backgroundColor="0x1871b3",t.isExpand="block")})}),e},extractWithType({docList:e,type:t}){return e.filter(e=>e.type===t?e:void 0)},getOrReplaceAnArrayItem({strArr:e,tag:t,index:r,value:n}){return t?(n?e.splice(r,1,n):e.splice(r,1),e):e[e.length-1]}},Gu=Math.max,Hu=Math.min;var Ju=function(e,t,r){return e>=Hu(t,r)&&e<Gu(t,r)};var $u=function(e,t,r){return t=wl(t),void 0===r?(r=t,t=0):r=wl(r),e=Tl(e),Ju(e,t,r)},Yu={inRange({number:e,start:t,end:r}){return e==t||e==r||$u(e,t,r)},multiply({number:e,multiple:t}){return e&&t?e*t:0},OctToBin({number:e}){return e?e.toString(2).toString():0},getAuthority({authSubtype:e,authList:a}){let l={};return e&&e.forEach(e=>{let t=parseInt(e.toString(16)),r=parseInt((t/1e4).toString()),n=t%10,i="",o=n.toString(2).split("").map(e=>"1"===e);Object.keys(a).forEach(e=>{a[e]==r&&(i=e)}),l[i]={invite:o[0],edit:o[1],review:o[2]}}),l},addition({num:e,step:t}){return L.default.debug("test addition",{num:e,step:t}),(e=parseInt(e))+(t=parseInt(t))},Subtraction({num:e,step:t}){return(e=parseInt(e))-(t=parseInt(t))},less({num1:e,num2:t}){return e<t},inhx({intHex:e,index:t,hex:r}){return((e="string"==typeof e?parseInt(e):e)>>t-1&1)!==r&&(1===r?e+=Math.pow(2,t-1):e-=Math.pow(2,t-1)),e},hexAnd({intOne:e,hexTwo:t}){return e&t},hexOr({intOne:e,hexTwo:t}){return e|t},hx({docGroup:n,localArr:i,binaryArr:o}){if(i.length!==o.length)return!1;{let r,e=[];for(let t=0;t<n.length;t++){for(let e=r=0;e<i.length&&(n[t].type>>i[e]-1&1)===o[e];e++)r++;r===i.length&&e.push(n[t])}return e}},typeIsValid({docType:r,localArr:n,binaryArr:i}){if(n.length!==i.length)return!1;{let t;for(let e=t=0;e<n.length&&(r>>n[e]-1&1)===i[e];e++)t++;return t===i.length}},formValid({docData:e}){for(const t in e)if(e.hasOwnProperty(t)&&(null===e[t]||""===e[t]))return!1;return!0},transformSubtype({subtype:e,addition:t}){return e&&t?(e=parseInt(e))-(255&e)+t:0},judgeNumber({num:e}){return/^(\-|\+)?\d+(.\d+)?$/.test(e)},pagingFax({value1:e,value2:t}){e=parseInt(e),t=parseInt(t);return Math.ceil(e/t)},betweenTwoNumbers({figure:e,hexadecimal:t,compareArr:r}){return!!r.includes(e&t)}};function Xu(e){return Ge(e)&&"[object RegExp]"==We(e)}var j=Y&&Y.isRegExp,Qu=j?Mr(j):Xu;var Zu=function(e,t,r){return r&&"number"!=typeof r&&vl(e,t,r)&&(t=r=void 0),(r=void 0===r?4294967295:r>>>0)?(e=Ye(e))&&("string"==typeof t||null!=t&&!Qu(t))&&(!(t=$e(t))&&Ie(e))?Ae(ke(e),0,r):e.split(t,r):[]},es={currentDateTime(){return Date.now()},getDate(){return(new Date).getDate()},getMonth(){return(new Date).getMonth()+1},getYear(){return(new Date).getFullYear()},getTimezoneOffset(){return(new Date).getTimezoneOffset().toString()},getNowLocalTime(){return new Date((new Date).toLocaleDateString()).getTime()},getNowLocalUnixTime(){return Math.ceil((new Date).getTime()/1e3)},getTime(){var e=(new Date).toString();return Date.parse(e)/1e3},stampToDate(e){return new Date(1e3*parseInt(e))},stampToTime(e){return e?(e=new Date(1e3*parseInt(e)).toString().split(" ")[4].split(":"),parseInt(e[0])<12?`${e[0]}:${e[1]}AM`:`${parseInt(e[0])-12}:${e[1]}PM`):"timeStamp is null"},stampToDay({timeStamp:t}){if(t){t=parseInt(t);let e=new Date(1e3*t);return{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}}},getTimeStampOfDate({date:t}){let e={start:0,end:0},r;if(-1===t.indexOf("-")){let e=t.split("/");e[0]=parseInt(e[0])-1,r=new Date(e[2],e[0],e[1])}else{let e=t.split("-");e[1]=parseInt(e[1])-1,r=new Date(e[0],e[1],e[2])}return e.start=Date.parse(r.toString())/1e3,e.end=e.start+86400,e},LoopToGenerate({span:e}){let t=0,r=[];for(;t<=1440;)r.push((n=t,o=i=void 0,n<780?(i=n%60,12==(o=Math.floor(n/60))?`${(""+o).slice(-2)}:${("0"+i).slice(-2)}PM`:`${("0"+o).slice(-2)}:${("0"+i).slice(-2)}AM`):(o=(n-720)%60,12==(i=Math.floor((n-720)/60))?`${("0"+i).slice(-2)}:${("0"+o).slice(-2)}AM`:`${("0"+i).slice(-2)}:${("0"+o).slice(-2)}PM`))),t+=parseInt(e);var n,i,o;return r[r.length-1]="11:59PM",r},calendarArray({year:o,month:a,today:l}){if(o&&a&&l){o=parseInt(o),a=parseInt(a);let t=[],e=o%4==0&&o%100!=0||o%400==0,r=[31,28,31,30,31,30,31,31,30,31,30,31],n=(r[1]=e?29:28,new Array(42).fill(0)),i=new Date(o,a-1,1).getDay();for(let e=i,t=1;e<i+r[a-1];e++,t++)n[e]=t;for(let e=i-1,t=0;0<=e&&0!=i;e--,t++)n[e]="";for(let e=i+r[a-1],t=1;e<42;e++,t++)n[e]="";for(let e=0;e<n.length;e++)n[e]==l?t.push({key:n[e],color:"#003d68",backgroundColor:"#d7e2ea"}):t.push({key:n[e],color:"#517086",backgroundColor:"#ffffff"});return t}},splitByTimeSlot({object2:e,timeSlot:r,year:t,month:n,day:i}){let o=new Date(t,n-1,i),a=o.getTime()/1e3+86400,l,u={morning:[],afternoon:[]};return(new Date).valueOf(),A.isArr(e)&&e.forEach(t=>{if(A.isObj(t)&&(t.stime<o.getTime()/1e3&&t.etime>o.getTime()/1e3&&(t.stime=o.getTime()/1e3),t.stime<a&&t.etime>a&&(t.etime=a),r)){let e=0;for(;l={stime:t.stime+e*r*60,etime:t.stime+(e+1)*r*60,showTime:f.default(1e3*(t.stime+e*r*60)).format("LT"),refid:t.id,bvid:t.bvid},L.default.debug(o.getTime()),t.etime-l.stime<60*r||((-1!=l.showTime.indexOf("AM")?u.morning:u.afternoon).push(l),e+=1),l.etime<=t.etime&&l.etime<=a;);}}),u},splitTime({object2:e,timeSlot:r,year:t,month:n,day:i,isSplitCurrent:o=!1}){L.default.debug("test splitTime",{object2:e,timeSlot:r,year:t,month:n,day:i,isSplitCurrent:o});let a,l,u=(o&&(a=new Date,l=a.getTime()/1e3),new Date(t,n-1,i)),s=u.getTime()/1e3+86400,c,d=[];return A.isArr(e)&&e.forEach(t=>{if(A.isObj(t)&&(t.stime<u.getTime()/1e3&&t.etime>u.getTime()/1e3&&(t.stime=u.getTime()/1e3),t.stime<s&&t.etime>s&&(t.etime=s),r)){let e=0;for(;c={stime:t.stime+e*r*60,etime:t.stime+(e+1)*r*60,showTime:f.default(1e3*(t.stime+e*r*60)).format("LT"),refid:t.id,bvid:t.bvid},t.etime-c.stime<60*r||(c.showTime.indexOf("AM"),(!o||c.stime>l)&&d.push(c),e+=1),c.etime<=t.etime&&c.etime<=s;);}}),d},ShowTimeSpan(e){if(A.isObj(e)&&(e.hasOwnProperty("stime")&&e.hasOwnProperty("etime")))return f.default(1e3*e.stime).format("LT")+" - "+f.default(1e3*e.etime).format("LT")},ShowTimeDate(i){if(A.isObj(i)&&i.hasOwnProperty("stime")&&i.hasOwnProperty("etime")){let e=new Date(1e3*i.stime),t=e.getFullYear(),r=9<e.getMonth()+1?e.getMonth()+1:"0"+(e.getMonth()+1),n=e.getDate()<10?"0"+e.getDate():""+e.getDate();return r+"-"+n+"-"+t}},ShowTimeDateUS(i){if(A.isObj(i)&&i.hasOwnProperty("stime")&&i.hasOwnProperty("etime")){let e=new Date(1e3*i.stime),t=e.getFullYear(),r=9<e.getMonth()+1?e.getMonth()+1:"0"+(e.getMonth()+1),n=e.getDate()<10?"0"+e.getDate():""+e.getDate();return r+"-"+n+"-"+t}},ShowTimeSpanFormat_us(a){if(A.isObj(a)&&a.hasOwnProperty("stime")&&a.hasOwnProperty("etime")){let e=new Date(1e3*a.stime),t=e.getFullYear(),r=10<=e.getMonth()+1?e.getMonth()+1:"0"+(e.getMonth()+1),n=e.getDate()<10?"0"+e.getDate():""+e.getDate(),i=f.default(1e3*a.stime).format("LT"),o=f.default(1e3*a.etime).format("LT");return r+"-"+n+"-"+t+" "+i+"-"+o}},minicalendarArray({year:n,month:i,today:o,middleDay:t,span:r,color:a,backgroundColor:l,todayColor:u,todayBackgroundColor:s}){L.default.debug("test minicalendarArray",{year:n,month:i,today:o,middleDay:t,span:r}),t=parseInt(t),r=parseInt(r),n=parseInt(n),i=parseInt(i);let c=["SU","MO","TU","WE","TH","FR","SA"],d=[],e=n%4==0&&n%100!=0||n%400==0,f=[31,28,31,30,31,30,31,31,30,31,30,31],p=(f[1]=e?29:28,Math.ceil(-r/2));for(let e=1;e<=r;e++){let r=t+p;if(o==r){let e=new Date(n,i,r),t=c[e.getDay()];d.push({key:o,week:t,color:u,backgroundColor:s})}else if(r<1){r+=f[i-1];let e=new Date(n,i,r),t=c[e.getDay()];d.push({key:r,week:t,color:a,backgroundColor:l})}else if(r>f[i-1]){r-=f[i-1];let e=new Date(n,i,r),t=c[e.getDay()];d.push({key:r,week:t,color:a,backgroundColor:l})}else{let e=new Date(n,i,r),t=c[e.getDay()];d.push({key:r,week:t,color:a,backgroundColor:l})}p+=1}return d},loopMonth({month:t,step:r}){if(t=parseInt(t),r=parseInt(r),t&&r){let e=t+r;return 12<e?e-=12:e<1&&(e+=12),e}},miniWeeklyCalendarArray({year:u,month:s,today:c,markDay:d,color:f,backgroundColor:p,todayColor:h,todayBackgroundColor:v,currentDateTime:y,pastTimeColor:g=null}){if("string"!=typeof u&&"string"!=typeof s&&"string"!=typeof c&&"string"!=typeof d&&u&&s&&c&&d){c=parseInt(c),u=parseInt(u),s=parseInt(s),d=parseInt(d);let t=[],r=["Su","Mo","Tu","We","Th","Fr","Sa"];const m=new Date(u,s-1,d);let e=m.getDay(),n=new Date(m.getTime()-24*e*60*60*1e3),i,o,a;y&&(u=y.split("-"),o=parseInt(u[0]),a=parseInt(u[1]),i=parseInt(u[2]));let l;g&&(l=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()));for(let e=0;e<7;e++){let e={year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate(),weekDay:r[n.getDay()],color:f,backgroundColor:p};g&&l&&(null==l?void 0:l.getTime())>(null==n?void 0:n.getTime())&&(e.color=g),!y&&(null==n?void 0:n.getDate())==c&&(e.color=h)&&(e.backgroundColor=v),y&&(null==n?void 0:n.getDate())==i&&n.getMonth()+1==a&&n.getFullYear()==o&&(e.color=h)&&(e.backgroundColor=v),t.push(e),n=new Date(n.getTime()+864e5)}return t}},NextWeek({year:e,month:t,day:r}){L.default.debug("test NextWeek2",{year:e,month:t,day:r});let n=new Date(e,t-1,r);e={year:(n=new Date(n.getTime()+864e5)).getFullYear(),month:n.getMonth()+1,day:n.getDate()};return L.default.debug("test NextWeek2",e),e},LastWeek({year:e,month:t,day:r}){L.default.debug("test lastweek1",{year:e,month:t,day:r});let n=new Date(e,t-1,r);e={year:(n=new Date(n.getTime()-864e5)).getFullYear(),month:n.getMonth()+1,day:n.getDate()};return L.default.debug("test lastweek2",e),e},AddHeightByTimeSpan({object:e}){if(A.isArr(e))return L.default.debug("test AddHeightByTimeSpan",e),e.forEach(e=>{let t=(parseInt(e.etime)-parseInt(e.stime))/60;100<=(t=1.5*t<20?20:1.5*t)&&(t=100),e.height=t+"px"}),e},ShowRightTime({year:a,month:l,day:u,formatType:t=""}){if("string"!=typeof a&&"string"!=typeof l&&"string"!=typeof u&&a&&l&&u){if(""==t||null==typeof t){let e=(a=parseInt(a))+"-"+(l=parseInt(l))+"-"+(u=parseInt(u)),t=new Date(e).valueOf(),r=a+"-"+l+"-"+(u+1),n=new Date(r).valueOf(),i=parseInt(t.toString().substr(0,10)),o=parseInt(n.toString().substr(0,10));return[i,o]}if("string"==typeof t){u<10&&(u="0"+u),l<10&&(l="0"+l),t.toUpperCase();let e=t.replace("Y",a);return e=(e=e.replace("M",l)).replace("D",u)}}},ShowLeftTime({year:a,month:l,day:u,formatType:t=""}){if("string"!=typeof a&&"string"!=typeof l&&"string"!=typeof u&&a&&l&&u){if(""==t||null==typeof t){let e=(a=parseInt(a))+"-"+(l=parseInt(l))+"-"+(u=parseInt(u)),t=new Date(e).valueOf(),r=a+"-"+l+"-"+(u+1),n=new Date(r).valueOf(),i=parseInt(t.toString().substring(0,10)),o=parseInt(n.toString().substr(0,10));return[i,o]}if("string"==typeof t){u<10&&(u="0"+u),l<10&&(l="0"+l),t.toUpperCase();let e=t.replace("Y",a);return e=(e=e.replace("M",l)).replace("D",u)}}},ShowDateByNumber({year:r,month:n,day:i,formatType:t="",abbreBool:o=!1}){if("test"===B.env&&L.default.debug("test ShowDateByNumber",{year:r,month:n,day:i}),"string"!=typeof r&&"string"!=typeof n&&"string"!=typeof i&&r&&n&&i){if(""==t||null==typeof t){r=parseInt(r),n=parseInt(n),i=parseInt(i);let e=new Date(r,n-1,i),t=["January","February","March","April","May","June","July","August","September","October","November","December"];return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()]+" "+(o?t[n-1].slice(0,3):t[n-1])+" "+i+","+r}if("string"==typeof t){i<10&&(i="0"+i),n<10&&(n="0"+n),t.toUpperCase();let e=t.replace("Y",r);return e=(e=e.replace("M",n)).replace("D",i)}}},TransformWeekDate({object:e}){if(A.isArr(e)){L.default.debug("test TransformWeekDate",e);let u=[];return e.forEach(e=>{let t=new Date,n=t.getFullYear(),i=t.getMonth(),o=t.getDay(),a,l,r=(e.duration.split("-").forEach((r,e)=>{if(-1!=r.indexOf("AM")){let e=(r=r.replace("AM","")).split(":"),t;r=(t=12==parseInt(e[0])?parseInt(e[0])+12:parseInt(e[0]))+":"+e[1]}else if(-1!=r.indexOf("PM")){let e=(r=r.replace("PM","")).split(":"),t;r=(t=12==parseInt(e[0])?parseInt(e[0]):parseInt(e[0])+12)+":"+e[1]}0==e?a=n+"/"+i+"/"+o+" "+r:l=n+"/"+i+"/"+o+" "+r}),{itemStyle:{normal:{color:"#2988E65f"}},value:[]});r.value[0]=6-e.index,r.value[1]=a,r.value[2]=l,u.push(r)}),{legend:{bottom:"1%",selectedMode:!1,textStyle:{color:"#000"}},grid:{left:"3%",right:"3%",top:"1%",bottom:"10%",containLabel:!0},xAxis:{type:"time",interval:36e5,axisLabel:{formatter:function(e){var e=new Date(e);if(e.getHours()%4==0)return e.getHours()+":"+(e=e.getMinutes(),e=parseInt(e)<10?"0"+e:e)}}},yAxis:{data:["SA","FR","TH","WE","TU","MO","SU"]},series:[{type:"custom",renderItem:function(e,t){var r=t.value(0),n=t.coord([t.value(1),r]),r=t.coord([t.value(2),r]);return{type:"rect",shape:echarts.graphic.clipRectByRect({x:n[0],y:n[1]-12,width:r[0]-n[0],height:24},{x:e.coordSys.x,y:e.coordSys.y,width:e.coordSys.width,height:e.coordSys.height}),style:t.style()}},encode:{x:[1,2],y:0},data:u}]}}},transformMonth({month:e,flag:t=1}){return 2==t?{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12}[e]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e-1]},transformYear({year:e}){return parseInt(e)},getDurationByMinute({stime:e,etime:t}){return(t-e)/60},startMeeting({stime:e}){return 1e3*(e-900)<=(new Date).getTime()},transformSelectWeek({object:i}){var o;if(A.isArr(i)){let e=[],r=[],n=["Su","M","T","W","Th","F","Sa"];for(let t=0;t<7;t++)0===Object.keys(i[t]).length&&i[t].constructor===Object||0===i[t].length&&(null==(o=i[t])?void 0:o.constructor)===Array||(e.push({index:t,key:n[t],availableTime:{timeStart:"",timeEnd:""}}),i[t].forEach(e=>{r.push({duration:e,location:"",index:t,key:n[t]})}));return{selectWeek:e,addWeek:r}}},isType({parameter:e,type:t}){return L.default.debug("test isType",{parameter:e,type:t}),typeof e==t},getQuarterStartMonth(e){let t=0;return(new Date(e).getMonth()<3||12==new Date(e).getMonth())&&(t=0),2<new Date(e).getMonth()&&new Date(e).getMonth()<6&&(t=3),5<new Date(e).getMonth()&&new Date(e).getMonth()<9&&(t=6),t=8<new Date(e).getMonth()?9:t},getWeekEndDate(e){let t=new Date(e);return new Date(t.getFullYear(),t.getMonth(),t.getDate()+(7-(0===t.getDay()?7:t.getDay()))).valueOf()/1e3},getMonthEndDate(e){let t=new Date(1e3*e);return new Date(t.getFullYear(),t.getMonth(),new Date(t.getFullYear(),t.getMonth(),0).getDate()).valueOf()/1e3},getQuarterEndDate(e){let t=0,r=new Date(1e3*e),n=new Date(r).getMonth()+1,i=r.getFullYear();L.default.debug(n),n<3&&(t=0),2<n&&n<6&&(t=3),5<n&&n<9&&(t=6),8<n&&n<=11&&(t=9),12===n&&(t=0,i++);e=t+2;return L.default.debug(t),new Date(i,e-1,new Date(r.getFullYear(),e,0).getDate()).valueOf()/1e3},compareTime({startTime:e,endTime:t}){var r=new Date,e=e.split(/[A-Z]{2}/)[0].split(":"),t=t.split(/[A-Z]{2}/)[0].split(":");return r.setHours(e[0],e[1])<r.setHours(t[0],t[1])},DateCompare({startTime:e,endTime:t}){let r=new Date,n=e.substr(-2,2),i=t.substr(-2,2),o=Zu(e.substring(0,e.length-2),":",2),a=Zu(t.substring(0,t.length-2),":",2);return L.default.debug(a,o),n===i?"AM"===n?r.setHours(+o[0],+o[1])<r.setHours(+a[0],+a[1]):"PM"===n?r.setHours(+o[0]+12,+o[1])<r.setHours(+a[0]+12,+a[1]):void 0:"AM"===n&&"PM"===i||("PM"!==n||"AM"!==i)&&void 0},generateYear({last:t=30,next:r=10}){let e=(new Date).getFullYear(),n=[],i=e-t;for(let e=0;e<t+r;e++)n.push(i.toString()),i++;return n},formatData(n){if((n*=1e3)>=new Date((new Date).toLocaleDateString()).getTime()){var i=new Date(n);let e=i.getHours(),t=i.getMinutes(),r=12<=e?"PM":"AM";return(e=(e%=12)||12)+":"+(t=t<10?"0"+t:t)+" "+r}return new Date(n).toDateString().split(" ")[1]+" "+new Date(n).toDateString().split(" ")[2]},getMonthString(){return["December","November","October","September","August","July","June","May","April","March","February","January"].splice(11-(new Date).getMonth(),12)},formatDataPro({date:e,separator:t,retentionOptions:r=!0}){10===e.toString().length&&(e=1e3*+e);let n=new Date(+e),i=""+n.toLocaleString("en-US",{month:"2-digit"})+t+n.toLocaleString("en-US",{day:"2-digit"})+t+n.getFullYear(),o=""+n.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});return r?i+" "+o:i},checkUnder18({date:e}){return((new Date).getTime()-new Date(e).getTime())/31536e6<18},timeRange({queryType:e,stime:t,timeStart:r=-1,timeEnd:n=-1}){var i=(new Date).getTime()/1e3;if(e&&t)switch(e){case 1:return 60*r<t-i;case 2:return t-i<60*n;case 3:return t-i<60*n&&60*r<t-i}},compareDate({comTime:t,pareTime:e,timeStart:r="availableTime.timeStart",timeEnd:n="availableTime.timeEnd",duration:i="duration",indexTime:o="index",fomatTime:a=["hh:mm A"]}){if(!e||!e.length)return!0;let l=m(t,r),u=e=>{var t=e.split("-")[0],e=e.split("-")[1];return new Date(f.default(l,a))>=new Date(f.default(e,a))||new Date(f.default(s,a))<=new Date(f.default(t,a))},s=m(t,n);return e.every(e=>{if(m(t,o)!==m(e,o))return!0;if(oa.isArray(m(e,i)))return m(e,i).every(u);e=m(e,i);return u(e)})},JudgmentOrderTime(){return new Date((new Date).getFullYear(),6,1).getTimezoneOffset()!==new Date((new Date).getFullYear(),12,1).getTimezoneOffset()},getTimezone(){return Intl.DateTimeFormat().resolvedOptions().timeZone}};var ts=function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),r=arguments[0],n=e;n--;)t[n-1]=arguments[n];return pn(h(r)?an(r):[r],mu(t,1))};var rs=function(e,t){for(var r=e.length;r--&&-1<ju(t,e[r],0););return r};var ns=function(e,t,r){return(e=Ye(e))&&(r||void 0===t)?e.slice(0,gl(e)+1):e&&(t=$e(t))?(r=ke(e),e=rs(r,ke(t))+1,Ae(r,0,e).join("")):e};var is=function(e,t,r,n){var i=-1,o=Nu,a=!0,l=e.length,u=[],s=t.length;if(!l)return u;r&&(t=Be(t,Mr(r))),n?(o=ku,a=!1):200<=t.length&&(o=Rl,a=!1,t=new kl(t));e:for(;++i<l;){var c=e[i],d=null==r?c:r(c),c=n||0!==c?c:0;if(a&&d==d){for(var f=s;f--;)if(t[f]===d)continue e;u.push(c)}else o(t,d,n)||u.push(c)}return u};var os=function(e){return Ge(e)&&Yr(e)},as=wu(function(e,t){var r=ul(t);return os(r)&&(r=void 0),os(e)?is(e,mu(t,1,os,!0),lu(r)):[]});var ls=function(e){return e&&e.length?Pu(e):[]};var us=function(e,t,r){return e&&e.length?(t=r||void 0===t?1:Al(t),we(e,0,t<0?0:t)):[]},u=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});const ss="doctors_dev",cs="externaldoctor_v0.1",ds="doctors_dev,room_dev",fs="provider_dev",ps=(e,t)=>{var r,n=null==localStorage?void 0:localStorage.getItem("config");return null!=(r=JSON.parse(n))&&r.hasOwnProperty(e)?JSON.parse(n)[e]:t},hs=(e,t,r)=>{const n=ps("syncHost","https://syncd.aitmed.io");let i=new Map([["40000","/avail/"],["35841","/docProfile/"],["79360","/rsnForVst/"],["655363","/room/"],["97280","/insurance/"]]).get(t),o="97280"===t?{bvid:r}:"40000"===t||"79360"===t?{vid:e,bvid:r}:{vid:e};return new Promise((t,r)=>{ne.default({url:i,baseURL:n,method:"put",data:o,headers:{"Content-Type":"application/json"}}).then(e=>{"test"===B.env&&L.default.info("%cGet mapbox address response","background: purple; color: white; display: block;",{data:e}),200==e.status&&t(e)}).catch(e=>{500===o.status&&q(o.status+": The search error!!! ",{type:"error"}),r(e)})})},vs=e=>{const n="/geocoding/v5/mapbox.places/"+e+".json";return new Promise((t,r)=>{ne.default({url:n,baseURL:"https://api.mapbox.com/",method:"get",params:{country:"US",limit:10,access_token:"pk.eyJ1IjoiamllamlleXV5IiwiYSI6ImNrbTFtem43NzF4amQyd3A4dmMyZHJhZzQifQ.qUDDq-asx1Q70aq90VDOJA"}}).then(e=>{"test"===B.env&&L.default.info("%cGet mapbox address response","background: purple; color: white; display: block;",{data:e}),200==e.status&&t(e)}).catch(e=>{r(e)})})};let ys=i=>new Promise((t,e)=>{let r="/api/icd10cm/v3/search?sf=code,name&df=code,name&maxList=20&terms="+i,n="clinicaltables.nlm.nih.gov";ne.default.get("https://"+n+r).then(e=>t({center:e.data})).catch(e)});var gs=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});const ms="https://api.aitmed.io/";function bs(r,a,l){return gs(this,null,function*(){var e=(new Date).getTime(),t=localStorage.getItem("expiredTime");("string"==typeof t?parseInt(t):0)<=e&&(yield function(){let t=new Date;ne.default({url:"/drugbank-token/",baseURL:ms,method:"get",headers:{"Content-Type":"application/json"}}).then(e=>{200==e.status&&(B.drugbankToken=e.data.token,localStorage.setItem("expiredTime",(t.getTime()+72e5).toString()),localStorage.setItem("drugbankToken",e.data.token),L.default.debug("test",e.data))}).catch(e=>{"test"===B.env&&L.default.error(e instanceof Error?e:new Error(String(e)))})}());const n=localStorage.getItem("drugbankToken");L.default.debug(n);let i="/product_concepts",o=("Route"==l?i="/product_concepts/"+a+"/routes":"Strength"==l&&(i="/product_concepts/"+a+"/strengths"),{});return r&&(o={q:r}),new Promise((t,r)=>{ne.default({url:i,baseURL:"https://api-js.drugbank.com/v1/us",method:"get",params:o,headers:{Authorization:"Bearer "+n}}).then(e=>{200==e.status&&t(e.data)}).catch(e=>{r(e)})})})}var _s={drugBank(e){return gs(this,arguments,function*({query:e,id:t,type:r}){let n=[];return yield bs(e,t,r).then(e=>{"test"===B.env&&L.default.info("%cGet Drug response","background: purple; color: white; display: block;",{data:e}),n=e},e=>{L.default.error(e instanceof Error?e:new Error(String(e)))}),n})},dataBank(e){return gs(this,arguments,function*({query:e}){let a=[];return yield function(t){return gs(this,null,function*(){let e=ms+"sdb/",n=t?{q:t}:{};return new Promise((t,r)=>{ne.default({url:e,method:"get",params:n}).then(e=>{"test"===B.env&&L.default.info("%cGet Drug response Detail","background: purple; color: white; display: block;",e.data),t(e.data.DrugList)}).catch(e=>{r(e)})})})}(e).then(e=>{"test"===B.env&&L.default.info("%cGet Drug response all","background: purple; color: white; display: block;",{data:e});let t=e,r=[],n=new Set;for(var i of t){var o=i.DrugName;n.has(o)||(n.add(o),r.push(i))}"test"===B.env&&L.default.info("%cGet Drug response","background: purple; color: white; display: block;",{result:r}),a=r},e=>{L.default.error(e instanceof Error?e:new Error(String(e)))}),a})},queryCPT(e){return gs(this,arguments,function*({query:e}){let t=[];return yield function(e){return gs(this,null,function*(){return new Promise((t,r)=>{ne.default({url:"https://clinicaltables.nlm.nih.gov/api/hcpcs/v3/search",method:"get",params:{authenticity_token:"",terms:e}}).then(e=>{"test"===B.env&&L.default.info("%cGet CPT response","background: purple; color: white; display: block;",e.data),t(e.data)}).catch(e=>{r(e)})})})}(e).then(e=>{"test"===B.env&&L.default.info("%cGet Drug response","background: purple; color: white; display: block;",{data:e}),t=e[3]},e=>{L.default.error(e instanceof Error?e:new Error(String(e)))}),t})}},s=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});function Ss(e,t){e=parseInt(e).toString(2);return e[e.length-t]}function Es(e,t,r){let n=parseInt(e).toString(2),i=n.length,o=n.split("");o.splice(i-t,1,r.toString());e=o.join("");return parseInt(e,2)}var Os={shareDoc(e){return s(this,arguments,function*({sourceDoc:e,targetEdgeID:t,targetRoomName:r,targetFileID:n,reid:i}){var e=yield tt(e.id),e=null!=(o=null==(o=null==e?void 0:e.data)?void 0:o.document)&&o.length?null==(o=null==e?void 0:e.data)?void 0:o.document[0]:null,o=yield Rt({document:e});let a=null==(e=null==o?void 0:o.name)?void 0:e.data;return"string"==typeof a&&(a=yield B.level2SDK.utilServices.base64ToBlob(null==(e=null==o?void 0:o.name)?void 0:e.data,null==(e=null==o?void 0:o.name)?void 0:e.type)),yield D.create({content:a,targetRoomName:r,title:null==(e=null==o?void 0:o.name)?void 0:e.title,user:null==(r=null==o?void 0:o.name)?void 0:r.user,type:null==o?void 0:o.type,edge_id:t,mediaType:null==(e=null==o?void 0:o.name)?void 0:e.type,fid:n,reid:i})})},shareDocByFid(e){return s(this,arguments,function*({sourceDoc:e,targetEdgeID:t,targetRoomName:r}){var e=yield tt(e.id),e=null!=(n=null==(n=null==e?void 0:e.data)?void 0:n.document)&&n.length?null==(n=null==e?void 0:e.data)?void 0:n.document[0]:null,n=yield Rt({document:e});let i=null==(e=null==n?void 0:n.name)?void 0:e.data;return"string"==typeof i&&(i=yield B.level2SDK.utilServices.base64ToBlob(null==(e=null==n?void 0:n.name)?void 0:e.data,null==(e=null==n?void 0:n.name)?void 0:e.type)),yield D.create({content:i,targetRoomName:r,title:null==(e=null==n?void 0:n.name)?void 0:e.title,user:null==(r=null==n?void 0:n.name)?void 0:r.user,type:null==n?void 0:n.type,edge_id:null==n?void 0:n.eid,fid:t,mediaType:null==(e=null==n?void 0:n.name)?void 0:e.type})})},shareDocList(e){return s(this,arguments,function*({sourceDocList:e,targetEdgeID:n,targetRoomName:i,targetFileID:o,reid:a}){var t;if(!M(n))throw new Se("Missing reference "+n);var r=yield F(n);if(null!=(t=null==(t=null==r?void 0:r.data)?void 0:t.edge)&&t.length&&r.data.edge[0])return Promise.all(e.map(r=>s(this,null,function*(){var e;let t=null==(e=null==r?void 0:r.name)?void 0:e.data;return"string"==typeof t&&(t=yield B.level2SDK.utilServices.base64ToBlob(null==(e=null==r?void 0:r.name)?void 0:e.data,null==(e=null==r?void 0:r.name)?void 0:e.type)),pc((yield D.nocheckcreate({content:t,targetRoomName:i,title:null==(e=null==r?void 0:r.name)?void 0:e.title,user:null==(e=null==r?void 0:r.name)?void 0:e.user,type:null==r?void 0:r.type,edge_id:n,mediaType:null==(e=null==r?void 0:r.name)?void 0:e.type,fid:o,reid:a})).doc)})));throw new P({name:"EDGE_DOES_NOT_EXIST"})})},updateDocList({sourceDocList:e}){return Promise.all(e.map(r=>s(this,null,function*(){var e;let t=null==(e=null==r?void 0:r.name)?void 0:e.data;"string"==typeof t&&(t=yield B.level2SDK.utilServices.base64ToBlob(null==(e=null==r?void 0:r.name)?void 0:e.data,null==(e=null==r?void 0:r.name)?void 0:e.type)),r.bsig!=(null==(e=localStorage.getItem("user_vid"))?void 0:e.toString())&&(yield B.level2SDK.edgeServices.createEdge({bvid:r.bsig,type:1030})),yield D.update(null==r?void 0:r.id,{edge_id:r.eid,content:t,type:null==r?void 0:r.type}),r.bsig!=(null==(e=localStorage.getItem("user_vid"))?void 0:e.toString())&&(yield B.level2SDK.edgeServices.createEdge({bvid:null==(e=localStorage.getItem("user_vid"))?void 0:e.toString(),type:1030}))})))},updateDocListType({sourceDocList:e,targetBit:n,targetValue:i}){return Promise.all(e.map(r=>s(this,null,function*(){let e=null==(t=null==r?void 0:r.name)?void 0:t.data;"string"==typeof e&&(e=yield B.level2SDK.utilServices.base64ToBlob(null==(t=null==r?void 0:r.name)?void 0:t.data,null==(t=null==r?void 0:r.name)?void 0:t.type)),r.bsig!=(null==(t=localStorage.getItem("user_vid"))?void 0:t.toString())&&(yield B.level2SDK.edgeServices.createEdge({bvid:r.bsig,type:1030}));var t;null!=r&&r.type;Ss(null==r?void 0:r.type,n)!=i&&(t=Es(null==r?void 0:r.type,n,i),yield D.update(null==r?void 0:r.id,{edge_id:r.eid,content:e,type:t})),r.bsig!=(null==(t=localStorage.getItem("user_vid"))?void 0:t.toString())&&(yield B.level2SDK.edgeServices.createEdge({bvid:null==(t=localStorage.getItem("user_vid"))?void 0:t.toString(),type:1030}))})))},updateDocListReid({sourceDocList:e,reid:n}){return Promise.all(e.map(r=>s(this,null,function*(){var e;let t=null==(e=null==r?void 0:r.name)?void 0:e.data;"string"==typeof t&&(t=yield B.level2SDK.utilServices.base64ToBlob(null==(e=null==r?void 0:r.name)?void 0:e.data,null==(e=null==r?void 0:r.name)?void 0:e.type)),r.bsig!=(null==(e=localStorage.getItem("user_vid"))?void 0:e.toString())&&(yield B.level2SDK.edgeServices.createEdge({bvid:r.bsig,type:1030})),L.default.debug("test",{edge_id:r.eid,content:t,reid:n}),yield D.update(null==r?void 0:r.id,{edge_id:r.eid,content:t,type:null==r?void 0:r.type,reid:n}),r.bsig!=(null==(e=localStorage.getItem("user_vid"))?void 0:e.toString())&&(yield B.level2SDK.edgeServices.createEdge({bvid:null==(e=localStorage.getItem("user_vid"))?void 0:e.toString(),type:1030}))})))},updateReidDocListType(e){return s(this,arguments,function*({sourceDocList:r,targetBit:n,targetValue:i,sCondition:e,eid:o}){var t,a=null==(t=localStorage.getItem("user_vid"))?void 0:t.toString();for(let t=0;t<r.length;t++){var l=U([r[t].id,a]),u=(yield B.level2SDK.documentServices.retrieveDocument({idList:l,options:{xfname:"reid,ovid",scondition:e}})).data.document;if(0==u.length){let e=3584;Ss(e,n)!=i&&(e=Es(e,n,i)),yield D.create({content:"",targetRoomName:"",title:"",user:"",reid:r[t].id,edge_id:o,type:e})}for(let t=0;t<u.length;t++){var s=u[t],c=yield Rt({document:s});let e=null==(f=null==c?void 0:c.name)?void 0:f.data;"string"==typeof e&&"undefined"!=e&&null!=(null==(f=null==s?void 0:s.name)?void 0:f.data)&&(e=yield B.level2SDK.utilServices.base64ToBlob(null==(s=null==c?void 0:c.name)?void 0:s.data,null==(f=null==c?void 0:c.name)?void 0:f.type));var d,s=yield B.level2SDK.utilServices.uint8ArrayToBase64(null==c?void 0:c.bsig),f=yield B.level2SDK.utilServices.uint8ArrayToBase64(null==c?void 0:c.eid);s!=(null==(d=localStorage.getItem("user_vid"))?void 0:d.toString())&&(yield B.level2SDK.edgeServices.createEdge({bvid:s,type:1030})),null==c||c.type;Ss(null==c?void 0:c.type,n)!=i&&(d=Es(null==c?void 0:c.type,n,i),yield D.update(null==c?void 0:c.id,{edge_id:f,content:e,type:d})),s!=(null==(c=localStorage.getItem("user_vid"))?void 0:c.toString())&&(yield B.level2SDK.edgeServices.createEdge({bvid:null==(f=localStorage.getItem("user_vid"))?void 0:f.toString(),type:1030}))}}})},createFolderTag({sourceDocList:e,folder:t,eid:r}){let n;return Promise.all(e.map(e=>s(this,null,function*(){n=U([e.id,t]);0==(yield B.level2SDK.documentServices.retrieveDocument({idList:n,options:{xfname:"reid,fid",type:3840}})).data.document.length&&(yield D.create({content:"",targetRoomName:"",title:"",user:"",reid:e.id,edge_id:r,fid:t,type:3840}))})))},deleteFolderTag({sourceDocList:e,folder:n}){let i;return Promise.all(e.map(e=>s(this,null,function*(){i=U([e.id,n]);var t=(yield B.level2SDK.documentServices.retrieveDocument({idList:i,options:{xfname:"reid,fid",type:3840}})).data.document;for(let e=0;e<t.length;e++){var r=t[e],r=yield Rt({document:r}),r=yield B.level2SDK.commonServices.deleteRequest([r.id]);"test"===B.env&&L.default.info("%cDelete Object Response","background: purple; color: white; display: block;",r)}})))},copyDocToAttachment(e){return s(this,arguments,function*({sourceDocList:e,newType:a}){let l=[];return yield Promise.all(e.map(o=>s(this,null,function*(){var e,t;let r=o,n=(1==Object.keys(o).length&&(t=null!=(e=null==(e=null==(t=yield tt(o.id))?void 0:t.data)?void 0:e.document)&&e.length?null==(e=null==t?void 0:t.data)?void 0:e.document[0]:null,r=yield Rt({document:t})),null==(e=null==r?void 0:r.name)?void 0:e.data),i=("string"==typeof n&&(n=yield B.level2SDK.utilServices.base64ToBlob(null==(t=null==r?void 0:r.name)?void 0:t.data,null==(e=null==r?void 0:r.name)?void 0:e.type)),yield D.create({content:n,title:null==(t=null==r?void 0:r.name)?void 0:t.title,user:null==(e=null==r?void 0:r.name)?void 0:e.user,type:a,edge_id:null==r?void 0:r.eid,mediaType:null==(t=null==r?void 0:r.name)?void 0:t.type,fid:null==r?void 0:r.fid}));i.doc.id=yield B.level2SDK.utilServices.uint8ArrayToBase64(null==(e=null==i?void 0:i.doc)?void 0:e.id),l.push(i)}))),l})},generatorSigForOldAccount(e){return s(this,arguments,function*({id:e,name:t,sk:r,phoneNumber:n}){return e&&t&&r?yield B.level2SDK.Account.generatorSigForOldAccount({id:e,userInfo:t,sk:r,phoneNumber:n}):{}})},transformVisitReason(e){return s(this,arguments,function*({vertexId:t,rootNoteBookId:r}){if(t&&r){const e=yield B.level2SDK.documentServices.retrieveDocument({idList:U([r]),options:{xfname:"eid",type:79360,maxcount:1,obfname:"mtime"}}),n=yield F(t,{xfname:"bvid|evid",type:10002,scondition:"subtype=196608"}),i=e.data.document[0],o=n.data.edge;if(i&&null!=o&&o.length){r=yield Rt({document:i});let e=null==(t=null==r?void 0:r.name)?void 0:t.data;(e="string"==typeof e&&"undefined"!=e&&null!=(null==(t=null==i?void 0:i.name)?void 0:t.data)?yield B.level2SDK.utilServices.base64ToBlob(null==(t=null==r?void 0:r.name)?void 0:t.data,null==(t=null==r?void 0:r.name)?void 0:t.type):e).reasonForVisit.forEach(e=>{e.fee="0.00",!e.hasOwnProperty("selectDoc")||null!=e&&delete e.selectDoc});const a={reasonForVisit:{Telemedicine:e.reasonForVisit,OfficeVisits:e.reasonForVisit},version:2};return Promise.all(o.map(e=>s(this,null,function*(){yield D.nocheckcreate({content:a,title:"",user:"",edge_id:e.eid,type:79360})})))}}})}},Ts={phoneNumber({phoneNumber:e,countryCode:t}){let r;return!!(t+" "+(r=e.includes("-")?e.replace(/-/g,""):e)).match(/^[+][0-9]+\s\d{10}$/)},userName(e){e=e.length;return 5<e&&e<17}},ws={random:function(){return Math.random()},add:function({num1:e,num2:t}){return e+t},greater:function({num1:e,num2:t}){return t<=e},lessthanSize:function({object:e,key:t}){e=e.size;return"NaN"!==parseFloat(e).toString()&&(t=Math.floor(t*Math.pow(1024,2)),!(parseFloat(e)>t))},cumulative:function({numArr:t}){let r=0;for(let e=0;e<t.length;e++)r+=parseFloat(t[e]);return r},toFixedNum({num:e}){return L.default.debug((+e).toFixed(2)),(+e).toFixed(2)},FixedLimit({num:e}){return String(e).length-String(e).indexOf(".")-1==2},calculateAge({dateTime:e,splite:t="/"}){let r=new Date,n=e.split(t),i=[r.getMonth()+1,r.getDate(),r.getFullYear()],o=i.map((e,t)=>e-+n[t]);if(o[1]<0){let e=new Date(i[2],i[0],0);o[0]--,o[1]+=e.getDate()}return o[0]<0&&(o[2]--,o[0]+=12),o[2]}},As={createSqPaymentForm(){const e=document.createElement("script");e.type="text/javascript",e.src="https://js.squareupsandbox.com/v2/paymentform",e.onload=()=>{window.paymentForm=new SqPaymentForm({applicationId:"sandbox-sq0idb-NZW9Yiwvqiqf5zAaaoFQgA",inputClass:"sq-input",autoBuild:!1,inputStyles:[{fontSize:"16px",lineHeight:"24px",padding:"16px",placeholderColor:"#a0a0a0",backgroundColor:"transparent"}],cardNumber:{elementId:"sq-card-number",placeholder:"Card Number"},cvv:{elementId:"sq-cvv",placeholder:"CVV"},expirationDate:{elementId:"sq-expiration-date",placeholder:"MM/YY"},postalCode:{elementId:"sq-postal-code",placeholder:"Postal"},callbacks:{cardNonceResponseReceived:function(r,n,e){return a=this,l=null,u=function*(){if(r)return L.default.error("Encountered Square errors:"),r.forEach(function(e){L.default.error("  "+e.message)}),void alert("Unable to process your payment at this time. Please try again later.");const e=document.getElementById("form-container"),t=document.createElement("div");t.setAttribute("type","hidden"),t.setAttribute("id","card-nonce"),null!=e&&e.appendChild(t),document.getElementById("card-nonce").value=n,alert("Please click continue to finish the payment."),delete window.onGetCardNonce,delete window.paymentForm},new Promise((t,r)=>{var n=e=>{try{o(u.next(e))}catch(e){r(e)}},i=e=>{try{o(u.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((u=u.apply(a,l)).next())});var a,l,u}}}),window.onGetCardNonce=function(e){L.default.debug(e),e.preventDefault(),paymentForm.requestCardNonce()},paymentForm.build()},document.body.appendChild(e)},getPaymentNonce(){var e=Array.from(document.getElementsByClassName("page"));if(e.length){e=e[0];if(e){const r=null==(t=e.contentWindow)?void 0:t.document;null!=(t=e.contentWindow)&&t.postMessage({getMeTheToken:!0},e.contentWindow.origin);var t=null==r?void 0:r.getElementById("card-nonce"),e=null==t?void 0:t.value;if(L.default.debug({iframeDoc:r}),L.default.debug({nonceElem:t}),L.default.debug({token:e}),e)return e}else L.default.error("%cCould not find the page component iframe","color:#ec0000;")}t=document.getElementById("card-nonce");if(t)return t.value;L.default.error('%cNonce element using selector "#card-nonce" not found',"color:#ec0000;")}},Ds=Object.defineProperty,Is=Object.defineProperties,xs=Object.getOwnPropertyDescriptors,js=Object.getOwnPropertySymbols,Ns=Object.prototype.hasOwnProperty,ks=Object.prototype.propertyIsEnumerable,Cs=(e,t,r)=>t in e?Ds(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Rs=(e,t)=>{for(var r in t=t||{})Ns.call(t,r)&&Cs(e,r,t[r]);if(js)for(var r of js(t))ks.call(t,r)&&Cs(e,r,t[r]);return e},Ps=(e,t)=>Is(e,xs(t)),d=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});function Ls({pageName:o,apiObject:a,dispatch:l}){const u=a.api.split(".").slice(1),e=Bs(),s=m(e,u);return i=>d(this,null,function*(){var{dataKey:e,dataIn:t,dataOut:r}=K(a||{}),t=yield l({type:z.GET_DATA,payload:{dataKey:t||e,pageName:o}});let n;try{"test"===B.env&&L.default.info(`%cBuiltIn Fn:${u} Request `,"background: purple; color: white; display: block;",Rs(Rs({},t),i)),n=yield s(Rs(Rs({},t),i)),"test"===B.env&&L.default.info(`%cBuiltIn Fn:${u} Response`,"background: purple; color: white; display: block;",n)}catch(e){throw e}return(Array.isArray(n)&&0<n.length||Ze(n))&&(yield l({type:z.UPDATE_DATA,payload:{pageName:o,dataKey:r||e,data:n}})),n})}function Bs(e={}){const{dispatch:c,processPopulate:t,getPage:r,emit:n,SearchClient:i}=e;return{string:ll,eccNaCl:po,object:hl,array:Wu,number:Yu,date:es,search:(I=[{SearchClient:i}["SearchClient"]][0],{updateEsData(e){return u(this,arguments,function*({id:e,type:t,bvid:r=null}){hs(e,t,r).then(e=>{},e=>{L.default.error(e instanceof Error?e:new Error(String(e)))})})},transformGeo(e){return u(this,arguments,function*({query:e}){let r=[];if(e=e.replace("#",""))return yield vs(e).then(e=>{var t;e=null==(t=null==(t=null==e?void 0:e.data)?void 0:t.features)?void 0:t[0],r=e.center,"test"===B.env&&L.default.debug(e)},e=>{"test"===B.env&&L.default.debug(e)}),r})},queryCode(e){return u(this,arguments,function*({query:e}){let r=[],n=[];return e?(yield ys(e).then(e=>{r[0]=e.center[3];for(let e=0;e<r[0].length;e++)n.push([]);for(let e=0;e<r[0].length;e++){var t=r[0][e][0]+r[0][e][1],t=ts(r[0][e],t);n[e].push(t)}},e=>{L.default.error("query error",e instanceof Error?e:new Error(String(e)))}),n):[]})},queryInsurance(e){return u(this,arguments,function*({id:e}){const t=ps("elasticClient","https://elasticd.aitmed.io"),r=I?new I({hosts:t}):{};return(yield r.search({index:"ins_all",body:{query:{match:{_id:e}}}})).hits.hits})},queryIns(e){return u(this,arguments,function*({ins:e}){const t=ps("elasticClient","https://elasticd.aitmed.io"),r=I?new I({hosts:t}):{};return yield r.search({index:"ins",body:{_source:!1,suggest:{ins:{prefix:e,completion:{field:"carries",size:1e3,skip_duplicates:!0}}}}})})},queryAllCarriers(e){return u(this,arguments,function*({object:e}){return e.forEach(e=>{e.text=e.carrier}),e})},suggestAddress(e){return u(this,arguments,function*({query:e}){e=e.replace("#","");let t=[];return e?(yield vs(e).then(e=>{t=null==(e=null==e?void 0:e.data)?void 0:e.features},e=>{L.default.error("query error",e instanceof Error?e:new Error(String(e)))}),null==t||null==typeof t?[]:t):[]})},suggest(e){return u(this,arguments,function*({prefix:e}){var t,r;const n=ps("elasticClient","https://elasticd.aitmed.io"),i=new I({hosts:n});L.default.debug("test suggest",e);let o=[],a=[],l=[],u=yield i.search({index:"search_field_suggestion",body:{suggest:{speciality_suggestion:{text:e,completion:{field:"specialty",skip_duplicates:!0,size:5}},symptom_suggestion:{text:e,completion:{field:"symptom",skip_duplicates:!0,size:10}}},sort:[{weight:{order:"desc"}}]}});function s(r,n){return function(e,t){e=null==(e=null==e?void 0:e[r])?void 0:e[n];return(null==(t=null==t?void 0:t[r])?void 0:t[n])-e}}for(t of null==(e=null==(e=null==(e=null==u?void 0:u.suggest)?void 0:e.speciality_suggestion)?void 0:e[0])?void 0:e.options.sort(s("_source","weight")))a.push(t);for(r of null==(e=null==(e=null==(e=null==u?void 0:u.suggest)?void 0:e.symptom_suggestion)?void 0:e[0])?void 0:e.options.sort(s("_source","weight")))l.push(r),o.push(r.text.trim().toLowerCase());return 5<(o=ls(o)).length&&(o=us(o,5)),5<l.length&&(l=us(l,5)),L.default.debug("test suggest",{uniqSym_suggestion:o,speciality_suggestion:a,symptom_suggestion:Array.from(new Set(l))}),{uniqSym_suggestion:o,speciality_suggestion:a,symptom_suggestion:Array.from(new Set(l))}})},GetAllLonAndLat({object:e}){if(A.isArr(e)){let i=[];return e.forEach(e=>{var t=null==(t=null==(t=null==(t=null==(t=null==e?void 0:e._source)?void 0:t.availByLocation)?void 0:t[0])?void 0:t.location)?void 0:t.geoCode.split(","),r=(null==(r=null==(r=null==(r=null==(r=null==(r=null==e?void 0:e._source)?void 0:r.availByLocation)?void 0:r[0])?void 0:r.location)?void 0:r.address)?void 0:r.street)+" "+(null==(r=null==(r=null==(r=null==(r=null==(r=null==e?void 0:e._source)?void 0:r.availByLocation)?void 0:r[0])?void 0:r.location)?void 0:r.address)?void 0:r.city)+" "+(null==(r=null==(r=null==(r=null==(r=null==(r=null==e?void 0:e._source)?void 0:r.availByLocation)?void 0:r[0])?void 0:r.location)?void 0:r.address)?void 0:r.state)+" "+(null==(r=null==(r=null==(r=null==(r=null==(r=null==e?void 0:e._source)?void 0:r.availByLocation)?void 0:r[0])?void 0:r.location)?void 0:r.address)?void 0:r.zipCode),n=parseFloat(t[1]),t=parseFloat(t[0]);i.push({data:[n,t],information:{address:r,name:(null==(n=null==e?void 0:e._source)?void 0:n.fullName)+" "+(null==(t=null==e?void 0:e._source)?void 0:t.title),phoneNumber:null==(r=null==e?void 0:e._source)?void 0:r.phone,speciality:null==(n=null==e?void 0:e._source)?void 0:n.specialty,title:null==(t=null==e?void 0:e._source)?void 0:t.title}})}),L.default.debug("test transform",i),i}},SortBySpeciality({object:e}){if(A.isArr(e)){let o=[],a=new Map,l=0;return e.forEach(t=>{var e,r,n,i=null!=(e=null==t?void 0:t._source)&&e.specialty?null==(e=null==t?void 0:t._source)?void 0:e.specialty:[null==(e=null==t?void 0:t._source)?void 0:e.service];for(let e=0;e<i.length;e++)void 0===a.get(i[e])?(n={Speciality:i[e],num:1,data:[t]},o.push(n),a.set(i[e],l++)):(n=parseInt(a.get(i[e])),L.default.debug("test",{obj:t,i:n}),o[n].num=(null==(r=null==o?void 0:o[n])?void 0:r.num)+1,o[n].data.push(t))}),o}},processingSearchData({object:e}){let a=["avatar1.png","avatar2.png","avatar3.png","avatar4.png"],l=[];if(A.isArr(e)){e.forEach(r=>{let n=new Map;for(let e=0;e<(null==(i=null==(i=null==r?void 0:r._source)?void 0:i.availByLocation)?void 0:i.length);e++){var i=null==(i=null==(i=null==(i=null==r?void 0:r._source)?void 0:i.availByLocation)?void 0:i[e])?void 0:i.location,o=null==(o=null==(o=null==(o=null==(o=null==r?void 0:r._source)?void 0:o.availByLocation)?void 0:o[e])?void 0:o.location)?void 0:o.geoCode;if(n.has(o))n.set(o,n.get(o));else{n.set(o,1);let e=r,t=Math.ceil(10*Math.random());t=0<=t&&t<2.5?0:t<5&&2.5<=t?1:5<=t&&t<7.5?2:3,e.path=a[t],e.fullName=(null==(o=null==e?void 0:e._source)?void 0:o.fullName)+", "+(null==(o=null==e?void 0:e._source)?void 0:o.title),e.address=(null==(o=null==i?void 0:i.address)?void 0:o.city)+", "+(null==(o=null==i?void 0:i.address)?void 0:o.state)+" "+(null==(o=null==i?void 0:i.address)?void 0:o.zipCode),e.street=null==(o=null==i?void 0:i.address)?void 0:o.street,null==(null==(i=null==r?void 0:r._source)?void 0:i.specialty)&&(r._source.specialty="unknown"),l.push(e)}}});let r={};return l=l.reduce((e,t)=>(r[t._id]||(e.push(t),r[t._id]=!0),e),[])}},ComputeObjectFieldCount({objArr:e,strOne:t,strTwo:r}){let n=0,i=0,o=[];return e.map(e=>{e.subtype===t?n++:e.subtype===r&&i++}),o.push(n),o.push(i),o},ModifyObjectField({objArr:e,str:t}){return e.map(e=>p(e,"place_name",ns(e.place_name,t)))},CountObj({objArr:t}){let i,o=[];return t.forEach(r=>{var e;if(1<=(null==(e=null==(e=null==r?void 0:r._source)?void 0:e.availByLocation)?void 0:e.length)){var n=null==(e=null==(e=null==r?void 0:r._source)?void 0:e.availByLocation)?void 0:e.length;i=null==(e=null==r?void 0:r._source)?void 0:e.availByLocation,dl(t,null==(e=null==r?void 0:r._source)?void 0:e.availByLocation);for(let t=0;t<n;t++){let e=K(r);e._source.availByLocation=new Array(i[t]),o.push(e)}}}),o},pickByArr({objArr:e}){let r=[],n=[],t=(null!=e&&e.forEach(e=>{var t;"Office Visits"===(null==(t=null==e?void 0:e._source)?void 0:t.visitType)||"COVID-19 Testing"===(null==(t=null==e?void 0:e._source)?void 0:t.service)||"COVID-19 Vaccine"===(null==(t=null==e?void 0:e._source)?void 0:t.service)||"Flu Shot"===(null==(t=null==e?void 0:e._source)?void 0:t.service)?r.push(e):"Telemedicine"===(null==(t=null==e?void 0:e._source)?void 0:t.visitType)&&n.push(e)}),[]);return t.push(r),t.push(n),t},queryProviders(e){return u(this,arguments,function*({cond:e=null}){const t=ps("elasticClient","https://elasticd.aitmed.io"),r=new I({hosts:t});e={query:{multi_match:{query:e,type:"best_fields",fields:["fullName^2","facilityName^2","specialty"],fuzziness:"AUTO",max_expansions:200}},size:100};return(yield r.search({index:fs,body:e})).hits.hits})},GetAllLonAndLatNew({object:e}){if(A.isArr(e)){let n=[],i="",o;return e.forEach(e=>{var t,r;null!=(t=null==e?void 0:e._source)&&t.practiceLocation&&null!=(t=null==(t=null==e?void 0:e._source)?void 0:t.practiceLocation)&&t.geoCode&&(o=null==(t=null==(t=null==e?void 0:e._source)?void 0:t.practiceLocation)?void 0:t.geoCode.split(","),i=null!=(t=null==(t=null==e?void 0:e._source)?void 0:t.practiceLocation)&&t.fullAddress?null==(t=null==(t=null==e?void 0:e._source)?void 0:t.practiceLocation)?void 0:t.fullAddress:null!=(t=null==(t=null==e?void 0:e._source)?void 0:t.practiceLocation)&&t.firstLine?""+(null!=(t=null==(t=null==e?void 0:e._source)?void 0:t.practiceLocation)&&t.firstLine?null==(t=null==(t=null==e?void 0:e._source)?void 0:t.practiceLocation)?void 0:t.firstLine:(null==(t=null==(t=null==e?void 0:e._source)?void 0:t.practiceLocation)||t.secondLine,null==(t=null==(t=null==e?void 0:e._source)?void 0:t.practiceLocation)?void 0:t.secondLine)):"address...",t=parseFloat(o[1]),r=parseFloat(o[0]),n.push({data:[t,r],information:{address:i,name:""+(null!=(t=null==e?void 0:e._source)&&t.fullName?null==(r=null==e?void 0:e._source)?void 0:r.titleName:null!=(t=null==e?void 0:e._source)&&t.roomName?null==(r=null==e?void 0:e._source)?void 0:r.roomName:""),phoneNumber:null==(t=null==e?void 0:e._source)?void 0:t.phoneNumber,speciality:""+(null!=(r=null==e?void 0:e._source)&&r.specialty?null==(t=null==e?void 0:e._source)?void 0:t.specialty:null!=(r=null==e?void 0:e._source)&&r.service?null==(t=null==e?void 0:e._source)?void 0:t.service:"")}}))}),n}},GetFacilityLat({object:e}){if(A.isArr(e)){let n=[];return e.forEach(e=>{var t=null==(t=null==(t=null==(t=null==e?void 0:e.name)?void 0:t.data)?void 0:t.basicInfo)?void 0:t.geoCode,e=(null==(r=null==(r=null==(r=null==e?void 0:e.name)?void 0:r.data)?void 0:r.basicInfo)?void 0:r.address)+" "+(null==(r=null==(r=null==(r=null==e?void 0:e.name)?void 0:r.data)?void 0:r.basicInfo)?void 0:r.city)+" "+(null==(r=null==(r=null==(r=null==e?void 0:e.name)?void 0:r.data)?void 0:r.basicInfo)?void 0:r.state)+" "+(null==(r=null==(e=null==(r=null==e?void 0:e.name)?void 0:r.data)?void 0:e.basicInfo)?void 0:r.zipCode),r=parseFloat(t[0]),t=parseFloat(t[1]);n.push({data:[r,t],information:{address:e}})}),n}},ChooseCarrier({object:t,cond:r}){for(let e=0;e<Array.from(t).length;e++)if(t[e].carrier==r)return t[e].plan[1]},jugeSame({object:t,cond:r,name:n}){for(let e=0;e<Array.from(t).length;e++)if(t[e][n]==r)return!0;return!1},DeleteCarrier({object:t,carreir:r,plans:n,len:i}){for(let e=0;e<Array.from(t).length;e++)if(t[e].carrier==r)return t[e].plans=n,t[e].planLength=i,t},queryByAllDate(e){return u(this,arguments,function*({cond:e=null,distance:t=30,pos:r=92805,stime:n,etime:i,isSplitCurrent:o=!1}){const a=ps("elasticClient","https://elasticd.aitmed.io"),l=new I({hosts:a});let u=[];r&&(yield vs(r).then(e=>{var t;e=null==(t=null==(t=null==e?void 0:e.data)?void 0:t.features)?void 0:t[0],u[0]=e.center[0],u[1]=e.center[1]},e=>{"test"===B.env&&L.default.error("%cError","background: purple; color: white; display: block;",e instanceof Error?e:new Error(String(e)))})),"string"!=typeof n&&"string"!=typeof i&&"number"!=typeof n&&"number"!=typeof i||(r=new Date,(s=new Date).setMonth(r.getMonth()+1),s.setDate(r.getDate()),s.setFullYear(r.getFullYear()),s.setHours(0),s.setMinutes(0),s.setSeconds(0),o?n<=(r=((new Date).getTime()/1e3).toFixed())&&(n=r):i=(n=Date.parse(s.toString())/1e3)+86400);var s,o={query:{bool:{must:[{function_score:{query:{multi_match:{query:e,type:"best_fields",fields:["specialty^2","fullName^1","service^2","facilityName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],filter:[{range:{avail:{gte:n,lt:i,relation:"intersects"}}},{geo_distance:{distance:t+"mi","practiceLocation.geoCode":u[1]+" , "+u[0]}}]}},size:100};return(yield l.search({index:ds,body:o})).hits.hits})},queryAllUser(e){return u(this,arguments,function*({cond:e=null,distance:t=30,pos:r=92805,stime:n,etime:i,isSplitCurrent:o=!1}){var a;const l=ps("elasticClient","https://elasticd.aitmed.io"),u=new I({hosts:l});let s=[];r&&(yield vs(r).then(e=>{e=e.data.features[0],s[0]=e.center[0],s[1]=e.center[1]},e=>{"test"===B.env&&L.default.error("%cError","background: purple; color: white; display: block;",e instanceof Error?e:new Error(String(e)))})),"string"!=typeof n&&"string"!=typeof i&&"number"!=typeof n&&"number"!=typeof i||(r=new Date,(a=new Date).setMonth(r.getMonth()+1),a.setDate(r.getDate()),a.setFullYear(r.getFullYear()),a.setHours(0),a.setMinutes(0),a.setSeconds(0),o?n<=(r=((new Date).getTime()/1e3).toFixed())&&(n=r):i=(n=Date.parse(a.toString())/1e3)+86400);o={query:{bool:{must:[{function_score:{query:{multi_match:{query:e,type:"best_fields",fields:["specialty^2","fullName^1","service^2","facilityName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}},{range:{avail:{gte:n,lt:i,relation:"intersects"}}},{geo_distance:{distance:t+"mi","practiceLocation.geoCode":s[1]+" , "+s[0]}}]}},size:1e3},r={query:{bool:{must:[{function_score:{query:{multi_match:{query:e,type:"best_fields",fields:["specialty^2","fullName^1","service^2","facilityName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}]}},size:1e3};const c=yield u.search({index:ds,body:o}),d=yield u.search({index:ss,body:r});return c.hits.hits.push(...as(null==(a=null==d?void 0:d.hits)?void 0:a.hits,null==(n=null==c?void 0:c.hits)?void 0:n.hits,"_id")),"test"===B.env&&L.default.info("%cGet Search response","background: purple; color: white; display: block;",{index:ds,response:null==(i=null==c?void 0:c.hits)?void 0:i.hits}),null==(t=null==c?void 0:c.hits)?void 0:t.hits})},queryUsers(e){return u(this,arguments,function*({cond:t=null,distance:r=30,pos:e=92805,lan:n="",ins:i="",stime:o,etime:a,isSplitCurrent:l=!1,pages:u=1,total:s=[],isType:c=!1,type:d=0}){const f=ps("elasticClient","https://elasticd.aitmed.io"),p=new I({hosts:f});let h=[];var v;e&&(yield vs(e).then(e=>{var t;e=null==(t=null==(t=null==e?void 0:e.data)?void 0:t.features)?void 0:t[0],h[0]=e.center[0],h[1]=e.center[1]},e=>{"test"===B.env&&L.default.error("%cError","background: purple; color: white; display: block;",e instanceof Error?e:new Error(String(e)))})),"string"!=typeof o&&"string"!=typeof a&&"number"!=typeof o&&"number"!=typeof a||(e=new Date,(v=new Date).setMonth(e.getMonth()+1),v.setDate(e.getDate()),v.setFullYear(e.getFullYear()),v.setHours(0),v.setMinutes(0),v.setSeconds(0),l?o<=(e=((new Date).getTime()/1e3).toFixed())&&(o=e):a=(o=Date.parse(v.toString())/1e3)+86400);const y=["Index_All","Index_doc","Index_Exter"];let g=(r=>{let n=[],e=10*(u-1),t=9+e,i=[];for(let t=0;t<r.length;t++)for(let e=0;e<r[t];e++)n.push({key:t,position:e,index:y[t]});var o=n[e],a=t>=n.length?n[n.length-1]:n[t];if(a.key>o.key)for(let e=o.key;e<=a.key;e++)e==o.key?i.push({index:o.index,start:o.position,length:r[o.key]-o.position}):e==a.key?i.push({index:a.index,start:0,length:a.position+1}):0!=r[e]&&i.push({index:o.index,start:0,length:r[e]});else i.push({index:o.index,start:o.position,length:a.position+1-o.position});return i})(s),m={from:0,size:0},b={from:0,size:0},_={from:0,size:0};g.forEach(e=>{"Index_All"==e.index&&(m.from=e.start,m.size=e.length),"Index_doc"==e.index&&(b.from=e.start,b.size=e.length),"Index_Exter"==e.index&&(_.from=e.start,_.size=e.length)});let S,E,O={match_phrase:{language:n}},T={match_phrase:{insurance:i}},w={term:{language:n}},A=0;for(let e=0;e<s.length;e++)A+=s[e];if(0==A)return(void 0).hits.hits=[],(void 0).hits.hits;{E=c?196609===d?(S={query:{bool:{must:[{function_score:{query:{multi_match:{query:t,type:"best_fields",fields:["specialty^2","fullName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],filter:[{range:{avail:{gte:o,lt:a,relation:"intersects"}}},{geo_distance:{distance:r+"mi","practiceLocation.geoCode":h[1]+" , "+h[0]}},{term:{subtype:d}}]}},from:m.from,size:m.size},""!=n&&""===i?S.query.bool.must.push(O):""!=i&&""===n?S.query.bool.must.push(T):""!=n&&""!=i&&(S.query.bool.must.push(O),S.query.bool.must.push(T)),ss):(S={query:{bool:{must:[{function_score:{query:{multi_match:{query:t,type:"best_fields",fields:["specialty^2","fullName^1","service^2","facilityName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],filter:[{range:{avail:{gte:o,lt:a,relation:"intersects"}}},{geo_distance:{distance:r+"mi","practiceLocation.geoCode":h[1]+" , "+h[0]}}],should:[{term:{subtype:131073}},{term:{_index:"room_dev"}}],minimum_should_match:1}},from:m.from,size:m.size},""!=i&&S.query.bool.must.push(T),""!=n&&(S.query.bool.should.push(w),S.query.bool.minimum_should_match=2),ds):(S={query:{bool:{must:[{function_score:{query:{multi_match:{query:t,type:"best_fields",fields:["specialty^2","fullName^1","service^2","facilityName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}},{range:{avail:{gte:o,lt:a,relation:"intersects"}}},{geo_distance:{distance:r+"mi","practiceLocation.geoCode":h[1]+" , "+h[0]}}]}},from:m.from,size:m.size},""!=n&&""===i?S.query.bool.must.push(O):""!=i&&""===n?S.query.bool.must.push(T):""!=n&&""!=i&&(S.query.bool.must.push(O),S.query.bool.must.push(T)),ds);const D=yield p.search({index:E,body:S});if(0!=b.size){let e;e=c?{query:{bool:{must:[{function_score:{query:{multi_match:{query:t,type:"best_fields",fields:["specialty^2","fullName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],must_not:[{range:{avail:{gte:o,lt:a,relation:"intersects"}}},{geo_distance:{distance:r+"mi","practiceLocation.geoCode":h[1]+" , "+h[0]}}],filter:[{term:{subtype:d}}]}},from:b.from,size:b.size}:{query:{bool:{must:[{function_score:{query:{multi_match:{query:t,type:"best_fields",fields:["specialty^2","fullName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],must_not:[{range:{avail:{gte:o,lt:a,relation:"intersects"}}},{geo_distance:{distance:r+"mi","practiceLocation.geoCode":h[1]+" , "+h[0]}}]}},from:b.from,size:b.size},""!=n&&""===i?e.query.bool.must.push(O):""!=i&&""===n?e.query.bool.must.push(T):""!=n&&""!=i&&(e.query.bool.must.push(O),e.query.bool.must.push(T));l=yield p.search({index:ss,body:e});D.hits.hits.length<10&&D.hits.hits.push(...l.hits.hits)}return""===n&&""===i&&0!=_.size&&(e={query:{bool:{must:[{function_score:{query:{multi_match:{query:t,type:"best_fields",fields:["specialty^2","fullName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}]}},from:_.from,size:_.size},v=yield p.search({index:cs,body:e}),D.hits.hits.length<10&&D.hits.hits.push(...v.hits.hits)),D.hits.hits}})},querySpecialty(e){return u(this,arguments,function*({cond:r=null,distance:n=30,pos:e=92805,stime:i,etime:o,isSplitCurrent:a=!1,isType:l=!1,type:u=0,lan:s="",ins:c=""}){const t=ps("elasticClient","https://elasticd.aitmed.io"),d=new I({hosts:t});let f=[];var p;e&&(yield vs(e).then(e=>{var t;e=null==(t=null==(t=null==e?void 0:e.data)?void 0:t.features)?void 0:t[0],f[0]=e.center[0],f[1]=e.center[1]},e=>{"test"===B.env&&L.default.error("%cError","background: purple; color: white; display: block;",e instanceof Error?e:new Error(String(e)))})),"string"!=typeof i&&"string"!=typeof o&&"number"!=typeof i&&"number"!=typeof o||(e=new Date,(p=new Date).setMonth(e.getMonth()+1),p.setDate(e.getDate()),p.setFullYear(e.getFullYear()),p.setHours(0),p.setMinutes(0),p.setSeconds(0),a?i<=(e=((new Date).getTime()/1e3).toFixed())&&(i=e):o=(i=Date.parse(p.toString())/1e3)+86400);let h,v,y={match_phrase:{language:s}},g={match_phrase:{insurance:c}},m={term:{language:s}};v=l?196609==u?(h={query:{bool:{must:[{function_score:{query:{multi_match:{query:r,type:"best_fields",fields:["specialty^2","fullName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],filter:[{range:{avail:{gte:i,lt:o,relation:"intersects"}}},{geo_distance:{distance:n+"mi","practiceLocation.geoCode":f[1]+" , "+f[0]}},{term:{subtype:u}}]}},_source:["specialty","service"],size:1e3},""!=s&&""===c?h.query.bool.must.push(y):""!=c&&""===s?h.query.bool.must.push(g):""!=s&&""!=c&&(h.query.bool.must.push(y),h.query.bool.must.push(g)),ss):(h={query:{bool:{must:[{function_score:{query:{multi_match:{query:r,type:"best_fields",fields:["specialty^2","fullName^1","service^2","facilityName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],filter:[{range:{avail:{gte:i,lt:o,relation:"intersects"}}},{geo_distance:{distance:n+"mi","practiceLocation.geoCode":f[1]+" , "+f[0]}}],should:[{term:{subtype:131073}},{term:{_index:"room_dev"}}],minimum_should_match:1}},_source:["specialty","service"],size:1e3},""!=c&&h.query.bool.must.push(g),""!=s&&(h.query.bool.should.push(m),h.query.bool.minimum_should_match=2),ds):(h={query:{bool:{must:[{function_score:{query:{multi_match:{query:r,type:"best_fields",fields:["specialty^2","fullName^1","service^2","facilityName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}},{range:{avail:{gte:i,lt:o,relation:"intersects"}}},{geo_distance:{distance:n+"mi","practiceLocation.geoCode":f[1]+" , "+f[0]}}]}},_source:["specialty","service"],size:1e3},""!=s&&""===c?h.query.bool.must.push(y):""!=c&&""===s?h.query.bool.must.push(g):""!=s&&""!=c&&(h.query.bool.must.push(y),h.query.bool.must.push(g)),ds);const b=yield d.search({index:v,body:h});if(b.hits.hits.length<30){let e=30-b.hits.hits.length,t;t=l?{query:{bool:{must:[{function_score:{query:{multi_match:{query:r,type:"best_fields",fields:["specialty^2","fullName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],must_not:[{range:{avail:{gte:i,lt:o,relation:"intersects"}}},{geo_distance:{distance:n+"mi","practiceLocation.geoCode":f[1]+" , "+f[0]}}],filter:[{term:{subtype:u}}]}},_source:["specialty","service"],size:e}:{query:{bool:{must:[{function_score:{query:{multi_match:{query:r,type:"best_fields",fields:["specialty^2","fullName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],must_not:[{range:{avail:{gte:i,lt:o,relation:"intersects"}}},{geo_distance:{distance:n+"mi","practiceLocation.geoCode":f[1]+" , "+f[0]}}]}},_source:["specialty","service"],size:e},""!=s&&""===c?t.query.bool.must.push(y):""!=c&&""===s?t.query.bool.must.push(g):""!=s&&""!=c&&(t.query.bool.must.push(y),t.query.bool.must.push(g));a=yield d.search({index:ss,body:t});b.hits.hits.length<10&&b.hits.hits.push(...a.hits.hits)}""===s&&""===c&&b.hits.hits.length<30&&(e={query:{bool:{must:[{function_score:{query:{multi_match:{query:r,type:"best_fields",fields:["specialty^2","fullName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}]}},_source:["specialty","service"],size:30-b.hits.hits.length},p=yield d.search({index:cs,body:e}),b.hits.hits.length<10&&b.hits.hits.push(...p.hits.hits));let _=[];return b.hits.hits.forEach(e=>{_=ls(_.concat(e._source.specialty))}),_})},queryTotals(e){return u(this,arguments,function*({cond:r=null,distance:n=30,pos:i=92805,stime:o,etime:a,isSplitCurrent:l=!1,isType:u=!1,type:s=0,lan:c="",ins:d=""}){const e=ps("elasticClient","https://elasticd.aitmed.io"),f=new I({hosts:e});let p=[];i&&(yield vs(i).then(e=>{var t;e=null==(t=null==(t=null==e?void 0:e.data)?void 0:t.features)?void 0:t[0],p[0]=e.center[0],p[1]=e.center[1]},e=>{"test"===B.env&&L.default.error("%cError","background: purple; color: white; display: block;",e instanceof Error?e:new Error(String(e)))})),"string"!=typeof o&&"string"!=typeof a&&"number"!=typeof o&&"number"!=typeof a||(i=new Date,(b=new Date).setMonth(i.getMonth()+1),b.setDate(i.getDate()),b.setFullYear(i.getFullYear()),b.setHours(0),b.setMinutes(0),b.setSeconds(0),l?o<=(i=((new Date).getTime()/1e3).toFixed())&&(o=i):a=(o=Date.parse(b.toString())/1e3)+86400);let t,h,v={match_phrase:{language:c}},y={match_phrase:{insurance:d}},g={term:{language:c}};h=u?196609==s?(t={query:{bool:{must:[{function_score:{query:{multi_match:{query:r,type:"best_fields",fields:["specialty^2","fullName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],filter:[{range:{avail:{gte:o,lt:a,relation:"intersects"}}},{geo_distance:{distance:n+"mi","practiceLocation.geoCode":p[1]+" , "+p[0]}},{term:{subtype:s}}]}}},""!=c&&""===d?t.query.bool.must.push(v):""!=d&&""===c?t.query.bool.must.push(y):""!=c&&""!=d&&(t.query.bool.must.push(v),t.query.bool.must.push(y)),ss):(t={query:{bool:{must:[{function_score:{query:{multi_match:{query:r,type:"best_fields",fields:["specialty^2","fullName^1","service^2","facilityName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],filter:[{range:{avail:{gte:o,lt:a,relation:"intersects"}}},{geo_distance:{distance:n+"mi","practiceLocation.geoCode":p[1]+" , "+p[0]}}],should:[{term:{subtype:131073}},{term:{_index:"room_dev"}}],minimum_should_match:1}}},""!=d&&t.query.bool.must.push(y),""!=c&&(t.query.bool.should.push(g),t.query.bool.minimum_should_match=2),ds):(t={query:{bool:{must:[{function_score:{query:{multi_match:{query:r,type:"best_fields",fields:["specialty^2","fullName^1","service^2","facilityName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}},{range:{avail:{gte:o,lt:a,relation:"intersects"}}},{geo_distance:{distance:n+"mi","practiceLocation.geoCode":p[1]+" , "+p[0]}}]}}},""!=c&&""===d?t.query.bool.must.push(v):""!=d&&""===c?t.query.bool.must.push(y):""!=c&&""!=d&&(t.query.bool.must.push(v),t.query.bool.must.push(y)),ds);l=yield f.count({index:h,body:t});let m=[];if(m[0]=l.count,l.count<30){let e=30-l.count,t;t=u?{query:{bool:{must:[{function_score:{query:{multi_match:{query:r,type:"best_fields",fields:["specialty^2","fullName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],must_not:[{range:{avail:{gte:o,lt:a,relation:"intersects"}}},{geo_distance:{distance:n+"mi","practiceLocation.geoCode":p[1]+" , "+p[0]}}],filter:[{term:{subtype:s}}]}}}:{query:{bool:{must:[{function_score:{query:{multi_match:{query:r,type:"best_fields",fields:["specialty^2","fullName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],must_not:[{range:{avail:{gte:o,lt:a,relation:"intersects"}}},{geo_distance:{distance:n+"mi","practiceLocation.geoCode":p[1]+" , "+p[0]}}]}}},""!=c&&""===d?t.query.bool.must.push(v):""!=d&&""===c?t.query.bool.must.push(y):""!=c&&""!=d&&(t.query.bool.must.push(v),t.query.bool.must.push(y));var b,i=yield f.count({index:ss,body:t});""===c&&""===d&&(i.count<e?(m[1]=i.count,b=e-i.count,l={query:{bool:{must:[{function_score:{query:{multi_match:{query:r,type:"best_fields",fields:["specialty^2","fullName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}]}}},0<=(u=yield f.count({index:cs,body:l})).count-b?m[2]=b:m[2]=u.count):m[1]=e)}return m})},call(e){return u(this,arguments,function*({telephone:e}){A.isBrowser()&&(window.location.href="tel:"+e)})},queryAllPat(e){return u(this,arguments,function*({cond:e=null,distance:t=30,pos:r=92805,stime:n,etime:i,isSplitCurrent:o=!1,from:a=0,size:l=10,lastArray:u=[]}){var s;const c=ps("elasticClient","https://elasticd.aitmed.io"),d=new I({hosts:c});let f=[];r&&(yield vs(r).then(e=>{e=e.data.features[0],f[0]=e.center[0],f[1]=e.center[1]},e=>{"test"===B.env&&L.default.error("%cError","background: purple; color: white; display: block;",e instanceof Error?e:new Error(String(e)))})),"string"!=typeof n&&"string"!=typeof i&&"number"!=typeof n&&"number"!=typeof i||(r=new Date,(s=new Date).setMonth(r.getMonth()+1),s.setDate(r.getDate()),s.setFullYear(r.getFullYear()),s.setHours(0),s.setMinutes(0),s.setSeconds(0),o?n<=(r=((new Date).getTime()/1e3).toFixed())&&(n=r):i=(n=Date.parse(s.toString())/1e3)+86400);o={query:{bool:{must:[{function_score:{query:{multi_match:{query:e,type:"best_fields",fields:["specialty^2","fullName^1","service^2","facilityName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],filter:[{range:{avail:{gte:n,lt:i,relation:"intersects"}}},{geo_distance:{distance:t+"mi","practiceLocation.geoCode":f[1]+" , "+f[0]}}]}},sort:[{_geo_distance:{"practiceLocation.geoCode":f[1]+" , "+f[0],order:"asc",unit:"mi",distance_type:"arc",ignore_unmapped:!0}}],from:a,size:l};const p=yield d.search({index:ds,body:o});let h=!0;0==p.hits.hits.length&&(h=!1),0!=u.length&&(p.hits.hits=u.concat(p.hits.hits));for(let e=0;e<(null==(v=null==(v=null==p?void 0:p.hits)?void 0:v.hits)?void 0:v.length);e++){var v=(+(null==(v=null==(v=null==(v=null==(v=null==p?void 0:p.hits)?void 0:v.hits)?void 0:v[e])?void 0:v.sort)?void 0:v[0])).toFixed(2)+" miles";p.hits.hits[e]._source.practiceLocation.distance=v,h?p.hits.hits[e].loading=!0:p.hits.hits[e].loading=!1}return p.hits.hits})},queryDataByType(e){return u(this,arguments,function*({cond:e,distance:t="25",pos:r=92805,stime:n,etime:i,type:o,isSplitCurrent:a=!1,size:l=10,from:u=0,lastArray:s=[]}){var c;const d=ps("elasticClient","https://elasticd.aitmed.io"),f=new I({hosts:d});let p=[];r&&(yield vs(r).then(e=>{e=e.data.features[0],p[0]=e.center[0],p[1]=e.center[1]},e=>{"test"===B.env&&L.default.error("%cError","background: purple; color: white; display: block;",e instanceof Error?e:new Error(String(e)))})),"string"!=typeof n&&"string"!=typeof i&&"number"!=typeof n&&"number"!=typeof i||(r=new Date,(c=new Date).setMonth(r.getMonth()+1),c.setDate(r.getDate()),c.setFullYear(r.getFullYear()),c.setHours(0),c.setMinutes(0),c.setSeconds(0),a?n<=(r=((new Date).getTime()/1e3).toFixed())&&(n=r):i=(n=Date.parse(c.toString())/1e3)+86400);let h,v;v=196609==o?(h={query:{bool:{must:[{function_score:{query:{multi_match:{query:e,type:"best_fields",fields:["specialty^2","fullName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],filter:[{range:{avail:{gte:n,lt:i,relation:"intersects"}}},{geo_distance:{distance:t+"mi","practiceLocation.geoCode":p[1]+" , "+p[0]}},{term:{subtype:o}}]}},sort:[{_geo_distance:{"practiceLocation.geoCode":p[1]+" , "+p[0],order:"asc",unit:"mi",distance_type:"arc",ignore_unmapped:!0}}],from:u,size:l},ss):(h={query:{bool:{must:[{function_score:{query:{multi_match:{query:e,type:"best_fields",fields:["specialty^2","fullName^1","service^2","facilityName^1"],fuzziness:"AUTO",max_expansions:200,prefix_length:2}}}}],filter:[{range:{avail:{gte:n,lt:i,relation:"intersects"}}},{geo_distance:{distance:t+"mi","practiceLocation.geoCode":p[1]+" , "+p[0]}}],should:[{term:{subtype:131073}},{term:{_index:"room_dev"}}],minimum_should_match:1}},sort:[{_geo_distance:{"practiceLocation.geoCode":p[1]+" , "+p[0],order:"asc",unit:"mi",distance_type:"arc",ignore_unmapped:!0}}],from:u,size:l},ds);const y=yield f.search({index:v,body:h});let g=!0;0==y.hits.hits.length&&(g=!1),0!=s.length&&(y.hits.hits=s.concat(y.hits.hits));for(let e=0;e<(null==(m=null==(m=null==y?void 0:y.hits)?void 0:m.hits)?void 0:m.length);e++){var m=(+(null==(m=null==(m=null==(m=null==(m=null==y?void 0:y.hits)?void 0:m.hits)?void 0:m[e])?void 0:m.sort)?void 0:m[0])).toFixed(2)+" miles";y.hits.hits[e]._source.practiceLocation.distance=m,g?y.hits.hits[e].loading=!0:y.hits.hits[e].loading=!1}return y.hits.hits})}}),apiRequest:_s,typeCheck:Ts,ecos:Os,utils:Sa,math:ws,FCM:ha,payment:As,getRootNotebook(c){return d(this,null,function*(){var e,t,{id:r,maxcount:n,sCondition:i,type:o}=c,a=((e,t)=>{var r={};for(n in e)Ns.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&js)for(var n of js(e))t.indexOf(n)<0&&ks.call(e,n)&&(r[n]=e[n]);return r})(c,["id","maxcount","sCondition","type"]);let l=Rs({},a);function u(t,r){return d(this,null,function*(){var e=yield F((null==(e=null==t?void 0:t.filter)?void 0:e.call(t,Boolean))||[],r);return null==e?void 0:e.data})}n&&(l.maxcount=parseInt(n)),o&&(l.type=parseInt(o)),i&&(l.scondition=i);let s=yield u(t=Array.isArray(r)?[...r]:[r],l);for(;0==(null==(e=null==s?void 0:s.edge)?void 0:e.length);)s=yield u(t,l);return s})},createNewAccount(s){return d(this,null,function*(){const{phoneNumber:e,password:t,userName:r,firstName:n,lastName:i,fullName:o}=s.name;let a;a=e.includes("-")?e.replace(/-/g,""):e,a=s.name.countryCode+" "+a;var l=yield ht(a,t,null==(l=s.name)?void 0:l.verificationCode,{userName:r,firstName:n,lastName:i,fullName:o},s.type),u=localStorage.getItem("sk");return c&&(yield c({type:z.UPDATE_DATA,payload:{pageName:"builtIn",dataKey:"builtIn.UserVertex",data:Ps(Rs({},l),{sk:u})}})),l})},signIn(e){return d(this,arguments,function*({phoneNumber:e,password:t,verificationCode:r}){L.default.debug("[builtIn.signIn]",arguments[0]);let n;n=e.includes("-")?e.replace(/-/g,""):e;e=yield vt(n,t,r),t=localStorage.getItem("sk");return c&&(yield c({type:z.UPDATE_DATA,payload:{pageName:"builtIn",dataKey:"builtIn.UserVertex",data:Ps(Rs({},e),{sk:t})}})),e})},loginByPassword(e){return d(this,arguments,function*(e){var t=yield yt(e),r=localStorage.getItem("sk");c&&(L.default.debug("[builtIn.loginByPassword]",{password:e,data:t,sk:r}),yield c({type:z.UPDATE_DATA,payload:{pageName:"builtIn",dataKey:"builtIn.UserVertex",data:Ps(Rs({},t),{sk:r})}}))})},storeCredentials(e){return d(this,arguments,function*({pk:e,sk:t,esk:r,userId:n}){localStorage.setItem("sk",t),localStorage.setItem("pk",e),localStorage.setItem("esk",r),localStorage.setItem("user_vid",n),n&&c&&(t=yield c({type:z.GET_DATA,payload:{dataKey:"Global.currentUser.vertex.name.eskSign"}}),e=yield c({type:z.GET_DATA,payload:{dataKey:"Global.currentUser.vertex.name.pkSign"}}),t&&(localStorage.setItem("eskSign",t),localStorage.setItem("pkSign",e)),yield c({type:z.PULL_INDEX_TABLE,payload:{}}))})},storeCredential(e){return d(this,arguments,function*({key:e,value:t}){localStorage.setItem(e,t),"facility_vid"===e&&t&&c&&(yield c({type:z.PULL_INDEX_TABLE,payload:{isAdmin:!0}}))})},currentDateTime:Date.now(),SignInOk(){return d(this,null,function*(){return 0===(yield mt()).code})},uploadDocument(e){return d(this,arguments,function*({title:e,tags:t=[],content:r,type:n,dataType:i=0}){var o=localStorage.getItem("Global"),o=null!==o?JSON.parse(o):null;if(!o)throw new Error("There was no rootNotebook found.Please sign in.");o=o.rootNotebook.edge.id,o=yield D.create({edge_id:o,title:e,tags:t,content:r,type:n,dataType:i});return o&&{docName:null==(e=null==o?void 0:o.name)?void 0:e.title,url:null==(t=null==o?void 0:o.deat)?void 0:t.url}})},isIOS(){if("undefined"!=typeof window){var e=window.navigator.userAgent||window.navigator.vendor;if(/iPad|iPhone|iPod|Safari/.test(e)&&!("MSStream"in window))return!0}return!1},isAndroid(){if("undefined"!=typeof window){var e=window.navigator.userAgent||window.navigator.vendor;if(/android/i.test(e))return!0}return!1},isIOSBrowser(){if("undefined"!=typeof window){var e=window.navigator.userAgent||window.navigator.vendor;if(/iPad|iPhone|iPod/.test(e)&&!("MSStream"in window))return!0}return!1},isAndroidBroswer(){if("undefined"!=typeof window){var e=window.navigator.userAgent||window.navigator.vendor;if(/android/i.test(e))return!0}return!1},isAndroidBrowser(){if("undefined"!=typeof window){var e=window.navigator.userAgent||window.navigator.vendor;if(/android/i.test(e))return!0}return!1},stringCompare(e,t){return e===t},toCSV(e){var t=e=>{function r(e,t){return null===t?"":t}let n=Object.keys(e),t=[e].map(function(t){return n.map(function(e){return JSON.stringify(t[e],r)}).join(",")});return t.unshift(n.join(",")),t.join(`\r
`)};return A.isArr(e)?e.map(t):(A.isObj(e)?t:String)(e)},downloadFromS3(t){return d(this,null,function*(){var e=yield B.level2SDK.documentServices.downloadDocumentFromS3({url:t});return null==e?void 0:e.data})},cleanLocalStorage(){return d(this,null,function*(){var e;B.level2SDK.Account.logoutClean(),localStorage.removeItem("Global"),c&&(yield c({type:z.UPDATE_DATA,payload:{dataKey:"Global",data:" "}}),yield c({type:z.PUSH_INDEX_TABLE,payload:{}})),t&&r&&n&&(e=t({source:null==(e=yield r("BaseDataModel"))?void 0:e[0],lookFor:[".","..","=","~"]}),n({type:T.SET_ROOT_PROPERTIES,payload:{properties:e}}),localStorage.setItem("Global",JSON.stringify(null==e?void 0:e.Global)))})},searchCache(e){return d(this,arguments,function*({key:e}){return c&&e?yield c({type:z.SEARCH_CACHE,payload:{key:e}}):[]})},isBrowser(){return"undefined"!=typeof window}};var I}function Us(i){try{let e;e="test"===B.env?60:3;const u=localStorage.getItem("api-dispatch-buffer"),s=oe.default.stringify(ie.default(JSON.stringify(i))).substring(0,8),c=f.default(Date.now());let t;t=null!==u?JSON.parse(u):{};let r,n;var o,a,l;n=s in t?(o=f.default(t[s]),c.diff(o,"seconds")>e?(t[s]=c.toString(),!0):(t[s+"FAILED_REPEAT"]=c.toString(),!1)):(t[s]=c.toString(),r=JSON.stringify(t),localStorage.setItem("api-dispatch-buffer",r),!0);for([a,l]of Object.entries(t))c.diff(l,"seconds")>e&&delete t[a];return r=JSON.stringify(t),localStorage.setItem("api-dispatch-buffer",r),n}catch(e){L.default.error(e instanceof Error?e:new Error(String(e)))}}var Fs=Object.defineProperty,Ks=Object.defineProperties,Ms=Object.getOwnPropertyDescriptors,zs=Object.getOwnPropertySymbols,qs=Object.prototype.hasOwnProperty,Vs=Object.prototype.propertyIsEnumerable,Ws=(e,t,r)=>t in e?Fs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Gs=(e,t)=>{for(var r in t=t||{})qs.call(t,r)&&Ws(e,r,t[r]);if(zs)for(var r of zs(t))Vs.call(t,r)&&Ws(e,r,t[r]);return e},Hs=(e,t)=>Ks(e,Ms(t)),Js=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});function $s({pageName:u,apiObject:s,dispatch:c}){return()=>Js(this,null,function*(){const{dataKey:e,dataIn:t}=K(s||{}),r=yield c({type:z.GET_DATA,payload:{dataKey:t||e,pageName:u}}),n=yield c({type:z.POPULATE_OBJECT,payload:{object:r,pageName:u}}),i=n["id"],o=((e,t)=>{var r={};for(n in e)qs.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&zs)for(var n of zs(e))t.indexOf(n)<0&&Vs.call(e,n)&&(r[n]=e[n]);return r})(n,["api","id"]);let a;if(Array.isArray(i)&&i.forEach(t=>Js(this,null,function*(){try{if("test"===B.env&&L.default.info("%cDelete Object Request","background: purple; color: white; display: block;",Hs(Gs({},o),{id:t})),!Us({api:"dx",element:t}))return;var e=(yield B.level2SDK.commonServices.deleteRequest([t]))["data"];a=e,"test"===B.env&&L.default.info("%cDelete Object Response","background: purple; color: white; display: block;",a)}catch(e){throw e}})),"string"==typeof i)try{var l;"test"===B.env&&L.default.info("%cDelete Object Request","background: purple; color: white; display: block;",Hs(Gs({},o),{id:i})),Us({api:"dx",id:i})&&(l=(yield B.level2SDK.commonServices.deleteRequest([i]))["data"],a=l,"test"===B.env&&L.default.info("%cDelete Object Response","background: purple; color: white; display: block;",a))}catch(e){throw e}})}function Ys(e){return{ce:Ra,re:Ca,cv:Ha,rv:Ga,cd:ol,rd:il,dx:$s,builtIn:Ls}[e]}var Xs=Object.defineProperty,Qs=Object.defineProperties,Zs=Object.getOwnPropertyDescriptors,ec=Object.getOwnPropertySymbols,tc=Object.prototype.hasOwnProperty,rc=Object.prototype.propertyIsEnumerable,nc=(e,t,r)=>t in e?Xs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ic=(e,t)=>{for(var r in t=t||{})tc.call(t,r)&&nc(e,r,t[r]);if(ec)for(var r of ec(t))rc.call(t,r)&&nc(e,r,t[r]);return e},oc=(e,t)=>Qs(e,Zs(t)),ac=(e,t)=>{var r={};for(n in e)tc.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&ec)for(var n of ec(e))t.indexOf(n)<0&&rc.call(e,n)&&(r[n]=e[n]);return r},lc=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});function uc({cadlObject:e,dispatch:t,force:r=!1}){var n=A.keys(e);return function d({pageName:f,cadlObject:e,dispatch:p,force:t=!1}){let h=e;return"Global"===f&&!t||A.isObj(h)&&A.keys(h).forEach(e=>{if(A.isObj(h[e]))h[e]=d({pageName:f,cadlObject:h[e],dispatch:p});else if(A.isArr(h[e])){const r=[...h[e]];h[e].length=0;for(var t of r)A.isObj(t)&&(t=d({pageName:f,cadlObject:t,dispatch:p})),h[e].push(t)}else if(A.isStr(h[e])&&"api"===e){const n=`${h.dataOut||h.dataKey||""}.name`,i=h,{api:o,_nonce:a}=i,l=ac(i,["api","_nonce"]),u=o.split(".")[0],s=Ys(u)({pageName:f,apiObject:h,dispatch:p});if(/(ce|cd|cv|builtIn)/.test(u))M(h)&&(h=[n,s]);else if(M(l)){const c={pageName:f,apiObject:h,dispatch:p};h=Ys(u)(c)}}}),h}({pageName:1<n.length?"Global":n[0],cadlObject:e,dispatch:t,force:r})}function sc({pageName:e,updateObject:t,dispatch:r}){return function(e){return lc(this,null,function*(){return r({type:z.EVAL_OBJECT,payload:{pageName:e.pageName,updateObject:e.updateObject}})})}.bind(this,{pageName:e,updateObject:t,dispatch:r})}function cc({source:e,lookFor:n,skip:i,locations:o,path:a,dispatch:l,pageName:u,shouldAttachRef:s,skipIf:c=!0}){let t=e;var d;a&&(d=a[a.length-1]||"");const r=[...t];t.length=0;e=r.reduce((e,t,r)=>{r="["+r+"]";return A.isArr(t)?t=cc({source:t,skip:i,lookFor:n,locations:[...o],path:null==a?void 0:a.slice(0,-1).concat(d+r),dispatch:l,pageName:u,shouldAttachRef:s,skipIf:c}):A.isObj(t)?"actionType"in t&&"evalObject"===t.actionType&&t.object&&A.isObj(t.object)||A.isArr(t.object)||(t=dc({source:t,skip:i,lookFor:n,locations:[...o],path:null==a?void 0:a.slice(0,-1).concat(d+r),dispatch:l,pageName:u,shouldAttachRef:s,skipIf:c})):"string"==typeof t&&(t=Uo({source:t,skip:i,lookFor:n,locations:[...o],path:null==a?void 0:a.slice(0,-1).concat(d+r),dispatch:l,shouldAttachRef:s,pageName:u})),e.push(t),e},[]);return t.push(...e),r.length=0,t}function dc({source:e={},lookFor:i,locations:o,skip:a=[],path:l=[],dispatch:u,pageName:s,skipIf:c=!0,shouldAttachRef:d}){var f,p,h;let v=e;for(const y of A.keys(v)){let e=y,t=y.includes("builtIn"),r=!1,n=!1;"if"===y&&c&&(r=!0),t&&a.includes("builtIn")&&(n=!0),"dataKey"===y||a.includes(y)||r||n||(p={source:v[y],skip:a,lookFor:i,path:l.concat(e),dispatch:u,pageName:s},A.isObj(v[y])?O.Identify.action.evalObject(v[y])&&A.isObj(v[y].object)&&!A.isArr(null==(f=v[y])?void 0:f.object)||(v[y]=dc(oc(ic({},p),{locations:[...o],skipIf:c,shouldAttachRef:d}))):A.isArr(v[y])?v[y]=cc(oc(ic({},p),{locations:[...o],skipIf:c,shouldAttachRef:d})):A.isStr(v[y])&&(O.Identify.reference(y)&&!y.startsWith("=.builtIn")?([f,p="",h="get"]=[v,y],A.isObj(f)&&null!=(f=Object.getOwnPropertyDescriptor(f,p))&&f[h]||Yo(y,v,{dispatch:u,locations:[...o],lookFor:i,pageName:s,path:l.concat(e),skip:a,_path_:l.concat(e).join("."),_ref_:y})):(p=O.Identify.reference(v[y]))&&d&&d(y,v[y],v)?Yo(y,v,{dispatch:u,locations:[...o],lookFor:i,pageName:s,path:l.concat(e),skip:a,_path_:l.concat(e).join("."),_ref_:v[y]}):(p&&s&&(h=v[y],g.refs[s]||(g.refs[s]={}),g.refs[s][h]||(g.refs[s][h]={key:y,ref:h,path:l.concat(e).join("."),isLocal:O.Identify.localReference(h)})),v[y]=Uo({dispatch:u,locations:[...o],lookFor:i,pageName:s,path:l.concat(e),source:v[y],skip:a,shouldAttachRef:d}))))}return v}function fc({source:e,lookFor:t,locations:r,skip:n,pageName:i,dispatch:o,shouldAttachRef:a}){let l=e;for(var u of t)l=(A.isStr(l)?Uo:dc)({source:l,lookFor:u,skip:n,locations:[...r],pageName:i,dispatch:o,shouldAttachRef:a});return l}function pc(e){let t=K(e||{});return A.isObj(e)?Object.keys(t).forEach(e=>{t[e]instanceof Uint8Array?t[e]=B.level2SDK.utilServices.uint8ArrayToBase64(t[e]):A.isObj(t[e])?t[e]=pc(t[e]):!A.isArr(t[e])||t[e]instanceof Uint8Array||(t[e]=t[e].map(e=>pc(e)))}):A.isArr(e)&&(t=e.map(e=>pc(e))),t}function hc(e){let t=[];if(e)if("all"===(e=null==e?void 0:e.toString()))t[0]="all";else for(const r of null==e?void 0:e.split(","))t.push(parseInt(r));for(const n of[10316,10317,3001,1005,2002])t.includes(n)||t.push(n);return t}const vc=new class{constructor(){this.stopWords="a about above after again against all am an and any are aren't as at be because been before being below between both but by can't cannot could couldn't did didn't do does doesn't doing don't down during each few for from further had hadn't has hasn't have haven't having he he'd he'll he's her here here's hers herself him himself his how how's i i'd i'll i'm i've if in into is isn't it it's its itself let's me more most mustn't my myself no nor not of off on once only or other ought our ours ourselves out over own same shan't she she'd she'll she's should shouldn't so some such than that that's the their theirs them themselves then there there's these they they'd they'll they're they've this those through to too under until up very was wasn't we we'd we'll we're we've were weren't what what's when when's where where's which while who who's whom why why's with won't would wouldn't you you'd you'll you're you've your yours yourself yourselves json application/json",this.stopWordMap={},this.stopWords.split(" ").forEach(e=>{this.stopWordMap[e]=!0})}isStopWord(e){return!!this.stopWordMap[e]}FilterStopWords(e){return e.split("\\s").filter(e=>!this.isStopWord(e)).toString()}};function yc(e){let t=[];return Ze(e)?t=function e(t){let r=Object.values(t),n=new Map;for(const a of r)if(Ze(a))for(const l of e(a))n.set(l,"");else if(A.isStr(a))for(const u of a.toLowerCase().split(/\W+/))u.length&&!vc.isStopWord(u)&&n.set(u,"");let i=[];for(var o of n.keys())i.push(o);return i}(e):A.isStr(e)&&t.push(e),t}class gc{initialMapping(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.toLowerCase()).replace(/[aeiouy]+/g,"a")).replace("^gh","g")).replace("^g[eiy]","j")).replace("^geo","jo")).replace("^gen","jn")).replace(/chr/g,"kr")).replace(/[aeiou]r/g,"a")).replace(/c[ei]/g,"sa")).replace(/cc/g,"c")).replace(/dd/g,"d")).replace(/gg/g,"g")).replace(/ll/g,"l")).replace(/mm/g,"m")).replace(/nn/g,"n")).replace(/pp/g,"p")).replace(/rr/g,"r")).replace(/ss/g,"s")).replace(/tt/g,"t")).replace(/zz/g,"z")).replace(/gh/g,"")).replace(/ph/g,"f")).replace(/pt/g,"d")).replace(/ti/g,"s")).replace(/ci/g,"s")).replace(/cl/g,"k")).replace(/ng/g,"n")).replace(/gn/g,"n")).replace(/h/g,"")).replace("^i","j")).replace("^u","j")).replace(/[+]/g,"")).replace(/\W/g,"`")).replace(/0/g,"`")).replace(/[123]+/g,"{")).replace(/[456]+/g,"|")).replace(/[789]+/g,"}")).replace("^y","a")}toFuzzyInt64(t){let r=[" ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}"],n=[0,1,2,11,3,1,4,5,0,1,6,7,8,9,9,1,2,10,8,11,3,1,12,12,11,1,11,13,14,15],i=ae.default.BigInt(0);for(let e=0;e<Math.min(t.length,16);e++){var o=t.charAt(e),o="`"===o?0:r.indexOf(o);0<=o&&o<n.length&&(i=ae.default.leftShift(i,ae.default.BigInt(4)),i=ae.default.bitwiseOr(i,ae.default.BigInt(n[o])))}return parseInt(i.toString())}toFuzzyHex(t){let r=[" ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}"],n=["0","1","2","B","3","1","6","5","!","1","6","7","8","9","9","1","2","A","8","B","3","1","C","C","B","1","B","D","E","F"],i="";for(let e=0;e<Math.min(t.length,16);e++){var o=t.charAt(e),o="`"===o?0:r.indexOf(o);0<=o&&o<n.length&&(i+=n[o])}return i}}var mc=Object.getOwnPropertySymbols,bc=Object.prototype.hasOwnProperty,_c=Object.prototype.propertyIsEnumerable,c=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});function Sc(d){const r={[z.ADD_FUNCTION]:e=>c(this,[e],function*({payload:e}){var t,{pageName:e="",fn:r}=e;d.root.actions[e]?(t={dataKey:`actions.${e}.update`,value:r},d.emit({type:T.SET_VALUE,payload:t})):d.emit({type:T.SET_VALUE,payload:{dataKey:"actions."+e,value:{update:r}}})}),[z.EVAL_OBJECT]:e=>c(this,[e],function*({payload:e}){let{pageName:t="",updateObject:r}=e,n;return A.isStr(r)&&(r=yield d.handleEvalString({stringArg:r,pageName:t})),A.isObj(r)?n=yield d.handleEvalObject({object:r,pageName:t}):A.isArr(r)&&(n=yield d.handleEvalArray({array:r,pageName:t})),yield d.dispatch({type:z.POPULATE,payload:{pageName:"Global"}}),yield d.dispatch({type:z.UPDATE_LOCAL_STORAGE}),n}),[z.FONTDB_OPREATE]:e=>c(this,[e],function*({payload:e}){var t=null==e?void 0:e.funcName;if(t)switch(t){case"getLastestDocsByType":return d.indexRepository.getLastestDocsByType(e);case"getAllDocsByType":return d.indexRepository.getAllDocsByType(e)}}),[z.GET_CACHE]:({payload:e})=>d.getApiCache(e.cacheIndex),[z.GET_DATA](e){return c(this,arguments,function*({payload:{dataKey:e="",pageName:t=""}={}}){if(e){const r=e.split(".");return e=m(d.root[t],r),t=()=>m(d.root,r),A.isUnd(e)&&A.isFnc(t)?t():e}})},[z.IF_OBJECT]:e=>c(this,[e],function*({payload:e}){return d.handleIfCommand({pageName:(null==e?void 0:e.pageName)||"",ifCommand:null==e?void 0:e.updateObject})}),[z.INSERT_TO_INDEX_TABLE]:e=>c(this,[e],function*({payload:e}){var t,r,n;let i=[];i=A.isArr(null==(t=e.doc)?void 0:t.doc)?null==(t=e.doc)?void 0:t.doc:e.doc;for(r of A.filter(Boolean,A.array(i))){const a=yc(null==r?void 0:r.name),l=new gc;let e=null==r?void 0:r.id;e instanceof Uint8Array&&(e=B.level2SDK.utilServices.uint8ArrayToBase64(e));for(n of a){var o=l.initialMapping(n),o=l.toFuzzyInt64(o);d.indexRepository.insertIndexData({kText:n,docId:e,docType:r.type,fKey:o,score:0,mtime:r.mtime})}}}),[z.INSERT_TO_OBJECT_TABLE]:e=>c(this,[e],function*({payload:e}){e=e.doc;let t=e.id;t instanceof Uint8Array&&(t=B.level2SDK.utilServices.uint8ArrayToBase64(t));var r=d.indexRepository.getDocById(t);null!=r&&r.length||(null!=(r=d.indexRepository.getDocById(t))&&r.length||d.indexRepository.cacheDoc(e))}),[z.POPULATE](e){return c(this,arguments,function*({payload:e}){let t=(null==e?void 0:e.pageName)||"",r=K(d.root[t]);for(const n of[".","..","~"])r=dc({source:r,lookFor:n,locations:"~"==n?[d]:[d.root,d.root[t]]});r=uc({cadlObject:r,dispatch:d.dispatch.bind(d)}),d.emit({type:T.SET_ROOT_PROPERTIES,payload:{properties:{[t]:r}}}),yield d.dispatch({type:z.UPDATE_LOCAL_STORAGE})})},[z.POPULATE_OBJECT](e){return c(this,arguments,function*({payload:{copy:e=!1,object:t,pageName:r=""}={}}){return dc({source:e?K(t):t,lookFor:"=",locations:[d.root,d.root[r]]})})},[z.SEARCH_CACHE](e){return c(this,arguments,function*({payload:{key:e="",sCondition:t=""}={}}){return yield d.indexRepository.search(e,t)})},[z.SET_API_BUFFER](e){return c(this,arguments,function*({payload:o}){var a,l,u,s,o=null==o?void 0:o.apiObject;try{let e="test"===B.env?60:3,t=oe.default.stringify(ie.default(JSON.stringify(o))),r=f.default(Date.now()),n=d.root.apiCache,i=!1;i=!(t in n)||(l=f.default(null==(a=n[t])?void 0:a.timestamp),r.diff(l,"seconds")>e?(n[t].timestamp=r.toString(),!0):!(n[t+"FAILED_REPEAT"]={timestamp:r.toString(),request:o}));for([u,s]of A.entries(n))r.diff(null==s?void 0:s.timestamp,"seconds")>e&&delete n[u];return{pass:i,cacheIndex:t}}catch(e){return L.default.error(e instanceof Error?e:new Error(String(e))),{pass:!1,cacheIndex:hash}}})},[z.SET_CACHE](e){return c(this,arguments,function*({payload:e}){d.emit({type:T.SET_CACHE,payload:e})})},[z.UPDATE_DATA](e){return c(this,arguments,function*({payload:i}){let{pageName:o="",dataKey:a,data:e}=i||{},l=pc(e),u=a?a.split("."):"";if("builtIn"===o)d.emit({type:T.SET_VALUE,payload:{dataKey:u,value:l}});else{if(!a)return;{[i=""]=[a];let e=!(!i||!A.isStr(i)||i[0]!==i[0].toUpperCase()),t=m(e?d.root:d.root[o],u),r,n=!1;if(null!=(r=A.isArr(t)?A.array(l):e?A.isArr(l)?l[0]:l:A.isObj(t)&&A.isArr(l)?l.length?1==l.length&&l[0]||void 0:t:l)&&r.jwt)for(const c of["doc","edge","vertex"])if(A.isArr(r[c])&&!r[c].length){n=!0;break}const s={dataKey:u,value:r,replace:n};e||(s.pageName=o),d.emit({type:T.SET_VALUE,payload:s})}}yield d.dispatch({type:z.UPDATE_LOCAL_STORAGE})})},[z.UPDATE_LOCAL_STORAGE]:()=>c(this,null,function*(){var e;A.isBrowser()&&localStorage.getItem("esk")&&(e=((e,t)=>{var r={};for(n in e)bc.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&mc)for(var n of mc(e))t.indexOf(n)<0&&_c.call(e,n)&&(r[n]=e[n]);return r})(null==(e=d.root)?void 0:e.Global,["globalRegister"]),localStorage.setItem("Global",JSON.stringify(e)))}),[z.PULL_INDEX_TABLE]:e=>c(this,[e],function*({payload:t}){var r;const n=d.indexRepository.PersonalIndexCtr;if(null!=n&&n.indexTablesDao){let e=yield o({type:z.GET_DATA,payload:{dataKey:"Global.currentUser.vertex.deat.rnb64ID"}});var i=()=>c(this,null,function*(){yield n.restorePI()});null!=(r=null==d?void 0:d.config)&&r.platform&&"admin"===(null==(r=null==d?void 0:d.config)?void 0:r.platform)&&(e=yield n.getAdminConnectedEdgeId()),n.setRootNoteBookId(e),"admin"===(null==(r=null==d?void 0:d.config)?void 0:r.platform)&&null!=t&&t.isAdmin&&i(),null!=(r=null==d?void 0:d.config)&&r.platform&&"admin"===(null==(t=null==d?void 0:d.config)?void 0:t.platform)||i()}}),[z.PUSH_INDEX_TABLE]:()=>c(this,null,function*(){const e=d.indexRepository.PersonalIndexCtr;null!=e&&e.indexTablesDao&&c(this,null,function*(){yield e.backUpPI()})})},o=e=>{var t;return null==(t=r[null==e?void 0:e.type])?void 0:t.call(r,e)};return o}var Ec=function(e,t,r){(void 0===r||Pt(e[t],r))&&(void 0!==r||t in e)||Dr(e,t,r)},R=Function.prototype,J=Object.prototype,Oc=R.toString,Tc=J.hasOwnProperty,wc=Oc.call(Object);var Ac=function(e){return!(!Ge(e)||"[object Object]"!=We(e))&&(null===(e=hn(e))||"function"==typeof(e=Tc.call(e,"constructor")&&e.constructor)&&e instanceof e&&Oc.call(e)==wc)};var Dc=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]};var Ic=function(e){return jr(e,rn(e))};var xc=function(e,t,r,n,i,o,a){var l,u,s,c=Dc(e,r),d=Dc(t,r),f=a.get(d);f||((t=void 0===(f=o?o(c,d,r+"",e,t,a):void 0))&&(u=!(l=h(d))&&Lr(d),s=!l&&!u&&zr(d),f=d,l||u||s?f=h(c)?c:os(c)?an(c):u?on(d,!(t=!1)):s?Mn(d,!(t=!1)):[]:Ac(d)||Rr(d)?Rr(f=c)?f=Ic(c):v(c)&&!Jt(c)||(f=Gn(d)):t=!1),t&&(a.set(d,f),i(f,d,n,o,a),a.delete(d))),Ec(e,r,f)};var jc=function n(i,o,a,l,u){i!==o&&uu(o,function(e,t){var r;u=u||new Tr,v(e)?xc(i,o,t,a,n,l,u):(r=l?l(Dc(i,t),e,t+"",i,o,u):void 0,Ec(i,t,r=void 0===r?e:r))},rn)};var Nc=function(l){return wu(function(e,t){var r=-1,n=t.length,i=1<n?t[n-1]:void 0,o=2<n?t[2]:void 0,i=3<l.length&&"function"==typeof i?(n--,i):void 0;for(o&&vl(t[0],t[1],o)&&(i=n<3?void 0:i,n=1),e=Object(e);++r<n;){var a=t[r];a&&l(e,a,r,i)}return e})}(function(e,t,r){jc(e,t,r)});function kc(e){return function({type:s,payload:c}){return e(u=>ee.default(u,r=>{switch(s){case T.ADD_BUILTIN_FNS:return void A.forEach(([e,t])=>p(r.builtIn,e,t),A.entries(c.builtInFns));case T.DELETE_PAGE:return void delete r[c.pageName];case T.EDIT_DRAFT:return void(null==(n=null==c?void 0:c.callback)||n.call(c,r,{getCurrent:N.current,getOriginal:N.original}));case T.SET_CACHE:var{cacheIndex:n,data:i}=c,o=f.default(Date.now()).toString();return void p(r.apiCache,n,{data:i,timestamp:o});case T.SET_LOCAL_PROPERTIES:case T.SET_ROOT_PROPERTIES:A.entries(c.properties).forEach(([e,t])=>{p(s===T.SET_ROOT_PROPERTIES?r:r[c.pageName],e,t)});break;case T.SET_VALUE:var{pageName:n,dataKey:i,value:o,replace:a}=c;let e,t=o;if(a||(e=A.isUnd(n)?m(u,i):m(u[n],i)),A.isObj(e)&&A.isObj(t))if("doc"in t)if(!A.isArr(e.doc)&&A.isArr(t.doc)){const l=e.doc;e.doc=[],null!=l&&l.id&&A.isStr(l.id)&&!t.doc.every(e=>(null==e?void 0:e.id)===l.id)&&e.doc.push(l),e.doc.push(...t.doc)}else!A.isArr(e.doc)&&A.isObj(t.doc)?e.doc=t.doc:"id"in e?t=function t(r,n){let i=r;return Ze(r)&&Ze(n)&&Object.keys(n).forEach(e=>{Ze(n[e])?e in r&&Ze(r[e])?i[e]=t(r[e],n[e]):i[e]=n[e]:null===n[e]&&null!==r[e]?i[e]=r[e]:i[e]=n[e]}),i=void 0===n&&Ze(r)?n:i}(e,t.doc):(e.doc.length=0,e.doc.push(...t.doc));else t=Nc(e,t);else A.isArr(e)&&A.isArr(t)?e!==t&&(e.length=0,e.push(...t)):p(void 0===n?r:r[n],i,t)}}))}}function Cc(r=""){return e=this,a=null,l=function*(){let e="",t;try{try{e=(yield ne.default.get(r)).data}catch(e){throw new _e("Unable to retrieve yaml for "+r,e instanceof Error?e:new Error(String(e)))}try{t=function(e=""){try{return le.default.parse(e,{prettyErrors:!0,schema:"core",version:"1.2"})}catch(e){return L.default.error(e instanceof Error?e:new Error(String(e))),{}}}(e)}catch(e){throw new be("Unable to parse yaml for "+r,e instanceof Error?e:new Error(String(e)))}}catch(e){throw e instanceof Error?e:new Error(String(e))}return[t,e]},new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});var e,a,l}function Rc(e){var t;return A.isObj(e)&&null!=(t=null==(e=A.keys(e)[0])?void 0:e.startsWith)&&t.call(e,"=")}var Pc,Lc=a=>{return{getDocById:function(e,t=void 0){t=`SELECT * FROM ecos_doc_table WHERE id = :did ${t?"AND "+t:""} LIMIT 1`,e={":did":e};return a.exec(t,e)},getDocByIds:function(n){let i="SELECT * FROM ecos_doc_table WHERE id IN(",o={};return n.forEach((e,t)=>{var r=":did"+t;i+=r+(t===n.length-1?")":","),o[r]=e}),a.exec(i,o)},insertDoc:function(e){let t={};L.default.debug("insertdoc!!",e);for(var[r,n]of Object.entries(e))n instanceof Uint8Array?t[":"+r]=B.level2SDK.utilServices.uint8ArrayToBase64(n):Ze(n)?t[":"+r]=JSON.stringify(n):t[":"+r]=n;return a.exec("INSERT INTO ecos_doc_table VALUES (:ctime, :mtime, :atime, :atimes, :id, :name, :deat, :size, :fid, :eid, :bsig, :esig, :subtype, :type, :tage);",t)},deleteDocById:function(e){e={":did":e};return a.exec("DELETE FROM ecos_doc_table WHERE id = :did",e)},getDocsByPageId:function(e){e="SELECT * FROM ecos_doc_table WHERE pageId = "+e;return a.exec(e)},getLastestDocsByType:function(e){e=`SELECT id FROM ecos_doc_table WHERE type = ${e} LIMIT 1 `;return a.exec(e)},getAllDocsByType:function(e){e="SELECT * FROM ecos_doc_table WHERE type = "+e,e=a.exec(e);return e=function(e){let t=[];if(e.length){var{columns:r,values:e}=e[0];for(const n of e){const i={};for(let e=0;e<n.length;e++)i[r[e]]=n[e];t.push(i)}return t}}(e)}}},Bc=c=>{return{getCount:function(){var e=c.exec("SELECT COUNT(*) FROM index_tables");return console.log(e),e[0].values[0][0]},extendAndFuzzySearch:function({kInput:t,ins_hex:r,docType:n,docTypeLow:i,docTypeHigh:o}){let e="SELECT * FROM index_tables WHERE printf('%X', fKey) LIKE '%'|| :ins_hex ||'%' OR kText LIKE :kInput || '%'",a={":ins_hex":r,":kInput":t};n?(e="SELECT * FROM index_tables WHERE docType = :docType AND (printf('%X', fKey) LIKE '%'|| :ins_hex ||'%' OR kText LIKE :kInput || '%'  )",a={":docType":n,":ins_hex":r,":kInput":t}):i&&o&&(e="SELECT * FROM index_tables WHERE docType BETWEEN :docTypeLow AND :docTypeHigh AND (printf('%X', fKey) LIKE '%'|| :ins_hex ||'%' OR kText LIKE :kInput || '%'  )",a={":docTypeLow":i,":docTypeHigh":o,":ins_hex":r,":kInput":t});const l=c.exec(e,a);if(l&&A.isArr(l)&&null!=l&&l.length){var{columns:n,values:i}=l[0];for(const u of i)u[4]=se.default.jarowinkler(t,u[1],1);o=oa.orderBy(i,function(e){return e[4]},"desc");console.log("ngram sort",{sortValues:o});let e=[];for(const s of o)e.push([s[2]]);r=[n[2]];l[0]={columns:r,values:e}}return l},getPIByDocId:function(e){e={":did":e};return c.exec("SELECT * FROM index_tables WHERE docId = :did",e)},deleteIndexByDocId:function(e){e={":did":e};return c.exec("DELETE FROM index_tables WHERE docId = :did",e)},getAllDocId:function(){return c.exec("SELECT DISTINCT docId FROM index_tables")},getAllkTextByDid:function(e){e={":did":e};return c.exec("SELECT kText FROM index_tables WHERE docId = :did ORDER BY score",e)},getAllScoreByDid:function(e){e={":did":e};return c.exec("SELECT score FROM index_tables WHERE docId = :did ORDER By score",e)},getmTimeById:function(e){e={":did":e};return c.exec("SELECT DISTINCT mTime FROM index_tables WHERE docId = :did",e)},getTypeById:function(e){e={":did":e};return c.exec("SELECT DISTINCT docType FROM index_tables WHERE docId = :did",e)},insertAll:function(e){let t={};for(var[r,n]of Object.entries(e))n instanceof Uint8Array?t[":"+r]=B.level2SDK.utilServices.uint8ArrayToBase64(n):t[":"+r]=n;return c.exec("INSERT INTO index_tables VALUES (:fKey , :kText , :docId , :docType , :score);",t)},getPI_mtime:function(){var e=c.exec("SELECT mTime FROM index_tables ORDER BY mtime desc LIMIT 1");{var t;if(e.length)return{columns:t,values:e}=e[0],e[0][0]}return 0},getLatestDocId:function(){var e=c.exec("SELECT docId FROM index_tables LIMIT 1");{var t;if(e.length)return{columns:t,values:e}=e[0],e[0][0]}},getAllDoc:function(){return c.exec("SELECT * FROM index_tables")},indexTableIsEmpty:function(){return!c.exec("SELECT COUNT(*) FROM index_tables")[0].values[0][0]}}},Uc=r=>{return{getApiResult:function(e){e={":api_input_hash":e};let t=r.exec("SELECT resultId FROM api_hash_table WHERE api_input_hash = :api_input_hash",e);return t=t.length?t[0].values[0]:t},insertApiResult:function(e,t){e={":api_input_hash":e,":api_result":t};return r.exec("INSERT INTO api_hash_table VALUES (:api_input_hash, :api_result );",e)},deleteApiResult:function(e){e={":api_input_hash":e};let t=r.exec("DELETE FROM api_hash_table WHERE api_input_hash = :api_input_hash",e);return t=t.length?t[0].values[0][0]:t}}},Fc=(e,t,r)=>{var n=e,i="read from private field";if(t.has(n))return r?r.call(e):t.get(e);throw TypeError("Cannot "+i)};class Kc{constructor(){this.databaseName="AiTMeet.db";var e=this,t=Pc,r={initialized:!1};if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)}getDatabase(t){return e=this,a=null,l=function*(){if(!Fc(this,Pc).initialized){L.default.debug("test",t);const e=yield ue.default(t);this.INSTANCE=new e.Database;this.INSTANCE.run("CREATE TABLE ecos_doc_table (ctime int, mtime int, atime int, atimes int, id char not null primary key,           name char,deat char, size int, fid char, eid char, bsig char, esig char, subtype int, type int, tage int);"),this.INSTANCE.run("CREATE TABLE index_tables (fkey int, kText char, docId char, docType int, score int);"),this.INSTANCE.run("CREATE TABLE api_hash_table (api_input_hash char, resultId char);"),this.DocTableDao=Lc(this.INSTANCE),this.IndexTablesDao=Bc(this.INSTANCE),this.ApiHashTableDao=Uc(this.INSTANCE)}return this.INSTANCE},new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});var e,a,l}get initialized(){return Fc(this,Pc).initialized}}Pc=new WeakMap;class Mc{constructor(e,t,r){this.fuzzyIndexCreator=new gc,this.id=e,this.kText=t,this.docType=r}convertIdxToDoc(){let e=[];for(const i of this.kText){var t=this.fuzzyIndexCreator.initialMapping(i),r=this.fuzzyIndexCreator.toFuzzyInt64(t),n=this.fuzzyIndexCreator.toFuzzyHex(t),r={docId:this.id,docType:this.docType,kText:i,fKey:r,fKeyHex:n,initMapping:t,score:0};e.push(r)}return e}}class zc{constructor(e){this.indexTablesDao=e}DBStoJSON(){const e=new Array,t=null==(r=this.indexTablesDao)?void 0:r.getAllDocId();if(t&&null!=t&&t.length){var r=t[0]["values"];for(const a of r){var n=a[0],i=this.indexTablesDao.getAllkTextByDid(n),o=this.indexTablesDao.getTypeById(n),i=A.reduce(i[0].values,(e,t)=>e.concat(t),[]),o=o[0].values[0][0];e.push({docType:o,id:n,kText:i})}return JSON.stringify(e)}}converS3ToDBS(t){try{if(A.isArr(t)){for(let e=0;e<t.length;e++){var r=t[e];for(const n of new Mc(r.id,r.kText,r.docType).convertIdxToDoc())this.indexTablesDao.insertAll(n)}return!0}}catch(e){console.log(e)}return!1}}var qc=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});class Vc{constructor(e){this.mTime=0,this.indexTablesDao=e,this.isadmin=!1}backUpPI(i){return qc(this,null,function*(){var e=this.rootNoteBookId,t=this.getUser_Vid(),r=new zc(this.indexTablesDao).DBStoJSON();let n={content:r};if(i)n.eid=null==i?void 0:i.eid,n.id=null==i?void 0:i.id;else{t=yield this.retrievePersonalIndex(t);if(0!=t.code)return console.log("Retrieve personal index failed with code "+t.code),!1;t=null==t?void 0:t.document;r&&t&&t.length&&(i=t[0],n.eid=null==i?void 0:i.eid,n.id=null==i?void 0:i.id)}return i||(n.eid=e),yield this.uploadPersonalIndex(n)})}retrievePersonalIndex(e){return qc(this,null,function*(){var e=[this.rootNoteBookId];let r;return yield B.level2SDK.documentServices.retrieveDocument({idList:e,options:{xfname:"eid",type:"1793",obfname:"mtime"}}).then(e=>{r=e.data;var t,e=A.reduce(A.array(null==(e=null==e?void 0:e.data)?void 0:e.document),(e,t)=>A.isNil(t)?e:e.concat(t),[]);return Promise.allSettled(null==(t=e.map)?void 0:t.call(e,n=>qc(this,null,function*(){if(null!=(r=null==n?void 0:n.deat)&&r.url)return n;{let t;try{t=yield pa({document:n})}catch(e){var r=e instanceof Error?e:new Error(String(e));console.error(r,{note:t,error:r,document:n})}return t}})))}).then(e=>{delete r.document,r.document=e.reduce((e,t)=>{var{status:t,value:r}=t;return"fulfilled"!==t||A.isNil(r)?e:e.concat(r)},[])}),r})}uploadPersonalIndex(r){return qc(this,null,function*(){let e;var t=yield((e,t)=>{let r;if("string"==typeof e)r=new Blob([e],{type:t});else if(e instanceof Blob)r=e;else try{var n=JSON.stringify(e);r=new Blob([n],{type:"application/json"})}catch(e){throw new P({name:"NOTE_CONTENT_INVALID",message:(e instanceof Error?e:new Error(String(e))).message})}return r})(null==r?void 0:r.content,"application/json");return 0===(null==(e=null!=r&&r.id?yield B.level2SDK.documentServices.updateDocument({id:null==r?void 0:r.id,fid:null==r?void 0:r.id,eid:null==r?void 0:r.eid,subtype:2,size:t.size,type:1793}):yield B.level2SDK.documentServices.createDocument({eid:null==r?void 0:r.eid,type:1793,subtype:2,size:t.size}))?void 0:e.code)&&(yield this.uploadFileToS3_low(null==(t=null==e?void 0:e.data)?void 0:t.document,null==r?void 0:r.content)),e})}uploadFileToS3_low(t,r){return qc(this,null,function*(){var e=null==t?void 0:t.deat;null!==e&&e&&e.url&&r&&(yield B.level2SDK.documentServices.uploadDocumentToS3({url:e.url,sig:e.sig,data:r}).then(B.responseCatcher).catch(B.errorCatcher))})}getPIData(n){return qc(this,null,function*(){var e=n.subtype;if(null!=e&&e.isOnServer)console.log("personal index should not be on server");else{var t,e=null==n?void 0:n.deat,r=null==e?void 0:e.url;try{if(e&&r)return null==(t=yield B.level2SDK.documentServices.downloadDocumentFromS3({url:r}))?void 0:t.data}catch(e){console.log(e)}}return null})}restorePI(){return qc(this,null,function*(){var e;if(!this.indexTablesDao.indexTableIsEmpty)return console.log("Local Index Table is not empty, skipping the restore"),!1;console.log("Index Table is empty.. going to check from S3");var t=this.getUser_Vid(),t=yield this.retrievePersonalIndex(t);if(0!=t.code)return console.log("Retrieve personal index failed with code "+t.code),!1;t=null==t?void 0:t.document;let r;return t&&t.length?(r=t[0],null==(t=yield this.getPIData(r))&&console.log("getPIData failed"),this.PI_docID=null==(e=t[0])?void 0:e.id,new zc(this.indexTablesDao).converS3ToDBS(t),console.log("restorePI success")):console.log("restorePI did not find a document"),yield this.updatePI_mtime(),yield this.backUpPI(r),!0})}retrieveLatestDoc(e,t){return qc(this,null,function*(){let r;return yield B.level2SDK.documentServices.retrieveDocument({idList:[e],options:{ObjType:1344,scondition:"D.type not in (1793)",asc:!1,obfname:"D.mtime",loid:t}}).then(e=>{r=e.data;var t,e=A.reduce(A.array(null==(e=null==e?void 0:e.data)?void 0:e.document),(e,t)=>A.isNil(t)?e:e.concat(t),[]);return Promise.allSettled(null==(t=e.map)?void 0:t.call(e,n=>qc(this,null,function*(){if(null!=(r=null==n?void 0:n.deat)&&r.url)return n;{let t;try{t=yield pa({document:n})}catch(e){var r=e instanceof Error?e:new Error(String(e));console.error(r,{note:t,error:r,document:n})}return t}})))}).then(e=>{delete r.document,r.document=e.reduce((e,t)=>{var{status:t,value:r}=t;return"fulfilled"!==t||A.isNil(r)?e:e.concat(r)},[])}).catch(e=>{console.error(e instanceof Error?e:new Error(String(e)))}),r})}getPI_mtime(){return this.indexTablesDao.getPI_mtime()}updatePI_mtime(){return qc(this,null,function*(){var e=this.indexTablesDao.getLatestDocId(),t=(new Date).getTime(),r=this.getUser_Vid(),r=yield this.retrieveLatestDoc(r,e);return this.mTime=t,this.insertIndexTable(r)})}insertIndexTable(e){var t;if(null!=(i=null==e?void 0:e.document)&&i.length){var r,n,i=null==e?void 0:e.document;for(r of A.filter(Boolean,A.array(i))){const l=yc(null==(t=null==r?void 0:r.name)?void 0:t.data),u=new gc;let e=null==r?void 0:r.id;e instanceof Uint8Array&&(e=B.level2SDK.utilServices.uint8ArrayToBase64(e)),console.log("insert doc",{item:r});for(n of l){var o=u.initialMapping(n),o=u.toFuzzyInt64(o),a=this.indexTablesDao.getPIByDocId(null==r?void 0:r.id);a.length?(a[0],this.indexTablesDao.deleteIndexByDocId(null==r?void 0:r.id),this.indexTablesDao.insertAll({kText:n,docId:e,docType:r.type,fKey:o,score:0})):this.indexTablesDao.insertAll({kText:n,docId:e,docType:r.type,fKey:o,score:0,mtime:r.mtime})}}return!0}return!1}getUser_Vid(){return this.user_vid=localStorage.getItem("facility_vid")?localStorage.getItem("facility_vid"):localStorage.getItem("user_vid"),this.user_vid}isAdmin(){return qc(this,null,function*(){var e=[this.getUser_Vid()];return yield B.level2SDK.vertexServices.retrieveVertex({idList:[],options:{ObjType:"4",scondition:"E.type in (1100,1200) AND V.type=20",xfname:"E.bvid",ids:e}}).then(e=>{e=null==(e=null==e?void 0:e.data)?void 0:e.vertex;e&&e.length&&(this.isadmin=!0)}),this.isadmin})}getAdminConnectedEdgeId(){return qc(this,null,function*(){var e=localStorage.getItem("facility_vid"),e=[localStorage.getItem("user_vid"),e];let t,r;return yield B.level2SDK.edgeServices.retrieveEdge({idList:e,options:{scondition:"type in (1100,1200)",xfname:"bvid,evid"}}).then(e=>{e=null==(e=null==e?void 0:e.data)?void 0:e.edge;e&&e.length&&(t=pc(t=e[0]),r=null==t?void 0:t.eid)}),r})}setRootNoteBookId(e){this.rootNoteBookId=e}}var Wc=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});class Gc{constructor(){this.userDB=new Kc}search(v,y){return Wc(this,null,function*(){var e;if(v){const a=new gc,l=a.initialMapping(v),u=a.toFuzzyHex(l),s=null==(e=this.indexTablesDao)?void 0:e.extendAndFuzzySearch({kInput:v,ins_hex:u});L.default.debug("fuzzysearch",v,s);let t=[];if(!s.length)return t;const c=s[0]["values"],d=c.reduce((e,t)=>(e.includes(t[0])||e.push(t[0]),e),[]);t=this.getDocsByIds(d,y),console.log("test",t);let r=[];for(let e=0;e<t.length;e++){var n=t[e];if(null!=n&&n.length){const f={},{columns:p,values:h}=n[0];for(let e=0;e<p.length;e++){var i=p[e],o=h[0][e];["deat","name"].includes(i)?f[i]=JSON.parse(o):f[i]=o}r.push(f)}else{n=yield this.getS3DocById(d[e]);r.push(null==n?void 0:n.document[0])}}return r}})}getS3DocById(r){return Wc(this,null,function*(){let t;yield B.level2SDK.documentServices.retrieveDocument({idList:[r],options:{xfname:"id"}}).then(e=>{t=null==e?void 0:e.data});var e=null==t?void 0:t.document[0];return this.cacheDoc(e),t})}getDataBase(e){return Wc(this,null,function*(){e&&(yield this.userDB.getDatabase(e),this.docTableDao=this.userDB.DocTableDao,this.indexTablesDao=this.userDB.IndexTablesDao,this.PersonalIndexCtr=new Vc(this.indexTablesDao))})}indexTableIsEmpty(){var e;return 0===(null==(e=this.indexTablesDao)?void 0:e.getCount())}insertIndexData(e){var t;null!=(t=this.indexTablesDao)&&t.insertAll(e)}getTypeById(e){var t;return null==(t=this.indexTablesDao)?void 0:t.getTypeById(e)}deleteIndexByDocId(e){var t;null!=(t=this.indexTablesDao)&&t.deleteIndexByDocId(e)}getPIByDocId(e){var t;return null==(t=this.indexTablesDao)?void 0:t.getPIByDocId(e)}getkTextByDid(e){var t;return null==(t=this.indexTablesDao)?void 0:t.getAllkTextByDid(e)}getAllDocId(){var e;return null==(e=this.indexTablesDao)?void 0:e.getAllDocId()}getAllDocByFkey({kInput:e,ins_hex:t}){var r;return null==(r=this.indexTablesDao)?void 0:r.extendAndFuzzySearch({kInput:e,ins_hex:t})}getDocById(e){var t,r;return null==(r=null==(t=this.docTableDao)?void 0:t.getDocById)?void 0:r.call(t,e)}cacheDoc(e){var t;null!=(t=this.docTableDao)&&t.insertDoc(e)}deleteCachedDocById(e){var t;return null==(t=this.docTableDao)?void 0:t.deleteDocById(e)}getDocsByIds(e,t){var r,n,i;let o=[];for(i of e)o.push(null==(n=null==(r=this.docTableDao)?void 0:r.getDocById)?void 0:n.call(r,i,t));return o}getDocsByPageId(e){var t;return null==(t=this.docTableDao)?void 0:t.getDocsByPageId(e)}getLastestDocsByType(e){var t;return null==(t=this.docTableDao)?void 0:t.getLastestDocsByType(null==e?void 0:e.type)}getAllDocsByType(e){var t;return null==(t=this.docTableDao)?void 0:t.getAllDocsByType(null==e?void 0:e.type)}}let Hc=0;var Jc=Object.defineProperty,$c=Object.defineProperties,Yc=Object.getOwnPropertyDescriptors,Xc=Object.getOwnPropertySymbols,Qc=Object.prototype.hasOwnProperty,Zc=Object.prototype.propertyIsEnumerable,ed=(e,t,r)=>t in e?Jc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,td=(e,t)=>{for(var r in t=t||{})Qc.call(t,r)&&ed(e,r,t[r]);if(Xc)for(var r of Xc(t))Zc.call(t,r)&&ed(e,r,t[r]);return e},rd=(e,t,r)=>{var n=e,i="read from private field";if(t.has(n))return r?r.call(e):t.get(e);throw TypeError("Cannot "+i)},nd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)};class id{constructor(){nd(this,bd,{ids:{},queue:[],history:[]}),nd(this,_d,{queue:[]})}getState(){return rd(this,bd)}getHelpers(){return{getState:this.getState.bind(this),getSubscribers:this.getSubscribers.bind(this)}}getSubscribers(){return rd(this,_d)}create(e){const t=td({id:String(++Hc),timestamp:(new Date).toISOString()},e),r=this.getState();return r.queue.push(t),r.ids[t.id]={type:t.type},this.publish(ho.QUEUE_START,t,this.getHelpers()),t}remove(e,t){const{queue:r,history:n,ids:i}=this.getState();if(r.includes(e)){for(;1e4<n.length;)n.shift();var o=(new Date).toISOString();n.push((t=td(td(td({},A.pick(e,["id","kind","operator"])),e.error?{error:e.error}:void 0),t),o={timestamp:o,time:f.default(o).diff(new Date(e.timestamp).getTime(),"ms")},$c(t,Yc(o)))),r.splice(r.indexOf(e),1),delete i[e.id],this.publish(ho.QUEUE_END,e,this.getHelpers())}}on(e,t){switch(e){case ho.QUEUE_START:case ho.QUEUE_END:return void(rd(this,_d).queue.includes(t)||rd(this,_d).queue.push(t))}}publish(e,...t){switch(e){case ho.QUEUE_START:case ho.QUEUE_END:return void this.getSubscribers().queue.map(e=>e(...t))}}}var od,ad,ld,ud,sd,cd,dd,fd,pd,hd,vd,yd,gd,md,bd=new WeakMap,_d=new WeakMap,Sd=Object.defineProperty,Ed=Object.defineProperties,Od=Object.getOwnPropertyDescriptors,Td=Object.getOwnPropertySymbols,wd=Object.prototype.hasOwnProperty,Ad=Object.prototype.propertyIsEnumerable,Dd=(e,t,r)=>t in e?Sd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Id=(e,t)=>{for(var r in t=t||{})wd.call(t,r)&&Dd(e,r,t[r]);if(Td)for(var r of Td(t))Ad.call(t,r)&&Dd(e,r,t[r]);return e},xd=(e,t)=>Ed(e,Od(t)),jd=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},b=(e,t,r)=>(jd(e,t,"read from private field"),r?r.call(e):t.get(e)),_=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},S=(e,t,r,n)=>(jd(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),w=(e,a,l)=>new Promise((t,r)=>{var n=e=>{try{o(l.next(e))}catch(e){r(e)}},i=e=>{try{o(l.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((l=l.apply(e,a)).next())});N.setAutoFreeze(!1);class Nd{constructor({configUrl:e,cadlVersion:t,aspectRatio:r,dbConfig:n,loglevel:i,SearchClient:o}){_(this,od,1),_(this,ad,{}),_(this,ld,null),_(this,ud,void 0),_(this,sd,""),_(this,cd,""),_(this,dd,void 0),_(this,fd,void 0),_(this,pd,void 0),_(this,hd,{init:{initiating:!1,done:!1,error:null}}),_(this,vd,{queue:[]}),_(this,yd,void 0),_(this,gd,void 0),_(this,md,void 0),this.cadlEndpoint=null,this.initCallQueue=[],this.myBaseUrl="",this.verificationRequest={timer:0,phoneNumber:""},B.env=t,B.configUrl=e,B.noodlInstance=this,i&&L.default.setLevel(i),this.cadlVersion=t,r&&(this.aspectRatio=r),S(this,yd,n),S(this,gd,new Gc),S(this,dd,Sc(this)),S(this,fd,kc(e=>this.root=e(this.root))),S(this,pd,ee.default({},e=>{e.actions={},e.builtIn=Bs({dispatch:this.dispatch.bind(this),processPopulate:this.processPopulate.bind(this),getPage:this.getPage.bind(this),emit:this.emit.bind(this),SearchClient:o}),e.apiCache={}})),S(this,md,new id)}[Symbol.for("nodejs.util.inspect.custom")](){return{assetsUrl:this.assetsUrl,cadlBaseUrl:this.cadlBaseUrl,cadlEndpoint:this.cadlEndpoint,cadlVersion:this.cadlVersion,myBaseUrl:this.myBaseUrl,state:this.getState()}}get dispatch(){return b(this,dd)}get emit(){return b(this,fd)}get indexRepository(){return b(this,gd)}init(){return w(this,arguments,function*({onFetchPreload:t,use:r}={}){var n;let e;try{e=(null==r?void 0:r.config)||(yield B.level2SDK.loadConfigData())}catch(e){throw new Oe("An error occured while trying to load the config",e instanceof Error?e:new Error(String(e)))}yield b(this,gd).getDataBase(b(this,yd)),Lo()&&null!=e&&e.isGetPosition&&window.navigator.geolocation.getCurrentPosition(e=>{var t=e.coords.longitude,e=e.coords.latitude;B.currentLatitude=e,B.currentLongitude=t,localStorage.setItem("longitude",JSON.stringify(t)),localStorage.setItem("latitude",JSON.stringify(e))},e=>{let t="";switch(e.code){case e.PERMISSION_DENIED:t="User rejects request to get geolocation.";break;case e.POSITION_UNAVAILABLE:t="Location information is not available.";break;case e.TIMEOUT:t="Requesting user geolocation timed out.";break;default:t="Error: "+(e.message||"unknown error")}L.default.error(t)},{enableHighAccuracy:!0,timeout:3e3,maximumAge:6e4});var{web:i={cadlVersion:""},cadlBaseUrl:o="",cadlMain:a="",designSuffix:l="",myBaseUrl:u=""}=e,i=(this.cadlVersion=i.cadlVersion[this.cadlVersion],S(this,ad,l),this.cadlBaseUrl=o,this.myBaseUrl=u,""+this.cadlBaseUrl+a),{baseUrl:l="",assetsUrl:o="",preload:u}=(this.cadlEndpoint=(null==r?void 0:r.cadlEndpoint)||(yield Cc(i))[0],this.cadlEndpoint||{}),a=(this.baseUrl=l,this.assetsUrl=o,S(this,ld,this.processPopulate({source:e,lookFor:[".","..","=","~"]})),this.emit({type:T.SET_ROOT_PROPERTIES,payload:{properties:{Config:b(this,ld)}}}),u||[]);for(const d of a){let e=null==r?void 0:r[d];e||(null!=t&&t(d,b(this,ld),this.cadlEndpoint),e=null==(n=yield this.getPage(d))?void 0:n[0]),this.emit({type:T.SET_ROOT_PROPERTIES,payload:{properties:this.processPopulate({source:e,lookFor:[".","..","=","~"]})}})}let s=Lo()&&localStorage.getItem("Global"),c=null;if(s){try{c=JSON.parse(s)}catch(e){L.default.error(e instanceof Error?e:new Error(String(e)))}if(c){this.emit({type:T.SET_ROOT_PROPERTIES,payload:{properties:{Global:xd(Id({},c),{globalRegister:null==(i=this.root.Global)?void 0:i.globalRegister})}}});const f=null==c?void 0:c.currentUser,p=null==f?void 0:f.vertex,h=A.isBrowser()?window.localStorage:null;h&&(!h.getItem("jwt")&&f.JWT&&h.setItem("jwt",f.JWT),!h.getItem("pk")&&p.pk&&h.setItem("pk",p.pk),!h.getItem("sk")&&p.sk&&h.setItem("sk",p.sk),!h.getItem("user_vid")&&p.id&&h.setItem("user_vid",p.id)),yield this.dispatch({type:z.UPDATE_DATA,payload:{pageName:"builtIn",dataKey:"builtIn.UserVertex",data:p}})}}})}initPage(e){return w(this,arguments,function*(r,n=[],i={}){this.cadlEndpoint||(yield this.init());const{builtIn:e,reload:o,wrapEvalObjects:f=!0}=i;A.isNil(o)&&(i.reload=!0),e&&A.isObj(e)&&this.emit({type:T.ADD_BUILTIN_FNS,payload:{builtInFns:Id({},e)}});var a=(e,t)=>{t&&!g.pages[e]&&(g.pages[e]=K(t[e]||t))};let l="",u;if(A.isStr(r)?l=r:null!=r&&r.pageName&&a(l=r.pageName,u=r.cadlObject),!1!==o||!this.root[l]){u||(g.pages[l]?u=K({[l]:g.pages[l]}):(null!=(r=null==i?void 0:i.onFetchPage)&&r.call(i,l,b(this,ld),this.cadlEndpoint),a(l,u=(yield this.getPage(l))[0]))),null!=i&&i.onReceive&&(yield null==(r=null==i?void 0:i.onReceive)?void 0:r.call(i,u)),this.root[l]&&o&&this.emit({type:"DELETE_PAGE",payload:{pageName:l}});let e=u,t=(e=this.processPopulate({source:e,lookFor:[".","..","~"],skip:["update","save","check","init","components",...n],withFns:!0,pageName:l,shouldAttachRef:null==i?void 0:i.shouldAttachRef,wrapEvalObjects:f}),null!=i&&i.onFirstProcess&&(yield null==(a=i.onFirstProcess)?void 0:a.call(i,e)),e=this.processPopulate({source:e,lookFor:[".","..","_","~"],skip:["update","check","init","formData","components",...n],shouldAttachRef:null==i?void 0:i.shouldAttachRef,withFns:!0,pageName:l,wrapEvalObjects:f}),null!=i&&i.onSecondProcess&&(yield null==(r=i.onSecondProcess)?void 0:r.call(i,e)),this.emit({type:T.SET_ROOT_PROPERTIES,payload:{properties:e}}),!1),d=A.values(e)[0].init;a=(l,u,s="",c)=>w(this,null,function*(){var r,n,i;try{let e=0,t=["update","check","init","formData","dataIn","style","message"];for(d||t.push("style");e<=1;){if(e<2?t.push("backgroundColor"):t.includes("backgroundColor")&&t.splice(t.indexOf("backgroundColor"),1),1<=e)for(const a of["edge","document","vertex"])t.includes(a)||t.push(a);1<e&&null!=d&&d.includes("style")&&d.splice(d.indexOf("style"),1),l=this.processPopulate(xd(Id({source:l,lookFor:[".","..","_","~"],withFns:!0,pageName:s,shouldAttachRef:c},null==u?void 0:u[e]),{skip:[...t,...(null==(r=null==u?void 0:u[e])?void 0:r.skip)||[]],wrapEvalObjects:!0})),e++}s in l||(g[s]?l[s]=K(g[s]):(l[s]={},L.default.warn(`%c"${s}" does not exist in the root or cache. An empty object was created instead`,"color:#ec0000;",l)));var o=cc(xd(Id({source:(null==(n=l[s])?void 0:n.components)||[],lookFor:"=",pageName:s,locations:[l[s],this.root],shouldAttachRef:c},null==u?void 0:u[e]),{skip:["update","check","edge","document","vertex","init","formData","dataIn","style",...(null==(i=null==u?void 0:u[e])?void 0:i.skip)||[]]}))||[];p(l,[s,"components"],o),f&&(l=yield function l(){return lc(this,arguments,function*({pageName:t,cadlObject:e,dispatch:r}){const n=e;for(const a of A.keys(n))if("object"===a&&O.Identify.action.evalObject(n)){var i=K(n[a]);n[a]=sc({pageName:t,updateObject:i,dispatch:r}),"SignIn"!==t&&"CreateNewAccount"!==t&&"SignUp"!==t||(yield r({type:z.ADD_FUNCTION,payload:{pageName:t,fn:sc({pageName:t,updateObject:i,dispatch:r})}}))}else if(A.isObj(n[a]))n[a]=yield l({pageName:t,cadlObject:n[a],dispatch:r});else if(A.isArr(n[a])){var o=n[a].length;for(let e=0;e<o;e++)n[a][e]=yield l({pageName:t,cadlObject:n[a][e],dispatch:r})}return n})}(Id({pageName:s,cadlObject:l,dispatch:this.dispatch.bind(this)},null==u?void 0:u[++e])))}catch(e){L.default.error(e)}return l});if(d){r=yield this.runInit({pageObject:e,onBeforeInit:null==i?void 0:i.onBeforeInit,onInit:null==i?void 0:i.onInit,onAfterInit:null==i?void 0:i.onAfterInit});if("abort"in r&&r.abort&&(t=!0,u&&null!=i&&i.onAbort&&(yield null==(s=null==i?void 0:i.onAbort)?void 0:s.call(i,u))),!t){const c=n||[];this.emit({type:T.SET_ROOT_PROPERTIES,payload:{properties:yield a(r,c.map(e=>({skip:[e]})),l,null==i?void 0:i.shouldAttachRef)}})}}else{var s=n||[];this.emit({type:T.SET_ROOT_PROPERTIES,payload:{properties:yield a(e,[{skip:["ecosObj","style",...s]},{skip:["ecosObj","style",...s]},{skip:["ecosObj","style",...s]}],l,null==i?void 0:i.shouldAttachRef)}})}return t?{aborted:t}:void 0}})}getPage(o){return w(this,null,function*(){let e,t="",r="";o.startsWith("~")?(r=this.myBaseUrl||this.baseUrl,o=o.substring(2)):r=this.baseUrl;try{var[n,i]=yield Cc(""+r+o+"_en.yml");e=n,t=i}catch(e){throw e}return[e,t]})}processPopulate({source:e,lookFor:r,skip:n,pageName:i,shouldAttachRef:o,withFns:a=!0}){let l=e,t=i?l[i]:l,u=K(this.root),s=Oo(t);for(var[c,d]of[[".",[u]],["..",[s]]]){let t;try{t=b(this,md).create({type:"populate",kind:"keys",location:d[0]===u?"root":"local",operator:c,pageName:i}),l=function a({source:e,lookFor:l,locations:u}){let s=e;return Object.keys(s).forEach(e=>{if(e.startsWith(l)){let r={},n=e;".."===l&&(n=n.slice(1));for(var i of u)try{let e=n.split("."),t;try{t=e.slice(1).reduce((e,t)=>e[t],i)}catch(e){throw new Se("Value not found",e instanceof Error?e:new Error(String(e)))}t&&(r=K(t))}catch(e){if(e instanceof Se)continue;throw e}A.keys(r).length&&s[e]?(o=Bo(a({source:r,lookFor:l,locations:[...u]}),a({source:s[e],lookFor:l,locations:[...u]})),delete(s=ic(ic({},s),o))[e]):A.keys(r).length&&(delete r[e],o=a({source:r,lookFor:l,locations:u}),delete(s=Bo(o,s))[e])}else if(A.isObj(s[e]))s[e]=a({source:s[e],lookFor:l,locations:[...u]});else if(A.isArr(s[e])){var t,o=[...s[e]];s[e].length=0;for(t of o)A.isObj(t)&&(t=a({source:t,lookFor:l,locations:[...u]})),s[e].push(t)}}),s}({source:l,lookFor:c,locations:d})}catch(e){var f=e instanceof Error?e:new Error(String(e));throw t&&(t.error=f),new Ee(f.message,"keys")}finally{t&&b(this,md).remove(t)}}i?l[i]:l;{let t;try{t=b(this,md).create({type:"populate",kind:"values",location:["root","local"],operator:r,pageName:i}),l=fc({source:l,lookFor:r,skip:n,locations:[this,u,s],pageName:i,dispatch:this.dispatch.bind(this),shouldAttachRef:o})}catch(e){var p=e instanceof Error?e:new Error(String(e));throw"values"===(null==t?void 0:t.kind)&&(t.error=p),new Ee(p.message,"values")}finally{t&&b(this,md).remove(t)}}i?l[i]:l;let h;{let t;try{t=b(this,md).create({type:"populate",kind:"functions",location:["object"],operator:r,pageName:i}),h=a?uc({cadlObject:l,dispatch:this.dispatch.bind(this)}):l}catch(e){var v=e instanceof Error?e:new Error(String(e));throw"functions"===(null==t?void 0:t.kind)&&(t.error=v),new Ee(v.message,"functions")}finally{t&&b(this,md).remove(t)}}return h}handleEvalString(e){return w(this,arguments,function*({stringArg:e,pageName:t}){for(const r of["..",".","=","~"])if(e.startsWith(r))return Uo({source:e,lookFor:r,locations:"~"==r?[this]:[this.root,this.root[t]]})})}handleEvalObject(e){return w(this,arguments,function*({object:e,pageName:t}){let r;if(A.isObj(e))for(const i of A.keys(e)){var n=yield this.handleEvalCommands({commands:e,key:i,pageName:t});A.isUnd(n)||(r?(r=A.isArr(r)?r:[]).push(n):r=n)}return r})}handleEvalArray(e){return w(this,arguments,function*({array:e,pageName:t=""}){let r=[];for(const i of e){let e=yield this.dispatch({type:z.POPULATE_OBJECT,payload:{pageName:t,object:i,copy:!0}});O.Identify.action.any(e)&&(e={actionType:e});for(const o of A.keys(e)){var n=yield this.handleEvalCommands({commands:e,key:o,pageName:t});if(function(e){if(e){if(Array.isArray(e))return e.some(e=>O.Identify.action.popUp(e)&&e.wait);if("object"==typeof e)return O.Identify.action.popUp(e)&&e.wait}}(n))return[...r,n];r.push(n)}}return r})}handleEvalCommands(e){return w(this,arguments,function*({commands:t,key:r,pageName:n}){let i;if("if"===r){var o=yield this.handleIfCommand({pageName:n,ifCommand:{[r]:t[r]}});A.isNil(o)||(A.isUnd(i)?i=o:A.isArr(i)?i.push(o):i=[i,o])}else if("goto"===r){var o=null==(o=t[r])?void 0:o.dataIn,o=r.includes("builtIn")&&A.isObj(o)&&!("object"in o)&&!("array"in o),o=yield this.dispatch({type:z.POPULATE_OBJECT,payload:{pageName:n,object:{[r]:t[r]},copy:o}});let e;A.isStr(o[r])?e={"=.builtIn.goto":{dataIn:{destination:o[r]}}}:A.isObj(o[r])&&(e={"=.builtIn.goto":o[r]});var o=yield this.handleEvalFunction({command:e,pageName:n,key:"=.builtIn.goto"});A.isNil(o)||(A.isUnd(i)?i=o:A.isArr(i)?i.push(o):i=[i,o])}else if("actionType"===r){let e;if(O.Identify.action.evalObject(null==t?void 0:t.actionType)){const a=null==(o=t.actionType)?void 0:o.object;A.isFnc(a)?e=yield a():A.isObj(a)&&(o={updateObject:a,pageName:n},e=yield this.dispatch({type:z.EVAL_OBJECT,payload:o}))}else e=t[r];A.isNil(e)||(A.isUnd(i)?i=e:A.isArr(i)?i.push(e):i=[i,e])}else r.startsWith("=")?r.startsWith("=")&&(o=null==(o=t[r])?void 0:o.dataIn,o=r.includes("builtIn")&&(A.isObj(o)||A.isArr(o))&&!("object"in o)&&!("array"in o),o={pageName:n,object:{[r]:t[r]},copy:o},o=yield this.dispatch({type:z.POPULATE_OBJECT,payload:o}),o=yield this.handleEvalFunction({command:o,pageName:n,key:r}),A.isNil(o)||(A.isUnd(i)?i=o:A.isArr(i)?i.push(o):i=[i,o])):(o=null==(o=t[r])?void 0:o.dataIn,o=r.includes("builtIn")&&A.isObj(o)&&!("object"in o)&&!("array"in o),t={pageName:n,object:{[r]:t[r]},copy:o},o=yield this.dispatch({type:z.POPULATE_OBJECT,payload:t}),yield this.handleEvalAssignmentExpressions({pageName:n,command:o,key:r}));return i})}handleEvalAssignmentExpressions(e){return w(this,arguments,function*({pageName:e,command:t,key:r}){let n="",i;var o;i=A.isArr(t[r])?K(t[r]):t[r],r.startsWith("..")?(t=(n=r.substring(2,r.length-1)).split("."),o=m(this.root,[e,...t])||"",t={pageName:e,dataKey:t,value:i=Rc(i=A.isObj(o)?Bo(o,i):i)?yield this.handleEvalFunction({pageName:e,key:A.keys(i)[0],command:i}):i},this.emit({type:T.SET_VALUE,payload:t})):r.startsWith(".")&&(o=(n=r.substring(1,r.length-1)).split("."),t=m(this.root,[...o])||"",Rc(i=A.isObj(t)?Bo(t,i):i)&&(i=yield this.handleEvalFunction({pageName:e,key:A.keys(i)[0],command:i})),this.emit({type:T.SET_VALUE,payload:{dataKey:o,value:i}}))})}handleEvalFunction(e){return w(this,arguments,function*({key:r="",pageName:n="",command:i}){var o,a,l,u,s,c,d,f,p;r=r||"",n=n||"";let h;try{let e=r.substring(r.startsWith("=..")?3:2,r.length).split("."),t=m(this.root,e)||m(this.root[n],e);if(A.isObj(t)){"dataKey"in t&&(null!=(t=xd(Id({},t),{dataIn:t.dataKey,dataOut:t.dataKey}))&&delete t.dataKey);let e=t;for(const v of[".","..","=","~"])e=dc({source:A.isObj(e)?Id({},e):e,lookFor:v,locations:"~"==v?[this]:[this.root,this.root[n]]});t=uc({cadlObject:A.isObj(e)?Id({},e):e,dispatch:this.dispatch.bind(this),force:!!(null!=(a=null==(o=null==e?void 0:e.dataIn)?void 0:o.includes)&&a.call(o,"Global")||null!=(u=null==(l=null==e?void 0:e.dataIn)?void 0:l.includes)&&u.call(l,"Firebase"))})}A.isFnc(t)?A.isObj(i[r])?({dataIn:d,dataOut:f}=i[r],p=yield t(d),f?(A.isStr(f)?this.emit({type:T.SET_VALUE,payload:{dataKey:null==(s=f.split)?void 0:s.call(f,"."),value:p}}):A.isObj(f),p&&(h=p)):d&&A.isUnd(f)&&(h=p)):h=yield t():A.isArr(t)&&(yield null==(c=null==t?void 0:t[1])?void 0:c.call(t)),r.includes("goto")&&(h={abort:!0})}catch(e){L.default.error(e)}return h})}handleIfCommand(e){return w(this,arguments,function*({pageName:r,ifCommand:t}){var n;let i,[o,e,a]=(null==t?void 0:t.if)||[];if(O.Identify.isBoolean(o))i=o;else if(A.isFnc(o))i=yield o();else if(A.isStr(o)&&[".","="].some(e=>o.startsWith(e))){let e=["..",".","="].find(e=>o.startsWith(e)),t;O.Identify.localReference(o)||O.Identify.evalLocalReference(o)?t=Uo({source:o,locations:[this.root[r]],lookFor:e}):[".","=."].some(e=>o.startsWith(e))&&(t=Uo({source:o,locations:[this.root],lookFor:e})),i=A.isFnc(t)?yield t():!(!t||t===o)&&i!==O.Identify.isBooleanFalse(i)}else A.isObj(o)&&null!=(n=null==(t=A.keys(o)[0])?void 0:t.startsWith)&&n.call(t,"=")&&(i=yield this.dispatch({type:z.EVAL_OBJECT,payload:{pageName:r,updateObject:o}}));let l=!O.Identify.isBooleanFalse(i)&&i?e:a,u=A.isObj(l),s=u&&A.keys(l)[0]||"",c="";if(u&&O.Identify.folds.goto(l)){if(A.isFnc(null==(n=this.root.builtIn)?void 0:n.goto)){const d=this.root.builtIn.goto;var t=null==(l=fc({source:l,pageName:r,lookFor:["..",".","="],locations:[this.root,this.root[r]]}))?void 0:l.goto;return yield null==d?void 0:d({pageName:r,goto:A.isObj(t)?t.dataIn:t}),{abort:"true"}}}else{if(A.isFnc(l))return void(yield l());if(u&&(s.includes("@")||s.startsWith("=")))return void(yield this.dispatch({type:z.EVAL_OBJECT,payload:{pageName:r,updateObject:l}}));if(O.Identify.action.evalObject(l))return yield this.dispatch({type:z.EVAL_OBJECT,payload:{pageName:r,updateObject:null==l?void 0:l.object}});if(O.Identify.action.any(l)||A.isArr(l))return l;A.isStr(l)&&(c=["..",".","="].find(e=>l.startsWith(e))||"")}if(!c)return l;{let e=Uo({source:l,locations:[this.root,this.root[r]],lookFor:c});if(!A.isFnc(e)){if(A.isObj(e)){const f=uc({cadlObject:e,dispatch:this.dispatch.bind(this)}),{dataIn:p,dataOut:h}=A.values(l)[0];return A.isFnc(f)?(n=p?yield f(p):yield f(),h&&this.emit({type:T.SET_VALUE,payload:{dataKey:h.split("."),value:n}}),n):A.isArr(f)&&A.isFnc(f[1])?(t=p?yield f[1](p):yield f[1](),h&&this.emit({type:T.SET_VALUE,payload:{dataKey:h.split("."),value:t}}),t):void 0}return A.isArr(e)&&A.isFnc(null==e?void 0:e[1])?yield e[1]():e}yield e()}})}updateObject(e){return w(this,arguments,function*({dataKey:e,dataObject:t,dataObjectKey:r}){this.emit({type:T.SET_VALUE,payload:{dataKey:(e.startsWith(".")?e.substring(1,e.length):e).split("."),value:r?t[r]:t,replace:!0}}),yield this.dispatch({type:z.UPDATE_LOCAL_STORAGE})})}runInit(e){return w(this,arguments,function*({pageObject:e={},onBeforeInit:t,onInit:S,onAfterInit:E}){return new Promise(_=>w(this,null,function*(){let n=e,i=A.keys(n)[0],o=A.values(n)[0].init;if(o){for(t&&(yield null==t?void 0:t(o)),this.initCallQueue=o.map((e,t)=>t);0<this.initCallQueue.length;)try{var a=this.initCallQueue.shift(),l=o[a];S&&(yield null==S?void 0:S(l,a,o));let e,t=A.isObj(l)&&A.keys(l)[0]||"";if(A.isObj(l)&&["=","@"].some(e=>t.includes(e))?yield this.dispatch({type:z.EVAL_OBJECT,payload:{updateObject:l,pageName:i}}):e=M(l)?l:fc({source:l,locations:[this.root,this.root[i]],lookFor:[".","..","=","~"]}),A.isFnc(e))try{yield e()}catch(e){var u=e instanceof Error?e:new Error(String(e));throw null!=E&&E(u,o),new me(`An error occured while executing ${i}.init. Check command at index ${a} under init`,u)}else if(O.Identify.action.any(e)){var{actionType:s,dataKey:c,dataObject:d,object:f,funcName:p}=e;switch(s){case"updateObject":yield this.updateObject({dataKey:c,dataObject:d});break;case"builtIn":if("videoChat"===p){const g=this.root.builtIn[p];A.isFnc(g)&&(yield null==g?void 0:g(e))}else if("initExtend"===p){const m=this.root.builtIn[p];A.isFnc(m)&&(yield null==m?void 0:m(e))}break;case"evalObject":var h={pageName:i,updateObject:f};yield this.dispatch({type:z.EVAL_OBJECT,payload:h});break;default:return}}else if(O.Identify.if(e)){var v=yield this.handleIfCommand({pageName:i,ifCommand:e});null!=v&&v.abort&&_({abort:!0})}else if(A.isArr(e)&&A.isFnc(e[0][1]))try{yield e[0][1]()}catch(e){throw new me(`An error occured while executing ${i}.init`,e instanceof Error?e:new Error(String(e)))}let r=this.root[i];for(const b of["..","."])r=dc({source:r,lookFor:b,skip:["update","check","components"],locations:[".."==b?this.root[i]:this.root]});r=uc({cadlObject:{[i]:r},dispatch:this.dispatch.bind(this)}),n=r,o=A.values(r)[0].init;var y={pageName:i,properties:A.values(r)[0]};this.emit({type:T.SET_LOCAL_PROPERTIES,payload:y})}catch(e){L.default.error(e)}yield null==E?void 0:E(null,o),_(n)}}))})}setFromLocalStorage(e){let t;try{var r=localStorage.getItem("Global");r&&(t=JSON.parse(r))}catch(e){throw e instanceof Error?e:new Error(String(e))}if(t)switch(e){case"user":t.currentUser.vertex;break;case"meetroom":var n=t.meetroom.edge;this.emit({type:T.SET_VALUE,payload:{dataKey:"Global.meetroom.edge",value:n}})}}editDraft(e){this.emit({type:"EDIT_DRAFT",payload:{callback:e}})}emitCall(e){return w(this,arguments,function*({dataKey:r,actions:n,pageName:i}){var o,a,l;const u={},e=n.length,t=b(this,md).create({type:"emit",kind:"emit",pageName:i,numActions:(null==n?void 0:n.length)||0});try{for(let t=0;t<e;t++){let e=n[t];A.isStr(e)&&e.includes("=")&&(e={[e]:""});var s,c,d=K(e),f=({vars:a,source:l}=[{vars:r,source:d}][0],dc({source:l,lookFor:"$",locations:[a],skipIf:!1}));if(O.Identify.action.evalObject(e)){try{yield null==(o=null==e?void 0:e.object)?void 0:o.call(e)}catch(e){L.default.error(e)}var p=yield this.dispatch({type:z.EVAL_OBJECT,payload:{pageName:i,updateObject:null==e?void 0:e.object}});u[t]=p||""}else A.keys(e)[0].includes("@")||A.keys(e)[0].startsWith("=")?(s=yield this.dispatch({type:z.EVAL_OBJECT,payload:{pageName:i,updateObject:f}}),u[t]=s||""):"if"in e?(c=yield this.handleIfCommand({pageName:i,ifCommand:f}),u[t]=c||""):O.Identify.folds.goto(e)&&(yield this.handleEvalCommands({pageName:i,commands:f,key:"goto"}))}}catch(e){throw e instanceof Error?e:new Error(String(e))}finally{b(this,md).remove(t)}return A.values(u)})}getApiCache(e){return this.root.apiCache[e].data}getState(){return Id(Id({},b(this,hd)),b(this,md).getState())}getSubscribers(){return b(this,vd)}on(e,t){switch(e){case ho.QUEUE_START:case ho.QUEUE_END:return void b(this,md).on(e,t)}}get baseUrl(){return b(this,sd)}set baseUrl(e){this.cadlBaseUrl&&S(this,sd,e.replace("${cadlBaseUrl}",this.cadlBaseUrl))}get cadlBaseUrl(){if(b(this,ud)){let e=b(this,ud);return e=(e=e.includes("cadlVersion")?e.replace("${cadlVersion}",this.cadlVersion):e).includes("designSuffix")?e.replace("${designSuffix}",this.designSuffix):e}}set cadlBaseUrl(e){S(this,ud,e)}get assetsUrl(){return b(this,cd)}set assetsUrl(e){this.cadlBaseUrl&&S(this,cd,e.replace("${cadlBaseUrl}",this.cadlBaseUrl))}get designSuffix(){var{greaterEqual:e,less:t,widthHeightRatioThreshold:r}=b(this,ad);return this.aspectRatio>=r?e:t}set designSuffix(e){S(this,ad,e)}get aspectRatio(){return b(this,od)}set aspectRatio(e){S(this,od,e),this.cadlBaseUrl&&S(this,sd,this.cadlBaseUrl)}get root(){return b(this,pd)}set root(e){S(this,pd,e||{})}set apiVersion(e){B.apiVersion=e}get apiVersion(){return B.apiVersion}get config(){return b(this,ld)}}od=new WeakMap,ad=new WeakMap,ld=new WeakMap,ud=new WeakMap,sd=new WeakMap,cd=new WeakMap,dd=new WeakMap,fd=new WeakMap,pd=new WeakMap,hd=new WeakMap,vd=new WeakMap,yd=new WeakMap,gd=new WeakMap,md=new WeakMap,Object.defineProperty(e,"Level2Ecos",{enumerable:!0,get:function(){return Q.default}}),Object.defineProperty(e,"Level2Error",{enumerable:!0,get:function(){return E.Level2Error}}),Object.defineProperty(e,"Level2Response",{enumerable:!0,get:function(){return E.Level2Response}}),Object.defineProperty(e,"Doc",{enumerable:!0,get:function(){return I.Doc}}),Object.defineProperty(e,"Edge",{enumerable:!0,get:function(){return I.Edge}}),Object.defineProperty(e,"Vertex",{enumerable:!0,get:function(){return I.Vertex}}),e.Account=G,e.CADL=Nd,e.Document=D,e.cache=g,e.getBuiltInFns=Bs,e.store=B,Object.defineProperty(e,"__esModule",{value:!0})});
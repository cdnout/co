L.Control.Permalink.include({initialize_overlay:function(){this.on("update",this._set_overlays,this),this.on("add",this._onadd_overlay,this)},_onadd_overlay:function(){this._map.on("overlayadd",this._update_overlay,this),this._map.on("overlayremove",this._update_overlay,this),this._update_overlay()},_update_overlay:function(){var a;!this.options.layers||(a=this.options.layers.overlayFlags())&&""!==a&&this._update({overlays:a})},_set_overlays:function(a){var e=a.params;this.options.layers&&e.overlays&&this.options.layers.setOverlays(e.overlays)}}),L.Control.Layers.include({setOverlays:function(a){var e,s,r=0;for(var t in this._layers){this._layers.hasOwnProperty(t)&&(s=this._layers[t]).overlay&&(e=r>=a.length||"T"===a[r],r++,!e&&this._map.hasLayer(s.layer)?this._map.removeLayer(s.layer):e&&!this._map.hasLayer(s.layer)&&this._map.addLayer(s.layer))}},overlayFlags:function(){var a,e="";for(var s in this._layers){this._layers.hasOwnProperty(s)&&((a=this._layers[s]).overlay&&a.overlay&&(this._map.hasLayer(a.layer)?e+="T":e+="F"))}return e}});
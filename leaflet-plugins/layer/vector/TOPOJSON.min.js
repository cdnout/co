!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.topojson=n.topojson||{})}(this,function(n){"use strict";function d(){}function v(n){if(!n)return d;var r,e,o=n.scale[0],i=n.scale[1],a=n.translate[0],u=n.translate[1];return function(n,t){t||(r=e=0),n[0]=(r+=n[0])*o+a,n[1]=(e+=n[1])*i+u}}function g(n,t){for(var r=0,e=n.length;r<e;){var o=r+e>>>1;n[o]<t?r=1+o:e=o}return r}function r(n,t){n={type:"Feature",id:t.id,properties:t.properties||{},geometry:o(n,t)};return null==t.id&&delete n.id,n}function o(n,t){var a=v(n.transform),u=n.arcs;function o(n,t){t.length&&t.pop();for(var r,e=u[n<0?~n:n],o=0,i=e.length;o<i;++o)t.push(r=e[o].slice()),a(r,o);n<0&&function(n,t){for(var r,e=n.length,o=e-t;o<--e;)r=n[o],n[o++]=n[e],n[e]=r}(t,i)}function r(n){return n=n.slice(),a(n,0),n}function e(n){for(var t=[],r=0,e=n.length;r<e;++r)o(n[r],t);return t.length<2&&t.push(t[0].slice()),t}function i(n){for(var t=e(n);t.length<4;)t.push(t[0].slice());return t}function c(n){return n.map(i)}var f={Point:function(n){return r(n.coordinates)},MultiPoint:function(n){return n.coordinates.map(r)},LineString:function(n){return e(n.arcs)},MultiLineString:function(n){return n.arcs.map(e)},Polygon:function(n){return c(n.arcs)},MultiPolygon:function(n){return n.arcs.map(c)}};return function n(t){var r=t.type;return"GeometryCollection"===r?{type:r,geometries:t.geometries.map(n)}:r in f?{type:r,coordinates:f[r](t)}:null}(t)}function p(a,e){var o={},u={},c={},i=[],f=-1;function n(n,t){for(var r in n){var e=n[r];delete t[e.start],delete e.start,delete e.end,e.forEach(function(n){o[n<0?~n:n]=1}),i.push(e)}}return e.forEach(function(n,t){var r=a.arcs[n<0?~n:n];r.length<3&&!r[1][0]&&!r[1][1]&&(r=e[++f],e[f]=n,e[t]=r)}),e.forEach(function(n){var t,r,e=function(n){var t,r=a.arcs[n<0?~n:n],e=r[0];a.transform?(t=[0,0],r.forEach(function(n){t[0]+=n[0],t[1]+=n[1]})):t=r[r.length-1];return n<0?[t,e]:[e,t]}(n),o=e[0],i=e[1];(e=c[o])?(delete c[e.end],e.push(n),e.end=i,(t=u[i])?(delete u[t.start],r=t===e?e:e.concat(t),u[r.start=e.start]=c[r.end=t.end]=r):u[e.start]=c[e.end]=e):(e=u[i])?(delete u[e.start],e.unshift(n),e.start=o,(t=c[o])?(delete c[t.end],r=t===e?e:t.concat(e),u[r.start=t.start]=c[r.end=e.end]=r):u[e.start]=c[e.end]=e):u[(e=[n]).start=o]=c[e.end=i]=e}),n(c,u),n(u,c),e.forEach(function(n){o[n<0?~n:n]||i.push([n])}),i}function t(n,t,r){var e=[];function o(n){var t=n<0?~n:n;(c[t]||(c[t]=[])).push({i:n,g:u})}function i(n){n.forEach(o)}function a(n){n.forEach(i)}if(1<arguments.length){var u,c=[],f={LineString:i,MultiLineString:a,Polygon:a,MultiPolygon:function(n){n.forEach(a)}};!function n(t){"GeometryCollection"===t.type?t.geometries.forEach(n):t.type in f&&f[(u=t).type](t.arcs)}(t),c.forEach(arguments.length<3?function(n){e.push(n[0].i)}:function(n){r(n[0].g,n[n.length-1].g)&&e.push(n[0].i)})}else for(var s=0,h=n.arcs.length;s<h;++s)e.push(s);return{type:"MultiLineString",arcs:p(n,e)}}function i(n){var t=n[0],r=n[1],n=n[2];return Math.abs((t[0]-n[0])*(r[1]-t[1])-(t[0]-r[0])*(n[1]-t[1]))}function e(u,n){var c={},r=[],e=[];function t(t){t.forEach(function(n){n.forEach(function(n){(c[n=n<0?~n:n]||(c[n]=[])).push(t)})}),r.push(t)}function f(n){return Math.abs(function(n){for(var t,r=-1,e=n.length,o=n[e-1],i=0;++r<e;)t=o,o=n[r],i+=t[0]*o[1]-t[1]*o[0];return i/2}(o(u,{type:"Polygon",arcs:[n]}).coordinates[0]))}return n.forEach(function(n){"Polygon"===n.type?t(n.arcs):"MultiPolygon"===n.type&&n.arcs.forEach(t)}),r.forEach(function(n){if(!n._){var t=[],r=[n];for(n._=1,e.push(t);n=r.pop();)t.push(n),n.forEach(function(n){n.forEach(function(n){c[n<0?~n:n].forEach(function(n){n._||(n._=1,r.push(n))})})})}}),r.forEach(function(n){delete n._}),{type:"MultiPolygon",arcs:e.map(function(n){var t,r=[];if(n.forEach(function(n){n.forEach(function(n){n.forEach(function(n){c[n<0?~n:n].length<2&&r.push(n)})})}),1<(t=(r=p(u,r)).length))for(var e,o,i=1,a=f(r[0]);i<t;++i)(e=f(r[i]))>a&&(o=r[0],r[0]=r[i],r[i]=o,a=e);return r})}}function c(n,t){return n[1][2]-t[1][2]}n.version="1.6.26",n.mesh=function(n){return o(n,t.apply(this,arguments))},n.meshArcs=t,n.merge=function(n){return o(n,e.apply(this,arguments))},n.mergeArcs=e,n.feature=function(t,n){return"GeometryCollection"===n.type?{type:"FeatureCollection",features:n.geometries.map(function(n){return r(t,n)})}:r(t,n)},n.neighbors=function(n){var e={},t=n.map(function(){return[]});function r(n,r){n.forEach(function(n){n<0&&(n=~n);var t=e[n];t?t.push(r):e[n]=[r]})}function o(n,t){n.forEach(function(n){r(n,t)})}var i,a={LineString:r,MultiLineString:o,Polygon:o,MultiPolygon:function(n,t){n.forEach(function(n){o(n,t)})}};for(i in n.forEach(function t(n,r){"GeometryCollection"===n.type?n.geometries.forEach(function(n){t(n,r)}):n.type in a&&a[n.type](n.arcs,r)}),e)for(var u=e[i],c=u.length,f=0;f<c;++f)for(var s=f+1;s<c;++s){var h,p=u[f],l=u[s];(h=t[p])[i=g(h,l)]!==l&&h.splice(i,0,l),(h=t[l])[i=g(h,p)]!==p&&h.splice(i,0,p)}return t},n.presimplify=function(n,f){var t,a,u,s=v(n.transform),h=function(n){if(!n)return d;var e,o,i=n.scale[0],a=n.scale[1],u=n.translate[0],c=n.translate[1];return function(n,t){t||(e=o=0);var r=Math.round((n[0]-u)/i),t=Math.round((n[1]-c)/a);n[0]=r-e,n[1]=t-o,e=r,o=t}}(n.transform),p=(a=[],u=0,(t={}).push=function(n){return e(a[n._=u]=n,u++),u},t.pop=function(){if(!(u<=0)){var n,t=a[0];return 0<--u&&(n=a[u],o(a[n._=0]=n,0)),t}},t.remove=function(n){var t,r=n._;if(a[r]===n)return r!==--u&&(c(t=a[u],n)<0?e:o)(a[t._=r]=t,r),r},t);function e(n,t){for(;0<t;){var r=(t+1>>1)-1,e=a[r];if(0<=c(n,e))break;a[e._=t]=e,a[n._=t=r]=n}}function o(n,t){for(;;){var r=t+1<<1,e=r-1,o=t,i=a[o];if(e<u&&c(a[e],i)<0&&(i=a[o=e]),r<u&&c(a[r],i)<0&&(i=a[o=r]),o===t)break;a[i._=t]=i,a[n._=t=o]=n}}function l(n){p.remove(n),n[1][2]=f(n),p.push(n)}return f=f||i,n.arcs.forEach(function(n){for(var t,r,e=[],o=0,i=0,a=n.length;i<a;++i)r=n[i],s(n[i]=[r[0],r[1],1/0],i);for(i=1,a=n.length-1;i<a;++i)(t=n.slice(i-1,i+2))[1][2]=f(t),e.push(t),p.push(t);for(i=0,a=e.length;i<a;++i)(t=e[i]).previous=e[i-1],t.next=e[i+1];for(;t=p.pop();){var u=t.previous,c=t.next;t[1][2]<o?t[1][2]=o:o=t[1][2],u&&(u.next=c,u[2]=t[2],l(u)),c&&(c.previous=u,c[0]=t[0],l(c))}n.forEach(h)}),n}}),L.TOPOJSON=L.FeatureGroup.extend({options:{async:!0},initialize:function(n,t){L.Util.setOptions(this,t),this._topojson=n,this._layers={},n&&this.addTOPOJSON(n,t,this.options.async)},loadJSON:function(n,t,r,e){void 0===e&&(e=this.options.async),void 0===r&&(r=this.options);var o=new window.XMLHttpRequest;if(void 0===o.withCredentials&&void 0!==window.XDomainRequest){var i=new window.XDomainRequest;i.open("GET",n,e),i.onprogress=function(){},i.ontimeout=function(){},i.onerror=function(){},i.onload=function(){i.responseText&&t(i.responseText,r)},setTimeout(function(){i.send()},0)}else{o.open("GET",n,e);try{o.overrideMimeType("application/json")}catch(n){}o.onreadystatechange=function(){4===o.readyState&&200===o.status&&t(o.response,r)},o.send(null)}},addTOPOJSON:function(n,t,r){var e=this;this.loadJSON(n,function(n){e._addTOPOJSON(n)},t,r)},_addTOPOJSON:function(n){var t=this.parseTOPOJSON(n);if(t&&t.length){for(var r=0;r<t.length;r++)this.fire("addlayer",{layer:t[r]}),this.addLayer(t[r]);this.fire("loaded")}},_addData:function(n,t){"addData"in n&&n.addData(t),"setGeoJSON"in n&&n.setGeoJSON(t)},parseTOPOJSON:function(n){var t,r=[],e="string"==typeof n?JSON.parse(n):n;for(t in e.objects){var o=L.geoJson(),i=topojson.feature(e,e.objects[t]);i.features?this._addData(o,i.features):_this._addData(o,i),r.push(o)}return r}});
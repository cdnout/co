!function(){function a(t){function e(t){return function(t){var e="";for(t=Math.floor(t);0!==t;)e="0123456789ABCDEF"[t%16]+e,t=Math.floor(t/16);for(;e.length<2;)e="0"+e;return e}(256*t)}return t<0?"#FF0000":t<1/3?"#FF"+e(3*t)+"00":t<2/3?"#"+e(2-3*t)+"FF00":t<1?"#00FF"+e(3*t-2):"#00FFFF"}function u(t){return 20!==t.length?new Date:new Date(t)}L.GPX.include({options:{maxSpeed:110,chunks:200},speedSplitEnable:function(t){return L.Util.setOptions(this,t),this.on("addline",this.speed_split,this)},speedSplitDisable:function(){return this.off("addline",this.speed_split,this)},speed_split:function(t){var e=t.line.pop().getLatLngs(),n=Math.floor(e.length/this.options.chunks);n<3&&(n=3);for(var i=null,o=0;o<e.length;o+=n){var l=0,s=null;o+n>e.length&&(n=e.length-o);for(var r=0;r<n;r++)i&&(l+=i.distanceTo(e[o+r])),i=e[o+r],s=s||u(i.meta.time);var h=.001*l/(s=(u((i=e[o+n-1]).meta.time)-s)/36e5),p=a(h/this.options.maxSpeed),p=new L.Polyline(e.slice(o,o+n+1),{color:p,weight:2,opacity:1});p.bindPopup("Dist: "+l.toFixed()+"m; Speed: "+h.toFixed(2)+" km/h"),t.line.push(p)}}})}();
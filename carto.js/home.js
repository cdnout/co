/*!
 * CARTO.js https://carto.com/
 * Version: 4.2.1
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.carto=t():e.carto=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=150)}([function(e,t,n){var r;(function(){var n=this,i=n._,o=Array.prototype,s=Object.prototype,a=Function.prototype,u=o.push,c=o.slice,l=s.toString,h=s.hasOwnProperty,f=Array.isArray,p=Object.keys,d=a.bind,g=Object.create,m=function(){},y=function(e){return e instanceof y?e:this instanceof y?void(this._wrapped=e):new y(e)};void 0!==e&&e.exports&&(t=e.exports=y),t._=y,y.VERSION="1.8.3";var _=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,o){return e.call(t,n,r,i,o)}}return function(){return e.apply(t,arguments)}},v=function(e,t,n){return null==e?y.identity:y.isFunction(e)?_(e,t,n):y.isObject(e)?y.matcher(e):y.property(e)};y.iteratee=function(e,t){return v(e,t,1/0)};var b=function(e,t){return function(n){var r=arguments.length;if(r<2||null==n)return n;for(var i=1;i<r;i++)for(var o=arguments[i],s=e(o),a=s.length,u=0;u<a;u++){var c=s[u];t&&void 0!==n[c]||(n[c]=o[c])}return n}},w=function(e){if(!y.isObject(e))return{};if(g)return g(e);m.prototype=e;var t=new m;return m.prototype=null,t},x=function(e){return function(t){return null==t?void 0:t[e]}},C=Math.pow(2,53)-1,E=x("length"),S=function(e){var t=E(e);return"number"==typeof t&&t>=0&&t<=C};function T(e){return function(t,n,r,i){n=_(n,i,4);var o=!S(t)&&y.keys(t),s=(o||t).length,a=e>0?0:s-1;return arguments.length<3&&(r=t[o?o[a]:a],a+=e),function(t,n,r,i,o,s){for(;o>=0&&o<s;o+=e){var a=i?i[o]:o;r=n(r,t[a],a,t)}return r}(t,n,r,o,a,s)}}y.each=y.forEach=function(e,t,n){var r,i;if(t=_(t,n),S(e))for(r=0,i=e.length;r<i;r++)t(e[r],r,e);else{var o=y.keys(e);for(r=0,i=o.length;r<i;r++)t(e[o[r]],o[r],e)}return e},y.map=y.collect=function(e,t,n){t=v(t,n);for(var r=!S(e)&&y.keys(e),i=(r||e).length,o=Array(i),s=0;s<i;s++){var a=r?r[s]:s;o[s]=t(e[a],a,e)}return o},y.reduce=y.foldl=y.inject=T(1),y.reduceRight=y.foldr=T(-1),y.find=y.detect=function(e,t,n){var r;if(void 0!==(r=S(e)?y.findIndex(e,t,n):y.findKey(e,t,n))&&-1!==r)return e[r]},y.filter=y.select=function(e,t,n){var r=[];return t=v(t,n),y.each(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r},y.reject=function(e,t,n){return y.filter(e,y.negate(v(t)),n)},y.every=y.all=function(e,t,n){t=v(t,n);for(var r=!S(e)&&y.keys(e),i=(r||e).length,o=0;o<i;o++){var s=r?r[o]:o;if(!t(e[s],s,e))return!1}return!0},y.some=y.any=function(e,t,n){t=v(t,n);for(var r=!S(e)&&y.keys(e),i=(r||e).length,o=0;o<i;o++){var s=r?r[o]:o;if(t(e[s],s,e))return!0}return!1},y.contains=y.includes=y.include=function(e,t,n,r){return S(e)||(e=y.values(e)),("number"!=typeof n||r)&&(n=0),y.indexOf(e,t,n)>=0},y.invoke=function(e,t){var n=c.call(arguments,2),r=y.isFunction(t);return y.map(e,function(e){var i=r?t:e[t];return null==i?i:i.apply(e,n)})},y.pluck=function(e,t){return y.map(e,y.property(t))},y.where=function(e,t){return y.filter(e,y.matcher(t))},y.findWhere=function(e,t){return y.find(e,y.matcher(t))},y.max=function(e,t,n){var r,i,o=-1/0,s=-1/0;if(null==t&&null!=e)for(var a=0,u=(e=S(e)?e:y.values(e)).length;a<u;a++)(r=e[a])>o&&(o=r);else t=v(t,n),y.each(e,function(e,n,r){((i=t(e,n,r))>s||i===-1/0&&o===-1/0)&&(o=e,s=i)});return o},y.min=function(e,t,n){var r,i,o=1/0,s=1/0;if(null==t&&null!=e)for(var a=0,u=(e=S(e)?e:y.values(e)).length;a<u;a++)(r=e[a])<o&&(o=r);else t=v(t,n),y.each(e,function(e,n,r){((i=t(e,n,r))<s||i===1/0&&o===1/0)&&(o=e,s=i)});return o},y.shuffle=function(e){for(var t,n=S(e)?e:y.values(e),r=n.length,i=Array(r),o=0;o<r;o++)(t=y.random(0,o))!==o&&(i[o]=i[t]),i[t]=n[o];return i},y.sample=function(e,t,n){return null==t||n?(S(e)||(e=y.values(e)),e[y.random(e.length-1)]):y.shuffle(e).slice(0,Math.max(0,t))},y.sortBy=function(e,t,n){return t=v(t,n),y.pluck(y.map(e,function(e,n,r){return{value:e,index:n,criteria:t(e,n,r)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index-t.index}),"value")};var A=function(e){return function(t,n,r){var i={};return n=v(n,r),y.each(t,function(r,o){var s=n(r,o,t);e(i,r,s)}),i}};y.groupBy=A(function(e,t,n){y.has(e,n)?e[n].push(t):e[n]=[t]}),y.indexBy=A(function(e,t,n){e[n]=t}),y.countBy=A(function(e,t,n){y.has(e,n)?e[n]++:e[n]=1}),y.toArray=function(e){return e?y.isArray(e)?c.call(e):S(e)?y.map(e,y.identity):y.values(e):[]},y.size=function(e){return null==e?0:S(e)?e.length:y.keys(e).length},y.partition=function(e,t,n){t=v(t,n);var r=[],i=[];return y.each(e,function(e,n,o){(t(e,n,o)?r:i).push(e)}),[r,i]},y.first=y.head=y.take=function(e,t,n){if(null!=e)return null==t||n?e[0]:y.initial(e,e.length-t)},y.initial=function(e,t,n){return c.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},y.last=function(e,t,n){if(null!=e)return null==t||n?e[e.length-1]:y.rest(e,Math.max(0,e.length-t))},y.rest=y.tail=y.drop=function(e,t,n){return c.call(e,null==t||n?1:t)},y.compact=function(e){return y.filter(e,y.identity)};var M=function(e,t,n,r){for(var i=[],o=0,s=r||0,a=E(e);s<a;s++){var u=e[s];if(S(u)&&(y.isArray(u)||y.isArguments(u))){t||(u=M(u,t,n));var c=0,l=u.length;for(i.length+=l;c<l;)i[o++]=u[c++]}else n||(i[o++]=u)}return i};function k(e){return function(t,n,r){n=v(n,r);for(var i=E(t),o=e>0?0:i-1;o>=0&&o<i;o+=e)if(n(t[o],o,t))return o;return-1}}function L(e,t,n){return function(r,i,o){var s=0,a=E(r);if("number"==typeof o)e>0?s=o>=0?o:Math.max(o+a,s):a=o>=0?Math.min(o+1,a):o+a+1;else if(n&&o&&a)return r[o=n(r,i)]===i?o:-1;if(i!=i)return(o=t(c.call(r,s,a),y.isNaN))>=0?o+s:-1;for(o=e>0?s:a-1;o>=0&&o<a;o+=e)if(r[o]===i)return o;return-1}}y.flatten=function(e,t){return M(e,t,!1)},y.without=function(e){return y.difference(e,c.call(arguments,1))},y.uniq=y.unique=function(e,t,n,r){y.isBoolean(t)||(r=n,n=t,t=!1),null!=n&&(n=v(n,r));for(var i=[],o=[],s=0,a=E(e);s<a;s++){var u=e[s],c=n?n(u,s,e):u;t?(s&&o===c||i.push(u),o=c):n?y.contains(o,c)||(o.push(c),i.push(u)):y.contains(i,u)||i.push(u)}return i},y.union=function(){return y.uniq(M(arguments,!0,!0))},y.intersection=function(e){for(var t=[],n=arguments.length,r=0,i=E(e);r<i;r++){var o=e[r];if(!y.contains(t,o)){for(var s=1;s<n&&y.contains(arguments[s],o);s++);s===n&&t.push(o)}}return t},y.difference=function(e){var t=M(arguments,!0,!0,1);return y.filter(e,function(e){return!y.contains(t,e)})},y.zip=function(){return y.unzip(arguments)},y.unzip=function(e){for(var t=e&&y.max(e,E).length||0,n=Array(t),r=0;r<t;r++)n[r]=y.pluck(e,r);return n},y.object=function(e,t){for(var n={},r=0,i=E(e);r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},y.findIndex=k(1),y.findLastIndex=k(-1),y.sortedIndex=function(e,t,n,r){for(var i=(n=v(n,r,1))(t),o=0,s=E(e);o<s;){var a=Math.floor((o+s)/2);n(e[a])<i?o=a+1:s=a}return o},y.indexOf=L(1,y.findIndex,y.sortedIndex),y.lastIndexOf=L(-1,y.findLastIndex),y.range=function(e,t,n){null==t&&(t=e||0,e=0),n=n||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r),o=0;o<r;o++,e+=n)i[o]=e;return i};var O=function(e,t,n,r,i){if(!(r instanceof t))return e.apply(n,i);var o=w(e.prototype),s=e.apply(o,i);return y.isObject(s)?s:o};y.bind=function(e,t){if(d&&e.bind===d)return d.apply(e,c.call(arguments,1));if(!y.isFunction(e))throw new TypeError("Bind must be called on a function");var n=c.call(arguments,2),r=function(){return O(e,r,t,this,n.concat(c.call(arguments)))};return r},y.partial=function(e){var t=c.call(arguments,1),n=function(){for(var r=0,i=t.length,o=Array(i),s=0;s<i;s++)o[s]=t[s]===y?arguments[r++]:t[s];for(;r<arguments.length;)o.push(arguments[r++]);return O(e,n,this,this,o)};return n},y.bindAll=function(e){var t,n,r=arguments.length;if(r<=1)throw new Error("bindAll must be passed function names");for(t=1;t<r;t++)e[n=arguments[t]]=y.bind(e[n],e);return e},y.memoize=function(e,t){var n=function(r){var i=n.cache,o=""+(t?t.apply(this,arguments):r);return y.has(i,o)||(i[o]=e.apply(this,arguments)),i[o]};return n.cache={},n},y.delay=function(e,t){var n=c.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},y.defer=y.partial(y.delay,y,1),y.throttle=function(e,t,n){var r,i,o,s=null,a=0;n||(n={});var u=function(){a=!1===n.leading?0:y.now(),s=null,o=e.apply(r,i),s||(r=i=null)};return function(){var c=y.now();a||!1!==n.leading||(a=c);var l=t-(c-a);return r=this,i=arguments,l<=0||l>t?(s&&(clearTimeout(s),s=null),a=c,o=e.apply(r,i),s||(r=i=null)):s||!1===n.trailing||(s=setTimeout(u,l)),o}},y.debounce=function(e,t,n){var r,i,o,s,a,u=function(){var c=y.now()-s;c<t&&c>=0?r=setTimeout(u,t-c):(r=null,n||(a=e.apply(o,i),r||(o=i=null)))};return function(){o=this,i=arguments,s=y.now();var c=n&&!r;return r||(r=setTimeout(u,t)),c&&(a=e.apply(o,i),o=i=null),a}},y.wrap=function(e,t){return y.partial(t,e)},y.negate=function(e){return function(){return!e.apply(this,arguments)}},y.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}},y.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},y.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}},y.once=y.partial(y.before,2);var R=!{toString:null}.propertyIsEnumerable("toString"),F=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function P(e,t){var n=F.length,r=e.constructor,i=y.isFunction(r)&&r.prototype||s,o="constructor";for(y.has(e,o)&&!y.contains(t,o)&&t.push(o);n--;)(o=F[n])in e&&e[o]!==i[o]&&!y.contains(t,o)&&t.push(o)}y.keys=function(e){if(!y.isObject(e))return[];if(p)return p(e);var t=[];for(var n in e)y.has(e,n)&&t.push(n);return R&&P(e,t),t},y.allKeys=function(e){if(!y.isObject(e))return[];var t=[];for(var n in e)t.push(n);return R&&P(e,t),t},y.values=function(e){for(var t=y.keys(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=e[t[i]];return r},y.mapObject=function(e,t,n){t=v(t,n);for(var r,i=y.keys(e),o=i.length,s={},a=0;a<o;a++)s[r=i[a]]=t(e[r],r,e);return s},y.pairs=function(e){for(var t=y.keys(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},y.invert=function(e){for(var t={},n=y.keys(e),r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},y.functions=y.methods=function(e){var t=[];for(var n in e)y.isFunction(e[n])&&t.push(n);return t.sort()},y.extend=b(y.allKeys),y.extendOwn=y.assign=b(y.keys),y.findKey=function(e,t,n){t=v(t,n);for(var r,i=y.keys(e),o=0,s=i.length;o<s;o++)if(t(e[r=i[o]],r,e))return r},y.pick=function(e,t,n){var r,i,o={},s=e;if(null==s)return o;y.isFunction(t)?(i=y.allKeys(s),r=_(t,n)):(i=M(arguments,!1,!1,1),r=function(e,t,n){return t in n},s=Object(s));for(var a=0,u=i.length;a<u;a++){var c=i[a],l=s[c];r(l,c,s)&&(o[c]=l)}return o},y.omit=function(e,t,n){if(y.isFunction(t))t=y.negate(t);else{var r=y.map(M(arguments,!1,!1,1),String);t=function(e,t){return!y.contains(r,t)}}return y.pick(e,t,n)},y.defaults=b(y.allKeys,!0),y.create=function(e,t){var n=w(e);return t&&y.extendOwn(n,t),n},y.clone=function(e){return y.isObject(e)?y.isArray(e)?e.slice():y.extend({},e):e},y.tap=function(e,t){return t(e),e},y.isMatch=function(e,t){var n=y.keys(t),r=n.length;if(null==e)return!r;for(var i=Object(e),o=0;o<r;o++){var s=n[o];if(t[s]!==i[s]||!(s in i))return!1}return!0};var B=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof y&&(e=e._wrapped),t instanceof y&&(t=t._wrapped);var i=l.call(e);if(i!==l.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t}var o="[object Array]"===i;if(!o){if("object"!=typeof e||"object"!=typeof t)return!1;var s=e.constructor,a=t.constructor;if(s!==a&&!(y.isFunction(s)&&s instanceof s&&y.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],r=r||[];for(var u=n.length;u--;)if(n[u]===e)return r[u]===t;if(n.push(e),r.push(t),o){if((u=e.length)!==t.length)return!1;for(;u--;)if(!B(e[u],t[u],n,r))return!1}else{var c,h=y.keys(e);if(u=h.length,y.keys(t).length!==u)return!1;for(;u--;)if(c=h[u],!y.has(t,c)||!B(e[c],t[c],n,r))return!1}return n.pop(),r.pop(),!0};y.isEqual=function(e,t){return B(e,t)},y.isEmpty=function(e){return null==e||(S(e)&&(y.isArray(e)||y.isString(e)||y.isArguments(e))?0===e.length:0===y.keys(e).length)},y.isElement=function(e){return!(!e||1!==e.nodeType)},y.isArray=f||function(e){return"[object Array]"===l.call(e)},y.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},y.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){y["is"+e]=function(t){return l.call(t)==="[object "+e+"]"}}),y.isArguments(arguments)||(y.isArguments=function(e){return y.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(y.isFunction=function(e){return"function"==typeof e||!1}),y.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},y.isNaN=function(e){return y.isNumber(e)&&e!==+e},y.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===l.call(e)},y.isNull=function(e){return null===e},y.isUndefined=function(e){return void 0===e},y.has=function(e,t){return null!=e&&h.call(e,t)},y.noConflict=function(){return n._=i,this},y.identity=function(e){return e},y.constant=function(e){return function(){return e}},y.noop=function(){},y.property=x,y.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},y.matcher=y.matches=function(e){return e=y.extendOwn({},e),function(t){return y.isMatch(t,e)}},y.times=function(e,t,n){var r=Array(Math.max(0,e));t=_(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r},y.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},y.now=Date.now||function(){return(new Date).getTime()};var I={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},N=y.invert(I),D=function(e){var t=function(t){return e[t]},n="(?:"+y.keys(e).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(i,t):e}};y.escape=D(I),y.unescape=D(N),y.result=function(e,t,n){var r=null==e?void 0:e[t];return void 0===r&&(r=n),y.isFunction(r)?r.call(e):r};var j=0;y.uniqueId=function(e){var t=++j+"";return e?e+t:t},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},U=/\\|'|\r|\n|\u2028|\u2029/g,$=function(e){return"\\"+z[e]};y.template=function(e,t,n){!t&&n&&(t=n),t=y.defaults({},t,y.templateSettings);var r=RegExp([(t.escape||q).source,(t.interpolate||q).source,(t.evaluate||q).source].join("|")+"|$","g"),i=0,o="__p+='";e.replace(r,function(t,n,r,s,a){return o+=e.slice(i,a).replace(U,$),i=a+t.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?o+="'+\n((__t=("+r+"))==null?'':__t)+\n'":s&&(o+="';\n"+s+"\n__p+='"),t}),o+="';\n",t.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var s=new Function(t.variable||"obj","_",o)}catch(e){throw e.source=o,e}var a=function(e){return s.call(this,e,y)},u=t.variable||"obj";return a.source="function("+u+"){\n"+o+"}",a},y.chain=function(e){var t=y(e);return t._chain=!0,t};var H=function(e,t){return e._chain?y(t).chain():t};y.mixin=function(e){y.each(y.functions(e),function(t){var n=y[t]=e[t];y.prototype[t]=function(){var e=[this._wrapped];return u.apply(e,arguments),H(this,n.apply(y,e))}})},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=o[e];y.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],H(this,n)}}),y.each(["concat","join","slice"],function(e){var t=o[e];y.prototype[e]=function(){return H(this,t.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return""+this._wrapped},void 0===(r=function(){return y}.apply(t,[]))||(e.exports=r)}).call(this)},function(e,t,n){(function(r){var i,o;!function(s){var a="object"==typeof self&&self.self==self&&self||"object"==typeof r&&r.global==r&&r;i=[n(0),n(17),t],void 0===(o=function(e,t,n){a.Backbone=function(e,t,n,r){var i=e.Backbone,o=Array.prototype.slice;t.VERSION="1.2.3",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var s=function(e,t,r){n.each(t,function(t,i){n[i]&&(e.prototype[i]=function(e,t,r){switch(e){case 1:return function(){return n[t](this[r])};case 2:return function(e){return n[t](this[r],e)};case 3:return function(e,i){return n[t](this[r],a(e,this),i)};case 4:return function(e,i,o){return n[t](this[r],a(e,this),i,o)};default:return function(){var e=o.call(arguments);return e.unshift(this[r]),n[t].apply(n,e)}}}(t,i,r))})},a=function(e,t){return n.isFunction(e)?e:n.isObject(e)&&!t._isModel(e)?u(e):n.isString(e)?function(t){return t.get(e)}:e},u=function(e){var t=n.matches(e);return function(e){return t(e.attributes)}},c=t.Events={},l=/\s+/,h=function(e,t,r,i,o){var s,a=0;if(r&&"object"==typeof r){void 0!==i&&"context"in o&&void 0===o.context&&(o.context=i);for(s=n.keys(r);a<s.length;a++)t=h(e,t,s[a],r[s[a]],o)}else if(r&&l.test(r))for(s=r.split(l);a<s.length;a++)t=e(t,s[a],i,o);else t=e(t,r,i,o);return t};c.on=function(e,t,n){return f(this,e,t,n)};var f=function(e,t,n,r,i){if(e._events=h(p,e._events||{},t,n,{context:r,ctx:e,listening:i}),i){var o=e._listeners||(e._listeners={});o[i.id]=i}return e};c.listenTo=function(e,t,r){if(!e)return this;var i=e._listenId||(e._listenId=n.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),s=o[i];if(!s){var a=this._listenId||(this._listenId=n.uniqueId("l"));s=o[i]={obj:e,objId:i,id:a,listeningTo:o,count:0}}return f(e,t,r,this,s),this};var p=function(e,t,n,r){if(n){var i=e[t]||(e[t]=[]),o=r.context,s=r.ctx,a=r.listening;a&&a.count++,i.push({callback:n,context:o,ctx:o||s,listening:a})}return e};c.off=function(e,t,n){return this._events?(this._events=h(d,this._events,e,t,{context:n,listeners:this._listeners}),this):this},c.stopListening=function(e,t,r){var i=this._listeningTo;if(!i)return this;for(var o=e?[e._listenId]:n.keys(i),s=0;s<o.length;s++){var a=i[o[s]];if(!a)break;a.obj.off(t,r,this)}return n.isEmpty(i)&&(this._listeningTo=void 0),this};var d=function(e,t,r,i){if(e){var o,s=0,a=i.context,u=i.listeners;if(t||r||a){for(var c=t?[t]:n.keys(e);s<c.length;s++){t=c[s];var l=e[t];if(!l)break;for(var h=[],f=0;f<l.length;f++){var p=l[f];r&&r!==p.callback&&r!==p.callback._callback||a&&a!==p.context?h.push(p):(o=p.listening)&&0==--o.count&&(delete u[o.id],delete o.listeningTo[o.objId])}h.length?e[t]=h:delete e[t]}return n.size(e)?e:void 0}for(var d=n.keys(u);s<d.length;s++)o=u[d[s]],delete u[o.id],delete o.listeningTo[o.objId]}};c.once=function(e,t,r){var i=h(g,{},e,t,n.bind(this.off,this));return this.on(i,void 0,r)},c.listenToOnce=function(e,t,r){var i=h(g,{},t,r,n.bind(this.stopListening,this,e));return this.listenTo(e,i)};var g=function(e,t,r,i){if(r){var o=e[t]=n.once(function(){i(t,o),r.apply(this,arguments)});o._callback=r}return e};c.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),n=Array(t),r=0;r<t;r++)n[r]=arguments[r+1];return h(m,this._events,e,void 0,n),this};var m=function(e,t,n,r){if(e){var i=e[t],o=e.all;i&&o&&(o=o.slice()),i&&y(i,r),o&&y(o,[t].concat(r))}return e},y=function(e,t){var n,r=-1,i=e.length,o=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++r<i;)(n=e[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o);return;case 2:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o,s);return;case 3:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o,s,a);return;default:for(;++r<i;)(n=e[r]).callback.apply(n.ctx,t);return}};c.bind=c.on,c.unbind=c.off,n.extend(t,c);var _=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{}),r=n.defaults({},r,n.result(this,"defaults")),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(_.prototype,c,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!n.iteratee(e,this)(this.attributes)},set:function(e,t,r){if(null==e)return this;var i;if("object"==typeof e?(i=e,r=t):(i={})[e]=t,r||(r={}),!this._validate(i,r))return!1;var o=r.unset,s=r.silent,a=[],u=this._changing;this._changing=!0,u||(this._previousAttributes=n.clone(this.attributes),this.changed={});var c=this.attributes,l=this.changed,h=this._previousAttributes;for(var f in i)t=i[f],n.isEqual(c[f],t)||a.push(f),n.isEqual(h[f],t)?delete l[f]:l[f]=t,o?delete c[f]:c[f]=t;if(this.id=this.get(this.idAttribute),!s){a.length&&(this._pending=r);for(var p=0;p<a.length;p++)this.trigger("change:"+a[p],this,c[a[p]],r)}if(u)return this;if(!s)for(;this._pending;)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&n.clone(this.changed);var t=this._changing?this._previousAttributes:this.attributes,r={};for(var i in e){var o=e[i];n.isEqual(t[i],o)||(r[i]=o)}return!!n.size(r)&&r},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){var t=this,r=(e=n.extend({parse:!0},e)).success;return e.success=function(n){var i=e.parse?t.parse(n,e):n;if(!t.set(i,e))return!1;r&&r.call(e.context,t,n,e),t.trigger("sync",t,n,e)},N(this,e),this.sync("read",this,e)},save:function(e,t,r){var i;null==e||"object"==typeof e?(i=e,r=t):(i={})[e]=t;var o=(r=n.extend({validate:!0,parse:!0},r)).wait;if(i&&!o){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;var s=this,a=r.success,u=this.attributes;r.success=function(e){s.attributes=u;var t=r.parse?s.parse(e,r):e;if(o&&(t=n.extend({},i,t)),t&&!s.set(t,r))return!1;a&&a.call(r.context,s,e,r),s.trigger("sync",s,e,r)},N(this,r),i&&o&&(this.attributes=n.extend({},u,i));var c=this.isNew()?"create":r.patch?"patch":"update";"patch"!==c||r.attrs||(r.attrs=i);var l=this.sync(c,this,r);return this.attributes=u,l},destroy:function(e){var t=this,r=(e=e?n.clone(e):{}).success,i=e.wait,o=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(n){i&&o(),r&&r.call(e.context,t,n,e),t.isNew()||t.trigger("sync",t,n,e)};var s=!1;return this.isNew()?n.defer(e.success):(N(this,e),s=this.sync("delete",this,e)),i||o(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||I();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.defaults({validate:!0},e))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return!r||(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1)}}),s(_,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes");var v=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},b={add:!0,remove:!0,merge:!0},w={add:!0,remove:!1},x=function(e,t,n){n=Math.min(Math.max(n,0),e.length);for(var r=Array(e.length-n),i=t.length,o=0;o<r.length;o++)r[o]=e[o+n];for(o=0;o<i;o++)e[o+n]=t[o];for(o=0;o<r.length;o++)e[o+i+n]=r[o]};n.extend(v.prototype,c,{model:_,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,w))},remove:function(e,t){t=n.extend({},t);var r=!n.isArray(e);e=r?[e]:n.clone(e);var i=this._removeModels(e,t);return!t.silent&&i&&this.trigger("update",this,t),r?i[0]:i},set:function(e,t){if(null!=e){(t=n.defaults({},t,b)).parse&&!this._isModel(e)&&(e=this.parse(e,t));var r=!n.isArray(e);e=r?[e]:e.slice();var i=t.at;null!=i&&(i=+i),i<0&&(i+=this.length+1);for(var o,s=[],a=[],u=[],c={},l=t.add,h=t.merge,f=t.remove,p=!1,d=this.comparator&&null==i&&!1!==t.sort,g=n.isString(this.comparator)?this.comparator:null,m=0;m<e.length;m++){o=e[m];var y=this.get(o);if(y){if(h&&o!==y){var _=this._isModel(o)?o.attributes:o;t.parse&&(_=y.parse(_,t)),y.set(_,t),d&&!p&&(p=y.hasChanged(g))}c[y.cid]||(c[y.cid]=!0,s.push(y)),e[m]=y}else l&&(o=e[m]=this._prepareModel(o,t))&&(a.push(o),this._addReference(o,t),c[o.cid]=!0,s.push(o))}if(f){for(m=0;m<this.length;m++)o=this.models[m],c[o.cid]||u.push(o);u.length&&this._removeModels(u,t)}var v=!1,w=!d&&l&&f;if(s.length&&w?(v=this.length!=s.length||n.some(this.models,function(e,t){return e!==s[t]}),this.models.length=0,x(this.models,s,0),this.length=this.models.length):a.length&&(d&&(p=!0),x(this.models,a,null==i?this.length:i),this.length=this.models.length),p&&this.sort({silent:!0}),!t.silent){for(m=0;m<a.length;m++)null!=i&&(t.index=i+m),(o=a[m]).trigger("add",o,this,t);(p||v)&&this.trigger("sort",this,t),(a.length||u.length)&&this.trigger("update",this,t)}return r?e[0]:e}},reset:function(e,t){t=t?n.clone(t):{};for(var r=0;r<this.models.length;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return o.apply(this.models,arguments)},get:function(e){if(null!=e){var t=this.modelId(this._isModel(e)?e.attributes:e);return this._byId[e]||this._byId[t]||this._byId[e.cid]}},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var r=t.length;return n.isFunction(t)&&(t=n.bind(t,this)),1===r||n.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){var t=(e=n.extend({parse:!0},e)).success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t.call(e.context,r,n,e),r.trigger("sync",r,n,e)},N(this,e),this.sync("read",this,e)},create:function(e,t){var r=(t=t?n.clone(t):{}).wait;if(!(e=this._prepareModel(e,t)))return!1;r||this.add(e,t);var i=this,o=t.success;return t.success=function(e,t,n){r&&i.add(e,n),o&&o.call(n.context,e,t,n)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;(t=t?n.clone(t):{}).collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_removeModels:function(e,t){for(var n=[],r=0;r<e.length;r++){var i=this.get(e[r]);if(i){var o=this.indexOf(i);this.models.splice(o,1),this.length--,t.silent||(t.index=o,i.trigger("remove",i,this,t)),n.push(i),this._removeReference(i,t)}}return!!n.length&&n},_isModel:function(e){return e instanceof _},_addReference:function(e,t){this._byId[e.cid]=e;var n=this.modelId(e.attributes);null!=n&&(this._byId[n]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var n=this.modelId(e.attributes);null!=n&&delete this._byId[n],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if("add"!==e&&"remove"!==e||n===this){if("destroy"===e&&this.remove(t,r),"change"===e){var i=this.modelId(t.previousAttributes()),o=this.modelId(t.attributes);i!==o&&(null!=i&&delete this._byId[i],null!=o&&(this._byId[o]=t))}this.trigger.apply(this,arguments)}}}),s(v,{forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3},"models");var C=t.View=function(e){this.cid=n.uniqueId("view"),n.extend(this,n.pick(e,S)),this._ensureElement(),this.initialize.apply(this,arguments)},E=/^(\S+)\s*(.*)$/,S=["model","collection","el","id","attributes","className","tagName","events"];n.extend(C.prototype,c,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=n.result(this,"events")),!e)return this;for(var t in this.undelegateEvents(),e){var r=e[t];if(n.isFunction(r)||(r=this[r]),r){var i=t.match(E);this.delegate(i[1],i[2],n.bind(r,this))}}return this},delegate:function(e,t,n){return this.$el.on(e+".delegateEvents"+this.cid,t,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,n){return this.$el.off(e+".delegateEvents"+this.cid,t,n),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e.class=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,r,i){var o=T[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:o,dataType:"json"};if(i.url||(s.url=n.result(r,"url")||I()),null!=i.data||!r||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),i.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){s.type="POST",i.emulateJSON&&(s.data._method=o);var a=i.beforeSend;i.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",o),a)return a.apply(this,arguments)}}"GET"===s.type||i.emulateJSON||(s.processData=!1);var u=i.error;i.error=function(e,t,n){i.textStatus=t,i.errorThrown=n,u&&u.call(i.context,e,t,n)};var c=i.xhr=t.ajax(n.extend(s,i));return r.trigger("request",r,c,i),c};var T={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var A=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},M=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,L=/\*\w+/g,O=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(A.prototype,c,{initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var o=this;return t.history.route(e,function(n){var s=o._extractParameters(e,n);!1!==o.execute(i,s,r)&&(o.trigger.apply(o,["route:"+r].concat(s)),o.trigger("route",r,s),t.history.trigger("route",o,r,s))}),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(O,"\\$&").replace(M,"(?:$1)?").replace(k,function(e,t){return t?e:"([^/?]+)"}).replace(L,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var R=t.History=function(){this.handlers=[],this.checkUrl=n.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},F=/^[#\/]|\s+$/g,P=/^\/+|\/+$/g,B=/#.*$/;R.started=!1,n.extend(R.prototype,c,{interval:50,atRoot:function(){var e=this.location.pathname.replace(/[^\/]$/,"$&/");return e===this.root&&!this.getSearch()},matchRoot:function(){var e=this.decodeFragment(this.location.pathname),t=e.slice(0,this.root.length-1)+"/";return t===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(F,"")},start:function(e){if(R.started)throw new Error("Backbone.history has already been started");if(R.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(P,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var r=document.body,i=r.insertBefore(this.iframe,r.firstChild).contentWindow;i.document.open(),i.document.close(),i.location.hash="#"+this.fragment}var o=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};if(this._usePushState?o("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?o("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),R.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),n.some(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0}))},navigate:function(e,t){if(!R.started)return!1;t&&!0!==t||(t={trigger:!!t}),e=this.getFragment(e||"");var n=this.root;""!==e&&"?"!==e.charAt(0)||(n=n.slice(0,-1)||"/");var r=n+e;if(e=this.decodeFragment(e.replace(B,"")),this.fragment!==e){if(this.fragment=e,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,r);else{if(!this._wantsHashChange)return this.location.assign(r);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var i=this.iframe.contentWindow;t.replace||(i.document.open(),i.document.close()),this._updateHash(i.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new R;_.extend=v.extend=A.extend=C.extend=R.extend=function(e,t){var r,i=this;r=e&&n.has(e,"constructor")?e.constructor:function(){return i.apply(this,arguments)};n.extend(r,i,t);var o=function(){this.constructor=r};o.prototype=i.prototype,r.prototype=new o,e&&n.extend(r.prototype,e);return r.__super__=i.prototype,r};var I=function(){throw new Error('A "url" property or function must be specified')},N=function(e,t){var n=t.error;t.error=function(r){n&&n.call(t.context,e,r,t),e.trigger("error",e,r,t)}};return t}(a,n,e,t)}.apply(t,i))||(e.exports=o)}()}).call(this,n(30))},function(e,t,n){"use strict";var r=n(17),i=n(0),o=n(1),s=o.Model.extend({initialize:function(e){return i.bindAll(this,"fetch","save","retrigger"),o.Model.prototype.initialize.call(this,e)},fetch:function(e){var t=this;this.trigger("loadModelStarted"),r.when(o.Model.prototype.fetch.call(this,e)).done(function(e){t.trigger("loadModelCompleted",e,t)}).fail(function(e){t.trigger("loadModelFailed",e,t)})},setIdAttribute:function(e){this.idAttribute=e},retrigger:function(e,t,n){n||(n=e);var r=this;t.bind&&t.bind(e,function(){r.trigger(n)},r)},save:function(e,t){var n=this;t&&t.silent||this.trigger("saving");var i=o.Model.prototype.save.apply(this,arguments);return r.when(i).done(function(){t&&t.silent||n.trigger("saved")}).fail(function(){t&&t.silent||n.trigger("errorSaving")}),i}});e.exports=s},function(e,t,n){"use strict";var r=n(4);e.exports=function(e,t,n){return new r({origin:"validation",type:e,message:t},n)}},function(e,t,n){"use strict";var r=n(143),i=n(138),o="unexpected error",s="generic";e.exports=function(e,t){t=t||{};var n=Object.create(Error.prototype);n.message=e&&e.message||o,n.origin=e&&e.origin||s,n.type=e&&e.type||"",function(e){return e&&"windshaft"===e.origin}(e)&&(n=function(e,t,n){var r=Object.create(Error.prototype);return r.message=e.message,r.origin=e.origin,r.type=e.type,"layer"===e.type&&t&&(r.layer=t.findById(e.layerId)),"analysis"===e.type&&(n&&(r.source=n,r.sourceId=n.getId&&n.getId()),e.analysisId&&(r.sourceId=e.analysisId)),r}(e,t.layers,t.analysis)),function(e){return e&&e.responseText}(e)&&(n=function(e){var t=Object.create(Error.prototype);return t.message=function(e){var t="";try{var n=JSON.parse(e.responseText);t=n.errors[0]}catch(e){}return t||o}(e),t.origin="ajax",t.type=e.statusText,t}(e));var a=r.getExtraFields(n);return n.message=a.friendlyMessage,n.errorCode=a.errorCode,n.name="CartoError",n.stack=(new Error).stack,n.originalError=e,i.track(n),n}},function(e,t,n){"use strict";var r=n(0),i={COUNT:"count",SUM:"sum",AVG:"avg",MAX:"max",MIN:"min"};var o={AUTO:"auto",MILLENNIUM:"millennium",CENTURY:"century",DECADE:"decade",YEAR:"year",QUARTER:"quarter",MONTH:"month",WEEK:"week",DAY:"day",HOUR:"hour",MINUTE:"minute"};e.exports={operation:i,status:{NOT_LOADED:"notLoaded",LOADING:"loading",LOADED:"loaded",ERROR:"error"},timeAggregation:o,isValidOperation:function(e){return r.contains(i,e)},isValidTimeAggregation:function(e){return r.contains(o,e)},ATTRIBUTION:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="https://carto.com/about-carto/">CARTO</a>'}},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(3);function s(){}r.extend(s.prototype,i.Events),s.prototype._getValidationError=function(e){return new o("filter",e)},e.exports=s},function(e,t,n){"use strict";var r=n(0),i={isCORSSupported:function(){return"withCredentials"in new XMLHttpRequest},array2hex:function(e){for(var t=[],n=0;n<e.length;++n)t.push(String.fromCharCode(e[n]+128));return i.btoa(t.join(""))},btoa:function(e){return"function"==typeof window.btoa?i.encodeBase64Native(e):i.encodeBase64(e)},encodeBase64Native:function(e){return btoa(e)},encodeBase64:function(e){var t,n,r,i,o,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=0,u=0,c="",l=[];if(!e)return e;do{t=(o=e.charCodeAt(a++)<<16|e.charCodeAt(a++)<<8|e.charCodeAt(a++))>>18&63,n=o>>12&63,r=o>>6&63,i=63&o,l[u++]=s.charAt(t)+s.charAt(n)+s.charAt(r)+s.charAt(i)}while(a<e.length);c=l.join("");var h=e.length%3;return(h?c.slice(0,h-3):c)+"===".slice(h||3)},uniqueCallbackName:function(e){return i._callback_c=i._callback_c||0,++i._callback_c,i.crc32(e)+"_"+i._callback_c},crc32:function(e){for(var t=i._crcTable||(i._crcTable=i._makeCRCTable()),n=-1,r=0,o=e.length;r<o;++r)n=n>>>8^t[255&(n^e.charCodeAt(r))];return(-1^n)>>>0},_makeCRCTable:function(){for(var e,t=[],n=0;n<256;++n){e=n;for(var r=0;r<8;++r)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t},_inferBrowser:function(e){var t={};return e=e||"undefined"!=typeof window&&window.navigator.userAgent||"",!function(){var t=e.indexOf("MSIE "),n=e.indexOf("Trident/");return t>-1||n>-1}()?e.indexOf("Edge/")>-1?t.edge=e:e.indexOf("Chrome")>-1?t.chrome=e:e.indexOf("Firefox")>-1?t.firefox=e:e.indexOf("Opera")>-1?t.opera=e:e.indexOf("Safari")>-1&&(t.safari=e):t.ie={version:document.compatMode?window.XMLHttpRequest?document.querySelector?document.addEventListener?window.atob?document.all?10:11:9:8:7:6:5},t}};i.browser=i._inferBrowser(),i.isMobileDevice=function(){return/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},i.supportsTouch=function(){return"ontouchstart"in window||navigator.msMaxTouchPoints};var o=null;i.isWebGLSupported=function(){if(null===o){var e=document.createElement("canvas");o=!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}return o},i.endsWith=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},i.checkRequiredOpts=function(e,t,n){r.each(t,function(t){if(r.isUndefined(e[t]))throw new Error(t+" is required"+(n?" to initialize "+n:""))})},i.isLeafletLoaded=function(){if(!window.L)throw new Error("Leaflet is required");if(window.L.version<"1.0.0")throw new Error("Leaflet +1.0 is required")},i.isGoogleMapsLoaded=function(){if(!window.google)throw new Error("Google Maps is required");if(!window.google.maps)throw new Error("Google Maps is required");if(window.google.maps.version<"3.31.0")throw new Error("Google Maps version should be >= 3.31")},e.exports=i},function(e,t,n){"use strict";e.exports={BBOX:"bbox",CIRCLE:"circle",POLYGON:"polygon"}},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(2),s=n(7),a=["camshaftReference","engine"],u={PENDING:"pending",WAITING:"waiting",RUNNING:"running",FAILED:"failed",READY:"ready"},c=o.extend({initialize:function(e,t){t=t||{},s.checkRequiredOpts(t,a,"AnalysisModel"),this._camshaftReference=t.camshaftReference,this._engine=t.engine,this._initBinds(),this._referencedBy={}},url:function(){var e=this.get("url");if(e){if(this.get("apiKey"))e+="?api_key="+this.get("apiKey");else if(this.get("authToken")){var t=this.get("authToken");if(t instanceof Array)e+="?"+r.map(t,function(e){return"auth_token[]="+e}).join("&");else e+="?auth_token="+t}return e}},setOk:function(){this.unset("error")},setError:function(e){this.set({error:e,status:u.FAILED})},_initBinds:function(){this.bind("change:type",function(){this.unbind(null,null,this),this._initBinds(),this._reload()},this),r.each(this.getParamNames(),function(e){this.bind("change:"+e,this._reload,this)},this),this.bind("change:status",function(){this._hadStatus()&&this.isReady()&&this.isSourceOfAnyModel()&&this._reload()},this)},_hadStatus:function(){return this.previous("status")},_reload:function(){this._engine.reload({error:this._onMapReloadError.bind(this)})},_onMapReloadError:function(){this.set("status",u.FAILED)},remove:function(){this.trigger("destroy",this),this.stopListening()},findAnalysisById:function(e){return this.get("id")===e?this:r.chain(this._getSourceNames()).map(function(t){var n=this.get(t);if(n)return n.findAnalysisById(e)},this).compact().value()[0]},_getSourceNames:function(){return this._camshaftReference.getSourceNamesForAnalysisType(this.get("type"))},isDone:function(){return this._hasStatus([u.READY,u.FAILED])},isLoading:function(){return this._hasStatus([u.PENDING,u.WAITING,u.RUNNING])},isReady:function(){return this._hasStatus(u.READY)},isFailed:function(){return this._hasStatus(u.FAILED)},_hasStatus:function(e){return r.isArray(e)||(e=[e]),r.contains(e,this._getStatus())},_getStatus:function(){return this.get("status")},toJSON:function(){var e=r.pick(this.attributes,"id","type");e.params=r.pick(this.attributes,this.getParamNames());var t=this._getSourceNames();return r.each(t,function(t){var n={},i=this.get(t);i&&(n[t]=i.toJSON(),r.extend(e.params,n))},this),e},getParamNames:function(){return this._camshaftReference.getParamNamesForAnalysisType(this.get("type"))},getNodes:function(){var e=[this];return"source"!==this.get("type")&&r.forEach(this._getSourceNames(),function(t){var n=this.get(t);n&&(e=e.concat(n.getNodes()))},this),e},getNodesCollection:function(){return new i.Collection(this.getNodes())},equals:function(e){return e instanceof c&&this.get("id")===e.get("id")},markAsSourceOf:function(e){this._referencedBy[e.cid]=!0},isSourceOfAnyModel:function(){return Object.keys(this._referencedBy).length>0},isSourceOf:function(e){return!!this._referencedBy[e.cid]},unmarkAsSourceOf:function(e){delete this._referencedBy[e.cid]}},{STATUS:u});e.exports=c},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(5).status,s=n(12),a=n(6),u=n(11),c=n(8),l=n(4),h=n(3);function f(){}r.extend(f.prototype,i.Events),f.prototype.getStatus=function(){return this._status},f.prototype.isLoading=function(){return this._status===o.LOADING},f.prototype.isLoaded=function(){return this._status===o.LOADED},f.prototype.hasError=function(){return this._status===o.ERROR},f.prototype.enable=function(){return this._setEnabled(!0)},f.prototype.disable=function(){return this._setEnabled(!1)},f.prototype.isEnabled=function(){return this._enabled},f.prototype.getSource=function(){return this._source},f.prototype.setColumn=function(e){return this._checkColumn(e),this._column=e,this._internalModel&&this._internalModel.set("column",this._column),this},f.prototype.getColumn=function(){return this._column},f.prototype.addFilter=function(e){return this._checkFilter(e),this._addSpatialFilter(e),this},f.prototype.removeFilter=function(e){return this._checkFilter(e),this._removeSpatialFilter(e),this},f.prototype.hasFilter=function(e){this._checkFilter(e);var t=e===this._boundingBoxFilter&&this._internalModel&&this._internalModel.get("sync_on_bbox_change"),n=e===this._circleFilter&&this._internalModel&&this._internalModel.get("sync_on_circle_change"),r=e===this._polygonFilter&&this._internalModel&&this._internalModel.get("sync_on_polygon_change");return t||n||r},f.prototype.getData=function(){throw new Error("getData must be implemented by the particular dataview.")},f.prototype.DEFAULTS={},f.prototype._initialize=function(e,t,n){n=r.defaults(n||{},this.DEFAULTS),this._checkSource(e),this._checkColumn(t),this._checkOptions(n),this._source=e,this._column=t,this._options=n,this._status=o.NOT_LOADED,this._enabled=!0,this._boundingBoxFilter=null},f.prototype._checkSource=function(e){if(!(e instanceof s))throw this._getValidationError("sourceRequired")},f.prototype._checkColumn=function(e){if(r.isUndefined(e))throw this._getValidationError("columnRequired");if(!r.isString(e))throw this._getValidationError("columnString");if(r.isEmpty(e))throw this._getValidationError("emptyColumn")},f.prototype._checkOptions=function(e){throw new Error("_checkOptions must be implemented by the particular dataview.")},f.prototype._checkFilter=function(e){if(!(e instanceof a)||e instanceof u)throw this._getValidationError("filterRequired")},f.prototype._createInternalModel=function(e){throw new Error("_createInternalModel must be implemented by the particular dataview.")},f.prototype._setEnabled=function(e){return this._enabled=e,this._internalModel&&this._internalModel.set("enabled",e),this},f.prototype._listenToInternalModelSharedEvents=function(){this._internalModel&&(this.listenTo(this._internalModel,"change:data",this._onDataChanged),this.listenTo(this._internalModel,"change:column",this._onColumnChanged),this.listenTo(this._internalModel,"loading",this._onStatusLoading),this.listenTo(this._internalModel,"loaded",this._onStatusLoaded),this.listenTo(this._internalModel,"statusError",this._onStatusError))},f.prototype._onDataChanged=function(){this.trigger("dataChanged",this.getData())},f.prototype._onColumnChanged=function(){this._internalModel&&(this._column=this._internalModel.get("column")),this.trigger("columnChanged",this._column)},f.prototype._onStatusLoading=function(){this._status=o.LOADING,this.trigger("statusChanged",this._status)},f.prototype._onStatusLoaded=function(){this._status=o.LOADED,this.trigger("statusChanged",this._status)},f.prototype._onStatusError=function(e,t){this._status=o.ERROR,this.trigger("statusChanged",this._status,t),this._triggerError(this,t)},f.prototype._changeProperty=function(e,t,n){var r=this["_"+e];this["_"+e]=t,r!==t&&(this._triggerChange(e,t),this._internalModel&&this._internalModel.set(n||e,t))},f.prototype._changeProperties=function(e){var t=this;r.each(e,function(e,n){t["_"+n]!==e&&(t["_"+n]=e,t._triggerChange(n,e))}),this._internalModel&&this._internalModel.set(e)},f.prototype._triggerChange=function(e,t){this.trigger(e+"Changed",t)},f.prototype._triggerError=function(e,t){this.trigger("error",new l(t))},f.prototype._addSpatialFilter=function(e){switch(e.type){case c.BBOX:this._addBoundingBoxFilter(e);break;case c.CIRCLE:this._addCircleFilter(e);break;case c.POLYGON:this._addPolygonFilter(e);break;default:throw new Error("The filter is not a valid spatial filter.")}},f.prototype._removeSpatialFilter=function(e){switch(e.type){case c.BBOX:e===this._boundingBoxFilter&&this._removeBoundingBoxFilter();break;case c.CIRCLE:e===this._circleFilter&&this._removeCircleFilter();break;case c.POLYGON:e===this._polygonFilter&&this._removePolygonFilter();break;default:throw new Error("The filter is not a valid spatial filter.")}},f.prototype._addBoundingBoxFilter=function(e){e!==this._boundingBoxFilter&&(this._boundingBoxFilter=e,this._internalModel&&(this._internalModel.addBBoxFilter(this._boundingBoxFilter.$getInternalModel()),this._internalModel.set("sync_on_bbox_change",!0)))},f.prototype._removeBoundingBoxFilter=function(){this._boundingBoxFilter=null,this._internalModel&&(this._internalModel.removeBBoxFilter(),this._internalModel.set("sync_on_bbox_change",!1))},f.prototype._addCircleFilter=function(e){e!==this._circleFilter&&(this._circleFilter=e,this._internalModel&&(this._internalModel.addCircleFilter(this._circleFilter.$getInternalModel()),this._internalModel.set("sync_on_circle_change",!0)))},f.prototype._removeCircleFilter=function(){this._circleFilter=null,this._internalModel&&(this._internalModel.removeCircleFilter(),this._internalModel.set("sync_on_circle_change",!1))},f.prototype._addPolygonFilter=function(e){e!==this._polygonFilter&&(this._polygonFilter=e,this._internalModel&&(this._internalModel.addPolygonFilter(this._polygonFilter.$getInternalModel()),this._internalModel.set("sync_on_polygon_change",!0)))},f.prototype._removePolygonFilter=function(){this._polygonFilter=null,this._internalModel&&(this._internalModel.removePolygonFilter(),this._internalModel.set("sync_on_polygon_change",!1))},f.prototype._getValidationError=function(e){return new h("dataview",e)},f.prototype.$setEngine=function(e){this._source.$setEngine(e),this._internalModel||(this._createInternalModel(e),this._listenToInternalModelSharedEvents())},f.prototype.$getInternalModel=function(){return this._internalModel},e.exports=f},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=n(0),o=n(6),s=n(95),a=["includeNull"],u=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r._checkColumn(e),r._checkOptions(n),r._column=e,r._filters={},r._options=n,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o),r(t,[{key:"set",value:function(e,t){if(e&&t&&i.isString(e)){var n=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},e,t);this._checkFilters(n),this._filters[e]=t,this.trigger("change:filters",n)}}},{key:"setFilters",value:function(e){e&&i.isObject(e)&&(this._checkFilters(e),this._filters=e,this.trigger("change:filters",e))}},{key:"resetFilters",value:function(){this.setFilters({})}},{key:"$getSQL",value:function(){var e=this,t=Object.keys(this._filters),n=t.map(function(t){return e._interpolateFilter(t,e._filters[t])}).filter(function(e){return Boolean(e)}).join(" AND ");return this._options.includeNull&&this._includeNullInQuery(n),t.length>1?"("+n+")":n}},{key:"_checkColumn",value:function(e){if(i.isUndefined(e))throw this._getValidationError("columnRequired");if(!i.isString(e))throw this._getValidationError("columnString");if(i.isEmpty(e))throw this._getValidationError("emptyColumn")}},{key:"_checkFilters",value:function(e){var t=this;Object.keys(e).forEach(function(n){if(!i.contains(t.ALLOWED_FILTERS,n))throw t._getValidationError("invalidFilter"+n);if(!t.PARAMETER_SPECIFICATION[n].parameters.every(function(t){var n=s(e,t.name);return t.allowedTypes.some(function(e){return c(e,n)})}))throw t._getValidationError("invalidParameterType"+n)})}},{key:"_checkOptions",value:function(e){var t=this;Object.keys(e).forEach(function(e){if(!i.contains(a,e))throw t._getValidationError("invalidOption"+e)})}},{key:"_convertValueToSQLString",value:function(e){var t=this;return i.isDate(e)?"'"+e.toISOString()+"'":i.isArray(e)?e.map(function(e){return t._convertValueToSQLString(e)}).join(","):i.isObject(e)?(Object.keys(e).forEach(function(n){"query"!==n&&(e[n]=t._convertValueToSQLString(e[n]))}),e):i.isNumber(e)?e:"'"+l(e.toString())+"'"}},{key:"_interpolateFilter",value:function(e,t){var n=i.template(this.SQL_TEMPLATES[e]),r=this._convertValueToSQLString(t);return n({column:this._column,value:r})}},{key:"_includeNullInQuery",value:function(e){return Object.keys(this._filters).length>1&&(e="("+e+")"),"("+e+" OR "+this._column+" IS NULL)"}}]),t}(),c=function(e,t){return i["is"+e](t)},l=function(e){return e.replace(/\n/g,"\\n").replace(/\"/g,'\\"').replace(/'/g,"''")};e.exports=u},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(4),s=n(21),a=n(14);function u(){this._id=u.$generateId(),this._hasFiltersApplied=!1,this._appliedFilters=new s}r.extend(u.prototype,i.Events),u.$nextId=0,u.$generateId=function(){return"S"+ ++u.$nextId},u.prototype.getId=function(){return this._id},u.prototype._createInternalModel=function(e){throw new Error("_createInternalModel must be implemented by the particular source")},u.prototype._triggerError=function(e,t){this.trigger(a.ERROR,new o(t,{analysis:this}))},u.prototype.$setEngine=function(e){this._internalModel||(this._internalModel=this._createInternalModel(e),this._internalModel.on("change:error",this._triggerError,this))},u.prototype.$getEngine=function(e){if(this._internalModel)return this._internalModel._engine},u.prototype.$getInternalModel=function(){return this._internalModel},u.prototype.getFilters=function(){return this._appliedFilters.getFilters()},u.prototype.addFilter=function(e){this._hasFiltersApplied=!0,this._appliedFilters.addFilter(e)},u.prototype.addFilters=function(e){var t=this;e.forEach(function(e){return t.addFilter(e)})},u.prototype.removeFilter=function(e){this._appliedFilters.removeFilter(e),this._hasFiltersApplied=Boolean(this._appliedFilters.count())},u.prototype.removeFilters=function(e){var t=this;e.forEach(function(e){return t.removeFilter(e)})},e.exports=u},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(44),s=["state","visible"],a=i.Model.extend({defaults:function(){return{visible:!1,title:"",preHTMLSnippet:"",postHTMLSnippet:"",state:this.constructor.STATE_LOADING}},initialize:function(e,t){if(!t.engine)throw new Error("engine is required");t.engine.on(o.Events.RELOAD_STARTED,this._onEngineReloadStarted,this)},_onEngineReloadStarted:function(){this.set("state",this.constructor.STATE_LOADING)},isLoading:function(){return this.get("state")===this.constructor.STATE_LOADING},isError:function(){return this.get("state")===this.constructor.STATE_ERROR},isSuccess:function(){return this.get("state")===this.constructor.STATE_SUCCESS},show:function(){this.set("visible",!0)},hide:function(){this.set("visible",!1)},isVisible:function(){return this.get("visible")},update:function(e){this.set(e)},getNonResettableAttrs:function(){return s},reset:function(){var e=r.omit(this.defaults(),this.getNonResettableAttrs());this.set(e)},isAvailable:function(){return!1}},{STATE_LOADING:"loading",STATE_SUCCESS:"success",STATE_ERROR:"error"});e.exports=a},function(e,t,n){"use strict";e.exports={SUCCESS:"success",ERROR:"error"}},function(e,t,n){"use strict";var r=n(0),i=function(e){this._rule=e};i.prototype.matchesAnyProperty=function(e){return this._matches(this._rule.prop,e)},i.prototype.matchesAnyMapping=function(e){return this._matches(this._rule.mapping,e)},i.prototype._matches=function(e,t){return r.isString(t)&&(t=[t]),r.contains(t,e)},i.prototype.getBucketsWithRangeFilter=function(){return this._getBucketsByFilterType("range")},i.prototype.getBucketsWithCategoryFilter=function(){return this._getBucketsByFilterType("category")},i.prototype.getBucketsWithDefaultFilter=function(){return this._getBucketsByFilterType("default")},i.prototype._getBucketsByFilterType=function(e){return this._rule?r.select(this._rule.buckets,function(t){return t.filter.type===e}):[]},i.prototype.getColumn=function(){return this._rule.column},i.prototype.getMapping=function(){return this._rule.mapping},i.prototype.getProperty=function(){return this._rule.prop},i.prototype.getFilterAvg=function(){return this._rule.stats.filter_avg},e.exports=i},function(e,t,n){"use strict";var r=function(e,t){return e.get("type").toLowerCase()===t.toLowerCase()};e.exports={isTiledLayer:function(e){return r(e,"Tiled")},isPlainLayer:function(e){return r(e,"Plain")},isWMSLayer:function(e){return r(e,"WMS")},isGoogleMapsBaseLayer:function(e){return r(e,"GMapsBase")},isCartoDBLayer:function(e){return r(e,"CartoDB")},isTorqueLayer:function(e){return r(e,"torque")}}},function(e,t,n){var r;
/*!
 * jQuery JavaScript Library v2.1.4
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2015-04-28T16:01Z
 */
/*!
 * jQuery JavaScript Library v2.1.4
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2015-04-28T16:01Z
 */
!function(t,n){"object"==typeof e&&"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(t)}("undefined"!=typeof window?window:this,function(n,i){var o=[],s=o.slice,a=o.concat,u=o.push,c=o.indexOf,l={},h=l.toString,f=l.hasOwnProperty,p={},d=n.document,g=function(e,t){return new g.fn.init(e,t)},m=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,y=/^-ms-/,_=/-([\da-z])/gi,v=function(e,t){return t.toUpperCase()};function b(e){var t="length"in e&&e.length,n=g.type(e);return"function"!==n&&!g.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e))}g.fn=g.prototype={jquery:"2.1.4",constructor:g,selector:"",length:0,toArray:function(){return s.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:s.call(this)},pushStack:function(e){var t=g.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return g.each(this,e,t)},map:function(e){return this.pushStack(g.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:u,sort:o.sort,splice:o.splice},g.extend=g.fn.extend=function(){var e,t,n,r,i,o,s=arguments[0]||{},a=1,u=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||g.isFunction(s)||(s={}),a===u&&(s=this,a--);a<u;a++)if(null!=(e=arguments[a]))for(t in e)n=s[t],s!==(r=e[t])&&(c&&r&&(g.isPlainObject(r)||(i=g.isArray(r)))?(i?(i=!1,o=n&&g.isArray(n)?n:[]):o=n&&g.isPlainObject(n)?n:{},s[t]=g.extend(c,o,r)):void 0!==r&&(s[t]=r));return s},g.extend({expando:"jQuery"+("2.1.4"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===g.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!g.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return"object"===g.type(e)&&!e.nodeType&&!g.isWindow(e)&&!(e.constructor&&!f.call(e.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[h.call(e)]||"object":typeof e},globalEval:function(e){var t,n=eval;(e=g.trim(e))&&(1===e.indexOf("use strict")?((t=d.createElement("script")).text=e,d.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(y,"ms-").replace(_,v)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r=0,i=e.length,o=b(e);if(n){if(o)for(;r<i&&!1!==t.apply(e[r],n);r++);else for(r in e)if(!1===t.apply(e[r],n))break}else if(o)for(;r<i&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?"":(e+"").replace(m,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(b(Object(e))?g.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:c.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,s=!n;i<o;i++)!t(e[i],i)!==s&&r.push(e[i]);return r},map:function(e,t,n){var r,i=0,o=e.length,s=[];if(b(e))for(;i<o;i++)null!=(r=t(e[i],i,n))&&s.push(r);else for(i in e)null!=(r=t(e[i],i,n))&&s.push(r);return a.apply([],s)},guid:1,proxy:function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),g.isFunction(e))return r=s.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(s.call(arguments)))}).guid=e.guid=e.guid||g.guid++,i},now:Date.now,support:p}),g.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});var w=
/*!
 * Sizzle CSS Selector Engine v2.2.0-pre
 * http://sizzlejs.com/
 *
 * Copyright 2008, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-12-16
 */
function(e){var t,n,r,i,o,s,a,u,c,l,h,f,p,d,g,m,y,_,v,b="sizzle"+1*new Date,w=e.document,x=0,C=0,E=se(),S=se(),T=se(),A=function(e,t){return e===t&&(h=!0),0},M=1<<31,k={}.hasOwnProperty,L=[],O=L.pop,R=L.push,F=L.push,P=L.slice,B=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},I="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",N="[\\x20\\t\\r\\n\\f]",D="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",j=D.replace("w","w#"),q="\\["+N+"*("+D+")(?:"+N+"*([*^$|!~]?=)"+N+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+j+"))|)"+N+"*\\]",z=":("+D+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+q+")*)|.*)\\)|)",U=new RegExp(N+"+","g"),$=new RegExp("^"+N+"+|((?:^|[^\\\\])(?:\\\\.)*)"+N+"+$","g"),H=new RegExp("^"+N+"*,"+N+"*"),G=new RegExp("^"+N+"*([>+~]|"+N+")"+N+"*"),V=new RegExp("="+N+"*([^\\]'\"]*?)"+N+"*\\]","g"),W=new RegExp(z),J=new RegExp("^"+j+"$"),Q={ID:new RegExp("^#("+D+")"),CLASS:new RegExp("^\\.("+D+")"),TAG:new RegExp("^("+D.replace("w","w*")+")"),ATTR:new RegExp("^"+q),PSEUDO:new RegExp("^"+z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+N+"*(even|odd|(([+-]|)(\\d*)n|)"+N+"*(?:([+-]|)"+N+"*(\\d+)|))"+N+"*\\)|)","i"),bool:new RegExp("^(?:"+I+")$","i"),needsContext:new RegExp("^"+N+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+N+"*((?:-\\d)?\\d*)"+N+"*\\)|)(?=[^-]|$)","i")},K=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,X=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=/'|\\/g,ne=new RegExp("\\\\([\\da-f]{1,6}"+N+"?|("+N+")|.)","ig"),re=function(e,t,n){var r="0x"+t-65536;return r!=r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},ie=function(){f()};try{F.apply(L=P.call(w.childNodes),w.childNodes),L[w.childNodes.length].nodeType}catch(e){F={apply:L.length?function(e,t){R.apply(e,P.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function oe(e,t,r,i){var o,a,c,l,h,d,y,_,x,C;if((t?t.ownerDocument||t:w)!==p&&f(t),t=t||p,r=r||[],l=t.nodeType,"string"!=typeof e||!e||1!==l&&9!==l&&11!==l)return r;if(!i&&g){if(11!==l&&(o=X.exec(e)))if(c=o[1]){if(9===l){if(!(a=t.getElementById(c))||!a.parentNode)return r;if(a.id===c)return r.push(a),r}else if(t.ownerDocument&&(a=t.ownerDocument.getElementById(c))&&v(t,a)&&a.id===c)return r.push(a),r}else{if(o[2])return F.apply(r,t.getElementsByTagName(e)),r;if((c=o[3])&&n.getElementsByClassName)return F.apply(r,t.getElementsByClassName(c)),r}if(n.qsa&&(!m||!m.test(e))){if(_=y=b,x=t,C=1!==l&&e,1===l&&"object"!==t.nodeName.toLowerCase()){for(d=s(e),(y=t.getAttribute("id"))?_=y.replace(te,"\\$&"):t.setAttribute("id",_),_="[id='"+_+"'] ",h=d.length;h--;)d[h]=_+me(d[h]);x=ee.test(e)&&de(t.parentNode)||t,C=d.join(",")}if(C)try{return F.apply(r,x.querySelectorAll(C)),r}catch(e){}finally{y||t.removeAttribute("id")}}}return u(e.replace($,"$1"),t,r,i)}function se(){var e=[];return function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}}function ae(e){return e[b]=!0,e}function ue(e){var t=p.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ce(e,t){for(var n=e.split("|"),i=e.length;i--;)r.attrHandle[n[i]]=t}function le(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||M)-(~e.sourceIndex||M);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function he(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function fe(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function pe(e){return ae(function(t){return t=+t,ae(function(n,r){for(var i,o=e([],n.length,t),s=o.length;s--;)n[i=o[s]]&&(n[i]=!(r[i]=n[i]))})})}function de(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=oe.support={},o=oe.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},f=oe.setDocument=function(e){var t,i,s=e?e.ownerDocument||e:w;return s!==p&&9===s.nodeType&&s.documentElement?(p=s,d=s.documentElement,(i=s.defaultView)&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",ie,!1):i.attachEvent&&i.attachEvent("onunload",ie)),g=!o(s),n.attributes=ue(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ue(function(e){return e.appendChild(s.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Y.test(s.getElementsByClassName),n.getById=ue(function(e){return d.appendChild(e).id=b,!s.getElementsByName||!s.getElementsByName(b).length}),n.getById?(r.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},r.filter.ID=function(e){var t=e.replace(ne,re);return function(e){return e.getAttribute("id")===t}}):(delete r.find.ID,r.filter.ID=function(e){var t=e.replace(ne,re);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),r.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},r.find.CLASS=n.getElementsByClassName&&function(e,t){if(g)return t.getElementsByClassName(e)},y=[],m=[],(n.qsa=Y.test(s.querySelectorAll))&&(ue(function(e){d.appendChild(e).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+N+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\["+N+"*(?:value|"+I+")"),e.querySelectorAll("[id~="+b+"-]").length||m.push("~="),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+b+"+*").length||m.push(".#.+[+~]")}),ue(function(e){var t=s.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name"+N+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")})),(n.matchesSelector=Y.test(_=d.matches||d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&ue(function(e){n.disconnectedMatch=_.call(e,"div"),_.call(e,"[s!='']:x"),y.push("!=",z)}),m=m.length&&new RegExp(m.join("|")),y=y.length&&new RegExp(y.join("|")),t=Y.test(d.compareDocumentPosition),v=t||Y.test(d.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},A=t?function(e,t){if(e===t)return h=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===r?e===s||e.ownerDocument===w&&v(w,e)?-1:t===s||t.ownerDocument===w&&v(w,t)?1:l?B(l,e)-B(l,t):0:4&r?-1:1)}:function(e,t){if(e===t)return h=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],u=[t];if(!i||!o)return e===s?-1:t===s?1:i?-1:o?1:l?B(l,e)-B(l,t):0;if(i===o)return le(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)u.unshift(n);for(;a[r]===u[r];)r++;return r?le(a[r],u[r]):a[r]===w?-1:u[r]===w?1:0},s):p},oe.matches=function(e,t){return oe(e,null,null,t)},oe.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&f(e),t=t.replace(V,"='$1']"),n.matchesSelector&&g&&(!y||!y.test(t))&&(!m||!m.test(t)))try{var r=_.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){}return oe(t,p,null,[e]).length>0},oe.contains=function(e,t){return(e.ownerDocument||e)!==p&&f(e),v(e,t)},oe.attr=function(e,t){(e.ownerDocument||e)!==p&&f(e);var i=r.attrHandle[t.toLowerCase()],o=i&&k.call(r.attrHandle,t.toLowerCase())?i(e,t,!g):void 0;return void 0!==o?o:n.attributes||!g?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},oe.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},oe.uniqueSort=function(e){var t,r=[],i=0,o=0;if(h=!n.detectDuplicates,l=!n.sortStable&&e.slice(0),e.sort(A),h){for(;t=e[o++];)t===e[o]&&(i=r.push(o));for(;i--;)e.splice(r[i],1)}return l=null,e},i=oe.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=i(t);return n},(r=oe.selectors={cacheLength:50,createPseudo:ae,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ne,re),e[3]=(e[3]||e[4]||e[5]||"").replace(ne,re),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||oe.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&oe.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return Q.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&W.test(n)&&(t=s(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ne,re).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=E[e+" "];return t||(t=new RegExp("(^|"+N+")"+e+"("+N+"|$)"))&&E(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=oe.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace(U," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var c,l,h,f,p,d,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,y=a&&t.nodeName.toLowerCase(),_=!u&&!a;if(m){if(o){for(;g;){for(h=t;h=h[g];)if(a?h.nodeName.toLowerCase()===y:1===h.nodeType)return!1;d=g="only"===e&&!d&&"nextSibling"}return!0}if(d=[s?m.firstChild:m.lastChild],s&&_){for(p=(c=(l=m[b]||(m[b]={}))[e]||[])[0]===x&&c[1],f=c[0]===x&&c[2],h=p&&m.childNodes[p];h=++p&&h&&h[g]||(f=p=0)||d.pop();)if(1===h.nodeType&&++f&&h===t){l[e]=[x,p,f];break}}else if(_&&(c=(t[b]||(t[b]={}))[e])&&c[0]===x)f=c[1];else for(;(h=++p&&h&&h[g]||(f=p=0)||d.pop())&&((a?h.nodeName.toLowerCase()!==y:1!==h.nodeType)||!++f||(_&&((h[b]||(h[b]={}))[e]=[x,f]),h!==t)););return(f-=i)===r||f%r==0&&f/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||oe.error("unsupported pseudo: "+e);return i[b]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?ae(function(e,n){for(var r,o=i(e,t),s=o.length;s--;)e[r=B(e,o[s])]=!(n[r]=o[s])}):function(e){return i(e,0,n)}):i}},pseudos:{not:ae(function(e){var t=[],n=[],r=a(e.replace($,"$1"));return r[b]?ae(function(e,t,n,i){for(var o,s=r(e,null,i,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}}),has:ae(function(e){return function(t){return oe(e,t).length>0}}),contains:ae(function(e){return e=e.replace(ne,re),function(t){return(t.textContent||t.innerText||i(t)).indexOf(e)>-1}}),lang:ae(function(e){return J.test(e||"")||oe.error("unsupported lang: "+e),e=e.replace(ne,re).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===d},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return Z.test(e.nodeName)},input:function(e){return K.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:pe(function(){return[0]}),last:pe(function(e,t){return[t-1]}),eq:pe(function(e,t,n){return[n<0?n+t:n]}),even:pe(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:pe(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:pe(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:pe(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=r.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=he(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=fe(t);function ge(){}function me(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function ye(e,t,n){var r=t.dir,i=n&&"parentNode"===r,o=C++;return t.first?function(t,n,o){for(;t=t[r];)if(1===t.nodeType||i)return e(t,n,o)}:function(t,n,s){var a,u,c=[x,o];if(s){for(;t=t[r];)if((1===t.nodeType||i)&&e(t,n,s))return!0}else for(;t=t[r];)if(1===t.nodeType||i){if((a=(u=t[b]||(t[b]={}))[r])&&a[0]===x&&a[1]===o)return c[2]=a[2];if(u[r]=c,c[2]=e(t,n,s))return!0}}}function _e(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function ve(e,t,n,r,i){for(var o,s=[],a=0,u=e.length,c=null!=t;a<u;a++)(o=e[a])&&(n&&!n(o,r,i)||(s.push(o),c&&t.push(a)));return s}function be(e,t,n,r,i,o){return r&&!r[b]&&(r=be(r)),i&&!i[b]&&(i=be(i,o)),ae(function(o,s,a,u){var c,l,h,f=[],p=[],d=s.length,g=o||function(e,t,n){for(var r=0,i=t.length;r<i;r++)oe(e,t[r],n);return n}(t||"*",a.nodeType?[a]:a,[]),m=!e||!o&&t?g:ve(g,f,e,a,u),y=n?i||(o?e:d||r)?[]:s:m;if(n&&n(m,y,a,u),r)for(c=ve(y,p),r(c,[],a,u),l=c.length;l--;)(h=c[l])&&(y[p[l]]=!(m[p[l]]=h));if(o){if(i||e){if(i){for(c=[],l=y.length;l--;)(h=y[l])&&c.push(m[l]=h);i(null,y=[],c,u)}for(l=y.length;l--;)(h=y[l])&&(c=i?B(o,h):f[l])>-1&&(o[c]=!(s[c]=h))}}else y=ve(y===s?y.splice(d,y.length):y),i?i(null,s,y,u):F.apply(s,y)})}function we(e){for(var t,n,i,o=e.length,s=r.relative[e[0].type],a=s||r.relative[" "],u=s?1:0,l=ye(function(e){return e===t},a,!0),h=ye(function(e){return B(t,e)>-1},a,!0),f=[function(e,n,r){var i=!s&&(r||n!==c)||((t=n).nodeType?l(e,n,r):h(e,n,r));return t=null,i}];u<o;u++)if(n=r.relative[e[u].type])f=[ye(_e(f),n)];else{if((n=r.filter[e[u].type].apply(null,e[u].matches))[b]){for(i=++u;i<o&&!r.relative[e[i].type];i++);return be(u>1&&_e(f),u>1&&me(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace($,"$1"),n,u<i&&we(e.slice(u,i)),i<o&&we(e=e.slice(i)),i<o&&me(e))}f.push(n)}return _e(f)}return ge.prototype=r.filters=r.pseudos,r.setFilters=new ge,s=oe.tokenize=function(e,t){var n,i,o,s,a,u,c,l=S[e+" "];if(l)return t?0:l.slice(0);for(a=e,u=[],c=r.preFilter;a;){for(s in n&&!(i=H.exec(a))||(i&&(a=a.slice(i[0].length)||a),u.push(o=[])),n=!1,(i=G.exec(a))&&(n=i.shift(),o.push({value:n,type:i[0].replace($," ")}),a=a.slice(n.length)),r.filter)!(i=Q[s].exec(a))||c[s]&&!(i=c[s](i))||(n=i.shift(),o.push({value:n,type:s,matches:i}),a=a.slice(n.length));if(!n)break}return t?a.length:a?oe.error(e):S(e,u).slice(0)},a=oe.compile=function(e,t){var n,i=[],o=[],a=T[e+" "];if(!a){for(t||(t=s(e)),n=t.length;n--;)(a=we(t[n]))[b]?i.push(a):o.push(a);(a=T(e,function(e,t){var n=t.length>0,i=e.length>0,o=function(o,s,a,u,l){var h,f,d,g=0,m="0",y=o&&[],_=[],v=c,b=o||i&&r.find.TAG("*",l),w=x+=null==v?1:Math.random()||.1,C=b.length;for(l&&(c=s!==p&&s);m!==C&&null!=(h=b[m]);m++){if(i&&h){for(f=0;d=e[f++];)if(d(h,s,a)){u.push(h);break}l&&(x=w)}n&&((h=!d&&h)&&g--,o&&y.push(h))}if(g+=m,n&&m!==g){for(f=0;d=t[f++];)d(y,_,s,a);if(o){if(g>0)for(;m--;)y[m]||_[m]||(_[m]=O.call(u));_=ve(_)}F.apply(u,_),l&&!o&&_.length>0&&g+t.length>1&&oe.uniqueSort(u)}return l&&(x=w,c=v),y};return n?ae(o):o}(o,i))).selector=e}return a},u=oe.select=function(e,t,i,o){var u,c,l,h,f,p="function"==typeof e&&e,d=!o&&s(e=p.selector||e);if(i=i||[],1===d.length){if((c=d[0]=d[0].slice(0)).length>2&&"ID"===(l=c[0]).type&&n.getById&&9===t.nodeType&&g&&r.relative[c[1].type]){if(!(t=(r.find.ID(l.matches[0].replace(ne,re),t)||[])[0]))return i;p&&(t=t.parentNode),e=e.slice(c.shift().value.length)}for(u=Q.needsContext.test(e)?0:c.length;u--&&(l=c[u],!r.relative[h=l.type]);)if((f=r.find[h])&&(o=f(l.matches[0].replace(ne,re),ee.test(c[0].type)&&de(t.parentNode)||t))){if(c.splice(u,1),!(e=o.length&&me(c)))return F.apply(i,o),i;break}}return(p||a(e,d))(o,t,!g,i,ee.test(e)&&de(t.parentNode)||t),i},n.sortStable=b.split("").sort(A).join("")===b,n.detectDuplicates=!!h,f(),n.sortDetached=ue(function(e){return 1&e.compareDocumentPosition(p.createElement("div"))}),ue(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||ce("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ue(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||ce("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ue(function(e){return null==e.getAttribute("disabled")})||ce(I,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),oe}(n);g.find=w,g.expr=w.selectors,g.expr[":"]=g.expr.pseudos,g.unique=w.uniqueSort,g.text=w.getText,g.isXMLDoc=w.isXML,g.contains=w.contains;var x=g.expr.match.needsContext,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,E=/^.[^:#\[\.,]*$/;function S(e,t,n){if(g.isFunction(t))return g.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return g.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(E.test(t))return g.filter(t,e,n);t=g.filter(t,e)}return g.grep(e,function(e){return c.call(t,e)>=0!==n})}g.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?g.find.matchesSelector(r,e)?[r]:[]:g.find.matches(e,g.grep(t,function(e){return 1===e.nodeType}))},g.fn.extend({find:function(e){var t,n=this.length,r=[],i=this;if("string"!=typeof e)return this.pushStack(g(e).filter(function(){for(t=0;t<n;t++)if(g.contains(i[t],this))return!0}));for(t=0;t<n;t++)g.find(e,i[t],r);return(r=this.pushStack(n>1?g.unique(r):r)).selector=this.selector?this.selector+" "+e:e,r},filter:function(e){return this.pushStack(S(this,e||[],!1))},not:function(e){return this.pushStack(S(this,e||[],!0))},is:function(e){return!!S(this,"string"==typeof e&&x.test(e)?g(e):e||[],!1).length}});var T,A=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(g.fn.init=function(e,t){var n,r;if(!e)return this;if("string"==typeof e){if(!(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:A.exec(e))||!n[1]&&t)return!t||t.jquery?(t||T).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof g?t[0]:t,g.merge(this,g.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:d,!0)),C.test(n[1])&&g.isPlainObject(t))for(n in t)g.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return(r=d.getElementById(n[2]))&&r.parentNode&&(this.length=1,this[0]=r),this.context=d,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):g.isFunction(e)?void 0!==T.ready?T.ready(e):e(g):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),g.makeArray(e,this))}).prototype=g.fn,T=g(d);var M=/^(?:parents|prev(?:Until|All))/,k={children:!0,contents:!0,next:!0,prev:!0};function L(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}g.extend({dir:function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&g(e).is(n))break;r.push(e)}return r},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),g.fn.extend({has:function(e){var t=g(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(g.contains(this,t[e]))return!0})},closest:function(e,t){for(var n,r=0,i=this.length,o=[],s=x.test(e)||"string"!=typeof e?g(e,t||this.context):0;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&g.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?g.unique(o):o)},index:function(e){return e?"string"==typeof e?c.call(g(e),this[0]):c.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(g.unique(g.merge(this.get(),g(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),g.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return g.dir(e,"parentNode")},parentsUntil:function(e,t,n){return g.dir(e,"parentNode",n)},next:function(e){return L(e,"nextSibling")},prev:function(e){return L(e,"previousSibling")},nextAll:function(e){return g.dir(e,"nextSibling")},prevAll:function(e){return g.dir(e,"previousSibling")},nextUntil:function(e,t,n){return g.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return g.dir(e,"previousSibling",n)},siblings:function(e){return g.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return g.sibling(e.firstChild)},contents:function(e){return e.contentDocument||g.merge([],e.childNodes)}},function(e,t){g.fn[e]=function(n,r){var i=g.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=g.filter(r,i)),this.length>1&&(k[e]||g.unique(i),M.test(e)&&i.reverse()),this.pushStack(i)}});var O,R=/\S+/g,F={};function P(){d.removeEventListener("DOMContentLoaded",P,!1),n.removeEventListener("load",P,!1),g.ready()}g.Callbacks=function(e){var t,n,r,i,o,s,a=[],u=!(e="string"==typeof e?F[e]||function(e){var t=F[e]={};return g.each(e.match(R)||[],function(e,n){t[n]=!0}),t}(e):g.extend({},e)).once&&[],c=function(h){for(t=e.memory&&h,n=!0,s=i||0,i=0,o=a.length,r=!0;a&&s<o;s++)if(!1===a[s].apply(h[0],h[1])&&e.stopOnFalse){t=!1;break}r=!1,a&&(u?u.length&&c(u.shift()):t?a=[]:l.disable())},l={add:function(){if(a){var n=a.length;!function t(n){g.each(n,function(n,r){var i=g.type(r);"function"===i?e.unique&&l.has(r)||a.push(r):r&&r.length&&"string"!==i&&t(r)})}(arguments),r?o=a.length:t&&(i=n,c(t))}return this},remove:function(){return a&&g.each(arguments,function(e,t){for(var n;(n=g.inArray(t,a,n))>-1;)a.splice(n,1),r&&(n<=o&&o--,n<=s&&s--)}),this},has:function(e){return e?g.inArray(e,a)>-1:!(!a||!a.length)},empty:function(){return a=[],o=0,this},disable:function(){return a=u=t=void 0,this},disabled:function(){return!a},lock:function(){return u=void 0,t||l.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!a||n&&!u||(t=[e,(t=t||[]).slice?t.slice():t],r?u.push(t):c(t)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},g.extend({Deferred:function(e){var t=[["resolve","done",g.Callbacks("once memory"),"resolved"],["reject","fail",g.Callbacks("once memory"),"rejected"],["notify","progress",g.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return g.Deferred(function(n){g.each(t,function(t,o){var s=g.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&g.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o[0]+"With"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?g.extend(e,r):r}},i={};return r.pipe=r.then,g.each(t,function(e,o){var s=o[2],a=o[3];r[o[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=s.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t,n,r,i=0,o=s.call(arguments),a=o.length,u=1!==a||e&&g.isFunction(e.promise)?a:0,c=1===u?e:g.Deferred(),l=function(e,n,r){return function(i){n[e]=this,r[e]=arguments.length>1?s.call(arguments):i,r===t?c.notifyWith(n,r):--u||c.resolveWith(n,r)}};if(a>1)for(t=new Array(a),n=new Array(a),r=new Array(a);i<a;i++)o[i]&&g.isFunction(o[i].promise)?o[i].promise().done(l(i,r,o)).fail(c.reject).progress(l(i,n,t)):--u;return u||c.resolveWith(r,o),c.promise()}}),g.fn.ready=function(e){return g.ready.promise().done(e),this},g.extend({isReady:!1,readyWait:1,holdReady:function(e){e?g.readyWait++:g.ready(!0)},ready:function(e){(!0===e?--g.readyWait:g.isReady)||(g.isReady=!0,!0!==e&&--g.readyWait>0||(O.resolveWith(d,[g]),g.fn.triggerHandler&&(g(d).triggerHandler("ready"),g(d).off("ready"))))}}),g.ready.promise=function(e){return O||(O=g.Deferred(),"complete"===d.readyState?setTimeout(g.ready):(d.addEventListener("DOMContentLoaded",P,!1),n.addEventListener("load",P,!1))),O.promise(e)},g.ready.promise();var B=g.access=function(e,t,n,r,i,o,s){var a=0,u=e.length,c=null==n;if("object"===g.type(n))for(a in i=!0,n)g.access(e,t,a,n[a],!0,o,s);else if(void 0!==r&&(i=!0,g.isFunction(r)||(s=!0),c&&(s?(t.call(e,r),t=null):(c=t,t=function(e,t,n){return c.call(g(e),n)})),t))for(;a<u;a++)t(e[a],n,s?r:r.call(e[a],a,t(e[a],n)));return i?e:c?t.call(e):u?t(e[0],n):o};function I(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=g.expando+I.uid++}g.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},I.uid=1,I.accepts=g.acceptData,I.prototype={key:function(e){if(!I.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=I.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,g.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),o=this.cache[i];if("string"==typeof t)o[t]=n;else if(g.isEmptyObject(o))g.extend(this.cache[i],t);else for(r in t)o[r]=t[r];return o},get:function(e,t){var n=this.cache[this.key(e)];return void 0===t?n:n[t]},access:function(e,t,n){var r;return void 0===t||t&&"string"==typeof t&&void 0===n?void 0!==(r=this.get(e,t))?r:this.get(e,g.camelCase(t)):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r,i,o=this.key(e),s=this.cache[o];if(void 0===t)this.cache[o]={};else{g.isArray(t)?r=t.concat(t.map(g.camelCase)):(i=g.camelCase(t),r=t in s?[t,i]:(r=i)in s?[r]:r.match(R)||[]),n=r.length;for(;n--;)delete s[r[n]]}},hasData:function(e){return!g.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var N=new I,D=new I,j=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,q=/([A-Z])/g;function z(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(q,"-$1").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:j.test(n)?g.parseJSON(n):n)}catch(e){}D.set(e,t,n)}else n=void 0;return n}g.extend({hasData:function(e){return D.hasData(e)||N.hasData(e)},data:function(e,t,n){return D.access(e,t,n)},removeData:function(e,t){D.remove(e,t)},_data:function(e,t,n){return N.access(e,t,n)},_removeData:function(e,t){N.remove(e,t)}}),g.fn.extend({data:function(e,t){var n,r,i,o=this[0],s=o&&o.attributes;if(void 0===e){if(this.length&&(i=D.get(o),1===o.nodeType&&!N.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(r=s[n].name).indexOf("data-")&&(r=g.camelCase(r.slice(5)),z(o,r,i[r]));N.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each(function(){D.set(this,e)}):B(this,function(t){var n,r=g.camelCase(e);if(o&&void 0===t)return void 0!==(n=D.get(o,e))?n:void 0!==(n=D.get(o,r))?n:void 0!==(n=z(o,r,void 0))?n:void 0;this.each(function(){var n=D.get(this,r);D.set(this,r,t),-1!==e.indexOf("-")&&void 0!==n&&D.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){D.remove(this,e)})}}),g.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=N.get(e,t),n&&(!r||g.isArray(n)?r=N.access(e,t,g.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=g.queue(e,t),r=n.length,i=n.shift(),o=g._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){g.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return N.get(e,n)||N.access(e,n,{empty:g.Callbacks("once memory").add(function(){N.remove(e,[t+"queue",n])})})}}),g.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?g.queue(this[0],e):void 0===t?this:this.each(function(){var n=g.queue(this,e,t);g._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&g.dequeue(this,e)})},dequeue:function(e){return this.each(function(){g.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=g.Deferred(),o=this,s=this.length,a=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(n=N.get(o[s],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(t)}});var U=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,$=["Top","Right","Bottom","Left"],H=function(e,t){return e=t||e,"none"===g.css(e,"display")||!g.contains(e.ownerDocument,e)},G=/^(?:checkbox|radio)$/i;!function(){var e=d.createDocumentFragment().appendChild(d.createElement("div")),t=d.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),p.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",p.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();p.focusinBubbles="onfocusin"in n;var V=/^key/,W=/^(?:mouse|pointer|contextmenu)|click/,J=/^(?:focusinfocus|focusoutblur)$/,Q=/^([^.]*)(?:\.(.+)|)$/;function K(){return!0}function Z(){return!1}function Y(){try{return d.activeElement}catch(e){}}g.event={global:{},add:function(e,t,n,r,i){var o,s,a,u,c,l,h,f,p,d,m,y=N.get(e);if(y)for(n.handler&&(n=(o=n).handler,i=o.selector),n.guid||(n.guid=g.guid++),(u=y.events)||(u=y.events={}),(s=y.handle)||(s=y.handle=function(t){return void 0!==g&&g.event.triggered!==t.type?g.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(R)||[""]).length;c--;)p=m=(a=Q.exec(t[c])||[])[1],d=(a[2]||"").split(".").sort(),p&&(h=g.event.special[p]||{},p=(i?h.delegateType:h.bindType)||p,h=g.event.special[p]||{},l=g.extend({type:p,origType:m,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&g.expr.match.needsContext.test(i),namespace:d.join(".")},o),(f=u[p])||((f=u[p]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(e,r,d,s)||e.addEventListener&&e.addEventListener(p,s,!1)),h.add&&(h.add.call(e,l),l.handler.guid||(l.handler.guid=n.guid)),i?f.splice(f.delegateCount++,0,l):f.push(l),g.event.global[p]=!0)},remove:function(e,t,n,r,i){var o,s,a,u,c,l,h,f,p,d,m,y=N.hasData(e)&&N.get(e);if(y&&(u=y.events)){for(c=(t=(t||"").match(R)||[""]).length;c--;)if(p=m=(a=Q.exec(t[c])||[])[1],d=(a[2]||"").split(".").sort(),p){for(h=g.event.special[p]||{},f=u[p=(r?h.delegateType:h.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=f.length;o--;)l=f[o],!i&&m!==l.origType||n&&n.guid!==l.guid||a&&!a.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(f.splice(o,1),l.selector&&f.delegateCount--,h.remove&&h.remove.call(e,l));s&&!f.length&&(h.teardown&&!1!==h.teardown.call(e,d,y.handle)||g.removeEvent(e,p,y.handle),delete u[p])}else for(p in u)g.event.remove(e,p+t[c],n,r,!0);g.isEmptyObject(u)&&(delete y.handle,N.remove(e,"events"))}},trigger:function(e,t,r,i){var o,s,a,u,c,l,h,p=[r||d],m=f.call(e,"type")?e.type:e,y=f.call(e,"namespace")?e.namespace.split("."):[];if(s=a=r=r||d,3!==r.nodeType&&8!==r.nodeType&&!J.test(m+g.event.triggered)&&(m.indexOf(".")>=0&&(m=(y=m.split(".")).shift(),y.sort()),c=m.indexOf(":")<0&&"on"+m,(e=e[g.expando]?e:new g.Event(m,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=y.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),t=null==t?[e]:g.makeArray(t,[e]),h=g.event.special[m]||{},i||!h.trigger||!1!==h.trigger.apply(r,t))){if(!i&&!h.noBubble&&!g.isWindow(r)){for(u=h.delegateType||m,J.test(u+m)||(s=s.parentNode);s;s=s.parentNode)p.push(s),a=s;a===(r.ownerDocument||d)&&p.push(a.defaultView||a.parentWindow||n)}for(o=0;(s=p[o++])&&!e.isPropagationStopped();)e.type=o>1?u:h.bindType||m,(l=(N.get(s,"events")||{})[e.type]&&N.get(s,"handle"))&&l.apply(s,t),(l=c&&s[c])&&l.apply&&g.acceptData(s)&&(e.result=l.apply(s,t),!1===e.result&&e.preventDefault());return e.type=m,i||e.isDefaultPrevented()||h._default&&!1!==h._default.apply(p.pop(),t)||!g.acceptData(r)||c&&g.isFunction(r[m])&&!g.isWindow(r)&&((a=r[c])&&(r[c]=null),g.event.triggered=m,r[m](),g.event.triggered=void 0,a&&(r[c]=a)),e.result}},dispatch:function(e){e=g.event.fix(e);var t,n,r,i,o,a,u=s.call(arguments),c=(N.get(this,"events")||{})[e.type]||[],l=g.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,e)){for(a=g.event.handlers.call(this,e,c),t=0;(i=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(o.namespace)||(e.handleObj=o,e.data=o.data,void 0!==(r=((g.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,u))&&!1===(e.result=r)&&(e.preventDefault(),e.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,o,s=[],a=t.delegateCount,u=e.target;if(a&&u.nodeType&&(!e.button||"click"!==e.type))for(;u!==this;u=u.parentNode||this)if(!0!==u.disabled||"click"!==e.type){for(r=[],n=0;n<a;n++)void 0===r[i=(o=t[n]).selector+" "]&&(r[i]=o.needsContext?g(i,this).index(u)>=0:g.find(i,this,null,[u]).length),r[i]&&r.push(o);r.length&&s.push({elem:u,handlers:r})}return a<t.length&&s.push({elem:this,handlers:t.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,o=t.button;return null==e.pageX&&null!=t.clientX&&(r=(n=e.target.ownerDocument||d).documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[g.expando])return e;var t,n,r,i=e.type,o=e,s=this.fixHooks[i];for(s||(this.fixHooks[i]=s=W.test(i)?this.mouseHooks:V.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new g.Event(o),t=r.length;t--;)e[n=r[t]]=o[n];return e.target||(e.target=d),3===e.target.nodeType&&(e.target=e.target.parentNode),s.filter?s.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Y()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Y()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&g.nodeName(this,"input"))return this.click(),!1},_default:function(e){return g.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=g.extend(new g.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?g.event.trigger(i,null,t):g.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},g.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},g.Event=function(e,t){if(!(this instanceof g.Event))return new g.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?K:Z):this.type=e,t&&g.extend(this,t),this.timeStamp=e&&e.timeStamp||g.now(),this[g.expando]=!0},g.Event.prototype={isDefaultPrevented:Z,isPropagationStopped:Z,isImmediatePropagationStopped:Z,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=K,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=K,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=K,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},g.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){g.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=e.relatedTarget,i=e.handleObj;return r&&(r===this||g.contains(this,r))||(e.type=i.origType,n=i.handler.apply(this,arguments),e.type=t),n}}}),p.focusinBubbles||g.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){g.event.simulate(t,e.target,g.event.fix(e),!0)};g.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=N.access(r,t);i||r.addEventListener(e,n,!0),N.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=N.access(r,t)-1;i?N.access(r,t,i):(r.removeEventListener(e,n,!0),N.remove(r,t))}}}),g.fn.extend({on:function(e,t,n,r,i){var o,s;if("object"==typeof e){for(s in"string"!=typeof t&&(n=n||t,t=void 0),e)this.on(s,t,n,e[s],i);return this}if(null==n&&null==r?(r=t,n=t=void 0):null==r&&("string"==typeof t?(r=n,n=void 0):(r=n,n=t,t=void 0)),!1===r)r=Z;else if(!r)return this;return 1===i&&(o=r,(r=function(e){return g().off(e),o.apply(this,arguments)}).guid=o.guid||(o.guid=g.guid++)),this.each(function(){g.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,g(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Z),this.each(function(){g.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){g.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return g.event.trigger(e,t,n,!0)}});var X=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ee=/<([\w:]+)/,te=/<|&#?\w+;/,ne=/<(?:script|style|link)/i,re=/checked\s*(?:[^=]|=\s*.checked.)/i,ie=/^$|\/(?:java|ecma)script/i,oe=/^true\/(.*)/,se=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ae={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ue(e,t){return g.nodeName(e,"table")&&g.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ce(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function le(e){var t=oe.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function he(e,t){for(var n=0,r=e.length;n<r;n++)N.set(e[n],"globalEval",!t||N.get(t[n],"globalEval"))}function fe(e,t){var n,r,i,o,s,a,u,c;if(1===t.nodeType){if(N.hasData(e)&&(o=N.access(e),s=N.set(t,o),c=o.events))for(i in delete s.handle,s.events={},c)for(n=0,r=c[i].length;n<r;n++)g.event.add(t,i,c[i][n]);D.hasData(e)&&(a=D.access(e),u=g.extend({},a),D.set(t,u))}}function pe(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&g.nodeName(e,t)?g.merge([e],n):n}function de(e,t){var n=t.nodeName.toLowerCase();"input"===n&&G.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}ae.optgroup=ae.option,ae.tbody=ae.tfoot=ae.colgroup=ae.caption=ae.thead,ae.th=ae.td,g.extend({clone:function(e,t,n){var r,i,o,s,a=e.cloneNode(!0),u=g.contains(e.ownerDocument,e);if(!(p.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||g.isXMLDoc(e)))for(s=pe(a),r=0,i=(o=pe(e)).length;r<i;r++)de(o[r],s[r]);if(t)if(n)for(o=o||pe(e),s=s||pe(a),r=0,i=o.length;r<i;r++)fe(o[r],s[r]);else fe(e,a);return(s=pe(a,"script")).length>0&&he(s,!u&&pe(e,"script")),a},buildFragment:function(e,t,n,r){for(var i,o,s,a,u,c,l=t.createDocumentFragment(),h=[],f=0,p=e.length;f<p;f++)if((i=e[f])||0===i)if("object"===g.type(i))g.merge(h,i.nodeType?[i]:i);else if(te.test(i)){for(o=o||l.appendChild(t.createElement("div")),s=(ee.exec(i)||["",""])[1].toLowerCase(),a=ae[s]||ae._default,o.innerHTML=a[1]+i.replace(X,"<$1></$2>")+a[2],c=a[0];c--;)o=o.lastChild;g.merge(h,o.childNodes),(o=l.firstChild).textContent=""}else h.push(t.createTextNode(i));for(l.textContent="",f=0;i=h[f++];)if((!r||-1===g.inArray(i,r))&&(u=g.contains(i.ownerDocument,i),o=pe(l.appendChild(i),"script"),u&&he(o),n))for(c=0;i=o[c++];)ie.test(i.type||"")&&n.push(i);return l},cleanData:function(e){for(var t,n,r,i,o=g.event.special,s=0;void 0!==(n=e[s]);s++){if(g.acceptData(n)&&(i=n[N.expando])&&(t=N.cache[i])){if(t.events)for(r in t.events)o[r]?g.event.remove(n,r):g.removeEvent(n,r,t.handle);N.cache[i]&&delete N.cache[i]}delete D.cache[n[D.expando]]}}}),g.fn.extend({text:function(e){return B(this,function(e){return void 0===e?g.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||ue(this,e).appendChild(e)})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=ue(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,r=e?g.filter(e,this):this,i=0;null!=(n=r[i]);i++)t||1!==n.nodeType||g.cleanData(pe(n)),n.parentNode&&(t&&g.contains(n.ownerDocument,n)&&he(pe(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(g.cleanData(pe(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return g.clone(this,e,t)})},html:function(e){return B(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ne.test(e)&&!ae[(ee.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(X,"<$1></$2>");try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(g.cleanData(pe(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,g.cleanData(pe(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=a.apply([],e);var n,r,i,o,s,u,c=0,l=this.length,h=this,f=l-1,d=e[0],m=g.isFunction(d);if(m||l>1&&"string"==typeof d&&!p.checkClone&&re.test(d))return this.each(function(n){var r=h.eq(n);m&&(e[0]=d.call(this,n,r.html())),r.domManip(e,t)});if(l&&(r=(n=g.buildFragment(e,this[0].ownerDocument,!1,this)).firstChild,1===n.childNodes.length&&(n=r),r)){for(o=(i=g.map(pe(n,"script"),ce)).length;c<l;c++)s=n,c!==f&&(s=g.clone(s,!0,!0),o&&g.merge(i,pe(s,"script"))),t.call(this[c],s,c);if(o)for(u=i[i.length-1].ownerDocument,g.map(i,le),c=0;c<o;c++)s=i[c],ie.test(s.type||"")&&!N.access(s,"globalEval")&&g.contains(u,s)&&(s.src?g._evalUrl&&g._evalUrl(s.src):g.globalEval(s.textContent.replace(se,"")))}return this}}),g.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){g.fn[e]=function(e){for(var n,r=[],i=g(e),o=i.length-1,s=0;s<=o;s++)n=s===o?this:this.clone(!0),g(i[s])[t](n),u.apply(r,n.get());return this.pushStack(r)}});var ge,me={};function ye(e,t){var r,i=g(t.createElement(e)).appendTo(t.body),o=n.getDefaultComputedStyle&&(r=n.getDefaultComputedStyle(i[0]))?r.display:g.css(i[0],"display");return i.detach(),o}function _e(e){var t=d,n=me[e];return n||("none"!==(n=ye(e,t))&&n||((t=(ge=(ge||g("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentDocument).write(),t.close(),n=ye(e,t),ge.detach()),me[e]=n),n}var ve=/^margin/,be=new RegExp("^("+U+")(?!px)[a-z%]+$","i"),we=function(e){return e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):n.getComputedStyle(e,null)};function xe(e,t,n){var r,i,o,s,a=e.style;return(n=n||we(e))&&(s=n.getPropertyValue(t)||n[t]),n&&(""!==s||g.contains(e.ownerDocument,e)||(s=g.style(e,t)),be.test(s)&&ve.test(t)&&(r=a.width,i=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=r,a.minWidth=i,a.maxWidth=o)),void 0!==s?s+"":s}function Ce(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){var e,t,r=d.documentElement,i=d.createElement("div"),o=d.createElement("div");function s(){o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",o.innerHTML="",r.appendChild(i);var s=n.getComputedStyle(o,null);e="1%"!==s.top,t="4px"===s.width,r.removeChild(i)}o.style&&(o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",p.clearCloneStyle="content-box"===o.style.backgroundClip,i.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",i.appendChild(o),n.getComputedStyle&&g.extend(p,{pixelPosition:function(){return s(),e},boxSizingReliable:function(){return null==t&&s(),t},reliableMarginRight:function(){var e,t=o.appendChild(d.createElement("div"));return t.style.cssText=o.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",t.style.marginRight=t.style.width="0",o.style.width="1px",r.appendChild(i),e=!parseFloat(n.getComputedStyle(t,null).marginRight),r.removeChild(i),o.removeChild(t),e}}))}(),g.swap=function(e,t,n,r){var i,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];for(o in i=n.apply(e,r||[]),t)e.style[o]=s[o];return i};var Ee=/^(none|table(?!-c[ea]).+)/,Se=new RegExp("^("+U+")(.*)$","i"),Te=new RegExp("^([+-])=("+U+")","i"),Ae={position:"absolute",visibility:"hidden",display:"block"},Me={letterSpacing:"0",fontWeight:"400"},ke=["Webkit","O","Moz","ms"];function Le(e,t){if(t in e)return t;for(var n=t[0].toUpperCase()+t.slice(1),r=t,i=ke.length;i--;)if((t=ke[i]+n)in e)return t;return r}function Oe(e,t,n){var r=Se.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Re(e,t,n,r,i){for(var o=n===(r?"border":"content")?4:"width"===t?1:0,s=0;o<4;o+=2)"margin"===n&&(s+=g.css(e,n+$[o],!0,i)),r?("content"===n&&(s-=g.css(e,"padding"+$[o],!0,i)),"margin"!==n&&(s-=g.css(e,"border"+$[o]+"Width",!0,i))):(s+=g.css(e,"padding"+$[o],!0,i),"padding"!==n&&(s+=g.css(e,"border"+$[o]+"Width",!0,i)));return s}function Fe(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=we(e),s="border-box"===g.css(e,"boxSizing",!1,o);if(i<=0||null==i){if(((i=xe(e,t,o))<0||null==i)&&(i=e.style[t]),be.test(i))return i;r=s&&(p.boxSizingReliable()||i===e.style[t]),i=parseFloat(i)||0}return i+Re(e,t,n||(s?"border":"content"),r,o)+"px"}function Pe(e,t){for(var n,r,i,o=[],s=0,a=e.length;s<a;s++)(r=e[s]).style&&(o[s]=N.get(r,"olddisplay"),n=r.style.display,t?(o[s]||"none"!==n||(r.style.display=""),""===r.style.display&&H(r)&&(o[s]=N.access(r,"olddisplay",_e(r.nodeName)))):(i=H(r),"none"===n&&i||N.set(r,"olddisplay",i?n:g.css(r,"display"))));for(s=0;s<a;s++)(r=e[s]).style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[s]||"":"none"));return e}function Be(e,t,n,r,i){return new Be.prototype.init(e,t,n,r,i)}g.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=xe(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=g.camelCase(t),u=e.style;if(t=g.cssProps[a]||(g.cssProps[a]=Le(u,a)),s=g.cssHooks[t]||g.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(i=s.get(e,!1,r))?i:u[t];"string"===(o=typeof n)&&(i=Te.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(g.css(e,t)),o="number"),null!=n&&n==n&&("number"!==o||g.cssNumber[a]||(n+="px"),p.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,r))||(u[t]=n))}},css:function(e,t,n,r){var i,o,s,a=g.camelCase(t);return t=g.cssProps[a]||(g.cssProps[a]=Le(e.style,a)),(s=g.cssHooks[t]||g.cssHooks[a])&&"get"in s&&(i=s.get(e,!0,n)),void 0===i&&(i=xe(e,t,r)),"normal"===i&&t in Me&&(i=Me[t]),""===n||n?(o=parseFloat(i),!0===n||g.isNumeric(o)?o||0:i):i}}),g.each(["height","width"],function(e,t){g.cssHooks[t]={get:function(e,n,r){if(n)return Ee.test(g.css(e,"display"))&&0===e.offsetWidth?g.swap(e,Ae,function(){return Fe(e,t,r)}):Fe(e,t,r)},set:function(e,n,r){var i=r&&we(e);return Oe(0,n,r?Re(e,t,r,"border-box"===g.css(e,"boxSizing",!1,i),i):0)}}}),g.cssHooks.marginRight=Ce(p.reliableMarginRight,function(e,t){if(t)return g.swap(e,{display:"inline-block"},xe,[e,"marginRight"])}),g.each({margin:"",padding:"",border:"Width"},function(e,t){g.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+$[r]+t]=o[r]||o[r-2]||o[0];return i}},ve.test(e)||(g.cssHooks[e+t].set=Oe)}),g.fn.extend({css:function(e,t){return B(this,function(e,t,n){var r,i,o={},s=0;if(g.isArray(t)){for(r=we(e),i=t.length;s<i;s++)o[t[s]]=g.css(e,t[s],!1,r);return o}return void 0!==n?g.style(e,t,n):g.css(e,t)},e,t,arguments.length>1)},show:function(){return Pe(this,!0)},hide:function(){return Pe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){H(this)?g(this).show():g(this).hide()})}}),g.Tween=Be,Be.prototype={constructor:Be,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(g.cssNumber[n]?"":"px")},cur:function(){var e=Be.propHooks[this.prop];return e&&e.get?e.get(this):Be.propHooks._default.get(this)},run:function(e){var t,n=Be.propHooks[this.prop];return this.options.duration?this.pos=t=g.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Be.propHooks._default.set(this),this}},Be.prototype.init.prototype=Be.prototype,Be.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=g.css(e.elem,e.prop,""))&&"auto"!==t?t:0:e.elem[e.prop]},set:function(e){g.fx.step[e.prop]?g.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[g.cssProps[e.prop]]||g.cssHooks[e.prop])?g.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Be.propHooks.scrollTop=Be.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},g.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},g.fx=Be.prototype.init,g.fx.step={};var Ie,Ne,De=/^(?:toggle|show|hide)$/,je=new RegExp("^(?:([+-])=|)("+U+")([a-z%]*)$","i"),qe=/queueHooks$/,ze=[function(e,t,n){var r,i,o,s,a,u,c,l=this,h={},f=e.style,p=e.nodeType&&H(e),d=N.get(e,"fxshow");n.queue||(null==(a=g._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,u=a.empty.fire,a.empty.fire=function(){a.unqueued||u()}),a.unqueued++,l.always(function(){l.always(function(){a.unqueued--,g.queue(e,"fx").length||a.empty.fire()})}));1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],c=g.css(e,"display"),"inline"===("none"===c?N.get(e,"olddisplay")||_e(e.nodeName):c)&&"none"===g.css(e,"float")&&(f.display="inline-block"));n.overflow&&(f.overflow="hidden",l.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],De.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(p?"hide":"show")){if("show"!==i||!d||void 0===d[r])continue;p=!0}h[r]=d&&d[r]||g.style(e,r)}else c=void 0;if(g.isEmptyObject(h))"inline"===("none"===c?_e(e.nodeName):c)&&(f.display=c);else for(r in d?"hidden"in d&&(p=d.hidden):d=N.access(e,"fxshow",{}),o&&(d.hidden=!p),p?g(e).show():l.done(function(){g(e).hide()}),l.done(function(){var t;for(t in N.remove(e,"fxshow"),h)g.style(e,t,h[t])}),h)s=Ge(p?d[r]:0,r,l),r in d||(d[r]=s.start,p&&(s.end=s.start,s.start="width"===r||"height"===r?1:0))}],Ue={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=je.exec(t),o=i&&i[3]||(g.cssNumber[e]?"":"px"),s=(g.cssNumber[e]||"px"!==o&&+r)&&je.exec(g.css(n.elem,e)),a=1,u=20;if(s&&s[3]!==o){o=o||s[3],i=i||[],s=+r||1;do{s/=a=a||".5",g.style(n.elem,e,s+o)}while(a!==(a=n.cur()/r)&&1!==a&&--u)}return i&&(s=n.start=+s||+r||0,n.unit=o,n.end=i[1]?s+(i[1]+1)*i[2]:+i[2]),n}]};function $e(){return setTimeout(function(){Ie=void 0}),Ie=g.now()}function He(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=$[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function Ge(e,t,n){for(var r,i=(Ue[t]||[]).concat(Ue["*"]),o=0,s=i.length;o<s;o++)if(r=i[o].call(n,t,e))return r}function Ve(e,t,n){var r,i,o=0,s=ze.length,a=g.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var t=Ie||$e(),n=Math.max(0,c.startTime+c.duration-t),r=1-(n/c.duration||0),o=0,s=c.tweens.length;o<s;o++)c.tweens[o].run(r);return a.notifyWith(e,[c,r,n]),r<1&&s?n:(a.resolveWith(e,[c]),!1)},c=a.promise({elem:e,props:g.extend({},t),opts:g.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Ie||$e(),duration:n.duration,tweens:[],createTween:function(t,n){var r=g.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(r),r},stop:function(t){var n=0,r=t?c.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)c.tweens[n].run(1);return t?a.resolveWith(e,[c,t]):a.rejectWith(e,[c,t]),this}}),l=c.props;for(!function(e,t){var n,r,i,o,s;for(n in e)if(i=t[r=g.camelCase(n)],o=e[n],g.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(s=g.cssHooks[r])&&"expand"in s)for(n in o=s.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(l,c.opts.specialEasing);o<s;o++)if(r=ze[o].call(c,e,l,c.opts))return r;return g.map(l,Ge,c),g.isFunction(c.opts.start)&&c.opts.start.call(e,c),g.fx.timer(g.extend(u,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}g.Animation=g.extend(Ve,{tweener:function(e,t){g.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,r=0,i=e.length;r<i;r++)n=e[r],Ue[n]=Ue[n]||[],Ue[n].unshift(t)},prefilter:function(e,t){t?ze.unshift(e):ze.push(e)}}),g.speed=function(e,t,n){var r=e&&"object"==typeof e?g.extend({},e):{complete:n||!n&&t||g.isFunction(e)&&e,duration:e,easing:n&&t||t&&!g.isFunction(t)&&t};return r.duration=g.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in g.fx.speeds?g.fx.speeds[r.duration]:g.fx.speeds._default,null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){g.isFunction(r.old)&&r.old.call(this),r.queue&&g.dequeue(this,r.queue)},r},g.fn.extend({fadeTo:function(e,t,n,r){return this.filter(H).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=g.isEmptyObject(e),o=g.speed(t,n,r),s=function(){var t=Ve(this,g.extend({},e),o);(i||N.get(this,"finish"))&&t.stop(!0)};return s.finish=s,i||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=g.timers,s=N.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&qe.test(i)&&r(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||g.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=N.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=g.timers,s=r?r.length:0;for(n.finish=!0,g.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<s;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),g.each(["toggle","show","hide"],function(e,t){var n=g.fn[t];g.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(He(t,!0),e,r,i)}}),g.each({slideDown:He("show"),slideUp:He("hide"),slideToggle:He("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){g.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),g.timers=[],g.fx.tick=function(){var e,t=0,n=g.timers;for(Ie=g.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||g.fx.stop(),Ie=void 0},g.fx.timer=function(e){g.timers.push(e),e()?g.fx.start():g.timers.pop()},g.fx.interval=13,g.fx.start=function(){Ne||(Ne=setInterval(g.fx.tick,g.fx.interval))},g.fx.stop=function(){clearInterval(Ne),Ne=null},g.fx.speeds={slow:600,fast:200,_default:400},g.fn.delay=function(e,t){return e=g.fx&&g.fx.speeds[e]||e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},function(){var e=d.createElement("input"),t=d.createElement("select"),n=t.appendChild(d.createElement("option"));e.type="checkbox",p.checkOn=""!==e.value,p.optSelected=n.selected,t.disabled=!0,p.optDisabled=!n.disabled,(e=d.createElement("input")).value="t",e.type="radio",p.radioValue="t"===e.value}();var We,Je=g.expr.attrHandle;g.fn.extend({attr:function(e,t){return B(this,g.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){g.removeAttr(this,e)})}}),g.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?g.prop(e,t,n):(1===o&&g.isXMLDoc(e)||(t=t.toLowerCase(),r=g.attrHooks[t]||(g.expr.match.bool.test(t)?We:void 0)),void 0===n?r&&"get"in r&&null!==(i=r.get(e,t))?i:null==(i=g.find.attr(e,t))?void 0:i:null!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:(e.setAttribute(t,n+""),n):void g.removeAttr(e,t))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(R);if(o&&1===e.nodeType)for(;n=o[i++];)r=g.propFix[n]||n,g.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!p.radioValue&&"radio"===t&&g.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),We={set:function(e,t,n){return!1===t?g.removeAttr(e,n):e.setAttribute(n,n),n}},g.each(g.expr.match.bool.source.match(/\w+/g),function(e,t){var n=Je[t]||g.find.attr;Je[t]=function(e,t,r){var i,o;return r||(o=Je[t],Je[t]=i,i=null!=n(e,t,r)?t.toLowerCase():null,Je[t]=o),i}});var Qe=/^(?:input|select|textarea|button)$/i;g.fn.extend({prop:function(e,t){return B(this,g.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[g.propFix[e]||e]})}}),g.extend({propFix:{for:"htmlFor",class:"className"},prop:function(e,t,n){var r,i,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return(1!==o||!g.isXMLDoc(e))&&(t=g.propFix[t]||t,i=g.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||Qe.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),p.optSelected||(g.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),g.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){g.propFix[this.toLowerCase()]=this});var Ke=/[\t\r\n\f]/g;g.fn.extend({addClass:function(e){var t,n,r,i,o,s,a="string"==typeof e&&e,u=0,c=this.length;if(g.isFunction(e))return this.each(function(t){g(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(R)||[];u<c;u++)if(r=1===(n=this[u]).nodeType&&(n.className?(" "+n.className+" ").replace(Ke," "):" ")){for(o=0;i=t[o++];)r.indexOf(" "+i+" ")<0&&(r+=i+" ");s=g.trim(r),n.className!==s&&(n.className=s)}return this},removeClass:function(e){var t,n,r,i,o,s,a=0===arguments.length||"string"==typeof e&&e,u=0,c=this.length;if(g.isFunction(e))return this.each(function(t){g(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(R)||[];u<c;u++)if(r=1===(n=this[u]).nodeType&&(n.className?(" "+n.className+" ").replace(Ke," "):"")){for(o=0;i=t[o++];)for(;r.indexOf(" "+i+" ")>=0;)r=r.replace(" "+i+" "," ");s=e?g.trim(r):"",n.className!==s&&(n.className=s)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):g.isFunction(e)?this.each(function(n){g(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n)for(var t,r=0,i=g(this),o=e.match(R)||[];t=o[r++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else"undefined"!==n&&"boolean"!==n||(this.className&&N.set(this,"__className__",this.className),this.className=this.className||!1===e?"":N.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,r=this.length;n<r;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(Ke," ").indexOf(t)>=0)return!0;return!1}});var Ze=/\r/g;g.fn.extend({val:function(e){var t,n,r,i=this[0];return arguments.length?(r=g.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,g(this).val()):e)?i="":"number"==typeof i?i+="":g.isArray(i)&&(i=g.map(i,function(e){return null==e?"":e+""})),(t=g.valHooks[this.type]||g.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))})):i?(t=g.valHooks[i.type]||g.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(Ze,""):null==n?"":n:void 0}}),g.extend({valHooks:{option:{get:function(e){var t=g.find.attr(e,"value");return null!=t?t:g.trim(g.text(e))}},select:{get:function(e){for(var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||i<0,s=o?null:[],a=o?i+1:r.length,u=i<0?a:o?i:0;u<a;u++)if(((n=r[u]).selected||u===i)&&(p.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!g.nodeName(n.parentNode,"optgroup"))){if(t=g(n).val(),o)return t;s.push(t)}return s},set:function(e,t){for(var n,r,i=e.options,o=g.makeArray(t),s=i.length;s--;)((r=i[s]).selected=g.inArray(r.value,o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),g.each(["radio","checkbox"],function(){g.valHooks[this]={set:function(e,t){if(g.isArray(t))return e.checked=g.inArray(g(e).val(),t)>=0}},p.checkOn||(g.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),g.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){g.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),g.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Ye=g.now(),Xe=/\?/;g.parseJSON=function(e){return JSON.parse(e+"")},g.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||g.error("Invalid XML: "+e),t};var et=/#.*$/,tt=/([?&])_=[^&]*/,nt=/^(.*?):[ \t]*([^\r\n]*)$/gm,rt=/^(?:GET|HEAD)$/,it=/^\/\//,ot=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,st={},at={},ut="*/".concat("*"),ct=n.location.href,lt=ot.exec(ct.toLowerCase())||[];function ht(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(R)||[];if(g.isFunction(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function ft(e,t,n,r){var i={},o=e===at;function s(a){var u;return i[a]=!0,g.each(e[a]||[],function(e,a){var c=a(t,n,r);return"string"!=typeof c||o||i[c]?o?!(u=c):void 0:(t.dataTypes.unshift(c),s(c),!1)}),u}return s(t.dataTypes[0])||!i["*"]&&s("*")}function pt(e,t){var n,r,i=g.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&g.extend(!0,e,r),e}g.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ct,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(lt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ut,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":g.parseJSON,"text xml":g.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?pt(pt(e,g.ajaxSettings),t):pt(g.ajaxSettings,e)},ajaxPrefilter:ht(st),ajaxTransport:ht(at),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,r,i,o,s,a,u,c,l=g.ajaxSetup({},t),h=l.context||l,f=l.context&&(h.nodeType||h.jquery)?g(h):g.event,p=g.Deferred(),d=g.Callbacks("once memory"),m=l.statusCode||{},y={},_={},v=0,b="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(2===v){if(!o)for(o={};t=nt.exec(i);)o[t[1].toLowerCase()]=t[2];t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===v?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return v||(e=_[n]=_[n]||e,y[e]=t),this},overrideMimeType:function(e){return v||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(v<2)for(t in e)m[t]=[m[t],e[t]];else w.always(e[w.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),x(0,t),this}};if(p.promise(w).complete=d.add,w.success=w.done,w.error=w.fail,l.url=((e||l.url||ct)+"").replace(et,"").replace(it,lt[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=g.trim(l.dataType||"*").toLowerCase().match(R)||[""],null==l.crossDomain&&(a=ot.exec(l.url.toLowerCase()),l.crossDomain=!(!a||a[1]===lt[1]&&a[2]===lt[2]&&(a[3]||("http:"===a[1]?"80":"443"))===(lt[3]||("http:"===lt[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=g.param(l.data,l.traditional)),ft(st,l,t,w),2===v)return w;for(c in(u=g.event&&l.global)&&0==g.active++&&g.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!rt.test(l.type),r=l.url,l.hasContent||(l.data&&(r=l.url+=(Xe.test(r)?"&":"?")+l.data,delete l.data),!1===l.cache&&(l.url=tt.test(r)?r.replace(tt,"$1_="+Ye++):r+(Xe.test(r)?"&":"?")+"_="+Ye++)),l.ifModified&&(g.lastModified[r]&&w.setRequestHeader("If-Modified-Since",g.lastModified[r]),g.etag[r]&&w.setRequestHeader("If-None-Match",g.etag[r])),(l.data&&l.hasContent&&!1!==l.contentType||t.contentType)&&w.setRequestHeader("Content-Type",l.contentType),w.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+ut+"; q=0.01":""):l.accepts["*"]),l.headers)w.setRequestHeader(c,l.headers[c]);if(l.beforeSend&&(!1===l.beforeSend.call(h,w,l)||2===v))return w.abort();for(c in b="abort",{success:1,error:1,complete:1})w[c](l[c]);if(n=ft(at,l,t,w)){w.readyState=1,u&&f.trigger("ajaxSend",[w,l]),l.async&&l.timeout>0&&(s=setTimeout(function(){w.abort("timeout")},l.timeout));try{v=1,n.send(y,x)}catch(e){if(!(v<2))throw e;x(-1,e)}}else x(-1,"No Transport");function x(e,t,o,a){var c,y,_,b,x,C=t;2!==v&&(v=2,s&&clearTimeout(s),n=void 0,i=a||"",w.readyState=e>0?4:0,c=e>=200&&e<300||304===e,o&&(b=function(e,t,n){for(var r,i,o,s,a=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}s||(s=i)}o=o||s}if(o)return o!==u[0]&&u.unshift(o),n[o]}(l,w,o)),b=function(e,t,n,r){var i,o,s,a,u,c={},l=e.dataTypes.slice();if(l[1])for(s in e.converters)c[s.toLowerCase()]=e.converters[s];for(o=l.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=l.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(s=c[u+" "+o]||c["* "+o]))for(i in c)if((a=i.split(" "))[1]===o&&(s=c[u+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[i]:!0!==c[i]&&(o=a[0],l.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(l,b,w,c),c?(l.ifModified&&((x=w.getResponseHeader("Last-Modified"))&&(g.lastModified[r]=x),(x=w.getResponseHeader("etag"))&&(g.etag[r]=x)),204===e||"HEAD"===l.type?C="nocontent":304===e?C="notmodified":(C=b.state,y=b.data,c=!(_=b.error))):(_=C,!e&&C||(C="error",e<0&&(e=0))),w.status=e,w.statusText=(t||C)+"",c?p.resolveWith(h,[y,C,w]):p.rejectWith(h,[w,C,_]),w.statusCode(m),m=void 0,u&&f.trigger(c?"ajaxSuccess":"ajaxError",[w,l,c?y:_]),d.fireWith(h,[w,C]),u&&(f.trigger("ajaxComplete",[w,l]),--g.active||g.event.trigger("ajaxStop")))}return w},getJSON:function(e,t,n){return g.get(e,t,n,"json")},getScript:function(e,t){return g.get(e,void 0,t,"script")}}),g.each(["get","post"],function(e,t){g[t]=function(e,n,r,i){return g.isFunction(n)&&(i=i||r,r=n,n=void 0),g.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),g._evalUrl=function(e){return g.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},g.fn.extend({wrapAll:function(e){var t;return g.isFunction(e)?this.each(function(t){g(this).wrapAll(e.call(this,t))}):(this[0]&&(t=g(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return g.isFunction(e)?this.each(function(t){g(this).wrapInner(e.call(this,t))}):this.each(function(){var t=g(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=g.isFunction(e);return this.each(function(n){g(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){g.nodeName(this,"body")||g(this).replaceWith(this.childNodes)}).end()}}),g.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},g.expr.filters.visible=function(e){return!g.expr.filters.hidden(e)};var dt=/%20/g,gt=/\[\]$/,mt=/\r?\n/g,yt=/^(?:submit|button|image|reset|file)$/i,_t=/^(?:input|select|textarea|keygen)/i;function vt(e,t,n,r){var i;if(g.isArray(t))g.each(t,function(t,i){n||gt.test(e)?r(e,i):vt(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==g.type(t))r(e,t);else for(i in t)vt(e+"["+i+"]",t[i],n,r)}g.param=function(e,t){var n,r=[],i=function(e,t){t=g.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=g.ajaxSettings&&g.ajaxSettings.traditional),g.isArray(e)||e.jquery&&!g.isPlainObject(e))g.each(e,function(){i(this.name,this.value)});else for(n in e)vt(n,e[n],t,i);return r.join("&").replace(dt,"+")},g.fn.extend({serialize:function(){return g.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=g.prop(this,"elements");return e?g.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!g(this).is(":disabled")&&_t.test(this.nodeName)&&!yt.test(e)&&(this.checked||!G.test(e))}).map(function(e,t){var n=g(this).val();return null==n?null:g.isArray(n)?g.map(n,function(e){return{name:t.name,value:e.replace(mt,"\r\n")}}):{name:t.name,value:n.replace(mt,"\r\n")}}).get()}}),g.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var bt=0,wt={},xt={0:200,1223:204},Ct=g.ajaxSettings.xhr();n.attachEvent&&n.attachEvent("onunload",function(){for(var e in wt)wt[e]()}),p.cors=!!Ct&&"withCredentials"in Ct,p.ajax=Ct=!!Ct,g.ajaxTransport(function(e){var t;if(p.cors||Ct&&!e.crossDomain)return{send:function(n,r){var i,o=e.xhr(),s=++bt;if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)o[i]=e.xhrFields[i];for(i in e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)o.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete wt[s],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?r(o.status,o.statusText):r(xt[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:void 0,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=wt[s]=t("abort");try{o.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}}),g.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return g.globalEval(e),e}}}),g.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),g.ajaxTransport("script",function(e){var t,n;if(e.crossDomain)return{send:function(r,i){t=g("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),d.head.appendChild(t[0])},abort:function(){n&&n()}}});var Et=[],St=/(=)\?(?=&|$)|\?\?/;g.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Et.pop()||g.expando+"_"+Ye++;return this[e]=!0,e}}),g.ajaxPrefilter("json jsonp",function(e,t,r){var i,o,s,a=!1!==e.jsonp&&(St.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&St.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=g.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(St,"$1"+i):!1!==e.jsonp&&(e.url+=(Xe.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return s||g.error(i+" was not called"),s[0]},e.dataTypes[0]="json",o=n[i],n[i]=function(){s=arguments},r.always(function(){n[i]=o,e[i]&&(e.jsonpCallback=t.jsonpCallback,Et.push(i)),s&&g.isFunction(o)&&o(s[0]),s=o=void 0}),"script"}),g.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||d;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=g.buildFragment([e],t,i),i&&i.length&&g(i).remove(),g.merge([],r.childNodes))};var Tt=g.fn.load;g.fn.load=function(e,t,n){if("string"!=typeof e&&Tt)return Tt.apply(this,arguments);var r,i,o,s=this,a=e.indexOf(" ");return a>=0&&(r=g.trim(e.slice(a)),e=e.slice(0,a)),g.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),s.length>0&&g.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){o=arguments,s.html(r?g("<div>").append(g.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){s.each(n,o||[e.responseText,t,e])}),this},g.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){g.fn[t]=function(e){return this.on(t,e)}}),g.expr.filters.animated=function(e){return g.grep(g.timers,function(t){return e===t.elem}).length};var At=n.document.documentElement;function Mt(e){return g.isWindow(e)?e:9===e.nodeType&&e.defaultView}g.offset={setOffset:function(e,t,n){var r,i,o,s,a,u,c=g.css(e,"position"),l=g(e),h={};"static"===c&&(e.style.position="relative"),a=l.offset(),o=g.css(e,"top"),u=g.css(e,"left"),("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1?(s=(r=l.position()).top,i=r.left):(s=parseFloat(o)||0,i=parseFloat(u)||0),g.isFunction(t)&&(t=t.call(e,n,a)),null!=t.top&&(h.top=t.top-a.top+s),null!=t.left&&(h.left=t.left-a.left+i),"using"in t?t.using.call(e,h):l.css(h)}},g.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){g.offset.setOffset(this,e,t)});var t,n,r=this[0],i={top:0,left:0},o=r&&r.ownerDocument;return o?(t=o.documentElement,g.contains(t,r)?(void 0!==r.getBoundingClientRect&&(i=r.getBoundingClientRect()),n=Mt(o),{top:i.top+n.pageYOffset-t.clientTop,left:i.left+n.pageXOffset-t.clientLeft}):i):void 0},position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===g.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),g.nodeName(e[0],"html")||(r=e.offset()),r.top+=g.css(e[0],"borderTopWidth",!0),r.left+=g.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-g.css(n,"marginTop",!0),left:t.left-r.left-g.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||At;e&&!g.nodeName(e,"html")&&"static"===g.css(e,"position");)e=e.offsetParent;return e||At})}}),g.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var r="pageYOffset"===t;g.fn[e]=function(i){return B(this,function(e,i,o){var s=Mt(e);if(void 0===o)return s?s[t]:e[i];s?s.scrollTo(r?n.pageXOffset:o,r?o:n.pageYOffset):e[i]=o},e,i,arguments.length,null)}}),g.each(["top","left"],function(e,t){g.cssHooks[t]=Ce(p.pixelPosition,function(e,n){if(n)return n=xe(e,t),be.test(n)?g(e).position()[t]+"px":n})}),g.each({Height:"height",Width:"width"},function(e,t){g.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){g.fn[r]=function(r,i){var o=arguments.length&&(n||"boolean"!=typeof r),s=n||(!0===r||!0===i?"margin":"border");return B(this,function(t,n,r){var i;return g.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):void 0===r?g.css(t,n,s):g.style(t,n,r,s)},t,o?r:void 0,o,null)}})}),g.fn.size=function(){return this.length},g.fn.andSelf=g.fn.addBack,void 0===(r=function(){return g}.apply(t,[]))||(e.exports=r);var kt=n.jQuery,Lt=n.$;return g.noConflict=function(e){return n.$===g&&(n.$=Lt),e&&n.jQuery===g&&(n.jQuery=kt),g},void 0===i&&(n.jQuery=n.$=g),g})},function(e,t,n){"use strict";var r=n(0),i=n(2);e.exports=i.extend({initialize:function(e){this._bounds={},e&&(this._mapAdapter=e,this.setBounds(this._mapAdapter.getBounds()),this._initBinds())},_initBinds:function(){this.listenTo(this._mapAdapter,"boundsChanged",r.debounce(this._boundsChanged,350))},_stopBinds:function(){this._mapAdapter&&this.stopListening(this._mapAdapter,"boundsChanged")},_boundsChanged:function(e){this.setBounds(e)},setBounds:function(e){this._bounds=e,this.trigger("boundsChanged",e)},getBounds:function(){return this._bounds},areBoundsAvailable:function(){return r.isFinite(this._bounds.west)},serialize:function(){return[this._bounds.west,this._bounds.south,this._bounds.east,this._bounds.north].join(",")},clean:function(){this._stopBinds()}})},function(e,t,n){"use strict";var r=n(1);e.exports=function(e,t,n){var i=arguments[1];return this._xhr&&this._xhr.abort(),this._xhr=r.sync.apply(this,arguments),this._xhr.always(function(){i._xhr=null}),this._xhr}},function(e,t,n){"use strict";var r=n(0),i=n(2),o=n(19),s=n(9),a=n(7),u=n(25),c=["engine"];e.exports=i.extend({defaults:{url:"",data:[],sync_on_bbox_change:!0,sync_on_circle_change:!0,sync_on_polygon_change:!0,enabled:!0,status:"unfetched"},url:function(){var e=r.union([this._getSpatialFilterParam()],this._getDataviewSpecificURLParams());this._addAuthTo(e);var t=this.get("url")+"?"+e.join("&");if(t.length>2083)throw new Error("URL length is longer than allowed (2083 chars). Check your filters (eg. if using a Polygon filter, reduce the number of vertices).");return t},_addAuthTo:function(e){if(this._engine.getApiKey())e.push("api_key="+this._engine.getApiKey());else if(this._engine.getAuthToken()){var t=this._engine.getAuthToken();t instanceof Array?r.each(t,function(t){e.push("auth_token[]="+t)}):e.push("auth_token="+t)}},_getSpatialFilterParam:function(){return this._bboxFilter?this._getBoundingBoxFilterParam():this._circleFilter?this._getCircleFilterParam():this._polygonFilter?this._getPolygonFilterParam():void 0},_getBoundingBoxFilterParam:function(){var e="";return this._checkBBoxFilter(),this.syncsOnBoundingBoxChanges()&&(e="bbox="+this._bboxFilter.serialize()),e},_getCircleFilterParam:function(){var e="";return this._checkCircleFilter(),this.syncsOnCircleChanges()&&(e="circle="+this._circleFilter.serialize()),e},_getPolygonFilterParam:function(){var e="";return this._checkPolygonFilter(),this.syncsOnPolygonChanges()&&(e="polygon="+this._polygonFilter.serialize()),e},_getDataviewSpecificURLParams:function(){return[]},initialize:function(e,t){if(e=e||{},t=t||{},a.checkRequiredOpts(t,c,"DataviewModelBase"),this._hasBinds=!1,this._engine=t.engine,!e.source)throw new Error("source is a required attr");this._checkSourceAttribute(this.getSource()),this.getSource().markAsSourceOf(this),e.id||this.set("id",this.defaults.type+"-"+this.cid),this.sync=o.bind(this),this.filter=t.filter,this.filter&&this.filter.set("dataviewId",this.id),this._addSpatialFilterFrom(t),this._initBinds()},_addSpatialFilterFrom:function(e){e.bboxFilter&&this.addBBoxFilter(e.bboxFilter),e.circleFilter&&this.addCircleFilter(e.circleFilter),e.polygonFilter&&this.addPolygonFilter(e.polygonFilter)},_initBinds:function(){this.listenToOnce(this,"change:url",function(){this._checkBBoxFilter(),this.syncsOnBoundingBoxChanges()&&!this._bboxFilter.areBoundsAvailable()?this.listenTo(this._bboxFilter,"boundsChanged",this._fetch):this._fetch()}),this.filter&&this.listenTo(this.filter,"change",this._onFilterChanged),this.getSource().on("change:status",this._onAnalysisStatusChange,this)},_onChangeBinds:function(){this.on("change:sync_on_bbox_change",function(){this.refresh()},this),this.on("change:url",function(e,t,n){this._newDataAvailable=!0,this._shouldFetchOnURLChange(n&&r.pick(n,["forceFetch","sourceId"]))&&this.refresh()},this),this.on("change:enabled",function(e,t){t&&this._newDataAvailable&&(this.refresh(),this._newDataAvailable=!1)},this)},_onMapBoundsChanged:function(){this._shouldFetchOnBoundingBoxChange()&&this._fetch(),this.syncsOnBoundingBoxChanges()&&(this._newDataAvailable=!0)},_onCircleChanged:function(){this._shouldFetchOnCircleChange()&&this._fetch(),this.syncsOnCircleChanges()&&(this._newDataAvailable=!0)},_onPolygonChanged:function(){this._shouldFetchOnPolygonChange()&&this._fetch(),this.syncsOnPolygonChanges()&&(this._newDataAvailable=!0)},_fetch:function(){this.fetch({success:function(){this._hasBinds||(this._hasBinds=!0,this._onChangeBinds())}.bind(this)})},_onAnalysisStatusChange:function(e,t){e.isLoading()?this._triggerLoading():e.isFailed()&&this._triggerStatusError(e.get("error"))},_triggerLoading:function(){this.trigger("loading",this)},_triggerStatusError:function(e){this.trigger("statusError",this,e)},_onFilterChanged:function(e){this._reload({sourceId:this.getSourceId()})},_reloadAndForceFetch:function(){this._reload({sourceId:this.getSourceId(),forceFetch:!0})},_reload:function(e){e=e||{},this._engine.reload(e)},_shouldFetchOnURLChange:function(e){var t=(e=e||{}).sourceId;return!!e.forceFetch||this.isEnabled()&&this._sourceAffectsMyOwnSource(t)},_sourceAffectsMyOwnSource:function(e){if(!e)return!0;var t=this.getSource();return t&&t.findAnalysisById(e)},_shouldFetchOnBoundingBoxChange:function(){return this.isEnabled()&&this.syncsOnBoundingBoxChanges()},_shouldFetchOnCircleChange:function(){return this.isEnabled()&&this.syncsOnCircleChanges()},_shouldFetchOnPolygonChange:function(){return this.isEnabled()&&this.syncsOnPolygonChanges()},refresh:function(){this.fetch()},addBBoxFilter:function(e){e&&(this._stopListeningBBoxChanges(),this._bboxFilter=e,this._listenToBBoxChanges())},removeBBoxFilter:function(){this._stopListeningBBoxChanges(),this._bboxFilter=null},addCircleFilter:function(e){e&&(this._stopListeningCircleChanges(),this._circleFilter=e,this._listenToCircleChanges())},removeCircleFilter:function(){this._stopListeningCircleChanges(),this._circleFilter=null},addPolygonFilter:function(e){e&&(this._stopListeningPolygonChanges(),this._polygonFilter=e,this._listenToPolygonChanges())},removePolygonFilter:function(){this._stopListeningPolygonChanges(),this._polygonFilter=null},update:function(e){if(r.has(e,"source"))throw new Error("Source of dataviews cannot be updated");e=r.pick(e,this.constructor.ATTRS_NAMES),this.set(e)},getData:function(){return this.get("data")},getPreviousData:function(){return this.previous("data")},fetch:function(e){if(e=e||{},this.set("status","fetching"),this._triggerLoading(),e.success)var t=e&&e.success;return i.prototype.fetch.call(this,r.extend(e,{success:function(){this.set("status","fetched"),t&&t(arguments),this.trigger("loaded",this)}.bind(this),error:function(e,t){if(!t||t&&"abort"!==t.statusText){this.set("status","error"),this._errorWithBigPolygonFilter(e)&&(t.statusText="error in the dataview request. Check the Polygon filter size (reduce the number of vertices and retry).");var n=this._parseError(t);this._triggerStatusError(n)}}.bind(this)}))},_errorWithBigPolygonFilter:function(e){return!!(e&&e.attributes&&e.attributes.sync_on_polygon_change&&this.url().length>2083)},toJSON:function(){throw new Error("toJSON should be defined for each dataview")},getSourceType:function(){return this.getSource().get("type")},getSourceId:function(){var e=this.getSource();return e&&e.id},getSource:function(){return this.get("source")},isSourceType:function(){return"source"===this.getSourceType()},isFiltered:function(){var e=!1;return this.filter&&(e=!this.filter.isEmpty()),e},remove:function(){this._removeExistingAnalysisBindings(),this.getSource().unmarkAsSourceOf(this),this.trigger("destroy",this),this.stopListening()},_removeExistingAnalysisBindings:function(){this.getSource().off("change:status",this._onAnalysisStatusChange,this)},isFetched:function(){return"fetched"===this.get("status")},isUnavailable:function(){return"error"===this.get("status")},isEnabled:function(){return this.get("enabled")},setUnavailable:function(){return this.set("status","error")},syncsOnBoundingBoxChanges:function(){return this.get("sync_on_bbox_change")},syncsOnCircleChanges:function(){return this.get("sync_on_circle_change")},syncsOnPolygonChanges:function(){return this.get("sync_on_polygon_change")},_checkSourceAttribute:function(e){if(!(e instanceof s))throw new Error("Source must be an instance of AnalysisModel")},_checkBBoxFilter:function(){if(this.syncsOnBoundingBoxChanges()&&!this._bboxFilter)throw new Error("Cannot sync on bounding box changes. There is no bounding box filter.")},_checkCircleFilter:function(){if(this.syncsOnCircleChanges()&&!this._circleFilter)throw new Error("Cannot sync on circle filter changes. There is no circle filter.")},_checkPolygonFilter:function(){if(this.syncsOnPolygonChanges()&&!this._polygonFilter)throw new Error("Cannot sync on polygon filter changes. There is no polygon filter.")},_listenToBBoxChanges:function(){this._bboxFilter&&this.listenTo(this._bboxFilter,"boundsChanged",this._onMapBoundsChanged)},_stopListeningBBoxChanges:function(){this._bboxFilter&&this.stopListening(this._bboxFilter,"boundsChanged")},_listenToCircleChanges:function(){this._circleFilter&&this.listenTo(this._circleFilter,"circleChanged",this._onCircleChanged)},_stopListeningCircleChanges:function(){this._circleFilter&&this.stopListening(this._circleFilter,"circleChanged")},_listenToPolygonChanges:function(){this._polygonFilter&&this.listenTo(this._polygonFilter,"polygonChanged",this._onPolygonChanged)},_stopListeningPolygonChanges:function(){this._polygonFilter&&this.stopListening(this._polygonFilter,"polygonChanged")},_parseError:function(e){var t={},n=u(e,"dataview");return n.length>0&&(t=n[0]),t}},{ATTRS_NAMES:["id","sync_on_bbox_change","sync_on_circle_change","sync_on_polygon_change","enabled","source"]})},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=n(0),o=n(6),s=n(11),a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._initialize(e),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o),r(t,[{key:"_initialize",value:function(e){var t=this;this._filters=[],e&&e.length&&e.map(function(e){return t.addFilter(e)})}},{key:"addFilter",value:function(e){var n=this;if(!(e instanceof s||e instanceof t))throw this._getValidationError("wrongFilterType");i.contains(this._filters,e)||(this.listenTo(e,"change:filters",function(e){return n._triggerFilterChange(e)}),this._filters.push(e),this._triggerFilterChange())}},{key:"removeFilter",value:function(e){var t=i.indexOf(this._filters,e);if(-1!==t){var n=this._filters.splice(t,1)[0];return n.off("change:filters",null,this),this._triggerFilterChange(),n}}},{key:"count",value:function(){return this._filters.length}},{key:"getFilters",value:function(){return this._filters}},{key:"$getSQL",value:function(){var e=this._filters.map(function(e){return e.$getSQL()}).filter(function(e){return Boolean(e)}),t=e.join(" "+(this.JOIN_OPERATOR||"AND")+" ");return e.length>1?"("+t+")":t}},{key:"_triggerFilterChange",value:function(e){this.trigger("change:filters",e)}}]),t}();e.exports=a},function(e,t,n){"use strict";var r=n(0),i=n(13),o=i.extend({defaults:function(){return r.extend(i.prototype.defaults.apply(this),{state:i.STATE_SUCCESS})},_onEngineReloadStarted:function(){},isAvailable:function(){return!0}});e.exports=o},function(e,t,n){"use strict";var r=n(109),i=n(91),o=n(90);e.exports={Aggregation:o,Layer:r,events:i}},function(e,t,n){"use strict";e.exports={OVERLAY_TYPES:{ATTRIBUTION:"attribution",HEADER:"header",LIMITS:"limits",TILES:"tiles",LOADER:"loader",LOGO:"logo",SEARCH:"search",ZOOM:"zoom"},MAP_PROVIDER_TYPES:{GMAPS:"googlemaps",LEAFLET:"leaflet"},GMAPS_BASE_LAYER_TYPES:["roadmap","gray_roadmap","dark_roadmap","hybrid","satellite","terrain"],WINDSHAFT_ERRORS:{ANALYSIS:"analysis",LAYER:"layer",LIMIT:"limit",TILE:"tile",GENERIC:"generic",UNKNOWN:"unknown"}}},function(e,t,n){"use strict";var r=n(0),i=n(41);e.exports=function(e,t){if((e=e||{}).responseJSON&&(e=e.responseJSON),e.errors_with_context)return r.map(e.errors_with_context,function(e){return new i(e,t)});if(e.errors){var n="string"==typeof e.errors[0]?{message:e.errors[0]}:e.errors[0];return[new i(n,t)]}return e.statusText?[new i({message:e.statusText},t,"ajax")]:[]}},function(e){e.exports={name:"internal-carto.js",version:"4.2.1",description:"CARTO javascript library",repository:{type:"git",url:"git://github.com/CartoDB/carto.js.git"},author:{name:"CARTO",url:"https://carto.com/"},contributors:["Javier lvarez <jmedina@carto.com>","Javier lvarez <xabel@vizzuality.com>","Javier Arce <javierarce@carto.com>","Javier Santana <jsantana@carto.com>","Raul Ochoa <rochoa@carto.com>","Carlos Matalln <matallo@carto.com>","Jaime Chapinal <jaime.chapinal@carto.com>","Nicklas Gummesson <nicklas@carto.com>","Francisco Dans <francisco@carto.com>","Emilio Garca <emilio@carto.com>","Ivan Malagon <ivan@carto.com>","Ruben Moya <ruben@carto.com>","Jesus Arroyo Torrens <jarroyo@carto.com>","Iago Lastra <iago@carto.com>","Elena Torr <elena@carto.com>","Jess Botella <jbotella@carto.com>","Alejandra Arri <alejandraarri@carto.com>"],private:!0,license:"BSD-3-Clause",dependencies:{"@carto/zera":"1.0.7",backbone:"1.2.3","backbone-poller":"^1.1.3","camshaft-reference":"0.34.0",carto:"github:cartodb/carto#master","clip-path-polygon":"0.1.12","d3-array":"1.2.1","d3-format":"1.2.0","d3-time-format":"2.1.0",jquery:"2.1.4",mustache:"1.1.0","perfect-scrollbar":"git://github.com/CartoDB/perfect-scrollbar.git#master",postcss:"5.0.19","promise-polyfill":"^6.1.0","torque.js":"github:CartoDB/torque#master",underscore:"1.8.3","whatwg-fetch":"^2.0.3"},devDependencies:{"babel-core":"^6.26.3","babel-loader":"^7.1.4","babel-plugin-transform-object-rest-spread":"^6.26.0","babel-preset-env":"^1.7.0","babel-preset-es2015":"~6.24.1",babelify:"^7.3.0",browserify:"13.0.0","browserify-shim":"3.8.12",cartoassets:"github:CartoDB/CartoAssets#master",eslint:"~4.18.2","eslint-config-semistandard":"~11.0.0","eslint-config-standard":"~10.2.1","eslint-plugin-import":"~2.7.0","eslint-plugin-node":"~5.2.0","eslint-plugin-promise":"~3.5.0","eslint-plugin-standard":"~3.0.1","findup-sync":"0.1.3",grunt:"0.4.5","grunt-aws":"^0.4.0","grunt-banner":"^0.6.0","grunt-browserify":"5.0.0","grunt-contrib-clean":"~0.5.0","grunt-contrib-concat":"~0.3.0","grunt-contrib-connect":"~0.11.2","grunt-contrib-copy":"~0.7.0","grunt-contrib-cssmin":"~0.7.0","grunt-contrib-imagemin":"~1.0.0","grunt-contrib-jasmine":"1.1.0","grunt-contrib-watch":"git://github.com/gruntjs/grunt-contrib-watch.git#b884948805940c663b1cbb91a3c28ba8afdebf78","grunt-eslint":"~20.1.0","grunt-exorcise":"2.1.0","grunt-fastly":"~0.1.3","grunt-gitinfo":"^0.1.9","grunt-prompt":"~1.3.0","grunt-replace":"0.6.2","grunt-sass":"2.0.0","grunt-terser":"^1.0.0",gulp:"3.8.10","gulp-iconfont":"1.0.0","gulp-iconfont-css":"0.0.9","gulp-install":"0.2.0","gulp-sketch":"0.0.7","jasmine-ajax":"git://github.com/nobuti/jasmine-ajax.git#master",jsdoc:"~3.5.5",jstify:"0.12.0",leaflet:"1.3.1","load-grunt-tasks":"~0.6.0","npm-watch":"^0.3.0",semver:"~5.4.0","source-map-support":"github:CartoDB/node-source-map-support#0.4.6-cdb1","time-grunt":"~0.3.1","uglifyjs-webpack-plugin":"^1.1.2",watchify:"3.4.0",webpack:"4.12.1","webpack-cli":"^3.3.12"},browserify:{transform:["browserify-shim","jstify"]},browser:{cdb:"./src/cdb.js","cdb.config":"./src/cdb.config.js","cdb.core.util":"./src/core/util.js","cdb.core.Profiler":"./src/core/profiler.js","cdb.log":"./src/cdb.log.js","cdb.errors":"./src/cdb.errors.js","cdb.templates":"./src/cdb.templates.js",geojson:"./vendor/GeoJSON.js","html-css-sanitizer":"./vendor/html-css-sanitizer-bundle.js",mousewheel:"./vendor/mousewheel.js",mwheelIntent:"./vendor/mwheelIntent.js"},"browserify-shim":{geojson:"GeoJSON","html-css-sanitizer":"html",mousewheel:{depends:["jquery:jQuery"]},mwheelIntent:{depends:["jquery:jQuery"]}},files:["dist","node_modules/cdb","src","themes","vendor"],main:"src/index.js",config:{root:"."},scripts:{test:"grunt test","test:browser":"grunt dev",lint:"eslint .","lint:fix":"eslint . --fix",build:"rm -rf dist/public; NODE_ENV=production webpack --progress --config webpack/webpack.config.js && NODE_ENV=production webpack --progress --config webpack/webpack.min.config.js","build:watch":"NODE_ENV=development webpack --progress -w --config webpack/webpack.config.js","build:internal":"grunt build",docs:"rm -rf docs/public; jsdoc --configure config/jsdoc/public-conf.json","docs:internal":"rm -rf docs/internal; jsdoc --configure config/jsdoc/internal-conf.json",bump:"npm version prerelease","bump:patch":"npm version patch","bump:minor":"npm version minor",postversion:"git push origin HEAD --follow-tags",release:"./scripts/release.sh"},watch:{docs:"src/**/*.js"}}},function(e,t,n){"use strict";var r=n(122);e.exports={error:function(){console.error.apply(console,arguments)},log:function(){console.log.apply(console,arguments)},info:function(){console.log.apply(console,arguments)},debug:function(){r.DEBUG&&console.log.apply(console,arguments)}}},function(e,t,n){"use strict";var r="node",i={source:[]},o={},s=n(133).getVersion("latest").analyses;if(!s)throw new Error("Error loading the reference for Camshaft analyses");for(var a in s){var u=s[a].params;for(var c in u){o[a]=o[a]||[],o[a].push(c),i[a]=i[a]||[],u[c].type===r&&i[a].push(c)}}e.exports={getSourceNamesForAnalysisType:function(e){var t=i[e];if(!t)throw new Error("source names for analysis of type "+e+" couldn't be found");return t},getParamNamesForAnalysisType:function(e){var t=o[e];if(!t)throw new Error("param names for analysis of type "+e+" couldn't be found");return t}}},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(9),s=n(28),a=n(16),u=function(e){if(!(e=e||{}).engine)throw new Error("engine is required");this._engine=e.engine,this._apiKey=e.apiKey,this._authToken=e.authToken,this._camshaftReference=e.camshaftReference||s,this._analysisNodes=new i.Collection};u.prototype.analyse=function(e){e=r.clone(e);var t=this.findNodeById(e.id),n=this._getAnalysisAttributesFromAnalysisDefinition(e);return t?t.set(n):(this._apiKey&&(n.apiKey=this._apiKey),this._authToken&&(n.authToken=this._authToken),t=new o(n,{camshaftReference:this._camshaftReference,engine:this._engine}),this._analysisNodes.add(t),t.bind("destroy",this._onAnalysisRemoved,this)),t},u.prototype._getAnalysisAttributesFromAnalysisDefinition=function(e){var t={},n=e.type,i=this._camshaftReference.getSourceNamesForAnalysisType(n);return r.each(i,function(n){var r=e.params[n];r&&(t[n]=this.analyse(r))},this),r.omit(r.extend(e,e.params,t),"params")},u.prototype.createAnalysisForLayer=function(e,t){return this.analyse({id:e,type:"source",params:{query:t}})},u.prototype.findNodeById=function(e){return this._analysisNodes.get(e)},u.prototype._onAnalysisRemoved=function(e){this._analysisNodes.remove(e),e.unbind("destroy",this._onAnalysisRemoved)},u.getUniqueAnalysisNodes=function(e,t){var n={},i=u.getAnalysisList(e,t);return r.each(i,function(e){e.getNodesCollection().each(function(e){n[e.get("id")]=e})}),r.map(n,function(e){return e},this)},u.getAnalysisList=function(e,t){var n=function(e){var t=function(e){return e.filter(function(e){return a.isCartoDBLayer(e)||a.isTorqueLayer(e)})}(e);return r.chain(t).map(function(e){return e.getSource()}).compact().value()}(e),i=function(e){return e.chain().map(function(e){return e.getSource()}).compact().value()}(t);return n.concat(i)},e.exports=u},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var r=n(0),i={second:{unit:"second",factor:1},minute:{unit:"minute",factor:1},hour:{unit:"hour",factor:1},day:{unit:"day",factor:1},week:{unit:"day",factor:7},month:{unit:"month",factor:1},quarter:{unit:"month",factor:3},year:{unit:"month",factor:12},decade:{unit:"month",factor:120},century:{unit:"month",factor:1200},millennium:{unit:"month",factor:12e3}},o={};o.fillTimestampBuckets=function(e,t,n,i,o,s){for(var a=[],u=!1,c=0;c<i;c++){u=void 0!==e[c],a.push(u);var l=this.add(t,c,n),h=this.add(t,c+1,n);e[c]=r.extend({bin:c,start:l,end:h-1,next:h,freq:0},e[c]),delete e[c].timestamp}return"totals"===o?e:function(e,t,n){for(var i=null,o=!0,s=t.length-1;s>=0&&o&&(!r.isFinite(n)||s>=n);s--)t[s]?o=!1:i=s;return null!==i?e.slice(0,i):e}(e,a,s)},o.fillNumericBuckets=function(e,t,n,i){for(var o=0;o<i;o++){var s=t+o*n,a=t+(o+1)*n,u=o+1===i&&e[o]?e[o].max:a,c=r.extend({},{bin:o,start:s,end:u,freq:0},e[o]);e[o]=c}},o.hasChangedSomeOf=function(e,t){return r.some(r.keys(t),function(t){return r.contains(e,t)})},o.add=function(e,t,n){if(!i.hasOwnProperty(n))throw Error('aggregation "'+n+'" is not defined');var r=new Date(1e3*e),o=i[n].unit,s=t*i[n].factor;switch(o){case"second":return r.setUTCSeconds(r.getUTCSeconds()+s)/1e3;case"minute":return r.setUTCMinutes(r.getUTCMinutes()+s)/1e3;case"hour":return r.setUTCHours(r.getUTCHours()+s)/1e3;case"day":return r.setUTCDate(r.getUTCDate()+s)/1e3;case"month":var a=r.getUTCDate();return r.setUTCDate(1),r.setUTCMonth(r.getUTCMonth()+s),r.setUTCDate(Math.min(a,function(e,t){return[31,function(e){return e%4==0&&e%100!=0||e%400==0}(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]}(r.getUTCFullYear(),r.getUTCMonth()))),r.getTime()/1e3;default:return 0}},e.exports=o},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(45),s=n(20),a=n(64),u=n(31),c=n(63);e.exports=s.extend({defaults:r.extend({type:"histogram",totalAmount:0,filteredAmount:0,hasNulls:!1,localTimezone:!1},s.prototype.defaults),_getDataviewSpecificURLParams:function(){var e=[];if(r.isNumber(this.get("own_filter")))e.push("own_filter="+this.get("own_filter")),"number"===this.get("column_type")&&this.get("bins")&&e.push("bins="+this.get("bins"));else{var t=this.getCurrentOffset();"number"===this.get("column_type")&&this.get("bins")?e.push("bins="+this.get("bins")):"date"===this.get("column_type")&&(e.push("aggregation="+(this.get("aggregation")||"auto")),r.isFinite(t)&&e.push("offset="+t));var n=this.get("start"),i=this.get("end");r.isFinite(n)&&r.isFinite(i)&&(e.push("start="+n),e.push("end="+i))}return e},initialize:function(e,t){this._localOffset=c.getLocalOffset(),this._totals=new a({bins:this.get("bins"),aggregation:this.get("aggregation"),offset:this.get("offset"),column_type:this.get("column_type"),apiKey:t&&t.engine&&t.engine.getApiKey(),authToken:t&&t.engine&&t.engine.getAuthToken(),localTimezone:this.get("localTimezone"),localOffset:this._localOffset,start:this.get("start"),end:this.get("end")}),s.prototype.initialize.apply(this,arguments),this._data=new i.Collection(this.get("data")),e&&(e.min||e.max)&&this.filter&&this.filter.setRange(this.get("min"),this.get("max"))},_initBinds:function(){s.prototype._initBinds.apply(this),this._updateURLBinding(),this._totals.bind("loadModelCompleted",this._onTotalsDataFetched,this),this._totals.once("loadModelCompleted",this._updateBindings,this),this._totals.bind("error",this.setUnavailable,this),this._totals.bind("error",this._onTotalsError,this),this.on("change:column",this._onColumnChanged,this),this.on("change:localTimezone",this._onLocalTimezoneChanged,this),this.on("change",this._onFieldsChanged,this),this.on("change:column_type",this._onColumnTypeChanged,this)},_onLocalTimezoneChanged:function(){this._totals.set("localTimezone",this.get("localTimezone"))},_updateURLBinding:function(){this.off("change:url"),this.on("change:url",this._onUrlChanged,this)},_updateBindings:function(){this._onChangeBinds(),this._updateURLBinding()},enableFilter:function(){this.set("own_filter",1)},disableFilter:function(){this.unset("own_filter")},getData:function(){return this._data.toJSON()},getUnfilteredData:function(){return this._totals.get("data")},getUnfilteredDataModel:function(){return this._totals},getSize:function(){return this._data.size()},getColumnType:function(){return this.get("column_type")},hasNulls:function(){return this.get("hasNulls")},parse:function(e){var t=e.aggregation||this._totals&&this._totals.get("aggregation"),n=r.isFinite(e.bins_count)?e.bins_count:this.get("bins"),i=e.bin_width,o="date"===this.get("column_type")?e.timestamp_start:e.bins_start,s={data:[],filteredAmount:0,nulls:0,totalAmount:0};return this.has("error")?s:(s.data=new Array(n),r.each(e.bins,function(e){s.data[e.bin]=e}),this.set({aggregation:t},{silent:!0}),"date"===this.get("column_type")?(s.data=u.fillTimestampBuckets(s.data,o,t,n,"filtered",this._totals.get("data").length),n=s.data.length):u.fillNumericBuckets(s.data,o,i,n),this._data&&this._data.reset(s.data),s.totalAmount=this._calculateTotalAmount(s.data),s.filteredAmount=this._calculateFilteredAmount(this.filter,this._data),s.nulls=e.nulls,s.bins=n,null!=e.nulls&&(s=r.extend({},s,{nulls:e.nulls,hasNulls:!0})),s)},_onFilterChanged:function(e){this.set("filteredAmount",this._calculateFilteredAmount(e,this._data)),s.prototype._onFilterChanged.apply(this,arguments)},_onColumnChanged:function(){this._totals.set({column_type:this.get("column_type"),column:this.get("column"),start:null,end:null}),this.set("aggregation",void 0,{silent:!0}),this._reloadAndForceFetch()},_calculateTotalAmount:function(e){return r.reduce(e,function(e,t){return e+(t&&t.freq?t.freq:0)},0)},_calculateFilteredAmount:function(e,t){var n=0;if(e&&void 0!==e.get("min")&&void 0!==e.get("max")){var r=this._findBinsIndexes(t,e.get("min"),e.get("max"));n=this._sumBinsFreq(t,r.start,r.end)}return n},_findBinsIndexes:function(e,t,n){var r=e.findWhere({start:Math.min(t,n)}),i=e.findWhere({end:Math.max(t,n)});return{start:r&&r.get("bin"),end:i&&i.get("bin")}},_sumBinsFreq:function(e,t,n){return r.reduce(e.slice(t,n+1),function(e,t){return(t.get("freq")||0)+e},0)},getDistributionType:function(e){var t=e||this.get("data"),n=function(e){return e.freq};if(o.max(t,n)-o.min(t,n)<.1*o.mean(t,n))return"F";var i=o.sum(t,n),s=t.map(function(e){return 100*e.freq/i}),a=s.map(function(e,t){var n=s[t+1];return e>n?-1:Math.abs(e-n)<=.05?0:1});a.pop();var u=o.max(a),c=o.min(a);if(0===c&&0===u)return"F";if(u<1)return"L";if(c>-1)return"J";var l=r.uniq(a);return[[1,-1],[1,0,-1],[1,-1,0],[0,1,-1]].some(function(e){return r.isEqual(e,l)})?"A":[[-1,1],[-1,0,1],[-1,1,0],[0,-1,1]].some(function(e){return r.isEqual(e,l)})?"U":"S"},toJSON:function(e){var t=this.get("column_type"),n=this.get("offset"),i={column:this.get("column")};return"number"===t&&this.get("bins")?i.bins=this.get("bins"):"date"===t&&(i.aggregation=this.get("aggregation")||"auto",r.isFinite(n)&&(i.offset=n)),{type:"histogram",source:{id:this.getSourceId()},options:i}},_onColumnTypeChanged:function(){this.filter&&this.filter.set("column_type",this.get("column_type"))},_onChangeBinds:function(){s.prototype._onChangeBinds.call(this)},_onUrlChanged:function(){this._totals.set({offset:this.get("offset"),bins:this.get("bins")},{silent:!0}),this._totals.setUrl(this.get("url"))},_onTotalsDataFetched:function(e,t){var n=t.get("start"),i=t.get("end");r.isFinite(n)&&r.isFinite(i)&&this.set({start:n,end:i}),this.set({aggregation:t.get("aggregation")||"auto",offset:t.get("offset")||0,bins:t.get("bins"),error:t.get("error")},{silent:!0});var o=!1;"date"===this.get("column_type")&&(r.has(this.changed,"aggregation")||r.has(this.changed,"offset"))?o=!0:"number"===this.get("column_type")&&r.has(this.changed,"bins")&&(o=!0),o?this._resetFilterAndFetch():this.fetch()},_onFieldsChanged:function(){if(this._setTotalsStartEnd(),u.hasChangedSomeOf(["bins","aggregation","offset"],this.changed)){var e=r.has(this.changed,"aggregation")&&r.isUndefined(this.changed.aggregation);"number"!==this.get("column_type")||e||this._totals.set("bins",this.get("bins")),"date"===this.get("column_type")&&(this.hasChanged("aggregation")&&this._resetFilter(),this._totals.set({offset:this.get("offset"),aggregation:this.get("aggregation")}))}},_setTotalsStartEnd:function(){var e=this.get("start"),t=this.get("end"),n=u.hasChangedSomeOf(["start","end"],this.changed),i=r.isFinite(e)&&r.isFinite(t),o=this._totals.get("start")!==e||this._totals.get("end")!==t;n&&i&&o&&(this._totals.set({start:e,end:t}),this._totals.refresh())},_resetFilterAndFetch:function(){this._resetFilter(),this.fetch()},_resetFilter:function(){this.disableFilter(),this.filter&&this.filter.unsetRange()},_onTotalsError:function(e,t){var n=t&&this._parseError(t);n&&"abort"!==n.message&&this._triggerStatusError(n)},getCurrentOffset:function(){return this.get("localTimezone")?this._localOffset:this.get("offset")}},{ATTRS_NAMES:s.ATTRS_NAMES.concat(["column","column_type","bins","min","max","aggregation","offset"])})},function(e,t,n){"use strict";var r=n(1),i=n(0),o=n(73);e.exports=r.Collection.extend({model:o,initialize:function(e,t){this.aggregationModel=t.aggregationModel,this.aggregation=t.aggregationModel.get("aggregation")},reset:function(e,t){"count"!==this.aggregationModel.get("aggregation")&&(e=i.filter(e,function(e){return null!=(e instanceof r.Model?e.get("value"):e.value)})),r.Collection.prototype.reset.call(this,e,t)},comparator:function(e,t){return"Other"===e.get("name")?1:"Other"===t.get("name")?-1:e.get("value")===t.get("value")?e.get("selected")<t.get("selected")?1:-1:e.get("value")<t.get("value")?1:-1},isOtherAvailable:function(){return this.where({agg:!0,name:"Other"}).length>0}})},function(e,t,n){!function(t,n){e.exports=n()}(0,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=n(1),o=n(4),s=n(5),a=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&this._bindMap(t),this._tileLoader=new s(n),this._tileSize=256,this._eventEmitter=new o}return r(e,[{key:"tilejson",value:function(e){return this._tileLoader.setUrl(e.grids[0]),this}},{key:"map",value:function(e){return this._bindMap(e),this}},{key:"_bindMap",value:function(e){this._map=new i(e),this._map.on("click",this._onMapClick.bind(this)),this._map.on("mousemove",this._onMapMouseMove.bind(this))}},{key:"on",value:function(e,t){switch(e){case"on":this._eventEmitter.addEventListener("mousemove",t),this._eventEmitter.addEventListener("click",t);break;case"off":this._eventEmitter.addEventListener("featureout",t);break;case"error":this._eventEmitter.addEventListener("error",t)}return this}},{key:"_onMapClick",value:function(e){var t=this,n=this._map.cloneEvent(e),r=this._getTileCoordsFromMouseEvent(n);this._tileLoader.loadTile(r.z,r.x,r.y).then(function(e){if("fetching"!==e)return t._objectForEvent(e,n,"click")}).catch(function(e){t._eventEmitter.dispatchEvent("error",e)})}},{key:"_onMapMouseMove",value:function(e){var t=this,n=this._map.cloneEvent(e),r=this._getTileCoordsFromMouseEvent(n);this._tileLoader.loadTile(r.z,r.x,r.y).then(function(e){if("fetching"!==e)return t._objectForEvent(e,n,"mousemove")}).catch(function(e){t._eventEmitter.dispatchEvent("error",e)})}},{key:"_getTileCoordsFromMouseEvent",value:function(e){var t=this._map.project(e),n=this._unscale(t,this._tileSize);return n.z=Math.round(this._map.getZoom()),n}},{key:"_unscale",value:function(e,t){return{x:Math.floor(e.x/t),y:Math.floor(e.y/t)}}},{key:"_objectForEvent",value:function(e,t,n){var r=this._map.project(t),i=this._unscale(r,this._tileSize),o=i.x,s=i.y,a=Math.pow(2,this._map.getZoom());if(o=(o+a)%a,s=(s+a)%a,e&&e.grid){var u=Math.floor((r.x-o*this._tileSize)/4),c=Math.floor((r.y-s*this._tileSize)/4),l=this._utfDecode(e.grid[c].charCodeAt(u)),h=e.keys[l];e.data.hasOwnProperty(h)&&(t.data=e.data[h])}t.e=t.originalEvent||{type:n},this._triggerEvent(n,t)}},{key:"_triggerEvent",value:function(e,t){t.data?"mousemove"!==e?"click"===e&&(this._eventEmitter.dispatchEvent("featureout",{}),this._eventEmitter.dispatchEvent("click",t)):this._eventEmitter.dispatchEvent("mousemove",t):this._eventEmitter.dispatchEvent("featureout",{})}},{key:"remove",value:function(){this._eventEmitter.clear(),this._map.off("click"),this._map.off("mousemove")}},{key:"_utfDecode",value:function(e){return e>=93&&e--,e>=35&&e--,e-32}}]),e}();e.exports={Interactive:a}},function(e,t,n){"use strict";var r=n(2),i=n(3);e.exports=function(e){return e.__gm?new r(e):new i(e)}},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._map=t,this._listeners={}}return r(e,[{key:"project",value:function(e){var t=e.latLng,n=this._map.getProjection().fromLatLngToPoint(t),r=Math.pow(2,this.getZoom());return{x:Math.floor(r*n.x),y:Math.floor(r*n.y)}}},{key:"getZoom",value:function(){return this._map.getZoom()}},{key:"on",value:function(e,t){this._listeners[e]=this._map.addListener(e,t)}},{key:"off",value:function(e){this._listeners[e]&&this._listeners[e].remove()}},{key:"cloneEvent",value:function(e){return{da:e.da,latLng:e.latLng,pixel:e.pixel}}}]),e}();e.exports=i},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._map=t,this._listeners={}}return r(e,[{key:"project",value:function(e){var t=e.latlng.wrap();return this._map.project(t,this._map.getZoom()).floor()}},{key:"getZoom",value:function(){return this._map.getZoom()}},{key:"on",value:function(e,t){return this._listeners[e]=t,this._map.on(e,t)}},{key:"off",value:function(e){return this._map.off(e,this._listeners[e])}},{key:"cloneEvent",value:function(e){return{containerPoint:e.containerPoint,latlng:e.latlng,layerPoint:e.layerPoint,originalEvent:e.originalEvent,target:e.target,type:e.type}}}]),e}();e.exports=i},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._listeners={click:void 0,move:void 0,out:void 0,error:void 0}}return r(e,[{key:"dispatchEvent",value:function(e,t){switch(e){case"mousemove":this._listeners.move&&this._listeners.move(t);break;case"click":this._listeners.click&&this._listeners.click(t);break;case"featureout":this._listeners.out&&this._listeners.out();break;case"error":this._listeners.error&&this._listeners.error(t)}}},{key:"addEventListener",value:function(e,t){switch(e){case"mousemove":this._listeners.move=t;break;case"click":this._listeners.click=t;break;case"featureout":this._listeners.out=t;break;case"error":this._listeners.error=t}}},{key:"removeEventListener",value:function(e){switch(e){case"mousemove":delete this._listeners.move;break;case"click":delete this._listeners.click;break;case"featureout":delete this._listeners.out;break;case"error":delete this._listeners.error}}},{key:"clear",value:function(){this._listeners={click:void 0,move:void 0,out:void 0,error:void 0}}}]),e}();e.exports=i},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._url=t,this._cache={}}return r(e,[{key:"setUrl",value:function(e){this._url=e}},{key:"loadTile",value:function(e,t,n){var r=this;return this._cache[e+"_"+t+"_"+n]?Promise.resolve(this._cache[e+"_"+t+"_"+n]):(this._cache[e+"_"+t+"_"+n]="fetching",fetch(this._buildTileUrl(e,t,n)).then(this._handleLimitErrors).then(function(i){return r._cache[e+"_"+t+"_"+n]=i,i}))}},{key:"_buildTileUrl",value:function(e,t,n){var r=this._url;return r=(r=(r=r.replace(/{z}/,e)).replace(/{x}/,t)).replace(/{y}/,n)}},{key:"_handleLimitErrors",value:function(e){return 429===e.status?e.json().then(function(e){return Promise.reject(e)}):e.json()}}]),e}();e.exports=i}])})},function(e,t,n){"use strict";var r=n(25);function i(e,t){t=t||{},this.interaction=[],this.nativeMap=t.nativeMap,this._mapModel=t.mapModel,e.on("change:urls",this._reload,this),e.onLayerVisibilityChanged(this._reload.bind(this)),this._reload()}i.prototype={_reload:function(){throw new Error("_reload must be implemented")},_reloadInteraction:function(){this._clearInteraction(),this.model.forEachGroupedLayer(function(e,t){e.isVisible()&&(e.isInteractive()||this._mapModel&&this._mapModel.isFeatureInteractivityEnabled())&&this._enableInteraction(t)},this)},_clearInteraction:function(){for(var e in this.interaction)this.interaction.hasOwnProperty(e)&&this.interaction[e]&&(this.interaction[e].remove(),this.interaction[e]=null)},_enableInteraction:function(e){var t=this,n=this._generateTileJSON(e);if(n){var r=this.interaction[e];r&&r.remove(),this.interaction[e]=(new this.interactionClass).map(this.nativeMap).tilejson(n).on("on",function(n){t._interactionDisabled||(n.layer=e,t._manageOnEvents(t.nativeMap,n))}).on("off",function(n){t._interactionDisabled||(null!=(n=n||{}).errors&&t._manageInteractivityErrors(n),n.layer=e,t._manageOffEvents(t.nativeMap,n))})}},_manageInteractivityErrors:function(e){var t=r(e);t.length>0&&this.trigger("featureError",t[0])},_generateTileJSON:function(e){if(this.model.hasURLs())return{tilejson:"2.0.0",scheme:"xyz",grids:this.model.getGridURLTemplatesWithSubdomains(e),tiles:this.model.getTileURLTemplatesWithSubdomains(),formatter:function(e,t){return t}}},error:function(e){},tilesOk:function(){}},e.exports=i},function(e,t,n){"use strict";e.exports=function(e,t,n){if(n){var r={data:void 0,latLng:void 0};t.feature&&(r.data=t.feature),t.latlng&&(r.latLng={lat:t.latlng[0],lng:t.latlng[1]}),t.position&&(r.position={x:t.position.x,y:t.position.y}),n.trigger(e,r)}}},function(e,t,n){"use strict";function r(e,t){this._type=e||"",this._column=t.getColumn(),this._mapping=t.getMapping(),this._property=t.getProperty()}r.prototype.getType=function(){return this._type},r.prototype.getColumn=function(){return this._column},r.prototype.getMapping=function(){return this._mapping},r.prototype.getProperty=function(){return this._property},e.exports=r},function(e,t,n){"use strict";var r=n(0),i=n(1);function o(){}r.extend(o.prototype,i.Events),o.prototype.$setError=function(e){this._error=e,this.trigger("error",e)},o.prototype.$setEngine=function(e){if(this._engine&&this._engine!==e)throw new Error("CartoCSS engine cannot be changed");this._engine=e},o.prototype.$getEngine=function(){return this._engine},e.exports=o},function(e,t,n){"use strict";var r=n(0),i=function(e){return r.map(e,function(e){var t={};return t[e.name]=e.title,t})},o=n(1).Collection.extend({equals:function(e){var t=this.toJSON();return r.isEqual(i(t),i(e))}});e.exports=o},function(e,t,n){"use strict";var r=n(0),i=n(1);function o(e,t,n){n=n||{},this._id=n.id||o.$generateId()}r.extend(o.prototype,i.Events),o.prototype.getId=function(){return this._id},o.$nextId=0,o.$generateId=function(){return"L"+ ++o.$nextId},o.prototype.$getInternalModel=function(){return this._internalModel},e.exports=o},function(e,t,n){"use strict";var r=n(24).WINDSHAFT_ERRORS,i=function(e,t,n){this._error=e,this.origin=n||"windshaft",this.type=function(e,t,n){return e&&e!==r.UNKNOWN?e:t||(e!==r.UNKNOWN?n:r.UNKNOWN)}(e.type,t,r.GENERIC),this.subtype=e.subtype,this.message=function(e){return e&&e.length>256?e.substring(0,256):e}(e.message),this.context=e.context,this.isLayerError(e.type)&&(this.context=e.layer&&e.layer.context,this.layerId=e.layer&&e.layer.id),this.isAnalysisError(e.type)&&e.analysis&&(this.context=e.analysis.context,this.analysisId=e.analysis.node_id||e.analysis.id)};i.prototype.isGlobalError=function(e){return!this.isLayerError(e)&&!this.isAnalysisError(e)},i.prototype.isLayerError=function(e){return(e=e||this._error.type)===r.LAYER},i.prototype.isAnalysisError=function(e){return(e=e||this._error.type)===r.ANALYSIS},e.exports=i},function(e,t,n){"use strict";e.exports={MAPS_API_BASE_URL:"api/v1/map"}},function(e,t,n){"use strict";var r=n(132);e.exports.getVersion=function(e){if("latest"===e)e=r.target;else if(!r.versions.includes(e))throw new Error('Invalid camshaft-reference version: "'+e+'". Valid versions are: '+r.versions.join(", ")+".");return n(131)("./"+e+"/reference.json")},e.exports.versions=r.versions},function(e,t,n){"use strict";var r=n(0),i=n(137),o=n(135),s=n(1),a=n(126),u=n(125),c=n(124),l=n(123),h=n(117),f=n(116),p=n(115),d=n(114),g=n(29),m=n(41);function y(e){if(!e)throw new Error("new Engine() called with no parameters");this._isNamedMap=void 0!==e.templateName,this._timeout=null,this._stackCalls=[],this._batchOptions={},this._windshaftSettings={urlTemplate:e.serverUrl,userName:e.username,client:e.client,apiKey:e.apiKey,authToken:e.authToken,templateName:e.templateName},this._windshaftClient=new d(this._windshaftSettings),this._eventEmmitter=r.extend({},s.Events),this._analysisPoller=new i,this._layersCollection=new c,this._dataviewsCollection=new u,this._cartoLayerGroup=new a({apiKey:e.apiKey,authToken:e.authToken},{layersCollection:this._layersCollection}),this._bindCartoLayerGroupError(),this._modelUpdater=new l({dataviewsCollection:this._dataviewsCollection,layerGroupModel:this._cartoLayerGroup,layersCollection:this._layersCollection})}y.prototype.getLayerGroup=function(){return this._cartoLayerGroup},y.prototype.getApiKey=function(){return this._windshaftSettings&&this._windshaftSettings.apiKey},y.prototype.getAuthToken=function(){return this._windshaftSettings&&this._windshaftSettings.authToken},y.prototype.on=function(e,t,n){this._eventEmmitter.on(e,t,n)},y.prototype.off=function(e,t,n){this._eventEmmitter.off(e,t,n)},y.prototype.reload=function(e){return e=e||{},new Promise(function(t,n){this._batchOptions=r.pick({sourceId:e.sourceId,forceFetch:this._batchOptions.forceFetch||e.forceFetch,includeFilters:e.includeFilters},r.negate(r.isUndefined)),this._stackCalls.push({success:e.success,error:e.error,resolve:t,reject:n});var i=function(){this._timeout=null,this._performReload(this._batchOptions).then(function(){this._stackCalls.forEach(function(e){e.success&&e.success(),e.resolve()}),this._stackCalls=[],this._batchOptions={}}.bind(this)).catch(function(e){this._stackCalls.forEach(function(t){t.error&&t.error(e),t.reject(e)}),this._stackCalls=[],this._batchOptions={}}.bind(this))}.bind(this);clearTimeout(this._timeout),this._timeout=setTimeout(i,100)}.bind(this))},y.prototype._performReload=function(e){return new Promise(function(t,n){var r=this._buildWindshaftOptions(e,function(n){this._onReloadSuccess(n,e.sourceId,e.forceFetch),t()}.bind(this),function(e){var t=this._onReloadError(e);n(t)}.bind(this));try{var i=this._buildParams(r.includeFilters),o=this._getSerializer().serialize(this._layersCollection,this._dataviewsCollection),s=new f(o,i,r);this._eventEmmitter.trigger(y.Events.RELOAD_STARTED),this._windshaftClient.instantiateMap(s)}catch(e){var a=new m({message:e.message});this._manageClientError(a,r)}}.bind(this))},y.prototype.addLayer=function(e){this._layersCollection.add(e)},y.prototype.removeLayer=function(e){this._layersCollection.remove(e)},y.prototype.moveLayer=function(e,t){var n=this._layersCollection.indexOf(e);n>=0&&n!==t&&this._layersCollection.models.splice(t,0,this._layersCollection.models.splice(n,1)[0])},y.prototype.addDataview=function(e){this._dataviewsCollection.add(e)},y.prototype.removeDataview=function(e){this._dataviewsCollection.remove(e)},y.prototype._onReloadSuccess=function(e,t,n){var r=new p(this._windshaftSettings,e);this._modelUpdater.updateModels(r,t,n),this._restartAnalysisPolling(),this._eventEmmitter.trigger(y.Events.RELOAD_SUCCESS)},y.prototype._onReloadError=function(e){var t=this._getSimpleWindshaftError(e);return this._modelUpdater.setErrors(e),this._eventEmmitter.trigger(y.Events.RELOAD_ERROR,t),t},y.prototype._buildWindshaftOptions=function(e,t,n){return r.extend({includeFilters:!0,success:t,error:n},r.pick(e,"sourceId","forceFetch","includeFilters"))},y.prototype._buildParams=function(e){var t={};return t.client=this._windshaftSettings.client,e&&!r.isEmpty(this._dataviewsCollection.getFilters())&&(t.filters=this._dataviewsCollection.getFilters()),this._windshaftSettings.apiKey?(t.api_key=this._windshaftSettings.apiKey,t):this._windshaftSettings.authToken?(t.auth_token=this._windshaftSettings.authToken,t):void console.warn("Engine initialized with no apiKeys neither authToken")},y.prototype._restartAnalysisPolling=function(){var e=g.getUniqueAnalysisNodes(this._layersCollection,this._dataviewsCollection);this._analysisPoller.resetAnalysisNodes(e)},y.prototype._getSerializer=function(){return this._isNamedMap?h:o},y.prototype._manageClientError=function(e,t){this._modelUpdater.setErrors([e]),t.error&&t.error([e])},y.prototype._bindCartoLayerGroupError=function(){this._cartoLayerGroup.on("all",function(e,t){0===e.lastIndexOf("error:",0)&&(t=new m(t),this._eventEmmitter.trigger(y.Events.LAYER_ERROR,t))},this)},y.prototype._getSimpleWindshaftError=function(e){var t=r.find(e,function(e){return e.isGlobalError()});return!t&&e&&e.length>0&&(t=e[0]),t},y.Events={RELOAD_STARTED:"reload-started",RELOAD_SUCCESS:"reload-success",RELOAD_ERROR:"reload-error",LAYER_ERROR:"layer-error"},e.exports=y},function(e,t,n){"use strict";n.r(t);var r=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},i=function(e){return 1===e.length&&(e=function(e){return function(t,n){return r(e(t),n)}}(e)),{left:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var o=r+i>>>1;e(t[o],n)<0?r=o+1:i=o}return r},right:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var o=r+i>>>1;e(t[o],n)>0?i=o:r=o+1}return r}}};var o=i(r),s=o.right,a=o.left,u=s,c=function(e,t){null==t&&(t=l);for(var n=0,r=e.length-1,i=e[0],o=new Array(r<0?0:r);n<r;)o[n]=t(i,i=e[++n]);return o};function l(e,t){return[e,t]}var h=function(e,t,n){var r,i,o,s,a=e.length,u=t.length,c=new Array(a*u);for(null==n&&(n=l),r=o=0;r<a;++r)for(s=e[r],i=0;i<u;++i,++o)c[o]=n(s,t[i]);return c},f=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},p=function(e){return null===e?NaN:+e},d=function(e,t){var n,r,i=e.length,o=0,s=-1,a=0,u=0;if(null==t)for(;++s<i;)isNaN(n=p(e[s]))||(u+=(r=n-a)*(n-(a+=r/++o)));else for(;++s<i;)isNaN(n=p(t(e[s],s,e)))||(u+=(r=n-a)*(n-(a+=r/++o)));if(o>1)return u/(o-1)},g=function(e,t){var n=d(e,t);return n?Math.sqrt(n):n},m=function(e,t){var n,r,i,o=e.length,s=-1;if(null==t){for(;++s<o;)if(null!=(n=e[s])&&n>=n)for(r=i=n;++s<o;)null!=(n=e[s])&&(r>n&&(r=n),i<n&&(i=n))}else for(;++s<o;)if(null!=(n=t(e[s],s,e))&&n>=n)for(r=i=n;++s<o;)null!=(n=t(e[s],s,e))&&(r>n&&(r=n),i<n&&(i=n));return[r,i]},y=Array.prototype,_=y.slice,v=y.map,b=function(e){return function(){return e}},w=function(e){return e},x=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(i);++r<i;)o[r]=e+r*n;return o},C=Math.sqrt(50),E=Math.sqrt(10),S=Math.sqrt(2),T=function(e,t,n){var r,i,o,s,a=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(s=A(e,t,n))||!isFinite(s))return[];if(s>0)for(e=Math.ceil(e/s),t=Math.floor(t/s),o=new Array(i=Math.ceil(t-e+1));++a<i;)o[a]=(e+a)*s;else for(e=Math.floor(e*s),t=Math.ceil(t*s),o=new Array(i=Math.ceil(e-t+1));++a<i;)o[a]=(e-a)/s;return r&&o.reverse(),o};function A(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=C?10:o>=E?5:o>=S?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=C?10:o>=E?5:o>=S?2:1)}function M(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=C?i*=10:o>=E?i*=5:o>=S&&(i*=2),t<e?-i:i}var k=function(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1},L=function(){var e=w,t=m,n=k;function r(r){var i,o,s=r.length,a=new Array(s);for(i=0;i<s;++i)a[i]=e(r[i],i,r);var c=t(a),l=c[0],h=c[1],f=n(a,l,h);Array.isArray(f)||(f=M(l,h,f),f=x(Math.ceil(l/f)*f,Math.floor(h/f)*f,f));for(var p=f.length;f[0]<=l;)f.shift(),--p;for(;f[p-1]>h;)f.pop(),--p;var d,g=new Array(p+1);for(i=0;i<=p;++i)(d=g[i]=[]).x0=i>0?f[i-1]:l,d.x1=i<p?f[i]:h;for(i=0;i<s;++i)l<=(o=a[i])&&o<=h&&g[u(f,o,0,p)].push(r[i]);return g}return r.value=function(t){return arguments.length?(e="function"==typeof t?t:b(t),r):e},r.domain=function(e){return arguments.length?(t="function"==typeof e?e:b([e[0],e[1]]),r):t},r.thresholds=function(e){return arguments.length?(n="function"==typeof e?e:Array.isArray(e)?b(_.call(e)):b(e),r):n},r},O=function(e,t,n){if(null==n&&(n=p),r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+n(e[o],o,e);return s+(+n(e[o+1],o+1,e)-s)*(i-o)}},R=function(e,t,n){return e=v.call(e,p).sort(r),Math.ceil((n-t)/(2*(O(e,.75)-O(e,.25))*Math.pow(e.length,-1/3)))},F=function(e,t,n){return Math.ceil((n-t)/(3.5*g(e)*Math.pow(e.length,-1/3)))},P=function(e,t){var n,r,i=e.length,o=-1;if(null==t){for(;++o<i;)if(null!=(n=e[o])&&n>=n)for(r=n;++o<i;)null!=(n=e[o])&&n>r&&(r=n)}else for(;++o<i;)if(null!=(n=t(e[o],o,e))&&n>=n)for(r=n;++o<i;)null!=(n=t(e[o],o,e))&&n>r&&(r=n);return r},B=function(e,t){var n,r=e.length,i=r,o=-1,s=0;if(null==t)for(;++o<r;)isNaN(n=p(e[o]))?--i:s+=n;else for(;++o<r;)isNaN(n=p(t(e[o],o,e)))?--i:s+=n;if(i)return s/i},I=function(e,t){var n,i=e.length,o=-1,s=[];if(null==t)for(;++o<i;)isNaN(n=p(e[o]))||s.push(n);else for(;++o<i;)isNaN(n=p(t(e[o],o,e)))||s.push(n);return O(s.sort(r),.5)},N=function(e){for(var t,n,r,i=e.length,o=-1,s=0;++o<i;)s+=e[o].length;for(n=new Array(s);--i>=0;)for(t=(r=e[i]).length;--t>=0;)n[--s]=r[t];return n},D=function(e,t){var n,r,i=e.length,o=-1;if(null==t){for(;++o<i;)if(null!=(n=e[o])&&n>=n)for(r=n;++o<i;)null!=(n=e[o])&&r>n&&(r=n)}else for(;++o<i;)if(null!=(n=t(e[o],o,e))&&n>=n)for(r=n;++o<i;)null!=(n=t(e[o],o,e))&&r>n&&(r=n);return r},j=function(e,t){for(var n=t.length,r=new Array(n);n--;)r[n]=e[t[n]];return r},q=function(e,t){if(n=e.length){var n,i,o=0,s=0,a=e[s];for(null==t&&(t=r);++o<n;)(t(i=e[o],a)<0||0!==t(a,a))&&(a=i,s=o);return 0===t(a,a)?s:void 0}},z=function(e,t,n){for(var r,i,o=(null==n?e.length:n)-(t=null==t?0:+t);o;)i=Math.random()*o--|0,r=e[o+t],e[o+t]=e[i+t],e[i+t]=r;return e},U=function(e,t){var n,r=e.length,i=-1,o=0;if(null==t)for(;++i<r;)(n=+e[i])&&(o+=n);else for(;++i<r;)(n=+t(e[i],i,e))&&(o+=n);return o},$=function(e){if(!(i=e.length))return[];for(var t=-1,n=D(e,H),r=new Array(n);++t<n;)for(var i,o=-1,s=r[t]=new Array(i);++o<i;)s[o]=e[o][t];return r};function H(e){return e.length}var G=function(){return $(arguments)};n.d(t,"bisect",function(){return u}),n.d(t,"bisectRight",function(){return s}),n.d(t,"bisectLeft",function(){return a}),n.d(t,"ascending",function(){return r}),n.d(t,"bisector",function(){return i}),n.d(t,"cross",function(){return h}),n.d(t,"descending",function(){return f}),n.d(t,"deviation",function(){return g}),n.d(t,"extent",function(){return m}),n.d(t,"histogram",function(){return L}),n.d(t,"thresholdFreedmanDiaconis",function(){return R}),n.d(t,"thresholdScott",function(){return F}),n.d(t,"thresholdSturges",function(){return k}),n.d(t,"max",function(){return P}),n.d(t,"mean",function(){return B}),n.d(t,"median",function(){return I}),n.d(t,"merge",function(){return N}),n.d(t,"min",function(){return D}),n.d(t,"pairs",function(){return c}),n.d(t,"permute",function(){return j}),n.d(t,"quantile",function(){return O}),n.d(t,"range",function(){return x}),n.d(t,"scan",function(){return q}),n.d(t,"shuffle",function(){return z}),n.d(t,"sum",function(){return U}),n.d(t,"ticks",function(){return T}),n.d(t,"tickIncrement",function(){return A}),n.d(t,"tickStep",function(){return M}),n.d(t,"transpose",function(){return $}),n.d(t,"variance",function(){return d}),n.d(t,"zip",function(){return G})},function(e,t,n){"use strict";var r=n(21),i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.JOIN_OPERATOR="OR",n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r),t}();e.exports=i},function(e,t,n){"use strict";var r=n(21),i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.JOIN_OPERATOR="AND",n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r),t}();e.exports=i},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=n(11),o={lt:{parameters:[{name:"lt",allowedTypes:["Number","Date","Object"]}]},lte:{parameters:[{name:"lte",allowedTypes:["Number","Date","Object"]}]},gt:{parameters:[{name:"gt",allowedTypes:["Number","Date","Object"]}]},gte:{parameters:[{name:"gte",allowedTypes:["Number","Date","Object"]}]},between:{parameters:[{name:"between.min",allowedTypes:["Number","Date"]},{name:"between.max",allowedTypes:["Number","Date"]}]},notBetween:{parameters:[{name:"notBetween.min",allowedTypes:["Number","Date"]},{name:"notBetween.max",allowedTypes:["Number","Date"]}]},betweenSymmetric:{parameters:[{name:"betweenSymmetric.min",allowedTypes:["Number","Date"]},{name:"betweenSymmetric.max",allowedTypes:["Number","Date"]}]},notBetweenSymmetric:{parameters:[{name:"notBetweenSymmetric.min",allowedTypes:["Number","Date"]},{name:"notBetweenSymmetric.max",allowedTypes:["Number","Date"]}]}},s=Object.freeze(Object.keys(o)),a=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return i.SQL_TEMPLATES=i._getSQLTemplates(),i.ALLOWED_FILTERS=s,i.PARAMETER_SPECIFICATION=o,i._checkFilters(n),i._filters=n,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i),r(t,[{key:"_getSQLTemplates",value:function(){return{lt:'<%= column %> < <%= value.query ? "(" + value.query + ")" : value %>',lte:'<%= column %> <= <%= value.query ? "(" + value.query + ")" : value %>',gt:'<%= column %> > <%= value.query ? "(" + value.query + ")" : value %>',gte:'<%= column %> >= <%= value.query ? "(" + value.query + ")" : value %>',between:"<%= column %> BETWEEN <%= value.min %> AND <%= value.max %>",notBetween:"<%= column %> NOT BETWEEN <%= value.min %> AND <%= value.max %>",betweenSymmetric:"<%= column %> BETWEEN SYMMETRIC <%= value.min %> AND <%= value.max %>",notBetweenSymmetric:"<%= column %> NOT BETWEEN SYMMETRIC <%= value.min %> AND <%= value.max %>"}}}]),t}();e.exports=a},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=n(11),o={in:{parameters:[{name:"in",allowedTypes:["Array","String","Object"]}]},notIn:{parameters:[{name:"notIn",allowedTypes:["Array","String","Object"]}]},eq:{parameters:[{name:"eq",allowedTypes:["String","Number","Date","Object"]}]},notEq:{parameters:[{name:"notEq",allowedTypes:["String","Number","Date","Object"]}]},like:{parameters:[{name:"like",allowedTypes:["String"]}]},similarTo:{parameters:[{name:"similarTo",allowedTypes:["String"]}]}},s=Object.freeze(Object.keys(o)),a=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return i.SQL_TEMPLATES=i._getSQLTemplates(),i.ALLOWED_FILTERS=s,i.PARAMETER_SPECIFICATION=o,i._checkFilters(n),i._filters=n,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i),r(t,[{key:"_getSQLTemplates",value:function(){return{in:"<% if (value) { %><%= column %> IN (<%= value.query || value %>)<% } else { %>true = false<% } %>",notIn:"<% if (value) { %><%= column %> NOT IN (<%= value.query || value %>)<% } %>",eq:'<%= column %> = <%= value.query ? "(" + value.query + ")" : value %>',notEq:'<%= column %> != <%= value.query ? "(" + value.query + ")" : value %>',like:"<%= column %> LIKE <%= value %>",similarTo:"<%= column %> SIMILAR TO <%= value %>"}}}]),t}();e.exports=a},function(e,t,n){"use strict";var r=n(2);e.exports=r.extend({initialize:function(){this._polygon={}},setPolygon:function(e){this._polygon=e,this.trigger("polygonChanged",e)},getPolygon:function(){return this._polygon},serialize:function(){return encodeURIComponent(JSON.stringify(this.getPolygon()))}})},function(e,t,n){"use strict";var r=n(0),i=n(6),o=n(50),s=n(3),a=n(8);function u(){this._internalModel=new o,this.type=a.POLYGON}u.prototype=Object.create(i.prototype),u.prototype.setPolygon=function(e){return this._checkPolygon(e),this._internalModel.setPolygon(e),this.trigger("polygonChanged",e),this},u.prototype.resetPolygon=function(){return this.setPolygon({type:"Polygon",coordinates:[]})},u.prototype.getPolygon=function(){return this._internalModel.getPolygon()},u.prototype._checkPolygon=function(e){if(r.isUndefined(e)||r.isUndefined(e.type)||r.isUndefined(e.coordinates)||!r.isString(e.type)||!r.isArray(e.coordinates)||"Polygon"!==e.type)throw new s("filter","invalidPolygonObject")},u.prototype.$getInternalModel=function(){return this._internalModel},e.exports=u},function(e,t,n){"use strict";var r=n(2);e.exports=r.extend({initialize:function(){this._circle={}},setCircle:function(e){this._circle=e,this.trigger("circleChanged",e)},getCircle:function(){return this._circle},serialize:function(){return encodeURIComponent(JSON.stringify(this.getCircle()))}})},function(e,t,n){"use strict";var r=n(0),i=n(6),o=n(52),s=n(3),a=n(8);function u(){this._internalModel=new o,this.type=a.CIRCLE}u.prototype=Object.create(i.prototype),u.prototype.setCircle=function(e){return this._checkCircle(e),this._internalModel.setCircle(e),this.trigger("circleChanged",e),this},u.prototype.resetCircle=function(){return this.setCircle({lat:0,lng:0,radius:0})},u.prototype.getCircle=function(){return this._internalModel.getCircle()},u.prototype._checkCircle=function(e){if(r.isUndefined(e)||r.isUndefined(e.lat)||r.isUndefined(e.lng)||r.isUndefined(e.radius)||!r.isNumber(e.lat)||!r.isNumber(e.lng)||!r.isNumber(e.radius))throw new s("filter","invalidCircleObject")},u.prototype.$getInternalModel=function(){return this._internalModel},e.exports=u},function(e,t,n){"use strict";var r=n(0),i=n(2);e.exports=i.extend({initialize:function(e){this._isReady=!1,this._map=e,this._debouncedTriggerBoundsChanged=r.debounce(this._triggerBoundsChanged,200),google.maps.event.addListener(this._map,"bounds_changed",this._debouncedTriggerBoundsChanged.bind(this))},getBounds:function(){if(this._isReady){var e=this._map.getBounds(),t=e.getSouthWest(),n=e.getNorthEast();return{west:t.lng(),south:t.lat(),east:n.lng(),north:n.lat()}}return{west:0,south:0,east:0,north:0}},clean:function(){google.maps.event.clearListeners(this._map,"bounds_changed")},_triggerBoundsChanged:function(){this._isReady=!0,this.trigger("boundsChanged",this.getBounds())}})},function(e,t,n){"use strict";var r=n(6),i=n(54),o=n(18),s=n(7),a=n(8);function u(e){if(!function(e){return s.isGoogleMapsLoaded(),e instanceof google.maps.Map}(e))throw new Error("Bounding box requires a Google Maps map but got: "+e);this.type=a.BBOX;var t=new i(e);this._internalModel=new o(t),this.listenTo(this._internalModel,"boundsChanged",this._onBoundsChanged)}u.prototype=Object.create(r.prototype),u.prototype.getBounds=function(){return this._internalModel.getBounds()},u.prototype._onBoundsChanged=function(e){this.trigger("boundsChanged",e)},u.prototype.$getInternalModel=function(){return this._internalModel},e.exports=u},function(e,t,n){"use strict";var r=n(0),i=n(2);e.exports=i.extend({initialize:function(e){this._map=e,this._debouncedTriggerBoundsChanged=r.debounce(this._triggerBoundsChanged,200),this._map.on("move zoom",this._debouncedTriggerBoundsChanged,this)},getBounds:function(){var e=this._map.getBounds(),t=e.getSouthWest(),n=e.getNorthEast();return{west:t.lng,south:t.lat,east:n.lng,north:n.lat}},clean:function(){this._map.off("move zoom")},_triggerBoundsChanged:function(){this.trigger("boundsChanged",this.getBounds())}})},function(e,t,n){"use strict";var r=n(6),i=n(56),o=n(18),s=n(7),a=n(8);function u(e){if(!function(e){return s.isLeafletLoaded(),e instanceof L.Map}(e))throw new Error("Bounding box requires a Leaflet map but got: "+e);this.type=a.BBOX;var t=new i(e);this._internalModel=new o(t),this.listenTo(this._internalModel,"boundsChanged",this._onBoundsChanged)}u.prototype=Object.create(r.prototype),u.prototype.getBounds=function(){return this._internalModel.getBounds()},u.prototype._onBoundsChanged=function(e){this.trigger("boundsChanged",e)},u.prototype.$getInternalModel=function(){return this._internalModel},e.exports=u},function(e,t,n){"use strict";var r=n(0),i=n(6),o=n(18),s=n(3),a=n(8);function u(){this._internalModel=new o,this.type=a.BBOX}u.prototype=Object.create(i.prototype),u.prototype.setBounds=function(e){return this._checkBounds(e),this._internalModel.setBounds(e),this.trigger("boundsChanged",e),this},u.prototype.resetBounds=function(){return this.setBounds({west:0,south:0,east:0,north:0})},u.prototype.getBounds=function(){return this._internalModel.getBounds()},u.prototype._checkBounds=function(e){if(r.isUndefined(e)||r.isUndefined(e.west)||r.isUndefined(e.south)||r.isUndefined(e.east)||r.isUndefined(e.north)||!r.isNumber(e.west)||!r.isNumber(e.south)||!r.isNumber(e.east)||!r.isNumber(e.north))throw new s("filter","invalidBoundsObject")},u.prototype.$getInternalModel=function(){return this._internalModel},e.exports=u},function(e,t,n){"use strict";var r=n(58),i=n(57),o=n(55),s=n(53),a=n(51),u=n(49),c=n(48),l=n(47),h=n(46);e.exports={BoundingBox:r,BoundingBoxLeaflet:i,BoundingBoxGoogleMaps:o,Circle:s,Polygon:a,Category:u,Range:c,AND:l,OR:h}},function(e,t,n){"use strict";var r=n(0);e.exports=function(e,t,n,i){if(!e)return null;var o=r.compact(e),s=r.max(o,function(e){return e.freq||0});return{bins:function(e,t){return e.map(function(e){return{index:e.bin,start:e.start,end:e.end,min:e.min,max:e.max,freq:e.freq,normalized:r.isFinite(e.freq)&&t>0?e.freq/t:0}})}(o,r.isFinite(s.freq)&&0!==s.freq?s.freq:null),nulls:t||0,offset:function(e){return e/3600}(i),totalAmount:n}}},function(e,t,n){"use strict";var r=n(0),i=n(10),o=n(32),s=n(60),a=n(5).timeAggregation,u=n(5).isValidTimeAggregation;function c(e,t,n){this._initialize(e,t,n),this._aggregation=this._options.aggregation,this._offset=l(this._options.offset),this._localTimezone=this._options.useLocalTimezone}function l(e){return 3600*e}c.prototype=Object.create(i.prototype),c.prototype.DEFAULTS={aggregation:a.AUTO,offset:0,useLocalTimezone:!1},c.prototype.getData=function(){return this._internalModel?s(this._internalModel.get("data"),this._internalModel.get("nulls"),this._internalModel.get("totalAmount"),this._internalModel.getCurrentOffset()):null},c.prototype.setAggregation=function(e){return this._validateAggregation(e),this._changeProperty("aggregation",e),this},c.prototype.getAggregation=function(){return this._aggregation},c.prototype.setOffset=function(e){return this._validateOffset(e),this._changeProperty("offset",l(e)),this},c.prototype.getOffset=function(){return function(e){return e/3600}(this._offset)},c.prototype.useLocalTimezone=function(e){return this._validateLocalTimezone(e),this._changeProperty("localTimezone",e),this},c.prototype.isUsingLocalTimezone=function(){return this._localTimezone},c.prototype._checkOptions=function(e){if(r.isUndefined(e))throw this._getValidationError("timeSeriesOptionsRequired");this._validateAggregation(e.aggregation),this._validateOffset(e.offset),this._validateLocalTimezone(e.useLocalTimezone)},c.prototype._validateAggregation=function(e){if(!u(e))throw this._getValidationError("timeSeriesInvalidAggregation")},c.prototype._validateOffset=function(e){if(!r.isFinite(e)||Math.floor(e)!==e||e<-12||e>14)throw this._getValidationError("timeSeriesInvalidOffset")},c.prototype._validateLocalTimezone=function(e){if(!r.isBoolean(e))throw this._getValidationError("timeSeriesInvalidUselocaltimezone")},c.prototype._createInternalModel=function(e){this._internalModel=new o({source:this._source.$getInternalModel(),column:this._column,aggregation:this._aggregation,offset:this._offset,localTimezone:this._localTimezone,sync_on_bbox_change:!!this._boundingBoxFilter,sync_on_circle_change:!!this._circleFilter,sync_on_polygon_change:!!this._polygonFilter,enabled:this._enabled,column_type:"date"},{engine:e,bboxFilter:this._boundingBoxFilter&&this._boundingBoxFilter.$getInternalModel(),circleFilter:this._circleFilter&&this._circleFilter.$getInternalModel(),polygonFilter:this._polygonFilter&&this._polygonFilter.$getInternalModel()})},e.exports=c},function(e,t,n){"use strict";var r=n(0);e.exports=function(e,t,n){if(!e)return null;var i=r.compact(e),o=r.max(i,function(e){return e.freq||0});return{bins:function(e,t){return e.map(function(e){return r.extend(e,{normalized:r.isFinite(e.freq)&&t>0?e.freq/t:0})})}(i,r.isFinite(o.freq)&&0!==o.freq?o.freq:null),nulls:t||0,totalAmount:n}}},function(e,t,n){"use strict";var r={getLocalOffset:function(){return-60*(new Date).getTimezoneOffset()}};e.exports=r},function(e,t,n){"use strict";var r=n(0),i=n(19),o=n(2),s=n(31);e.exports=o.extend({defaults:{url:"",data:[],localTimezone:!1,localOffset:0,hasBeenFetched:!1},url:function(){var e=[],t=this.get("column_type"),n=this._getCurrentOffset(),i=this.get("aggregation")||"auto";if(e.push("no_filters=1"),"number"===t&&this.get("bins")?e.push("bins="+this.get("bins")):"date"===t&&(e.push("aggregation="+i),r.isFinite(n)&&e.push("offset="+n)),this.get("apiKey"))e.push("api_key="+this.get("apiKey"));else if(this.get("authToken")){var o=this.get("authToken");o instanceof Array?r.each(o,function(t){e.push("auth_token[]="+t)}):e.push("auth_token="+o)}var s=this.get("start"),a=this.get("end");return r.isFinite(s)&&r.isFinite(a)&&(e.push("start="+s),e.push("end="+a)),this.get("url")+"?"+e.join("&")},initialize:function(){this.sync=i.bind(this),this._initBinds()},_initBinds:function(){this.on("change:url",function(){this.refresh()},this),this.on("change:aggregation change:offset",function(){"date"===this.get("column_type")&&this.get("aggregation")&&this.refresh()},this),this.on("change:bins",function(){"number"===this.get("column_type")&&this.refresh()},this),this.on("change:localTimezone",function(){this.refresh()},this),this.on("change:column",function(){this.set("aggregation","auto",{silent:!0})}),this.on("sync",function(){this.set("hasBeenFetched",!0)})},setUrl:function(e){if(!e)throw new Error("url not specified");this.set("url",e)},setBins:function(e){this.set("bins",e,{silent:void 0===e})},getData:function(){return this.get("data")},parse:function(e){var t=e.aggregation||this.get("aggregation"),n=e.bins_count||0,i=e.bin_width,o="date"===this.get("column_type")?e.timestamp_start:e.bins_start,a={};return a.data=new Array(n),t&&(a.aggregation=t,this.set("aggregation",t,{silent:!0})),r.each(e.bins,function(e){a.data[e.bin]=e}),"date"===this.get("column_type")?(a.data=s.fillTimestampBuckets(a.data,o,t,n,"totals"),n=a.data.length):s.fillNumericBuckets(a.data,o,i,n),a.data.length>0&&(a.start=a.data[0].start,a.end=a.data[a.data.length-1].end),a.bins=n,a},refresh:function(){this.fetch()},_getCurrentOffset:function(){return this.get("localTimezone")?this.get("localOffset"):this.get("offset")}})},function(e,t,n){"use strict";var r=n(0),i=n(10),o=n(32),s=n(62);function a(e,t,n){this._initialize(e,t,n),this._bins=this._options.bins,this._start=this._options.start,this._end=this._options.end}a.prototype=Object.create(i.prototype),a.prototype.DEFAULTS={bins:10},a.prototype.getData=function(){return this._internalModel?s(this._internalModel.get("data"),this._internalModel.get("nulls"),this._internalModel.get("totalAmount")):null},a.prototype.setColumn=function(e){i.prototype.setColumn.apply(this,arguments),this._start=null,this._end=null},a.prototype.setBins=function(e){return this._validateBins(e),this._changeProperty("bins",e),this},a.prototype.getBins=function(){return this._bins},a.prototype.setStartEnd=function(e,t){return this._validateStartEnd(e,t),this._changeProperties({start:e,end:t}),this},a.prototype.getStart=function(){return this._start||this._internalModel.get("start")},a.prototype.getEnd=function(){return this._end||this._internalModel.get("end")},a.prototype.getDistributionType=function(){if(this._internalModel){var e=this._internalModel.getData();return this._internalModel.getDistributionType(e)}return null},a.prototype._validateBins=function(e){if(!r.isFinite(e)||e<1||Math.floor(e)!==e)throw this._getValidationError("histogramInvalidBins")},a.prototype._validateStartEnd=function(e,t){var n=[e,t];if(!r.every(n,r.isUndefined)){var i=r.every(n,function(e){return r.isNumber(e)&&!r.isNaN(e)}),o=r.every(n,r.isNull);if(!i&&!o)throw this._getValidationError("histogramInvalidStartEnd")}},a.prototype._checkOptions=function(e){if(r.isUndefined(e))throw this._getValidationError("histogramOptionsRequired");this._validateBins(e.bins),this._validateStartEnd(e.start,e.end)},a.prototype._createInternalModel=function(e){this._internalModel=new o({source:this._source.$getInternalModel(),column:this._column,bins:this._bins,start:this._start,end:this._end,sync_on_bbox_change:!!this._boundingBoxFilter,sync_on_circle_change:!!this._circleFilter,sync_on_polygon_change:!!this._polygonFilter,enabled:this._enabled,column_type:"number"},{engine:e,bboxFilter:this._boundingBoxFilter&&this._boundingBoxFilter.$getInternalModel(),circleFilter:this._circleFilter&&this._circleFilter.$getInternalModel(),polygonFilter:this._polygonFilter&&this._polygonFilter.$getInternalModel()})},e.exports=a},function(e,t,n){"use strict";e.exports=function(e,t,n){return{nulls:e,operation:t,result:n}}},function(e,t,n){"use strict";var r=n(0),i=n(20);e.exports=i.extend({defaults:r.extend({type:"formula",data:""},i.prototype.defaults),initialize:function(){i.prototype.initialize.apply(this,arguments),this.on("change:column change:operation",this._reloadAndForceFetch,this)},parse:function(e){return{data:e.result,nulls:e.nulls}},toJSON:function(){return{type:"formula",source:{id:this.getSourceId()},options:{column:this.get("column"),operation:this.get("operation")}}}},{ATTRS_NAMES:i.ATTRS_NAMES.concat(["column","operation"])})},function(e,t,n){"use strict";var r=n(0),i=n(10),o=n(5),s=n(67),a=n(66);function u(e,t,n){this._initialize(e,t,n),this._operation=this._options.operation}u.prototype=Object.create(i.prototype),u.prototype.setOperation=function(e){return this._checkOperation(e),this._changeProperty("operation",e),this},u.prototype.getOperation=function(){return this._operation},u.prototype.getData=function(){return this._internalModel?a(this._internalModel.get("nulls"),this._operation,this._internalModel.get("data")):null},u.prototype.DEFAULTS={operation:o.operation.COUNT},u.prototype._checkOptions=function(e){if(r.isUndefined(e))throw this._getValidationError("formulaOptionsRequired");this._checkOperation(e.operation)},u.prototype._checkOperation=function(e){if(r.isUndefined(e)||!o.isValidOperation(e))throw this._getValidationError("formulaInvalidOperation")},u.prototype._createInternalModel=function(e){this._internalModel=new s({source:this._source.$getInternalModel(),column:this._column,operation:this._operation,sync_on_bbox_change:!!this._boundingBoxFilter,sync_on_circle_change:!!this._circleFilter,sync_on_polygon_change:!!this._polygonFilter,enabled:this._enabled},{engine:e,bboxFilter:this._boundingBoxFilter&&this._boundingBoxFilter.$getInternalModel(),circleFilter:this._circleFilter&&this._circleFilter.$getInternalModel(),polygonFilter:this._polygonFilter&&this._polygonFilter.$getInternalModel()})},e.exports=u},function(e,t,n){"use strict";var r=n(0);e.exports=function(e,t,n,i,o,s){return e?{count:t,max:n,min:i,nulls:o,operation:s,categories:function(e){return r.map(e,function(e){return{group:e.agg,name:e.name,value:e.value}})}(e)}:null}},function(e,t,n){"use strict";var r=n(2);e.exports=r.extend({isEmpty:function(){throw new Error("Filters must implement the .isEmpty method")},toJSON:function(){throw new Error("Filters must implement the .toJSON method")},remove:function(){this.trigger("destroy",this),this.stopListening()}})},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(70);e.exports=o.extend({defaults:{rejectAll:!1},initialize:function(){this.rejectedCategories=new i.Collection,this.acceptedCategories=new i.Collection,this._initBinds()},_initBinds:function(){this.listenTo(this.rejectedCategories,"add remove",function(){this.set("rejectAll",!1)}),this.listenTo(this.acceptedCategories,"add remove",function(){this.set("rejectAll",!1)})},isEmpty:function(){return 0===this.rejectedCategories.size()&&0===this.acceptedCategories.size()&&!this.get("rejectAll")},accept:function(e,t){e=r.isArray(e)?e:[e],r.each(e,function(e){var t={name:e},n=this.rejectedCategories.where(t),r=this.acceptedCategories.where(t);n.length>0?this.rejectedCategories.remove(n):r.length||this.acceptedCategories.add(t)},this),!1!==t&&this.applyFilter()},acceptAll:function(){this.set("rejectAll",!1),this.cleanFilter()},isAccepted:function(e){return this.acceptedCategories.where({name:e}).length>0},reject:function(e,t){e=r.isArray(e)?e:[e],r.each(e,function(e){var t={name:e},n=this.acceptedCategories.where(t),r=this.rejectedCategories.where(t);n.length>0?this.acceptedCategories.remove(n):r.length||this.rejectedCategories.add(t)},this),!1!==t&&this.applyFilter()},isRejected:function(e){var t=this.acceptedCategories.size();return this.rejectedCategories.where({name:e}).length>0||(t>0&&0===this.acceptedCategories.where({name:e}).length||!!this.get("rejectAll"))},rejectAll:function(){this.set("rejectAll",!0),this.cleanFilter()},cleanFilter:function(e){this.acceptedCategories.reset(),this.rejectedCategories.reset(),!1!==e&&this.applyFilter()},applyFilter:function(){this.trigger("change",this)},areAllRejected:function(){return this.get("rejectAll")},toJSON:function(){var e={},t=this.rejectedCategories.size(),n=this.acceptedCategories.size(),i={accept:r.pluck(this.acceptedCategories.toJSON(),"name")},o={reject:r.pluck(this.rejectedCategories.toJSON(),"name")};this.get("rejectAll")?e={accept:[]}:n>0?e=i:t>0&&0===n&&(e=o);var s={};return s[this.get("dataviewId")]=e,s},getAcceptedCategoryNames:function(){return this.acceptedCategories.map(function(e){return e.get("name")})},getRejectedCategoryNames:function(){return this.rejectedCategories.map(function(e){return e.get("name")})}})},function(e,t,n){"use strict";var r=n(0),i=n(2);e.exports=i.extend({defaults:{url:"",totalCount:0,categoriesCount:0},url:function(){var e=this.get("url"),t=[];if(this.get("apiKey"))e+="?api_key="+this.get("apiKey");else if(this.get("authToken")){var n=this.get("authToken");n instanceof Array?r.each(n,function(e){t.push("auth_token[]="+e)}):t.push("auth_token="+n),e+="?"+t.join("&")}return e},initialize:function(){this.bind("change:url",function(){this.fetch()},this)},setUrl:function(e){this.set("url",e)},parse:function(e){return{categoriesCount:e.categoriesCount,totalCount:r.reduce(r.pluck(e.categories,"value"),function(e,t){return e+t},0)}}})},function(e,t,n){"use strict";var r=n(2);e.exports=r.extend({defaults:{name:"",agg:!1,value:0}})},function(e,t,n){"use strict";var r=n(0),i=n(2),o=n(19),s=n(33);e.exports=i.extend({defaults:{q:"",data:[],url:""},url:function(){var e=this.get("url")+"/search?q="+encodeURIComponent(this.get("q"));if(this.get("apiKey"))e+="&api_key="+this.get("apiKey");else if(this.get("authToken")){var t=this.get("authToken");t instanceof Array?r.each(t,function(t){e+="&auth_token[]="+t}):e+="&auth_token="+t}return e},initialize:function(e,t){this._data=new s(null,{aggregationModel:t.aggregationModel}),this.sync=o.bind(this)},fetchIfSearchIsApplied:function(){this.isSearchApplied()&&this.fetch()},setData:function(e){var t=this._parseData(e);this._data.reset(t),this.set("data",t)},getData:function(){return this._data},getSize:function(){return this._data.size()},getCount:function(){return this.getSize()},isValid:function(){return!!this.get("q")},resetData:function(){this.setData([]),this.set("q","")},getSearchQuery:function(){return this.get("q")},isSearchApplied:function(){return this.isValid()&&this.getSize()>0},_parseData:function(e){var t=[];return r.each(e,function(e){e.agg||t.push({selected:!1,name:(e.category||e.name).toString(),agg:e.agg,value:e.value})},this),t},parse:function(e){var t=this._parseData(e.categories);return this._data.reset(t),{data:t}},fetch:function(e){if(e=e||{},this.trigger("loading",this),e.success)var t=e&&e.success;return i.prototype.fetch.call(this,r.extend(e,{success:function(){t&&t(arguments),this.trigger("loaded",this)}.bind(this),error:function(e,t){(!t||t&&"abort"!==t.statusText)&&this.trigger("error",e,t)}.bind(this)}))}})},function(e,t,n){"use strict";var r=n(0),i=n(20),o=n(74),s=n(72),a=n(33);e.exports=i.extend({defaults:r.extend({type:"category",filterEnabled:!1,categories:6,allCategoryNames:[]},i.prototype.defaults),_getDataviewSpecificURLParams:function(){return["own_filter="+(this.get("filterEnabled")?1:0),"categories="+this.get("categories")]},initialize:function(e,t){i.prototype.initialize.call(this,e,t),this._rangeModel=new s({apiKey:this._engine.getApiKey(),authToken:this._engine.getAuthToken()}),this._data=new a(null,{aggregationModel:this}),this._searchModel=new o({apiKey:this._engine.getApiKey(),authToken:this._engine.getAuthToken()},{aggregationModel:this}),this.on("change:column change:aggregation change:aggregation_column",this._reloadAndForceFetch,this),this.on("change:categories",this.refresh,this),this.bind("change:url",function(){this._searchModel.set({url:this.get("url")})},this),this.once("change:url",function(){this._rangeModel.setUrl(this.get("url"))},this),this._rangeModel.bind("change:totalCount change:categoriesCount",function(){this.set({totalCount:this._rangeModel.get("totalCount"),categoriesCount:this._rangeModel.get("categoriesCount")})},this),this._bindSearchModelEvents(),e&&e.acceptedCategories&&this.filter.accept(e.acceptedCategories)},_onMapBoundsChanged:function(){i.prototype._onMapBoundsChanged.apply(this,arguments),this._searchModel.fetchIfSearchIsApplied()},_onCircleChanged:function(){i.prototype._onCircleChanged.apply(this,arguments),this._searchModel.fetchIfSearchIsApplied()},_onPolygonChanged:function(){i.prototype._onPolygonChanged.apply(this,arguments),this._searchModel.fetchIfSearchIsApplied()},_bindSearchModelEvents:function(){this.listenTo(this._searchModel,"loading",function(){this.trigger("loading",this)},this),this.listenTo(this._searchModel,"loaded",function(){this.trigger("loaded",this)},this),this.listenTo(this._searchModel,"error",function(e,t){(!t||t&&"abort"!==t.statusText)&&this.trigger("error",e,t)},this),this.listenTo(this._searchModel,"change:data",this._onSearchDataChange,this)},_onSearchDataChange:function(){this.getSearchResult().each(function(e){var t=this.filter.isAccepted(e.get("name"));e.set("selected",t)},this),this.trigger("change:searchData",this)},_shouldFetchOnBoundingBoxChange:function(){return i.prototype._shouldFetchOnBoundingBoxChange.call(this)&&!this.isSearchApplied()},_shouldFetchOnCircleChange:function(){return i.prototype._shouldFetchOnCircleChange.call(this)&&!this.isSearchApplied()},_shouldFetchOnPolygonChange:function(){return i.prototype._shouldFetchOnPolygonChange.call(this)&&!this.isSearchApplied()},enableFilter:function(){this.set("filterEnabled",!0)},disableFilter:function(){this.set("filterEnabled",!1)},getSearchQuery:function(){return this._searchModel.getSearchQuery()},setSearchQuery:function(e){this._searchModel.set("q",e)},isSearchValid:function(){return this._searchModel.isValid()},getSearchResult:function(){return this._searchModel.getData()},getSearchCount:function(){return this._searchModel.getCount()},applySearch:function(){this._searchModel.fetch()},isSearchApplied:function(){return this._searchModel.isSearchApplied()},cleanSearch:function(){this._searchModel.resetData()},setupSearch:function(){this.isSearchApplied()||this._searchModel.setData(this._data.toJSON())},getData:function(){return this._data},getSize:function(){return this._data.size()},getCount:function(){return this.get("categoriesCount")},isOtherAvailable:function(){return this._data.isOtherAvailable()},numberOfAcceptedCategories:function(){var e=this.filter.acceptedCategories,t=this.numberOfRejectedCategories(),n=this.getData(),r=n.size(),i=n.reduce(function(t,n){return t+(e.where({name:n.get("name")}).length>0?1:0)},0);return t?r-t:i},numberOfRejectedCategories:function(){var e=this.filter.rejectedCategories;return this.getData().reduce(function(t,n){return t+(e.where({name:n.get("name")}).length>0?1:0)},0)},refresh:function(){this.isSearchApplied()?this._searchModel.fetch():this.fetch()},parse:function(e){var t=[],n={},i=e.categories,o=[],s=[];return r.each(i,function(e){var r=e.category;o.push(r);var i=this.filter.isRejected(r);n[r]=!0,t.push({selected:!i,name:r,agg:e.agg,value:e.value})},this),this.get("filterEnabled")&&this.filter.acceptedCategories.each(function(e){var r=e.get("name");s.push(r),n[r]||t.push({selected:!0,name:r,agg:!1,value:0})},this),this._data.reset(t),{allCategoryNames:r.chain(o).union(s).unique().value(),data:t,nulls:e.nulls,min:e.min,max:e.max,count:e.count}},toJSON:function(){return{type:"aggregation",source:{id:this.getSourceId()},options:{column:this.get("column"),aggregation:this.get("aggregation"),aggregationColumn:this.get("aggregation_column")}}}},{ATTRS_NAMES:i.ATTRS_NAMES.concat(["column","aggregation","aggregation_column","acceptedCategories","categories"])})},function(e,t,n){"use strict";var r=n(0),i=n(10),o=n(5),s=n(75),a=n(71),u=n(69);function c(e,t,n){this.DEFAULTS.operationColumn=t,this._initialize(e,t,n),this._limit=this._options.limit,this._operation=this._options.operation,this._operationColumn=this._options.operationColumn}c.prototype=Object.create(i.prototype),c.prototype.setLimit=function(e){return this._checkLimit(e),this._changeProperty("limit",e,"categories"),this},c.prototype.getLimit=function(){return this._limit},c.prototype.setOperation=function(e){return this._checkOperation(e),this._changeProperty("operation",e,"aggregation"),this},c.prototype.getOperation=function(){return this._operation},c.prototype.setOperationColumn=function(e){return this._checkOperationColumn(e),this._changeProperty("operationColumn",e,"aggregation_column"),this},c.prototype.getOperationColumn=function(){return this._operationColumn},c.prototype.getData=function(){return this._internalModel?u(this._internalModel.get("data"),this._internalModel.get("count"),this._internalModel.get("max"),this._internalModel.get("min"),this._internalModel.get("nulls"),this._operation):null},c.prototype.DEFAULTS={limit:6,operation:o.operation.COUNT},c.prototype._checkOptions=function(e){if(r.isUndefined(e))throw this._getValidationError("categoryOptionsRequired");this._checkLimit(e.limit),this._checkOperation(e.operation),this._checkOperationColumn(e.operationColumn)},c.prototype._checkLimit=function(e){if(r.isUndefined(e))throw this._getValidationError("categoryLimitRequired");if(!r.isNumber(e))throw this._getValidationError("categoryLimitNumber");if(e<=0)throw this._getValidationError("categoryLimitPositive")},c.prototype._checkOperation=function(e){if(r.isUndefined(e)||!o.isValidOperation(e))throw this._getValidationError("categoryInvalidOperation")},c.prototype._checkOperationColumn=function(e){if(r.isUndefined(e))throw this._getValidationError("categoryOperationRequired");if(!r.isString(e))throw this._getValidationError("categoryOperationString");if(r.isEmpty(e))throw this._getValidationError("categoryOperationEmpty")},c.prototype._createInternalModel=function(e){this._internalModel=new s({source:this._source.$getInternalModel(),column:this._column,aggregation:this._operation,aggregation_column:this._operationColumn,categories:this._limit,sync_on_bbox_change:!!this._boundingBoxFilter,sync_on_circle_change:!!this._circleFilter,sync_on_polygon_change:!!this._polygonFilter,enabled:this._enabled},{engine:e,filter:new a,bboxFilter:this._boundingBoxFilter&&this._boundingBoxFilter.$getInternalModel(),circleFilter:this._circleFilter&&this._circleFilter.$getInternalModel(),polygonFilter:this._polygonFilter&&this._polygonFilter.$getInternalModel()})},e.exports=c},function(e,t,n){"use strict";var r=n(76),i=n(68),o=n(65),s=n(61),a=n(5).status,u=n(5).timeAggregation;e.exports={Category:r,Formula:i,Histogram:o,TimeSeries:s,status:a,timeAggregation:u}},function(e,t,n){"use strict";var r=n(0),i=n(38),o=n(3),s=n(4),a="contentChanged";function u(e){l(e),this._content=e}function c(e){return this.trigger(a,this._content),Promise.resolve(this._content)}function l(e){if(!e)throw new o("style","requiredCSS");if(!r.isString(e))throw new o("style","requiredCSSString")}u.prototype=Object.create(i.prototype),u.prototype.getContent=function(){return this._content},u.prototype.setContent=function(e){return l(e),this._content=e,this.trigger("$changed",this),this._engine?this._engine.reload().then(function(){return c.call(this,e)}.bind(this)).catch(function(e){return Promise.reject(new s(e))}):c.call(this,e)},e.exports=u},function(e,t,n){"use strict";var r=n(78);e.exports={CartoCSS:r}},function(e,t,n){"use strict";var r=n(0),i=n(12),o=n(9),s=n(28),a=n(3),u=n(4);function c(e){var t=this;l(e),this._query=e,i.apply(this,arguments),this._appliedFilters.on("change:filters",function(){return t._updateInternalModelQuery(t._getQueryToApply())})}function l(e){if(!e)throw new a("source","requiredQuery");if(!r.isString(e))throw new a("source","requiredString")}c.prototype=Object.create(i.prototype),c.prototype.setQuery=function(e){l(e),this._query=e;var t=this._getQueryToApply();return this._internalModel?this._updateInternalModelQuery(t):(this._triggerQueryChanged(this,t),Promise.resolve())},c.prototype.getQuery=function(){return this._query},c.prototype._createInternalModel=function(e){var t=new o({id:this.getId(),type:"source",query:this._getQueryToApply()},{camshaftReference:s,engine:e});return t.on("change:query",this._triggerQueryChanged,this),t},c.prototype._updateInternalModelQuery=function(e){var t=this;if(this._internalModel)return this._internalModel.set("query",e,{silent:!0}),this._internalModel._engine.reload().then(function(){return t._triggerQueryChanged(t,e)}).catch(function(e){return Promise.reject(new u(e))})},c.prototype._getQueryToApply=function(){var e=this._appliedFilters.$getSQL();return!this._hasFiltersApplied||r.isEmpty(e)?this._query:"SELECT * FROM ("+this._query+") as originalQuery WHERE "+e},c.prototype.addFilter=function(e){i.prototype.addFilter.apply(this,arguments),this._updateInternalModelQuery(this._getQueryToApply())},c.prototype.removeFilter=function(e){i.prototype.removeFilter.apply(this,arguments),this._updateInternalModelQuery(this._getQueryToApply())},c.prototype._triggerQueryChanged=function(e,t){this.trigger("queryChanged",t)},e.exports=c},function(e,t,n){"use strict";var r=n(0),i=n(12),o=n(9),s=n(28),a=n(3),u=n(4);function c(e){var t=this;l(e),this._tableName=e,i.apply(this,arguments),this._appliedFilters.on("change:filters",function(){return t._updateInternalModelQuery(t._getQueryToApply())})}function l(e){if(r.isUndefined(e))throw new a("source","noDatasetName");if(!r.isString(e))throw new a("source","requiredDatasetString");if(r.isEmpty(e))throw new a("source","requiredDataset")}c.prototype=Object.create(i.prototype),c.prototype.setTableName=function(e){return l(e),this._tableName=e,this._internalModel?this._updateInternalModelQuery(this._getQueryToApply()):(this._triggerTableNameChanged(this,e),Promise.resolve())},c.prototype.getTableName=function(){return this._tableName},c.prototype._createInternalModel=function(e){return new o({id:this.getId(),type:"source",query:this._getQueryToApply()},{camshaftReference:s,engine:e})},c.prototype._updateInternalModelQuery=function(e){var t=this;if(this._internalModel)return this._internalModel.set("query",e,{silent:!0}),this._internalModel._engine.reload().then(function(){return t._triggerTableNameChanged(t,t._tableName)}).catch(function(e){return Promise.reject(new u(e))})},c.prototype._getQueryToApply=function(){var e=this._appliedFilters.$getSQL(),t="SELECT * from "+this._tableName;return r.isEmpty(e)?t:"SELECT * FROM ("+t+") as datasetQuery WHERE "+e},c.prototype.addFilter=function(e){i.prototype.addFilter.apply(this,arguments),this._updateInternalModelQuery(this._getQueryToApply())},c.prototype.removeFilter=function(e){i.prototype.removeFilter.apply(this,arguments),this._updateInternalModelQuery(this._getQueryToApply())},c.prototype._triggerTableNameChanged=function(e,t){this.trigger("tableNameChanged",t)},e.exports=c},function(e,t,n){"use strict";var r=n(81),i=n(80);e.exports={Dataset:r,SQL:i}},function(e,t,n){"use strict";function r(){}function i(e){this.t0=null,this.name=e,this.count=0}r.metrics={},r._backend=null,r.get=function(e){return r.metrics[e]||{max:0,min:Number.MAX_VALUE,avg:0,total:0,count:0,last:0,history:"undefined"!=typeof Float32Array?new Float32Array(1024):[]}},r.backend=function(e){r._backend=e},r.new_value=function(e,t,n,i){n=n||"i";var o=r.metrics[e]=r.get(e);if(o.max=Math.max(o.max,t),o.min=Math.min(o.min,t),o.total+=t,++o.count,o.avg=o.total/o.count,o.history[o.count%1024]=t,i){var s=performance.now();s-o.last>1e3&&(r._backend&&r._backend([n,e,o.avg]),o.last=s)}else r._backend&&r._backend([n,e,t])},r.print_stats=function(){for(var e in r.metrics){var t=r.metrics[e];console.log(" === "+e+" === "),console.log(" max: "+t.max),console.log(" min: "+t.min),console.log(" avg: "+t.avg),console.log(" count: "+t.count),console.log(" total: "+t.total)}},i.prototype={start:function(){return this.t0=performance.now(),this},_elapsed:function(){return performance.now()-this.t0},end:function(e){null!==this.t0&&(r.new_value(this.name,this._elapsed(),"t",e),this.t0=null)},inc:function(e){e=void 0===e?1:e,r.new_value(this.name,e,"i")},dec:function(e){e=void 0===e?1:e,r.new_value(this.name,e,"d")},mark:function(){(++this.count,null!==this.t0)?this._elapsed()>1&&(r.new_value(this.name,this.count),this.count=0,this.start()):this.start()}},r.metric=function(e){return new i(e)},e.exports=r},function(e,t,n){"use strict";function r(e){this.setMap(e)}r.prototype=new google.maps.OverlayView,r.prototype.draw=function(){},r.prototype.latLngToPixel=function(e){var t=this.getProjection();return t?t.fromLatLngToContainerPixel(e):(console.warn("Projector has no projection"),new google.maps.Point(0,0))},r.prototype.pixelToLatLng=function(e){var t=this.getProjection();return t?t.fromContainerPixelToLatLng(e):(console.warn("Projector has no projection"),new google.maps.LatLng(0,0))},e.exports=r},function(e,t,n){"use strict";var r=n(0),i=n(1),o=function(e,t){t=t||{},this.model=e,this.model.bind("change",this._onModelUpdated,this),this.mapModel=t.mapModel,this.gmapsMap=t.nativeMap,this.showLimitErrors=t.showLimitErrors};r.extend(o.prototype,i.Events),r.extend(o.prototype,{addToMap:function(){throw new Error("Subclasses of GMapsLayerView must implement addToMap")},remove:function(){throw new Error("Subclasses of GMapsLayerView must implement remove")},_onModelUpdated:function(){}}),e.exports=o},function(e,t,n){"use strict";var r=n(0),i=n(85),o=n(34),s=n(24),a=n(84),u=n(35),c=n(83),l="progid:DXImageTransform.Microsoft.gradient(startColorstr=#00FFFFFF,endColorstr=#00FFFFFF)",h="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function f(e,t){var n=Math.round(100*t);e.style.filter=n>=99?l:"alpha(opacity="+t+");"}var p=function(e,t){var n=this,o=[],s=t.nativeMap;r.bindAll(this,"featureOut","featureOver","featureClick");var c=r.clone(e.attributes);c.map=s;var l,h=c.featureOver,f=c.featureOut,p=c.featureClick,d=-1;c.featureOver=function(e,t,r,i,s){o[s]||n.trigger("layerenter",e,t,r,i,s),o[s]=1,h&&h.apply(this,arguments),n.featureOver&&n.featureOver.apply(this,arguments),e.timeStamp===l&&clearTimeout(d),d=setTimeout(function(){n.trigger("mouseover",e,t,r,i,s),n.trigger("layermouseover",e,t,r,i,s)},0),l=e.timeStamp},c.featureOut=function(e,t){o[t]&&n.trigger("layermouseout",t),o[t]=0,r.any(o)||n.trigger("mouseout"),f&&f.apply(this,arguments),n.featureOut&&n.featureOut.apply(this,arguments)},c.featureClick=r.debounce(function(){p&&p.apply(this,arguments),n.featureClick&&n.featureClick.apply(c,arguments)},10),this.tiles=0,this.options={tiles:t.tiles,scheme:t.scheme||"xyz",blankImage:t.blankImage||"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},this._id=(4294967296*(1+Math.random())|0).toString(16).substring(1),this.interactive=!0,this.tileSize=new google.maps.Size(256,256),this.cache={},r.extend(this.options,c),i.apply(this,arguments),this.projector=new a(c.map),u.apply(this,arguments)};p.prototype.interactionClass=o.Interactive,r.extend(p.prototype,u.prototype,i.prototype,{addToMap:function(){this.gmapsMap.overlayMapTypes.setAt(0,this)},remove:function(){var e=this._getOverlayIndex();e>=0&&this.gmapsMap.overlayMapTypes.removeAt(e),this._clearInteraction(),this.finishLoading&&this.finishLoading()},reload:function(){this.model.invalidate()},featureOver:function(e,t,n,r,i){var o=this.model.getLayerInLayerGroupAt(i);o&&this.trigger("featureOver",{layer:o,layerIndex:i,latlng:[t.lat(),t.lng()],position:{x:n.x,y:n.y},feature:r})},featureOut:function(e,t){var n=this.model.getLayerInLayerGroupAt(t);n&&this.trigger("featureOut",{layer:n,layerIndex:t})},featureClick:function(e,t,n,r,i){var o=this.model.getLayerInLayerGroupAt(i);o&&this.trigger("featureClick",{layer:o,layerIndex:i,latlng:[t.lat(),t.lng()],position:{x:n.x,y:n.y},feature:r})},error:function(e){this.model&&(this.model.trigger("error",e?e.errors:"unknown error"),this.model.trigger("tileError",e?e.errors:"unknown error"))},ok:function(e){this.model.trigger("tileOk")},tilesOk:function(e){this.model.trigger("tileOk")},loading:function(){this.trigger("loading")},finishLoading:function(){this.trigger("load")},setOpacity:function(e){if(isNaN(e)||e>1||e<0)throw new Error(e+" is not a valid value, should be in [0, 1] range");for(var t in this.opacity=this.options.opacity=e,this.cache){var n=this.cache[t];n.style.opacity=e,f(n,e)}},getTile:function(e,t,n){var r=this,i="ActiveXObject"in window&&!document.addEventListener;if(this.options.added=!0,!this.model.hasTileURLTemplates()){var o=t+"/"+e.x+"/"+e.y,a=this.cache[o]=new Image(256,256);return a.src=h,a.setAttribute("gTileKey",o),a.style.opacity=this.options.opacity,a}var u=this._getTile(e,t,n);i&&f(u,this.options.opacity),u.style.opacity=this.options.opacity,0===this.tiles&&this.loading&&this.loading(),this.tiles++;var l=c.metric("cartodb-js.tile.png.load.time").start(),p=function(){l.end(),r.tiles--,0===r.tiles&&r.finishLoading&&r.finishLoading()};return u.onload=p,u.onerror=function(){c.metric("cartodb-js.tile.png.error").inc(),r.model.addError({type:s.WINDSHAFT_ERRORS.TILE}),p()},u},_getTile:function(e,t,n){var r=t+"/"+e.x+"/"+e.y;if(!this.cache[r]){var i=this.cache[r]=new Image(256,256);this.cache[r].src=this._getTileUrl(e,t),this.cache[r].setAttribute("gTileKey",r),this.cache[r].onerror=function(){i.style.display="none"}}return this.cache[r]},_getTileUrl:function(e,t){var n=Math.pow(2,t),r="tms"===this.options.scheme?n-1-e.y:e.y,i=e.x%n;return i=i<0?e.x%n+n:i,r<0?this.options.blankImage:this.options.tiles[parseInt(i+r,10)%this.options.tiles.length].replace(/\{z\}/g,t).replace(/\{x\}/g,i).replace(/\{y\}/g,r)},_reload:function(){var e;e=this.model.hasTileURLTemplates()?[this.model.getTileURLTemplatesWithSubdomains()[0]]:[h],this.options.tiles=e,this.tiles=0,this.cache={},this._reloadInteraction(),this._refreshView()},_refreshView:function(){var e=this.gmapsMap.overlayMapTypes,t=this._getOverlayIndex();t>=0&&e.setAt(t,e.getAt(t))},_checkLayer:function(){if(!this.options.added)throw new Error("the layer is not still added to the map")},_getOverlayIndex:function(){var e=this.gmapsMap.overlayMapTypes.getArray();return r.findIndex(e,function(e){return e&&e._id===this._id},this)},_newPoint:function(e,t){return new google.maps.Point(e,t)},_manageOffEvents:function(e,t){if(this.options.featureOut)return this.options.featureOut&&this.options.featureOut(t.e,t.layer)},_manageOnEvents:function(e,t){var n=t.pixel,r=this.projector.pixelToLatLng(n);switch(t.e.type.toLowerCase()){case"mousemove":if(this.options.featureOver)return this.options.featureOver(t.e,r,n,t.data,t.layer);break;case"click":case"touchend":case"touchmove":case"mspointerup":case"pointerup":case"pointermove":this.options.featureClick&&this.options.featureClick(t.e,r,n,t.data,t.layer)}}}),e.exports=p},function(e,t,n){"use strict";var r=n(0),i=n(23),o=n(36),s=n(86),a=n(4);function u(e,t,n){this._layers=e,this._engine=t,this._map=n,this._hoveredLayers=[],this.tileSize=new google.maps.Size(256,256),this._internalView=new s(this._engine._cartoLayerGroup,{nativeMap:n}),this._id=this._internalView._id,this._internalView.on("featureClick",this._onFeatureClick,this),this._internalView.on("featureOver",this._onFeatureOver,this),this._internalView.on("featureOut",this._onFeatureOut,this),this._internalView.on("featureError",this._onFeatureError,this)}u.prototype.getTile=function(e,t,n){return this._internalView.getTile(e,t,n)},u.prototype._onFeatureClick=function(e){var t=this._layers.findById(e.layer.id);o(i.events.FEATURE_CLICKED,e,t)},u.prototype._onFeatureOver=function(e){var t=this._layers.findById(e.layer.id);t.isInteractive()&&(this._hoveredLayers[e.layerIndex]=!0,this._map.setOptions({draggableCursor:"pointer"})),o(i.events.FEATURE_OVER,e,t)},u.prototype._onFeatureOut=function(e){var t=this._layers.findById(e.layer.id);this._hoveredLayers[e.layerIndex]=!1,r.any(this._hoveredLayers)?this._map.setOptions({draggableCursor:"pointer"}):this._map.setOptions({draggableCursor:"auto"}),o(i.events.FEATURE_OUT,e,t)},u.prototype._onFeatureError=function(e){var t=new a(e);r.each(this._layers.toArray(),function(e){e.isInteractive()&&e.trigger(i.events.TILE_ERROR,t)})},e.exports=u},function(e,t,n){"use strict";var r=n(0),i=n(1),o=function(e,t){t=t||{},this.model=e,this.mapModel=t.mapModel,this.leafletMap=t.nativeMap,this.leafletLayer=t.nativeLayer||this._createLeafletLayer(),this.showLimitErrors=t.showLimitErrors,this.setModel(e);var n=e.get("type")||e.get("kind");this.type=n&&n.toLowerCase()};r.extend(o.prototype,i.Events),r.extend(o.prototype,{setZIndex:function(e){this.leafletLayer.setZIndex(e)},setModel:function(e){this.model&&this.model.unbind("change",this._modelUpdated,this),this.model=e,this.model.bind("change",this._modelUpdated,this)},remove:function(){this.leafletMap.removeLayer(this.leafletLayer),this.notifyRemove()},notifyRemove:function(){this.trigger("remove",this),this.model.unbind(null,null,this),this.unbind()},reload:function(){this.leafletLayer.redraw()},_createLeafletLayer:function(){throw new Error("subclasses of LeafletLayerView must implement _createLeafletLayer")}}),e.exports=o},function(e,t,n){"use strict";var r=n(0),i=n(24),o=n(88),s=n(35),a=n(34),u=function(e,t){o.apply(this,arguments),s.apply(this,arguments),this.leafletLayer.on("load",function(){this.trigger("load")}.bind(this)),this.leafletLayer.on("loading",function(){this.trigger("loading")}.bind(this)),this.leafletLayer.on("tileerror",function(e){this.model.addError({type:i.WINDSHAFT_ERRORS.TILE})}.bind(this))};(u.prototype=r.extend({},o.prototype,s.prototype,{interactionClass:a.Interactive,_createLeafletLayer:function(){var e=new L.TileLayer(null,{opacity:.99,maxZoom:30});return e._setUrl=function(e,t){return L.TileLayer.prototype.setUrl.call(this,e,t)},e},_reload:function(){var e=this.model.getTileURLTemplate(),t=this.model.getSubdomains();e||(e="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"),t&&L.Util.setOptions(this.leafletLayer,{subdomains:t}),this.leafletLayer._setUrl(e),this._reloadInteraction()},_manageOffEvents:function(e,t){this._onFeatureOut(t.layer)},_manageOnEvents:function(e,t){var n=e.layerPointToContainerPoint(t.layerPoint);if(!n||isNaN(n.x)||isNaN(n.y))return!1;var r=e.containerPointToLatLng(n);switch(t.e.type.toLowerCase()){case"mousemove":this._onFeatureOver(r,n,t.data,t.layer);break;case"click":this._onFeatureClicked(r,n,t.data,t.layer)}},_onFeatureClicked:function(e,t,n,r){var i=this.model.getLayerInLayerGroupAt(r);i&&this.trigger("featureClick",{layer:i,layerIndex:r,latlng:[e.lat,e.lng],position:t,feature:n})},_onFeatureOver:function(e,t,n,r){var i=this.model.getLayerInLayerGroupAt(r);i&&this.trigger("featureOver",{layer:i,layerIndex:r,latlng:[e.lat,e.lng],position:t,feature:n})},_onFeatureOut:function(e){var t=this.model.getLayerInLayerGroupAt(e);t&&this.trigger("featureOut",{layer:t,layerIndex:e})}})).constructor=o,e.exports=u},function(e,t,n){"use strict";var r=n(0),i=n(3),o={AVG:"avg",SUM:"sum",MIN:"min",MAX:"max",MODE:"mode"},s={SAMPLE:"point-sample",GRID:"point-grid",CENTROID:"centroid"},a=[.5,1,2,4,8,16,32,64,128,256];function u(e){if(!r.isFinite(e.threshold))throw c("thresholdRequired");if(!r.isFinite(e.threshold)||e.threshold<1||Math.floor(e.threshold)!==e.threshold)throw c("invalidThreshold");if(!r.isFinite(e.resolution))throw c("resolutionRequired");if(!r.contains(a,e.resolution))throw c("invalidResolution");!function(e){if(e&&!r.contains(r.values(s),e))throw c("invalidPlacement")}(e.placement);var t=function(e){var t=null;e&&(!function(e){Object.keys(e).forEach(function(t){!function(e,t){if(!e[t].aggregatedColumn)throw c("columnAggregatedColumnRequired"+t);if(!r.isString(e[t].aggregatedColumn))throw c("invalidColumnAggregatedColumn"+t);if(!e[t].aggregateFunction)throw c("columnFunctionRequired"+t);if(!r.contains(r.values(o),e[t].aggregateFunction))throw c("invalidColumnFunction"+t)}(e,t)})}(e),t={},Object.keys(e).forEach(function(n){t[n]=function(e){return{aggregate_function:e.aggregateFunction,aggregated_column:e.aggregatedColumn}}(e[n])}));return t}(e.columns),n={threshold:e.threshold,resolution:e.resolution,placement:e.placement,columns:t};return r.pick(n,r.identity)}function c(e){return new i("aggregation",e)}u.operation=o,u.placement=s,e.exports=u},function(e,t,n){"use strict";e.exports={FEATURE_CLICKED:"featureClicked",FEATURE_OVER:"featureOver",FEATURE_OUT:"featureOut",TILE_ERROR:"featureError"}},function(e,t,n){"use strict";var r=n(37);function i(e){var t=e.getBucketsWithCategoryFilter(),n=e.getBucketsWithDefaultFilter();this._categories=t.map(function(e){return{name:e.filter.name,value:e.value}}),this._defaultValue=n.length>0?n[0].value:void 0,r.call(this,"categories",e)}i.prototype=Object.create(r.prototype),i.prototype.getCategories=function(){return this._categories},i.prototype.getDefaultValue=function(){return this._defaultValue},e.exports=i},function(e,t,n){"use strict";var r=n(37);function i(e){var t=e.getBucketsWithRangeFilter();this._buckets=t.map(function(e){return{min:e.filter.start,max:e.filter.end,value:e.value}}),this._avg=e.getFilterAvg(),this._min=t.length>0?t[0].filter.start:void 0,this._max=t.length>0?t[t.length-1].filter.end:void 0,r.call(this,"buckets",e)}i.prototype=Object.create(r.prototype),i.prototype.getBuckets=function(){return this._buckets},i.prototype.getAverage=function(){return this._avg},i.prototype.getMin=function(){return this._min},i.prototype.getMax=function(){return this._max},e.exports=i},function(e,t,n){"use strict";var r=n(93),i=n(92),o=n(15);e.exports={getMetadataFromRules:function(e){var t=[];return e.forEach(function(e){var n=new o(e);!function(e){return e.getBucketsWithRangeFilter().length>0}(n)?function(e){return e.getBucketsWithCategoryFilter().length>0}(n)&&t.push(new i(n)):t.push(new r(n))}),t}}},function(e,t,n){"use strict";var r=n(0);e.exports=function(e,t,n){var i=t.split(".").reduce(function(e,t){return(e||{})[t]},e);return r.isUndefined(i)?n:i}},function(e,t,n){"use strict";var r=n(0),i=n(22),o=i.extend({defaults:function(){return r.extend(i.prototype.defaults.apply(this),{type:"torque",items:[],html:""})}});e.exports=o},function(e,t,n){"use strict";var r=n(0),i=n(22),o=i.extend({defaults:function(){return r.extend(i.prototype.defaults.apply(this),{type:"custom_choropleth",prefix:"",suffix:"",leftLabel:"",rightLabel:"",colors:[]})}});e.exports=o},function(e,t,n){"use strict";var r=n(0),i=n(22),o=i.extend({defaults:function(){return r.extend(i.prototype.defaults.apply(this),{type:"custom",items:[],html:""})}});e.exports=o},function(e,t,n){"use strict";var r=n(0),i=n(13),o=i.extend({defaults:function(){return r.extend(i.prototype.defaults.apply(this),{type:"choropleth",prefix:"",suffix:"",leftLabel:"",rightLabel:"",colors:[]})},getNonResettableAttrs:function(){return r.union(i.prototype.getNonResettableAttrs.apply(this),["colors"])},isAvailable:function(){return this.get("colors")&&this.get("colors").length>0}});e.exports=o},function(e,t,n){"use strict";var r=n(0),i=n(13),o=i.extend({defaults:function(){return r.extend(i.prototype.defaults.apply(this),{type:"bubble",fillColor:"",prefix:"",suffix:"",values:[]})},getNonResettableAttrs:function(){return r.union(i.prototype.getNonResettableAttrs.apply(this),["values"])},isAvailable:function(){return this.get("values")&&this.get("values").length>0}});e.exports=o},function(e,t,n){"use strict";var r=n(0),i=n(13),o=i.extend({defaults:function(){return r.extend(i.prototype.defaults.apply(this),{type:"category",categories:[]})},getNonResettableAttrs:function(){return r.union(i.prototype.getNonResettableAttrs.apply(this),["categories"])},isAvailable:function(){return this.get("categories")&&this.get("categories").length>0}});e.exports=o},function(e,t,n){"use strict";var r=n(0),i=n(101),o=n(100),s=n(99),a=n(98),u={bubble:{modelClass:o,definitionAttrs:[{fillColor:"color"},{topLabel:"top_label"},{bottomLabel:"bottom_label"}],dynamic:!0},category:{modelClass:i,definitionAttrs:["prefix","suffix"],dynamic:!0},choropleth:{modelClass:s,definitionAttrs:["prefix","suffix",{leftLabel:"left_label"},{rightLabel:"right_label"}],dynamic:!0},custom:{modelClass:a,definitionAttrs:[{items:"categories"},"html"]},html:{modelClass:a,definitionAttrs:[{items:"categories"},"html"]},custom_choropleth:{modelClass:n(97),definitionAttrs:["prefix","suffix",{leftLabel:"left_label"},{rightLabel:"right_label"},"colors"]},torque:{modelClass:n(96),definitionAttrs:[{items:"categories"},"html"]}},c=["title",{preHTMLSnippet:"pre_html"},{postHTMLSnippet:"post_html"}],l=function(e,t){if(!t.engine)throw new Error("engine is required");this._legendsData=e||[],this._engine=t.engine,r.each(u,function(e,t){this[t]=this._createLegendModel(t,e)},this),this._findDataForLegend("html")&&(this.custom=this.html),delete this.html};l.prototype._createLegendModel=function(e,t){var n=t.modelClass,i=c.concat(t.definitionAttrs),o=this._findDataForLegend(e);o=o&&r.extend({},r.omit(o,"definition"),o.definition);var s={};r.each(i,function(e){var t=e,n=e;r.isObject(e)&&(t=e[n=Object.keys(e)[0]]),s[n]=o&&o[t]});var a=new n(s,{engine:this._engine});return o&&a.show(),a},l.prototype._findDataForLegend=function(e){return r.find(this._legendsData,{type:e})},l.prototype.hasAnyLegend=function(){var e=r.keys(u);return r.some(e,function(e){var t=this[e];return t&&t.isVisible()},this)},e.exports=l},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(39),s=i.Model.extend({defaults:{vertical_offset:0,horizontal_offset:0,position:"top|center",template:"",alternative_names:{}},initialize:function(e){e=e||{},this.fields=new o(e.fields||[]),this.unset("fields")},update:function(e){e=r.clone(e),this.fields.equals(e.fields)||this.fields.reset(e.fields),delete e.fields,e.alternative_names&&(e.alternative_names=JSON.parse(JSON.stringify(e.alternative_names))),this.set(e)},getFieldNames:function(){return this.fields.pluck("name")},hasFields:function(){return!this.fields.isEmpty()},hasTemplate:function(){return!!this.get("template")}});e.exports=s},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(39),s=i.Model.extend({defaults:{offset:[28,0],maxHeight:180,alternative_names:{},template_type:"mustache"},initialize:function(e){e=e||{},this.fields=new o(e.fields||[]),this.unset("fields")},update:function(e){e=r.clone(e),this.fields.equals(e.fields)||this.fields.reset(e.fields),delete e.fields,e.alternative_names&&(e.alternative_names=JSON.parse(JSON.stringify(e.alternative_names))),this.set(e)},getFieldNames:function(){return this.fields.pluck("name")},hasFields:function(){return!this.fields.isEmpty()},hasTemplate:function(){return!!this.get("template")}});e.exports=s},function(e,t,n){"use strict";var r=n(27),i=n(2).extend({initialize:function(){this.bind("change:type",function(){r.error("changing layer type is not allowed, remove it and add a new one instead")})},remove:function(e){e=e||{},this.trigger("destroy",this,this.collection,e)},update:function(e,t){t=t||{},this.set(e,{silent:t.silent})},show:function(){this.set("visible",!0)},hide:function(){this.set("visible",!1)},isVisible:function(){return!!this.get("visible")},isHidden:function(){return!this.isVisible()},toggle:function(){this.set("visible",!this.get("visible"))},setOk:function(){this.unset("error")},setError:function(e){this.set("error",e)},getSourceId:function(){throw new Error(".getSourceId called on a non torque/cartodb layer.")},hasSource:function(e){return!1}});e.exports=i},function(e,t,n){"use strict";var r=n(1).Model.extend({VERSION:4,initialize:function(){},REPORT_ERROR_URL:"/api/v0/error",ERROR_TRACK_ENABLED:!1});e.exports=r},function(e,t,n){"use strict";var r=new(n(106));r.set({cartodb_attributions:' <a href="https://carto.com/about-carto/" target="_blank">CARTO</a>',cartodb_logo_link:"http://www.carto.com"}),e.exports=r},function(e,t,n){"use strict";var r=n(0),i=n(107),o=n(105),s=n(104),a=n(103),u=n(102),c=n(9),l=["sql","source","sql_wrap","cartocss"],h=o.extend({defaults:{type:"CartoDB",attribution:i.get("cartodb_attributions"),visible:!0},initialize:function(e,t){if(e=e||{},!(t=t||{}).engine)throw new Error("engine is required");this._engine=t.engine,e&&e.cartocss&&this.set("initialStyle",e.cartocss),e.source&&this.setSource(e.source),this.infowindow=new s(e.infowindow),this.tooltip=new a(e.tooltip),this.unset("infowindow"),this.unset("tooltip"),this.legends=new u(e.legends,{engine:this._engine}),this.unset("legends"),this.bind("change",this._onAttributeChanged,this),this.infowindow.fields.bind("reset add remove",this._reload,this),this.tooltip.fields.bind("reset add remove",this._reload,this),this.aggregation=t.aggregation,o.prototype.initialize.apply(this,arguments)},_onAttributeChanged:function(){r.any(l,function(e){if(this.hasChanged(e))return!0},this)&&this._reload()},_reload:function(){this._engine.reload({sourceId:this.get("id")})},restoreCartoCSS:function(){this.set("cartocss",this.get("initialStyle"))},isVisible:function(){return this.get("visible")},isInteractive:function(){return this._hasInfowindowFields()||this._hasTooltipFields()},_hasInfowindowFields:function(){return this.infowindow.hasFields()},_hasTooltipFields:function(){return this.tooltip.hasFields()},getInteractiveColumnNames:function(){return r.chain(["cartodb_id"]).union(this.infowindow.getFieldNames()).union(this.tooltip.getFieldNames()).uniq().value()},isInfowindowEnabled:function(){return this.infowindow.hasTemplate()},isTooltipEnabled:function(){return this.tooltip.hasTemplate()},getName:function(){return this.get("layer_name")},getEstimatedFeatureCount:function(){var e=this.get("meta"),t=e&&e.stats;return t&&t.estimatedFeatureCount},getSourceId:function(){var e=this.getSource();return e&&e.id},getSource:function(){return this.get("source")},setSource:function(e,t){this.getSource()&&this.getSource().unmarkAsSourceOf(this),e.markAsSourceOf(this),this.set("source",e,t)},hasSource:function(e){return this.getSource().equals(e)},update:function(e){if(e.source)throw new Error('Use ".setSource" to update a layer\'s source instead of the update method');o.prototype.update.apply(this,arguments)},remove:function(){this.getSource().unmarkAsSourceOf(this),o.prototype.remove.apply(this,arguments)},getTableName:function(){if(this.get("source").has("options"))return this.get("source").get("options").table_name},getApiKey:function(){return this._engine.getApiKey()}},{_checkSourceAttribute:function(e){if(!(e instanceof c))throw new Error("Source must be an instance of AnalysisModel")}});e.exports=h},function(e,t,n){"use strict";var r=n(0),i=n(40),o=n(108),s=n(12),a=n(38),u=n(4),c=n(3),l=n(14),h=n(94);function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i.apply(this,arguments),g(e),d(t),this._client=void 0,this._engine=void 0,this._internalModel=void 0,this._source=e,this._style=t,this._visible=!r.isBoolean(n.visible)||n.visible,this._featureClickColumns=n.featureClickColumns||[],this._featureOverColumns=n.featureOverColumns||[],this._minzoom=n.minzoom||0,this._maxzoom=n.maxzoom||void 0,this._aggregation=n.aggregation||{},function(e,t,n){var r=e&&Object.keys(e)||[];v(r,t,"featureClick"),v(r,n,"featureOver")}(this._aggregation.columns,this._featureClickColumns,this._featureOverColumns)}function p(e){return{fields:e.map(function(e,t){return{name:e,title:!0,position:t}})}}function d(e){if(!(e instanceof a))throw new c("layer","nonValidStyle")}function g(e){if(!(e instanceof s))throw new c("layer","nonValidSource")}function m(e){if(r.any(e,function(e){return!r.isString(e)}))throw new c("layer","nonValidColumns")}function y(e){var t=new u(e);return this.trigger(l.ERROR,t),Promise.reject(t)}function _(e,t){return e.length===t.length&&r.isEmpty(r.difference(e,t))}function v(e,t,n){if(t.length>0&&e.length>0){var i=r.filter(t,function(t){return!r.contains(e,t)});if(i.length>0)throw new c("layer","wrongInteractivityColumns["+i.join(", ")+"]#"+n)}}f.prototype=Object.create(i.prototype),f.prototype.setStyle=function(e,t){var n=this._style;if(d(e),t=t||{},n===e)return Promise.resolve();if(!this._internalModel)return this._style=e,this.trigger("styleChanged",this),Promise.resolve();if(e.$getEngine()&&e.$getEngine()!==this._internalModel._engine)throw new c("layer","differentStyleClient");return e.$getEngine()||e.$setEngine(this._engine),this._internalModel.set("cartocss",e.getContent(),{silent:!0}),this._engine.reload().then(function(){this._style=e,this.trigger("styleChanged",this)}.bind(this)).catch(y.bind(this))},f.prototype.getStyle=function(){return this._style},f.prototype.setSource=function(e){var t=this._source;if(g(e),t===e)return Promise.resolve();if(!this._internalModel)return this._source=e,this.trigger("sourceChanged",this),Promise.resolve();if(e.$getEngine()&&e.$getEngine()!==this._internalModel._engine)throw new c("layer","differentSourceClient");return e.$getEngine()||e.$setEngine(this._engine),this._internalModel.set("source",e.$getInternalModel(),{silent:!0}),this._engine.reload().then(function(){this._source=e,this.trigger("sourceChanged",this)}.bind(this)).catch(y.bind(this))},f.prototype.getSource=function(){return this._source},f.prototype.setFeatureClickColumns=function(e){var t=this._featureClickColumns;return m(e),_(e,t)?Promise.resolve():this._internalModel?(this._internalModel.infowindow.fields.set(p(e).fields,{silent:!0}),this._engine.reload().then(function(){this._featureClickColumns=e}.bind(this)).catch(y.bind(this))):(this._featureClickColumns=e,Promise.resolve())},f.prototype.getFeatureClickColumns=function(){return this._featureClickColumns},f.prototype.setFeatureOverColumns=function(e){var t=this._featureOverColumns;return m(e),_(e,t)?Promise.resolve():this._internalModel?(this._internalModel.tooltip.fields.set(p(e).fields,{silent:!0}),this._engine.reload().then(function(){this._featureOverColumns=e}.bind(this)).catch(y.bind(this))):(this._featureOverColumns=e,Promise.resolve())},f.prototype.getFeatureOverColumns=function(){return this._featureOverColumns},f.prototype.hide=function(){var e=this._visible;return this._visible=!1,this._internalModel&&this._internalModel.set("visible",!1),e&&this.trigger("visibilityChanged",!1),this},f.prototype.show=function(){var e=this._visible;return this._visible=!0,this._internalModel&&this._internalModel.set("visible",!0),e||this.trigger("visibilityChanged",!1),this},f.prototype.toggle=function(){return this.isVisible()?this.hide():this.show()},f.prototype.isVisible=function(){return this._visible},f.prototype.isHidden=function(){return!this.isVisible()},f.prototype.isInteractive=function(){return this.getFeatureClickColumns().length>0||this.getFeatureOverColumns().length>0},f.prototype.setOrder=function(e){return this._client?this._client.moveLayer(this,e):Promise.resolve()},f.prototype.bringToBack=function(){return this.setOrder(0)},f.prototype.bringToFront=function(){return this.setOrder(this._client._layers.size()-1)},f.prototype._createInternalModel=function(e){var t=new o({id:this._id,source:this._source.$getInternalModel(),cartocss:this._style.getContent(),visible:this._visible,infowindow:p(this._featureClickColumns),tooltip:p(this._featureOverColumns),minzoom:this._minzoom,maxzoom:this._maxzoom},{engine:e,aggregation:this._aggregation});return t.on("change:meta",function(e,t){var n=t.cartocss_meta.rules,r={styles:h.getMetadataFromRules(n)};this.trigger("metadataChanged",r)},this),t.on("change:error",function(e,t){t&&function(e){return e.message&&e.message.indexOf("style")>=0}(t)?this._style.$setError(new u(t)):t&&this.trigger(l.ERROR,new u(t))},this),t},f.prototype.$setClient=function(e){this._client||this._engine&&e._engine!==this._engine||(this._client=e)},f.prototype.$setEngine=function(e){this._engine||(this._engine=e,this._source.$setEngine(e),this._style.$setEngine(e),this._internalModel||(this._internalModel=this._createInternalModel(e),this._style.on("$changed",function(e){this._internalModel.set("cartocss",e.getContent(),{silent:!0})},this)))},e.exports=f},function(e,t,n){"use strict";var r=n(0),i=n(23),o=n(5),s=n(36),a=n(89),u=n(4),c=L.TileLayer.extend({options:{opacity:.99,maxZoom:30,attribution:o.ATTRIBUTION},initialize:function(e,t,n){r.extend(this.options,n),this._layers=e,this._engine=t,this._internalView=null,this._hoveredLayers=[]},addTo:function(e){return this._internalView||(this._internalView=new a(this._engine._cartoLayerGroup,{nativeMap:e,nativeLayer:this}),this._internalView.on("featureClick",this._onFeatureClick,this),this._internalView.on("featureOver",this._onFeatureOver,this),this._internalView.on("featureOut",this._onFeatureOut,this),this._internalView.on("featureError",this._onFeatureError,this)),L.TileLayer.prototype.addTo.call(this,e)},removeFrom:function(e){return this._internalView&&(this._internalView.off("featureClick"),this._internalView.off("featureOver"),this._internalView.off("featureOut"),this._internalView.off("featureError"),this._internalView.notifyRemove()),this._internalView=null,L.TileLayer.prototype.removeFrom.call(this,e)},setUrl:void 0,_setUrl:function(e,t){return L.TileLayer.prototype.setUrl.call(this,e,t)},_onFeatureClick:function(e){var t=this._layers.findById(e.layer.id);s(i.events.FEATURE_CLICKED,e,t)},_onFeatureOver:function(e){var t=this._layers.findById(e.layer.id);t.isInteractive()&&(this._hoveredLayers[e.layerIndex]=!0,this._map.getContainer().style.cursor="pointer"),s(i.events.FEATURE_OVER,e,t)},_onFeatureOut:function(e){var t=this._layers.findById(e.layer.id);this._hoveredLayers[e.layerIndex]=!1,r.any(this._hoveredLayers)?this._map.getContainer().style.cursor="pointer":this._map.getContainer().style.cursor="auto",s(i.events.FEATURE_OUT,e,t)},_onFeatureError:function(e){var t=new u(e);r.each(this._layers.toArray(),function(e){e.isInteractive()&&e.trigger(i.events.TILE_ERROR,t)})}});e.exports=c},function(e,t,n){"use strict";var r=n(0);function i(e){this._layers=e||[]}i.prototype.add=function(e){return this._layers.push(e),e},i.prototype.remove=function(e){return this._layers.splice(this._layers.indexOf(e),1)},i.prototype.size=function(){return this._layers.length},i.prototype.indexOf=function(e){return this._layers.indexOf(e)},i.prototype.contains=function(e){return this._layers.indexOf(e)>=0},i.prototype.findById=function(e){return r.find(this._layers,function(t){return t.getId()===e},this)},i.prototype.toArray=function(){return this._layers},i.prototype.move=function(e,t){var n=this._layers.indexOf(e);n>=0&&n!==t&&this._layers.splice(t,0,this._layers.splice(n,1)[0])},e.exports=i},function(e,t,n){"use strict";var r=n(0),i=function(e){this._maxNumberOfRequests=e||3,this.reset()};i.prototype.track=function(e,t){this.lastRequestEquals(e)&&this.lastResponseEquals(t)||this.reset(),this.maxNumberOfRequestsReached()||(this._lastRequest=e,this._lastResponse=t,this._numberOfRequests+=1)},i.prototype.reset=function(){this._lastRequest=void 0,this._lastResponse=void 0,this._numberOfRequests=0},i.prototype.canRequestBePerformed=function(e){return!this.maxNumberOfRequestsReached()||this.maxNumberOfRequestsReached()&&!this.lastRequestEquals(e)},i.prototype.maxNumberOfRequestsReached=function(){return this._numberOfRequests===this._maxNumberOfRequests},i.prototype.lastRequestEquals=function(e){return this._lastRequest&&this._lastRequest.equals(e)},i.prototype.lastResponseEquals=function(e){return r.isEqual(this._lastResponse,e)},e.exports=i},function(e,t){var n=function(){var e,t=1,n=2;function r(e,t){postMessage({action:3,callback_num:t,result:e})}var i,o,s,a=[0,-0x8000000000000000],u=[4294967295,-4294967296],c=[0,0],l=[1,0],h=[4,0],f=[4096,0],p=[16777215,0],d=[16777216,0],g=[4278190080,0],m=[4294967295,0],y=[4294967295,0x7fffffff00000000];function _(){}function v(){}function b(){}function w(e,t){return e.detailMessage=t,e}function x(){}function C(){}function E(e,t){e[e.explicitLength++]=t}function S(e,t){e[e.explicitLength++]=t}function T(e,t,n,r,i){var a;return a=function(e,t){var n=new Array(t);if(e>0)for(var r=[null,0,!1,[0,0]][e],i=0;i<t;++i)n[i]=r;return n}(i,r),k(),L(a,o,s),a.arrayClass$=e,a.typeId$=t,a.queryId$=n,a}function A(e,t,n){if(null!=n){if(e.queryId$>0&&!R(n.typeId$,e.queryId$))throw new Fe;if(e.queryId$<0&&(n.typeMarker$==Fn||2==n.typeId$))throw new Fe}return e[t]=n}function M(){}function k(){k=Fn,o=[],s=[],function(e,t,n){var r,i=0;for(var o in e)(r=e[o])&&(t[i]=o,n[i]=r,++i)}(new M,o,s)}function L(e,t,n){k();for(var r=0,i=t.length;r<i;++r)e[t[r]]=n[r]}function O(e,t){return e&&!!J[e][t]}function R(e,t){return e&&J[e][t]}function F(e,t){if(null!=e&&!R(e.typeId$,t))throw new Ne;return e}function P(e,t){return null!=e&&O(e.typeId$,t)}function B(e){return~~Math.max(Math.min(e,2147483647),-2147483648)}(i=_.prototype={}).getClass$=function(){return Pn},i.typeMarker$=Fn,i.typeId$=1,(i=v.prototype=new _).getClass$=function(){return Bn},i.typeId$=3,i.detailMessage=null,(i=b.prototype=new v).getClass$=function(){return In},i.typeId$=4,(i=x.prototype=new b).getClass$=function(){return Nn},i.typeId$=5,(i=C.prototype=new x).getClass$=function(){return Dn},i.typeId$=6,(i=M.prototype=new _).getClass$=function(){return this.arrayClass$},i.typeId$=0,i.arrayClass$=null,i.length=0,i.queryId$=0;var I,N,D,j,q,z,U,$,H,G,V,W,J=[{},{},{1:1},{2:1},{2:1},{2:1},{2:1},{2:1,10:1},{2:1},{2:1},{2:1},{2:1},{2:1},{2:1,11:1},{2:1},{2:1},{2:1},{4:1},{5:1},{6:1},{7:1},{8:1},{9:1}];function Q(e){return null!=e&&O(e.typeId$,2)?e:function(e,t){return e}(new C)}function K(e,t){var n;return n=e[1]+t[1],ee(e[0]+t[0],n)}function Z(e,t,n){return 0==t?e:0==n?e:K(e,ee(t*n,0))}function Y(e,t){return function(e,t){var n,r;n=4294967296*e,r=t,t<0&&(r+=4294967296);return[r,n]}(~~Math.max(Math.min(e[1]/4294967296,2147483647),-2147483648)&~~Math.max(Math.min(t[1]/4294967296,2147483647),-2147483648),se(e)&se(t))}function X(e,t){var n,r;return e[0]==t[0]&&e[1]==t[1]?0:(n=e[1]<0,r=t[1]<0,n&&!r?-1:!n&&r?1:pe(e,t)[1]<0?-1:1)}function ee(e,t){var n,r;for(e%=0x10000000000000000,t=(t%=0x10000000000000000)-(n=t%4294967296)+(r=4294967296*Math.floor(e/4294967296)),e=e-r+n;e<0;)e+=4294967296,t-=4294967296;for(;e>4294967295;)e-=4294967296,t+=4294967296;for(t%=0x10000000000000000;t>0x7fffffff00000000;)t-=0x10000000000000000;for(;t<-0x8000000000000000;)t+=0x10000000000000000;return[e,t]}function te(e,t){var n,r,i,o,s;if(0==t[0]&&0==t[1])throw function(e,t){return e.detailMessage=t,e}(new Oe,"/ by zero");if(0==e[0]&&0==e[1])return me(),H;if(ne(e,(me(),j)))return ne(t,z)||ne(t,q)?j:K(n=he(te(fe(e,1),t),1),te(o=pe(e,ae(t,n)),t));if(ne(t,j))return H;if(e[1]<0)return t[1]<0?te(ce(e),ce(t)):ce(te(ce(e),t));if(t[1]<0)return ce(te(e,ce(t)));for(s=H,o=e;X(o,t)>=0;)0==(i=re(Math.floor(de(o)/ge(t))))[0]&&0==i[1]&&(i=z),r=ae(i,t),s=K(s,i),o=pe(o,r);return s}function ne(e,t){return e[0]==t[0]&&e[1]==t[1]}function re(e){return isNaN(e)?(me(),H):e<-0x8000000000000000?(me(),j):e>=0x8000000000000000?(me(),D):ee(e>0?Math.floor(e):Math.ceil(e),0)}function ie(e){var t,n;return e>-129&&e<128?(t=e+128,null==(n=(function(){Fn;I=T(qn,0,9,256,0)}(),I)[t])&&(n=I[t]=oe(e)),n):oe(e)}function oe(e){return e>=0?[e,0]:[e+4294967296,-4294967296]}function se(e){return e[0]>=2147483648?~~Math.max(Math.min(e[0]-4294967296,2147483647),-2147483648):~~Math.max(Math.min(e[0],2147483647),-2147483648)}function ae(e,t){var n,r,i,o,s,a,u,c;return 0==e[0]&&0==e[1]?(me(),H):0==t[0]&&0==t[1]?(me(),H):ne(e,(me(),j))?ue(t):ne(t,j)?ue(e):e[1]<0?t[1]<0?ae(ce(e),ce(t)):ce(ae(ce(e),t)):t[1]<0?ce(ae(e,ce(t))):X(e,$)<0&&X(t,$)<0?ee((e[1]+e[0])*(t[1]+t[0]),0):(i=e[1]%281474976710656,o=e[1]-i,n=e[0]%65536,r=e[0]-n,u=t[1]%281474976710656,c=t[1]-u,s=t[0]%65536,a=t[0]-s,Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(H,o,s),i,a),i,s),r,u),r,a),r,s),n,c),n,u),n,a),n,s))}function ue(e){return 1==(1&se(e))?(me(),j):(me(),H)}function ce(e){var t,n;return ne(e,(me(),j))?j:(t=-e[1],(n=-e[0])>4294967295&&(n-=4294967296,t+=4294967296),n<0&&(n+=4294967296,t-=4294967296),[n,t])}function le(e){return e<=30?1<<e:le(30)*le(e-30)}function he(e,t){var n,r,i,o;return t&=63,ne(e,(me(),j))?0==t?e:H:e[1]<0?ce(he(ce(e),t)):(o=le(t),r=e[1]*o%0x10000000000000000,i=e[0]*o,i-=n=i-i%4294967296,(r+=n)>=0x8000000000000000&&(r-=0x10000000000000000),[i,r])}function fe(e,t){var n,r;return r=le(t&=63),n=e[1]/r,ee(Math.floor(e[0]/r),n)}function pe(e,t){var n;return n=e[1]-t[1],ee(e[0]-t[0],n)}function de(e){var t,n;return(t=B(Math.log(e[1])/(me(),N)))<=48?e[1]+e[0]:(n=(1<<t-48)-1,e[1]+(e[0]-n))}function ge(e){var t,n;return(t=B(Math.log(e[1])/(me(),N)))<=48?e[1]+e[0]:(n=(1<<t-48)-1,e[1]+(e[0]+n))}function me(){me=Fn,N=Math.log(2),D=y,j=a,q=ie(-1),z=ie(1),U=ie(2),$=d,H=ie(0)}function ye(){}function _e(e,t){return function(e,t,n,r){e.buf=t,e.pos=n,e.count=n+r,e.count>t.length&&(e.count=t.length)}(e,t,0,t.length),e}function ve(e){return e.pos>=e.count?-1:255&e.buf[e.pos++]}function be(e,t,n,r){return e.pos>=e.count?-1:(r=He(r,e.count-e.pos),We(e.buf,e.pos,t,n,r),e.pos+=r,r)}function we(){}function xe(){}function Ce(e){return e.buf=T($n,0,-1,32,1),e}function Ee(e,t){var n;t<=e.buf.length||(t=$e(t,2*e.buf.length),n=T($n,0,-1,t,1),We(e.buf,0,n,0,e.buf.length),e.buf=n)}function Se(e){var t;return t=T($n,0,-1,e.count,1),We(e.buf,0,t,0,e.count),t}function Te(e,t){Ee(e,e.count+1),e.buf[e.count++]=t<<24>>24}function Ae(e,t,n,r){Ee(e,e.count+r),We(t,n,e.buf,e.count,r),e.count+=r}function Me(){}function ke(e,t){return e.detailMessage=t,e}function Le(){}function Oe(){}function Re(e,t){return e.detailMessage=t,e}function Fe(){}function Pe(e,t){var n;return(n=new Ie).typeName=e+t,n}function Be(e,t){var n;return(n=new Ie).typeName=e+t,n}function Ie(){}function Ne(){}function De(){}function je(e,t){return e.detailMessage=t,e}function qe(){}function ze(){}function Ue(){}function $e(e,t){return e>t?e:t}function He(e,t){return e<t?e:t}function Ge(){}function Ve(){}function We(e,t,n,r,i){var o,s,a,u,c,l,h,f;if(null==e||null==n)throw new Ge;if(h=(e.typeMarker$==Fn||2==e.typeId$?e.getClass$():jn).typeName,a=(n.typeMarker$==Fn||2==n.typeId$?n.getClass$():jn).typeName,91!=h.charCodeAt(0)||91!=a.charCodeAt(0))throw Re(new Fe,"Must be array types");if(h.charCodeAt(1)!=a.charCodeAt(1))throw Re(new Fe,"Array types must match");if(f=e.length,u=n.length,t<0||r<0||i<0||t+i>f||r+i>u)throw new Ue;if(76!=h.charCodeAt(1)&&91!=h.charCodeAt(1)||function(e,t){return null!=t&&String(e)==t}(h,a))for(c=0;c<i;++c)n[r+c]=e[t+c];else if(l=F(e,3),o=F(n,3),(null==e?null:e)===(null==n?null:n)&&t<r)for(t+=i,s=r+i;s-- >r;)A(o,s,l[--t]);else for(s=r+i;r<s;)A(o,r++,l[t++])}function Je(e){var t;try{return yt(e.chunker)}catch(t){if(P(t=Q(t),10))return!1;throw t}}function Qe(e,t,n,r,i){var o,s;if(!i)throw je(new qe,"null mode");if(X(r,u)<0)throw je(new qe,"invalid length "+function e(t){var n,r,i,o,s,a;if(0==t[0]&&0==t[1])return"0";if(ne(t,(me(),j)))return"-9223372036854775808";if(t[1]<0)return"-"+e(ce(t));for(r=t,o="";0!=r[0]||0!=r[1];){if(n=""+se(pe(r,ae(i=te(r,s=ie(1e9)),s))),0!=(r=i)[0]||0!=r[1])for(a=9-n.length;a>0;--a)n="0"+n;o=n+o}return o}(r));for(e.length_0=r,function(e,t){if(!function(e,t){var n;if(t<1||t>536870912)return!1;for(e._dictionarySize=t,n=0;t>1<<n;++n);return e._distTableSize=2*n,!0}(t,1<<e.dictionarySize))throw w(new x,"unexpected failure");if(!function(e,t){return!(t<5||t>273)&&(e._numFastBytes=t,!0)}(t,e.fb))throw w(new x,"unexpected failure");if(!function(e,t){var n;return!(t<0||t>2)&&(n=e._matchFinderType,e._matchFinderType=t,e._matchFinder&&n!=e._matchFinderType&&(e._dictionarySizePrev=-1,e._matchFinder=null),!0)}(t,e.matchFinder))throw w(new x,"unexpected failure");if(!function(e,t,n,r){return!(n<0||n>4||t<0||t>8||r<0||r>4)&&(e._numLiteralPosStateBits=n,e._numLiteralContextBits=t,e._posStateBits=r,e._posStateMask=(1<<e._posStateBits)-1,!0)}(t,e.lc,e.lp,e.pb))throw w(new x,"unexpected failure")}(i,o=function(e){var t;for(Mt(),e._repDistances=T(nr,0,-1,4,1),e._optimum=T(yr,0,6,4096,0),e._rangeEncoder=(vn(),new Tn),e._isMatch=T(lr,0,-1,192,1),e._isRep=T(lr,0,-1,12,1),e._isRepG0=T(lr,0,-1,12,1),e._isRepG1=T(lr,0,-1,12,1),e._isRepG2=T(lr,0,-1,12,1),e._isRep0Long=T(lr,0,-1,192,1),e._posSlotEncoder=T(_r,0,8,4,0),e._posEncoders=T(lr,0,-1,114,1),e._posAlignEncoder=un(new gn,4),e._lenEncoder=Gt(new Jt),e._repMatchLenEncoder=Gt(new Jt),e._literalEncoder=new Kt,e._matchDistances=T(nr,0,-1,548,1),e._posSlotPrices=T(nr,0,-1,256,1),e._distancesPrices=T(nr,0,-1,512,1),e._alignPrices=T(nr,0,-1,16,1),e.reps=T(nr,0,-1,4,1),e.repLens=T(nr,0,-1,4,1),e.processedInSize=T(vr,0,-1,1,3),e.processedOutSize=T(vr,0,-1,1,3),e.finished=T(br,0,-1,1,2),e.properties=T($n,0,-1,5,1),e.tempPrices=T(nr,0,-1,128,1),t=0;t<4096;++t)e._optimum[t]=new rn;for(t=0;t<4;++t)e._posSlotEncoder[t]=un(new gn,6);return e}(new qt)),o._writeEndMark=!0,function(e,t){var n;for(e.properties[0]=9*(5*e._posStateBits+e._numLiteralPosStateBits)+e._numLiteralContextBits<<24>>24,n=0;n<4;++n)e.properties[1+n]=e._dictionarySize>>8*n<<24>>24;Ae(t,e.properties,0,5)}(o,n),s=0;s<64;s+=8)Te(n,255&se(fe(r,s)));e.chunker=(o._needReleaseMFStream=!1,o._inStream=t,o._finished=!1,function(e){var t,n;e._matchFinder||(ut(),t=new ht,n=4,0==e._matchFinderType&&(n=2),function(e,t){e.HASH_ARRAY=t>2,e.HASH_ARRAY?(e.kNumHashDirectBytes=0,e.kMinMatchCheck=4,e.kFixHashSize=66560):(e.kNumHashDirectBytes=2,e.kMinMatchCheck=3,e.kFixHashSize=0)}(t,n),e._matchFinder=t);if(function(e,t,n){var r,i;if(null==e.m_Coders||e.m_NumPrevBits!=n||e.m_NumPosBits!=t)for(e.m_NumPosBits=t,e.m_PosMask=(1<<t)-1,e.m_NumPrevBits=n,i=1<<e.m_NumPrevBits+e.m_NumPosBits,e.m_Coders=T(xr,0,5,i,0),r=0;r<i;++r)e.m_Coders[r]=Xt(new tn)}(e._literalEncoder,e._numLiteralPosStateBits,e._numLiteralContextBits),e._dictionarySize==e._dictionarySizePrev&&e._numFastBytesPrev==e._numFastBytes)return;(function(e,t,n,r,i){var o,s;if(t>1073741567)return!1;e._cutValue=16+(r>>1),function(e,t,n,r){var i;e._keepSizeBefore=t,e._keepSizeAfter=n,i=t+n+r,(null==e._bufferBase||e._blockSize!=i)&&(e._bufferBase=null,e._blockSize=i,e._bufferBase=T($n,0,-1,e._blockSize,1)),e._pointerToLastSafePosition=e._blockSize-n}(e,t+n,r+i,256+~~((t+n+r+i)/2)),e._matchMaxLen=r,o=t+1,e._cyclicBufferSize!=o&&(e._son=T(nr,0,-1,2*(e._cyclicBufferSize=o),1));s=65536,e.HASH_ARRAY&&(s=t-1,s|=s>>1,s|=s>>2,s|=s>>4,s|=s>>8,s>>=1,(s|=65535)>16777216&&(s>>=1),e._hashMask=s,++s,s+=e.kFixHashSize);s!=e._hashSizeSum&&(e._hash=T(nr,0,-1,e._hashSizeSum=s,1))})(e._matchFinder,e._dictionarySize,4096,e._numFastBytes,274),e._dictionarySizePrev=e._dictionarySize,e._numFastBytesPrev=e._numFastBytes}(o),o._rangeEncoder.Stream=n,function(e){var t;for(function(e){var t;for(e._state=0,e._previousByte=0,t=0;t<4;++t)e._repDistances[t]=0}(e),function(e){e._position=c,e.Low=c,e.Range=-1,e._cacheSize=1,e._cache=0}(e._rangeEncoder),Sn(e._isMatch),Sn(e._isRep0Long),Sn(e._isRep),Sn(e._isRepG0),Sn(e._isRepG1),Sn(e._isRepG2),Sn(e._posEncoders),function(e){var t,n;for(n=1<<e.m_NumPrevBits+e.m_NumPosBits,t=0;t<n;++t)Sn(e.m_Coders[t].m_Encoders)}(e._literalEncoder),t=0;t<4;++t)yn(e._posSlotEncoder[t].Models);zt(e._lenEncoder,1<<e._posStateBits),zt(e._repMatchLenEncoder,1<<e._posStateBits),yn(e._posAlignEncoder.Models),e._longestMatchWasFound=!1,e._optimumEndIndex=0,e._optimumCurrentIndex=0,e._additionalOffset=0}(o),Ot(o),Lt(o),o._lenEncoder._tableSize=o._numFastBytes+1-2,Wt(o._lenEncoder,1<<o._posStateBits),o._repMatchLenEncoder._tableSize=o._numFastBytes+1-2,Wt(o._repMatchLenEncoder,1<<o._posStateBits),o.nowPos64=c,function(e,t){return e.encoder=t,e.decoder=null,e.alive=!0,e}(new _t,o))}function Ke(){}function Ze(){}function Ye(e){var t,n;try{return yt(e.chunker)}catch(t){if(P(t=Q(t),10))return n=t,e.exception=n,!1;throw t}}function Xe(e,t,n){var r,i,o,s,a,l="";for(o=T($n,0,-1,5,1),i=0;i<o.length;++i){if(-1==(s=ve(t)))throw ke(new Le,"truncated input");o[i]=s<<24>>24}if(!function(e,t){var n,r,i,o,s,a,u;if(t.length<5)return!1;for(u=255&t[0],i=u%9,o=(a=~~(u/9))%5,s=~~(a/5),n=0,r=0;r<4;++r)n+=(255&t[1+r])<<8*r;if(!function(e,t,n,r){var i;if(t>8||n>4||r>4)return!1;return function(e,t,n){var r,i;if(null==e.m_Coders||e.m_NumPrevBits!=n||e.m_NumPosBits!=t)for(e.m_NumPosBits=t,e.m_PosMask=(1<<t)-1,e.m_NumPrevBits=n,i=1<<e.m_NumPrevBits+e.m_NumPosBits,e.m_Coders=T(dr,0,4,i,0),r=0;r<i;++r)e.m_Coders[r]=Tt(new At)}(e.m_LiteralDecoder,n,t),i=1<<r,bt(e.m_LenDecoder,i),bt(e.m_RepLenDecoder,i),e.m_PosStateMask=i-1,!0}(e,i,o,s))return!1;return function(e,t){if(t<0)return!1;e.m_DictionarySize!=t&&(e.m_DictionarySize=t,e.m_DictionarySizeCheck=$e(e.m_DictionarySize,1),function(e,t){null!=e._buffer&&e._windowSize==t||(e._buffer=T($n,0,-1,t,1));e._windowSize=t,e._pos=0,e._streamPos=0}(e.m_OutWindow,$e(e.m_DictionarySizeCheck,4096)));return!0}(e,n)}(r=function(e){var t;for(e.m_OutWindow=new dt,e.m_RangeDecoder=new _n,e.m_IsMatchDecoders=T(lr,0,-1,192,1),e.m_IsRepDecoders=T(lr,0,-1,12,1),e.m_IsRepG0Decoders=T(lr,0,-1,12,1),e.m_IsRepG1Decoders=T(lr,0,-1,12,1),e.m_IsRepG2Decoders=T(lr,0,-1,12,1),e.m_IsRep0LongDecoders=T(lr,0,-1,192,1),e.m_PosSlotDecoder=T(hr,0,7,4,0),e.m_PosDecoders=T(lr,0,-1,114,1),e.m_PosAlignDecoder=on(new an,4),e.m_LenDecoder=xt(new Et),e.m_RepLenDecoder=xt(new Et),e.m_LiteralDecoder=new St,t=0;t<4;++t)e.m_PosSlotDecoder[t]=on(new an,6);return e}(new vt),o))throw ke(new Le,"corrupted input");for(i=0;i<64;i+=8){if(-1==(s=ve(t)))throw ke(new Le,"truncated input");1==(s=s.toString(16)).length&&(s="0"+s),l=s+""+l}"ffffffffffffffffff"==l.toLowerCase()||0==l?e.length_0=u:(a=parseInt(l,16),e.length_0=a>4294967295?u:re(a)),e.chunker=function(e,t,n,r){return e.m_RangeDecoder.Stream=t,function(e,t){ft(e),e._stream=null,e._stream=t}(e.m_OutWindow,n),function(e){var t;for(function(e,t){t||(e._streamPos=0,e._pos=0)}(e.m_OutWindow,!1),yn(e.m_IsMatchDecoders),yn(e.m_IsRep0LongDecoders),yn(e.m_IsRepDecoders),yn(e.m_IsRepG0Decoders),yn(e.m_IsRepG1Decoders),yn(e.m_IsRepG2Decoders),yn(e.m_PosDecoders),function(e){var t,n;for(n=1<<e.m_NumPrevBits+e.m_NumPosBits,t=0;t<n;++t)yn(e.m_Coders[t].m_Decoders)}(e.m_LiteralDecoder),t=0;t<4;++t)yn(e.m_PosSlotDecoder[t].Models);Ct(e.m_LenDecoder),Ct(e.m_RepLenDecoder),yn(e.m_PosAlignDecoder.Models),function(e){var t;for(e.Code=0,e.Range=-1,t=0;t<5;++t)e.Code=e.Code<<8|ve(e.Stream)}(e.m_RangeDecoder)}(e),e.state=0,e.rep0=0,e.rep1=0,e.rep2=0,e.rep3=0,e.outSize=r,e.nowPos64=c,e.prevByte=0,function(e,t){return e.decoder=t,e.encoder=null,e.alive=!0,e}(new _t,e)}(r,t,n,e.length_0)}function et(){}function tt(){}function nt(e,t){return e._bufferBase[e._bufferOffset+e._pos+t]}function rt(e,t,n,r){var i,o;for(e._streamEndWasReached&&e._pos+t+r>e._streamPos&&(r=e._streamPos-(e._pos+t)),++n,o=e._bufferOffset+e._pos+t,i=0;i<r&&e._bufferBase[o+i]==e._bufferBase[o+i-n];++i);return i}function it(e){return e._streamPos-e._pos}function ot(e){var t,n;if(!e._streamEndWasReached)for(;;){if(0==(n=-e._bufferOffset+e._blockSize-e._streamPos))return;if(-1==(t=be(e._stream,e._bufferBase,e._bufferOffset+e._streamPos,n)))return e._posLimit=e._streamPos,e._bufferOffset+e._posLimit>e._pointerToLastSafePosition&&(e._posLimit=e._pointerToLastSafePosition-e._bufferOffset),void(e._streamEndWasReached=!0);e._streamPos+=t,e._streamPos>=e._pos+e._keepSizeAfter&&(e._posLimit=e._streamPos-e._keepSizeAfter)}}function st(e,t){e._bufferOffset+=t,e._posLimit-=t,e._pos-=t,e._streamPos-=t}function at(){}function ut(){var e,t,n;for(ut=Fn,G=T(nr,0,-1,256,1),e=0;e<256;++e){for(n=e,t=0;t<8;++t)0!=(1&n)?n=n>>>1^-306674912:n>>>=1;G[e]=n}}function ct(e){var t;++e._cyclicBufferPos>=e._cyclicBufferSize&&(e._cyclicBufferPos=0),function(e){++e._pos,e._pos>e._posLimit&&(e._bufferOffset+e._pos>e._pointerToLastSafePosition&&function(e){var t,n,r;for((r=e._bufferOffset+e._pos-e._keepSizeBefore)>0&&--r,n=e._bufferOffset+e._streamPos-r,t=0;t<n;++t)e._bufferBase[t]=e._bufferBase[r+t];e._bufferOffset-=r}(e),ot(e))}(e),1073741823==e._pos&&(t=e._pos-e._cyclicBufferSize,lt(e._son,2*e._cyclicBufferSize,t),lt(e._hash,e._hashSizeSum,t),st(e,t))}function lt(e,t,n){var r,i;for(r=0;r<t;++r)(i=e[r])<=n?i=0:i-=n,e[r]=i}function ht(){}function ft(e){var t;0!=(t=e._pos-e._streamPos)&&(Ae(e._stream,e._buffer,e._streamPos,t),e._pos>=e._windowSize&&(e._pos=0),e._streamPos=e._pos)}function pt(e,t){var n;return(n=e._pos-t-1)<0&&(n+=e._windowSize),e._buffer[n]}function dt(){}function gt(e){return(e-=2)<4?e:3}function mt(e){return e<4?0:e<10?e-3:e-6}function yt(e){var t;if(!e.alive)throw new ze;t=!0;try{return e.encoder?function(e){(function(e,t,n,r){var i,o,s,a,u,h,p,d,g,m,y,_,v,b,w;if(t[0]=c,n[0]=c,r[0]=!0,e._inStream&&(e._matchFinder._stream=e._inStream,function(e){var t;for(e._bufferOffset=0,e._pos=0,e._streamPos=0,e._streamEndWasReached=!1,ot(e),t=0;t<e._hashSizeSum;++t)e._hash[t]=0;e._cyclicBufferPos=0,st(e,-1)}(e._matchFinder),e._needReleaseMFStream=!0,e._inStream=null),!e._finished){if(e._finished=!0,b=e.nowPos64,ne(e.nowPos64,c)){if(0==it(e._matchFinder))return void Rt(e,se(e.nowPos64));Nt(e),v=se(e.nowPos64)&e._posStateMask,bn(e._rangeEncoder,e._isMatch,(e._state<<4)+v,0),e._state=mt(e._state),s=nt(e._matchFinder,-e._additionalOffset),Zt(Qt(e._literalEncoder,se(e.nowPos64),e._previousByte),e._rangeEncoder,s),e._previousByte=s,--e._additionalOffset,e.nowPos64=K(e.nowPos64,l)}if(0!=it(e._matchFinder))for(;;){if(p=Ft(e,se(e.nowPos64)),m=e.backRes,v=se(e.nowPos64)&e._posStateMask,o=(e._state<<4)+v,1==p&&-1==m)bn(e._rangeEncoder,e._isMatch,o,0),s=nt(e._matchFinder,-e._additionalOffset),w=Qt(e._literalEncoder,se(e.nowPos64),e._previousByte),e._state<7?Zt(w,e._rangeEncoder,s):(g=nt(e._matchFinder,-e._repDistances[0]-1-e._additionalOffset),Yt(w,e._rangeEncoder,g,s)),e._previousByte=s,e._state=mt(e._state);else{if(bn(e._rangeEncoder,e._isMatch,o,1),m<4){if(bn(e._rangeEncoder,e._isRep,e._state,1),0==m?(bn(e._rangeEncoder,e._isRepG0,e._state,0),bn(e._rangeEncoder,e._isRep0Long,o,1==p?0:1)):(bn(e._rangeEncoder,e._isRepG0,e._state,1),1==m?bn(e._rangeEncoder,e._isRepG1,e._state,0):(bn(e._rangeEncoder,e._isRepG1,e._state,1),bn(e._rangeEncoder,e._isRepG2,e._state,m-2))),1==p?e._state=e._state<7?9:11:(Ht(e._repMatchLenEncoder,e._rangeEncoder,p-2,v),e._state=e._state<7?8:11),a=e._repDistances[m],0!=m){for(h=m;h>=1;--h)e._repDistances[h]=e._repDistances[h-1];e._repDistances[0]=a}}else{for(bn(e._rangeEncoder,e._isRep,e._state,0),e._state=e._state<7?7:10,Ht(e._lenEncoder,e._rangeEncoder,p-2,v),_=jt(m-=4),d=gt(p),cn(e._posSlotEncoder[d],e._rangeEncoder,_),_>=4&&(y=m-(i=(2|1&_)<<(u=(_>>1)-1)),_<14?pn(e._posEncoders,i-_-1,e._rangeEncoder,u,y):(wn(e._rangeEncoder,y>>4,u-4),hn(e._posAlignEncoder,e._rangeEncoder,15&y),++e._alignPriceCount)),a=m,h=3;h>=1;--h)e._repDistances[h]=e._repDistances[h-1];e._repDistances[0]=a,++e._matchPriceCount}e._previousByte=nt(e._matchFinder,p-1-e._additionalOffset)}if(e._additionalOffset-=p,e.nowPos64=K(e.nowPos64,ie(p)),0==e._additionalOffset){if(e._matchPriceCount>=128&&Ot(e),e._alignPriceCount>=16&&Lt(e),t[0]=e.nowPos64,n[0]=xn(e._rangeEncoder),0==it(e._matchFinder))return void Rt(e,se(e.nowPos64));if(X(pe(e.nowPos64,b),f)>=0)return e._finished=!1,void(r[0]=!1)}}else Rt(e,se(e.nowPos64))}})(e.encoder,e.encoder.processedInSize,e.encoder.processedOutSize,e.encoder.finished),e.inBytesProcessed=e.encoder.processedInSize[0],e.encoder.finished[0]&&(!function(e){Dt(e),e._rangeEncoder.Stream=null}(e.encoder),e.alive=!1)}(e):function(e){var t;if(-1==(t=function(e){var t,n,r,i,o,s;if(s=se(e.nowPos64)&e.m_PosStateMask,0==mn(e.m_RangeDecoder,e.m_IsMatchDecoders,(e.state<<4)+s))t=function(e,t,n){return e.m_Coders[((t&e.m_PosMask)<<e.m_NumPrevBits)+((255&n)>>>8-e.m_NumPrevBits)]}(e.m_LiteralDecoder,se(e.nowPos64),e.prevByte),e.state<7?e.prevByte=function(e,t){var n;n=1;do{n=n<<1|mn(t,e.m_Decoders,n)}while(n<256);return n<<24>>24}(t,e.m_RangeDecoder):e.prevByte=function(e,t,n){var r,i,o;o=1;do{if(i=n>>7&1,n<<=1,r=mn(t,e.m_Decoders,(1+i<<8)+o),o=o<<1|r,i!=r){for(;o<256;)o=o<<1|mn(t,e.m_Decoders,o);break}}while(o<256);return o<<24>>24}(t,e.m_RangeDecoder,pt(e.m_OutWindow,e.rep0)),function(e,t){e._buffer[e._pos++]=t,e._pos>=e._windowSize&&ft(e)}(e.m_OutWindow,e.prevByte),e.state=mt(e.state),e.nowPos64=K(e.nowPos64,l);else{if(1==mn(e.m_RangeDecoder,e.m_IsRepDecoders,e.state))r=0,0==mn(e.m_RangeDecoder,e.m_IsRepG0Decoders,e.state)?0==mn(e.m_RangeDecoder,e.m_IsRep0LongDecoders,(e.state<<4)+s)&&(e.state=e.state<7?9:11,r=1):(0==mn(e.m_RangeDecoder,e.m_IsRepG1Decoders,e.state)?n=e.rep1:(0==mn(e.m_RangeDecoder,e.m_IsRepG2Decoders,e.state)?n=e.rep2:(n=e.rep3,e.rep3=e.rep2),e.rep2=e.rep1),e.rep1=e.rep0,e.rep0=n),0==r&&(r=wt(e.m_RepLenDecoder,e.m_RangeDecoder,s)+2,e.state=e.state<7?8:11);else if(e.rep3=e.rep2,e.rep2=e.rep1,e.rep1=e.rep0,r=2+wt(e.m_LenDecoder,e.m_RangeDecoder,s),e.state=e.state<7?7:10,(o=sn(e.m_PosSlotDecoder[gt(r)],e.m_RangeDecoder))>=4){if(i=(o>>1)-1,e.rep0=(2|1&o)<<i,o<14)e.rep0+=function(e,t,n,r){var i,o,s,a;for(s=1,a=0,o=0;o<r;++o)i=mn(n,e,t+s),s<<=1,s+=i,a|=i<<o;return a}(e.m_PosDecoders,e.rep0-o-1,e.m_RangeDecoder,i);else if(e.rep0+=function(e,t){var n,r,i;for(r=0,n=t;0!=n;--n)e.Range>>>=1,i=e.Code-e.Range>>>31,e.Code-=e.Range&i-1,r=r<<1|1-i,0==(-16777216&e.Range)&&(e.Code=e.Code<<8|ve(e.Stream),e.Range<<=8);return r}(e.m_RangeDecoder,i-4)<<4,e.rep0+=function(e,t){var n,r,i,o;for(i=1,o=0,r=0;r<e.NumBitLevels;++r)n=mn(t,e.Models,i),i<<=1,i+=n,o|=n<<r;return o}(e.m_PosAlignDecoder,e.m_RangeDecoder),e.rep0<0)return-1==e.rep0?1:-1}else e.rep0=o;if(X(ie(e.rep0),e.nowPos64)>=0||e.rep0>=e.m_DictionarySizeCheck)return-1;!function(e,t,n){var r;for((r=e._pos-t-1)<0&&(r+=e._windowSize);0!=n;--n)r>=e._windowSize&&(r=0),e._buffer[e._pos++]=e._buffer[r++],e._pos>=e._windowSize&&ft(e)}(e.m_OutWindow,e.rep0,r),e.nowPos64=K(e.nowPos64,ie(r)),e.prevByte=pt(e.m_OutWindow,0)}return 0}(e.decoder)))throw ke(new Le,"corrupted input");e.inBytesProcessed=u,e.outBytesProcessed=e.decoder.nowPos64,(1==t||X(e.decoder.outSize,c)>=0&&X(e.decoder.nowPos64,e.decoder.outSize)>=0)&&(!function(e){ft(e.m_OutWindow),function(e){ft(e),e._stream=null}(e.m_OutWindow),e.m_RangeDecoder.Stream=null}(e.decoder),e.alive=!1)}(e),t=!1,e.alive}finally{t&&(e.alive=!1)}}function _t(){}function vt(){}function bt(e,t){for(;e.m_NumPosStates<t;++e.m_NumPosStates)e.m_LowCoder[e.m_NumPosStates]=on(new an,3),e.m_MidCoder[e.m_NumPosStates]=on(new an,3)}function wt(e,t,n){var r;return 0==mn(t,e.m_Choice,0)?sn(e.m_LowCoder[n],t):(r=8,0==mn(t,e.m_Choice,1)?r+=sn(e.m_MidCoder[n],t):r+=8+sn(e.m_HighCoder,t),r)}function xt(e){return e.m_Choice=T(lr,0,-1,2,1),e.m_LowCoder=T(hr,0,7,16,0),e.m_MidCoder=T(hr,0,7,16,0),e.m_HighCoder=on(new an,8),e}function Ct(e){var t;for(yn(e.m_Choice),t=0;t<e.m_NumPosStates;++t)yn(e.m_LowCoder[t].Models),yn(e.m_MidCoder[t].Models);yn(e.m_HighCoder.Models)}function Et(){}function St(){}function Tt(e){return e.m_Decoders=T(lr,0,-1,768,1),e}function At(){}function Mt(){var e,t,n,r;for(Mt=Fn,e=2,(V=T($n,0,-1,2048,1))[0]=0,V[1]=1,r=2;r<22;++r)for(n=1<<(r>>1)-1,t=0;t<n;++t,++e)V[e]=r<<24>>24}function kt(e,t){var n,r,i,o;e._optimumEndIndex=t,i=e._optimum[t].PosPrev,r=e._optimum[t].BackPrev;do{e._optimum[t].Prev1IsChar&&(nn(e._optimum[i]),e._optimum[i].PosPrev=i-1,e._optimum[t].Prev2&&(e._optimum[i-1].Prev1IsChar=!1,e._optimum[i-1].PosPrev=e._optimum[t].PosPrev2,e._optimum[i-1].BackPrev=e._optimum[t].BackPrev2)),o=i,n=r,r=e._optimum[o].BackPrev,i=e._optimum[o].PosPrev,e._optimum[o].BackPrev=n,e._optimum[o].PosPrev=t,t=o}while(t>0);return e.backRes=e._optimum[0].BackPrev,e._optimumCurrentIndex=e._optimum[0].PosPrev,e._optimumCurrentIndex}function Lt(e){var t;for(t=0;t<16;++t)e._alignPrices[t]=fn(e._posAlignEncoder,t);e._alignPriceCount=0}function Ot(e){var t,n,r,i,o,s,a,u;for(i=4;i<128;++i)t=(2|1&(s=jt(i)))<<(r=(s>>1)-1),e.tempPrices[i]=dn(e._posEncoders,t-s-1,r,i-t);for(o=0;o<4;++o){for(n=e._posSlotEncoder[o],a=o<<6,s=0;s<e._distTableSize;++s)e._posSlotPrices[a+s]=ln(n,s);for(s=14;s<e._distTableSize;++s)e._posSlotPrices[a+s]+=(s>>1)-1-4<<6;for(u=128*o,i=0;i<4;++i)e._distancesPrices[u+i]=e._posSlotPrices[a+i];for(;i<128;++i)e._distancesPrices[u+i]=e._posSlotPrices[a+jt(i)]+e.tempPrices[i]}e._matchPriceCount=0}function Rt(e,t){Dt(e),function(e,t){var n;if(!e._writeEndMark)return;bn(e._rangeEncoder,e._isMatch,(e._state<<4)+t,1),bn(e._rangeEncoder,e._isRep,e._state,0),e._state=e._state<7?7:10,Ht(e._lenEncoder,e._rangeEncoder,0,t),n=gt(2),cn(e._posSlotEncoder[n],e._rangeEncoder,63),wn(e._rangeEncoder,67108863,26),hn(e._posAlignEncoder,e._rangeEncoder,15)}(e,t&e._posStateMask),function(e){var t;for(t=0;t<5;++t)Cn(e)}(e._rangeEncoder)}function Ft(e,t){var n,r,i,o,s,a,u,c,l,h,f,p,d,g,m,y,_,v,b,w,x,C,E,S,T,A,M,k,L,O,R,F,P,B,I,N,D,j,q,z,U,$,H,G;if(e._optimumEndIndex!=e._optimumCurrentIndex)return d=e._optimum[e._optimumCurrentIndex].PosPrev-e._optimumCurrentIndex,e.backRes=e._optimum[e._optimumCurrentIndex].BackPrev,e._optimumCurrentIndex=e._optimum[e._optimumCurrentIndex].PosPrev,d;if(e._optimumCurrentIndex=e._optimumEndIndex=0,e._longestMatchWasFound?(p=e._longestMatchLength,e._longestMatchWasFound=!1):p=Nt(e),A=e._numDistancePairs,(S=it(e._matchFinder)+1)<2)return e.backRes=-1,1;for(S>273&&(S=273),q=0,l=0;l<4;++l)e.reps[l]=e._repDistances[l],e.repLens[l]=rt(e._matchFinder,-1,e.reps[l],273),e.repLens[l]>e.repLens[q]&&(q=l);if(e.repLens[q]>=e._numFastBytes)return e.backRes=q,It(e,(d=e.repLens[q])-1),d;if(p>=e._numFastBytes)return e.backRes=e._matchDistances[A-1]+4,It(e,p-1),p;if(u=nt(e._matchFinder,-1),_=nt(e._matchFinder,-e._repDistances[0]-1-1),p<2&&u!=_&&e.repLens[q]<2)return e.backRes=-1,1;if(e._optimum[0].State=e._state,P=t&e._posStateMask,e._optimum[1].Price=(vn(),W[e._isMatch[(e._state<<4)+P]>>>2]+en(Qt(e._literalEncoder,t,e._previousByte),e._state>=7,_,u)),nn(e._optimum[1]),j=(v=W[2048-e._isMatch[(e._state<<4)+P]>>>2])+W[2048-e._isRep[e._state]>>>2],_==u&&(z=j+function(e,t,n){return vn(),W[e._isRepG0[t]>>>2]+W[e._isRep0Long[(t<<4)+n]>>>2]}(e,e._state,P))<e._optimum[1].Price&&(e._optimum[1].Price=z,function(e){e.BackPrev=0,e.Prev1IsChar=!1}(e._optimum[1])),(f=p>=e.repLens[q]?p:e.repLens[q])<2)return e.backRes=e._optimum[1].BackPrev,1;e._optimum[1].PosPrev=0,e._optimum[0].Backs0=e.reps[0],e._optimum[0].Backs1=e.reps[1],e._optimum[0].Backs2=e.reps[2],e._optimum[0].Backs3=e.reps[3],h=f;do{e._optimum[h--].Price=268435455}while(h>=2);for(l=0;l<4;++l)if(!((D=e.repLens[l])<2)){I=j+Bt(e,l,e._state,P);do{(o=I+Vt(e._repMatchLenEncoder,D-2,P))<(O=e._optimum[D]).Price&&(O.Price=o,O.PosPrev=0,O.BackPrev=l,O.Prev1IsChar=!1)}while(--D>=2)}if(E=v+W[e._isRep[e._state]>>>2],(h=e.repLens[0]>=2?e.repLens[0]+1:2)<=p){for(M=0;h>e._matchDistances[M];)M+=2;for(;(o=E+Pt(e,c=e._matchDistances[M+1],h,P))<(O=e._optimum[h]).Price&&(O.Price=o,O.PosPrev=0,O.BackPrev=c+4,O.Prev1IsChar=!1),h!=e._matchDistances[M]||(M+=2)!=A;++h);}for(n=0;;){if(++n==f)return kt(e,n);if(b=Nt(e),A=e._numDistancePairs,b>=e._numFastBytes)return e._longestMatchLength=b,e._longestMatchWasFound=!0,kt(e,n);if(++t,F=e._optimum[n].PosPrev,e._optimum[n].Prev1IsChar?(--F,e._optimum[n].Prev2?($=e._optimum[e._optimum[n].PosPrev2].State,$=e._optimum[n].BackPrev2<4?$<7?8:11:$<7?7:10):$=e._optimum[F].State,$=mt($)):$=e._optimum[F].State,F==n-1?$=0==e._optimum[n].BackPrev?$<7?9:11:mt($):(e._optimum[n].Prev1IsChar&&e._optimum[n].Prev2?(F=e._optimum[n].PosPrev2,R=e._optimum[n].BackPrev2,$=$<7?8:11):$=(R=e._optimum[n].BackPrev)<4?$<7?8:11:$<7?7:10,L=e._optimum[F],R<4?0==R?(e.reps[0]=L.Backs0,e.reps[1]=L.Backs1,e.reps[2]=L.Backs2,e.reps[3]=L.Backs3):1==R?(e.reps[0]=L.Backs1,e.reps[1]=L.Backs0,e.reps[2]=L.Backs2,e.reps[3]=L.Backs3):2==R?(e.reps[0]=L.Backs2,e.reps[1]=L.Backs0,e.reps[2]=L.Backs1,e.reps[3]=L.Backs3):(e.reps[0]=L.Backs3,e.reps[1]=L.Backs0,e.reps[2]=L.Backs1,e.reps[3]=L.Backs2):(e.reps[0]=R-4,e.reps[1]=L.Backs0,e.reps[2]=L.Backs1,e.reps[3]=L.Backs2)),e._optimum[n].State=$,e._optimum[n].Backs0=e.reps[0],e._optimum[n].Backs1=e.reps[1],e._optimum[n].Backs2=e.reps[2],e._optimum[n].Backs3=e.reps[3],a=e._optimum[n].Price,u=nt(e._matchFinder,-1),_=nt(e._matchFinder,-e.reps[0]-1-1),P=t&e._posStateMask,w=!1,(r=a+W[e._isMatch[($<<4)+P]>>>2]+en(Qt(e._literalEncoder,t,nt(e._matchFinder,-2)),$>=7,_,u))<(x=e._optimum[n+1]).Price&&(x.Price=r,x.PosPrev=n,x.BackPrev=-1,x.Prev1IsChar=!1,w=!0),j=(v=a+W[2048-e._isMatch[($<<4)+P]>>>2])+W[2048-e._isRep[$]>>>2],_!=u||x.PosPrev<n&&0==x.BackPrev||(z=j+(W[e._isRepG0[$]>>>2]+W[e._isRep0Long[($<<4)+P]>>>2]))<=x.Price&&(x.Price=z,x.PosPrev=n,x.BackPrev=0,x.Prev1IsChar=!1,w=!0),!((S=T=4095-n<(T=it(e._matchFinder)+1)?4095-n:T)<2)){if(S>e._numFastBytes&&(S=e._numFastBytes),!w&&_!=u&&(G=He(T-1,e._numFastBytes),(m=rt(e._matchFinder,0,e.reps[0],G))>=2)){for(H=mt($),B=t+1&e._posStateMask,C=r+W[2048-e._isMatch[(H<<4)+B]>>>2]+W[2048-e._isRep[H]>>>2],k=n+1+m;f<k;)e._optimum[++f].Price=268435455;(o=C+(Vt(e._repMatchLenEncoder,m-2,B)+Bt(e,0,H,B)))<(O=e._optimum[k]).Price&&(O.Price=o,O.PosPrev=n+1,O.BackPrev=0,O.Prev1IsChar=!0,O.Prev2=!1)}for(U=2,N=0;N<4;++N)if(!((g=rt(e._matchFinder,-1,e.reps[N],S))<2)){y=g;do{for(;f<n+g;)e._optimum[++f].Price=268435455;(o=j+(Vt(e._repMatchLenEncoder,g-2,P)+Bt(e,N,$,P)))<(O=e._optimum[n+g]).Price&&(O.Price=o,O.PosPrev=n,O.BackPrev=N,O.Prev1IsChar=!1)}while(--g>=2);if(g=y,0==N&&(U=g+1),g<T&&(G=He(T-1-g,e._numFastBytes),(m=rt(e._matchFinder,g,e.reps[N],G))>=2)){for(H=$<7?8:11,B=t+g&e._posStateMask,i=j+(Vt(e._repMatchLenEncoder,g-2,P)+Bt(e,N,$,P))+W[e._isMatch[(H<<4)+B]>>>2]+en(Qt(e._literalEncoder,t+g,nt(e._matchFinder,g-1-1)),!0,nt(e._matchFinder,g-1-(e.reps[N]+1)),nt(e._matchFinder,g-1)),H=mt(H),B=t+g+1&e._posStateMask,C=i+W[2048-e._isMatch[(H<<4)+B]>>>2]+W[2048-e._isRep[H]>>>2],k=g+1+m;f<n+k;)e._optimum[++f].Price=268435455;(o=C+(Vt(e._repMatchLenEncoder,m-2,B)+Bt(e,0,H,B)))<(O=e._optimum[n+k]).Price&&(O.Price=o,O.PosPrev=n+g+1,O.BackPrev=0,O.Prev1IsChar=!0,O.Prev2=!0,O.PosPrev2=n,O.BackPrev2=N)}}if(b>S){for(b=S,A=0;b>e._matchDistances[A];A+=2);e._matchDistances[A]=b,A+=2}if(b>=U){for(E=v+W[e._isRep[$]>>>2];f<n+b;)e._optimum[++f].Price=268435455;for(M=0;U>e._matchDistances[M];)M+=2;for(g=U;;++g)if((o=E+Pt(e,s=e._matchDistances[M+1],g,P))<(O=e._optimum[n+g]).Price&&(O.Price=o,O.PosPrev=n,O.BackPrev=s+4,O.Prev1IsChar=!1),g==e._matchDistances[M]){if(g<T&&(G=He(T-1-g,e._numFastBytes),(m=rt(e._matchFinder,g,s,G))>=2)){for(H=$<7?7:10,B=t+g&e._posStateMask,i=o+W[e._isMatch[(H<<4)+B]>>>2]+en(Qt(e._literalEncoder,t+g,nt(e._matchFinder,g-1-1)),!0,nt(e._matchFinder,g-(s+1)-1),nt(e._matchFinder,g-1)),H=mt(H),B=t+g+1&e._posStateMask,C=i+W[2048-e._isMatch[(H<<4)+B]>>>2]+W[2048-e._isRep[H]>>>2],k=g+1+m;f<n+k;)e._optimum[++f].Price=268435455;(o=C+(Vt(e._repMatchLenEncoder,m-2,B)+Bt(e,0,H,B)))<(O=e._optimum[n+k]).Price&&(O.Price=o,O.PosPrev=n+g+1,O.BackPrev=0,O.Prev1IsChar=!0,O.Prev2=!0,O.PosPrev2=n,O.BackPrev2=s+4)}if((M+=2)==A)break}}}}}function Pt(e,t,n,r){var i;return i=gt(n),(t<128?e._distancesPrices[128*i+t]:e._posSlotPrices[(i<<6)+function(e){if(e<131072)return V[e>>6]+12;if(e<134217728)return V[e>>16]+32;return V[e>>26]+52}(t)]+e._alignPrices[15&t])+Vt(e._lenEncoder,n-2,r)}function Bt(e,t,n,r){var i;return 0==t?(vn(),i=W[e._isRepG0[n]>>>2],i+=W[2048-e._isRep0Long[(n<<4)+r]>>>2]):(vn(),i=W[2048-e._isRepG0[n]>>>2],1==t?i+=W[e._isRepG1[n]>>>2]:(i+=W[2048-e._isRepG1[n]>>>2],i+=En(e._isRepG2[n],t-2))),i}function It(e,t){t>0&&(!function(e,t){var n,r,i,o,s,a,u,c,l,h,f,p,d,g,m,y,_;do{if(e._pos+e._matchMaxLen<=e._streamPos)p=e._matchMaxLen;else if((p=e._streamPos-e._pos)<e.kMinMatchCheck){ct(e);continue}for(d=e._pos>e._cyclicBufferSize?e._pos-e._cyclicBufferSize:0,r=e._bufferOffset+e._pos,e.HASH_ARRAY?(a=1023&(_=G[255&e._bufferBase[r]]^255&e._bufferBase[r+1]),e._hash[a]=e._pos,u=65535&(_^=(255&e._bufferBase[r+2])<<8),e._hash[1024+u]=e._pos,c=(_^G[255&e._bufferBase[r+3]]<<5)&e._hashMask):c=255&e._bufferBase[r]^(255&e._bufferBase[r+1])<<8,i=e._hash[e.kFixHashSize+c],e._hash[e.kFixHashSize+c]=e._pos,m=1+(e._cyclicBufferPos<<1),y=e._cyclicBufferPos<<1,h=f=e.kNumHashDirectBytes,n=e._cutValue;;){if(i<=d||0==n--){e._son[m]=e._son[y]=0;break}if(o=((s=e._pos-i)<=e._cyclicBufferPos?e._cyclicBufferPos-s:e._cyclicBufferPos-s+e._cyclicBufferSize)<<1,g=e._bufferOffset+i,l=h<f?h:f,e._bufferBase[g+l]==e._bufferBase[r+l]){for(;++l!=p&&e._bufferBase[g+l]==e._bufferBase[r+l];);if(l==p){e._son[y]=e._son[o],e._son[m]=e._son[o+1];break}}(255&e._bufferBase[g+l])<(255&e._bufferBase[r+l])?(e._son[y]=i,y=o+1,i=e._son[y],f=l):(e._son[m]=i,m=o,i=e._son[m],h=l)}ct(e)}while(0!=--t)}(e._matchFinder,t),e._additionalOffset+=t)}function Nt(e){var t;return t=0,e._numDistancePairs=function(e,t){var n,r,i,o,s,a,u,c,l,h,f,p,d,g,m,y,_,v,b,w,x;if(e._pos+e._matchMaxLen<=e._streamPos)g=e._matchMaxLen;else if((g=e._streamPos-e._pos)<e.kMinMatchCheck)return ct(e),0;for(_=0,m=e._pos>e._cyclicBufferSize?e._pos-e._cyclicBufferSize:0,r=e._bufferOffset+e._pos,y=1,c=0,l=0,e.HASH_ARRAY?(c=1023&(x=G[255&e._bufferBase[r]]^255&e._bufferBase[r+1]),l=65535&(x^=(255&e._bufferBase[r+2])<<8),h=(x^G[255&e._bufferBase[r+3]]<<5)&e._hashMask):h=255&e._bufferBase[r]^(255&e._bufferBase[r+1])<<8,i=e._hash[e.kFixHashSize+h],e.HASH_ARRAY&&(o=e._hash[c],s=e._hash[1024+l],e._hash[c]=e._pos,e._hash[1024+l]=e._pos,o>m&&e._bufferBase[e._bufferOffset+o]==e._bufferBase[r]&&(t[_++]=y=2,t[_++]=e._pos-o-1),s>m&&e._bufferBase[e._bufferOffset+s]==e._bufferBase[r]&&(s==o&&(_-=2),t[_++]=y=3,t[_++]=e._pos-s-1,o=s),0!=_&&o==i&&(_-=2,y=1)),e._hash[e.kFixHashSize+h]=e._pos,b=1+(e._cyclicBufferPos<<1),w=e._cyclicBufferPos<<1,p=d=e.kNumHashDirectBytes,0!=e.kNumHashDirectBytes&&i>m&&e._bufferBase[e._bufferOffset+i+e.kNumHashDirectBytes]!=e._bufferBase[r+e.kNumHashDirectBytes]&&(t[_++]=y=e.kNumHashDirectBytes,t[_++]=e._pos-i-1),n=e._cutValue;;){if(i<=m||0==n--){e._son[b]=e._son[w]=0;break}if(a=((u=e._pos-i)<=e._cyclicBufferPos?e._cyclicBufferPos-u:e._cyclicBufferPos-u+e._cyclicBufferSize)<<1,v=e._bufferOffset+i,f=p<d?p:d,e._bufferBase[v+f]==e._bufferBase[r+f]){for(;++f!=g&&e._bufferBase[v+f]==e._bufferBase[r+f];);if(y<f&&(t[_++]=y=f,t[_++]=u-1,f==g)){e._son[w]=e._son[a],e._son[b]=e._son[a+1];break}}(255&e._bufferBase[v+f])<(255&e._bufferBase[r+f])?(e._son[w]=i,w=a+1,i=e._son[w],d=f):(e._son[b]=i,b=a,i=e._son[b],p=f)}return ct(e),_}(e._matchFinder,e._matchDistances),e._numDistancePairs>0&&(t=e._matchDistances[e._numDistancePairs-2])==e._numFastBytes&&(t+=rt(e._matchFinder,t-1,e._matchDistances[e._numDistancePairs-1],273-t)),++e._additionalOffset,t}function Dt(e){e._matchFinder&&e._needReleaseMFStream&&(e._matchFinder._stream=null,e._needReleaseMFStream=!1)}function jt(e){return e<2048?V[e]:e<2097152?V[e>>10]+20:V[e>>20]+40}function qt(){}function zt(e,t){var n;for(Sn(e._choice),n=0;n<t;++n)yn(e._lowCoder[n].Models),yn(e._midCoder[n].Models);yn(e._highCoder.Models)}function Ut(e,t,n,r,i){var o,s,a,u,c;for(vn(),o=W[e._choice[0]>>>2],a=(s=W[2048-e._choice[0]>>>2])+W[e._choice[1]>>>2],u=s+W[2048-e._choice[1]>>>2],c=0,c=0;c<8;++c){if(c>=n)return;r[i+c]=o+ln(e._lowCoder[t],c)}for(;c<16;++c){if(c>=n)return;r[i+c]=a+ln(e._midCoder[t],c-8)}for(;c<n;++c)r[i+c]=u+ln(e._highCoder,c-8-8)}function $t(){}function Ht(e,t,n,r){!function(e,t,n,r){n<8?(bn(t,e._choice,0,0),cn(e._lowCoder[r],t,n)):(n-=8,bn(t,e._choice,0,1),n<8?(bn(t,e._choice,1,0),cn(e._midCoder[r],t,n)):(bn(t,e._choice,1,1),cn(e._highCoder,t,n-8)))}(e,t,n,r),0==--e._counters[r]&&(Ut(e,r,e._tableSize,e._prices,272*r),e._counters[r]=e._tableSize)}function Gt(e){return function(e){var t;for(e._choice=T(lr,0,-1,2,1),e._lowCoder=T(_r,0,8,16,0),e._midCoder=T(_r,0,8,16,0),e._highCoder=un(new gn,8),t=0;t<16;++t)e._lowCoder[t]=un(new gn,3),e._midCoder[t]=un(new gn,3)}(e),e._prices=T(nr,0,-1,4352,1),e._counters=T(nr,0,-1,16,1),e}function Vt(e,t,n){return e._prices[272*n+t]}function Wt(e,t){var n;for(n=0;n<t;++n)Ut(e,n,e._tableSize,e._prices,272*n),e._counters[n]=e._tableSize}function Jt(){}function Qt(e,t,n){return e.m_Coders[((t&e.m_PosMask)<<e.m_NumPrevBits)+((255&n)>>>8-e.m_NumPrevBits)]}function Kt(){}function Zt(e,t,n){var r,i,o;for(i=1,o=7;o>=0;--o)r=n>>o&1,bn(t,e.m_Encoders,i,r),i=i<<1|r}function Yt(e,t,n,r){var i,o,s,a,u,c;for(o=1,u=!0,s=7;s>=0;--s)i=r>>s&1,c=o,u&&(c+=1+(a=n>>s&1)<<8,u=a==i),bn(t,e.m_Encoders,c,i),o=o<<1|i}function Xt(e){return e.m_Encoders=T(lr,0,-1,768,1),e}function en(e,t,n,r){var i,o,s,a,u;if(u=0,o=1,s=7,t)for(;s>=0;--s)if(a=n>>s&1,i=r>>s&1,u+=En(e.m_Encoders[(1+a<<8)+o],i),o=o<<1|i,a!=i){--s;break}for(;s>=0;--s)i=r>>s&1,u+=En(e.m_Encoders[o],i),o=o<<1|i;return u}function tn(){}function nn(e){e.BackPrev=-1,e.Prev1IsChar=!1}function rn(){}function on(e,t){return e.NumBitLevels=t,e.Models=T(lr,0,-1,1<<t,1),e}function sn(e,t){var n,r;for(r=1,n=e.NumBitLevels;0!=n;--n)r=(r<<1)+mn(t,e.Models,r);return r-(1<<e.NumBitLevels)}function an(){}function un(e,t){return e.NumBitLevels=t,e.Models=T(lr,0,-1,1<<t,1),e}function cn(e,t,n){var r,i,o;for(o=1,i=e.NumBitLevels;0!=i;)r=n>>>--i&1,bn(t,e.Models,o,r),o=o<<1|r}function ln(e,t){var n,r,i,o;for(o=0,i=1,r=e.NumBitLevels;0!=r;)n=t>>>--r&1,o+=En(e.Models[i],n),i=(i<<1)+n;return o}function hn(e,t,n){var r,i,o;for(o=1,i=0;i<e.NumBitLevels;++i)r=1&n,bn(t,e.Models,o,r),o=o<<1|r,n>>=1}function fn(e,t){var n,r,i,o;for(o=0,i=1,r=e.NumBitLevels;0!=r;--r)n=1&t,t>>>=1,o+=En(e.Models[i],n),i=i<<1|n;return o}function pn(e,t,n,r,i){var o,s,a;for(a=1,s=0;s<r;++s)bn(n,e,t+a,o=1&i),a=a<<1|o,i>>=1}function dn(e,t,n,r){var i,o,s,a;for(a=0,s=1,o=n;0!=o;--o)i=1&r,r>>>=1,a+=(vn(),W[(2047&(e[t+s]-i^-i))>>>2]),s=s<<1|i;return a}function gn(){}function mn(e,t,n){var r,i;return i=t[n],r=(e.Range>>>11)*i,(-2147483648^e.Code)<(-2147483648^r)?(e.Range=r,t[n]=i+(2048-i>>>5)<<16>>16,0==(-16777216&e.Range)&&(e.Code=e.Code<<8|ve(e.Stream),e.Range<<=8),0):(e.Range-=r,e.Code-=r,t[n]=i-(i>>>5)<<16>>16,0==(-16777216&e.Range)&&(e.Code=e.Code<<8|ve(e.Stream),e.Range<<=8),1)}function yn(e){var t;for(t=0;t<e.length;++t)e[t]=1024}function _n(){}function vn(){var e,t,n;for(vn=Fn,W=T(nr,0,-1,512,1),t=8;t>=0;--t)for(e=1<<9-t,n=1<<9-t-1;n<e;++n)W[n]=(t<<6)+(e-n<<6>>>9-t-1)}function bn(e,t,n,r){var i,o;o=t[n],i=(e.Range>>>11)*o,0==r?(e.Range=i,t[n]=o+(2048-o>>>5)<<16>>16):(e.Low=K(e.Low,Y(ie(i),m)),e.Range-=i,t[n]=o-(o>>>5)<<16>>16),0==(-16777216&e.Range)&&(e.Range<<=8,Cn(e))}function wn(e,t,n){var r;for(r=n-1;r>=0;--r)e.Range>>>=1,1==(t>>>r&1)&&(e.Low=K(e.Low,ie(e.Range))),0==(-16777216&e.Range)&&(e.Range<<=8,Cn(e))}function xn(e){return K(K(ie(e._cacheSize),e._position),h)}function Cn(e){var t,n;if(0!=(t=se(function(e,t){var n;return n=fe(e,t&=63),e[1]<0&&(n=K(n,he((me(),U),63-t))),n}(e.Low,32)))||X(e.Low,g)<0){e._position=K(e._position,ie(e._cacheSize)),n=e._cache;do{Te(e.Stream,n+t),n=255}while(0!=--e._cacheSize);e._cache=se(e.Low)>>>24}++e._cacheSize,e.Low=he(Y(e.Low,p),8)}function En(e,t){return vn(),W[(2047&(e-t^-t))>>>2]}function Sn(e){var t;for(vn(),t=0;t<e.length;++t)e[t]=1024}function Tn(){}function An(e){return e}function Mn(e){return e[1]+e[0]}function kn(){var e,n,i,o,s,a=An(new On),u=arguments[0],c=arguments[1];"function"==typeof arguments[2]?(o=arguments[2],"function"==typeof arguments[3]&&(s=arguments[3])):i=arguments[2],a.mode=Dr(c),a.c=function(e,t,n){var r;e.output=Ce(new Me);try{Qe(e,_e(new we,t),e.output,ie(t.length),n)}catch(r){throw P(r=Q(r),10)?w(new x,"impossible exception"):r}return e}(new Ze,function(e){var t,n,r,i,o,s,a;for(function(e,t,n,r,i){var o;for(o=t;o<n;++o)r[i++]=e.charCodeAt(o)}(e,0,a=e.length,s=T(Kn,0,-1,a,1),0),n=s,i=0,o=0;o<e.length;++o)(t=n[o])>=1&&t<=127?++i:i+=0==t||t>=128&&t<=2047?2:3;for(r=T($n,0,-1,i,1),i=0,o=0;o<e.length;++o)(t=n[o])>=1&&t<=127?r[i++]=t<<24>>24:0==t||t>=128&&t<=2047?(r[i++]=(192|t>>6&31)<<24>>24,r[i++]=(128|63&t)<<24>>24):(r[i++]=(224|t>>12&15)<<24>>24,r[i++]=(128|t>>6&63)<<24>>24,r[i++]=(128|63&t)<<24>>24);return r}(u),a.mode),s?s(0):void 0!==i&&r(0,i),setTimeout(function u(){var c;for(n=(new Date).getTime();Je(a.c);)if(e=Mn(a.c.chunker.inBytesProcessed)/Mn(a.c.length_0),(new Date).getTime()-n>200)return s?s(e):void 0!==i&&r(e,i),setTimeout(u,0),!1;s?s(1):void 0!==i&&r(1,i),c=Se(a.c.output).slice(0),o?o(c):void 0!==i&&postMessage({action:t,callback_num:i,result:c})},1)}function Ln(){var e,t,i,a,u,c,l=An(new On),h=arguments[0];"function"==typeof arguments[1]?(u=arguments[1],"function"==typeof arguments[2]&&(c=arguments[2])):a=arguments[1],t=function(e,t,n,r){return k(),L(r,o,s),r.arrayClass$=e,r.typeId$=t,r.queryId$=n,r}($n,0,-1,h),l.d=function(e,t){return e.output=Ce(new Me),Xe(e,_e(new we,t),e.output),e}(new tt,t),c?c(0):void 0!==a&&r(0,a),setTimeout(function t(){var o;for(i=(new Date).getTime();Ye(l.d);)if(e=Mn(l.d.chunker.decoder.nowPos64)/Mn(l.d.length_0),(new Date).getTime()-i>200)return c?c(e):void 0!==a&&r(e,a),setTimeout(t,0),!1;c?c(1):void 0!==a&&r(1,a),o=function(e){var t,n,r,i,o;for(t=function(e){var t;return e.data=((t=[]).explicitLength=0,t),e}(new Ve),n=0;n<e.length;++n)if(0==(128&(r=255&e[n]))){if(0==r)throw je(new qe,"invalid UTF-8");S(t.data,String.fromCharCode(65535&r))}else if(192==(224&r)){if(n+1>=e.length)throw je(new qe,"invalid UTF-8");if(128!=(192&(i=255&e[++n])))throw je(new qe,"invalid UTF-8");E(t.data,String.fromCharCode((31&r)<<6&65535|63&i))}else{if(224!=(240&r))throw je(new qe,"invalid UTF-8");if(n+2>=e.length)throw je(new qe,"invalid UTF-8");if(128!=(192&(i=255&e[++n])))throw je(new qe,"invalid UTF-8");if(128!=(192&(o=255&e[++n])))throw je(new qe,"invalid UTF-8");S(t.data,String.fromCharCode(65535&((15&r)<<12|(63&i)<<6|63&o)))}return function(e){var t,n;return n=e.join(""),e.length=e.explicitLength=0,t=n,e[e.explicitLength++]=t,t}(t.data)}(Se(l.d.output)),u?u(o):void 0!==a&&postMessage({action:n,callback_num:a,result:o})},0)}function On(){}function Rn(){$stats&&$stats({moduleName:e,subSystem:"startup",evtGroup:"moduleStartup",millis:(new Date).getTime(),type:"onModuleLoadStart",className:"org.dellroad.lzma.demo.client.LZMADemo"})}function Fn(){}(i=ye.prototype=new _).getClass$=function(){return zn},i.typeId$=0,(i=we.prototype=new ye).getClass$=function(){return Un},i.typeId$=0,i.buf=null,i.count=0,i.pos=0,(i=xe.prototype=new _).getClass$=function(){return Hn},i.typeId$=0,(i=Me.prototype=new xe).getClass$=function(){return Gn},i.typeId$=0,i.buf=null,i.count=0,(i=Le.prototype=new b).getClass$=function(){return Vn},i.typeId$=7,(i=Oe.prototype=new x).getClass$=function(){return Jn},i.typeId$=8,(i=Fe.prototype=new x).getClass$=function(){return Qn},i.typeId$=9,(i=Ie.prototype=new _).getClass$=function(){return Zn},i.typeId$=0,i.typeName=null,(i=Ne.prototype=new x).getClass$=function(){return Yn},i.typeId$=12,(i=De.prototype=new _).getClass$=function(){return Wn},i.typeId$=0,(i=qe.prototype=new x).getClass$=function(){return Xn},i.typeId$=13,(i=ze.prototype=new x).getClass$=function(){return er},i.typeId$=14,(i=Ue.prototype=new x).getClass$=function(){return tr},i.typeId$=15,(i=Ge.prototype=new x).getClass$=function(){return rr},i.typeId$=16,(i=String.prototype).getClass$=function(){return ir},i.typeId$=2,(i=Ve.prototype=new _).getClass$=function(){return or},i.typeId$=0,(i=function(){}.prototype=new De).getClass$=function(){return Rr},i.typeId$=0,i.dictionarySize=0,i.fb=0,i.lc=0,i.lp=0,i.matchFinder=0,i.pb=0,(i=Ke.prototype=new _).getClass$=function(){return Fr},i.typeId$=0,i.chunker=null,(i=Ze.prototype=new Ke).getClass$=function(){return Pr},i.typeId$=0,i.output=null,(i=et.prototype=new _).getClass$=function(){return Br},i.typeId$=0,i.chunker=null,i.exception=null,i.length_0=c,(i=tt.prototype=new et).getClass$=function(){return Ir},i.typeId$=0,i.output=null,(i=at.prototype=new _).getClass$=function(){return sr},i.typeId$=0,i._blockSize=0,i._bufferBase=null,i._bufferOffset=0,i._keepSizeAfter=0,i._keepSizeBefore=0,i._pointerToLastSafePosition=0,i._pos=0,i._posLimit=0,i._stream=null,i._streamEndWasReached=!1,i._streamPos=0,(i=ht.prototype=new at).getClass$=function(){return ar},i.typeId$=0,i.HASH_ARRAY=!0,i._cutValue=255,i._cyclicBufferPos=0,i._cyclicBufferSize=0,i._hash=null,i._hashMask=0,i._hashSizeSum=0,i._matchMaxLen=0,i._son=null,i.kFixHashSize=66560,i.kMinMatchCheck=4,i.kNumHashDirectBytes=0,(i=dt.prototype=new _).getClass$=function(){return ur},i.typeId$=0,i._buffer=null,i._pos=0,i._stream=null,i._streamPos=0,i._windowSize=0,(i=_t.prototype=new _).getClass$=function(){return cr},i.typeId$=0,i.alive=!1,i.decoder=null,i.encoder=null,(i=vt.prototype=new _).getClass$=function(){return fr},i.typeId$=0,i.m_DictionarySize=-1,i.m_DictionarySizeCheck=-1,i.m_PosStateMask=0,i.nowPos64=c,i.outSize=c,i.prevByte=0,i.rep0=0,i.rep1=0,i.rep2=0,i.rep3=0,i.state=0,(i=Et.prototype=new _).getClass$=function(){return pr},i.typeId$=0,i.m_NumPosStates=0,(i=St.prototype=new _).getClass$=function(){return gr},i.typeId$=0,i.m_Coders=null,i.m_NumPosBits=0,i.m_NumPrevBits=0,i.m_PosMask=0,(i=At.prototype=new _).getClass$=function(){return mr},i.typeId$=17,(i=qt.prototype=new _).getClass$=function(){return wr},i.typeId$=0,i._additionalOffset=0,i._alignPriceCount=0,i._dictionarySize=4194304,i._dictionarySizePrev=-1,i._distTableSize=44,i._finished=!1,i._inStream=null,i._longestMatchLength=0,i._longestMatchWasFound=!1,i._matchFinder=null,i._matchFinderType=1,i._matchPriceCount=0,i._needReleaseMFStream=!1,i._numDistancePairs=0,i._numFastBytes=32,i._numFastBytesPrev=-1,i._numLiteralContextBits=3,i._numLiteralPosStateBits=0,i._optimumCurrentIndex=0,i._optimumEndIndex=0,i._posStateBits=2,i._posStateMask=3,i._previousByte=0,i._state=0,i._writeEndMark=!1,i.backRes=0,i.nowPos64=c,(i=$t.prototype=new _).getClass$=function(){return Sr},i.typeId$=0,(i=Jt.prototype=new $t).getClass$=function(){return Tr},i.typeId$=0,i._tableSize=0,(i=Kt.prototype=new _).getClass$=function(){return Cr},i.typeId$=0,i.m_Coders=null,i.m_NumPosBits=0,i.m_NumPrevBits=0,i.m_PosMask=0,(i=tn.prototype=new _).getClass$=function(){return Er},i.typeId$=18,(i=rn.prototype=new _).getClass$=function(){return Ar},i.typeId$=19,i.BackPrev=0,i.BackPrev2=0,i.Backs0=0,i.Backs1=0,i.Backs2=0,i.Backs3=0,i.PosPrev=0,i.PosPrev2=0,i.Prev1IsChar=!1,i.Prev2=!1,i.Price=0,i.State=0,(i=an.prototype=new _).getClass$=function(){return Mr},i.typeId$=20,i.Models=null,i.NumBitLevels=0,(i=gn.prototype=new _).getClass$=function(){return kr},i.typeId$=21,i.Models=null,i.NumBitLevels=0,(i=_n.prototype=new _).getClass$=function(){return Lr},i.typeId$=0,i.Code=0,i.Range=0,i.Stream=null,(i=Tn.prototype=new _).getClass$=function(){return Or},i.typeId$=0,i.Low=c,i.Range=0,i.Stream=null,i._cache=0,i._cacheSize=0,i._position=c,(i=On.prototype=new _).getClass$=function(){return Nr},i.typeId$=0,i.c=null,i.d=null;var Pn=Be("java.lang.","Object"),Bn=Be("java.lang.","Throwable"),In=Be("java.lang.","Exception"),Nn=Be("java.lang.","RuntimeException"),Dn=Be("com.google.gwt.core.client.","JavaScriptException"),jn=Be("com.google.gwt.core.client.","JavaScriptObject$"),qn=Pe("","[[D"),zn=Be("java.io.","InputStream"),Un=Be("java.io.","ByteArrayInputStream"),$n=Pe("","[B"),Hn=Be("java.io.","OutputStream"),Gn=Be("java.io.","ByteArrayOutputStream"),Vn=Be("java.io.","IOException"),Wn=Be("java.lang.","Enum"),Jn=Be("java.lang.","ArithmeticException"),Qn=Be("java.lang.","ArrayStoreException"),Kn=Pe("","[C"),Zn=Be("java.lang.","Class"),Yn=Be("java.lang.","ClassCastException"),Xn=Be("java.lang.","IllegalArgumentException"),er=Be("java.lang.","IllegalStateException"),tr=Be("java.lang.","IndexOutOfBoundsException"),nr=Pe("","[I"),rr=Be("java.lang.","NullPointerException"),ir=Be("java.lang.","String"),or=Be("java.lang.","StringBuilder"),sr=Be("org.dellroad.lzma.client.SevenZip.Compression.LZ.","InWindow"),ar=Be("org.dellroad.lzma.client.SevenZip.Compression.LZ.","BinTree"),ur=Be("org.dellroad.lzma.client.SevenZip.Compression.LZ.","OutWindow"),cr=Be("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Chunker"),lr=Pe("","[S"),hr=Pe("[Lorg.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","BitTreeDecoder;"),fr=Be("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Decoder"),pr=Be("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Decoder$LenDecoder"),dr=Pe("[Lorg.dellroad.lzma.client.SevenZip.Compression.LZMA.","Decoder$LiteralDecoder$Decoder2;"),gr=Be("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Decoder$LiteralDecoder"),mr=Be("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Decoder$LiteralDecoder$Decoder2"),yr=Pe("[Lorg.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$Optimal;"),_r=Pe("[Lorg.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","BitTreeEncoder;"),vr=Pe("","[J"),br=Pe("","[Z"),wr=Be("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder"),xr=Pe("[Lorg.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$LiteralEncoder$Encoder2;"),Cr=Be("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$LiteralEncoder"),Er=Be("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$LiteralEncoder$Encoder2"),Sr=Be("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$LenEncoder"),Tr=Be("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$LenPriceTableEncoder"),Ar=Be("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$Optimal"),Mr=Be("org.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","BitTreeDecoder"),kr=Be("org.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","BitTreeEncoder"),Lr=Be("org.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","Decoder"),Or=Be("org.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","Encoder"),Rr=function(e,t){var n;return(n=new Ie).typeName=e+t,n}("org.dellroad.lzma.client.","CompressionMode"),Fr=Be("org.dellroad.lzma.client.","LZMACompressor"),Pr=Be("org.dellroad.lzma.client.","LZMAByteArrayCompressor"),Br=Be("org.dellroad.lzma.client.","LZMADecompressor"),Ir=Be("org.dellroad.lzma.client.","LZMAByteArrayDecompressor"),Nr=Be("org.dellroad.lzma.demo.client.","LZMADemo");!function(t,n,r){if(e=n,r,t)try{Rn()}catch(e){t(n)}else Rn()}(function(){},"lzma_demo","");var Dr=function(){var e=[{dictionarySize:16,fb:64,matchFinder:0,lc:3,lp:0,pb:2},{dictionarySize:20,fb:64,matchFinder:0,lc:3,lp:0,pb:2},{dictionarySize:19,fb:64,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:20,fb:64,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:21,fb:128,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:22,fb:128,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:23,fb:128,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:24,fb:255,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:25,fb:255,matchFinder:1,lc:3,lp:0,pb:2}];return function(t){return!function(e){return!isNaN(parseFloat(e))&&isFinite(e)}(t)?t=1:t<1?t=1:t>9&&(t=9),e[t-1]}}();return{compress:kn,decompress:Ln}}();e.exports=n},function(e,t,n){"use strict";var r=n(17),i=n(0),o=n(113),s=n(7),a=n(42),u=n(112),c=n(27),l=n(25),h=function(e){!function(e,t){var n=i.filter(t,function(t){return!e[t]});if(n.length)throw new Error("WindshaftClient could not be initialized. The following options are missing: "+n.join(", "))}(e,["urlTemplate","userName"]),e.templateName?this.endpoints={get:[a.MAPS_API_BASE_URL,"named",e.templateName,"jsonp"].join("/"),post:[a.MAPS_API_BASE_URL,"named",e.templateName].join("/")}:this.endpoints={get:a.MAPS_API_BASE_URL,post:a.MAPS_API_BASE_URL},this.url=e.urlTemplate.replace("{user}",e.userName),this._requestTracker=new u(3)};h.prototype.instantiateMap=function(e){this._requestTracker.canRequestBePerformed(e)?this._performRequest(e,{success:function(t){if(this._requestTracker.track(e,t),t.errors){var n=l(t);e.options.error&&e.options.error(n)}else e.options.success&&e.options.success(t)}.bind(this),error:function(t,n){if("abort"!==n){var r={},i={};try{r=JSON.parse(t.responseText),i=l(r)}catch(e){}this._requestTracker.track(e,r),e.options.error&&e.options.error(i)}}.bind(this)}):(c.error("Maximum number of subsequent equal requests to the Maps API reached (3):",e.payload,e.params),e.options.error&&e.options.error({}))},h.prototype._performRequest=function(e,t){var n=e.payload,r=e.params,i=this._generateEncodedURL(n,r);this._isURLValid(i)?this._get(i,t):this._generateCompressedURL(n,r,function(e){if(this._isURLValid(e))this._get(e,t);else{var i=this._getURL(r,"post");this._post(i,n,t)}}.bind(this))},h.prototype._generateEncodedURL=function(e,t){return t=i.extend({config:JSON.stringify(e)},t),this._getURL(t)},h.prototype._generateCompressedURL=function(e,t,n){var r=JSON.stringify({config:JSON.stringify(e)});o.compress(r,3,function(e){t=i.extend({lzma:s.array2hex(e)},t),n(this._getURL(t))}.bind(this))},h.prototype._isURLValid=function(e){return e.length<2033},h.prototype._post=function(e,t,n){this._abortPreviousRequest(),this._previousRequest=r.ajax({url:e,crossOrigin:!0,method:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(t),success:n.success,error:n.error})},h.prototype._get=function(e,t){this._abortPreviousRequest(),this._previousRequest=r.ajax({url:e,method:"GET",dataType:"jsonp",jsonpCallback:this._jsonpCallbackName(e),cache:!0,success:t.success,error:t.error})},h.prototype._abortPreviousRequest=function(){this._previousRequest&&this._previousRequest.abort()},h.prototype._getURL=function(e,t){t=t||"get";var n=this._convertParamsToQueryString(e),r=this.endpoints[t];return[this.url,r].join("/")+n},h.prototype._convertParamsToQueryString=function(e){var t=[];return i.each(e,function(e,n){e instanceof Array?i.each(e,function(e){t.push(n+"[]="+e)}):e instanceof Object?t.push(n+"="+encodeURIComponent(JSON.stringify(e))):t.push(n+"="+encodeURIComponent(e))}),t.length>0?"?"+t.join("&"):""},h.prototype._jsonpCallbackName=function(e){return"_cdbc_"+s.uniqueCallbackName(e)},e.exports=h},function(e,t,n){"use strict";var r=n(0),i=n(42);function o(e,t){this._windshaftSettings=e,this._layerGroupId=t.layergroupid,this._layers=t.metadata.layers,this._dataviews=t.metadata.dataviews,this._analyses=t.metadata.analyses,this._cdnUrl=t.cdn_url}o.prototype.getLayerIndexesByType=function(e){return r.reduce(this._getLayers(),function(t,n,r){return n.type===e&&t.push(r),t},[])},o.prototype.getBaseURL=function(){return[this._getHost(),i.MAPS_API_BASE_URL,this._layerGroupId].join("/")},o.prototype.getStaticBaseURL=function(){return[this._getHost(),i.MAPS_API_BASE_URL,"static/center",this._layerGroupId].join("/")},o.prototype._getHost=function(){var e=this._windshaftSettings.urlTemplate,t=this._windshaftSettings.userName,n=this.getProtocol(),r=this._cdnUrl,i=r&&r[n],o=r&&r.templates;return o&&o[n]?o[n].url+"/"+t:i?[n,"://",i,"/",t].join(""):e.replace("{user}",t)},o.prototype.getProtocol=function(){return this._isHttps()?"https":"http"},o.prototype._isHttps=function(){return 0===this._windshaftSettings.urlTemplate.indexOf("https")},o.prototype.getSupportedSubdomains=function(){var e=this._cdnUrl&&this._cdnUrl.templates,t=this.getProtocol();return e&&e[t]?e[t].subdomains:[]},o.prototype.getLayerMetadata=function(e){var t={},n=this._getLayers();return n&&n[e]&&(t=n[e].meta||{}),t},o.prototype.getDataviewMetadata=function(e){var t=this._getDataviews();if(t&&t[e])return t[e];t={};var n=r.compact(r.map(this._getLayers(),function(e){return e.widgets}));return r.each(n,function(e){r.extend(t,e)}),t&&t[e]?t[e]:void 0},o.prototype.getAnalysisNodeMetadata=function(e){var t={},n=r.map(this._getAnalyses(),function(e){return e.nodes});return r.each(n,function(e){r.extend(t,e)}),t[e]},o.prototype._getLayers=function(){return this._layers},o.prototype._getDataviews=function(){return this._dataviews},o.prototype._getAnalyses=function(){return this._analyses},e.exports=o},function(e,t,n){"use strict";var r=function(e,t,n){this.payload=e,this.params=t,this.options=n};r.prototype.toHashCode=function(){return JSON.stringify(this.payload)+JSON.stringify(this.params)+JSON.stringify(this.options)},r.prototype.equals=function(e){return this.toHashCode()===e.toHashCode()},e.exports=r},function(e,t,n){"use strict";var r=n(0),i=n(16);e.exports={serialize:function(e,t){return{buffersize:{mvt:0},styles:function(e){return r.reduce(e,function(e,t,n){return t.get("cartocss")&&(e[n]=t.get("cartocss")),e},{})}(e.filter(function(e){return!i.isGoogleMapsBaseLayer(e)}))}}}},function(e,t,n){"use strict";var r=n(0),i=n(15),o=["line-color","marker-fill","polygon-fill","marker-file"],s=["="],a=function(e){var t="",n=e.match(/(http|https):\/\/\S+\.(?:gif|jpeg|jpg|png|webp|svg)/g);return n&&(t=n[0]),t};e.exports={canAdapt:function(e){return(e=new i(e)).matchesAnyProperty(o)&&e.matchesAnyMapping(s)&&function(e){var t=e.getBucketsWithCategoryFilter();return r.every(t,function(e){return null!=e.filter.name&&null!=e.value})}(e)},adapt:function(e){var t=new i(e[0]),n=new i(e[1]),o=t.getBucketsWithCategoryFilter(),s=n.getBucketsWithCategoryFilter(),u=t.getBucketsWithDefaultFilter(),c=n.getBucketsWithDefaultFilter();return{categories:function(e,t){return r.map(e,function(e){var n=r.find(t,function(t){return t.filter.name===e.filter.name});return{title:e.filter.name,icon:n&&n.value?a(n.value):"",color:e.value}})}(o,s),default:{icon:r.isEmpty(c)?"":a(c[0].value),color:r.isEmpty(u)?"":u[0].value}}}}},function(e,t,n){"use strict";var r=n(0),i=n(15),o=["line-color","marker-fill","polygon-fill"],s=[">",">=","<","<="];e.exports={canAdapt:function(e){return(e=new i(e)).matchesAnyProperty(o)&&e.matchesAnyMapping(s)&&function(e){var t=e.getBucketsWithRangeFilter();return r.every(t,function(e){return null!=e.filter.start&&null!=e.filter.end})}(e)},adapt:function(e){var t=new i(e[0]),n=t.getBucketsWithRangeFilter(),o=r.last(n),s=r.first(n);return{colors:function(e){if(1===e.length){var t=e[0],n=t.filter.start,i=t.filter.end;return[{value:t.value,label:n.toString()},{value:t.value,label:i.toString()}]}return r.map(e,function(t,n){var r="";return 0===n?r=t.filter.start:n===e.length-1&&(r=t.filter.end),{value:t.value,label:r.toString()}})}(n),avg:t.getFilterAvg(),max:o.filter.end,min:s.filter.start}}}},function(e,t,n){"use strict";var r=n(0),i=n(15),o=["marker-width","line-width"];e.exports={canAdapt:function(e){return(e=new i(e)).matchesAnyProperty(o)&&function(e){var t=e.getBucketsWithRangeFilter();return r.every(t,function(e){return null!=e.filter.start&&null!=e.filter.end})}(e)},adapt:function(e){var t=new i(e[0]),n=t.getBucketsWithRangeFilter();return{values:function(e){var t=r.last(e);return r.chain(e).map("filter").map("start").concat(t.filter.end).value()}(n),sizes:r.map(n,"value"),avg:t.getFilterAvg()}}}},function(e,t,n){"use strict";var r={bubble:n(120),choropleth:n(119),category:n(118)};e.exports={getAdapterForLegend:function(e){return r[e.get("type")]}}},function(e,t,n){"use strict";var r={};r.VERSION=n(26).version,r.DEBUG=!1,r.helpers={},e.exports=r},function(e,t,n){"use strict";var r=n(0),i=n(27),o=n(7),s=n(121),a=n(29),u=n(1);var c=function(e){if(!e.layerGroupModel)throw new Error("layerGroupModel is required");if(!e.layersCollection)throw new Error("layersCollection is required");if(!e.dataviewsCollection)throw new Error("dataviewsCollection is required");this._layerGroupModel=e.layerGroupModel,this._layersCollection=e.layersCollection,this._dataviewsCollection=e.dataviewsCollection};c.prototype.updateModels=function(e,t,n){this._updateLayerModels(e),this._updateLayerGroupModel(e),this._updateDataviewModels(e,t,n),this._updateAnalysisModels(e)},c.prototype._updateLayerGroupModel=function(e){var t={tiles:this._generateTileURLTemplate(e),subdomains:e.getSupportedSubdomains(),grids:this._calculateGridURLTemplatesForCartoDBLayers(e),attributes:this._calculateAttributesBaseURLsForCartoDBLayers(e),image:this._calculateStaticMapURL(e)};this._layerGroupModel.set({indexOfLayersInWindshaft:e.getLayerIndexesByType("mapnik"),urls:t})},c.prototype._calculateStaticMapURL=function(e){return[e.getStaticBaseURL(),"{z}/{lat}/{lng}/{width}/{height}.{format}"].join("/")},c.prototype._generateTileURLTemplate=function(e){return e.getBaseURL()+"/{layerIndexes}/{z}/{x}/{y}.{format}"},c.prototype._calculateGridURLTemplatesForCartoDBLayers=function(e){var t=[],n=e.getLayerIndexesByType("mapnik");return n.length>0&&r.each(n,function(n){var i=[],o=this._generateGridURLTemplate(e,n),s=e.getSupportedSubdomains();s.length?r.each(s,function(e){i.push(o.replace("{s}",e))}):i.push(o),t.push(i)},this),t},c.prototype._generateGridURLTemplate=function(e,t){return e.getBaseURL()+"/"+t+"/{z}/{x}/{y}.grid.json"},c.prototype._calculateAttributesBaseURLsForCartoDBLayers=function(e){var t=[],n=e.getLayerIndexesByType("mapnik");return n.length>0&&r.each(n,function(n){t.push(this._generateAttributesBaseURL(e,n))},this),t},c.prototype._generateAttributesBaseURL=function(e,t){var n=e.getBaseURL()+"/"+t+"/attributes";if(n.indexOf("{s}")>=0){var r=function(e,t){return e[o.crc32(t)%e.length]}(e.getSupportedSubdomains(),n);n=n.replace("{s}",r)}return n},c.prototype._updateLayerModels=function(e){var t=e.getLayerIndexesByType("mapnik");r.each(this._layersCollection.getCartoDBLayers(),function(n,r){var i=t[r];n.set("meta",e.getLayerMetadata(i)),this._updateLegendModels(n,i,e),n.setOk()},this);var n=e.getLayerIndexesByType("torque");r.each(this._layersCollection.getTorqueLayers(),function(t,r){var i=n[r],o=e.getLayerMetadata(i);t.set("meta",o),t.set(o),t.set("subdomains",e.getSupportedSubdomains()),t.set("tileURLTemplates",this._calculateTileURLTemplatesForTorqueLayers(e)),this._updateLegendModels(t,i,e),t.setOk()},this)},c.prototype._calculateTileURLTemplatesForTorqueLayers=function(e){var t=[],n=e.getLayerIndexesByType("torque");return n.length>0&&t.push(this._generateTorqueTileURLTemplate(e,n)),t},c.prototype._generateTorqueTileURLTemplate=function(e,t){return e.getBaseURL()+"/"+t.join(",")+"/{z}/{x}/{y}.json.torque"},c.prototype._updateLegendModels=function(e,t,n){var i=n.getLayerMetadata(t);r.each(this._getLayerLegends(e),function(e){this._updateLegendModel(e,i)},this)},c.prototype._updateLegendModel=function(e,t){var n=t&&t.cartocss_meta&&t.cartocss_meta.rules;try{var o={state:"success"};if(n){var a=s.getAdapterForLegend(e),u=r.filter(n,a.canAdapt);r.isEmpty(u)||(o=r.extend(o,a.adapt(u)))}e.set(o)}catch(t){e.set({state:"error"}),i.error("legend of type '"+e.get("type")+"' couldn't be updated: "+t.message)}},c.prototype._updateDataviewModels=function(e,t,n){this._dataviewsCollection.each(function(r){var i=e.getDataviewMetadata(r.get("id"));i&&r.set({url:i.url[this._getProtocol()]},{sourceId:t,forceFetch:n})},this)},c.prototype._updateAnalysisModels=function(e){this._getUniqueAnalysisNodesCollection().each(function(t){var n,i=e.getAnalysisNodeMetadata(t.get("id"));i&&(n={status:i.status,url:i.url[this._getProtocol()],query:i.query},n=r.omit(n,t.getParamNames()),i.error_message?(n=r.extend(n,{error:{message:i.error_message}}),t.set(n)):(t.set(n),t.setOk()))},this)},c.prototype._getProtocol=function(){return"file:"===window.location.protocol?"http":window.location.protocol.replace(":","")},c.prototype.setErrors=function(e){r.each(e,this._setError,this),this._setLegendErrors()},c.prototype._setError=function(e){if(e.isLayerError()){var t=this._layersCollection.get(e.layerId);t&&t.setError(e)}else if(e.isAnalysisError()){var n=this._getUniqueAnalysisNodesCollection().get(e.analysisId);n&&n.setError(e)}},c.prototype._setLegendErrors=function(){var e=this._layersCollection.chain().map(this._getLayerLegends).compact().flatten().value();r.each(e,function(e){e.set("state","error")})},c.prototype._getLayerLegends=function(e){return e.legends&&[e.legends.bubble,e.legends.category,e.legends.choropleth]},c.prototype._getUniqueAnalysisNodesCollection=function(){var e=a.getUniqueAnalysisNodes(this._layersCollection,this._dataviewsCollection);return new u.Collection(e)},e.exports=c},function(e,t,n){"use strict";var r=n(0),i=n(1).Collection.extend({initialize:function(){this.comparator=function(e){return parseInt(e.get("order"),10)},this.bind("add",this._assignIndexes),this.bind("remove",this._assignIndexes)},_assignIndexes:function(e,t,n){if(this.size()>0&&(this.at(0).set({order:0}),this.size()>1)){var i=this.reduce(function(e,t,n){var r=t.get("type");return 0===n&&"Tiled"===r?e:(e[r]=e[r]||[],e[r].push(t),e)},{}),o=1,s=["CartoDB","torque","Tiled"];r.each(s,function(e){var t=i[e]||[];r.each(t,function(e){e.set({order:o}),o+=1})})}this.sort()},getCartoDBLayers:function(){return this._getLayersByType("CartoDB")},getTiledLayers:function(){return this._getLayersByType("Tiled")},getTorqueLayers:function(){return this._getLayersByType("torque")},_getLayersByType:function(e){return this.select(function(t){return t.get("type")===e})},getLayersWithLegends:function(){return this.select(function(e){return!!e.legends})},moveCartoDBLayer:function(e,t){if(e===t)return!1;var n=this.at(e);return!(!n||"CartoDB"!==n.get("type"))&&(this.remove(n,{silent:!0}),this.add(n,{at:t,silent:!0}),this.trigger("layerMoved",n),n)}});e.exports=i},function(e,t,n){"use strict";var r=n(0),i=n(1).Collection.extend({isAnyDataviewFiltered:function(){return this.any(function(e){var t=e.filter;return t&&!t.isEmpty()})},getFilters:function(){return this.reduce(function(e,t){var n=t.filter;return n&&!n.isEmpty()&&(e.dataviews=e.dataviews||{},r.extend(e.dataviews,n.toJSON())),e},{})}});e.exports=i},function(e,t,n){"use strict";var r=n(0),i=n(17),o=n(1),s=n(16),a=n(7),u=o.Model.extend({defaults:{visible:!0,type:"layergroup"},initialize:function(e,t){if(!(t=t||{}).layersCollection)throw new Error("layersCollection option is required");this._layersCollection=t.layersCollection},addError:function(e){var t=e.type;if(!t)throw new Error("Error must have a type property.");this.trigger("error:"+t,e)},forEachGroupedLayer:function(e,t){r.each(this._getGroupedLayers(),e.bind(t||this))},_getGroupedLayers:function(){return this._layersCollection.getCartoDBLayers()},_getLayers:function(){return this._layersCollection.reject(s.isGoogleMapsBaseLayer)},getIndexOfLayerInLayerGroup:function(e){return this._getGroupedLayers().indexOf(e)},getLayerInLayerGroupAt:function(e){return this._getGroupedLayers()[e]},getCartoLayerById:function(e){return this._layersCollection.get(e)},isEqual:function(){return!1},hasURLs:function(){return!!this.get("urls")},getSubdomains:function(){return this.get("urls")&&this.get("urls").subdomains||[]},getTileURLTemplatesWithSubdomains:function(){var e=this.getTileURLTemplate(),t=this.getSubdomains();return t&&t.length?r.map(t,function(t){return e.replace("{s}",t)}):[e]},getTileURLTemplate:function(e){e=e||"png";var t=this.get("urls")&&this.get("urls").tiles;return t?"png"===e?this._areAllLayersHidden()?"":this._generatePNGTileURLTemplate(t):"mvt"===e?this._generateMTVTileURLTemplate(t):void 0:""},_generatePNGTileURLTemplate:function(e){var t=this._getIndexesOfVisibleMapnikLayers();return t?(e=e.replace("{layerIndexes}",t).replace("{format}","png"),this._appendAuthParamsToURL(e)):""},_generateMTVTileURLTemplate:function(e){return e=e.replace("{layerIndexes}","mapnik").replace("{format}","mvt"),this._appendAuthParamsToURL(e)},_areAllLayersHidden:function(){return r.all(this._getGroupedLayers(),function(e){return!e.isVisible()})},_getIndexesOfVisibleMapnikLayers:function(e){var t=this.get("indexOfLayersInWindshaft");return r.reduce(this._getGroupedLayers(),function(e,n,r){return n.isVisible()&&e.push(t[r]),e},[]).join(",")},_getIndexesOfVisibleLayers:function(e){return r.reduce(this._getLayers(),function(e,t,n){return t.isVisible()&&e.push(n),e},[]).join(",")},hasTileURLTemplates:function(){return!!this.getTileURLTemplate()},getGridURLTemplatesWithSubdomains:function(e){var t=this.get("urls")&&this.get("urls").grids&&this.get("urls").grids[e]||[];if(this.get("urls")&&this.get("urls").subdomains){var n=this.get("urls").subdomains;t=r.map(t,function(e,t){return e.replace("{s}",n[t])})}return r.map(t,this._appendAuthParamsToURL,this)},getAttributesBaseURL:function(e){return this.get("urls")&&this.get("urls").attributes&&this.get("urls").attributes[e]},getStaticImageURLTemplate:function(){var e=this.get("urls")&&this.get("urls").image;return e&&(e=this._appendParamsToURL(e,["layer="+this._getIndexesOfVisibleLayers()]),e=(e=this._appendAuthParamsToURL(e)).replace("{s}",this.getSubdomains()[0])),e},fetchAttributes:function(e,t,n){var r=this.getAttributesBaseURL(e);if(!r)throw new Error("Attributes cannot be fetched until urls are set");var o=this._appendAuthParamsToURL(r+"/"+t);i.ajax({dataType:"jsonp",url:o,jsonpCallback:"_cdbi_layer_attributes_"+a.uniqueCallbackName(this.toJSON()),cache:!0,success:function(e){n(e)},error:function(e){n(null)}})},_appendAuthParamsToURL:function(e){var t=[];if(this.get("apiKey"))t.push("api_key="+this.get("apiKey"));else if(this.get("authToken")){var n=this.get("authToken");n instanceof Array?r.each(n,function(e){t.push("auth_token[]="+e)}):t.push("auth_token="+n)}return this._appendParamsToURL(e,t)},_appendParamsToURL:function(e,t){if(t.length){var n="?";return-1!==e.indexOf("?")&&(n="&"),e+n+t.join("&")}return e},onLayerVisibilityChanged:function(e){this._layersCollection.on("change:visible",function(t){this._isLayerGrouped(t)&&e(t)},this)},onLayerAdded:function(e){this._layersCollection.on("add",function(t){this._isLayerGrouped(t)&&e(t,this.getLayerInLayerGroupAt(t))},this)},_isLayerGrouped:function(e){return this._getGroupedLayers().indexOf(e)>=0}});e.exports=u},function(e,t,n){"use strict";var r=n(0),i=n(16),o="2.1.0",s="http",a="plain",u="mapnik",c="torque";function l(e){return i.isTiledLayer(e)?function(e){return{id:e.get("id"),type:s,options:{urlTemplate:e.get("urlTemplate"),subdomains:e.get("subdomains"),tms:e.get("tms")}}}(e):i.isPlainLayer(e)?function(e){return{id:e.get("id"),type:a,options:{color:e.get("color"),imageUrl:e.get("image")}}}(e):i.isWMSLayer(e)?function(e){return{id:e.get("id"),type:s,options:{urlTemplate:e.get("urlTemplate"),tms:!0}}}(e):i.isCartoDBLayer(e)?function(e){var t=h(e);t.interactivity=e.getInteractiveColumnNames(),e.infowindow&&e.infowindow.hasFields()&&(t.attributes={id:"cartodb_id",columns:e.infowindow.getFieldNames()});isFinite(e.get("minzoom"))&&(t.minzoom=e.get("minzoom"));isFinite(e.get("maxzoom"))&&(t.maxzoom=e.get("maxzoom"));r.isEmpty(e.aggregation)||r.extend(t,{aggregation:e.aggregation});return{id:e.get("id"),type:u,options:t}}(e):i.isTorqueLayer(e)?function(e){var t=h(e);return{id:e.get("id"),type:c,options:t}}(e):void 0}function h(e){var t={cartocss:e.get("cartocss"),cartocss_version:e.get("cartocss_version")||o};return t.source={id:e.getSourceId()},e.get("sql_wrap")&&(t.sql_wrap=e.get("sql_wrap")),t}e.exports={serialize:function(e){return e.chain().map(l).compact().value()}}},function(e,t,n){"use strict";e.exports={serialize:function(e){return e.reduce(function(e,t){return e[t.get("id")]=t.toJSON(),e},{})}}},function(e,t,n){"use strict";var r=n(43);function i(e,t){t=t||"latest",this.definition=e,this.reference=r.getVersion(t)}function o(e,t){var n=t.analyses[e];return Object.keys(n.params).reduce(function(e,t){return"node"===n.params[t].type&&e.push(t),e},[])}function s(e,t){return function(n){return!function(e,t,n){return n.analyses[e].params[t].optional}(e.type,n,t)||!!e.params[n]}}e.exports=i,i.prototype.getNodesWithId=function(){return function e(t,n,r){n.id&&(t[n.id]=n);o(n.type,r).filter(s(n,r)).forEach(function(i){e(t,n.params[i],r)});return t}({},this.definition,this.reference)},i.prototype.getChildNodesNames=function(){return o(this.definition.type,this.reference)},i.prototype.getNodesList=function(){return function e(t,n,r){t.push(n);o(n.type,r).filter(s(n,r)).forEach(function(i){e(t,n.params[i],r)});return t}([],this.definition,this.reference)},i.prototype.getDefinitionWith=function(e,t){return function e(t,n,r,i){t.id&&t.id===r&&Object.keys(i).forEach(function(e){t.params.hasOwnProperty(e)||(t.params[e]={});var n=i[e];Object.keys(n).forEach(function(r){t.params[e][r]=n[r]})});o(t.type,n).filter(s(t,n)).forEach(function(o){e(t.params[o],n,r,i)});return t}(this.definition,this.reference,e,t)}},function(e){e.exports={version:"0.59.4",analyses:{"aggregate-intersection":{params:{source:{type:"node",geometry:["*"]},target:{type:"node",geometry:["*"]},aggregate_function:{type:"enum",values:["avg","count","max","min","sum"]},aggregate_column:{type:"string",optional:!0}}},"bounding-box":{params:{source:{type:"node",geometry:["*"]},category_column:{type:"string",optional:!0},aggregation:{type:"enum",values:["avg","count","max","min","sum"],optional:!0,"default-value":"count"},aggregation_column:{type:"string",optional:!0}}},"bounding-circle":{params:{source:{type:"node",geometry:["*"]},category_column:{type:"string",optional:!0},aggregation:{type:"enum",values:["avg","count","max","min","sum"],optional:!0,"default-value":"count"},aggregation_column:{type:"string",optional:!0}}},buffer:{params:{source:{type:"node",geometry:["*"]},radius:{type:"number"},isolines:{type:"number",optional:!0},dissolved:{type:"boolean",optional:!0}}},centroid:{params:{source:{type:"node",geometry:["*"]},category_column:{type:"string",optional:!0},aggregation:{type:"string",optional:!0,"default-value":"count"},aggregation_column:{type:"string",optional:!0}}},closest:{params:{source:{type:"node",geometry:["*"]},target:{type:"node",geometry:["*"]},responses:{type:"number",optional:!0,"default-value":1},category:{type:"string",optional:!0}}},"concave-hull":{params:{source:{type:"node",geometry:["*"]},category_column:{type:"string",optional:!0},target_percent:{type:"number",optional:!0,"default-value":.7},allow_holes:{type:"boolean",optional:!0,"default-value":!1},aggregation:{type:"enum",values:["avg","count","max","min","sum"],optional:!0,"default-value":"count"},aggregation_column:{type:"string",optional:!0}}},contour:{params:{source:{type:"node",geometry:["point"]},column:{type:"string"},buffer:{type:"number",optional:!0,"default-value":.2},method:{type:"enum",values:["nearest_neighbor","barymetric","IDW"],optional:!0,"default-value":"barymetric"},class_method:{type:"enum",values:["equals","headstails","jenks","quantiles"],optional:!0,"default-value":"quantiles"},steps:{type:"number",optional:!0,"default-value":7},resolution:{type:"number",optional:!0,"default-value":-90}}},"convex-hull":{params:{source:{type:"node",geometry:["*"]},category_column:{type:"string",optional:!0},aggregation:{type:"enum",values:["avg","count","max","min","sum"],optional:!0,"default-value":"count"},aggregation_column:{type:"string",optional:!0}}},"data-observatory-measure":{params:{source:{type:"node",geometry:["point","polygon"]},final_column:{type:"string"},segment_name:{type:"string"},percent:{type:"boolean",optional:!0}}},"data-observatory-multiple-measures":{params:{source:{type:"node",geometry:["point","polygon"]},numerators:{type:"array"},normalizations:{type:"array"},denominators:{type:"array"},geom_ids:{type:"array"},numerator_timespans:{type:"array"},column_names:{type:"array"}}},"deprecated-sql-function":{params:{function_name:{type:"string"},primary_source:{type:"node",geometry:["*"]},secondary_source:{type:"node",geometry:["*"],optional:!0},function_args:{type:"array",optional:!0}}},"filter-by-node-column":{params:{source:{type:"node",geometry:["*"]},column:{type:"string"},filter_source:{type:"node",geometry:["*"]},filter_column:{type:"string"}}},"filter-category":{params:{source:{type:"node",geometry:["*"]},column:{type:"string"},accept:{type:"array",optional:!0},reject:{type:"array",optional:!0}}},"filter-grouped-rank":{params:{source:{type:"node",geometry:["*"]},column:{type:"string"},rank:{type:"enum",values:["top","bottom"]},group:{type:"string"},min:{type:"number",optional:!0},max:{type:"number",optional:!0}}},"filter-range":{params:{source:{type:"node",geometry:["*"]},column:{type:"string"},min:{type:"number",optional:!0},max:{type:"number",optional:!0},greater_than:{type:"number",optional:!0},greater_than_or_equal:{type:"number",optional:!0},less_than:{type:"number",optional:!0},less_than_or_equal:{type:"number",optional:!0}}},"filter-rank":{params:{source:{type:"node",geometry:["*"]},column:{type:"string"},rank:{type:"enum",values:["top","bottom"]},limit:{type:"number"},action:{type:"enum",values:["show","hide"],optional:!0,"default-value":"show"}}},"georeference-admin-region":{params:{source:{type:"node",geometry:["*"]},admin_region_column:{type:"string"},country:{type:"string",optional:!0},country_column:{type:"string",optional:!0}}},"georeference-city":{params:{source:{type:"node",geometry:["*"]},city_column:{type:"string"},admin_region:{type:"string",optional:!0},admin_region_column:{type:"string",optional:!0},country:{type:"string",optional:!0},country_column:{type:"string",optional:!0}}},"georeference-country":{params:{source:{type:"node",geometry:["*"]},country_column:{type:"string"}}},"georeference-ip-address":{params:{source:{type:"node",geometry:["*"]},ip_address:{type:"string"}}},"georeference-long-lat":{params:{source:{type:"node",geometry:["*"]},longitude:{type:"string"},latitude:{type:"string"}}},"georeference-postal-code":{params:{source:{type:"node",geometry:["*"]},output_geometry_type:{type:"enum",values:["point","polygon"],optional:!0,"default-value":"point"},postal_code_column:{type:"string"},country:{type:"string",optional:!0},country_column:{type:"string",optional:!0}}},"georeference-street-address":{params:{source:{type:"node",geometry:["*"]},street_address_column:{type:"string",optional:!0},street_address_template:{type:"string",optional:!0},city:{type:"string",optional:!0},city_column:{type:"string",optional:!0},state:{type:"string",optional:!0},state_column:{type:"string",optional:!0},country:{type:"string",optional:!0},country_column:{type:"string",optional:!0}}},gravity:{params:{source:{type:"node",geometry:["*"]},target:{type:"node",geometry:["*"]},weight_column:{type:"string"},weight_threshold:{type:"number",optional:!0,"default-value":-1e308},pop_column:{type:"string"},max_distance:{type:"number"},target_id:{type:"number"}}},intersection:{params:{source:{type:"node",geometry:["*"]},source_columns:{type:"array",optional:!0,"default-value":[]},target:{type:"node",geometry:["*"]}}},kmeans:{params:{source:{type:"node",geometry:["point"]},clusters:{type:"number"}}},"line-sequential":{params:{source:{type:"node",geometry:["point"]},order_column:{type:"string"},order_type:{type:"enum",values:["asc","desc"]},category_column:{type:"string",optional:!0}}},"line-source-to-target":{params:{source:{type:"node",geometry:["point"]},source_column:{type:"string",optional:!0},target:{type:"node",geometry:["point"]},target_column:{type:"string",optional:!0},closest:{type:"boolean"}}},"line-to-column":{params:{source:{type:"node",geometry:["point"]},target_column:{type:"string"}}},"line-to-single-point":{params:{source:{type:"node",geometry:["point"]},destination_longitude:{type:"number"},destination_latitude:{type:"number"}}},"link-by-line":{params:{source_points:{type:"node",geometry:["point"]},destination_points:{type:"node",geometry:["point"]},source_column:{type:"string"},destination_column:{type:"string"},use_great_circle:{type:"boolean",optional:!0,"default-value":!1}}},merge:{params:{left_source:{type:"node",geometry:["*"]},right_source:{type:"node",geometry:["*"]},left_source_column:{type:"string"},right_source_column:{type:"string"},join_operator:{type:"enum",values:["inner","left","right"],optional:!0,"default-value":"inner"},source_geometry:{type:"enum",values:["left_source","right_source"],optional:!0,"default-value":"left_source"},left_source_columns:{type:"array",optional:!0},right_source_columns:{type:"array",optional:!0,"default-value":[]}}},moran:{params:{source:{type:"node",geometry:["polygon","point"]},numerator_column:{type:"string"},denominator_column:{type:"string",optional:!0},significance:{type:"number"},neighbours:{type:"number",optional:!0},permutations:{type:"number",optional:!0},w_type:{type:"enum",values:["knn","queen"],optional:!0,"default-value":"knn"}}},"point-in-polygon":{params:{points_source:{type:"node",geometry:["point"]},polygons_source:{type:"node",geometry:["polygon"]}}},"population-in-area":{params:{source:{type:"node",geometry:["polygon"]},final_column:{type:"string"}}},"routing-sequential":{params:{source:{type:"node",geometry:["point"]},mode:{type:"enum",values:["car","walk","bicycle","public_transport"]},units:{type:"enum",values:["kilometers","miles"],optional:!0,"default-value":"kilometers"},order_column:{type:"string",optional:!0,"default-value":"cartodb_id"},order_type:{type:"enum",values:["asc","desc"],optional:!0,"default-value":"asc"}}},"routing-to-layer-all-to-all":{params:{source:{type:"node",geometry:["point"]},source_column:{type:"string"},target:{type:"node",geometry:["point"]},target_column:{type:"string"},mode:{type:"enum",values:["car","walk","bicycle","public_transport"]},units:{type:"enum",values:["kilometers","miles"],optional:!0,"default-value":"kilometers"},closest:{type:"boolean"}}},"routing-to-single-point":{params:{source:{type:"node",geometry:["point"]},mode:{type:"enum",values:["car","walk","bicycle","public_transport"]},destination_longitude:{type:"number"},destination_latitude:{type:"number"},units:{type:"enum",values:["kilometers","miles"],optional:!0,"default-value":"kilometers"}}},sampling:{params:{source:{type:"node",geometry:["*"]},sampling:{type:"number"},seed:{type:"number",optional:!0}}},source:{params:{query:{type:"string"}}},"spatial-markov-trend":{params:{source:{type:"node",geometry:["*"]},time_columns:{type:"array"},num_classes:{type:"number",optional:!0,"default-value":5},weight_type:{type:"string",optional:!0,"default-value":"knn"},num_ngbrs:{type:"number",optional:!0,"default-value":5},permutations:{type:"number",optional:!0,"default-value":0},geom_col:{type:"string",optional:!0,"default-value":"the_geom"},id_col:{type:"string",optional:!0,"default-value":"cartodb_id"}}},"trade-area":{params:{source:{type:"node",geometry:["point"]},kind:{type:"enum",values:["walk","car"]},time:{type:"number"},isolines:{type:"number"},dissolved:{type:"boolean"}}},"weighted-centroid":{params:{source:{type:"node",geometry:["*"]},weight_column:{type:"string"},category_column:{type:"string",optional:!0},aggregation:{type:"string",optional:!0,"default-value":"count"},aggregation_column:{type:"string",optional:!0}}}}}},function(e,t,n){var r={"./0.59.4/reference.json":130};function i(e){var t=o(e);return n(t)}function o(e){var t=r[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}i.keys=function(){return Object.keys(r)},i.resolve=o,e.exports=i,i.id=131},function(e,t){e.exports.versions=["0.1.0","0.2.0","0.3.0","0.4.0","0.6.0","0.7.0","0.9.0","0.10.0","0.14.0","0.15.0","0.16.0","0.17.0","0.18.0","0.19.0","0.20.0","0.21.0","0.22.0","0.23.0","0.26.0","0.27.0","0.29.0","0.33.0","0.34.0","0.37.0","0.37.1","0.38.0","0.40.0","0.41.0","0.43.0","0.44.0","0.47.0","0.51.0","0.52.0","0.54.0","0.55.0","0.55.1","0.58.1","0.59.3","0.59.4"],e.exports.target="0.59.4"},function(e,t,n){"use strict";var r=n(43),i=n(129);e.exports.getVersion=r.getVersion,e.exports.versions=r.versions,e.exports.AnalysisGraph=i},function(e,t,n){"use strict";var r=n(0),i=n(29);e.exports={serialize:function(e,t){return function(e){var t={};return r.reduce(e,function(n,i){return t[i.get("id")]||function(e,t){return r.any(t,function(t){return!e.equals(t)&&t.findAnalysisById(e.get("id"))})}(i,e)||(t[i.get("id")]=!0,n.push(i.toJSON())),n},[])}(i.getAnalysisList(e,t))}}},function(e,t,n){"use strict";var r=n(134),i=n(128),o=n(127);e.exports={serialize:function(e,t){return{buffersize:{mvt:0},layers:o.serialize(e),dataviews:i.serialize(t),analyses:r.serialize(e,t)}}}},function(e,t,n){var r,i,o;
/*!
(c) 2012 Uzi Kilon, Splunk Inc.
Backbone Poller 1.1.4
https://github.com/uzikilon/backbone-poller
Backbone Poller may be freely distributed under the MIT license.
*/
/*!
(c) 2012 Uzi Kilon, Splunk Inc.
Backbone Poller 1.1.4
https://github.com/uzikilon/backbone-poller
Backbone Poller may be freely distributed under the MIT license.
*/
!function(s,a){"use strict";i=[n(0),n(1)],void 0===(o="function"==typeof(r=function(e,t){var n={delay:1e3,condition:function(){return!0}},r=["start","stop","fetch","success","error","complete"],i=[];var o={get:function(t,n){var r=function(t){return e.find(i,function(e){return e.model===t})}(t);return r?r.set(n):(r=new s(t,n),i.push(r)),n&&!0===n.autostart&&r.start({silent:!0}),r},size:function(){return i.length},reset:function(){for(;i.length;)i[0].destroy()}};function s(n,r){this.model=n,this.cid=e.uniqueId("poller"),this.set(r),this.model instanceof t.Model&&this.listenTo(this.model,"destroy",this.destroy)}function a(t){if(h(t)){var n=e.extend({},t.options,{success:function(e,n){t.trigger("success",e,n),l(t)},error:function(e,n){t.options.continueOnError?(t.trigger("error",e,n),l(t)):(t.stop({silent:!0}),t.trigger("error",e,n))}});t.trigger("fetch",t.model),t.xhr=t.model.fetch(n)}}e.extend(s.prototype,t.Events,{set:function(t){return this.options=e.extend({},n,t||{}),this.options.flush&&this.off(),e.each(r,e.bind(function(t){var n=this.options[t];e.isFunction(n)&&(this.off(t,n,this),this.on(t,n,this))},this)),this.stop({silent:!0})},start:function(t){return this.active()||(t&&t.silent||this.trigger("start",this.model),this.options.active=!0,this.options.delayed?l(this,e.isNumber(this.options.delayed)&&this.options.delayed):a(this)),this},stop:function(e){return e&&e.silent||this.trigger("stop",this.model),this.options.active=!1,this.xhr&&this.xhr.abort&&this.xhr.abort(),this.xhr=null,clearTimeout(this.timeoutId),this.timeoutId=null,this},active:function(){return!0===this.options.active},destroy:function(){var t=e.indexOf(i,this);t>-1&&(this.stop().stopListening().off(),i.splice(t,1))}});var u={};function c(t){if(e.isNumber(t.options.delay))return t.options.delay;var n=t.options.delay[0],r=t.options.delay[1],i=t.options.delay[2]||2;u[t.cid]?e.isFunction(i)?u[t.cid]=i(u[t.cid]):u[t.cid]*=i:u[t.cid]=1;var o=Math.round(n*u[t.cid]);return r&&r>0&&(o=Math.min(o,r)),o}function l(t,n){h(t)&&(t.timeoutId=e.delay(a,n||c(t),t))}function h(e){return!!e.options.active&&(!0===e.options.condition(e.model)||(e.stop({silent:!0}),e.trigger("complete",e.model),!1))}return o.getDelay=c,o.prototype=s.prototype,o})?r.apply(t,i):r)||(e.exports=o)}()},function(e,t,n){"use strict";var r=n(0),i=n(136);function o(){this._pollers=[]}o.CONFIG={START_DELAY:1e3,MAX_DELAY:1/0,DELAY_MULTIPLIER:1.5},o.prototype.resetAnalysisNodes=function(e){this.reset(),r.each(e,function(e){this._poll(e)},this)},o.prototype._poll=function(e){this._canBePolled(e)&&this._createPoller(e).start()},o.prototype._canBePolled=function(e){return e.url()&&!e.isDone()},o.prototype._findPoller=function(e){return r.find(this._pollers,function(t){return t.model===e})},o.prototype._createPoller=function(e){var t={delay:[o.CONFIG.START_DELAY,o.CONFIG.MAX_DELAY,o.CONFIG.DELAY_MULTIPLIER],condition:function(e){return!e.isDone()}},n=i.get(e,t);return this._pollers.push(n),n},o.prototype.reset=function(){i.reset(),this._pollers=[]},e.exports=o},function(e,t,n){"use strict";e.exports={track:function(e){if(window.trackJs)try{var t=e?e.message+" - code: "+e.errorCode:JSON.stringify(e);window.trackJs.track(new Error(t))}catch(e){}}}},function(e,t,n){"use strict";e.exports={layer:{"non-valid-source":{messageRegex:/nonValidSource/,friendlyMessage:'The given object is not a valid source. See "carto.source.Base".'},"non-valid-style":{messageRegex:/nonValidStyle/,friendlyMessage:'The given object is not a valid style. See "carto.style.Base".'},"non-valid-columns":{messageRegex:/nonValidColumns/,friendlyMessage:"The given object is not a valid array of string columns."},"source-with-different-client":{messageRegex:/differentSourceClient/,friendlyMessage:"A layer can't have a source which belongs to a different client."},"style-with-different-client":{messageRegex:/differentStyleClient/,friendlyMessage:"A layer can't have a style which belongs to a different client."},"wrong-interactivity-columns":{messageRegex:/wrongInteractivityColumns\[(.+)\]#(.+)$/,friendlyMessage:"Columns [$0] set on `$1` do not match the columns set in aggregation options."}},source:{"query-required":{messageRegex:/requiredQuery/,friendlyMessage:"SQL Source must have a SQL query."},"query-string":{messageRegex:/requiredString/,friendlyMessage:"SQL Query must be a string."},"no-dataset-name":{messageRegex:/noDatasetName/,friendlyMessage:"Table name is required."},"dataset-string":{messageRegex:/requiredDatasetString$/,friendlyMessage:"Table name must be a string."},"dataset-required":{messageRegex:/requiredDataset$/,friendlyMessage:"Table name must be not empty."}},style:{"required-css":{messageRegex:/requiredCSS$/,friendlyMessage:"CartoCSS is required."},"css-string":{messageRegex:/requiredCSSString$/,friendlyMessage:"CartoCSS must be a string."}},client:{"bad-layer-type":{messageRegex:/badLayerType/,friendlyMessage:"The given object is not a layer."},"index-number":{messageRegex:/indexNumber/,friendlyMessage:"index property must be a number."},"index-out-of-range":{messageRegex:/indexOutOfRange/,friendlyMessage:"index is out of range."},"api-key-required":{messageRegex:/apiKeyRequired/,friendlyMessage:"apiKey property is required."},"api-key-string":{messageRegex:/apiKeyString/,friendlyMessage:"apiKey property must be a string."},"username-required":{messageRegex:/usernameRequired/,friendlyMessage:"username property is required."},"username-string":{messageRegex:/usernameString/,friendlyMessage:"username property must be a string."},"non-valid-server-url":{messageRegex:/nonValidServerURL/,friendlyMessage:"serverUrl is not a valid URL."},"non-matching-server-url":{messageRegex:/serverURLDoesntMatchUsername/,friendlyMessage:"serverUrl doesn't match the username."},"duplicated-layer-id":{messageRegex:/duplicatedLayerId/,friendlyMessage:"A layer with the same ID already exists in the client."}},dataview:{"source-required":{messageRegex:/sourceRequired/,friendlyMessage:"Source property is required."},"column-required":{messageRegex:/columnRequired/,friendlyMessage:"Column property is required."},"column-string":{messageRegex:/columnString/,friendlyMessage:"Column property must be a string."},"empty-column":{messageRegex:/emptyColumn/,friendlyMessage:"Column property must be not empty."},"filter-required":{messageRegex:/filterRequired/,friendlyMessage:"Filter property is required."},"time-series-options-required":{messageRegex:/timeSeriesOptionsRequired/,friendlyMessage:"Options object to create a time series dataview is required."},"time-series-invalid-aggregation":{messageRegex:/timeSeriesInvalidAggregation/,friendlyMessage:"Time aggregation must be a valid value. Use carto.dataview.timeAggregation."},"time-series-invalid-offset":{messageRegex:/timeSeriesInvalidOffset/,friendlyMessage:"Offset must an integer value between -12 and 14."},"time-series-invalid-uselocaltimezone":{messageRegex:/timeSeriesInvalidUselocaltimezone/,friendlyMessage:"useLocalTimezone must be a boolean value."},"histogram-options-required":{messageRegex:/histogramOptionsRequired/,friendlyMessage:"Options object to create a histogram dataview is required."},"histogram-invalid-bins":{messageRegex:/histogramInvalidBins/,friendlyMessage:"Bins must be a positive integer value."},"histogram-invalid-start-end":{messageRegex:/histogramInvalidStartEnd/,friendlyMessage:"Both start and end values must be a number or null."},"formula-options-required":{messageRegex:/formulaOptionsRequired/,friendlyMessage:"Formula dataview options are not defined."},"formula-invalid-operation":{messageRegex:/formulaInvalidOperation/,friendlyMessage:"Operation for formula dataview is not valid. Use carto.operation"},"category-options-required":{messageRegex:/categoryOptionsRequired/,friendlyMessage:"Category dataview options are not defined."},"category-limit-required":{messageRegex:/categoryLimitRequired/,friendlyMessage:"Limit for category dataview is required."},"category-limit-number":{messageRegex:/categoryLimitNumber/,friendlyMessage:"Limit for category dataview must be a number."},"category-limit-positive":{messageRegex:/categoryLimitPositive/,friendlyMessage:"Limit for category dataview must be greater than 0."},"category-invalid-operation":{messageRegex:/categoryInvalidOperation/,friendlyMessage:"Operation for category dataview is not valid. Use carto.operation"},"category-operation-required":{messageRegex:/categoryOperationRequired/,friendlyMessage:"Operation column for category dataview is required."},"category-operation-string":{messageRegex:/categoryOperationString/,friendlyMessage:"Operation column for category dataview must be a string."},"category-operation-empty":{messageRegex:/categoryOperationEmpty/,friendlyMessage:"Operation column for category dataview must be not empty."}},filter:{"invalid-bounds-object":{messageRegex:/invalidBoundsObject/,friendlyMessage:"Bounds object is not valid. Use a carto.filter.Bounds object"},"invalid-circle-object":{messageRegex:/invalidCircleObject/,friendlyMessage:"Circle object is not valid. Use a carto.filter.CircleData object"},"invalid-polygon-object":{messageRegex:/invalidPolygonObject/,friendlyMessage:"Polygon object is not valid. Use a carto.filter.PolygonData object"},"column-required":{messageRegex:/columnRequired/,friendlyMessage:"Column property is required."},"column-string":{messageRegex:/columnString/,friendlyMessage:"Column property must be a string."},"empty-column":{messageRegex:/emptyColumn/,friendlyMessage:"Column property must be not empty."},"invalid-filter":{messageRegex:/invalidFilter(.+)/,friendlyMessage:"'$0' is not a valid filter. Please check documentation."},"invalid-option":{messageRegex:/invalidOption(.+)/,friendlyMessage:"'$0' is not a valid option for this filter."},"wrong-filter-type":{messageRegex:/wrongFilterType/,friendlyMessage:"Filters need to extend from carto.filter.SQLBase. Please use carto.filter.Category or carto.filter.Range."},"invalid-parameter-type":{messageRegex:/invalidParameterType(.+)/,friendlyMessage:"Invalid parameter type for '$0'. Please check filters documentation."}},aggregation:{"threshold-required":{messageRegex:/thresholdRequired/,friendlyMessage:"Aggregation threshold is required."},"invalid-threshold":{messageRegex:/invalidThreshold/,friendlyMessage:"Aggregation threshold must be an integer value greater than 0."},"resolution-required":{messageRegex:/resolutionRequired/,friendlyMessage:"Aggregation resolution is required."},"invalid-resolution":{messageRegex:/invalidResolution/,friendlyMessage:"Aggregation resolution must be 0.5, 1 or powers of 2 up to 256 (2, 4, 8, 16, 32, 64, 128, 256)."},"invalid-placement":{messageRegex:/invalidPlacement/,friendlyMessage:"Aggregation placement is not valid. Must be one of these values: `point-sample`, `point-grid`, `centroid`"},"column-function-required":{messageRegex:/columnFunctionRequired(.+)$/,friendlyMessage:"Aggregation function for column '$0' is required."},"invalid-column-function":{messageRegex:/invalidColumnFunction(.+)$/,friendlyMessage:"Aggregation function for column '$0' is not valid. Use carto.aggregation.function"},"column-aggregated-column-required":{messageRegex:/columnAggregatedColumnRequired(.+)$/,friendlyMessage:"Column to be aggregated to '$0' is required."},"invalid-column-aggregated-column":{messageRegex:/invalidColumnAggregatedColumn(.+)$/,friendlyMessage:"Column to be aggregated to '$0' must be a string."}}}},function(e,t,n){"use strict";e.exports={}},function(e,t,n){"use strict";e.exports={analysis:{"sql-syntax-error":{messageRegex:/^syntax error/},"invalid-dataset":{messageRegex:/relation (.+) does not exist/,friendlyMessage:"Invalid dataset name used. Dataset $0 does not exist."},"column-does-not-exist":{messageRegex:/column (.+) does not exist/,friendlyMessage:"Invalid column name. Column $0 does not exist."},"analysis-requires-authentication":{messageRegex:/^Analysis requires authentication with API key/}},generic:{},limit:{"over-platform-limits":{messageRegex:/^You are over platform's limits/},"generic-limit-error":{messageRegex:/.*/,friendlyMessage:"The server is taking too long to respond, due to poor conectivity or a temporary error with our servers. Please try again soon."}},tile:{"generic-tile-error":{messageRegex:/.*/,friendlyMessage:"Some tiles might not be rendering correctly."}},layer:{"column-does-not-exist":{messageRegex:/column (.+) does not exist/,friendlyMessage:"Invalid column name. Column $0 does not exist."},"unrecognized-rule":{messageRegex:/Unrecognized rule: (.+)/,friendlyMessage:'Unrecognized rule "$0"'},"generic-layer-error":{messageRegex:/.*/}},dataview:{"formula-does-not-support-operation":{messageRegex:/Formula does not support (.+) operation/},"column-does-not-exist":{messageRegex:/column (.+) does not exist/},"permission-denied":{messageRegex:/permission denied for (.+)/},"wrong-type-column-used-in-time-series":{messageRegex:/function date_part\(unknown, (.+)\) does not exist/,friendlyMessage:"Your time series column type is $0. Please use a date type."},"invalid-aggregation-value":{messageRegex:/Invalid aggregation value. Valid ones: auto, minute, hour, day, week, month, quarter, year, decade, century, millennium/}},auth:{forbidden:{messageRegex:/^Forbidden$/,friendlyMessage:"Forbidden. API key does not grant access."}}}},function(e,t,n){"use strict";var r=n(141),i=n(140),o=n(139);e.exports={ajax:i,windshaft:r,validation:o}},function(e,t,n){"use strict";var r=n(0),i=n(142);function o(e,t){if(!t.friendlyMessage)return e.message;var n=e.message&&e.message.match(t.messageRegex);if(n&&n.length>1){var r=t.friendlyMessage.replace("$0",n[1]);return n.length>2&&(r=r.replace("$1",n[2])),r}return t.friendlyMessage}function s(e,t){var n=[];return n.push(e&&e.origin),n.push(e&&e.type),n.push(t),(n=r.compact(n)).join(":")}e.exports={getExtraFields:function(e){var t=function(e,t){for(var n,i=r.keys(t),a=0;a<i.length;a++){if(n=i[a],!(t[n].messageRegex instanceof RegExp))throw new Error("MessageRegex on "+n+" is not a RegExp.");if(t[n].messageRegex.test(e.message))return{friendlyMessage:o(e,t[n]),errorCode:s(e,n)}}return{friendlyMessage:e.message||"",errorCode:s(e,"unknown-error")}}(e,function(e){return i[e.origin]&&i[e.origin][e.type]}(e));return{friendlyMessage:t.friendlyMessage,errorCode:t.errorCode}}}},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(4),s=n(44),a=n(14),u=n(40),c=n(111),l=n(26).version,h=n(3),f=n(7);function p(e){return new h("client",e)}var d="https://{username}.carto.com";function g(e){e.serverUrl=(e.serverUrl||d).replace(/{username}/,e.username||""),function(e){(function(e){if(!e)throw p("apiKeyRequired");if(!r.isString(e))throw p("apiKeyString")})(e.apiKey),function(e){if(!e)throw p("usernameRequired");if(!r.isString(e))throw p("usernameString")}(e.username),e.serverUrl&&function(e,t){if(!e.match(/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/))throw p("nonValidServerURL");if(e.indexOf(t)<0)throw p("serverURLDoesntMatchUsername")}(e.serverUrl,e.username)}(e),this._layers=new c,this._dataviews=[],this._engine=new s({apiKey:e.apiKey,username:e.username,serverUrl:e.serverUrl,client:"js-"+l}),this._bindEngine(this._engine)}function m(e){if(!(e instanceof u))throw p("badLayerType")}r.extend(g.prototype,i.Events),g.prototype.addLayer=function(e){return this.addLayers([e])},g.prototype.addLayers=function(e){return e.forEach(this._addLayer,this),this._reload()},g.prototype.removeLayer=function(e){return this.removeLayers([e])},g.prototype.removeLayers=function(e){return e.slice(0).forEach(this._removeLayer,this),this._reload()},g.prototype.moveLayer=function(e,t){var n=this._layers.indexOf(e);return this._moveLayer(e,t),n===t?Promise.resolve():this._reload()},g.prototype.getLayers=function(){return this._layers.toArray()},g.prototype.addDataview=function(e){return this.addDataviews([e])},g.prototype.addDataviews=function(e){return e.forEach(this._addDataview,this),this._reload()},g.prototype.removeDataview=function(e){var t=this._dataviews.indexOf(e);return-1===t?Promise.resolve():(this._dataviews.splice(t,1),this._engine.removeDataview(e.$getInternalModel()),e.disable(),this._reload())},g.prototype.getDataviews=function(){return this._dataviews},g.prototype.getLeafletLayer=function(e){if(f.isLeafletLoaded(),!this._leafletLayer){var t=n(110);this._leafletLayer=new t(this._layers,this._engine,e)}return this._leafletLayer},g.prototype.getGoogleMapsMapType=function(e){if(f.isGoogleMapsLoaded(),!this._gmapsMapType){var t=n(87);this._gmapsMapType=new t(this._layers,this._engine,e)}return this._gmapsMapType},g.prototype._reload=function(){return this._engine.reload().then(function(){return Promise.resolve()}).catch(function(e){return Promise.reject(new o(e))})},g.prototype._addLayer=function(e,t){m(e),this._checkDuplicatedLayerId(e),this._layers.add(e),e.$setClient(this),e.$setEngine(this._engine),this._engine.addLayer(e.$getInternalModel())},g.prototype._removeLayer=function(e){m(e),this._layers.remove(e),this._engine.removeLayer(e.$getInternalModel())},g.prototype._moveLayer=function(e,t){m(e),function(e,t){if(!r.isNumber(e))throw p("indexNumber");if(e<0||e>=t)throw p("indexOutOfRange")}(t,this._layers.size()),this._layers.move(e,t),this._engine.moveLayer(e.$getInternalModel(),t)},g.prototype._addDataview=function(e,t){this._dataviews.push(e),e.$setEngine(this._engine),this._engine.addDataview(e.$getInternalModel())},g.prototype._bindEngine=function(e){e.on(s.Events.RELOAD_SUCCESS,function(){this.trigger(a.SUCCESS)}.bind(this)),e.on(s.Events.RELOAD_ERROR,function(e){this.trigger(a.ERROR,new o(e,{layers:this._layers}))}.bind(this)),e.on(s.Events.LAYER_ERROR,function(e){this.trigger(a.ERROR,new o(e))}.bind(this))},g.prototype._checkDuplicatedLayerId=function(e){if(this._layers.findById(e.getId()))throw p("duplicatedLayerId")},e.exports=g},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var u,c=[],l=!1,h=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&p())}function p(){if(!l){var e=a(f);l=!0;for(var t=c.length;t;){for(u=c,c=[];++h<t;)u&&u[h].run();h=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new d(e,t)),1!==c.length||l||a(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,i=1,o={},s=!1,a=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick(function(){l(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&l(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),r=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){l(e.data)},r=function(t){e.port2.postMessage(t)}}():a&&"onreadystatechange"in a.createElement("script")?function(){var e=a.documentElement;r=function(t){var n=a.createElement("script");n.onreadystatechange=function(){l(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():r=function(e){setTimeout(l,0,e)},u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var s={callback:e,args:t};return o[i]=s,r(i),i++},u.clearImmediate=c}function c(e){delete o[e]}function l(e){if(s)setTimeout(l,0,e);else{var t=o[e];if(t){s=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}(t)}finally{c(e),s=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(30),n(145))},function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(146),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(30))},function(e,t,n){(function(t){!function(n){var r=setTimeout;function i(){}function o(e){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function s(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,o._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(e){return void u(t.promise,e)}a(t.promise,r)}else(1===e._state?a:u)(t.promise,e._value)})):e._deferreds.push(t)}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof o)return e._state=3,e._value=t,void c(e);if("function"==typeof n)return void l(function(e,t){return function(){e.apply(t,arguments)}}(n,t),e)}e._state=1,e._value=t,c(e)}catch(t){u(e,t)}}function u(e,t){e._state=2,e._value=t,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)s(e,e._deferreds[t]);e._deferreds=null}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,u(t,e))})}catch(e){if(n)return;n=!0,u(t,e)}}o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var n=new this.constructor(i);return s(this,new function(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(e,t,n)),n},o.all=function(e){return new o(function(t,n){if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var i=r.length;function o(e,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(t){o(e,t)},n)}r[e]=s,0==--i&&t(r)}catch(e){n(e)}}for(var s=0;s<r.length;s++)o(s,r[s])})},o.resolve=function(e){return e&&"object"==typeof e&&e.constructor===o?e:new o(function(t){t(e)})},o.reject=function(e){return new o(function(t,n){n(e)})},o.race=function(e){return new o(function(t,n){for(var r=0,i=e.length;r<i;r++)e[r].then(t,n)})},o._immediateFn="function"==typeof t&&function(e){t(e)}||function(e){r(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},o._setImmediateFn=function(e){o._immediateFn=e},o._setUnhandledRejectionFn=function(e){o._unhandledRejectionFn=e},void 0!==e&&e.exports?e.exports=o:n.Promise||(n.Promise=o)}(this)}).call(this,n(147).setImmediate)},function(e,t){!function(e){"use strict";if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=function(e){return e&&DataView.prototype.isPrototypeOf(e)},i=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};l.prototype.append=function(e,t){e=a(e),t=u(t);var n=this.map[e];this.map[e]=n?n+","+t:t},l.prototype.delete=function(e){delete this.map[a(e)]},l.prototype.get=function(e){return e=a(e),this.has(e)?this.map[e]:null},l.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},l.prototype.set=function(e,t){this.map[a(e)]=u(t)},l.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},l.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),c(e)},l.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),c(e)},l.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),c(e)},t.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},g.call(m.prototype),g.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:0,statusText:""});return e.type="error",e};var s=[301,302,303,307,308];_.redirect=function(e,t){if(-1===s.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})},e.Headers=l,e.Request=m,e.Response=_,e.fetch=function(e,n){return new Promise(function(r,i){var o=new m(e,n),s=new XMLHttpRequest;s.onload=function(){var e={status:s.status,statusText:s.statusText,headers:function(e){var t=new l;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}}),t}(s.getAllResponseHeaders()||"")};e.url="responseURL"in s?s.responseURL:e.headers.get("X-Request-URL");var t="response"in s?s.response:s.responseText;r(new _(t,e))},s.onerror=function(){i(new TypeError("Network request failed"))},s.ontimeout=function(){i(new TypeError("Network request failed"))},s.open(o.method,o.url,!0),"include"===o.credentials?s.withCredentials=!0:"omit"===o.credentials&&(s.withCredentials=!1),"responseType"in s&&t.blob&&(s.responseType="blob"),o.headers.forEach(function(e,t){s.setRequestHeader(t,e)}),s.send(void 0===o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function u(e){return"string"!=typeof e&&(e=String(e)),e}function c(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(n[Symbol.iterator]=function(){return n}),n}function l(e){this.map={},e instanceof l?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function h(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function f(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function p(e){var t=new FileReader,n=f(t);return t.readAsArrayBuffer(e),n}function d(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&r(e))this._bodyArrayBuffer=d(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!i(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=d(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}),this.text=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=f(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(y)}),this.json=function(){return this.text().then(JSON.parse)},this}function m(e,t){var n=(t=t||{}).body;if(e instanceof m){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new l(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new l(t.headers)),this.method=function(e){var t=e.toUpperCase();return o.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function y(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}}),t}function _(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new l(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this)},function(e,t,n){"use strict";n(149);var r=n(148);window.Promise||(window.Promise=r);var i=n(144),o=n(82),s=n(79),a=n(23),u=n(77),c=n(59),l=n(14),h=n(5),f={version:n(26).version,ATTRIBUTION:h.ATTRIBUTION,Client:i,source:o,style:s,layer:a,dataview:u,filter:c,events:l,operation:h.operation};e.exports=f}])});
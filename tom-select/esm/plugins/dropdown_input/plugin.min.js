const KEY_ESC=27,KEY_TAB=9;"undefined"!=typeof navigator&&/Mac/.test(navigator.userAgent);const latin_convert={"æ":"ae","ⱥ":"a","ø":"o"};new RegExp(Object.keys(latin_convert).join("|"),"g");const iterate=(e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)},getDom=t=>{if(t.jquery)return t[0];if(t instanceof HTMLElement)return t;if(isHtmlString(t)){let e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild}return document.querySelector(t)},isHtmlString=e=>"string"==typeof e&&-1<e.indexOf("<"),addClasses=(e,...t)=>{var n=classesArray(t);(e=castAsArray(e)).map(t=>{n.map(e=>{t.classList.add(e)})})},classesArray=e=>{var t=[];return iterate(e,e=>{"string"==typeof e&&(e=e.trim().split(/[\11\12\14\15\40]/)),Array.isArray(e)&&(t=t.concat(e))}),t.filter(Boolean)},castAsArray=e=>e=Array.isArray(e)?e:[e],preventDefault=(e,t=!1)=>{e&&(e.preventDefault(),t&&e.stopPropagation())},addEvent=(e,t,n,r)=>{e.addEventListener(t,n,r)};function plugin(){var n=this;n.settings.shouldOpen=!0,n.hook("before","setup",()=>{n.focus_node=n.control,addClasses(n.control_input,"dropdown-input");const e=getDom('<div class="dropdown-input-wrap">');e.append(n.control_input),n.dropdown.insertBefore(e,n.dropdown.firstChild)}),n.on("initialize",()=>{n.control_input.addEventListener("keydown",e=>{switch(e.keyCode){case KEY_ESC:return n.isOpen&&(preventDefault(e,!0),n.close()),void n.clearActiveItems();case KEY_TAB:n.focus_node.tabIndex=-1}return n.onKeyDown.call(n,e)}),n.on("blur",()=>{n.focus_node.tabIndex=n.isDisabled?-1:n.tabIndex}),n.on("dropdown_open",()=>{n.control_input.focus()});const t=n.onBlur;n.hook("instead","onBlur",e=>{if(!e||e.relatedTarget!=n.control_input)return t.call(n)}),addEvent(n.control_input,"blur",()=>n.onBlur()),n.hook("before","close",()=>{n.isOpen&&n.focus_node.focus()})})}export{plugin as default};
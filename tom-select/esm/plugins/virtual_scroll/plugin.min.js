const latin_convert={"æ":"ae","ⱥ":"a","ø":"o"};new RegExp(Object.keys(latin_convert).join("|"),"g");const iterate=(e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var r in e)e.hasOwnProperty(r)&&t(e[r],r)},addClasses=(e,...t)=>{var r=classesArray(t);(e=castAsArray(e)).map(t=>{r.map(e=>{t.classList.add(e)})})},classesArray=e=>{var t=[];return iterate(e,e=>{"string"==typeof e&&(e=e.trim().split(/[\11\12\14\15\40]/)),Array.isArray(e)&&(t=t.concat(e))}),t.filter(Boolean)},castAsArray=e=>e=Array.isArray(e)?e:[e];function plugin(){const r=this,t=r.canLoad,e=r.clearActiveOption,s=r.loadCallback;var n,a,i={},l=!1;if(r.settings.shouldLoadMore||(r.settings.shouldLoadMore=function(){if(.9<n.clientHeight/(n.scrollHeight-n.scrollTop))return!0;if(r.activeOption){var e=r.selectable();if([...e].indexOf(r.activeOption)>=e.length-2)return!0}return!1}),!r.settings.firstUrl)throw"virtual_scroll plugin requires a firstUrl() method";function o(e){return!("number"==typeof r.settings.maxOptions&&n.children.length>=r.settings.maxOptions)&&!!(e in i&&i[e])}r.settings.sortField=[{field:"$order"},{field:"$score"}],r.setNextUrl=function(e,t){i[e]=t},r.getUrl=function(e){if(e in i){var t=i[e];return i[e]=!1,t}return i={},r.settings.firstUrl.call(r,e)},r.hook("instead","clearActiveOption",()=>{if(!l)return e.call(r)}),r.hook("instead","canLoad",e=>e in i?o(e):t.call(r,e)),r.hook("instead","loadCallback",(e,t)=>{l?a&&0<e.length&&(a.dataset.value=e[0][r.settings.valueField]):r.clearOptions(),s.call(r,e,t),l=!1}),r.hook("after","refreshOptions",()=>{var e,t=r.lastValue;o(t)?(e=r.render("loading_more",{query:t}))&&(e.setAttribute("data-selectable",""),a=e):t in i&&!n.querySelector(".no-results")&&(e=r.render("no_more_results",{query:t})),e&&(addClasses(e,r.settings.optionClass),n.append(e))}),r.on("initialize",()=>{n=r.dropdown_content,r.settings.render=Object.assign({},{loading_more:function(){return'<div class="loading-more-results">Loading more results ... </div>'},no_more_results:function(){return'<div class="no-more-results">No more results</div>'}},r.settings.render),n.addEventListener("scroll",function(){r.settings.shouldLoadMore.call(r)&&o(r.lastValue)&&(l||(l=!0,r.load.call(r,r.lastValue)))})})}export{plugin as default};
function forEvents(e,t){e.split(/\s+/).forEach(e=>{t(e)})}class MicroEvent{constructor(){this._events=void 0,this._events={}}on(e,t){forEvents(e,e=>{this._events[e]=this._events[e]||[],this._events[e].push(t)})}off(e,t){var i=arguments.length;0!==i?forEvents(e,e=>1===i?delete this._events[e]:void(e in this._events!=!1&&this._events[e].splice(this._events[e].indexOf(t),1))):this._events={}}trigger(e,...i){var s=this;forEvents(e,e=>{if(e in s._events!=!1)for(var t of s._events[e])t.apply(s,i)})}}function MicroPlugin(n){return n.plugins={},class extends n{constructor(...e){super(...e),this.plugins={names:[],settings:{},requested:{},loaded:{}}}static define(e,t){n.plugins[e]={name:e,fn:t}}initializePlugins(e){var t,i;const s=this,n=[];if(Array.isArray(e))e.forEach(e=>{"string"==typeof e?n.push(e):(s.plugins.settings[e.name]=e.options,n.push(e.name))});else if(e)for(t in e)e.hasOwnProperty(t)&&(s.plugins.settings[t]=e[t],n.push(t));for(;i=n.shift();)s.require(i)}loadPlugin(e){var t=this,i=t.plugins,s=n.plugins[e];if(!n.plugins.hasOwnProperty(e))throw new Error('Unable to find "'+e+'" plugin');i.requested[e]=!0,i.loaded[e]=s.fn.apply(t,[t.plugins.settings[e]||{}]),i.names.push(e)}require(e){var t=this,i=t.plugins;if(!t.plugins.loaded.hasOwnProperty(e)){if(i.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');t.loadPlugin(e)}return i.loaded[e]}}}var latin_pat,diacritic_patterns;const accent_pat="[̀-ͯ·ʾ]",accent_reg=new RegExp(accent_pat,"g"),latin_convert={"æ":"ae","ⱥ":"a","ø":"o"},convert_pat=new RegExp(Object.keys(latin_convert).join("|"),"g"),code_points=[[67,67],[160,160],[192,438],[452,652],[961,961],[1019,1019],[1083,1083],[1281,1289],[1984,1984],[5095,5095],[7429,7441],[7545,7549],[7680,7935],[8580,8580],[9398,9449],[11360,11391],[42792,42793],[42802,42851],[42873,42897],[42912,42922],[64256,64260],[65313,65338],[65345,65370]],asciifold=e=>e.normalize("NFKD").replace(accent_reg,"").toLowerCase().replace(convert_pat,function(e){return latin_convert[e]}),arrayToPattern=(e,t="|")=>{if(1==e.length)return e[0];var i=1;return e.forEach(e=>{i=Math.max(i,e.length)}),1==i?"["+e.join("")+"]":"(?:"+e.join(t)+")"},allSubstrings=i=>{if(1===i.length)return[[i]];var s=[];return allSubstrings(i.substring(1)).forEach(function(e){var t=e.slice(0);t[0]=i.charAt(0)+t[0],s.push(t),(t=e.slice(0)).unshift(i.charAt(0)),s.push(t)}),s},generateDiacritics=()=>{var n={};code_points.forEach(e=>{for(let t=e[0];t<=e[1];t++){let e=String.fromCharCode(t);var i,s=asciifold(e);s!=e.toLowerCase()&&(s in n||(n[s]=[s]),i=new RegExp(arrayToPattern(n[s]),"iu"),e.match(i)||n[s].push(e))}});var e=(e=Object.keys(n)).sort((e,t)=>t.length-e.length);latin_pat=new RegExp("("+arrayToPattern(e)+accent_pat+"*)","g");var i={};return e.sort((e,t)=>e.length-t.length).forEach(e=>{var t=allSubstrings(e).map(e=>(e=e.map(e=>n.hasOwnProperty(e)?arrayToPattern(n[e]):e),arrayToPattern(e,"")));i[e]=arrayToPattern(t)}),i},diacriticRegexPoints=e=>{void 0===diacritic_patterns&&(diacritic_patterns=generateDiacritics());const t=e.normalize("NFKD").toLowerCase();return t.split(latin_pat).map(e=>{if(""==e)return"";var t=asciifold(e);if(diacritic_patterns.hasOwnProperty(t))return diacritic_patterns[t];t=e.normalize("NFC");return t!=e?arrayToPattern([e,t]):e}).join("")},getAttr=(e,t)=>{if(e)return e[t]},getAttrNesting=(e,t)=>{if(e){for(var i,s=t.split(".");(i=s.shift())&&(e=e[i]););return e}},scoreValue=(e,t,i)=>{var s;return!e||-1===(s=(e+="").search(t.regex))?0:(e=t.string.length/e.length,0===s&&(e+=.5),e*i)},escape_regex=e=>(e+"").replace(/([\$\(-\+\.\?\[-\^\{-\}])/g,"\\$1"),propToArray=(e,t)=>{var i=e[t];if("function"==typeof i)return i;i&&!Array.isArray(i)&&(e[t]=[i])},iterate=(e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var i in e)e.hasOwnProperty(i)&&t(e[i],i)},cmp=(e,t)=>"number"==typeof e&&"number"==typeof t?t<e?1:e<t?-1:0:(e=asciifold(e+"").toLowerCase(),(t=asciifold(t+"").toLowerCase())<e?1:e<t?-1:0);class Sifter{constructor(e,t){this.items=void 0,this.settings=void 0,this.items=e,this.settings=t||{diacritics:!0}}tokenize(e,n,t){if(!e||!e.length)return[];const r=[],i=e.split(/\s+/);var o;return t&&(o=new RegExp("^("+Object.keys(t).map(escape_regex).join("|")+"):(.*)$")),i.forEach(e=>{let t,i=null,s=null;o&&(t=e.match(o))&&(i=t[1],e=t[2]),0<e.length&&(s=escape_regex(e),this.settings.diacritics&&(s=diacriticRegexPoints(s)),n&&(s="\\b"+s)),r.push({string:e,regex:s?new RegExp(s,"iu"):null,field:i})}),r}getScoreFunction(e,t){t=this.prepareSearch(e,t);return this._getScoreFunction(t)}_getScoreFunction(e){const n=e.tokens,r=n.length;if(!r)return function(){return 0};const s=e.options.fields,o=e.weights,t=s.length,a=e.getAttrFn;if(!t)return function(){return 1};const l=1===t?function(e,t){var i=s[0].field;return scoreValue(a(t,i),e,o[i])}:function(i,s){var e,n=0;return i.field?(e=a(s,i.field),!i.regex&&e?n+=1/t:n+=scoreValue(e,i,1)):iterate(o,(e,t)=>{n+=scoreValue(a(s,t),i,e)}),n/t};return 1===r?function(e){return l(n[0],e)}:"and"===e.options.conjunction?function(e){for(var t,i=0,s=0;i<r;i++){if((t=l(n[i],e))<=0)return 0;s+=t}return s/r}:function(t){var i=0;return iterate(n,e=>{i+=l(e,t)}),i/r}}getSortFunction(e,t){t=this.prepareSearch(e,t);return this._getSortFunction(t)}_getSortFunction(i){var e,t,s;const n=this,r=i.options,o=!i.query&&r.sort_empty?r.sort_empty:r.sort,a=[],l=[];if("function"==typeof o)return o.bind(this);function d(e,t){return"$score"===e?t.score:i.getAttrFn(n.items[t.id],e)}if(o)for(e=0,t=o.length;e<t;e++)!i.query&&"$score"===o[e].field||a.push(o[e]);if(i.query){for(s=!0,e=0,t=a.length;e<t;e++)if("$score"===a[e].field){s=!1;break}s&&a.unshift({field:"$score",direction:"desc"})}else for(e=0,t=a.length;e<t;e++)if("$score"===a[e].field){a.splice(e,1);break}for(e=0,t=a.length;e<t;e++)l.push("desc"===a[e].direction?-1:1);const c=a.length;if(c){if(1!==c)return function(e,t){for(var i,s=0;s<c;s++)if(i=a[s].field,i=l[s]*cmp(d(i,e),d(i,t)))return i;return 0};{const p=a[0].field,u=l[0];return function(e,t){return u*cmp(d(p,e),d(p,t))}}}return null}prepareSearch(e,t){const i={};t=Object.assign({},t);if(propToArray(t,"sort"),propToArray(t,"sort_empty"),t.fields){propToArray(t,"fields");const s=[];t.fields.forEach(e=>{"string"==typeof e&&(e={field:e,weight:1}),s.push(e),i[e.field]="weight"in e?e.weight:1}),t.fields=s}return{options:t,query:e.toLowerCase().trim(),tokens:this.tokenize(e,t.respect_word_boundaries,i),total:0,items:[],weights:i,getAttrFn:t.nesting?getAttrNesting:getAttr}}search(e,i){var s,n=this.prepareSearch(e,i);i=n.options,e=n.query;const r=i.score||this._getScoreFunction(n);e.length?iterate(this.items,(e,t)=>{s=r(e),(!1===i.filter||0<s)&&n.items.push({score:s,id:t})}):iterate(this.items,(e,t)=>{n.items.push({score:1,id:t})});e=this._getSortFunction(n);return e&&n.items.sort(e),n.total=n.items.length,"number"==typeof i.limit&&(n.items=n.items.slice(0,i.limit)),n}}const getDom=t=>{if(t.jquery)return t[0];if(t instanceof HTMLElement)return t;if(isHtmlString(t)){let e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild}return document.querySelector(t)},isHtmlString=e=>"string"==typeof e&&-1<e.indexOf("<"),escapeQuery=e=>e.replace(/['"\\]/g,"\\$&"),triggerEvent=(e,t)=>{var i=document.createEvent("HTMLEvents");i.initEvent(t,!0,!1),e.dispatchEvent(i)},applyCSS=(e,t)=>{Object.assign(e.style,t)},addClasses=(e,...t)=>{var i=classesArray(t);(e=castAsArray(e)).map(t=>{i.map(e=>{t.classList.add(e)})})},removeClasses=(e,...t)=>{var i=classesArray(t);(e=castAsArray(e)).map(t=>{i.map(e=>{t.classList.remove(e)})})},classesArray=e=>{var t=[];return iterate(e,e=>{"string"==typeof e&&(e=e.trim().split(/[\11\12\14\15\40]/)),Array.isArray(e)&&(t=t.concat(e))}),t.filter(Boolean)},castAsArray=e=>e=Array.isArray(e)?e:[e],parentMatch=(e,t,i)=>{if(!i||i.contains(e))for(;e&&e.matches;){if(e.matches(t))return e;e=e.parentNode}},getTail=(e,t=0)=>0<t?e[e.length-1]:e[0],isEmptyObject=e=>0===Object.keys(e).length,nodeIndex=(e,t)=>{if(!e)return-1;t=t||e.nodeName;for(var i=0;e=e.previousElementSibling;)e.matches(t)&&i++;return i},setAttr=(i,e)=>{iterate(e,(e,t)=>{null==e?i.removeAttribute(t):i.setAttribute(t,""+e)})},replaceNode=(e,t)=>{e.parentNode&&e.parentNode.replaceChild(t,e)},highlight=(e,s)=>{if(null===s)return;if("string"==typeof s){if(!s.length)return;s=new RegExp(s,"i")}const i=e=>3===e.nodeType?(e=>{var t=e.data.match(s);if(t&&0<e.data.length){var i=document.createElement("span");i.className="highlight";e=e.splitText(t.index);e.splitText(t[0].length);t=e.cloneNode(!0);return i.appendChild(t),replaceNode(e,i),1}return 0})(e):((e=>{if(1===e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName)&&("highlight"!==e.className||"SPAN"!==e.tagName))for(var t=0;t<e.childNodes.length;++t)t+=i(e.childNodes[t])})(e),0);i(e)},removeHighlight=e=>{e=e.querySelectorAll("span.highlight");Array.prototype.forEach.call(e,function(e){var t=e.parentNode;t.replaceChild(e.firstChild,e),t.normalize()})},KEY_A=65,KEY_RETURN=13,KEY_ESC=27,KEY_LEFT=37,KEY_UP=38,KEY_RIGHT=39,KEY_DOWN=40,KEY_BACKSPACE=8,KEY_DELETE=46,KEY_TAB=9,IS_MAC="undefined"!=typeof navigator&&/Mac/.test(navigator.userAgent),KEY_SHORTCUT=IS_MAC?"metaKey":"ctrlKey";var defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:null,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,shouldOpen:null,maxOptions:50,maxItems:null,hideSelected:null,duplicates:!1,addPrecedence:!1,selectOnTab:!1,preload:null,allowEmptyOption:!1,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"ts-wrapper",controlClass:"ts-control",dropdownClass:"ts-dropdown",dropdownContentClass:"ts-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:'<input type="text" autocomplete="off" size="1" />',copyClassesToDropdown:!1,placeholder:null,hidePlaceholder:null,shouldLoad:function(e){return 0<e.length},render:{}};const hash_key=e=>null==e?null:get_hash(e),get_hash=e=>"boolean"==typeof e?e?"1":"0":e+"",escape_html=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),loadDebounce=(s,n)=>{var r;return function(e,t){var i=this;r&&(i.loading=Math.max(i.loading-1,0),clearTimeout(r)),r=setTimeout(function(){r=null,i.loadedSearches[e]=!0,s.call(i,e,t)},n)}},debounce_events=(t,i,e)=>{var s,n=t.trigger,r={};t.trigger=function(){var e=arguments[0];if(-1===i.indexOf(e))return n.apply(t,arguments);r[e]=arguments},e.apply(t,[]),t.trigger=n;for(s of i)s in r&&n.apply(t,r[s])},getSelection=e=>({start:e.selectionStart||0,length:(e.selectionEnd||0)-(e.selectionStart||0)}),preventDefault=(e,t=!1)=>{e&&(e.preventDefault(),t&&e.stopPropagation())},addEvent=(e,t,i,s)=>{e.addEventListener(t,i,s)},isKeyDown=(e,t)=>{return!!t&&(!!t[e]&&1==(t.altKey?1:0)+(t.ctrlKey?1:0)+(t.shiftKey?1:0)+(t.metaKey?1:0))},getId=(e,t)=>{var i=e.getAttribute("id");return i||(e.setAttribute("id",t),t)},addSlashes=e=>e.replace(/[\\"']/g,"\\$&"),append=(e,t)=>{t&&e.append(t)};function getSettings(e,t){var i,c=Object.assign({},defaults,t),s=c.dataAttr,p=c.labelField,u=c.valueField,h=c.disabledField,g=c.optgroupField,v=c.optgroupLabelField,m=c.optgroupValueField,n=e.tagName.toLowerCase(),r=e.getAttribute("placeholder")||e.getAttribute("data-placeholder");r||c.allowEmptyOption||(i=e.querySelector('option[value=""]'))&&(r=i.textContent);var o,f={placeholder:r,options:[],optgroups:[],items:[],maxItems:null};return"select"===n?(()=>{var n,r=f.options,o={},a=1,l=e=>{var t=Object.assign({},e.dataset),e=s&&t[s];return t="string"==typeof e&&e.length?Object.assign(t,JSON.parse(e)):t},d=(e,t)=>{var i,s=hash_key(e.value);null!=s&&(s||c.allowEmptyOption)&&(o.hasOwnProperty(s)?t&&((i=o[s][g])?Array.isArray(i)?i.push(t):o[s][g]=[i,t]:o[s][g]=t):((i=l(e))[p]=i[p]||e.textContent,i[u]=i[u]||s,i[h]=i[h]||e.disabled,i[g]=i[g]||t,i.$option=e,o[s]=i,r.push(i)),e.selected&&f.items.push(s))};f.maxItems=e.hasAttribute("multiple")?null:1,iterate(e.children,e=>{var t,i,s;"optgroup"===(n=e.tagName.toLowerCase())?((s=l(t=e))[v]=s[v]||t.getAttribute("label")||"",s[m]=s[m]||a++,s[h]=s[h]||t.disabled,f.optgroups.push(s),i=s[m],iterate(t.children,e=>{d(e,i)})):"option"===n&&d(e)})})():(o=e.getAttribute(s))?(f.options=JSON.parse(o),iterate(f.options,e=>{f.items.push(e[u])})):(o=e.value.trim()||"",(c.allowEmptyOption||o.length)&&(o=o.split(c.delimiter),iterate(o,e=>{const t={};t[p]=e,t[u]=e,f.options.push(t)}),f.items=o)),Object.assign({},defaults,f,t)}var instance_i=0;class TomSelect extends MicroPlugin(MicroEvent){constructor(e,t){super(),this.control_input=void 0,this.wrapper=void 0,this.dropdown=void 0,this.control=void 0,this.dropdown_content=void 0,this.focus_node=void 0,this.order=0,this.settings=void 0,this.input=void 0,this.tabIndex=void 0,this.is_select_tag=void 0,this.rtl=void 0,this.inputId=void 0,this._destroy=void 0,this.sifter=void 0,this.isOpen=!1,this.isDisabled=!1,this.isRequired=void 0,this.isInvalid=!1,this.isValid=!0,this.isLocked=!1,this.isFocused=!1,this.isInputHidden=!1,this.isSetup=!1,this.ignoreFocus=!1,this.hasOptions=!1,this.currentResults=void 0,this.lastValue="",this.caretPos=0,this.loading=0,this.loadedSearches={},this.activeOption=null,this.activeItems=[],this.optgroups={},this.options={},this.userOptions={},this.items=[],instance_i++;var i=getDom(e);if(i.tomselect)throw new Error("Tom Select already initialized on this element");i.tomselect=this;var s=(window.getComputedStyle&&window.getComputedStyle(i,null)).getPropertyValue("direction");const n=getSettings(i,t);this.settings=n,this.input=i,this.tabIndex=i.tabIndex||0,this.is_select_tag="select"===i.tagName.toLowerCase(),this.rtl=/rtl/i.test(s),this.inputId=getId(i,"tomselect-"+instance_i),this.isRequired=i.required,this.sifter=new Sifter(this.options,{diacritics:n.diacritics}),n.mode=n.mode||(1===n.maxItems?"single":"multi"),"boolean"!=typeof n.hideSelected&&(n.hideSelected="multi"===n.mode),"boolean"!=typeof n.hidePlaceholder&&(n.hidePlaceholder="multi"!==n.mode);var r=n.createFilter;"function"!=typeof r&&((r="string"==typeof r?new RegExp(r):r)instanceof RegExp?n.createFilter=e=>r.test(e):n.createFilter=()=>!0),this.initializePlugins(n.plugins),this.setupCallbacks(),this.setupTemplates();var o=getDom("<div>");const a=getDom("<div>");var l,d=this._render("dropdown"),e=getDom('<div role="listbox" tabindex="-1">'),t=this.input.getAttribute("class")||"",s=n.mode;addClasses(o,n.wrapperClass,t,s),addClasses(a,n.controlClass),append(o,a),addClasses(d,n.dropdownClass,s),n.copyClassesToDropdown&&addClasses(d,t),addClasses(e,n.dropdownContentClass),append(d,e),getDom(n.dropdownParent||o).appendChild(d),isHtmlString(n.controlInput)?(l=getDom(n.controlInput),iterate(["autocorrect","autocapitalize","autocomplete"],e=>{i.getAttribute(e)&&setAttr(l,{[e]:i.getAttribute(e)})}),l.tabIndex=-1,a.appendChild(l),this.focus_node=l):n.controlInput?(l=getDom(n.controlInput),this.focus_node=l):(l=getDom("<input/>"),this.focus_node=a),this.wrapper=o,this.dropdown=d,this.dropdown_content=e,this.control=a,this.control_input=l,this.setup()}setup(){const i=this,e=i.settings,s=i.control_input,n=i.dropdown;var t=i.dropdown_content;const r=i.wrapper,o=i.control,a=i.input;var l=i.focus_node,d={passive:!0},c=i.inputId+"-ts-dropdown";setAttr(t,{id:c}),setAttr(l,{role:"combobox","aria-haspopup":"listbox","aria-expanded":"false","aria-controls":c});var p,u=getId(l,i.inputId+"-ts-control"),c="label[for='"+escapeQuery(i.inputId)+"']";const h=document.querySelector(c),g=i.focus.bind(i);h&&(addEvent(h,"click",g),setAttr(h,{for:u}),p=getId(h,i.inputId+"-ts-label"),setAttr(l,{"aria-labelledby":p}),setAttr(t,{"aria-labelledby":p})),r.style.width=a.style.width,i.plugins.names.length&&(p="plugin-"+i.plugins.names.join(" plugin-"),addClasses([r,n],p)),(null===e.maxItems||1<e.maxItems)&&i.is_select_tag&&setAttr(a,{multiple:"multiple"}),i.settings.placeholder&&setAttr(s,{placeholder:e.placeholder}),!i.settings.splitOn&&i.settings.delimiter&&(i.settings.splitOn=new RegExp("\\s*"+escape_regex(i.settings.delimiter)+"+\\s*")),e.load&&e.loadThrottle&&(e.load=loadDebounce(e.load,e.loadThrottle)),i.control_input.type=a.type,addEvent(n,"click",e=>{var t=parentMatch(e.target,"[data-selectable]");t&&(i.onOptionSelect(e,t),preventDefault(e,!0))}),addEvent(o,"click",e=>{var t=parentMatch(e.target,"[data-ts-item]",o);t&&i.onItemSelect(e,t)?preventDefault(e,!0):""==s.value&&(i.onClick(),preventDefault(e,!0))}),addEvent(l,"keydown",e=>i.onKeyDown(e)),addEvent(s,"keypress",e=>i.onKeyPress(e)),addEvent(s,"input",e=>i.onInput(e)),addEvent(l,"resize",()=>i.positionDropdown(),d),addEvent(l,"blur",e=>i.onBlur(e)),addEvent(l,"focus",e=>i.onFocus(e)),addEvent(l,"paste",e=>i.onPaste(e));const v=e=>{var t=e.composedPath()[0];if(!r.contains(t)&&!n.contains(t))return i.isFocused&&i.blur(),void i.inputState();t==s&&i.isOpen?e.stopPropagation():preventDefault(e,!0)};var m=()=>{i.isOpen&&i.positionDropdown()};addEvent(document,"mousedown",v),addEvent(window,"scroll",m,d),addEvent(window,"resize",m,d),this._destroy=()=>{document.removeEventListener("mousedown",v),window.removeEventListener("sroll",m),window.removeEventListener("resize",m),h&&h.removeEventListener("click",g)},this.revertSettings={innerHTML:a.innerHTML,tabIndex:a.tabIndex},a.tabIndex=-1,a.insertAdjacentElement("afterend",i.wrapper),i.sync(!1),e.items=[],delete e.optgroups,delete e.options,addEvent(a,"invalid",e=>{i.isValid&&(i.isValid=!1,i.isInvalid=!0,i.refreshState())}),i.updateOriginalInput(),i.refreshItems(),i.close(!1),i.inputState(),i.isSetup=!0,a.disabled?i.disable():i.enable(),i.on("change",this.onChange),addClasses(a,"tomselected","ts-hidden-accessible"),i.trigger("initialize"),!0===e.preload&&i.preload()}setupOptions(e=[],t=[]){this.addOptions(e),iterate(t,e=>{this.registerOptionGroup(e)})}setupTemplates(){var i=this.settings.labelField,s=this.settings.optgroupLabelField;this.settings.render=Object.assign({},{optgroup:e=>{let t=document.createElement("div");return t.className="optgroup",t.appendChild(e.options),t},optgroup_header:(e,t)=>'<div class="optgroup-header">'+t(e[s])+"</div>",option:(e,t)=>"<div>"+t(e[i])+"</div>",item:(e,t)=>"<div>"+t(e[i])+"</div>",option_create:(e,t)=>'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>",no_results:()=>'<div class="no-results">No results found</div>',loading:()=>'<div class="spinner"></div>',not_loading:()=>{},dropdown:()=>"<div></div>"},this.settings.render)}setupCallbacks(){var e,t,i={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",item_select:"onItemSelect",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in i)(t=this.settings[i[e]])&&this.on(e,t)}sync(e=!0){var t=this,e=e?getSettings(t.input,{delimiter:t.settings.delimiter}):t.settings;t.setupOptions(e.options,e.optgroups),t.setValue(e.items,!0),t.lastQuery=null}onClick(){var e=this;if(0<e.activeItems.length)return e.clearActiveItems(),void e.focus();e.isFocused&&e.isOpen?e.blur():e.focus()}onMouseDown(){}onChange(){triggerEvent(this.input,"input"),triggerEvent(this.input,"change")}onPaste(e){var t=this;t.isInputHidden||t.isLocked?preventDefault(e):t.settings.splitOn&&setTimeout(()=>{var e=t.inputValue();e.match(t.settings.splitOn)&&(e=e.trim().split(t.settings.splitOn),iterate(e,e=>{t.createItem(e)}))},0)}onKeyPress(e){var t,i=this;i.isLocked?preventDefault(e):(t=String.fromCharCode(e.keyCode||e.which),i.settings.create&&"multi"===i.settings.mode&&t===i.settings.delimiter&&(i.createItem(),preventDefault(e)))}onKeyDown(e){var t,i=this;if(i.isLocked)e.keyCode!==KEY_TAB&&preventDefault(e);else{switch(e.keyCode){case KEY_A:if(isKeyDown(KEY_SHORTCUT,e)&&""==i.control_input.value)return preventDefault(e),void i.selectAll();break;case KEY_ESC:return i.isOpen&&(preventDefault(e,!0),i.close()),void i.clearActiveItems();case KEY_DOWN:return!i.isOpen&&i.hasOptions?i.open():!i.activeOption||(t=i.getAdjacent(i.activeOption,1))&&i.setActiveOption(t),void preventDefault(e);case KEY_UP:return!i.activeOption||(t=i.getAdjacent(i.activeOption,-1))&&i.setActiveOption(t),void preventDefault(e);case KEY_RETURN:return void(i.canSelect(i.activeOption)?(i.onOptionSelect(e,i.activeOption),preventDefault(e)):i.settings.create&&i.createItem()&&preventDefault(e));case KEY_LEFT:return void i.advanceSelection(-1,e);case KEY_RIGHT:return void i.advanceSelection(1,e);case KEY_TAB:return void(i.settings.selectOnTab&&(i.canSelect(i.activeOption)&&(i.onOptionSelect(e,i.activeOption),preventDefault(e)),i.settings.create&&i.createItem()&&preventDefault(e)));case KEY_BACKSPACE:case KEY_DELETE:return void i.deleteSelection(e)}i.isInputHidden&&!isKeyDown(KEY_SHORTCUT,e)&&preventDefault(e)}}onInput(e){var t,i=this;i.isLocked||(t=i.inputValue(),i.lastValue!==t&&(i.lastValue=t,i.settings.shouldLoad.call(i,t)&&i.load(t),i.refreshOptions(),i.trigger("type",t)))}onFocus(e){var t=this,i=t.isFocused;if(t.isDisabled)return t.blur(),void preventDefault(e);t.ignoreFocus||(t.isFocused=!0,"focus"===t.settings.preload&&t.preload(),i||t.trigger("focus"),t.activeItems.length||(t.showInput(),t.refreshOptions(!!t.settings.openOnFocus)),t.refreshState())}onBlur(e){var t,i;!1===document.hasFocus()||(t=this).isFocused&&(t.isFocused=!1,t.ignoreFocus=!1,i=()=>{t.close(),t.setActiveItem(),t.setCaret(t.items.length),t.trigger("blur")},t.settings.create&&t.settings.createOnBlur?t.createItem(null,!1,i):i())}onOptionSelect(e,t){var i,s=this;t.parentElement&&t.parentElement.matches("[data-disabled]")||(t.classList.contains("create")?s.createItem(null,!0,()=>{s.settings.closeAfterSelect&&s.close()}):void 0!==(i=t.dataset.value)&&(s.lastQuery=null,s.addItem(i),s.settings.closeAfterSelect&&s.close(),!s.settings.hideSelected&&e.type&&/click/.test(e.type)&&s.setActiveOption(t)))}canSelect(e){return!!(this.isOpen&&e&&this.dropdown_content.contains(e))}onItemSelect(e,t){return!this.isLocked&&"multi"===this.settings.mode&&(preventDefault(e),this.setActiveItem(t,e),!0)}canLoad(e){return!!this.settings.load&&!this.loadedSearches.hasOwnProperty(e)}load(e){var t,i=this;i.canLoad(e)&&(addClasses(i.wrapper,i.settings.loadingClass),i.loading++,t=i.loadCallback.bind(i),i.settings.load.call(i,e,t))}loadCallback(e,t){var i=this;i.loading=Math.max(i.loading-1,0),i.lastQuery=null,i.clearActiveOption(),i.setupOptions(e,t),i.refreshOptions(i.isFocused&&!i.isInputHidden),i.loading||removeClasses(i.wrapper,i.settings.loadingClass),i.trigger("load",e,t)}preload(){var e=this.wrapper.classList;e.contains("preloaded")||(e.add("preloaded"),this.load(""))}setTextboxValue(e=""){var t=this.control_input;t.value!==e&&(t.value=e,triggerEvent(t,"update"),this.lastValue=e)}getValue(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)}setValue(e,t){var i=t?[]:["change"];debounce_events(this,i,()=>{this.clear(t),this.addItems(e,t)})}setMaxItems(e){this.settings.maxItems=e=0===e?null:e,this.refreshState()}setActiveItem(e,t){var i,s,n,r,o,a=this;if("single"!==a.settings.mode){if(!e)return a.clearActiveItems(),void(a.isFocused&&a.showInput());if("click"===(i=t&&t.type.toLowerCase())&&isKeyDown("shiftKey",t)&&a.activeItems.length){for(o=a.getLastActive(),n=Array.prototype.indexOf.call(a.control.children,o),(r=Array.prototype.indexOf.call(a.control.children,e))<n&&(o=n,n=r,r=o),s=n;s<=r;s++)e=a.control.children[s],-1===a.activeItems.indexOf(e)&&a.setActiveItemClass(e);preventDefault(t)}else"click"===i&&isKeyDown(KEY_SHORTCUT,t)||"keydown"===i&&isKeyDown("shiftKey",t)?e.classList.contains("active")?a.removeActiveItem(e):a.setActiveItemClass(e):(a.clearActiveItems(),a.setActiveItemClass(e));a.hideInput(),a.isFocused||a.focus()}}setActiveItemClass(e){var t=this.control.querySelector(".last-active");t&&removeClasses(t,"last-active"),addClasses(e,"active last-active"),this.trigger("item_select",e),-1==this.activeItems.indexOf(e)&&this.activeItems.push(e)}removeActiveItem(e){var t=this.activeItems.indexOf(e);this.activeItems.splice(t,1),removeClasses(e,"active")}clearActiveItems(){removeClasses(this.activeItems,"active"),this.activeItems=[]}setActiveOption(e){e!==this.activeOption&&(this.clearActiveOption(),e&&(this.activeOption=e,setAttr(this.focus_node,{"aria-activedescendant":e.getAttribute("id")}),setAttr(e,{"aria-selected":"true"}),addClasses(e,"active"),this.scrollToOption(e)))}scrollToOption(e,t){if(e){const r=this.dropdown_content;var i=r.clientHeight,s=r.scrollTop||0,n=e.offsetHeight,e=e.getBoundingClientRect().top-r.getBoundingClientRect().top+s;i+s<e+n?this.scroll(e-i+n,t):e<s&&this.scroll(e,t)}}scroll(e,t){const i=this.dropdown_content;t&&(i.style.scrollBehavior=t),i.scrollTop=e,i.style.scrollBehavior=""}clearActiveOption(){this.activeOption&&(removeClasses(this.activeOption,"active"),setAttr(this.activeOption,{"aria-selected":null})),this.activeOption=null,setAttr(this.focus_node,{"aria-activedescendant":null})}selectAll(){const t=this;var e;"single"===t.settings.mode||(e=t.controlChildren()).length&&(t.hideInput(),t.close(),t.activeItems=e,iterate(e,e=>{t.setActiveItemClass(e)}))}inputState(){var e=this;e.control.contains(e.control_input)&&(setAttr(e.control_input,{placeholder:e.settings.placeholder}),0<e.activeItems.length||!e.isFocused&&e.settings.hidePlaceholder&&0<e.items.length?(e.setTextboxValue(),e.isInputHidden=!0):(e.settings.hidePlaceholder&&0<e.items.length&&setAttr(e.control_input,{placeholder:""}),e.isInputHidden=!1),e.wrapper.classList.toggle("input-hidden",e.isInputHidden))}hideInput(){this.inputState()}showInput(){this.inputState()}inputValue(){return this.control_input.value.trim()}focus(){var e=this;e.isDisabled||(e.ignoreFocus=!0,(e.control_input.offsetWidth?e.control_input:e.focus_node).focus(),setTimeout(()=>{e.ignoreFocus=!1,e.onFocus()},0))}blur(){this.focus_node.blur(),this.onBlur()}getScoreFunction(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())}getSearchOptions(){var e=this.settings,t=e.sortField;return"string"==typeof e.sortField&&(t=[{field:e.sortField}]),{fields:e.searchField,conjunction:e.searchConjunction,sort:t,nesting:e.nesting}}search(e){var t,i,s,n=this,r=this.getSearchOptions();if(n.settings.score&&"function"!=typeof(s=n.settings.score.call(n,e)))throw new Error('Tom Select "score" setting must be a function that returns a function');if(e!==n.lastQuery?(n.lastQuery=e,i=n.sifter.search(e,Object.assign(r,{score:s})),n.currentResults=i):i=Object.assign({},n.currentResults),n.settings.hideSelected)for(t=i.items.length-1;0<=t;t--){var o=hash_key(i.items[t].id);o&&-1!==n.items.indexOf(o)&&i.items.splice(t,1)}return i}refreshOptions(e=!0){var t,i,s,n,r,o,a,l,d,c,p;const u={},h=[];var g=this,v=g.inputValue(),m=g.search(v),f=null,y=g.settings.shouldOpen||!1,_=g.dropdown_content;for(g.activeOption&&(d=g.activeOption.dataset.value,c=g.activeOption.closest("[data-group]")),n=m.items.length,0<(n="number"==typeof g.settings.maxOptions?Math.min(n,g.settings.maxOptions):n)&&(y=!0),t=0;t<n;t++){var O=m.items[t].id,b=g.options[O];let e=g.getOption(O,!0);for(g.settings.hideSelected||e.classList.toggle("selected",g.items.includes(O)),r=b[g.settings.optgroupField]||"",i=0,s=(o=Array.isArray(r)?r:[r])&&o.length;i<s;i++)r=o[i],g.optgroups.hasOwnProperty(r)||(r=""),u.hasOwnProperty(r)||(u[r]=document.createDocumentFragment(),h.push(r)),0<i&&(e=e.cloneNode(!0),setAttr(e,{id:b.$id+"-clone-"+i,"aria-selected":null}),e.classList.add("ts-cloned"),removeClasses(e,"active")),f||d!=O||c&&c.dataset.group!==r||(f=e),u[r].appendChild(e)}this.settings.lockOptgroupOrder&&h.sort((e,t)=>{return(g.optgroups[e]&&g.optgroups[e].$order||0)-(g.optgroups[t]&&g.optgroups[t].$order||0)}),a=document.createDocumentFragment(),iterate(h,e=>{var t,i;g.optgroups.hasOwnProperty(e)&&u[e].children.length?(i=document.createDocumentFragment(),t=g.render("optgroup_header",g.optgroups[e]),append(i,t),append(i,u[e]),i=g.render("optgroup",{group:g.optgroups[e],options:i}),append(a,i)):append(a,u[e])}),_.innerHTML="",append(_,a),g.settings.highlight&&(removeHighlight(_),m.query.length&&m.tokens.length&&iterate(m.tokens,e=>{highlight(_,e.regex)}));var w=e=>{e=g.render(e,{input:v});return e&&(y=!0,_.insertBefore(e,_.firstChild)),e};if(g.loading?w("loading"):g.settings.shouldLoad.call(g,v)?0===m.items.length&&w("no_results"):w("not_loading"),(l=g.canCreate(v))&&(p=w("option_create")),g.hasOptions=0<m.items.length||l,y){if(0<m.items.length){if(!f&&"single"===g.settings.mode&&g.items.length&&(f=g.getOption(g.items[0])),!_.contains(f)){let e=0;p&&!g.settings.addPrecedence&&(e=1),f=g.selectable()[e]}}else p&&(f=p);e&&!g.isOpen&&(g.open(),g.scrollToOption(f,"auto")),g.setActiveOption(f)}else g.clearActiveOption(),e&&g.isOpen&&g.close(!1)}selectable(){return this.dropdown_content.querySelectorAll("[data-selectable]")}addOption(e,t=!1){var i=this;if(Array.isArray(e))return i.addOptions(e,t),!1;var s=hash_key(e[i.settings.valueField]);return null!==s&&!i.options.hasOwnProperty(s)&&(e.$order=e.$order||++i.order,e.$id=i.inputId+"-opt-"+e.$order,i.options[s]=e,i.lastQuery=null,t&&(i.userOptions[s]=t,i.trigger("option_add",s,e)),s)}addOptions(e,t=!1){iterate(e,e=>{this.addOption(e,t)})}registerOption(e){return this.addOption(e)}registerOptionGroup(e){var t=hash_key(e[this.settings.optgroupValueField]);return null!==t&&(e.$order=e.$order||++this.order,this.optgroups[t]=e,t)}addOptionGroup(e,t){t[this.settings.optgroupValueField]=e,(e=this.registerOptionGroup(t))&&this.trigger("optgroup_add",e,t)}removeOptionGroup(e){this.optgroups.hasOwnProperty(e)&&(delete this.optgroups[e],this.clearCache(),this.trigger("optgroup_remove",e))}clearOptionGroups(){this.optgroups={},this.clearCache(),this.trigger("optgroup_clear")}updateOption(e,t){var i=this,s=hash_key(e),n=hash_key(t[i.settings.valueField]);if(null!==s&&i.options.hasOwnProperty(s)){if("string"!=typeof n)throw new Error("Value must be set in option data");const r=i.getOption(s),o=i.getItem(s);t.$order=t.$order||i.options[s].$order,delete i.options[s],i.uncacheValue(n),i.options[n]=t,r&&(i.dropdown_content.contains(r)&&(e=i._render("option",t),replaceNode(r,e),i.activeOption===r&&i.setActiveOption(e)),r.remove()),o&&(-1!==(s=i.items.indexOf(s))&&i.items.splice(s,1,n),t=i._render("item",t),o.classList.contains("active")&&addClasses(t,"active"),replaceNode(o,t)),i.lastQuery=null}}removeOption(e,t){var i=this;e=get_hash(e),i.uncacheValue(e),delete i.userOptions[e],delete i.options[e],i.lastQuery=null,i.trigger("option_remove",e),i.removeItem(e,t)}clearOptions(){this.loadedSearches={},this.userOptions={},this.clearCache();var i={};iterate(this.options,(e,t)=>{0<=this.items.indexOf(t)&&(i[t]=this.options[t])}),this.options=this.sifter.items=i,this.lastQuery=null,this.trigger("option_clear")}getOption(e,t=!1){e=hash_key(e);if(null!==e&&this.options.hasOwnProperty(e)){e=this.options[e];if(e.$div)return e.$div;if(t)return this._render("option",e)}return null}getAdjacent(t,i,e="option"){var s;if(!t)return null;s="item"==e?this.controlChildren():this.dropdown_content.querySelectorAll("[data-selectable]");for(let e=0;e<s.length;e++)if(s[e]==t)return 0<i?s[e+1]:s[e-1];return null}getItem(e){if("object"==typeof e)return e;e=hash_key(e);return null!==e?this.control.querySelector(`[data-value="${addSlashes(e)}"]`):null}addItems(e,i){var s=this,n=Array.isArray(e)?e:[e];for(let e=0,t=(n=n.filter(e=>-1===s.items.indexOf(e))).length;e<t;e++)s.isPending=e<t-1,s.addItem(n[e],i)}addItem(o,a){var e=a?[]:["change","dropdown_close"];debounce_events(this,e,()=>{var e,t,i,s=this,n=s.settings.mode,r=hash_key(o);r&&-1!==s.items.indexOf(r)&&("single"===n&&s.close(),"single"===n||!s.settings.duplicates)||null!==r&&s.options.hasOwnProperty(r)&&("single"===n&&s.clear(a),"multi"===n&&s.isFull()||(i=s._render("item",s.options[r]),s.control.contains(i)&&(i=i.cloneNode(!0)),e=s.isFull(),s.items.splice(s.caretPos,0,r),s.insertAtCaret(i),s.isSetup&&(!s.isPending&&s.settings.hideSelected&&(t=s.getOption(r),(t=s.getAdjacent(t,1))&&s.setActiveOption(t)),s.isPending||s.settings.closeAfterSelect||s.refreshOptions(s.isFocused&&"single"!==n),0!=s.settings.closeAfterSelect&&s.isFull()?s.close():s.isPending||s.positionDropdown(),s.trigger("item_add",r,i),s.isPending||s.updateOriginalInput({silent:a})),s.isPending&&(e||!s.isFull())||(s.inputState(),s.refreshState())))})}removeItem(e=null,t){var i,s,n,r=this;(e=r.getItem(e))&&(s=e.dataset.value,n=nodeIndex(e),e.remove(),e.classList.contains("active")&&(i=r.activeItems.indexOf(e),r.activeItems.splice(i,1),removeClasses(e,"active")),r.items.splice(n,1),r.lastQuery=null,!r.settings.persist&&r.userOptions.hasOwnProperty(s)&&r.removeOption(s,t),n<r.caretPos&&r.setCaret(r.caretPos-1),r.updateOriginalInput({silent:t}),r.refreshState(),r.positionDropdown(),r.trigger("item_remove",s,e))}createItem(e=null,t,i=()=>{}){var s=this,n=s.caretPos;if(e=e||s.inputValue(),!s.canCreate(e))return i(),!1;s.lock();var r=!1,o=e=>{if(s.unlock(),!e||"object"!=typeof e)return i();var t=hash_key(e[s.settings.valueField]);if("string"!=typeof t)return i();s.setTextboxValue(),s.addOption(e,!0),s.setCaret(n),s.addItem(t),i(e),r=!0},e="function"==typeof s.settings.create?s.settings.create.call(this,e,o):{[s.settings.labelField]:e,[s.settings.valueField]:e};return r||o(e),!0}refreshItems(){var e=this;e.lastQuery=null,e.isSetup&&e.addItems(e.items),e.updateOriginalInput(),e.refreshState()}refreshState(){var e=this;e.refreshValidityState();var t=e.isFull(),i=e.isLocked;e.wrapper.classList.toggle("rtl",e.rtl);const s=e.wrapper.classList;s.toggle("focus",e.isFocused),s.toggle("disabled",e.isDisabled),s.toggle("required",e.isRequired),s.toggle("invalid",!e.isValid),s.toggle("locked",i),s.toggle("full",t),s.toggle("input-active",e.isFocused&&!e.isInputHidden),s.toggle("dropdown-active",e.isOpen),s.toggle("has-options",isEmptyObject(e.options)),s.toggle("has-items",0<e.items.length)}refreshValidityState(){var e=this;e.input.checkValidity&&(e.isValid=e.input.checkValidity(),e.isInvalid=!e.isValid)}isFull(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems}updateOriginalInput(e={}){const s=this;var t,i;const n=s.input.querySelector('option[value=""]');if(s.is_select_tag){const o=[],a=s.input.querySelectorAll("option:checked").length;function r(e,t,i){return(e=e||getDom('<option value="'+escape_html(t)+'">'+escape_html(i)+"</option>"))!=n&&s.input.append(e),o.push(e),(e!=n||0<a)&&(e.selected=!0),e}s.input.querySelectorAll("option:checked").forEach(e=>{e.selected=!1}),0==s.items.length&&"single"==s.settings.mode?r(n,"",""):s.items.forEach(e=>{t=s.options[e],i=t[s.settings.labelField]||"",o.includes(t.$option)?r(s.input.querySelector(`option[value="${addSlashes(e)}"]:not(:checked)`),e,i):t.$option=r(t.$option,e,i)})}else s.input.value=s.getValue();s.isSetup&&(e.silent||s.trigger("change",s.getValue()))}open(){var e=this;e.isLocked||e.isOpen||"multi"===e.settings.mode&&e.isFull()||(e.isOpen=!0,setAttr(e.focus_node,{"aria-expanded":"true"}),e.refreshState(),applyCSS(e.dropdown,{visibility:"hidden",display:"block"}),e.positionDropdown(),applyCSS(e.dropdown,{visibility:"visible",display:"block"}),e.focus(),e.trigger("dropdown_open",e.dropdown))}close(e=!0){var t=this,i=t.isOpen;e&&(t.setTextboxValue(),"single"===t.settings.mode&&t.items.length&&t.hideInput()),t.isOpen=!1,setAttr(t.focus_node,{"aria-expanded":"false"}),applyCSS(t.dropdown,{display:"none"}),t.settings.hideSelected&&t.clearActiveOption(),t.refreshState(),i&&t.trigger("dropdown_close",t.dropdown)}positionDropdown(){var e,t,i;"body"===this.settings.dropdownParent&&(e=(i=this.control).getBoundingClientRect(),t=i.offsetHeight+e.top+window.scrollY,i=e.left+window.scrollX,applyCSS(this.dropdown,{width:e.width+"px",top:t+"px",left:i+"px"}))}clear(e){var t,i=this;i.items.length&&(t=i.controlChildren(),iterate(t,e=>{i.removeItem(e,!0)}),i.showInput(),e||i.updateOriginalInput(),i.trigger("clear"))}insertAtCaret(e){var t=this.caretPos;const i=this.control;i.insertBefore(e,i.children[t]),this.setCaret(t+1)}deleteSelection(e){var t,i=this,s=e&&e.keyCode===KEY_BACKSPACE?-1:1,n=getSelection(i.control_input);const r=[];i.activeItems.length?(t=getTail(i.activeItems,s),t=nodeIndex(t),0<s&&t++,iterate(i.activeItems,e=>r.push(e))):(i.isFocused||"single"===i.settings.mode)&&i.items.length&&(o=i.controlChildren(),s<0&&0===n.start&&0===n.length?r.push(o[i.caretPos-1]):0<s&&n.start===i.inputValue().length&&r.push(o[i.caretPos]));var o=r.map(e=>e.dataset.value);if(!o.length||"function"==typeof i.settings.onDelete&&!1===i.settings.onDelete.call(i,o,e))return!1;for(preventDefault(e,!0),void 0!==t&&i.setCaret(t);r.length;)i.removeItem(r.pop());return i.showInput(),i.positionDropdown(),i.refreshOptions(!1),!0}advanceSelection(e,t){var i,s=this;s.rtl&&(e*=-1),s.inputValue().length||(isKeyDown(KEY_SHORTCUT,t)||isKeyDown("shiftKey",t)?(t=(i=s.getLastActive(e))?i.classList.contains("active")?s.getAdjacent(i,e,"item"):i:0<e?s.control_input.nextElementSibling:s.control_input.previousElementSibling)&&(t.classList.contains("active")&&s.removeActiveItem(i),s.setActiveItemClass(t)):s.moveCaret(e))}moveCaret(e){}getLastActive(e){var t=this.control.querySelector(".last-active");if(t)return t;t=this.control.querySelectorAll(".active");return t?getTail(t,e):void 0}setCaret(e){this.caretPos=this.items.length}controlChildren(){return Array.from(this.control.querySelectorAll("[data-ts-item]"))}lock(){this.isLocked=!0,this.refreshState()}unlock(){this.isLocked=!1,this.refreshState()}disable(){var e=this;e.input.disabled=!0,e.control_input.disabled=!0,e.focus_node.tabIndex=-1,e.isDisabled=!0,this.close(),e.lock()}enable(){var e=this;e.input.disabled=!1,e.control_input.disabled=!1,e.focus_node.tabIndex=e.tabIndex,e.isDisabled=!1,e.unlock()}destroy(){var e=this,t=e.revertSettings;e.trigger("destroy"),e.off(),e.wrapper.remove(),e.dropdown.remove(),e.input.innerHTML=t.innerHTML,e.input.tabIndex=t.tabIndex,removeClasses(e.input,"tomselected","ts-hidden-accessible"),e._destroy(),delete e.input.tomselect}render(e,t){return"function"!=typeof this.settings.render[e]?null:this._render(e,t)}_render(e,t){var i,s,n="",r=this;return"option"!==e&&"item"!=e||(n=get_hash(t[r.settings.valueField])),null==(s=r.settings.render[e].call(this,t,escape_html))||(s=getDom(s),"option"===e||"option_create"===e?t[r.settings.disabledField]?setAttr(s,{"aria-disabled":"true"}):setAttr(s,{"data-selectable":""}):"optgroup"===e&&(i=t.group[r.settings.optgroupValueField],setAttr(s,{"data-group":i}),t.group[r.settings.disabledField]&&setAttr(s,{"data-disabled":""})),"option"!==e&&"item"!==e||(setAttr(s,{"data-value":n}),"item"===e?(addClasses(s,r.settings.itemClass),setAttr(s,{"data-ts-item":""})):(addClasses(s,r.settings.optionClass),setAttr(s,{role:"option",id:t.$id}),r.options[n].$div=s))),s}clearCache(){iterate(this.options,(e,t)=>{e.$div&&(e.$div.remove(),delete e.$div)})}uncacheValue(e){const t=this.getOption(e);t&&t.remove()}canCreate(e){return this.settings.create&&0<e.length&&this.settings.createFilter.call(this,e)}hook(i,e,s){var n=this,r=n[e];n[e]=function(){var e,t;return"after"===i&&(e=r.apply(n,arguments)),t=s.apply(n,arguments),"instead"===i?t:"before"===i?r.apply(n,arguments):e}}}function caret_position(){var s=this;s.hook("instead","setCaret",i=>{"single"!==s.settings.mode&&s.control.contains(s.control_input)?(i=Math.max(0,Math.min(s.items.length,i)))==s.caretPos||s.isPending||s.controlChildren().forEach((e,t)=>{t<i?s.control_input.insertAdjacentElement("beforebegin",e):s.control.appendChild(e)}):i=s.items.length,s.caretPos=i}),s.hook("instead","moveCaret",e=>{var t,i;s.isFocused&&((t=s.getLastActive(e))?(i=nodeIndex(t),s.setCaret(0<e?i+1:i),s.setActiveItem(),removeClasses(t,"last-active")):s.setCaret(s.caretPos+e))})}function dropdown_input(){var i=this;i.settings.shouldOpen=!0,i.hook("before","setup",()=>{i.focus_node=i.control,addClasses(i.control_input,"dropdown-input");const e=getDom('<div class="dropdown-input-wrap">');e.append(i.control_input),i.dropdown.insertBefore(e,i.dropdown.firstChild)}),i.on("initialize",()=>{i.control_input.addEventListener("keydown",e=>{switch(e.keyCode){case KEY_ESC:return i.isOpen&&(preventDefault(e,!0),i.close()),void i.clearActiveItems();case KEY_TAB:i.focus_node.tabIndex=-1}return i.onKeyDown.call(i,e)}),i.on("blur",()=>{i.focus_node.tabIndex=i.isDisabled?-1:i.tabIndex}),i.on("dropdown_open",()=>{i.control_input.focus()});const t=i.onBlur;i.hook("instead","onBlur",e=>{if(!e||e.relatedTarget!=i.control_input)return t.call(i)}),addEvent(i.control_input,"blur",()=>i.onBlur()),i.hook("before","close",()=>{i.isOpen&&i.focus_node.focus()})})}function no_backspace_delete(){var t=this,i=t.deleteSelection;this.hook("instead","deleteSelection",e=>!!t.activeItems.length&&i.call(t,e))}function remove_button(e){var n,e=Object.assign({label:"&times;",title:"Remove",className:"remove",append:!0},e),r=this;e.append&&(n='<a href="javascript:void(0)" class="'+e.className+'" tabindex="-1" title="'+escape_html(e.title)+'">'+e.label+"</a>",r.hook("after","setupTemplates",()=>{var s=r.settings.render.item;r.settings.render.item=(e,t)=>{var i=getDom(s.call(r,e,t)),t=getDom(n);return i.appendChild(t),addEvent(t,"mousedown",e=>{preventDefault(e,!0)}),addEvent(t,"click",e=>{preventDefault(e,!0),r.isLocked||(e=i.dataset.value,r.removeItem(e),r.refreshOptions(!1),r.inputState())}),i}}))}function restore_on_backspace(e){const t=this,i=Object.assign({text:e=>e[t.settings.labelField]},e);t.on("item_remove",function(e){t.isFocused&&(""!==t.control_input.value.trim()||(e=t.options[e])&&t.setTextboxValue(i.text.call(t,e)))})}TomSelect.define("caret_position",caret_position),TomSelect.define("dropdown_input",dropdown_input),TomSelect.define("no_backspace_delete",no_backspace_delete),TomSelect.define("remove_button",remove_button),TomSelect.define("restore_on_backspace",restore_on_backspace);export{TomSelect as default};
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var dictionary_1=require("./dictionary"),transform_1=require("./transform"),regex_1=require("./regex"),utils_1=require("./utils"),list=function(n){for(var l=[],x=null,e=function(){var e,r,i,t=x.index,s=t+x[0].length,o=x[0];return"/"===n.charAt(s)&&(o+=n.charAt(s),s++),-1<dictionary_1.closingParenthesis.indexOf(n.charAt(s))&&dictionary_1.parenthesis.forEach(function(e){var r=e.charAt(0),i=e.charAt(1);utils_1.checkParenthesis(r,i,o,n.charAt(s))&&(o+=n.charAt(s),s++)}),-1!==['""',"''","()"].indexOf(n.charAt(t-1)+n.charAt(s))&&utils_1.isInsideAttribute(n.substring(t-utils_1.maximumAttrLength-15,t))||-1<n.substring(s,n.length).indexOf("</a>")&&-1<n.substring(0,t).indexOf("<a")&&utils_1.isInsideAnchorTag(o,n,s)?"continue":void(x[regex_1.iidxes.isURL]?(e=(x[regex_1.iidxes.url.path]||"")+(x[regex_1.iidxes.url.secondPartOfPath]||"")||void 0,r=x[regex_1.iidxes.url.protocol1]||x[regex_1.iidxes.url.protocol2]||x[regex_1.iidxes.url.protocol3],l.push({start:t,end:s,string:o,isURL:!0,protocol:r,port:x[regex_1.iidxes.url.port],ipv4:x[regex_1.iidxes.url.ipv4Confirmation]?x[regex_1.iidxes.url.ipv4]:void 0,ipv6:x[regex_1.iidxes.url.ipv6],host:x[regex_1.iidxes.url.byProtocol]?void 0:(x[regex_1.iidxes.url.protocolWithDomain]||"").substr((r||"").length),confirmedByProtocol:!!x[regex_1.iidxes.url.byProtocol],path:x[regex_1.iidxes.url.byProtocol]?void 0:e,query:x[regex_1.iidxes.url.query]||void 0,fragment:x[regex_1.iidxes.url.fragment]||void 0})):x[regex_1.iidxes.isFile]?(i=o.substr(8),l.push({start:t,end:s,string:o,isFile:!0,protocol:x[regex_1.iidxes.file.protocol],filename:x[regex_1.iidxes.file.fileName],filePath:i,fileDirectory:i.substr(0,i.length-x[regex_1.iidxes.file.fileName].length)})):x[regex_1.iidxes.isEmail]?l.push({start:t,end:s,string:o,isEmail:!0,local:x[regex_1.iidxes.email.local],protocol:x[regex_1.iidxes.email.protocol],host:x[regex_1.iidxes.email.host]}):l.push({start:t,end:s,string:o}))};null!==(x=regex_1.finalRegex.exec(n));)e();return l},anchorme=function(e){var r="string"==typeof e?{input:e,options:void 0,extensions:void 0}:e,i=r.input,t=r.options,s=r.extensions;if(s)for(var o=0;o<s.length;o++)var n=s[o],i=i.replace(n.test,n.transform);for(var l=list(i),x="",o=0;o<l.length;o++)x=(x||(0===o?i.substring(0,l[o].start):""))+transform_1.transform(l[o],t)+(l[o+1]?i.substring(l[o].end,l[o+1].start):i.substring(l[o].end));return x||i};anchorme.list=function(e){return list(e)},anchorme.validate={ip:function(e){return regex_1.ipRegex.test(e)},email:function(e){return regex_1.emailRegex.test(e)},file:function(e){return regex_1.fileRegex.test(e)},url:function(e){return regex_1.urlRegex.test(e)||regex_1.ipRegex.test(e)}},exports.default=anchorme;
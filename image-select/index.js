!function(n){function e(e,o,t,i,s,r){var c=n(o).data("img-src");void 0!=c&&c>""&&(e=n(e),text=n(o).text(),s=void 0==s||s,r=r||(s?"chose-image":"chose-image-small"),r=i?r+" rtl":r,t=t.replace("{url}",c).replace("{class_name}",r).replace("{text}",text),e.empty(),i&&s?e.append(t):e.prepend(t))}function o(e){for(var o=[],t=n(e.form_field).find("option:selected")||[],i=e.is_multiple?n(e.container).find(".chosen-choices span"):n(e.container).find(".chosen-single span"),s=0;s<t.length;s++)for(var r=0;r<i.length;r++)n(i[r]).text()==n(t[s]).text()&&o.push({span:i[r],option:t[s]});return o}var t='<img class="{class_name}" src="{url}" />',i=n.fn.chosen;n.fn.extend({chosen:function(s){s=s||{};i.apply(this,arguments);return this.each(function(){var i=n(this),r=i.data("chosen");i.on("chosen:hiding_dropdown",function(n,i){for(var r=o(i.chosen),c=i.chosen.is_rtl,a=i.chosen.is_multiple,h=s.html_template||(c&&a?"{text}"+t:t+"{text}"),d=0;d<r.length;d++)e(r[d].span,r[d].option,h,c,a)}),i.on("chosen:showing_dropdown",function(o,i){for(var r=(i=i.chosen).form_field.options||[],c=i.is_rtl,a=s.html_template||(c?"{text}"+t:t+"{text}"),h=n(i.container).find(".chosen-drop ul li:not(:has(img))"),d=0;d<h.length;d++){var l=h[d],p=(n(r[d]),n(l).attr("data-option-array-index"));p&&e(l,r[i.results_data[p].options_index],a,c,!0,"chose-image-list")}}),i.on("chosen:ready",function(n,e){i.trigger("chosen:hiding_dropdown",e)}),i.on("chosen:updated",function(n){i.trigger("chosen:hiding_dropdown",{chosen:r})}),i.on("chosen:filter",function(n,e){i.trigger("chosen:showing_dropdown",{chosen:e.chosen})}),void 0!==r&&i.trigger("chosen:hiding_dropdown",{chosen:r})}),n(this)}})}(jQuery);
/*
jQuery Age
Copyright 2013 Kevin Sylvestre
1.2.4
*/
(function(){"use strict";var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}};e=jQuery;t=function(){function t(r,i){if(i==null){i={}}this.text=n(this.text,this);this.interval=n(this.interval,this);this.format=n(this.format,this);this.unit=n(this.unit,this);this.amount=n(this.amount,this);this.formatting=n(this.formatting,this);this.adjust=n(this.adjust,this);this.prefix=n(this.prefix,this);this.suffix=n(this.suffix,this);this.date=n(this.date,this);this.reformat=n(this.reformat,this);this.$el=r;this.settings=e.extend({},t.settings,i);this.reformat()}t.settings={singular:1,interval:1e3,suffixes:{past:"ago",future:"until"},prefixes:{past:"",future:""},units:["years","months","weeks","days","hours","minutes","seconds"],formats:{now:"now",singular:{seconds:"a second",minutes:"a minute",hours:"an hour",days:"a day",weeks:"a week",months:"a month",years:"a year"},plural:{seconds:"{{amount}} seconds",minutes:"{{amount}} minutes",hours:"{{amount}} hours",days:"{{amount}} days",weeks:"{{amount}} weeks",months:"{{amount}} months",years:"{{amount}} years"},tiny:{seconds:"{{amount}}s",minutes:"{{amount}}m",hours:"{{amount}}h",days:"{{amount}}d",weeks:"{{amount}}w",months:"{{amount}}m",years:"{{amount}}y"}}};t.prototype.reformat=function(){var e;e=this.interval();this.$el.html(this.text(e));return setTimeout(this.reformat,this.settings.interval)};t.prototype.date=function(){return new Date(this.$el.attr("datetime")||this.$el.attr("date")||this.$el.attr("time"))};t.prototype.suffix=function(e){if(e<0){return this.settings.suffixes.past}if(e>0){return this.settings.suffixes.future}};t.prototype.prefix=function(e){if(e<0){return this.settings.prefixes.past}if(e>0){return this.settings.prefixes.future}};t.prototype.adjust=function(e,t){return Math.floor(Math.abs(e/t))};t.prototype.formatting=function(e){return{seconds:this.adjust(e,1e3),minutes:this.adjust(e,1e3*60),hours:this.adjust(e,1e3*60*60),days:this.adjust(e,1e3*60*60*24),weeks:this.adjust(e,1e3*60*60*24*7),months:this.adjust(e,1e3*60*60*24*30),years:this.adjust(e,1e3*60*60*24*365)}};t.prototype.amount=function(e){return e[this.unit(e)]||0};t.prototype.unit=function(e){var t,n,r,i;i=this.settings.units;for(n=0,r=i.length;n<r;n++){t=i[n];if(e[t]>0){return t}}return void 0};t.prototype.format=function(e,t){var n,r;if(this.settings.style!=null){return(n=this.settings.formats[this.settings.style])!=null?n[t]:void 0}return(r=this.settings.formats[e===this.settings.singular?"singular":"plural"])!=null?r[t]:void 0};t.prototype.interval=function(){return this.date()-new Date};t.prototype.text=function(e){var t,n,r,i,s,o;if(e==null){e=this.interval()}if(e>0&&this.settings.pending!=null){return this.settings.pending}if(e<0&&this.settings.expired!=null){return this.settings.expired}s=this.suffix(e);i=this.prefix(e);r=this.formatting(e);t=this.amount(r);o=this.unit(r);n=this.format(t,o);if(!n){return this.settings.formats.now}return(""+i+" "+n.replace("{{unit}}",o).replace("{{amount}}",t)+" "+s).trim()};return t}();e.fn.extend({age:function(n){if(n==null){n={}}return this.each(function(){return new t(e(this),n)})}})}).call(this)

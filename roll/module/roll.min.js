"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_get=function(e,t,r){for(var n=!0;n;){var i=e,s=t,o=r;l=u=a=void 0,n=!1,null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,s);if(void 0!==l){if("value"in l)return l.value;var a=l.get;if(void 0===a)return;return a.call(o)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=s,r=o,n=!0}},EventEmitter=require("events").EventEmitter,Roll=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.viewportSize=e,this.paneSize=0,this.steps=[],this.pos=0,this.current=0,this.last=-1,this.movingInterval=-1}return _inherits(t,e),_createClass(t,[{key:"addStep",value:function(e){Array.isArray(e)||(e=[e]);var t=e[0].p1;if(this.steps.length>0){var r=this.steps[this.steps.length-1];t=r.p2+r.pad}for(var n=0;n<e.length;n++)e[n].p1=t,e[n].p2=e[n].p1+e[n].size,t=e[n].p2+e[n].pad,this.steps.push(e[n]);return this.getHeight(!0),this}},{key:"getStepAt",value:function(e){return this.steps[Math.max(0,Math.min(this.steps.length-1,e))]}},{key:"getStep",value:function(){for(var e=0;e<this.steps.length;e++){var t=this.steps[e];if(t.p1>=-this.viewportSize&&t.p2<=t.size)return this.current=e,e}return-1}},{key:"getStepProgress",value:function(){var e=this.steps[this.current];return 1-e.p2/e.size}},{key:"getPosition",value:function(){return this.pos}},{key:"getHeight",value:function(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];return e&&(this.paneSize=this.steps.reduce(function(e,t){return e+t.size+t.pad},0)),this.paneSize}},{key:"getViewportHeight",value:function(){return this.viewportSize}},{key:"move",value:function(e){var t=this.pos;this.pos=-e;for(var r=this.pos-t,n=0;n<this.steps.length;n++){var i=this.steps[n];i.p1+=r,i.p2=i.p1+i.size}var s=this.getStep(),o=this.getStepProgress();return this.emit("roll",s,o,e,e/(this.paneSize-this.viewportSize)),s!=this.last&&s>=0&&(this.emit("step",s,this.last,this.viewportSize),this.last=s),this}},{key:"scroll",value:function(e,t){var r=this,n=arguments.length<=2||void 0===arguments[2]?.1:arguments[2],i=arguments.length<=3||void 0===arguments[3]||arguments[3];if(!t||null==t.scrollTop)throw"scrollPane parameter requires a DOM element with scrollTop property";clearInterval(this.movingInterval);var s=Number.NEGATIVE_INFINITY,o=i?"scrollTop":"scrollLeft";this.movingInterval=setInterval(function(){var i=r.getStepAt(e),l=(i.p1+i.size/4)*n;t[o]+=l,(Math.abs(l)<1||s===t[o])&&clearInterval(r.movingInterval),s=t[o]},17)}}],[{key:"chunk",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return{p1:0,p2:e,size:e,pad:t}}},{key:"stepName",value:function(e,t){var r=arguments.length<=2||void 0===arguments[2]?"prev":arguments[2],n=arguments.length<=3||void 0===arguments[3]?"next":arguments[3],i=arguments.length<=4||void 0===arguments[4]?"curr":arguments[4];return e===t?i:e<t?r:n}},{key:"stepHandler",value:function(e,r){var n=arguments.length<=2||void 0===arguments[2]?"prev":arguments[2],i=arguments.length<=3||void 0===arguments[3]?"next":arguments[3],s=arguments.length<=4||void 0===arguments[4]?"curr":arguments[4],o=!(arguments.length<=5||void 0===arguments[5])&&arguments[5];return function(l,a,u){for(var p=0;p<e.steps.length;p++){var h=t.stepName(p,l,n,i,s);if(r[p].className="step "+h,o){var v=h===n?e.steps[p].size*-1:h===i?u:0;r[p].style.top=v+"px"}}}}},{key:"DOM",value:function(e,r,n,i){var s=arguments.length<=4||void 0===arguments[4]?0:arguments[4],o=document.querySelector(e),l=o.querySelector(r),a=document.querySelector(n),u=a.querySelectorAll(i);if(!o||!l)throw"Cannot find "+e+" or "+r+" element id.";if(!i)throw"Cannot find "+i+" element class name";for(var p=new t(o.getBoundingClientRect().height),h=0;h<u.length;h++){var v=u[h].getBoundingClientRect();p.addStep(t.chunk(v.height,s))}return l.style.height=p.getHeight()+"px",a.style.width=l.getBoundingClientRect().width+"px",o.addEventListener("scroll",function(e){p.move(o.scrollTop)}),p}}]),t}(EventEmitter);exports.default=Roll,window&&(window.Roll=Roll),module.exports=exports.default;
//# sourceMappingURL=roll.min.js.map
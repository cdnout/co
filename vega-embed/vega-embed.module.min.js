import{applyPatch}from"fast-json-patch";import stringify from"json-stringify-pretty-compact";import*as vegaImport from"vega";import{writeConfig,mergeConfig,isString,isBoolean}from"vega";import{expressionInterpreter}from"vega-interpreter";import*as vegaLiteImport from"vega-lite";import schemaParser from"vega-schema-url-parser";import*as themes from"vega-themes";import{Handler}from"vega-tooltip";function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function asyncGeneratorStep(e,t,r,n,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function _asyncToGenerator(s){return function(){var e=this,i=arguments;return new Promise(function(t,r){var n=s.apply(e,i);function o(e){asyncGeneratorStep(n,t,r,o,a,"next",e)}function a(e){asyncGeneratorStep(n,t,r,o,a,"throw",e)}o(void 0)})}}var undefined$1,Op=Object.prototype,hasOwn=Op.hasOwnProperty,$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function wrap(e,t,r,n){t=t&&t.prototype instanceof Generator?t:Generator,t=Object.create(t.prototype),n=new Context(n||[]);return t._invoke=makeInvokeMethod(e,r,n),t}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}var GenStateSuspendedStart="suspendedStart",GenStateSuspendedYield="suspendedYield",GenStateExecuting="executing",GenStateCompleted="completed",ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};IteratorPrototype[iteratorSymbol]=function(){return this};var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function isGeneratorFunction(e){e="function"==typeof e&&e.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))}function mark(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,toStringTagSymbol in e||(e[toStringTagSymbol]="GeneratorFunction")),e.prototype=Object.create(Gp),e}function awrap(e){return{__await:e}}function AsyncIterator(i,s){var t;this._invoke=function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,o){e=tryCatch(i[e],i,r);if("throw"!==e.type){var a=e.arg;return(r=a.value)&&"object"==typeof r&&hasOwn.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,o)},function(e){t("throw",e,n,o)}):s.resolve(r).then(function(e){a.value=e,n(a)},function(e){return t("throw",e,n,o)})}o(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}}function async(e,t,r,n,o){void 0===o&&(o=Promise);var a=new AsyncIterator(wrap(e,t,r,n),o);return isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})}function makeInvokeMethod(o,a,i){var s=GenStateSuspendedStart;return function(e,t){if(s===GenStateExecuting)throw new Error("Generator is already running");if(s===GenStateCompleted){if("throw"===e)throw t;return doneResult()}for(i.method=e,i.arg=t;;){var r=i.delegate;if(r){var n=maybeInvokeDelegate(r,i);if(n){if(n===ContinueSentinel)continue;return n}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(s===GenStateSuspendedStart)throw s=GenStateCompleted,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);s=GenStateExecuting;n=tryCatch(o,a,i);if("normal"===n.type){if(s=i.done?GenStateCompleted:GenStateSuspendedYield,n.arg!==ContinueSentinel)return{value:n.arg,done:i.done}}else"throw"===n.type&&(s=GenStateCompleted,i.method="throw",i.arg=n.arg)}}}function maybeInvokeDelegate(e,t){var r=e.iterator[t.method];if(r===undefined$1){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=undefined$1,maybeInvokeDelegate(e,t),"throw"===t.method))return ContinueSentinel;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return ContinueSentinel}r=tryCatch(r,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,ContinueSentinel;r=r.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=undefined$1),t.delegate=null,ContinueSentinel):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,ContinueSentinel)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function keys(r){var e,n=[];for(e in r)n.push(e);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}}function values(t){if(t){var e=t[iteratorSymbol];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,e=function e(){for(;++r<t.length;)if(hasOwn.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=undefined$1,e.done=!0,e};return e.next=e}}return{next:doneResult}}function doneResult(){return{value:undefined$1,done:!0}}(GeneratorFunction.prototype=Gp.constructor=GeneratorFunctionPrototype).constructor=GeneratorFunction,GeneratorFunctionPrototype[toStringTagSymbol]=GeneratorFunction.displayName="GeneratorFunction",defineIteratorMethods(AsyncIterator.prototype),AsyncIterator.prototype[asyncIteratorSymbol]=function(){return this},defineIteratorMethods(Gp),Gp[toStringTagSymbol]="Generator",Gp[iteratorSymbol]=function(){return this},Gp.toString=function(){return"[object Generator]"},Context.prototype={constructor:Context,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=undefined$1,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined$1,this.tryEntries.forEach(resetTryEntry),!e)for(var t in this)"t"===t.charAt(0)&&hasOwn.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=undefined$1)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return a.type="throw",a.arg=r,n.next=e,t&&(n.method="next",n.arg=undefined$1),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],a=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var i=hasOwn.call(o,"catchLoc"),s=hasOwn.call(o,"finallyLoc");if(i&&s){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&hasOwn.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var a=(o=o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc?null:o)?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,ContinueSentinel):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),ContinueSentinel},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),ContinueSentinel}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n,o=r.completion;return"throw"===o.type&&(n=o.arg,resetTryEntry(r)),n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:values(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=undefined$1),ContinueSentinel}};var _regeneratorRuntime={wrap:wrap,isGeneratorFunction:isGeneratorFunction,AsyncIterator:AsyncIterator,mark:mark,awrap:awrap,async:async,keys:keys,values:values},yallist=Yallist$1;function Yallist$1(e){var t=this;if((t=!(t instanceof Yallist$1)?new Yallist$1:t).tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach(function(e){t.push(e)});else if(0<arguments.length)for(var r=0,n=arguments.length;r<n;r++)t.push(arguments[r]);return t}function insert(e,t,r){t=t===e.head?new Node(r,null,t,e):new Node(r,t,t.next,e);return null===t.next&&(e.tail=t),null===t.prev&&(e.head=t),e.length++,t}function push(e,t){e.tail=new Node(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function unshift(e,t){e.head=new Node(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Node(e,t,r,n){if(!(this instanceof Node))return new Node(e,t,r,n);this.list=n,this.value=e,t?(t.next=this).prev=t:this.prev=null,r?(r.prev=this).next=r:this.next=null}Yallist$1.Node=Node,(Yallist$1.create=Yallist$1).prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},Yallist$1.prototype.unshiftNode=function(e){var t;e!==this.head&&(e.list&&e.list.removeNode(e),t=this.head,e.list=this,(e.next=t)&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++)},Yallist$1.prototype.pushNode=function(e){var t;e!==this.tail&&(e.list&&e.list.removeNode(e),t=this.tail,e.list=this,(e.prev=t)&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++)},Yallist$1.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)push(this,arguments[e]);return this.length},Yallist$1.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)unshift(this,arguments[e]);return this.length},Yallist$1.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},Yallist$1.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},Yallist$1.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},Yallist$1.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},Yallist$1.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},Yallist$1.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},Yallist$1.prototype.map=function(e,t){t=t||this;for(var r=new Yallist$1,n=this.head;null!==n;)r.push(e.call(t,n.value,this)),n=n.next;return r},Yallist$1.prototype.mapReverse=function(e,t){t=t||this;for(var r=new Yallist$1,n=this.tail;null!==n;)r.push(e.call(t,n.value,this)),n=n.prev;return r},Yallist$1.prototype.reduce=function(e,t){var r,n=this.head;if(1<arguments.length)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var o=0;null!==n;o++)r=e(r,n.value,o),n=n.next;return r},Yallist$1.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(1<arguments.length)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var o=this.length-1;null!==n;o--)r=e(r,n.value,o),n=n.prev;return r},Yallist$1.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},Yallist$1.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},Yallist$1.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new Yallist$1;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=0,o=this.head;null!==o&&n<e;n++)o=o.next;for(;null!==o&&n<t;n++,o=o.next)r.push(o.value);return r},Yallist$1.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new Yallist$1;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=this.length,o=this.tail;null!==o&&t<n;n--)o=o.prev;for(;null!==o&&e<n;n--,o=o.prev)r.push(o.value);return r},Yallist$1.prototype.splice=function(e,t){(e=e>this.length?this.length-1:e)<0&&(e=this.length+e);for(var r=0,n=this.head;null!==n&&r<e;r++)n=n.next;for(var o=[],r=0;n&&r<t;r++)o.push(n.value),n=this.removeNode(n);(n=null===n?this.tail:n)!==this.head&&n!==this.tail&&(n=n.prev);for(r=0;r<(arguments.length<=2?0:arguments.length-2);r++)n=insert(this,n,r+2<2||arguments.length<=r+2?void 0:arguments[r+2]);return o},Yallist$1.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{Yallist$1.prototype[Symbol.iterator]=_regeneratorRuntime.mark(function e(){var t;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.head;case 1:if(t)return e.next=4,t.value;e.next=7;break;case 4:t=t.next,e.next=1;break;case 7:case"end":return e.stop()}},e,this)})}catch(e){}var Yallist=yallist,MAX=Symbol("max"),LENGTH=Symbol("length"),LENGTH_CALCULATOR=Symbol("lengthCalculator"),ALLOW_STALE=Symbol("allowStale"),MAX_AGE=Symbol("maxAge"),DISPOSE=Symbol("dispose"),NO_DISPOSE_ON_SET=Symbol("noDisposeOnSet"),LRU_LIST=Symbol("lruList"),CACHE=Symbol("cache"),UPDATE_AGE_ON_GET=Symbol("updateAgeOnGet"),naiveLength=()=>1;class LRUCache{constructor(e){if((e=(e="number"==typeof e?{max:e}:e)||{}).max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[MAX]=e.max||1/0;var t=e.length||naiveLength;if(this[LENGTH_CALCULATOR]="function"!=typeof t?naiveLength:t,this[ALLOW_STALE]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[MAX_AGE]=e.maxAge||0,this[DISPOSE]=e.dispose,this[NO_DISPOSE_ON_SET]=e.noDisposeOnSet||!1,this[UPDATE_AGE_ON_GET]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[MAX]=e||1/0,trim(this)}get max(){return this[MAX]}set allowStale(e){this[ALLOW_STALE]=!!e}get allowStale(){return this[ALLOW_STALE]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[MAX_AGE]=e,trim(this)}get maxAge(){return this[MAX_AGE]}set lengthCalculator(e){(e="function"!=typeof e?naiveLength:e)!==this[LENGTH_CALCULATOR]&&(this[LENGTH_CALCULATOR]=e,this[LENGTH]=0,this[LRU_LIST].forEach(e=>{e.length=this[LENGTH_CALCULATOR](e.value,e.key),this[LENGTH]+=e.length})),trim(this)}get lengthCalculator(){return this[LENGTH_CALCULATOR]}get length(){return this[LENGTH]}get itemCount(){return this[LRU_LIST].length}rforEach(e,t){t=t||this;for(var r=this[LRU_LIST].tail;null!==r;){var n=r.prev;forEachStep(this,e,r,t),r=n}}forEach(e,t){t=t||this;for(var r=this[LRU_LIST].head;null!==r;){var n=r.next;forEachStep(this,e,r,t),r=n}}keys(){return this[LRU_LIST].toArray().map(e=>e.key)}values(){return this[LRU_LIST].toArray().map(e=>e.value)}reset(){this[DISPOSE]&&this[LRU_LIST]&&this[LRU_LIST].length&&this[LRU_LIST].forEach(e=>this[DISPOSE](e.key,e.value)),this[CACHE]=new Map,this[LRU_LIST]=new Yallist,this[LENGTH]=0}dump(){return this[LRU_LIST].map(e=>!isStale(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[LRU_LIST]}set(e,t,r){if((r=r||this[MAX_AGE])&&"number"!=typeof r)throw new TypeError("maxAge must be a number");var n=r?Date.now():0,o=this[LENGTH_CALCULATOR](t,e);if(this[CACHE].has(e)){if(o>this[MAX])return del(this,this[CACHE].get(e)),!1;var a=this[CACHE].get(e).value;return this[DISPOSE]&&(this[NO_DISPOSE_ON_SET]||this[DISPOSE](e,a.value)),a.now=n,a.maxAge=r,a.value=t,this[LENGTH]+=o-a.length,a.length=o,this.get(e),trim(this),!0}r=new Entry(e,t,o,n,r);return r.length>this[MAX]?(this[DISPOSE]&&this[DISPOSE](e,t),!1):(this[LENGTH]+=r.length,this[LRU_LIST].unshift(r),this[CACHE].set(e,this[LRU_LIST].head),trim(this),!0)}has(e){if(!this[CACHE].has(e))return!1;e=this[CACHE].get(e).value;return!isStale(this,e)}get(e){return get(this,e,!0)}peek(e){return get(this,e,!1)}pop(){var e=this[LRU_LIST].tail;return e?(del(this,e),e.value):null}del(e){del(this,this[CACHE].get(e))}load(e){this.reset();for(var t=Date.now(),r=e.length-1;0<=r;r--){var n=e[r],o=n.e||0;0===o?this.set(n.k,n.v):0<(o=o-t)&&this.set(n.k,n.v,o)}}prune(){this[CACHE].forEach((e,t)=>get(this,t,!1))}}var get=(e,t,r)=>{var n=e[CACHE].get(t);if(n){t=n.value;if(isStale(e,t)){if(del(e,n),!e[ALLOW_STALE])return}else r&&(e[UPDATE_AGE_ON_GET]&&(n.value.now=Date.now()),e[LRU_LIST].unshiftNode(n));return t.value}},isStale=(e,t)=>{if(!t||!t.maxAge&&!e[MAX_AGE])return!1;var r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[MAX_AGE]&&r>e[MAX_AGE]},trim=e=>{if(e[LENGTH]>e[MAX])for(var t=e[LRU_LIST].tail;e[LENGTH]>e[MAX]&&null!==t;){var r=t.prev;del(e,t),t=r}},del=(e,t)=>{var r;t&&(r=t.value,e[DISPOSE]&&e[DISPOSE](r.key,r.value),e[LENGTH]-=r.length,e[CACHE].delete(r.key),e[LRU_LIST].removeNode(t))};class Entry{constructor(e,t,r,n,o){this.key=e,this.value=t,this.length=r,this.now=n,this.maxAge=o||0}}var forEachStep=(e,t,r,n)=>{var o=r.value;isStale(e,o)&&(del(e,r),e[ALLOW_STALE]||(o=void 0)),o&&t.call(n,o.value,o.key,e)},lruCache=LRUCache,opts=["includePrerelease","loose","rtl"],parseOptions$3=t=>t?"object"!=typeof t?{loose:!0}:opts.filter(e=>t[e]).reduce((e,t)=>(e[t]=!0,e),{}):{},parseOptions_1=parseOptions$3,re$3={exports:{}},SEMVER_SPEC_VERSION="2.0.0",MAX_LENGTH$1=256,MAX_SAFE_INTEGER$1=Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH=16,constants={SEMVER_SPEC_VERSION:SEMVER_SPEC_VERSION,MAX_LENGTH:MAX_LENGTH$1,MAX_SAFE_INTEGER:MAX_SAFE_INTEGER$1,MAX_SAFE_COMPONENT_LENGTH:MAX_SAFE_COMPONENT_LENGTH},debug$3="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return console.error("SEMVER",...t)}:()=>{},debug_1=debug$3;!function(e,t){var r=constants.MAX_SAFE_COMPONENT_LENGTH,o=debug_1,a=(t=e.exports={}).re=[],i=t.src=[],s=t.t={},c=0,e=(e,t,r)=>{var n=c++;o(n,t),s[e]=n,i[n]=t,a[n]=new RegExp(t,r?"g":void 0)};e("NUMERICIDENTIFIER","0|[1-9]\\d*"),e("NUMERICIDENTIFIERLOOSE","[0-9]+"),e("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),e("MAINVERSION","(".concat(i[s.NUMERICIDENTIFIER],")\\.")+"(".concat(i[s.NUMERICIDENTIFIER],")\\.")+"(".concat(i[s.NUMERICIDENTIFIER],")")),e("MAINVERSIONLOOSE","(".concat(i[s.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(i[s.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(i[s.NUMERICIDENTIFIERLOOSE],")")),e("PRERELEASEIDENTIFIER","(?:".concat(i[s.NUMERICIDENTIFIER],"|").concat(i[s.NONNUMERICIDENTIFIER],")")),e("PRERELEASEIDENTIFIERLOOSE","(?:".concat(i[s.NUMERICIDENTIFIERLOOSE],"|").concat(i[s.NONNUMERICIDENTIFIER],")")),e("PRERELEASE","(?:-(".concat(i[s.PRERELEASEIDENTIFIER],"(?:\\.").concat(i[s.PRERELEASEIDENTIFIER],")*))")),e("PRERELEASELOOSE","(?:-?(".concat(i[s.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(i[s.PRERELEASEIDENTIFIERLOOSE],")*))")),e("BUILDIDENTIFIER","[0-9A-Za-z-]+"),e("BUILD","(?:\\+(".concat(i[s.BUILDIDENTIFIER],"(?:\\.").concat(i[s.BUILDIDENTIFIER],")*))")),e("FULLPLAIN","v?".concat(i[s.MAINVERSION]).concat(i[s.PRERELEASE],"?").concat(i[s.BUILD],"?")),e("FULL","^".concat(i[s.FULLPLAIN],"$")),e("LOOSEPLAIN","[v=\\s]*".concat(i[s.MAINVERSIONLOOSE]).concat(i[s.PRERELEASELOOSE],"?").concat(i[s.BUILD],"?")),e("LOOSE","^".concat(i[s.LOOSEPLAIN],"$")),e("GTLT","((?:<|>)?=?)"),e("XRANGEIDENTIFIERLOOSE","".concat(i[s.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),e("XRANGEIDENTIFIER","".concat(i[s.NUMERICIDENTIFIER],"|x|X|\\*")),e("XRANGEPLAIN","[v=\\s]*(".concat(i[s.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(i[s.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(i[s.XRANGEIDENTIFIER],")")+"(?:".concat(i[s.PRERELEASE],")?").concat(i[s.BUILD],"?")+")?)?"),e("XRANGEPLAINLOOSE","[v=\\s]*(".concat(i[s.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(i[s.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(i[s.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(i[s.PRERELEASELOOSE],")?").concat(i[s.BUILD],"?")+")?)?"),e("XRANGE","^".concat(i[s.GTLT],"\\s*").concat(i[s.XRANGEPLAIN],"$")),e("XRANGELOOSE","^".concat(i[s.GTLT],"\\s*").concat(i[s.XRANGEPLAINLOOSE],"$")),e("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(r,"})")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:$|[^\\d])"),e("COERCERTL",i[s.COERCE],!0),e("LONETILDE","(?:~>?)"),e("TILDETRIM","(\\s*)".concat(i[s.LONETILDE],"\\s+"),!0),t.tildeTrimReplace="$1~",e("TILDE","^".concat(i[s.LONETILDE]).concat(i[s.XRANGEPLAIN],"$")),e("TILDELOOSE","^".concat(i[s.LONETILDE]).concat(i[s.XRANGEPLAINLOOSE],"$")),e("LONECARET","(?:\\^)"),e("CARETTRIM","(\\s*)".concat(i[s.LONECARET],"\\s+"),!0),t.caretTrimReplace="$1^",e("CARET","^".concat(i[s.LONECARET]).concat(i[s.XRANGEPLAIN],"$")),e("CARETLOOSE","^".concat(i[s.LONECARET]).concat(i[s.XRANGEPLAINLOOSE],"$")),e("COMPARATORLOOSE","^".concat(i[s.GTLT],"\\s*(").concat(i[s.LOOSEPLAIN],")$|^$")),e("COMPARATOR","^".concat(i[s.GTLT],"\\s*(").concat(i[s.FULLPLAIN],")$|^$")),e("COMPARATORTRIM","(\\s*)".concat(i[s.GTLT],"\\s*(").concat(i[s.LOOSEPLAIN],"|").concat(i[s.XRANGEPLAIN],")"),!0),t.comparatorTrimReplace="$1$2$3",e("HYPHENRANGE","^\\s*(".concat(i[s.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(i[s.XRANGEPLAIN],")")+"\\s*$"),e("HYPHENRANGELOOSE","^\\s*(".concat(i[s.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(i[s.XRANGEPLAINLOOSE],")")+"\\s*$"),e("STAR","(<|>)?=?\\s*\\*"),e("GTE0","^\\s*>=\\s*0.0.0\\s*$"),e("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")}(re$3,re$3.exports);var numeric=/^[0-9]+$/,compareIdentifiers$1=(e,t)=>{var r=numeric.test(e),n=numeric.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n||(!n||r)&&e<t?-1:1},rcompareIdentifiers=(e,t)=>compareIdentifiers$1(t,e),identifiers={compareIdentifiers:compareIdentifiers$1,rcompareIdentifiers:rcompareIdentifiers},debug$2=debug_1,MAX_LENGTH=constants.MAX_LENGTH,MAX_SAFE_INTEGER=constants.MAX_SAFE_INTEGER,re$2=re$3.exports.re,t$2=re$3.exports.t,parseOptions$2=parseOptions_1,compareIdentifiers=identifiers.compareIdentifiers;class SemVer$3{constructor(e,t){if(t=parseOptions$2(t),e instanceof SemVer$3){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: ".concat(e));if(e.length>MAX_LENGTH)throw new TypeError("version is longer than ".concat(MAX_LENGTH," characters"));debug$2("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;t=e.trim().match(t.loose?re$2[t$2.LOOSE]:re$2[t$2.FULL]);if(!t)throw new TypeError("Invalid Version: ".concat(e));if(this.raw=e,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>MAX_SAFE_INTEGER||this.major<0)throw new TypeError("Invalid major version");if(this.minor>MAX_SAFE_INTEGER||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>MAX_SAFE_INTEGER||this.patch<0)throw new TypeError("Invalid patch version");t[4]?this.prerelease=t[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){var t=+e;if(0<=t&&t<MAX_SAFE_INTEGER)return t}return e}):this.prerelease=[],this.build=t[5]?t[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(e){if(debug$2("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer$3)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer$3(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer$3||(e=new SemVer$3(e,this.options)),compareIdentifiers(this.major,e.major)||compareIdentifiers(this.minor,e.minor)||compareIdentifiers(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer$3||(e=new SemVer$3(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],n=e.prerelease[t];if(debug$2("prerelease compare",t,r,n),void 0===r&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===r)return-1;if(r!==n)return compareIdentifiers(r,n)}while(++t)}compareBuild(e){e instanceof SemVer$3||(e=new SemVer$3(e,this.options));var t=0;do{var r=this.build[t],n=e.build[t];if(debug$2("prerelease compare",t,r,n),void 0===r&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===r)return-1;if(r!==n)return compareIdentifiers(r,n)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;0<=--r;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]!==t||isNaN(this.prerelease[1]))&&(this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: ".concat(e))}return this.format(),this.raw=this.version,this}}var semver=SemVer$3,SemVer$2=semver,compare$6=(e,t,r)=>new SemVer$2(e,r).compare(new SemVer$2(t,r)),compare_1=compare$6,compare$5=compare$6,eq$1=(e,t,r)=>0===compare$5(e,t,r),eq_1=eq$1,compare$4=compare$6,neq$1=(e,t,r)=>0!==compare$4(e,t,r),neq_1=neq$1,compare$3=compare$6,gt$1=(e,t,r)=>0<compare$3(e,t,r),gt_1=gt$1,compare$2=compare$6,gte$1=(e,t,r)=>0<=compare$2(e,t,r),gte_1=gte$1,compare$1=compare$6,lt$1=(e,t,r)=>compare$1(e,t,r)<0,lt_1=lt$1,compare=compare$6,lte$1=(e,t,r)=>compare(e,t,r)<=0,lte_1=lte$1,eq=eq$1,neq=neq$1,gt=gt$1,gte=gte$1,lt=lt$1,lte=lte$1,cmp$1=(e,t,r,n)=>{switch(t){case"===":return(e="object"==typeof e?e.version:e)===(r="object"==typeof r?r.version:r);case"!==":return(e="object"==typeof e?e.version:e)!==(r="object"==typeof r?r.version:r);case"":case"=":case"==":return eq(e,r,n);case"!=":return neq(e,r,n);case">":return gt(e,r,n);case">=":return gte(e,r,n);case"<":return lt(e,r,n);case"<=":return lte(e,r,n);default:throw new TypeError("Invalid operator: ".concat(t))}},cmp_1=cmp$1,ANY=Symbol("SemVer ANY");class Comparator$1{static get ANY(){return ANY}constructor(e,t){if(t=parseOptions$1(t),e instanceof Comparator$1){if(e.loose===!!t.loose)return e;e=e.value}debug$1("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===ANY?this.value="":this.value=this.operator+this.semver.version,debug$1("comp",this)}parse(e){var t=this.options.loose?re$1[t$1.COMPARATORLOOSE]:re$1[t$1.COMPARATOR],t=e.match(t);if(!t)throw new TypeError("Invalid comparator: ".concat(e));this.operator=void 0!==t[1]?t[1]:"","="===this.operator&&(this.operator=""),t[2]?this.semver=new SemVer$1(t[2],this.options.loose):this.semver=ANY}toString(){return this.value}test(e){if(debug$1("Comparator.test",e,this.options.loose),this.semver===ANY||e===ANY)return!0;if("string"==typeof e)try{e=new SemVer$1(e,this.options)}catch(e){return!1}return cmp(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Comparator$1))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new Range$2(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new Range$2(this.value,t).test(e.semver);var r=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),n=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),i=cmp(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),e=cmp(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return r||n||o&&a||i||e}}var comparator=Comparator$1,parseOptions$1=parseOptions_1,re$1=re$3.exports.re,t$1=re$3.exports.t,cmp=cmp_1,debug$1=debug_1,SemVer$1=semver,Range$2=range;function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(i)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}class Range$1{constructor(e,t){if(t=parseOptions(t),e instanceof Range$1)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Range$1(e.raw,t);if(e instanceof Comparator)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(e));if(1<this.set.length){e=this.set[0];if(this.set=this.set.filter(e=>!isNullSet(e[0])),0===this.set.length)this.set=[e];else if(1<this.set.length){var r,n=_createForOfIteratorHelper(this.set);try{for(n.s();!(r=n.n()).done;){var o=r.value;if(1===o.length&&isAny(o[0])){this.set=[o];break}}}catch(e){n.e(e)}finally{n.f()}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();var r=Object.keys(this.options).join(","),n="parseRange:".concat(r,":").concat(e),o=cache.get(n);if(o)return o;r=this.options.loose,o=r?re[t.HYPHENRANGELOOSE]:re[t.HYPHENRANGE];e=e.replace(o,hyphenReplace(this.options.includePrerelease)),debug("hyphen replace",e),e=e.replace(re[t.COMPARATORTRIM],comparatorTrimReplace),debug("comparator trim",e,re[t.COMPARATORTRIM]),e=(e=(e=e.replace(re[t.TILDETRIM],tildeTrimReplace)).replace(re[t.CARETTRIM],caretTrimReplace)).split(/\s+/).join(" ");var a=r?re[t.COMPARATORLOOSE]:re[t.COMPARATOR],e=e.split(" ").map(e=>parseComparator(e,this.options)).join(" ").split(/\s+/).map(e=>replaceGTE0(e,this.options)).filter(this.options.loose?e=>!!e.match(a):()=>!0).map(e=>new Comparator(e,this.options));e.length;var i,s=new Map,c=_createForOfIteratorHelper(e);try{for(c.s();!(i=c.n()).done;){var l=i.value;if(isNullSet(l))return[l];s.set(l.value,l)}}catch(e){c.e(e)}finally{c.f()}1<s.size&&s.has("")&&s.delete("");e=[...s.values()];return cache.set(n,e),e}intersects(e,r){if(!(e instanceof Range$1))throw new TypeError("a Range is required");return this.set.some(t=>isSatisfiable(t,r)&&e.set.some(e=>isSatisfiable(e,r)&&t.every(t=>e.every(e=>t.intersects(e,r)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new SemVer(e,this.options)}catch(e){return!1}for(var t=0;t<this.set.length;t++)if(testSet(this.set[t],e,this.options))return!0;return!1}}var range=Range$1,LRU=lruCache,cache=new lruCache({max:1e3}),parseOptions=parseOptions_1,Comparator=comparator,debug=debug_1,SemVer=semver,re=re$3.exports.re,t=re$3.exports.t,comparatorTrimReplace=re$3.exports.comparatorTrimReplace,tildeTrimReplace=re$3.exports.tildeTrimReplace,caretTrimReplace=re$3.exports.caretTrimReplace,isNullSet=e=>"<0.0.0-0"===e.value,isAny=e=>""===e.value,isSatisfiable=(e,t)=>{for(var r=!0,n=e.slice(),o=n.pop();r&&n.length;)r=n.every(e=>o.intersects(e,t)),o=n.pop();return r},parseComparator=(e,t)=>(debug("comp",e,t),e=replaceCarets(e,t),debug("caret",e),e=replaceTildes(e,t),debug("tildes",e),e=replaceXRanges(e,t),debug("xrange",e),e=replaceStars(e,t),debug("stars",e),e),isX=e=>!e||"x"===e.toLowerCase()||"*"===e,replaceTildes=(e,t)=>e.trim().split(/\s+/).map(e=>replaceTilde(e,t)).join(" "),replaceTilde=(a,e)=>{e=e.loose?re[t.TILDELOOSE]:re[t.TILDE];return a.replace(e,(e,t,r,n,o)=>{return debug("tilde",a,e,t,r,n,o),r=isX(t)?"":isX(r)?">=".concat(t,".0.0 <").concat(+t+1,".0.0-0"):isX(n)?">=".concat(t,".").concat(r,".0 <").concat(t,".").concat(+r+1,".0-0"):o?(debug("replaceTilde pr",o),">=".concat(t,".").concat(r,".").concat(n,"-").concat(o," <").concat(t,".").concat(+r+1,".0-0")):">=".concat(t,".").concat(r,".").concat(n," <").concat(t,".").concat(+r+1,".0-0"),debug("tilde return",r),r})},replaceCarets=(e,t)=>e.trim().split(/\s+/).map(e=>replaceCaret(e,t)).join(" "),replaceCaret=(a,e)=>{debug("caret",a,e);var r=e.loose?re[t.CARETLOOSE]:re[t.CARET],i=e.includePrerelease?"-0":"";return a.replace(r,(e,t,r,n,o)=>{return debug("caret",a,e,t,r,n,o),t=isX(t)?"":isX(r)?">=".concat(t,".0.0").concat(i," <").concat(+t+1,".0.0-0"):isX(n)?"0"===t?">=".concat(t,".").concat(r,".0").concat(i," <").concat(t,".").concat(+r+1,".0-0"):">=".concat(t,".").concat(r,".0").concat(i," <").concat(+t+1,".0.0-0"):o?(debug("replaceCaret pr",o),"0"===t?"0"===r?">=".concat(t,".").concat(r,".").concat(n,"-").concat(o," <").concat(t,".").concat(r,".").concat(+n+1,"-0"):">=".concat(t,".").concat(r,".").concat(n,"-").concat(o," <").concat(t,".").concat(+r+1,".0-0"):">=".concat(t,".").concat(r,".").concat(n,"-").concat(o," <").concat(+t+1,".0.0-0")):(debug("no pr"),"0"===t?"0"===r?">=".concat(t,".").concat(r,".").concat(n).concat(i," <").concat(t,".").concat(r,".").concat(+n+1,"-0"):">=".concat(t,".").concat(r,".").concat(n).concat(i," <").concat(t,".").concat(+r+1,".0-0"):">=".concat(t,".").concat(r,".").concat(n," <").concat(+t+1,".0.0-0")),debug("caret return",t),t})},replaceXRanges=(e,t)=>(debug("replaceXRanges",e,t),e.split(/\s+/).map(e=>replaceXRange(e,t)).join(" ")),replaceXRange=(l,p)=>{l=l.trim();var e=p.loose?re[t.XRANGELOOSE]:re[t.XRANGE];return l.replace(e,(e,t,r,n,o,a)=>{debug("xRange",l,e,t,r,n,o,a);var i=isX(r),s=i||isX(n),c=s||isX(o);return"="===t&&c&&(t=""),a=p.includePrerelease?"-0":"",i?e=">"===t||"<"===t?"<0.0.0-0":"*":t&&c?(s&&(n=0),o=0,">"===t?(t=">=",o=s?(r=+r+1,n=0):(n=+n+1,0)):"<="===t&&(t="<",s?r=+r+1:n=+n+1),"<"===t&&(a="-0"),e="".concat(t+r,".").concat(n,".").concat(o).concat(a)):s?e=">=".concat(r,".0.0").concat(a," <").concat(+r+1,".0.0-0"):c&&(e=">=".concat(r,".").concat(n,".0").concat(a," <").concat(r,".").concat(+n+1,".0-0")),debug("xRange return",e),e})},replaceStars=(e,r)=>(debug("replaceStars",e,r),e.trim().replace(re[t.STAR],"")),replaceGTE0=(e,r)=>(debug("replaceGTE0",e,r),e.trim().replace(re[r.includePrerelease?t.GTE0PRE:t.GTE0],"")),hyphenReplace=d=>(e,t,r,n,o,a,i,s,c,l,p,u,h)=>(t=isX(r)?"":isX(n)?">=".concat(r,".0.0").concat(d?"-0":""):isX(o)?">=".concat(r,".").concat(n,".0").concat(d?"-0":""):a?">=".concat(t):">=".concat(t).concat(d?"-0":""),s=isX(c)?"":isX(l)?"<".concat(+c+1,".0.0-0"):isX(p)?"<".concat(c,".").concat(+l+1,".0-0"):u?"<=".concat(c,".").concat(l,".").concat(p,"-").concat(u):d?"<".concat(c,".").concat(l,".").concat(+p+1,"-0"):"<=".concat(s),"".concat(t," ").concat(s).trim()),testSet=(e,t,r)=>{for(var n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(!t.prerelease.length||r.includePrerelease)return!0;for(var o=0;o<e.length;o++)if(debug(e[o].semver),e[o].semver!==Comparator.ANY&&0<e[o].semver.prerelease.length){var a=e[o].semver;if(a.major===t.major&&a.minor===t.minor&&a.patch===t.patch)return!0}return!1},Range=range,satisfies=(e,t,r)=>{try{t=new Range(t,r)}catch(e){return!1}return t.test(e)},satisfies_1=satisfies;function post(r,e,t){var n=r.open(e),o=new URL(e).origin,a=40;r.addEventListener("message",function e(t){t.source===n&&(a=0,r.removeEventListener("message",e,!1))},!1),setTimeout(function e(){a<=0||(n.postMessage(t,o),setTimeout(e,250),--a)},250)}var embedStyle='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n}\n.vega-embed.has-actions {\n  padding-right: 38px;\n}\n.vega-embed details:not([open]) > :not(summary) {\n  display: none !important;\n}\n.vega-embed summary {\n  list-style: none;\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 6px;\n  z-index: 1000;\n  background: white;\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n  color: #1b1e23;\n  border: 1px solid #aaa;\n  border-radius: 999px;\n  opacity: 0.2;\n  transition: opacity 0.4s ease-in;\n  cursor: pointer;\n  line-height: 0px;\n}\n.vega-embed summary::-webkit-details-marker {\n  display: none;\n}\n.vega-embed summary:active {\n  box-shadow: #aaa 0px 0px 0px 1px inset;\n}\n.vega-embed summary svg {\n  width: 14px;\n  height: 14px;\n}\n.vega-embed details[open] summary {\n  opacity: 0.7;\n}\n.vega-embed:hover summary, .vega-embed:focus-within summary {\n  opacity: 1 !important;\n  transition: opacity 0.2s ease;\n}\n.vega-embed .vega-actions {\n  position: absolute;\n  z-index: 1001;\n  top: 35px;\n  right: -9px;\n  display: flex;\n  flex-direction: column;\n  padding-bottom: 8px;\n  padding-top: 8px;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n  border: 1px solid #d9d9d9;\n  background: white;\n  animation-duration: 0.15s;\n  animation-name: scale-in;\n  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n  text-align: left;\n}\n.vega-embed .vega-actions a {\n  padding: 8px 16px;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 600;\n  white-space: nowrap;\n  color: #434a56;\n  text-decoration: none;\n}\n.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {\n  background-color: #f7f7f9;\n  color: black;\n}\n.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n  content: "";\n  display: inline-block;\n  position: absolute;\n}\n.vega-embed .vega-actions::before {\n  left: auto;\n  right: 14px;\n  top: -16px;\n  border: 8px solid #0000;\n  border-bottom-color: #d9d9d9;\n}\n.vega-embed .vega-actions::after {\n  left: auto;\n  right: 15px;\n  top: -14px;\n  border: 7px solid #0000;\n  border-bottom-color: #fff;\n}\n.vega-embed .chart-wrapper.fit-x {\n  width: 100%;\n}\n.vega-embed .chart-wrapper.fit-y {\n  height: 100%;\n}\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px;\n}\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n';function mergeDeep(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var o=0,a=r;o<a.length;o++)deepMerge_(e,a[o]);return e}function deepMerge_(e,t){for(var r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];writeConfig(e,o,t[o],!0)}}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});var _w$vl,name="vega-embed",version$1="6.20.9--canary.871.0984bc2.0",description="Publish Vega visualizations as embedded web components.",keywords=["vega","data","visualization","component","embed"],repository={type:"git",url:"http://github.com/vega/vega-embed.git"},author={name:"UW Interactive Data Lab",url:"http://idl.cs.washington.edu"},contributors=[{name:"Dominik Moritz",url:"https://www.domoritz.de"}],bugs={url:"https://github.com/vega/vega-embed/issues"},homepage="https://github.com/vega/vega-embed#readme",license="BSD-3-Clause",main="build/vega-embed.js",module="build/vega-embed.module.js",unpkg="build/vega-embed.min.js",jsdelivr="build/vega-embed.min.js",types="build/vega-embed.module.d.ts",files=["src","build","build-es5","patches"],devDependencies={"@auto-it/conventional-commits":"^10.32.6","@auto-it/first-time-contributor":"^10.32.6","@babel/plugin-transform-runtime":"^7.17.0","@rollup/plugin-commonjs":"21.0.2","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^13.1.3","@types/semver":"^7.3.9",auto:"^10.32.6","browser-sync":"^2.27.7",concurrently:"^7.0.0","del-cli":"^4.0.1","jest-canvas-mock":"^2.3.1","patch-package":"^6.4.7","postinstall-postinstall":"^2.1.0",rollup:"2.69.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2","rollup-plugin-ts":"^2.0.5",sass:"^1.49.9",typescript:"^4.6.2",vega:"^5.21.0","vega-lite":"^5.0.0","vega-lite-dev-config":"^0.20.0"},peerDependencies={vega:"^5.21.0","vega-lite":"*"},dependencies={"fast-json-patch":"^3.1.0","json-stringify-pretty-compact":"^3.0.0",semver:"^7.3.5",tslib:"^2.3.1","vega-interpreter":"^1.0.4","vega-schema-url-parser":"^2.2.0","vega-themes":"^2.10.0","vega-tooltip":"^0.28.0"},bundledDependencies=["yallist"],scripts={prebuild:"yarn clean && yarn build:style",build:"rollup -c","build:style":"./build-style.sh",clean:"del-cli build build-es5 src/style.ts",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint && yarn test",serve:"browser-sync start --directory -s -f build *.html",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",pretest:"yarn build:style",test:"beemo jest --stdio stream","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand",prepare:"beemo create-config && npx patch-package",prettierbase:"beemo prettier '*.{css,scss,html}'",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",release:"yarn build && auto shipit"},pkg={name:name,version:version$1,description:description,keywords:keywords,repository:repository,author:author,contributors:contributors,bugs:bugs,homepage:homepage,license:license,main:main,module:module,unpkg:unpkg,jsdelivr:jsdelivr,types:types,files:files,devDependencies:devDependencies,peerDependencies:peerDependencies,dependencies:dependencies,bundledDependencies:bundledDependencies,scripts:scripts};function ownKeys(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var version=pkg.version,vega=vegaImport,_vegaLite=vegaLiteImport,w="undefined"!=typeof window?window:void 0;void 0===_vegaLite&&null!=w&&null!==(_w$vl=w.vl)&&void 0!==_w$vl&&_w$vl.compile&&(_vegaLite=w.vl);var DEFAULT_ACTIONS={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},I18N={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},NAMES={vega:"Vega","vega-lite":"Vega-Lite"},VERSION={vega:vega.version,"vega-lite":_vegaLite?_vegaLite.version:"not available"},PREPROCESSOR={vega:e=>e,"vega-lite":(e,t)=>_vegaLite.compile(e,{config:t}).spec},SVG_CIRCLES='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',CHART_WRAPPER_CLASS="chart-wrapper";function isTooltipHandler(e){return"function"==typeof e}function viewSource(e,t,r,n){var o="<html><head>".concat(t,'</head><body><pre><code class="json">'),t="</code></pre>".concat(r,"</body></html>"),r=window.open("");r.document.write(o+e+t),r.document.title="".concat(NAMES[n]," JSON Source")}function guessMode(e,t){if(e.$schema){var r=schemaParser(e.$schema);t&&t!==r.library&&console.warn("The given visualization spec is written in ".concat(NAMES[r.library],", but mode argument sets ").concat(null!==(n=NAMES[t])&&void 0!==n?n:t,"."));var n=r.library;return satisfies_1(VERSION[n],"^".concat(r.version.slice(1)))||console.warn("The input spec uses ".concat(NAMES[n]," ").concat(r.version,", but the current version of ").concat(NAMES[n]," is v").concat(VERSION[n],".")),n}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":!("marks"in e||"signals"in e||"scales"in e||"axes"in e)&&null!=t?t:"vega"}function isLoader(e){return!!(e&&"load"in e)}function createLoader(e){return isLoader(e)?e:vega.loader(e)}function embedOptionsFromUsermeta(e){e=null!==(e=null===(e=e.usermeta)||void 0===e?void 0:e.embedOptions)&&void 0!==e?e:{};return isString(e.defaultStyle)&&(e.defaultStyle=!1),e}function embed(e,t){return _embed2.apply(this,arguments)}function _embed2(){return(_embed2=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,r){var n,o,a,i,s,c,l,p=arguments;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=2<p.length&&void 0!==p[2]?p[2]:{},isString(r))return a=createLoader(n.loader),e.t0=JSON,e.next=6,a.load(r);e.next=10;break;case 6:e.t1=e.sent,o=e.t0.parse.call(e.t0,e.t1),e.next=11;break;case 10:o=r;case 11:return l=embedOptionsFromUsermeta(o),i=l.loader,a&&!i||(a=createLoader(null!==(s=n.loader)&&void 0!==s?s:i)),e.next=16,loadOpts(l,a);case 16:return c=e.sent,e.next=19,loadOpts(n,a);case 19:return l=e.sent,l=_objectSpread(_objectSpread({},mergeDeep(l,c)),{},{config:mergeConfig(null!==(l=l.config)&&void 0!==l?l:{},null!==(l=c.config)&&void 0!==l?l:{})}),e.next=23,_embed(t,o,l,a);case 23:return e.abrupt("return",e.sent);case 24:case"end":return e.stop()}},e)}))).apply(this,arguments)}function loadOpts(e,t){return _loadOpts.apply(this,arguments)}function _loadOpts(){return(_loadOpts=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,r){var n,o;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(isString(t.config))return e.t1=JSON,e.next=4,r.load(t.config);e.next=8;break;case 4:e.t2=e.sent,e.t0=e.t1.parse.call(e.t1,e.t2),e.next=9;break;case 8:e.t0=null!==(o=t.config)&&void 0!==o?o:{};case 9:if(n=e.t0,isString(t.patch))return e.t4=JSON,e.next=14,r.load(t.patch);e.next=18;break;case 14:e.t5=e.sent,e.t3=e.t4.parse.call(e.t4,e.t5),e.next=19;break;case 18:e.t3=t.patch;case 19:return o=e.t3,e.abrupt("return",_objectSpread(_objectSpread(_objectSpread({},t),o?{patch:o}:{}),n?{config:n}:{}));case 21:case"end":return e.stop()}},e)}))).apply(this,arguments)}function getRoot(e){var e=e.getRootNode?e.getRootNode():document;return e instanceof ShadowRoot?{root:e,rootContainer:e}:{root:document,rootContainer:null!==(e=document.head)&&void 0!==e?e:document.body}}function _embed(e,t){return _embed3.apply(this,arguments)}function _embed3(){return(_embed3=_asyncToGenerator(_regeneratorRuntime.mark(function e(t,r){var o,n,a,i,s,c,l,p,u,h,d,m,v,f,g,E,y,S,b,L,I,A,R,O,T,N,w,_,x,$,C=arguments;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if($=function(){L&&document.removeEventListener("click",L),S.finalize()},o=2<C.length&&void 0!==C[2]?C[2]:{},n=3<C.length?C[3]:void 0,a=o.theme?mergeConfig(themes[o.theme],null!==(m=o.config)&&void 0!==m?m:{}):o.config,i=isBoolean(o.actions)?o.actions:mergeDeep({},DEFAULT_ACTIONS,null!==(u=o.actions)&&void 0!==u?u:{}),s=_objectSpread(_objectSpread({},I18N),o.i18n),c=null!==(h=o.renderer)&&void 0!==h?h:"canvas",l=null!==(d=o.logLevel)&&void 0!==d?d:vega.Warn,p=null!==(m=o.downloadFileName)&&void 0!==m?m:"visualization",u="string"==typeof t?document.querySelector(t):t){e.next=12;break}throw new Error("".concat(t," does not exist"));case 12:return!1!==o.defaultStyle&&(h="vega-embed-style",d=getRoot(u),m=d.root,d=d.rootContainer,m.getElementById(h)||((m=document.createElement("style")).id=h,m.innerHTML=void 0===o.defaultStyle||!0===o.defaultStyle?embedStyle.toString():o.defaultStyle,d.appendChild(m))),v=guessMode(r,o.mode),f=PREPROCESSOR[v](r,a),"vega-lite"===v&&f.$schema&&(y=schemaParser(f.$schema),satisfies_1(VERSION.vega,"^".concat(y.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(y.version,", but current version is v").concat(VERSION.vega,"."))),u.classList.add("vega-embed"),i&&u.classList.add("has-actions"),u.innerHTML="",g=u,i&&((E=document.createElement("div")).classList.add(CHART_WRAPPER_CLASS),u.appendChild(E),g=E),(y=o.patch)&&(f=y instanceof Function?y(f):applyPatch(f,y,!0,!1).newDocument),o.formatLocale&&vega.formatLocale(o.formatLocale),o.timeFormatLocale&&vega.timeFormatLocale(o.timeFormatLocale),E=o.ast,y=vega.parse(f,"vega-lite"===v?{}:a,{ast:E}),(S=new(o.viewClass||vega.View)(y,_objectSpread({loader:n,logLevel:l,renderer:c},E?{expr:null!==(E=null!==(E=vega.expressionInterpreter)&&void 0!==E?E:o.expr)&&void 0!==E?E:expressionInterpreter}:{}))).addSignalListener("autosize",(e,t)=>{t=t.type;"fit-x"==t?(g.classList.add("fit-x"),g.classList.remove("fit-y")):"fit-y"==t?(g.classList.remove("fit-x"),g.classList.add("fit-y")):"fit"==t?g.classList.add("fit-x","fit-y"):g.classList.remove("fit-x","fit-y")}),!1!==o.tooltip&&(b=isTooltipHandler(o.tooltip)?o.tooltip:new Handler(!0===o.tooltip?{}:o.tooltip).call,S.tooltip(b)),(b=void 0===(b=o.hover)?"vega"===v:b)&&(w=(A="boolean"==typeof b?{}:b).hoverSet,A=A.updateSet,S.hover(w,A)),o&&(null!=o.width&&S.width(o.width),null!=o.height&&S.height(o.height),null!=o.padding&&S.padding(o.padding)),e.next=36,S.initialize(g,o.bind).runAsync();case 36:if(!1!==i){if(w=u,!1!==o.defaultStyle&&((I=document.createElement("details")).title=s.CLICK_TO_VIEW_ACTIONS,u.append(I),w=I,(A=document.createElement("summary")).innerHTML=SVG_CIRCLES,I.append(A),L=e=>{I.contains(e.target)||I.removeAttribute("open")},document.addEventListener("click",L)),R=document.createElement("div"),w.append(R),R.classList.add("vega-actions"),!0===i||!1!==i.export)for(O=function(){var e,t,n=N[T];!0!==i&&!0!==i.export&&!i.export[n]||(e=s["".concat(n.toUpperCase(),"_ACTION")],(t=document.createElement("a")).text=e,t.href="#",t.target="_blank",t.download="".concat(p,".").concat(n),t.addEventListener("mousedown",function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function e(t){var r;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,S.toImageURL(n,o.scaleFactor);case 3:r=e.sent,this.href=r;case 5:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}()),R.append(t))},T=0,N=["svg","png"];T<N.length;T++)O();!0!==i&&!1===i.source||((w=document.createElement("a")).text=s.SOURCE_ACTION,w.href="#",w.addEventListener("click",function(e){var t;viewSource(stringify(r),null!==(t=o.sourceHeader)&&void 0!==t?t:"",null!==(t=o.sourceFooter)&&void 0!==t?t:"",v),e.preventDefault()}),R.append(w)),"vega-lite"!==v||!0!==i&&!1===i.compiled||((x=document.createElement("a")).text=s.COMPILED_ACTION,x.href="#",x.addEventListener("click",function(e){var t;viewSource(stringify(f),null!==(t=o.sourceHeader)&&void 0!==t?t:"",null!==(t=o.sourceFooter)&&void 0!==t?t:"","vega"),e.preventDefault()}),R.append(x)),!0!==i&&!1===i.editor||(_=null!==(x=o.editorUrl)&&void 0!==x?x:"https://vega.github.io/editor/",(x=document.createElement("a")).text=s.EDITOR_ACTION,x.href="#",x.addEventListener("click",function(e){post(window,_,{config:a,mode:v,renderer:c,spec:stringify(r)}),e.preventDefault()}),R.append(x))}return e.abrupt("return",{view:S,spec:r,vgSpec:f,finalize:$,embedOptions:o});case 38:case"end":return e.stop()}},e)}))).apply(this,arguments)}export{DEFAULT_ACTIONS,embed as default,guessMode,vega,_vegaLite as vegaLite,version};
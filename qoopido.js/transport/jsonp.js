/*! Qoopido.js library 3.7.4, 2015-08-14 | https://github.com/dlueth/qoopido.js | (c) 2015 Dirk Lueth */
!function(t,e){e.qoopido.registerSingleton("transport/jsonp",t,["../transport","../function/merge","../function/unique/uuid","../url","../dom/element","../promise/defer"])}(function(t,e,i,n){"use strict";function o(t,e){var n=this,o=n.dfd,l=n.script,u=n.settings;e="object"==typeof e?n.serialize(e):e,t="".concat(t,t.indexOf("?")>-1?"&":"?","".concat(u.callback,"=",n.id)),t=u.cache===!1?"".concat(t,t.indexOf("?")>-1?"&":"?","".concat("_=",(new Date).getTime().toString())):t,t=e?"".concat(t,t.indexOf("?")>-1?"&":"?",e):t,i[n.id]=function(t){try{delete i[n.id]}catch(e){i[n.id]=null}a.call(n),o.resolve(t)},l.on("load readystatechange",function(t){c.call(n,t)}).one("error",function(){r.call(n)}).setAttribute("src",t),f.appendChild(l.element),n.timeout=setTimeout(function(){s.call(n)},u.timeout)}function c(t){var e=this,i=e.dfd;t.readyState&&"loaded"!==t.readyState&&"complete"!==t.readyState||e.script.off()&&e.script.element.dispose&&e.script.element.dispose(),e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(function(){s.call(e)},e.settings.timeout),i.notify(t)}function r(){var t=this;a.call(t),t.dfd.reject()}function s(){var t=this;a.call(t),t.dfd.reject(!1)}function a(){var t=this;t.timeout&&clearTimeout(t.timeout),t.script.off()&&t.script.element.dispose&&t.script.element.dispose()}var l,u=i.document,d=t["promise/defer"],m=e.pool&&e.pool.dom,f=u.getElementsByTagName("head")[0];return l=t.transport.extend({_settings:{callback:"callback",cache:!1,timeout:5e3},load:function(e,i,n){var c={};return e=t.url.resolve(e),c.id="".concat("jsonp-",t["function/unique/string"]()),c.dfd=new d,c.script=t["dom/element"].create(m?m.obtain("script"):u.createElement("script")),c.settings=t["function/merge"]({},this._settings,n),c.timeout=null,c.script.setAttribute("async",!0),o.call(c,e,i),c.dfd.promise}})},this);
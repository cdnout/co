"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=TimeAgo;var React=_interopRequireWildcard(require("react")),_defaultFormatter=_interopRequireDefault(require("./defaultFormatter")),_dateParser=_interopRequireDefault(require("./dateParser"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!==_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache();if(t&&t.has(e))return t.get(e);var r,o={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e){Object.prototype.hasOwnProperty.call(e,a)&&((r=n?Object.getOwnPropertyDescriptor(e,a):null)&&(r.get||r.set)?Object.defineProperty(o,a,r):o[a]=e[a])}return o.default=e,t&&t.set(e,o),o}function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e}).apply(this,arguments)}function ownKeys(t,e){var r,o=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,r)),o}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],o=!0,n=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(o=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(e){n=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(n)throw a}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _objectWithoutProperties(e,t){if(null==e)return{};var r,o=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols)for(var n=Object.getOwnPropertySymbols(e),a=0;a<n.length;a++)r=n[a],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r]);return o}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};for(var r,o={},n=Object.keys(e),a=0;a<n.length;a++)r=n[a],0<=t.indexOf(r)||(o[r]=e[r]);return o}var Component=React.Component,MINUTE=60,HOUR=60*MINUTE,DAY=24*HOUR,WEEK=7*DAY,MONTH=30*DAY,YEAR=365*DAY;function TimeAgo(e){var c=e.date,t=e.formatter,r=void 0===t?_defaultFormatter.default:t,o=e.component,n=void 0===o?"time":o,a=e.live,i=void 0===a||a,u=e.minPeriod,l=void 0===u?0:u,f=e.maxPeriod,d=void 0===f?1/0:f,y=e.title,p=e.now,s=void 0===p?function(){return Date.now()}:p,b=_objectWithoutProperties(e,["date","formatter","component","live","minPeriod","maxPeriod","title","now"]),m=_slicedToArray((0,React.useState)(0),2),O=(m[0],m[1]);(0,React.useEffect)(function(){if(i){var u;return function e(t){var r,o,n,a,i=(0,_dateParser.default)(c).valueOf();i?(r=s(),n=(o=Math.round(Math.abs(r-i)/1e3))<MINUTE?1e3:o<HOUR?1e3*MINUTE:o<DAY?1e3*HOUR:0,(a=Math.min(Math.max(n,1e3*l),1e3*d))&&(u&&clearTimeout(u),u=setTimeout(e,a)),t||O(function(e){return e+1})):console.warn("[react-timeago] Invalid Date provided")}(!0),function(){clearTimeout(u)}}},[]);var _=n,h=(0,_dateParser.default)(c).valueOf();if(!h)return null;var v=s(),j=Math.round(Math.abs(v-h)/1e3),g=h<v?"ago":"from now",P=_slicedToArray(j<MINUTE?[Math.round(j),"second"]:j<HOUR?[Math.round(j/MINUTE),"minute"]:j<DAY?[Math.round(j/HOUR),"hour"]:j<WEEK?[Math.round(j/DAY),"day"]:j<MONTH?[Math.round(j/WEEK),"week"]:j<YEAR?[Math.round(j/MONTH),"month"]:[Math.round(j/YEAR),"year"],2),A=P[0],M=P[1],w=void 0===y?"string"==typeof c?c:(0,_dateParser.default)(c).toISOString().substr(0,16).replace("T"," "):y,T="time"===_?_objectSpread(_objectSpread({},b),{},{dateTime:(0,_dateParser.default)(c).toISOString()}):b,R=_defaultFormatter.default.bind(null,A,M,g);return React.createElement(_,_extends({},T,{title:w}),r(A,M,g,h,R,s))}
var __extends=this&&this.__extends||function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(t,i)};return function(t,i){function e(){this.constructor=t}n(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}}();import TileState from"./TileState.js";import{easeIn}from"./easing.js";import EventTarget from"./events/Target.js";import EventType from"./events/EventType.js";import{abstract}from"./util.js";var Tile=function(r){function t(t,i,e){var n=r.call(this)||this,e=e||{};return n.tileCoord=t,n.state=i,n.interimTile=null,n.hifi=!0,n.key="",n.transition_=void 0===e.transition?250:e.transition,n.transitionStarts_={},n}return __extends(t,r),t.prototype.changed=function(){this.dispatchEvent(EventType.CHANGE)},t.prototype.getKey=function(){return this.key+"/"+this.tileCoord},t.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==TileState.LOADED)return this.transition_=0,t}while(t=t.interimTile);return this},t.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,i=this;do{if(t.getState()==TileState.LOADED){t.interimTile=null;break}}while(t.getState()!=TileState.LOADING&&t.getState()==TileState.IDLE?i.interimTile=t.interimTile:i=t,t=i.interimTile)}},t.prototype.getTileCoord=function(){return this.tileCoord},t.prototype.getState=function(){return this.state},t.prototype.setState=function(t){this.state=t,this.changed()},t.prototype.load=function(){abstract()},t.prototype.getAlpha=function(t,i){if(!this.transition_)return 1;var e=this.transitionStarts_[t];if(e){if(-1===e)return 1}else this.transitionStarts_[t]=e=i;t=i-e+1e3/60;return t>=this.transition_?1:easeIn(t/this.transition_)},t.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},t.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},t}(EventTarget);export default Tile;
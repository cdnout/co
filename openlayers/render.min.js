import{DEVICE_PIXEL_RATIO}from"./has.js";import{apply as applyTransform,create as createTransform,multiply as multiplyTransform,scale as scaleTransform}from"./transform.js";import CanvasImmediateRenderer from"./render/canvas/Immediate.js";function toContext(e,r){var t=e.canvas,r=r||{},a=r.pixelRatio||DEVICE_PIXEL_RATIO,r=r.size,r=(r&&(t.width=r[0]*a,t.height=r[1]*a,t.style.width=r[0]+"px",t.style.height=r[1]+"px"),[0,0,t.width,t.height]),t=scaleTransform(createTransform(),a,a);return new CanvasImmediateRenderer(e,a,r,t,0)}function getVectorContext(e){var r=e.frameState,t=multiplyTransform(e.inversePixelTransform.slice(),r.coordinateToPixelTransform);return new CanvasImmediateRenderer(e.context,r.pixelRatio,r.extent,t,r.viewState.rotation)}function getRenderPixel(e,r){r=r.slice(0);return applyTransform(e.inversePixelTransform.slice(),r),r}function renderDeclutterItems(e,r){r&&r.clear();for(var t=e.declutterItems,a=t.length-1;0<=a;--a)for(var n=t[a],o=n.items,i=0,s=o.length;i<s;i+=3)r=o[i].renderDeclutter(o[i+1],o[i+2],n.opacity,r);return t.length=0,r}export{toContext,getVectorContext,getRenderPixel,renderDeclutterItems};
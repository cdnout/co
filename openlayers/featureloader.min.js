import{VOID}from"./functions.js";import FormatType from"./format/FormatType.js";var withCredentials=!1;function loadFeaturesXhr(t,s,i,p){return function(n,e,a){var o=new XMLHttpRequest;o.open("GET","function"==typeof t?t(n,e,a):t,!0),s.getType()==FormatType.ARRAY_BUFFER&&(o.responseType="arraybuffer"),o.withCredentials=withCredentials,o.onload=function(e){var t,r;!o.status||200<=o.status&&o.status<300?(r=void 0,(t=s.getType())==FormatType.JSON||t==FormatType.TEXT?r=o.responseText:t==FormatType.XML?r=(r=o.responseXML)||(new DOMParser).parseFromString(o.responseText,"application/xml"):t==FormatType.ARRAY_BUFFER&&(r=o.response),r?i.call(this,s.readFeatures(r,{extent:n,featureProjection:a}),s.readProjection(r)):p.call(this)):p.call(this)}.bind(this),o.onerror=function(){p.call(this)}.bind(this),o.send()}}function xhr(e,t){return loadFeaturesXhr(e,t,function(e,t){"function"==typeof this.addFeatures&&this.addFeatures(e)},VOID)}function setWithCredentials(e){withCredentials=e}export{loadFeaturesXhr,xhr,setWithCredentials};
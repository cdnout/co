var __extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)};return function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();import{abstract}from"../util.js";import{createOrUpdateFromFlatCoordinates,getCenter}from"../extent.js";import Geometry from"./Geometry.js";import GeometryLayout from"./GeometryLayout.js";import{rotate,scale,translate,transform2D}from"./flat/transform.js";import{clear}from"../obj.js";var SimpleGeometry=function(e){function t(){var t=e.call(this)||this;return t.layout=GeometryLayout.XY,t.stride=2,t.flatCoordinates=null,t}return __extends(t,e),t.prototype.computeExtent=function(t){return createOrUpdateFromFlatCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},t.prototype.getCoordinates=function(){return abstract()},t.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},t.prototype.getFlatCoordinates=function(){return this.flatCoordinates},t.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},t.prototype.getLayout=function(){return this.layout},t.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&(clear(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e,o=t.toString();return this.simplifiedGeometryCache.hasOwnProperty(o)?this.simplifiedGeometryCache[o]:(e=this.getSimplifiedGeometryInternal(t)).getFlatCoordinates().length<this.flatCoordinates.length?this.simplifiedGeometryCache[o]=e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},t.prototype.getSimplifiedGeometryInternal=function(t){return this},t.prototype.getStride=function(){return this.stride},t.prototype.setFlatCoordinates=function(t,e){this.stride=getStrideForLayout(t),this.layout=t,this.flatCoordinates=e},t.prototype.setCoordinates=function(t,e){abstract()},t.prototype.setLayout=function(t,e,o){var r;if(t)r=getStrideForLayout(t);else{for(var i=0;i<o;++i){if(0===e.length)return this.layout=GeometryLayout.XY,void(this.stride=2);e=e[0]}t=getLayoutForStride(r=e.length)}this.layout=t,this.stride=r},t.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},t.prototype.rotate=function(t,e){var o,r=this.getFlatCoordinates();r&&(o=this.getStride(),rotate(r,0,r.length,o,t,e,r),this.changed())},t.prototype.scale=function(t,e,o){var r=e;void 0===e&&(r=t);var i,e=(e=o)||getCenter(this.getExtent()),o=this.getFlatCoordinates();o&&(i=this.getStride(),scale(o,0,o.length,i,t,r,e,o),this.changed())},t.prototype.translate=function(t,e){var o,r=this.getFlatCoordinates();r&&(o=this.getStride(),translate(r,0,r.length,o,t,e,r),this.changed())},t}(Geometry);function getLayoutForStride(t){var e;return 2==t?e=GeometryLayout.XY:3==t?e=GeometryLayout.XYZ:4==t&&(e=GeometryLayout.XYZM),e}function getStrideForLayout(t){var e;return t==GeometryLayout.XY?e=2:t==GeometryLayout.XYZ||t==GeometryLayout.XYM?e=3:t==GeometryLayout.XYZM&&(e=4),e}function transformGeom2D(t,e,o){var r=t.getFlatCoordinates();return r?(t=t.getStride(),transform2D(r,0,r.length,t,e,o)):null}export default SimpleGeometry;export{getStrideForLayout,transformGeom2D};
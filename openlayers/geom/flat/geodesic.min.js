import{squaredSegmentDistance,toRadians,toDegrees}from"../../math.js";import{get as getProjection,getTransform}from"../../proj.js";function line(t,n,a){for(var r,e,o,i,s,c,p,h=[],u=t(0),g=t(1),f=n(u),M=[g,u],l=[n(g),f],m=[1,0],d={},R=1e5;0<--R&&0<m.length;)i=m.pop(),u=M.pop(),f=l.pop(),(p=i.toString())in d||(h.push(f[0],f[1]),d[p]=!0),s=m.pop(),g=M.pop(),r=l.pop(),o=n(e=t(c=(i+s)/2)),squaredSegmentDistance(o[0],o[1],f[0],f[1],r[0],r[1])<a?(h.push(r[0],r[1]),d[p=s.toString()]=!0):(m.push(s,c,c,i),l.push(r,o,o,f),M.push(g,e,e,u));return h}function greatCircleArc(e,t,o,i,n,a){var r=getProjection("EPSG:4326"),s=Math.cos(toRadians(t)),c=Math.sin(toRadians(t)),p=Math.cos(toRadians(i)),h=Math.sin(toRadians(i)),u=Math.cos(toRadians(o-e)),g=Math.sin(toRadians(o-e)),f=c*h+s*p*u;return line(function(t){if(1<=f)return[o,i];var t=t*Math.acos(f),n=Math.cos(t),t=Math.sin(t),a=Math.atan2(g*p,s*h-c*p*u),r=Math.asin(c*n+s*t*Math.cos(a)),a=toRadians(e)+Math.atan2(Math.sin(a)*t*s,n-c*Math.sin(r));return[toDegrees(a),toDegrees(r)]},getTransform(r,n),a)}function meridian(n,a,r,t,e){var o=getProjection("EPSG:4326");return line(function(t){return[n,a+(r-a)*t]},getTransform(o,t),e)}function parallel(n,a,r,t,e){var o=getProjection("EPSG:4326");return line(function(t){return[a+(r-a)*t,n]},getTransform(o,t),e)}export{greatCircleArc,meridian,parallel};
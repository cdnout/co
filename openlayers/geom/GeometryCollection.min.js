var __extends=this&&this.__extends||function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();import{listen,unlistenByKey}from"../events.js";import EventType from"../events/EventType.js";import{createOrUpdateEmpty,closestSquaredDistanceXY,extend,getCenter}from"../extent.js";import Geometry from"./Geometry.js";import GeometryType from"./GeometryType.js";import{clear}from"../obj.js";var GeometryCollection=function(r){function m(e){var t=r.call(this)||this;return t.geometries_=e||null,t.changeEventsKeys_=[],t.listenGeometriesChange_(),t}return __extends(m,r),m.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(unlistenByKey),this.changeEventsKeys_.length=0},m.prototype.listenGeometriesChange_=function(){if(this.geometries_)for(var e=0,t=this.geometries_.length;e<t;++e)this.changeEventsKeys_.push(listen(this.geometries_[e],EventType.CHANGE,this.changed,this))},m.prototype.clone=function(){var e=new m(null);return e.setGeometries(this.geometries_),e},m.prototype.closestPointXY=function(e,t,r,i){if(i<closestSquaredDistanceXY(this.getExtent(),e,t))return i;for(var o=this.geometries_,n=0,s=o.length;n<s;++n)i=o[n].closestPointXY(e,t,r,i);return i},m.prototype.containsXY=function(e,t){for(var r=this.geometries_,i=0,o=r.length;i<o;++i)if(r[i].containsXY(e,t))return!0;return!1},m.prototype.computeExtent=function(e){createOrUpdateEmpty(e);for(var t=this.geometries_,r=0,i=t.length;r<i;++r)extend(e,t[r].getExtent());return e},m.prototype.getGeometries=function(){return cloneGeometries(this.geometries_)},m.prototype.getGeometriesArray=function(){return this.geometries_},m.prototype.getSimplifiedGeometry=function(e){if(this.simplifiedGeometryRevision!=this.getRevision()&&(clear(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;var t=e.toString();if(this.simplifiedGeometryCache.hasOwnProperty(t))return this.simplifiedGeometryCache[t];for(var r,i=[],o=this.geometries_,n=!1,s=0,h=o.length;s<h;++s){var p=o[s],a=p.getSimplifiedGeometry(e);i.push(a),a!==p&&(n=!0)}return n?((r=new m(null)).setGeometriesArray(i),this.simplifiedGeometryCache[t]=r):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)},m.prototype.getType=function(){return GeometryType.GEOMETRY_COLLECTION},m.prototype.intersectsExtent=function(e){for(var t=this.geometries_,r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1},m.prototype.isEmpty=function(){return 0===this.geometries_.length},m.prototype.rotate=function(e,t){for(var r=this.geometries_,i=0,o=r.length;i<o;++i)r[i].rotate(e,t);this.changed()},m.prototype.scale=function(e,t,r){for(var i=(i=r)||getCenter(this.getExtent()),o=this.geometries_,n=0,s=o.length;n<s;++n)o[n].scale(e,t,i);this.changed()},m.prototype.setGeometries=function(e){this.setGeometriesArray(cloneGeometries(e))},m.prototype.setGeometriesArray=function(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()},m.prototype.applyTransform=function(e){for(var t=this.geometries_,r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()},m.prototype.translate=function(e,t){for(var r=this.geometries_,i=0,o=r.length;i<o;++i)r[i].translate(e,t);this.changed()},m.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),r.prototype.disposeInternal.call(this)},m}(Geometry);function cloneGeometries(e){for(var t=[],r=0,i=e.length;r<i;++r)t.push(e[r].clone());return t}export default GeometryCollection;
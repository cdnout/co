var __extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();import AssertionError from"./AssertionError.js";import CollectionEventType from"./CollectionEventType.js";import BaseObject from"./Object.js";import Event from"./events/Event.js";var Property={LENGTH:"length"},CollectionEvent=function(n){function t(t,e,r){t=n.call(this,t)||this;return t.element=e,t.index=r,t}return __extends(t,n),t}(Event),Collection=function(i){function t(t,e){var r=i.call(this)||this;if(r.unique_=!!(e||{}).unique,r.array_=t||[],r.unique_)for(var n=0,o=r.array_.length;n<o;++n)r.assertUnique_(r.array_[n],n);return r.updateLength_(),r}return __extends(t,i),t.prototype.clear=function(){for(;0<this.getLength();)this.pop()},t.prototype.extend=function(t){for(var e=0,r=t.length;e<r;++e)this.push(t[e]);return this},t.prototype.forEach=function(t){for(var e=this.array_,r=0,n=e.length;r<n;++r)t(e[r],r,e)},t.prototype.getArray=function(){return this.array_},t.prototype.item=function(t){return this.array_[t]},t.prototype.getLength=function(){return this.get(Property.LENGTH)},t.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new CollectionEvent(CollectionEventType.ADD,e,t))},t.prototype.pop=function(){return this.removeAt(this.getLength()-1)},t.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},t.prototype.remove=function(t){for(var e=this.array_,r=0,n=e.length;r<n;++r)if(e[r]===t)return this.removeAt(r)},t.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new CollectionEvent(CollectionEventType.REMOVE,e,t)),e},t.prototype.setAt=function(t,e){var r=this.getLength();if(t<r){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new CollectionEvent(CollectionEventType.REMOVE,n,t)),this.dispatchEvent(new CollectionEvent(CollectionEventType.ADD,e,t))}else{for(var o=r;o<t;++o)this.insertAt(o,void 0);this.insertAt(t,e)}},t.prototype.updateLength_=function(){this.set(Property.LENGTH,this.array_.length)},t.prototype.assertUnique_=function(t,e){for(var r=0,n=this.array_.length;r<n;++r)if(this.array_[r]===t&&r!==e)throw new AssertionError(58)},t}(BaseObject);export default Collection;export{CollectionEvent};
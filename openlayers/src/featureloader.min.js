import{VOID}from"./functions.js";import FormatType from"./format/FormatType.js";let withCredentials=!1;function loadFeaturesXhr(t,o,a,i){return function(r,e,n){const s=new XMLHttpRequest;s.open("GET","function"==typeof t?t(r,e,n):t,!0),o.getType()==FormatType.ARRAY_BUFFER&&(s.responseType="arraybuffer"),s.withCredentials=withCredentials,s.onload=function(e){if(!s.status||200<=s.status&&s.status<300){var t=o.getType();let e;t==FormatType.JSON||t==FormatType.TEXT?e=s.responseText:t==FormatType.XML?e=(e=s.responseXML)||(new DOMParser).parseFromString(s.responseText,"application/xml"):t==FormatType.ARRAY_BUFFER&&(e=s.response),e?a.call(this,o.readFeatures(e,{extent:r,featureProjection:n}),o.readProjection(e)):i.call(this)}else i.call(this)}.bind(this),s.onerror=function(){i.call(this)}.bind(this),s.send()}}function xhr(e,t){return loadFeaturesXhr(e,t,function(e,t){"function"==typeof this.addFeatures&&this.addFeatures(e)},VOID)}function setWithCredentials(e){withCredentials=e}export{loadFeaturesXhr,xhr,setWithCredentials};
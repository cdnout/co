import{linearFindNearest}from"./array.js";import{getHeight,getWidth}from"./extent.js";import{clamp}from"./math.js";function getViewportClampedResolution(t,e,o){var n=getWidth(e)/o[0],e=getHeight(e)/o[1];return Math.min(t,Math.min(n,e))}function getSmoothClampedResolution(t,e,o){let n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,o&&(n=Math.max(n,o),n/=Math.log(1+50*Math.max(0,o/t-1))/50+1),clamp(n,o/2,2*e)}function createSnapToResolutions(r,l,m){return function(t,e,o,n){if(void 0!==t){var a=r[0],i=r[r.length-1],o=m?getViewportClampedResolution(a,m,o):a;if(n)return void 0===l||l?getSmoothClampedResolution(t,o,i):clamp(t,i,o);a=Math.min(o,t),n=Math.floor(linearFindNearest(r,a,e));return r[n]>o&&n<r.length-1?r[n+1]:r[n]}}}function createSnapToPower(i,r,l,m,u){return function(t,e,o,n){if(void 0!==t){var o=u?getViewportClampedResolution(r,u,o):r,a=void 0!==l?l:0;if(n)return void 0===m||m?getSmoothClampedResolution(t,o,a):clamp(t,a,o);n=-e*(.5-1e-9)+.5,e=Math.min(o,t),t=Math.floor(Math.log(r/e)/Math.log(i)+n),e=r/Math.pow(i,t);return clamp(e,a,o)}}}function createMinMaxResolution(a,i,r,l){return function(t,e,o,n){if(void 0!==t)return o=l?getViewportClampedResolution(a,l,o):a,(void 0===r||r)&&n?getSmoothClampedResolution(t,o,i):clamp(t,i,o)}}export{createSnapToResolutions,createSnapToPower,createMinMaxResolution};
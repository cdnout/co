import{abstract}from"../util.js";import ImageState from"../ImageState.js";import Observable from"../Observable.js";import EventType from"../events/EventType.js";import SourceState from"../source/State.js";class LayerRenderer extends Observable{constructor(e){super(),this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e}prepareFrame(e){return abstract()}renderFrame(e,t){return abstract()}loadedTileCallback(e,t,a){e[t]||(e[t]={}),e[t][a.tileCoord.toString()]=a}createLoadedTileFinder(r,n,d){return function(e,t){var a=this.loadedTileCallback.bind(this,d,e);return r.forEachLoadedTile(n,e,t,a)}.bind(this)}forEachFeatureAtCoordinate(e,t,a,r,n){}getDataAtPixel(e,t,a){return abstract()}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;t.getState()===ImageState.LOADED&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=ImageState.LOADED&&t!=ImageState.ERROR&&e.addEventListener(EventType.CHANGE,this.boundHandleImageChange_),t==ImageState.IDLE&&(e.load(),t=e.getState()),t==ImageState.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e.getVisible()&&e.getSourceState()==SourceState.READY&&e.changed()}}export default LayerRenderer;
import{extend}from"../array.js";import{createOrUpdateFromCoordinate,createOrUpdateFromFlatCoordinates,getCenter,getHeight}from"../extent.js";import GeometryType from"../geom/GeometryType.js";import{linearRingss as linearRingssCenter}from"../geom/flat/center.js";import{getInteriorPointOfArray,getInteriorPointsOfMultiArray}from"../geom/flat/interiorpoint.js";import{interpolatePoint}from"../geom/flat/interpolate.js";import{get as getProjection}from"../proj.js";import{transform2D}from"../geom/flat/transform.js";import{create as createTransform,compose as composeTransform}from"../transform.js";const tmpTransform=createTransform();class RenderFeature{constructor(t,e,r,i,o){this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r,this.properties_=i}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_===GeometryType.POINT?createOrUpdateFromCoordinate(this.flatCoordinates_):createOrUpdateFromFlatCoordinates(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){var t;return this.flatInteriorPoints_||(t=getCenter(this.getExtent()),this.flatInteriorPoints_=getInteriorPointOfArray(this.flatCoordinates_,0,this.ends_,2,t,0)),this.flatInteriorPoints_}getFlatInteriorPoints(){var t;return this.flatInteriorPoints_||(t=linearRingssCenter(this.flatCoordinates_,0,this.ends_,2),this.flatInteriorPoints_=getInteriorPointsOfMultiArray(this.flatCoordinates_,0,this.ends_,2,t)),this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=interpolatePoint(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];var i=this.flatCoordinates_;let r=0;var o=this.ends_;for(let t=0,e=o.length;t<e;++t){var n=o[t],s=interpolatePoint(i,r,n,2,.5);extend(this.flatMidpoints_,s),r=n}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}getProperties(){return this.properties_}getStride(){return 2}getStyleFunction(){}getType(){return this.type_}transform(t,e){var r=(t=getProjection(t)).getExtent(),t=t.getWorldExtent(),r=getHeight(t)/getHeight(r);composeTransform(tmpTransform,t[0],t[3],r,-r,0,0,0),transform2D(this.flatCoordinates_,0,this.flatCoordinates_.length,2,tmpTransform,this.flatCoordinates_)}}RenderFeature.prototype.getEnds=RenderFeature.prototype.getEndss=function(){return this.ends_},RenderFeature.prototype.getFlatCoordinates=RenderFeature.prototype.getOrientedFlatCoordinates;export default RenderFeature;
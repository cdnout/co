var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();import CanvasInstruction,{strokeInstruction,beginPathInstruction}from"./Instruction.js";import CanvasBuilder from"./Builder.js";var CanvasLineStringBuilder=function(s){function t(t,i,n,e){return s.call(this,t,i,n,e)||this}return __extends(t,s),t.prototype.drawFlatCoordinates_=function(t,i,n,e){var s=this.coordinates.length,t=this.appendFlatCoordinates(t,i,n,e,!1,!1),i=[CanvasInstruction.MOVE_TO_LINE_TO,s,t];return this.instructions.push(i),this.hitDetectionInstructions.push(i),n},t.prototype.drawLineString=function(t,i){var n=this.state,e=n.strokeStyle,s=n.lineWidth;void 0!==e&&void 0!==s&&(this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(i),this.hitDetectionInstructions.push([CanvasInstruction.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],beginPathInstruction),e=t.getFlatCoordinates(),s=t.getStride(),this.drawFlatCoordinates_(e,0,e.length,s),this.hitDetectionInstructions.push(strokeInstruction),this.endGeometry(i))},t.prototype.drawMultiLineString=function(t,i){var n=this.state,e=n.strokeStyle,s=n.lineWidth;if(void 0!==e&&void 0!==s){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(i),this.hitDetectionInstructions.push([CanvasInstruction.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],beginPathInstruction);for(var o=t.getEnds(),r=t.getFlatCoordinates(),a=t.getStride(),h=0,u=0,l=o.length;u<l;++u)h=this.drawFlatCoordinates_(r,h,o[u],a);this.hitDetectionInstructions.push(strokeInstruction),this.endGeometry(i)}},t.prototype.finish=function(){var t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(strokeInstruction),this.reverseHitDetectionInstructions(),this.state=null,s.prototype.finish.call(this)},t.prototype.applyStroke=function(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(strokeInstruction),t.lastStroke=this.coordinates.length),t.lastStroke=0,s.prototype.applyStroke.call(this,t),this.instructions.push(beginPathInstruction)},t}(CanvasBuilder);export default CanvasLineStringBuilder;
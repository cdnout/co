var __extends=this&&this.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)};return function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();import{always}from"../events/condition.js";import EventType from"../events/EventType.js";import{DEVICE_PIXEL_RATIO,FIREFOX}from"../has.js";import Interaction,{zoomByDelta}from"./Interaction.js";import{clamp}from"../math.js";var Mode={TRACKPAD:"trackpad",WHEEL:"wheel"},MouseWheelZoom=function(o){function t(t){var e=this,t=t||{};return(e=o.call(this,t)||this).totalDelta_=0,e.lastDelta_=0,e.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,e.duration_=void 0!==t.duration?t.duration:250,e.timeout_=void 0!==t.timeout?t.timeout:80,e.useAnchor_=void 0===t.useAnchor||t.useAnchor,e.condition_=t.condition||always,e.lastAnchor_=null,e.startTime_=void 0,e.timeoutId_,e.mode_=void 0,e.trackpadEventGap_=400,e.trackpadTimeoutId_,e.trackpadDeltaPerZoom_=300,e}return __extends(t,o),t.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().endInteraction(void 0,Math.sign(this.lastDelta_),this.lastAnchor_)},t.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;if(t.type!==EventType.WHEEL)return!0;t.preventDefault();var e,o=t.map,i=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==EventType.WHEEL&&(e=i.deltaY,FIREFOX&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=DEVICE_PIXEL_RATIO),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;t=Date.now();if(void 0===this.startTime_&&(this.startTime_=t),(!this.mode_||t-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?Mode.TRACKPAD:Mode.WHEEL),this.mode_===Mode.TRACKPAD)return i=o.getView(),this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):i.beginInteraction(),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.trackpadEventGap_),i.adjustZoom(-e/this.trackpadDeltaPerZoom_,this.lastAnchor_),this.startTime_=t,!1;this.totalDelta_+=e;i=Math.max(this.timeout_-(t-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,o),i),!1},t.prototype.handleWheelZoom_=function(t){var t=t.getView(),e=(t.getAnimating()&&t.cancelAnimations(),clamp(this.totalDelta_,-this.maxDelta_,this.maxDelta_));zoomByDelta(t,-e,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},t.prototype.setMouseAnchor=function(t){(this.useAnchor_=t)||(this.lastAnchor_=null)},t}(Interaction);export default MouseWheelZoom;export{Mode};
var __extends=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();import{scale as scaleCoordinate,rotate as rotateCoordinate}from"../coordinate.js";import{easeOut}from"../easing.js";import{noModifierKeys,primaryAction}from"../events/condition.js";import{FALSE}from"../functions.js";import PointerInteraction,{centroid as centroidFromPointers}from"./Pointer.js";var DragPan=function(i){function t(t){var n=i.call(this,{stopDown:FALSE})||this,t=t||{};return n.kinetic_=t.kinetic,n.lastCentroid=null,n.lastPointersCount_,n.panning_=!1,n.condition_=t.condition||defaultCondition,n.noKinetic_=!1,n}return __extends(t,i),t.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var n,i=this.targetPointers,e=centroidFromPointers(i);i.length==this.lastPointersCount_?(this.kinetic_&&this.kinetic_.update(e[0],e[1]),this.lastCentroid&&(n=[this.lastCentroid[0]-e[0],e[1]-this.lastCentroid[1]],t=t.map.getView(),scaleCoordinate(n,t.getResolution()),rotateCoordinate(n,t.getRotation()),t.adjustCenterInternal(n))):this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=e,this.lastPointersCount_=i.length},t.prototype.handleUpEvent=function(t){var n,i,e,t=t.map,o=t.getView();return 0===this.targetPointers.length?(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()&&(n=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),e=o.getCenterInternal(),e=t.getPixelFromCoordinate(e),t=t.getCoordinateFromPixel([e[0]-n*Math.cos(i),e[1]-n*Math.sin(i)]),o.animateInternal({center:o.getConstrainedCenter(t),duration:500,easing:easeOut})),this.panning_&&(this.panning_=!1,o.endInteraction()),!1):(this.kinetic_&&this.kinetic_.begin(),!(this.lastCentroid=null))},t.prototype.handleDownEvent=function(t){return!!(0<this.targetPointers.length&&this.condition_(t))&&(t=t.map.getView(),this.lastCentroid=null,t.getAnimating()&&t.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=1<this.targetPointers.length,!0)},t}(PointerInteraction);function defaultCondition(t){return noModifierKeys(t)&&primaryAction(t)}export default DragPan;
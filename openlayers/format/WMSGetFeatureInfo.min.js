var __extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();import{extend,includes}from"../array.js";import GML2 from"./GML2.js";import XMLFeature from"./XMLFeature.js";import{assign}from"../obj.js";import{makeArrayPusher,makeStructureNS,pushParseAndPop}from"../xml.js";var featureIdentifier="_feature",layerIdentifier="_layer",WMSGetFeatureInfo=function(r){function e(e){var t=r.call(this)||this,e=e||{};return t.featureNS_="http://mapserver.gis.umn.edu/mapserver",t.gmlFormat_=new GML2,t.layers_=e.layers||null,t}return __extends(e,r),e.prototype.getLayers=function(){return this.layers_},e.prototype.setLayers=function(e){this.layers_=e},e.prototype.readFeatures_=function(e,t){e.setAttribute("namespaceURI",this.featureNS_);var r=e.localName,a=[];if(0===e.childNodes.length)return a;if("msGMLOutput"==r)for(var o=0,n=e.childNodes.length;o<n;o++){var s,u,i,f=e.childNodes[o];f.nodeType===Node.ELEMENT_NODE&&(i=t[0],u=(f=f).localName.replace(layerIdentifier,""),this.layers_&&!includes(this.layers_,u)||(i.featureType=u=u+featureIdentifier,i.featureNS=this.featureNS_,(s={})[u]=makeArrayPusher(this.gmlFormat_.readFeatureElement,this.gmlFormat_),u=makeStructureNS([i.featureNS,null],s),f.setAttribute("namespaceURI",this.featureNS_),(i=pushParseAndPop([],u,f,t,this.gmlFormat_))&&extend(a,i)))}return a="FeatureCollection"==r&&(r=pushParseAndPop([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,e,[{}],this.gmlFormat_))?r:a},e.prototype.readFeaturesFromNode=function(e,t){var r={};return t&&assign(r,this.getReadOptions(e,t)),this.readFeatures_(e,[r])},e}(XMLFeature);export default WMSGetFeatureInfo;
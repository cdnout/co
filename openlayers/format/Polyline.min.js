var __extends=this&&this.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();import{assert}from"../asserts.js";import Feature from"../Feature.js";import{transformGeometryWithOptions}from"./Feature.js";import TextFeature from"./TextFeature.js";import GeometryLayout from"../geom/GeometryLayout.js";import LineString from"../geom/LineString.js";import{getStrideForLayout}from"../geom/SimpleGeometry.js";import{flipXY}from"../geom/flat/flip.js";import{inflateCoordinates}from"../geom/flat/inflate.js";import{get as getProjection}from"../proj.js";var Polyline=function(r){function e(e){var t=r.call(this)||this,e=e||{};return t.dataProjection=getProjection("EPSG:4326"),t.factor_=e.factor||1e5,t.geometryLayout_=e.geometryLayout||GeometryLayout.XY,t}return __extends(e,r),e.prototype.readFeatureFromText=function(e,t){e=this.readGeometryFromText(e,t);return new Feature(e)},e.prototype.readFeaturesFromText=function(e,t){return[this.readFeatureFromText(e,t)]},e.prototype.readGeometryFromText=function(e,t){var r=getStrideForLayout(this.geometryLayout_),e=decodeDeltas(e,r,this.factor_),e=(flipXY(e,0,e.length,r,e),inflateCoordinates(e,0,e.length,r)),r=new LineString(e,this.geometryLayout_);return transformGeometryWithOptions(r,!1,this.adaptOptions(t))},e.prototype.writeFeatureText=function(e,t){e=e.getGeometry();return e?this.writeGeometryText(e,t):(assert(!1,40),"")},e.prototype.writeFeaturesText=function(e,t){return this.writeFeatureText(e[0],t)},e.prototype.writeGeometryText=function(e,t){t=(e=transformGeometryWithOptions(e,!0,this.adaptOptions(t))).getFlatCoordinates(),e=e.getStride();return flipXY(t,0,t.length,e,t),encodeDeltas(t,e,this.factor_)},e}(TextFeature);function encodeDeltas(e,t,r){for(var r=r||1e5,o=new Array(t),n=0;n<t;++n)o[n]=0;for(var i=0,a=e.length;i<a;)for(n=0;n<t;++n,++i){var s=e[i],d=s-o[n];o[n]=s,e[i]=d}return encodeFloats(e,r)}function decodeDeltas(e,t,r){for(var r=r||1e5,o=new Array(t),n=0;n<t;++n)o[n]=0;for(var i=decodeFloats(e,r),a=0,s=i.length;a<s;)for(n=0;n<t;++n,++a)o[n]+=i[a],i[a]=o[n];return i}function encodeFloats(e,t){for(var r=t||1e5,o=0,n=e.length;o<n;++o)e[o]=Math.round(e[o]*r);return encodeSignedIntegers(e)}function decodeFloats(e,t){for(var r=t||1e5,o=decodeSignedIntegers(e),n=0,i=o.length;n<i;++n)o[n]/=r;return o}function encodeSignedIntegers(e){for(var t=0,r=e.length;t<r;++t){var o=e[t];e[t]=o<0?~(o<<1):o<<1}return encodeUnsignedIntegers(e)}function decodeSignedIntegers(e){for(var t=decodeUnsignedIntegers(e),r=0,o=t.length;r<o;++r){var n=t[r];t[r]=1&n?~(n>>1):n>>1}return t}function encodeUnsignedIntegers(e){for(var t="",r=0,o=e.length;r<o;++r)t+=encodeUnsignedInteger(e[r]);return t}function decodeUnsignedIntegers(e){for(var t=[],r=0,o=0,n=0,i=e.length;n<i;++n){var a=e.charCodeAt(n)-63;r|=(31&a)<<o,a<32?(t.push(r),o=r=0):o+=5}return t}function encodeUnsignedInteger(e){for(var t,r="";32<=e;)t=63+(32|31&e),r+=String.fromCharCode(t),e>>=5;return t=e+63,r+=String.fromCharCode(t)}export default Polyline;export{encodeDeltas,decodeDeltas,encodeFloats,decodeFloats,encodeSignedIntegers,decodeSignedIntegers,encodeUnsignedIntegers,decodeUnsignedIntegers,encodeUnsignedInteger};
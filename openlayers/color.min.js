import{assert}from"./asserts.js";import{clamp}from"./math.js";var HEX_COLOR_RE_=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,NAMED_COLOR_RE_=/^([a-z]*)$/i;function asString(r){return"string"==typeof r?r:toString(r)}function fromNamed(r){var t=document.createElement("div");return t.style.color=r,""!==t.style.color?(document.body.appendChild(t),r=getComputedStyle(t).color,document.body.removeChild(t),r):""}var fromString=function(){var a={},o=0;return function(r){var t;if(a.hasOwnProperty(r))t=a[r];else{if(1024<=o){var e,n=0;for(e in a)0==(3&n++)&&(delete a[e],--o)}t=fromStringInternal_(r),a[r]=t,++o}return t}}();function asArray(r){return Array.isArray(r)?r:fromString(r)}function fromStringInternal_(r){var t,e,n,a,o,i;return NAMED_COLOR_RE_.exec(r)&&(r=fromNamed(r)),HEX_COLOR_RE_.exec(r)?(t=void 0,t=(e=r.length-1)<=4?1:2,e=4==e||8==e,n=parseInt(r.substr(1+0*t,t),16),a=parseInt(r.substr(+t+1,t),16),o=parseInt(r.substr(1+2*t,t),16),i=e?parseInt(r.substr(1+3*t,t),16):255,1==t&&(n=(n<<4)+n,a=(a<<4)+a,o=(o<<4)+o,e&&(i=(i<<4)+i)),t=[n,a,o,i/255]):0==r.indexOf("rgba(")?normalize(t=r.slice(5,-1).split(",").map(Number)):0==r.indexOf("rgb(")?((t=r.slice(4,-1).split(",").map(Number)).push(1),normalize(t)):assert(!1,14),t}function normalize(r){return r[0]=clamp(r[0]+.5|0,0,255),r[1]=clamp(r[1]+.5|0,0,255),r[2]=clamp(r[2]+.5|0,0,255),r[3]=clamp(r[3],0,1),r}function toString(r){var t=r[0],e=r[1],n=r[2];return"rgba("+(t=t!=(0|t)?t+.5|0:t)+","+(e=e!=(0|e)?e+.5|0:e)+","+(n=n!=(0|n)?n+.5|0:n)+","+(void 0===r[3]?1:r[3])+")"}export{asString,fromString,asArray,normalize,toString};
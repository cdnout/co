var __extends=this&&this.__extends||function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();import LayerRenderer from"../Layer.js";import WebGLHelper from"../../webgl/Helper.js";var WebGLWorkerMessageType={GENERATE_BUFFERS:"GENERATE_BUFFERS"},WebGLLayerRenderer=function(r){function t(t,e){t=r.call(this,t)||this,e=e||{};return t.helper=new WebGLHelper({postProcesses:e.postProcesses,uniforms:e.uniforms}),t}return __extends(t,r),t.prototype.disposeInternal=function(){r.prototype.disposeInternal.call(this)},t.prototype.getShaderCompileErrors=function(){return this.helper.getShaderCompileErrors()},t}(LayerRenderer);function writePointFeatureInstructions(t,e,r,o,n,i,s,a,u,T,_,c){return t[e++]=r,t[e++]=o,t[e++]=n,t[e++]=i,t[e++]=s,t[e++]=a,t[e++]=u,t[e++]=T,t[e++]=_?1:0,t[e++]=c[0],t[e++]=c[1],t[e++]=c[2],t[e++]=c[3],e}var tmpArray_=[],bufferPositions_={vertexPosition:0,indexPosition:0},POINT_INSTRUCTIONS_COUNT=13,POINT_VERTEX_STRIDE=12;function writePointVertex(t,e,r,o,n,i,s,a,u,T,_,c,f,I){t[e+0]=r,t[e+1]=o,t[e+2]=n,t[e+3]=i,t[e+4]=s,t[e+5]=a,t[e+6]=u,t[e+7]=T,t[e+8]=_,t[e+9]=c,t[e+10]=f,t[e+11]=I}function writeCustomAttrs(t,e,r){r.length&&t.set(r,e)}function writePointFeatureToBuffers(t,e,r,o,n,i){var i=POINT_INSTRUCTIONS_COUNT<i?i:POINT_INSTRUCTIONS_COUNT,s=t[e+0],a=t[e+1],u=t[e+2],T=t[e+3],_=t[e+4],c=t[e+5],f=t[e+6],I=t[e+7],p=t[e+8],d=t[e+9],N=t[e+10],P=t[e+11],l=t[e+12],O=POINT_VERTEX_STRIDE,h=O+i-POINT_INSTRUCTIONS_COUNT,C=tmpArray_;C.length=i-POINT_INSTRUCTIONS_COUNT;for(var E=0;E<C.length;E++)C[E]=t[e+POINT_INSTRUCTIONS_COUNT+E];var i=n?n.vertexPosition:0,n=n?n.indexPosition:0,R=i/h;return writePointVertex(r,i,s,a,-f/2,-f/2,u,T,I,p,d,N,P,l),writeCustomAttrs(r,i+O,C),writePointVertex(r,i+=h,s,a,+f/2,-f/2,_,T,I,p,d,N,P,l),writeCustomAttrs(r,i+O,C),writePointVertex(r,i+=h,s,a,+f/2,+f/2,_,c,I,p,d,N,P,l),writeCustomAttrs(r,i+O,C),writePointVertex(r,i+=h,s,a,-f/2,+f/2,u,c,I,p,d,N,P,l),writeCustomAttrs(r,i+O,C),i+=h,o[n++]=R,o[n++]=1+R,o[n++]=3+R,o[n++]=1+R,o[n++]=2+R,o[n++]=3+R,bufferPositions_.vertexPosition=i,bufferPositions_.indexPosition=n,bufferPositions_}function getBlankImageData(){var t=document.createElement("canvas").getContext("2d").createImageData(1,1);return t.data[0]=t.data[1]=t.data[2]=t.data[3]=255,t}function colorEncodeId(t,e){var e=e||[],r=256;return e[0]=Math.floor(t/r/r/r)/255,e[1]=Math.floor(t/r/r)%r/255,e[2]=Math.floor(t/r)%r/255,e[3]=t%r/255,e}function colorDecodeId(t){var e=0;return(e+=Math.round(256*t[0]*256*256*255))+Math.round(256*t[1]*256*255)+Math.round(256*t[2]*255)+Math.round(255*t[3])}export default WebGLLayerRenderer;export{WebGLWorkerMessageType,writePointFeatureInstructions,POINT_INSTRUCTIONS_COUNT,POINT_VERTEX_STRIDE,writePointFeatureToBuffers,getBlankImageData,colorEncodeId,colorDecodeId};
var __extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();import ImageWrapper from"../Image.js";import ImageState from"../ImageState.js";import{createCanvasContext2D}from"../dom.js";import EventType from"../events/EventType.js";import{intersects,getHeight,getWidth}from"../extent.js";import{get as getProjection}from"../proj.js";import ImageSource,{defaultImageLoadFunction}from"./Image.js";var Static=function(r){function t(t){var e=this,i=void 0!==t.crossOrigin?t.crossOrigin:null,n=void 0!==t.imageLoadFunction?t.imageLoadFunction:defaultImageLoadFunction;return(e=r.call(this,{attributions:t.attributions,projection:getProjection(t.projection)})||this).url_=t.url,e.imageExtent_=t.imageExtent,e.image_=new ImageWrapper(e.imageExtent_,void 0,1,e.url_,i,n),e.imageSize_=t.imageSize||null,e.image_.addEventListener(EventType.CHANGE,e.handleImageChange.bind(e)),e}return __extends(t,r),t.prototype.getImageExtent=function(){return this.imageExtent_},t.prototype.getImageInternal=function(t,e,i,n){return intersects(t,this.image_.getExtent())?this.image_:null},t.prototype.getUrl=function(){return this.url_},t.prototype.handleImageChange=function(t){var e,i,n,a,o;this.image_.getState()==ImageState.LOADED&&(o=this.image_.getExtent(),e=this.image_.getImage(),n=i=void 0,n=this.imageSize_?(i=this.imageSize_[0],this.imageSize_[1]):(i=e.width,e.height),a=getHeight(o)/n,(o=Math.ceil(getWidth(o)/a))!=i&&(o=(a=createCanvasContext2D(o,n)).canvas,a.drawImage(e,0,0,i,n,0,0,o.width,o.height),this.image_.setImage(o))),r.prototype.handleImageChange.call(this,t)},t}(ImageSource);export default Static;
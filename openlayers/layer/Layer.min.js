var __extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();import{listen,unlistenByKey}from"../events.js";import EventType from"../events/EventType.js";import{getChangeEventType}from"../Object.js";import BaseLayer from"./Base.js";import LayerProperty from"./Property.js";import{assign}from"../obj.js";import RenderEventType from"../render/EventType.js";import SourceState from"../source/State.js";var Layer=function(n){function e(e){var t=this,r=assign({},e),r=(delete r.source,(t=n.call(this,r)||this).mapPrecomposeKey_=null,t.mapRenderKey_=null,t.sourceChangeKey_=null,t.renderer_=null,e.render&&(t.render=e.render),e.map&&t.setMap(e.map),t.addEventListener(getChangeEventType(LayerProperty.SOURCE),t.handleSourcePropertyChange_),e.source||null);return t.setSource(r),t}return __extends(e,n),e.prototype.getLayersArray=function(e){e=e||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(e){e=e||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(LayerProperty.SOURCE)||null},e.prototype.getSourceState=function(){var e=this.getSource();return e?e.getState():SourceState.UNDEFINED},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(unlistenByKey(this.sourceChangeKey_),this.sourceChangeKey_=null);var e=this.getSource();e&&(this.sourceChangeKey_=listen(e,EventType.CHANGE,this.handleSourceChange_,this)),this.changed()},e.prototype.render=function(e,t){var r=this.getRenderer();if(r.prepareFrame(e))return r.renderFrame(e,t)},e.prototype.setMap=function(e){this.mapPrecomposeKey_&&(unlistenByKey(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(unlistenByKey(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=listen(e,RenderEventType.PRECOMPOSE,function(e){e.frameState.layerStatesArray.push(this.getLayerState(!1))},this),this.mapRenderKey_=listen(this,EventType.CHANGE,e.render,e),this.changed())},e.prototype.setSource=function(e){this.set(LayerProperty.SOURCE,e)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e}(BaseLayer);function inView(e,t){if(!e.visible)return!1;var r=t.resolution;if(r<e.minResolution||r>=e.maxResolution)return!1;r=t.zoom;return r>e.minZoom&&r<=e.maxZoom}export default Layer;export{inView};
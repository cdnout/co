(function(){var g=false,k=function(){if(g)return false;return!document.createElement("canvas").getContext?(g=true,console&&console.log("Notificon: requires canvas support"),false):true},l=function(c){c||(c={});var b=h(),b={color:"#000000",stroke:"rgba(255,255,255,0.85)",favicon:b?b.getAttribute("href"):"/favicon.ico"},a;for(a in b)c[a]||(c[a]=b[a]);return c},h=function(c){for(var b=document.getElementsByTagName("link"),a=0;a<b.length;a++)if(c&&/\bnotificon\b/i.test(b[a].getAttribute("rel")))return b[a];
else if(!c&&/\bicon\b/i.test(b[a].getAttribute("rel")))return b[a];return false},m=function b(){var a=h(true);a&&(a.parentNode.removeChild(a),b())},j=function(b){var a=document.createElement("link");a.type="image/x-icon";a.rel="icon notificon";a.href=b;m();document.getElementsByTagName("head")[0].appendChild(a)},n=function(b,a){if(!k())return false;var f=l(a);if(!b.length)return j(f.favicon);var e=document.createElement("img");e.src=f.favicon;e.onload=function(){var a=document.createElement("canvas");
a.width=e.width;a.height=e.height;a.getContext("2d").drawImage(e,0,0);if(b){var g=f.color,h=f.stroke,d=a.getContext("2d");d.font="10px monospace";d.fillStyle=g;d.textAlign="right";d.textBaseline="top";d.strokeStyle=h;d.lineWidth=4;d.strokeText(b,16,6);d.fillText(b,16,6)}try{return j(a.toDataURL("image/png"))}catch(i){if(console)return console.log("Notificon: cannot use icons located on a different domain ("+favicon+")"),false}};e.onerror=function(){if(console)return console.log("Notificon: image not found ("+
f.favicon+")"),false};return true},i=function(b,a){n(b,a)};typeof exports!=="undefined"?module.exports=i:this.Notificon=i})(this);

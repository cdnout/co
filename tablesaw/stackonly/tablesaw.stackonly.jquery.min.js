!function(e,a){"function"==typeof define&&define.amd?define(["jquery"],function(t){return e.Tablesaw=a(t,e)}):"object"==typeof exports?module.exports=a("document"in e?require("jquery"):require("jquery")(e),e):e.Tablesaw=a(jQuery,e)}("undefined"!=typeof window?window:this,function(d,h){"use strict";var c=h.document,e=/complete|loaded/.test(c.readyState);c.addEventListener("DOMContentLoaded",function(){e=!0});var t,n,i,a,r,s,o,u={i18n:{modeStack:"Stack",modeSwipe:"Swipe",modeToggle:"Toggle",modeSwitchColumnsAbbreviated:"Cols",modeSwitchColumns:"Columns",columnToggleButton:"Columns",columnToggleError:"No eligible columns.",sort:"Sort",swipePreviousColumn:"Previous column",swipeNextColumn:"Next column"},mustard:"head"in c&&(!h.blackberry||h.WebKitPoint)&&!h.operamini,$:d,_init:function(t){u.$(t||c).trigger("enhance.tablesaw")},init:function(t){(e=e||/complete|loaded/.test(c.readyState))?u._init(t):"addEventListener"in c&&c.addEventListener("DOMContentLoaded",function(){u._init(t)})}};return d(c).on("enhance.tablesaw",function(){"undefined"!=typeof TablesawConfig&&TablesawConfig.i18n&&(u.i18n=d.extend(u.i18n,TablesawConfig.i18n||{})),u.i18n.modes=[u.i18n.modeStack,u.i18n.modeSwipe,u.i18n.modeToggle]}),u.mustard&&d(c.documentElement).addClass("tablesaw-enhanced"),function(){var a="tablesaw",n="tablesaw-bar",e={create:"tablesawcreate",destroy:"tablesawdestroy",refresh:"tablesawrefresh",resize:"tablesawresize"},i={};u.events=e;var t=function(t){if(!t)throw new Error("Tablesaw requires an element.");this.table=t,this.$table=d(t),this.$thead=this.$table.children().filter("thead").eq(0),this.$tbody=this.$table.children().filter("tbody"),this.mode=this.$table.attr("data-tablesaw-mode")||"stack",this.$toolbar=null,this.attributes={subrow:"data-tablesaw-subrow",ignorerow:"data-tablesaw-ignorerow"},this.init()};t.prototype.init=function(){if(!this.$thead.length)throw new Error("tablesaw: a <thead> is required, but none was found.");if(!this.$thead.find("th").length)throw new Error("tablesaw: no header cells found. Are you using <th> inside of <thead>?");this.$table.attr("id")||this.$table.attr("id",a+"-"+Math.round(1e4*Math.random())),this.createToolbar(),this._initCells(),this.$table.data(a,this),this.$table.trigger(e.create,[this])},t.prototype.getConfig=function(t){var e=d.extend(i,t||{});return d.extend(e,"undefined"!=typeof TablesawConfig?TablesawConfig:{})},t.prototype._getPrimaryHeaderRow=function(){return this._getHeaderRows().eq(0)},t.prototype._getHeaderRows=function(){return this.$thead.children().filter("tr").filter(function(){return!d(this).is("[data-tablesaw-ignorerow]")})},t.prototype._getRowIndex=function(t){return t.prevAll().length},t.prototype._getHeaderRowIndeces=function(){var t=this,e=[];return this._getHeaderRows().each(function(){e.push(t._getRowIndex(d(this)))}),e},t.prototype._getPrimaryHeaderCells=function(t){return(t||this._getPrimaryHeaderRow()).find("th")},t.prototype._$getCells=function(t){var n=this;return d(t).add(t.cells).filter(function(){var t=d(this),e=t.parent(),a=t.is("[colspan]");return!(e.is("["+n.attributes.subrow+"]")||e.is("["+n.attributes.ignorerow+"]")&&a)})},t.prototype._getVisibleColspan=function(){var e=0;return this._getPrimaryHeaderCells().each(function(){var t=d(this);"none"!==t.css("display")&&(e+=parseInt(t.attr("colspan"),10)||1)}),e},t.prototype.getColspanForCell=function(t){var e=this._getVisibleColspan(),a=0;return t.closest("tr").data("tablesaw-rowspanned")&&a++,t.siblings().each(function(){var t=d(this),e=parseInt(t.attr("colspan"),10)||1;"none"!==t.css("display")&&(a+=e)}),e-a},t.prototype.isCellInColumn=function(t,e){return d(t).add(t.cells).filter(function(){return this===e}).length},t.prototype.updateColspanCells=function(n,i,r){var s=this,t=s._getPrimaryHeaderRow();this.$table.find("[rowspan][data-tablesaw-priority]").each(function(){var t=d(this);if("persist"===t.attr("data-tablesaw-priority")){var e=t.closest("tr"),a=parseInt(t.attr("rowspan"),10);1<a&&((e=e.next()).data("tablesaw-rowspanned",!0),a--)}}),this.$table.find("[colspan],[data-tablesaw-maxcolspan]").filter(function(){return d(this).closest("tr")[0]!==t[0]}).each(function(){var t=d(this);if(void 0===r||s.isCellInColumn(i,this)){var e=s.getColspanForCell(t);n&&void 0!==r&&t[0===e?"addClass":"removeClass"](n);var a=parseInt(t.attr("data-tablesaw-maxcolspan"),10);a?a<e&&(e=a):t.attr("data-tablesaw-maxcolspan",t.attr("colspan")),t.attr("colspan",e)}})},t.prototype._findPrimaryHeadersForCell=function(t){for(var e=this._getPrimaryHeaderRow(),a=this._getRowIndex(e),n=[],i=0;i<this.headerMapping.length;i++)if(i!==a)for(var r=0;r<this.headerMapping[i].length;r++)this.headerMapping[i][r]===t&&n.push(this.headerMapping[a][r]);return n},t.prototype.getRows=function(){var t=this;return this.$table.find("tr").filter(function(){return d(this).closest("table").is(t.$table)})},t.prototype.getBodyRows=function(t){return(t?d(t):this.$tbody).children().filter("tr")},t.prototype.getHeaderCellIndex=function(t){for(var e=this.headerMapping[0],a=0;a<e.length;a++)if(e[a]===t)return a;return-1},t.prototype._initCells=function(){this.$table.find("[data-tablesaw-maxcolspan]").each(function(){var t=d(this);t.attr("colspan",t.attr("data-tablesaw-maxcolspan"))});var t=this.getRows(),s=[];t.each(function(t){s[t]=[]}),t.each(function(i){var r=0;d(this).children().each(function(){for(var t=parseInt(this.getAttribute("data-tablesaw-maxcolspan")||this.getAttribute("colspan"),10),e=parseInt(this.getAttribute("rowspan"),10);s[i][r];)r++;if(s[i][r]=this,t)for(var a=0;a<t-1;a++)r++,s[i][r]=this;if(e)for(var n=1;n<e;n++)s[i+n][r]=this;r++})});for(var e=this._getHeaderRowIndeces(),a=0;a<s[0].length;a++)for(var n=0,i=e.length;n<i;n++){var r,o=s[e[n]][a],l=e[n];for(o.cells||(o.cells=[]);l<s.length;)o!==(r=s[l][a])&&o.cells.push(r),l++}this.headerMapping=s},t.prototype.refresh=function(){this._initCells(),this.$table.trigger(e.refresh,[this])},t.prototype._getToolbarAnchor=function(){var t=this.$table.parent();return t.is(".tablesaw-overflow")?t:this.$table},t.prototype._getToolbar=function(t){return t||(t=this._getToolbarAnchor()),t.prev().filter("."+n)},t.prototype.createToolbar=function(){var t=this._getToolbarAnchor(),e=this._getToolbar(t);e.length||(e=d("<div>").addClass(n).insertBefore(t)),this.$toolbar=e,this.mode&&this.$toolbar.addClass("tablesaw-mode-"+this.mode)},t.prototype.destroy=function(){this._getToolbar().each(function(){this.className=this.className.replace(/\btablesaw-mode\-\w*\b/gi,"")});var t=this.$table.attr("id");d(c).off("."+t),d(h).off("."+t),this.$table.trigger(e.destroy,[this]),this.$table.removeData(a)},d.fn[a]=function(){return this.each(function(){d(this).data(a)||new t(this)})};var r=d(c);r.on("enhance.tablesaw",function(t){if(u.mustard){var e=d(t.target);e.parent().length&&(e=e.parent()),e.find("table").filter("[data-tablesaw],[data-tablesaw-mode],[data-tablesaw-sortable]")[a]()}});var s,o,l=!1;r.on("scroll.tablesaw",function(){l=!0,h.clearTimeout(s),s=h.setTimeout(function(){l=!1},300)}),d(h).on("resize",function(){l||(h.clearTimeout(o),o=h.setTimeout(function(){r.trigger(e.resize)},150))}),u.Table=t}(),n="tablesaw-cell-label",i="tablesaw-cell-content",a=t="tablesaw-stack",r="data-tablesaw-no-labels",s="data-tablesaw-hide-empty",(o=function(t,e){this.tablesaw=e,this.$table=d(t),this.labelless=this.$table.is("["+r+"]"),this.hideempty=this.$table.is("["+s+"]"),this.$table.data(a,this)}).prototype.init=function(){if(this.$table.addClass(t),!this.labelless){var a=this;this.$table.find("th, td").filter(function(){return!d(this).closest("thead").length}).filter(function(){return!(d(this).is("["+r+"]")||d(this).closest("tr").is("["+r+"]")||a.hideempty&&!d(this).html())}).each(function(){var s=d(c.createElement("b")).addClass(n),t=d(this);d(a.tablesaw._findPrimaryHeadersForCell(this)).each(function(t){var e=d(this.cloneNode(!0)),a=e.find(".tablesaw-sortable-btn");e.find(".tablesaw-sortable-arrow").remove();var n=e.find("[data-tablesaw-checkall]");if(n.closest("label").remove(),n.length)s=d([]);else{0<t&&s.append(c.createTextNode(", "));for(var i,r=a.length?a[0]:e[0];i=r.firstChild;)s[0].appendChild(i)}}),s.length&&!t.find("."+i).length&&t.wrapInner("<span class='"+i+"'></span>");var e=t.find("."+n);e.length?e.replaceWith(s):(t.prepend(c.createTextNode(" ")),t.prepend(s))})}},o.prototype.destroy=function(){this.$table.removeClass(t),this.$table.find("."+n).remove(),this.$table.find("."+i).each(function(){d(this).replaceWith(d(this.childNodes))})},d(c).on(u.events.create,function(t,e){"stack"===e.mode&&new o(e.table,e).init()}).on(u.events.refresh,function(t,e){"stack"===e.mode&&d(e.table).data(a).init()}).on(u.events.destroy,function(t,e){"stack"===e.mode&&d(e.table).data(a).destroy()}),u.Stack=o,u});
!function(e){function t(){this.parent=null,this.nested=[],this.nodes=[],this.filters=null,this.directives=null,this.context=null,this.unbind=null,this.onRender=null,this.onUpdate=null,this.onRemove=null,this.noCache=!1}function n(){this.items=Object.create(null),this.length=0,this.next=0}function r(e,t,n,r){if(r){var i={__index__:n};return i[r.value]=e[n],r.key&&(i[r.key]=n),i}return e[n]}function i(e,t,n,r){if(r){var i={__index__:n};return i[r.value]=e[t[n]],r.key&&(i[r.key]=t[n]),i}return e[t[n]]}t.render=function(e,t,n){var r;return r=n&&n.noCache?new e:e.pool.pop()||new e,8==t.nodeType?r.insertBefore(t):r.appendTo(t),n&&(n.parent&&(r.parent=n.parent),n.context&&(r.context=n.context),n.filters&&(r.filters=n.filters),n.directives&&(r.directives=n.directives),n.noCache&&(r.noCache=n.noCache)),r.onRender&&r.onRender(),r},t.prerender=function(e,t){for(;t--;)e.pool.push(new e)},t.loop=function(e,n,o,s,h,d){var u,c,f,l,a,p,v=o.length;Array.isArray(h)?(a=r,p=h.length):(a=i,l=Object.keys(h),p=l.length),f=v-p;for(u in o.items){if(!(f-- >0))break;o.items[u].remove()}c=0;for(u in o.items)o.items[u].__state__=a(h,l,c,d),c++;for(c=v,f=p;c<f;c++){var m=t.render(s,n,{parent:e,context:e.context,filters:e.filters,directives:e.directives,noCache:e.noCache});e.nested.push(m),u=o.push(m),m.unbind=function(e){return function(){o.remove(e)}}(u),m.__state__=a(h,l,c,d)}},t.cond=function(e,n,r,i,o){if(r.ref)o||r.ref.remove();else if(o){var s=t.render(i,n,{parent:e,context:e.context,filters:e.filters,directives:e.directives,noCache:e.noCache});e.nested.push(s),r.ref=s,s.unbind=function(){r.ref=null}}return o},t.insert=function(e,n,r,i,o){if(r.ref)r.ref.update(o);else{var s=t.render(i,n,{parent:e,context:e.context,filters:e.filters,directives:e.directives,noCache:e.noCache});e.nested.push(s),r.ref=s,s.unbind=function(){r.ref=null},s.update(o)}},t.prototype.remove=function(){for(var e=this.nodes.length;e--;)this.nodes[e].parentNode.removeChild(this.nodes[e]);for(this.unbind&&this.unbind(),e=this.nested.length;e--;)this.nested[e].remove();this.parent&&(e=this.parent.nested.indexOf(this),this.parent.nested.splice(e,1),this.parent=null),this.onRemove&&this.onRemove(),this.noCache||this.constructor.pool.push(this)},t.prototype.appendTo=function(e){for(var t=0,n=this.nodes.length;t<n;t++)e.appendChild(this.nodes[t])},t.prototype.insertBefore=function(e){if(!e.parentNode)throw new Error("Can not insert child view into parent node. You need append your view first and then update.");for(var t=0,n=this.nodes.length;t<n;t++)e.parentNode.insertBefore(this.nodes[t],e)},t.prototype.createDocument=function(){if(1==this.nodes.length)return this.nodes[0];for(var t=e.createDocumentFragment(),n=0,r=this.nodes.length;n<r;n++)t.appendChild(this.nodes[n]);return t},t.prototype.querySelector=function(e){for(var t=0;t<this.nodes.length;t++){if(this.nodes[t].matches&&this.nodes[t].matches(e))return this.nodes[t];if(8===this.nodes[t].nodeType)throw new Error("Can not use querySelector with non-element nodes on first level.");if(this.nodes[t].querySelector){var n=this.nodes[t].querySelector(e);if(n)return n}}return null},n.prototype.push=function(e){return this.items[this.next]=e,this.length+=1,this.next+=1,this.next-1},n.prototype.remove=function(e){if(!(e in this.items))throw new Error('You are trying to delete not existing element "'+e+'" form map.');delete this.items[e],this.length-=1},n.prototype.forEach=function(e){for(var t in this.items)e(this.items[t])},t.Map=n,"undefined"!=typeof module?module.exports=t:window.Monkberry=t}(window.document);
//# sourceMappingURL=monkberry.min.js.map
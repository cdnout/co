"use strict";const{kReply,kRequest,kState,kHasBeenDecorated}=require("./symbols.js"),{FST_ERR_DEC_ALREADY_PRESENT,FST_ERR_DEC_MISSING_DEPENDENCY,FST_ERR_DEC_AFTER_START,FST_ERR_DEC_DEPENDENCY_INVALID_TYPE}=require("./errors"),warning=require("./warnings");function decorate(e,t,r,n){if(e.hasOwnProperty(t))throw new FST_ERR_DEC_ALREADY_PRESENT(t);checkDependencies(e,t,n),!r||"function"!=typeof r.getter&&"function"!=typeof r.setter?e[t]=r:Object.defineProperty(e,t,{get:r.getter,set:r.setter})}function decorateConstructor(e,t,r,n){const c=e.prototype;if(c.hasOwnProperty(t)||hasKey(e,t))throw new FST_ERR_DEC_ALREADY_PRESENT(t);e[kHasBeenDecorated]=!0,checkDependencies(e,t,n),!r||"function"!=typeof r.getter&&"function"!=typeof r.setter?"function"==typeof r?c[t]=r:e.props.push({key:t,value:r}):Object.defineProperty(c,t,{get:r.getter,set:r.setter})}function checkReferenceType(e,t){"object"==typeof t&&t&&"function"!=typeof t.getter&&"function"!=typeof t.setter&&warning.emit("FSTDEP006",e)}function decorateFastify(e,t,r){return assertNotStarted(this,e),decorate(this,e,t,r),this}function checkExistence(e,t){return t?t in e||e.prototype&&t in e.prototype||hasKey(e,t):e in this}function hasKey(e,t){return!!e.props&&e.props.find(({key:e})=>e===t)}function checkRequestExistence(e){return!(!e||!hasKey(this[kRequest],e))||checkExistence(this[kRequest].prototype,e)}function checkReplyExistence(e){return!(!e||!hasKey(this[kReply],e))||checkExistence(this[kReply].prototype,e)}function checkDependencies(e,t,r){if(null!=r){if(!Array.isArray(r))throw new FST_ERR_DEC_DEPENDENCY_INVALID_TYPE(t);for(var n=0;n!==r.length;++n)if(!checkExistence(e,r[n]))throw new FST_ERR_DEC_MISSING_DEPENDENCY(r[n])}}function decorateReply(e,t,r){return assertNotStarted(this,e),checkReferenceType(e,t),decorateConstructor(this[kReply],e,t,r),this}function decorateRequest(e,t,r){return assertNotStarted(this,e),checkReferenceType(e,t),decorateConstructor(this[kRequest],e,t,r),this}function assertNotStarted(e,t){if(e[kState].started)throw new FST_ERR_DEC_AFTER_START(t)}module.exports={add:decorateFastify,exist:checkExistence,existRequest:checkRequestExistence,existReply:checkReplyExistence,dependencies:checkDependencies,decorateReply:decorateReply,decorateRequest:decorateRequest};
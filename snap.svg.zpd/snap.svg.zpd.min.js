SVGElement.prototype.getTransformToElement=SVGElement.prototype.getTransformToElement||function(e){return e.getScreenCTM().inverse().multiply(this.getScreenCTM())},Snap.plugin(function(p,e,t,o,n){function d(e,t){return void 0===t?parseInt(e):"+"==t[0]?e+parseInt(t.split("+")[1]):"-"==t[0]?e-parseInt(t.split("-")[1]):parseInt(t)}function c(e,t){var o="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";e.setAttribute("transform",o)}function v(e,t){var o,n,a,r=t.node.createSVGPoint(),i=(o=t.node,n=curtop=0,(a=o.getBoundingClientRect())&&(n=a.left,curtop=a.top),[n,curtop]);return void 0!==e.touches?(r.x=e.touches[0].clientX-i[0],r.y=e.touches[0].clientY-i[1]):(r.x=e.clientX-i[0],r.y=e.clientY-i[1]),r}function r(e,t,o){function n(e){r=e/i.getCTM().a,u=t.data.root.createSVGMatrix().translate(s.x,s.y).scale(r).translate(-s.x,-s.y),(l=i.getCTM().multiply(u)).a=l.a.toFixed(4),l.d=l.d.toFixed(4)}var a,r=Math.pow(1+t.options.zoomScale,o),i=t.element.node,s=(s=v(e,t.data.svg)).matrixTransform(i.getCTM().inverse()),u=t.data.root.createSVGMatrix().translate(s.x,s.y).scale(r).translate(-s.x,-s.y),l=i.getCTM().multiply(u),d=t.options.zoomThreshold;d&&"object"==typeof d&&(a=p(i).transform().globalMatrix,l.a<a.a&&l.a<d[0]||l.d<a.d&&l.d<d[0]?n(d[0]):(l.a>a.a&&l.a>d[1]||l.d>a.d&&l.d>d[1])&&n(d[1])),c(i,l),"undefined"==typeof stateTf&&(t.data.stateTf=i.getCTM().inverse()),t.data.stateTf=t.data.stateTf.multiply(u.inverse())}var y,b={uniqueIdPrefix:"snapsvg-zpd-",dataStore:{},enable:!0},O=function(i){function a(e){var t,o,n,a,r;e.preventDefault&&i.options.preventDefaultEvent.handleMouseMove&&e.preventDefault(),b.enable&&(e.returnValue=!1,t=i.element.node,"pan"==i.data.state&&i.options.pan?(o=v(e,i.data.svg).matrixTransform(i.data.stateTf),r=a=0,"both"!=i.options.panDirections&&"horizontal"!=i.options.panDirections||(a=o.x-i.data.stateOrigin.x),"both"!=i.options.panDirections&&"vertical"!=i.options.panDirections||(r=o.y-i.data.stateOrigin.y),c(t,i.data.stateTf.inverse().translate(a,r))):"drag"==i.data.state&&i.options.drag&&(n=v(e,i.data.svg).matrixTransform(t.getCTM().inverse()),r=a=0,"both"!=i.options.panDirections&&"horizontal"!=i.options.panDirections||(a=n.x-i.data.stateOrigin.x),"both"!=i.options.panDirections&&"vertical"!=i.options.panDirections||(r=n.y-i.data.stateOrigin.y),c(i.data.stateTarget,i.data.root.createSVGMatrix().translate(a,r).multiply(t.getCTM().inverse()).multiply(i.data.stateTarget.getCTM())),i.data.stateOrigin=n))}return{mouseOrTouchUp:function(e){e.preventDefault&&i.options.preventDefaultEvent.handleMouseOrTouchUp&&e.preventDefault(),b.enable&&(e.returnValue=!1,i.data.touchZoom=!1,"pan"!=i.data.state&&"drag"!=i.data.state||(i.data.state=""))},mouseOrTouchDown:function(e){var t,o,n;e.preventDefault&&i.options.preventDefaultEvent.handleMouseOrTouchDown&&e.preventDefault(),b.enable&&(e.returnValue=!1,i.options.touch&&(i.data.touchZoom=(o=!1,void 0!==(t=e).touches&&2==t.touches.length&&(o=!0),o)),n=i.element.node,"svg"!=e.target.tagName&&i.options.drag?(i.data.state="drag",i.data.stateTarget=e.target):i.data.state="pan",i.data.stateTf=n.getCTM().inverse(),i.data.stateOrigin=v(e,i.data.svg).matrixTransform(i.data.stateTf))},mouseMove:a,mouseWheel:function(e){var t;i.options.zoom&&(e.preventDefault&&i.options.preventDefaultEvent.handleMouseWheel&&e.preventDefault(),b.enable&&(e.returnValue=!1,t=0,t=e.wheelDelta?e.wheelDelta/360:e.detail/-9,r(e,i,t)))},touchMove:function(e){var t,o,n;i.options.zoom&&i.options.touch&&(e.preventDefault&&i.options.preventDefaultEvent.handleTouchMove&&e.preventDefault(),b.enable&&(e.returnValue=!1,i.data.touchZoom?(n=e,t=Math.sqrt((n.touches[0].clientX-n.touches[1].clientX)*(n.touches[0].clientX-n.touches[1].clientX)+(n.touches[0].clientY-n.touches[1].clientY)*(n.touches[0].clientY-n.touches[1].clientY)),null!=i.data.prevZoomDistance&&(o=.15,i.data.prevZoomDistance>t&&(o*=-1),r(e,i,o)),i.data.prevZoomDistance=t):a(e)))}}};t.prototype.zpd=function(e,t){var o,n,a,r,i,s=this,u={pan:!0,panDirections:"both",zoom:!0,drag:!1,zoomScale:.2,zoomThreshold:null,touch:!0,preventDefaultEvent:{handleMouseOrTouchUp:!0,handleMouseOrTouchDown:!0,handleMouseMove:!0,handleMouseWheel:!0,handleTouchMove:!0}},l="init",d="reinit",c="destroy",p="save",v="origin",h="callback",f="toggle",m=null;if("function"==typeof e&&(t=e,o=h),b.dataStore.hasOwnProperty(s.id))if(m=b.dataStore[s.id],"object"==typeof e){for(var g in void 0!==e.preventDefaultEvent&&"object"!=typeof e.preventDefaultEvent&&(e.preventDefaultEvent={handleMouseOrTouchUp:!!e.preventDefaultEvent,handleMouseOrTouchDown:!!e.preventDefaultEvent,handleMouseMove:!!e.preventDefaultEvent,handleMouseWheel:!!e.preventDefaultEvent,handleTouchMove:!!e.preventDefaultEvent}),e)if("object"==typeof e[g])for(var T in"object"!=typeof m.options[g]&&(m.options[g]=e[g]),e[g])m.options[g][T]=e[g][T];else m.options[g]=e[g];o=d}else"string"==typeof e&&(o=e);else{if("object"==typeof e){for(var D in void 0!==e.preventDefaultEvent&&"object"!=typeof e.preventDefaultEvent&&(e.preventDefaultEvent={handleMouseOrTouchUp:!!e.preventDefaultEvent,handleMouseOrTouchDown:!!e.preventDefaultEvent,handleMouseMove:!!e.preventDefaultEvent,handleMouseWheel:!!e.preventDefaultEvent,handleTouchMove:!!e.preventDefaultEvent}),e)if("object"==typeof e[D])for(var M in"object"!=typeof u[D]&&(u[D]=e[D]),e[D])u[D][M]=e[D][M];else u[D]=e[D];o=l}else"string"==typeof e&&(o=e);m=function(e,t){y=e.node;var o,n,a=e.node.childNodes,r=e.g(),i=r.node;i.id=b.uniqueIdPrefix+e.id,t.load&&"object"==typeof t.load?(n="matrix("+(o=t.load).a+","+o.b+","+o.c+","+o.d+","+o.e+","+o.f+")",r.transform(n)):r.transform("matrix");for(var s=0,u=a.length-1;s<u;)i.appendChild(a[0]),s+=1;var l={element:r,data:{svg:e,root:e.node,state:"none",stateTarget:null,stateOrigin:null,stateTf:null,touchZoom:!1,prevZoomDistance:null},options:t};return l.handlerFunctions=O(l),l}(s,u),n=s.node,a=m.handlerFunctions,"ontouchend"in document.documentElement?(n.addEventListener("touchend",a.mouseOrTouchUp,!1),n.addEventListener("touchcancel",a.mouseOrTouchUp,!1),n.addEventListener("touchstart",a.mouseOrTouchDown,!1),n.addEventListener("touchmove",a.touchMove,!1)):"onmouseup"in document.documentElement&&(n.addEventListener("mouseup",a.mouseOrTouchUp,!1),n.addEventListener("mousedown",a.mouseOrTouchDown,!1),n.addEventListener("mousemove",a.mouseMove,!1),0<=navigator.userAgent.toLowerCase().indexOf("webkit")||0<=navigator.userAgent.toLowerCase().indexOf("trident")?n.addEventListener("mousewheel",a.mouseWheel,!1):n.addEventListener("DOMMouseScroll",a.mouseWheel,!1)),b.dataStore[s.id]=m}switch(o){case l:case d:case h:return void(t&&t(null,m));case c:return r=s.node,i=m.handlerFunctions,"ontouchend"in document.documentElement?(r.removeEventListener("touchend",i.mouseOrTouchUp,!1),r.removeEventListener("touchcancel",i.mouseOrTouchUp,!1),r.removeEventListener("touchstart",i.mouseOrTouchDown,!1),r.removeEventListener("touchmove",i.touchMove,!1)):"onmouseup"in document.documentElement&&(r.removeEventListener("mouseup",i.mouseOrTouchUp,!1),r.removeEventListener("mousedown",i.mouseOrTouchDown,!1),r.removeEventListener("mousemove",i.mouseMove,!1),0<=navigator.userAgent.toLowerCase().indexOf("webkit")||0<=navigator.userAgent.toLowerCase().indexOf("trident")?r.removeEventListener("mousewheel",i.mouseWheel,!1):r.removeEventListener("DOMMouseScroll",i.mouseWheel,!1)),function(e){if(e.parentNode){for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);e.parentNode.removeChild(e)}}(s.node.firstChild),delete b.dataStore[s.id],void(t&&t(null,m));case p:var E=document.getElementById(b.uniqueIdPrefix+s.id).getCTM();return t&&t(null,E),E;case v:return s.zoomTo(1,1e3),void(t&&t(null,m));case f:return b.enable=!b.enable,void(t&&t(null,b.enable))}},t.prototype.zoomTo=function(e,t,o,n){var a,r,i,s,u,l,d,c;e<0||"number"!=typeof e?console.error("zoomTo(arg) should be a number and greater than 0"):("number"!=typeof t&&(t=3e3),b.dataStore.hasOwnProperty(this.id)&&(a=b.dataStore[this.id].element,r=a.node.getTransformToElement(y),i=r.a,s=r.e,u=r.f,l=a.getBBox(),d=parseFloat(l.width)/2,c=parseFloat(l.height)/2,p.animate(i,e,function(e){var t,o=e/i;e!==i&&(r.e=s-(d*o-d),r.f=u-(c*o-c),r.a=e,r.d=e,a.node.setAttribute("transform","matrix("+(t=r).a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")"))},t,o,n)))},t.prototype.panTo=function(e,t,o,n,a){var r,i,s,u,l;b.dataStore.hasOwnProperty(this.id)&&(i=(r=b.dataStore[this.id].element).node.getCTM(),s=d(i.e,e),u=d(i.f,t),l="matrix("+i.a+","+i.b+","+i.c+","+i.d+","+s+","+u+")",r.animate({transform:l},o||10,n||null,function(){a&&a(null,r)}))},t.prototype.rotate=function(e,t,o,n,a,r){var i,s;b.dataStore.hasOwnProperty(this.id)&&((s=(i=b.dataStore[this.id].element).node.getCTM()).a,s.b,s.c,s.d,s.e,s.f,t&&"number"==typeof t||(t=this.node.offsetWidth/2),o&&"number"==typeof o||(o=this.node.offsetHeight/2),i.animate({transform:new p.Matrix(s).rotate(e,t,o)},n||10,a||null,function(){r&&r(null,i)}))}});
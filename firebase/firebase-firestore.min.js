!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(ng){"use strict";try{(function(){var l,t,e=(t=ng)&&"object"==typeof t&&"default"in t?t:{default:t};function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(ge=l=l||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var r={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},i=l.INFO,u=((me={})[l.DEBUG]="log",me[l.VERBOSE]="log",me[l.INFO]="info",me[l.WARN]="warn",me[l.ERROR]="error",me),o=(Object.defineProperty(a.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),a.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(a.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),a.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},a.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},a.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},a.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},a.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},a);function a(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function h(t,e){function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function f(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(h(w,d=Error),w);function w(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(I.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(_,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},I);function I(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var _=/\{\$([^}]+)}/g,E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=N||self;function A(){}function x(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function D(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var O="closure_uid_"+(1e9*Math.random()>>>0),k=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function L(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:L).apply(null,arguments)}function R(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function V(){return Date.now()}function M(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function U(){this.j=this.j,this.i=this.i}U.prototype.j=!1,U.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,O)&&this[O]||(this[O]=++k))},U.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function F(){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function B(t){return/^[\s\xa0]*$/.test(t)}var G=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function z(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}var J=S.navigator;function W(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function X(t){var e,n={};for(e in t)n[e]=t[e];return n}ut=(J=J&&J.userAgent)?J:"";var Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Y.length;i++)e=Y[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function $(t){return $[" "](t),t}$[" "]=A;var Z,tt=z(ut,"Opera"),et=z(ut,"Trident")||z(ut,"MSIE"),nt=z(ut,"Edge"),rt=nt||et,it=z(ut,"Gecko")&&!(z(ut.toLowerCase(),"webkit")&&!z(ut,"Edge"))&&!(z(ut,"Trident")||z(ut,"MSIE"))&&!z(ut,"Edge"),ot=z(ut.toLowerCase(),"webkit")&&!z(ut,"Edge");function st(){var t=S.document;return t?t.documentMode:void 0}var J="",ut=(ut=ut,it?/rv:([^\);]+)(\)|;)/.exec(ut):nt?/Edge\/([\d\.]+)/.exec(ut):et?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):ot?/WebKit\/(\S+)/.exec(ut):tt?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);ut&&(J=ut?ut[1]:""),Z=et&&null!=(ut=st())&&ut>parseFloat(J)?String(ut):J;var at={};function ct(u){return t=u,e=function(){for(var t=0,e=G(String(Z)).split("."),n=G(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=at,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var ht=S.document&&et&&(st()||parseInt(Z,10))||void 0,ft=!et||9<=Number(ht),lt=et&&!ct("9"),pt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",A,e),S.removeEventListener("test",A,e)}catch(t){}return t}();function dt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function yt(t,e){if(dt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(it){t:{try{$(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:vt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}dt.prototype.b=function(){this.defaultPrevented=!0},M(yt,dt);var vt={2:"touch",3:"pen",4:"mouse"};yt.prototype.b=function(){yt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,lt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var gt="closure_listenable_"+(1e6*Math.random()|0),mt=0;function wt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++mt,this.Y=this.Z=!1}function bt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function It(t){this.src=t,this.a={},this.b=0}function _t(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=j(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(bt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Et(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}It.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Et(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new wt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Tt="closure_lm_"+(1e6*Math.random()|0),Nt={};function St(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ct(r),e&&e[gt]?e.wa(n,r,D(i)?!!i.capture:!!i,o):At(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)St(t,e[o],n,r,i);return null}return n=Ct(n),t&&t[gt]?t.va(e,n,D(r)?!!r.capture:!!r,i):At(t,e,n,!1,r,i)}function At(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=D(i)?!!i.capture:!!i;if(s&&!ft)return null;var u,a,c=Pt(t);if(c||(t[Tt]=c=new It(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=kt,r=a=ft?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)pt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Dt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function xt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[gt]?_t(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Dt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Pt(e))?(_t(n,t),0==n.b&&(n.src=null,e[Tt]=null)):bt(t)))}function Dt(t){return t in Nt?Nt[t]:Nt[t]="on"+t}function Ot(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&xt(t),n.call(r,e)}function kt(t,e){if(t.Y)return!0;if(ft)return Ot(t,new yt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ot(t,e=new yt(e,this))}function Pt(t){return(t=t[Tt])instanceof It?t:null}var Lt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ct(e){return"function"==typeof e?e:(e[Lt]||(e[Lt]=function(t){return e.handleEvent(t)}),e[Lt])}function Rt(){U.call(this),this.c=new It(this),(this.J=this).C=null}function Vt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new dt(e,t):e instanceof dt?e.target=e.target||t:(s=e,Q(e=new dt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Mt(o,r,!0,e)&&s;if(s=Mt(o=e.a=t,r,!0,e)&&s,s=Mt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Mt(o=e.a=n[i],r,!1,e)&&s}function Mt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&_t(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}M(Rt,U),Rt.prototype[gt]=!0,(ut=Rt.prototype).addEventListener=function(t,e,n,r){St(this,t,e,n,r)},ut.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=D(i)?!!i.capture:!!i,r=Ct(r),e&&e[gt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Et(s=e.a[n],r,i,o))&&(bt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Pt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Et(n,r,i,o)),(r=-1<e?n[e]:null)&&xt(r))}(this,t,e,n,r)},ut.G=function(){if(Rt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)bt(n[r]);delete e.a[t],e.b--}}this.C=null},ut.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ut.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ut=S.JSON.stringify;function jt(){this.b=this.a=null}var qt,Ft=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Bt},function(t){t.reset()}));function Ht(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Bt(){this.next=this.b=this.a=null}function Gt(t,e){var n;qt||(n=S.Promise.resolve(void 0),qt=function(){n.then(Jt)}),zt||(qt(),zt=!0),Kt.add(t,e)}jt.prototype.add=function(t,e){var n=Ft.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Bt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var zt=!(Bt.prototype.reset=function(){this.next=this.b=this.a=null}),Kt=new jt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Kt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Ft;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}zt=!1}function Wt(t,e){Rt.call(this),this.b=t||1,this.a=e||S,this.f=C(this.Za,this),this.g=V()}function Xt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Yt(t,e,n){if("function"==typeof t)n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}M(Wt,Rt),(ut=Wt.prototype).aa=!1,ut.M=null,ut.Za=function(){var t;this.aa&&(0<(t=V()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Vt(this,"tick"),this.aa&&(Xt(this),this.start())))},ut.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=V())},ut.G=function(){Wt.X.G.call(this),Xt(this),delete this.a};var Qt,$t,Zt=(E($t=ee,J=Qt=U),$t.prototype=null===J?Object.create(J):(te.prototype=J.prototype,new te),ee.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Yt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ee.prototype.G=function(){Qt.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ee);function te(){this.constructor=$t}function ee(t,e){var n=Qt.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ne(t){U.call(this),this.b=t,this.a={}}M(ne,U);var re=[];function ie(t,e,n,r){Array.isArray(n)||(n&&(re[0]=n.toString()),n=re);for(var i=0;i<n.length;i++){var o=St(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function oe(t){W(t.a,function(t,e){this.a.hasOwnProperty(e)&&xt(t)},t),t.a={}}function se(){this.a=!0}function ue(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Ut(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ne.prototype.G=function(){ne.X.G.call(this),oe(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},se.prototype.info=function(){};var ae={},ce=null;function he(){return ce=ce||new Rt}function fe(t){dt.call(this,ae.Fa,t)}function le(){var t=he();Vt(t,new fe(t))}function pe(t,e){dt.call(this,ae.STAT_EVENT,t),this.stat=e}function de(t){var e=he();Vt(e,new pe(e,t))}function ye(t){dt.call(this,ae.Ga,t)}function ve(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}ae.Fa="serverreachability",M(fe,dt),ae.STAT_EVENT="statevent",M(pe,dt),ae.Ga="timingevent",M(ye,dt);var ge={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},me={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function we(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function Ie(){}we.prototype.a=null;var _e,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ee(){dt.call(this,"d")}function Te(){dt.call(this,"c")}function Ne(){}function Se(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ne(this),this.P=Ae,t=rt?125:void 0,this.R=new Wt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}M(Ee,dt),M(Te,dt),M(Ne,we),_e=new Ne;var Ae=45e3,xe={},De={};function Oe(t,e,n){t.H=1,t.i=Qe(ze(e)),t.j=n,t.I=!0,ke(t,null)}function ke(t,e){t.u=V(),Le(t),t.l=ze(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),fn(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new Zt(C(t.Ca,t,t.a),t.O)),ie(t.J,t.a,"readystatechange",t.Xa),e=t.B?X(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),le(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Pe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?De:(i=Number(u.substring(i,o)),isNaN(i)?xe:(o+=1)+i>u.length?De:(u=u.substr(o,i),r.D=o+i,u)));if(u==De){4==e&&(t.h=4,de(14),s=!1),ue(t.c,t.f,null,"[Incomplete Response]");break}if(u==xe){t.h=4,de(15),ue(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ue(t.c,t.f,u,null),Ue(t,u)}4==e&&0==n.length&&(t.h=1,de(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Yn(e),e.F=!0,de(11))):(ue(t.c,t.f,n,"[Invalid Chunked Response]"),Me(t),Ve(t))}function Le(t){t.T=V()+t.P,Ce(t,t.P)}function Ce(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(C(t.Va,t),e)}function Re(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Ve(t){0==t.g.v||t.A||Zn(t.g,t)}function Me(t){Re(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Xt(t.R),oe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ue(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;$n(u),Fn(u)}Xn(u),de(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(C(u.Sa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||$n(u),!B(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(z(r,"spdy")||z(r,"quic")||z(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(wn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Ye(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=V()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(bn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Re(o),Le(o)),n.a=i):Wn(n),0<u.g.length&&Gn(u)):"stop"!=c[0]&&"close"!=c[0]||er(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?er(u,7):qn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);le()}catch(t){}}function je(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Fe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ut=Se.prototype).setTimeout=function(t){this.P=t},ut.Xa=function(t){t=t.target;var e=this.F;e&&3==Vn(t)?e.f():this.Ca(t)},ut.Ca=function(t){try{if(t==this.a)t:{var e=Vn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!rt&&!this.a.$())){this.A||4!=e||7==n||le(),Re(this);var i=this.a.W();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,de(12),Me(this),Ve(this);break t}ue(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ue(this,s)}this.I?(Pe(this,e,n),rt&&this.b&&3==e&&(ie(this.J,this.R,"tick",this.Wa),this.R.start())):(ue(this.c,this.f,n,null),Ue(this,n)),4==e&&Me(this),this.b&&!this.A&&(4==e?Zn(this.g,this):(this.b=!1,Le(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,de(12)):(this.h=0,de(13)),Me(this),Ve(this)}}}catch(t){}var u,a,c,h,f,l},ut.Wa=function(){var t,e;this.a&&(t=Vn(this.a),e=this.a.$(),this.D<e.length&&(Re(this),Pe(this,t,e),this.b&&4!=t&&Le(this)))},ut.cancel=function(){this.A=!0,Me(this)},ut.Va=function(){this.o=null;var t,e,n=V();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(le(),de(17)),Me(this),this.h=2,Ve(this)):Ce(this,this.T-n)},(ut=qe.prototype).K=function(){Fe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ut.L=function(){return Fe(this),this.a.concat()},ut.get=function(t,e){return He(this.b,t)?this.b[t]:e},ut.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ut.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Be=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ge(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ge?(this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,Je(this,t.c),We(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new qe(e.a),n.b=e.b),Xe(this,n),this.i=t.i):t&&(n=String(t).match(Be))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=$e(n[2]||""),Je(this,n[3]||"",!0),We(this,n[4]),this.g=$e(n[5]||"",!0),Xe(this,n[6]||"",!0),this.i=$e(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function ze(t){return new Ge(t)}function Ke(t,e,n){t.f=n?$e(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?$e(e,!0):e}function We(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Xe(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(cn(this,e),fn(this,n,t))},r)),r.f=i):(n||(e=Ze(e,on)),t.b=new un(e,t.a))}function Ye(t,e,n){t.b.set(e,n)}function Qe(t){return Ye(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^V()).toString(36)),t}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ge.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ze(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ze(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new qe,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function cn(t,e){an(t),e=ln(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Fe(t)))}function hn(t,e){return an(t),e=ln(t,e),He(t.a.b,e)}function fn(t,e,n){cn(t,e),0<n.length&&(t.c=null,t.a.set(ln(t,e),H(n)),t.b+=n.length)}function ln(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(ut=un.prototype).add=function(t,e){an(this),this.c=null,t=ln(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ut.forEach=function(n,r){an(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},ut.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ut.K=function(t){an(this);var e=[];if("string"==typeof t)hn(this,t)&&(e=F(e,this.a.get(ln(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=F(e,t[n])}return e},ut.set=function(t,e){return an(this),this.c=null,hn(this,t=ln(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ut.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},ut.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function bn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function In(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return H(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function _n(){}function En(){this.a=new _n}function Tn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=In(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},_n.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},_n.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Nn=S.JSON.parse;function Sn(t){Rt.call(this),this.headers=new qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=An,this.D=this.F=!1}M(Sn,Rt);var An="",xn=/^https?$/i,Dn=["POST","PUT"];function On(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Pn(t),Cn(t)}function Pn(t){t.u||(t.u=!0,Vt(t,"complete"),Vt(t,"error"))}function Ln(t){if(t.b&&(!t.s[1]||4!=Vn(t)||2!=t.W()))if(t.l&&4==Vn(t))Yt(t.za,0,t);else if(Vt(t,"readystatechange"),4==Vn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Be)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!xn.test(i?i.toLowerCase():"")),e=n),e)Vt(t,"complete"),Vt(t,"success");else{t.h=6;try{var u=2<Vn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Pn(t)}}finally{Cn(t)}}}function Cn(t,e){if(t.a){Rn(t);var n=t.a,r=t.s[0]?A:null;t.a=null,t.s=null,e||Vt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Rn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Vn(t){return t.a?t.a.readyState:0}function Mn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",W(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ye(t,e,n))}function Un(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function jn(t){this.pa=0,this.g=[],this.c=new se,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Un("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Un("baseRetryDelayMs",5e3,t),this.Ra=Un("retryDelaySeedMs",1e4,t),this.Ma=Un("forwardChannelMaxRetries",2,t),this.ma=Un("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new En,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function qn(t){var e,n;Hn(t),3==t.v&&(e=t.R++,Ye(n=ze(t.B),"SID",t.J),Ye(n,"RID",e),Ye(n,"TYPE","terminate"),Kn(t,n),(e=new Se(t,t.c,e,void 0)).H=2,e.i=Qe(ze(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=V(),Le(e)),nr(t)}function Fn(t){t.a&&(Yn(t),t.a.cancel(),t.a=null)}function Hn(t){Fn(t),t.j&&(S.clearTimeout(t.j),t.j=null),$n(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Bn(t,e){t.g.push(new pn(t.Oa++,e)),3==t.v&&Gn(t)}function Gn(t){vn(t.b)||t.h||(t.h=!0,Gt(t.Ba,t),t.u=0)}function zn(t,e){var n=e?e.f:t.R++,r=ze(t.B);Ye(r,"SID",t.J),Ye(r,"RID",n),Ye(r,"AID",t.P),Kn(t,r),t.i&&t.l&&Mn(r,t.i,t.l),n=new Se(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),wn(t.b,n),Oe(n,r,e)}function Kn(t,n){t.f&&je({},function(t,e){Ye(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{je(t,function(t,e){var n=t;D(t)&&(n=Ut(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Wn(t){t.a||t.j||(t.T=1,Gt(t.Aa,t),t.o=0)}function Xn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(C(t.Aa,t),tr(t,t.o)),t.o++,1)}function Yn(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function Qn(t){t.a=new Se(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=ze(t.la);Ye(e,"RID","rpc"),Ye(e,"SID",t.J),Ye(e,"CI",t.H?"0":"1"),Ye(e,"AID",t.P),Kn(t,e),Ye(e,"TYPE","xmlhttp"),t.i&&t.l&&Mn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Qe(ze(e)),n.j=null,n.I=!0,ke(n,t)}function $n(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function Zn(t,e){var n,r,i,o=null;if(t.a==e){$n(t),Yn(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,bn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=V()-e.u,n=t.u,Vt(s=he(),new ye(s)),Gn(t)):Wn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=ve(C(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Xn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Ya,t),r||(r=new Ge("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Ke(r,"https"),Qe(r)),n=r.toString(),r=o,o=new se,S.Image?((i=new Image).onload=R(Tn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=R(Tn,o,i,"TestLoadImage: error",!1,r),i.onabort=R(Tn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=R(Tn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(2),t.v=0,t.f&&t.f.ra(e),nr(t),Hn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==In(t.b).length&&0==t.g.length||(t.b.c.length=0,H(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ge?ze(s):new Ge(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),We(a,a.h)):(r=(u=S.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ge(null,void 0),r&&Ke(u,r),i&&Je(u,i),o&&We(u,o),s&&(u.g=s),a=u),t.V&&W(t.V,function(t,e){Ye(a,e,t)}),e=t.A,n=t.na,e&&n&&Ye(a,e,n),Ye(a,"VER",t.ha),Kn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Sn(t.Na)).F=t.C,e}function or(){}function sr(){if(et&&!(10<=Number(ht)))throw Error("Environmental error: no available transport.")}function ur(t,e){Rt.call(this),this.a=new jn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!B(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!B(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new hr(this)}function ar(t){Ee.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function cr(){Te.call(this),this.status=1}function hr(t){this.a=t}(ut=Sn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?be(this.H):be(_e),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void kn(this,t)}t=n||"";var i,o=new qe(this.headers);r&&je(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=On,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=j(Dn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Rn(this),0<this.o&&((this.D=(i=this.a,et&&ct(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=Yt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){kn(this,t)}},ut.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Vt(this,"timeout"),this.abort(8))},ut.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Vt(this,"complete"),Vt(this,"abort"),Cn(this))},ut.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Cn(this,!0)),Sn.X.G.call(this)},ut.za=function(){this.j||(this.A||this.l||this.g?Ln(this):this.Ua())},ut.Ua=function(){Ln(this)},ut.W=function(){try{return 2<Vn(this)?this.a.status:-1}catch(t){return-1}},ut.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},ut.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Nn(e)}},ut.ua=function(){return this.h},ut.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(ut=jn.prototype).ha=8,ut.v=1,ut.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Se(this,this.c,t,void 0),r=this.l;if(this.O&&(r?Q(r=X(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),Ye(i=ze(this.B),"RID",t),Ye(i,"CVER",22),this.A&&Ye(i,"X-HTTP-Session-Id",this.A),Kn(this,i),this.i&&r&&Mn(i,this.i,r),wn(this.b,n),this.Ia&&Ye(i,"TYPE","init"),this.da?(Ye(i,"$req",e),Ye(i,"SID","null"),n.U=!0,Oe(n,i,null)):Oe(n,i,e),this.v=2}}else 3==this.v&&(t?zn(this,t):0==this.g.length||vn(this.b)||zn(this))},ut.Aa=function(){var t;this.j=null,Qn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(C(this.Ta,this),t))},ut.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(10),Fn(this),Qn(this))},ut.Sa=function(){null!=this.m&&(this.m=null,Fn(this),Xn(this),de(19))},ut.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),de(2)):(this.c.info("Failed to ping google.com"),de(1))},(ut=or.prototype).ta=function(){},ut.sa=function(){},ut.ra=function(){},ut.qa=function(){},ut.Ja=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},M(ur,Rt),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),Gn(t)},ur.prototype.close=function(){qn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Bn(this.a,e)):this.l?((e={}).__data__=Ut(t),Bn(this.a,e)):Bn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,qn(this.a),delete this.a,ur.X.G.call(this)},M(ar,Ee),M(cr,Te),M(hr,or),hr.prototype.ta=function(){Vt(this.a,"a")},hr.prototype.sa=function(t){Vt(this.a,new ar(t))},hr.prototype.ra=function(t){Vt(this.a,new cr)},hr.prototype.qa=function(){Vt(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(Ie.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Rt.prototype.listen=Rt.prototype.va,Sn.prototype.listenOnce=Sn.prototype.wa,Sn.prototype.getLastError=Sn.prototype.Qa,Sn.prototype.getLastErrorCode=Sn.prototype.ua,Sn.prototype.getStatus=Sn.prototype.W,Sn.prototype.getResponseJson=Sn.prototype.Pa,Sn.prototype.getResponseText=Sn.prototype.$,Sn.prototype.send=Sn.prototype.ba;var fr=he,lr=ge,pr=me,dr=ae,yr=Ie,vr=Sn,gr=new o("@firebase/firestore");function mr(){return gr.logLevel}function wr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];gr.logLevel<=l.DEBUG&&(e=n.map(_r),gr.debug.apply(gr,f(["Firestore (8.2.3): "+t],e)))}function br(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];gr.logLevel<=l.ERROR&&(e=n.map(_r),gr.error.apply(gr,f(["Firestore (8.2.3): "+t],e)))}function Ir(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];gr.logLevel<=l.WARN&&(e=n.map(_r),gr.warn.apply(gr,f(["Firestore (8.2.3): "+t],e)))}function _r(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Er(t){throw void 0===t&&(t="Unexpected state"),br(t="FIRESTORE (8.2.3) INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Tr(t){t||Er()}var Nr=(Sr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Sr);function Sr(){}function Ar(t,e){return t<e?-1:e<t?1:0}function xr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Dr(t){return t+"\0"}var Or=(kr.fromBase64String=function(t){return new kr(atob(t))},kr.fromUint8Array=function(t){return new kr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},kr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},kr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},kr.prototype.o=function(){return 2*this.i.length},kr.prototype.u=function(t){return Ar(this.i,t.i)},kr.prototype.isEqual=function(t){return this.i===t.i},kr);function kr(t){this.i=t}Or.h=new Or("");var Pr,Lr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Cr=(h(Ur,Pr=Error),Ur),Rr=(Mr.fromBase64String=function(t){try{return new Mr(Or.fromBase64String(t))}catch(t){throw new Cr(Lr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Mr.fromUint8Array=function(t){return new Mr(Or.fromUint8Array(t))},Mr.prototype.toBase64=function(){return this.l.toBase64()},Mr.prototype.toUint8Array=function(){return this.l.toUint8Array()},Mr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Mr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Mr),Vr=function(t){this._=t};function Mr(t){this.l=t}function Ur(t,e){var n=this;return(n=Pr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function jr(){if("undefined"==typeof Uint8Array)throw new Cr(Lr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function qr(){if("undefined"==typeof atob)throw new Cr(Lr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Fr,Hr=(h(Wr,Fr=Vr),Wr.fromBase64String=function(t){return qr(),new Wr(Rr.fromBase64String(t))},Wr.fromUint8Array=function(t){return jr(),new Wr(Rr.fromUint8Array(t))},Wr.prototype.toBase64=function(){return qr(),this._.toBase64()},Wr.prototype.toUint8Array=function(){return jr(),this._.toUint8Array()},Wr.prototype.isEqual=function(t){return this._.isEqual(t._)},Wr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Wr),Br=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},Gr=(Object.defineProperty(Jr.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Jr.prototype.isEqual=function(t){return t instanceof Jr&&t.projectId===this.projectId&&t.database===this.database},Jr),zr=(Kr.prototype.A=function(){return null!=this.uid},Kr.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},Kr.prototype.isEqual=function(t){return t.uid===this.uid},Kr);function Kr(t){this.uid=t}function Jr(t,e){this.projectId=t,this.database=e||"(default)"}function Wr(){return null!==Fr&&Fr.apply(this,arguments)||this}function Xr(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t}zr.UNAUTHENTICATED=new zr(null),zr.P=new zr("google-credentials-uid"),zr.g=new zr("first-party-uid");var Yr=(oi.prototype.getToken=function(){return Promise.resolve(null)},oi.prototype.v=function(){},oi.prototype.S=function(t){(this.p=t)(zr.UNAUTHENTICATED)},oi.prototype.D=function(){this.p=null},oi),Qr=(ii.prototype.getToken=function(){var e=this,n=this.O,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.O!==n?(wr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Tr("string"==typeof t.accessToken),new Xr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},ii.prototype.v=function(){this.forceRefresh=!0},ii.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},ii.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},ii.prototype.F=function(){var t=this.auth&&this.auth.getUid();return Tr(null===t||"string"==typeof t),new zr(t)},ii),$r=(Object.defineProperty(ri.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),ri),Zr=(ni.prototype.getToken=function(){return Promise.resolve(new $r(this.k,this.M))},ni.prototype.S=function(t){t(zr.g)},ni.prototype.D=function(){},ni.prototype.v=function(){},ni),ti=(ei.prototype.$=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ei.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},ei);function ei(t,e){var n=this;this.previousValue=t,e&&(e.L=function(t){return n.$(t)},this.B=function(t){return e.q(t)})}function ni(t,e){this.k=t,this.M=e}function ri(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=zr.g}function ii(t){var e=this;this.C=null,this.currentUser=zr.UNAUTHENTICATED,this.N=!1,this.O=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.O++,e.currentUser=e.F(),e.N=!0,e.p&&e.p(e.currentUser)},this.O=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}function oi(){this.p=null}ti.U=-1;var si,ui,ai=(wi.now=function(){return wi.fromMillis(Date.now())},wi.fromDate=function(t){return wi.fromMillis(t.getTime())},wi.fromMillis=function(t){var e=Math.floor(t/1e3);return new wi(e,1e6*(t-1e3*e))},wi.prototype.toDate=function(){return new Date(this.toMillis())},wi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},wi.prototype.K=function(t){return this.seconds===t.seconds?Ar(this.nanoseconds,t.nanoseconds):Ar(this.seconds,t.seconds)},wi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},wi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},wi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},wi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},wi),ci=(mi.j=function(t){return new mi(t)},mi.min=function(){return new mi(new ai(0,0))},mi.prototype.u=function(t){return this.timestamp.K(t.timestamp)},mi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},mi.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},mi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},mi.prototype.G=function(){return this.timestamp},mi),me=(Object.defineProperty(gi.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),gi.prototype.isEqual=function(t){return 0===gi.J(this,t)},gi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof gi?t.forEach(function(t){e.push(t)}):e.push(t),this.Y(e)},gi.prototype.limit=function(){return this.offset+this.length},gi.prototype.X=function(t){return t=void 0===t?1:t,this.Y(this.segments,this.offset+t,this.length-t)},gi.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},gi.prototype.tt=function(){return this.segments[this.offset]},gi.prototype.et=function(){return this.get(this.length-1)},gi.prototype.get=function(t){return this.segments[this.offset+t]},gi.prototype.nt=function(){return 0===this.length},gi.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},gi.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},gi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},gi.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},gi.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},gi),hi=(h(vi,ui=me),vi.prototype.Y=function(t,e,n){return new vi(t,e,n)},vi.prototype.ot=function(){return this.rt().join("/")},vi.prototype.toString=function(){return this.ot()},vi.ct=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Cr(Lr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new vi(n)},vi.at=function(){return new vi([])},vi),fi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,li=(h(yi,si=me),yi.prototype.Y=function(t,e,n){return new yi(t,e,n)},yi.ut=function(t){return fi.test(t)},yi.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yi.ut(t)||(t="`"+t+"`"),t}).join(".")},yi.prototype.toString=function(){return this.ot()},yi.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},yi.lt=function(){return new yi(["__name__"])},yi._t=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Cr(Lr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Cr(Lr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Cr(Lr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Cr(Lr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new yi(e)},yi.at=function(){return new yi([])},yi),pi=(di.ft=function(t){return new di(hi.ct(t))},di.dt=function(t){return new di(hi.ct(t).X(5))},di.prototype.wt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},di.prototype.isEqual=function(t){return null!==t&&0===hi.J(this.path,t.path)},di.prototype.toString=function(){return this.path.toString()},di.J=function(t,e){return hi.J(t.path,e.path)},di.Et=function(t){return t.length%2==0},di.Tt=function(t){return new di(new hi(t.slice()))},di);function di(t){this.path=t}function yi(){return null!==si&&si.apply(this,arguments)||this}function vi(){return null!==ui&&ui.apply(this,arguments)||this}function gi(t,e,n){void 0===e?e=0:e>t.length&&Er(),void 0===n?n=t.length-e:n>t.length-e&&Er(),this.segments=t,this.offset=e,this.H=n}function mi(t){this.timestamp=t}function wi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Cr(Lr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Cr(Lr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Cr(Lr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Cr(Lr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function bi(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Ii(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function _i(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ei=(Ni.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},Ni.prototype.isEqual=function(t){return xr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ni),Ti=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ni(t){(this.fields=t).sort(li.J)}function Si(t){if(Tr(!!t),"string"!=typeof t)return{seconds:Ai(t.seconds),nanos:Ai(t.nanos)};var e=0,n=Ti.exec(t);return Tr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Ai(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function xi(t){return"string"==typeof t?Or.fromBase64String(t):Or.fromUint8Array(t)}function Di(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Oi(t){return t=Si(t.mapValue.fields.__local_write_time__.timestampValue),new ai(t.seconds,t.nanos)}function ki(t){return null==t}function Pi(t){return 0===t&&1/t==-1/0}function Li(t){return"number"==typeof t&&Number.isInteger(t)&&!Pi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Ci(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Di(t)?4:10:Er()}function Ri(r,i){var t,e=Ci(r);if(e!==Ci(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Oi(r).isEqual(Oi(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Si(r.timestampValue),t=Si(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,xi(r.bytesValue).isEqual(xi(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Ai((t=r).geoPointValue.latitude)===Ai(e.geoPointValue.latitude)&&Ai(t.geoPointValue.longitude)===Ai(e.geoPointValue.longitude);case 2:return t=i,"integerValue"in(e=r)&&"integerValue"in t?Ai(e.integerValue)===Ai(t.integerValue):"doubleValue"in e&&"doubleValue"in t&&((e=Ai(e.doubleValue))===(t=Ai(t.doubleValue))?Pi(e)===Pi(t):isNaN(e)&&isNaN(t));case 9:return xr(r.arrayValue.values||[],i.arrayValue.values||[],Ri);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(bi(e)!==bi(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Ri(e[t],n[t])))return!1;return!0}();default:return Er()}}function Vi(t,e){return void 0!==(t.values||[]).find(function(t){return Ri(t,e)})}function Mi(t,e){var n,r,i,o=Ci(t),s=Ci(e);if(o!==s)return Ar(o,s);switch(o){case 0:return 0;case 1:return Ar(t.booleanValue,e.booleanValue);case 2:return n=e,(r=Ai(t.integerValue||t.doubleValue))<(n=Ai(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Ui(t.timestampValue,e.timestampValue);case 4:return Ui(Oi(t),Oi(e));case 5:return Ar(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,s=e.bytesValue,i=xi(i),s=xi(s),i.u(s);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ar(n[i],r[i]);if(0!==o)return o}return Ar(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=Ar(Ai(o.latitude),Ai(r.latitude)))?n:Ar(Ai(o.longitude),Ai(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Mi(n[i],r[i]);if(o)return o}return Ar(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ar(r[s],o[s]);if(0!==u)return u;if(0!==(u=Mi(n[r[s]],i[o[s]])))return u}return Ar(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Er()}}function Ui(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ar(t,e);var n=Si(t),t=Si(e);return 0!==(e=Ar(n.seconds,t.seconds))?e:Ar(n.nanos,t.nanos)}function ji(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Si(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?xi(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,pi.dt(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Er();var t,e}(t)}function qi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function Fi(t){return t&&"integerValue"in t}function Hi(t){return!!t&&"arrayValue"in t}function Bi(t){return t&&"nullValue"in t}function Gi(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function zi(t){return t&&"mapValue"in t}var Ki=(Xi.empty=function(){return new Xi({mapValue:{}})},Xi.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!zi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},Xi.prototype.isEqual=function(t){return Ri(this.proto,t.proto)},Xi),Ji=(Wi.prototype.set=function(t,e){return this.Pt(t,e),this},Wi.prototype.delete=function(t){return this.Pt(t,null),this},Wi.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Ci(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.et(),e)},Wi.prototype.yt=function(){var t=this.gt(li.at(),this.Rt);return null!=t?new Ki(t):this.At},Wi.prototype.gt=function(r,t){var i=this,o=!1,e=this.At.field(r),s=zi(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.gt(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Wi);function Wi(t){void 0===t&&(t=Ki.empty()),this.At=t,this.Rt=new Map}function Xi(t){this.proto=t}var Yi,Qi,$i,Zi=(h(oo,$i=o=function(t,e){this.key=t,this.version=e}),oo.prototype.field=function(t){return this.Vt.field(t)},oo.prototype.data=function(){return this.Vt},oo.prototype.vt=function(){return this.Vt.proto},oo.prototype.isEqual=function(t){return t instanceof oo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},oo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(oo.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),oo),to=(h(io,Qi=o),io.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(io.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),io.prototype.isEqual=function(t){return t instanceof io&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},io),eo=(h(ro,Yi=o),ro.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(ro.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),ro.prototype.isEqual=function(t){return t instanceof ro&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ro),no=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function ro(){return null!==Yi&&Yi.apply(this,arguments)||this}function io(t,e,n){var r=this;return(r=Qi.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function oo(t,e,n,r){var i=this;return(i=$i.call(this,t,e)||this).Vt=n,i.bt=!!r.bt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function so(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new no(t,e,n,r,i,o,s)}function uo(t){var e=t;return null===e.St&&(t=e.path.ot(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.ot()+t.op.toString()+ji(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.ot()+t.dir}).join(","),ki(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Mo(e.startAt)),e.endAt&&(t+="|ub:",t+=Mo(e.endAt)),e.St=t),e.St}function ao(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Ri(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!qo(t.startAt,e.startAt)&&qo(t.endAt,e.endAt)}function co(t){return pi.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var ho,fo=(h(lo,ho=function(){}),lo.create=function(t,e,n){return t.ht()?"in"===e||"not-in"===e?this.Dt(t,e,n):new go(t,e,n):"array-contains"===e?new xo(t,n):"in"===e?new Do(t,n):"not-in"===e?new Oo(t,n):"array-contains-any"===e?new ko(t,n):new lo(t,e,n)},lo.Dt=function(t,e,n){return new("in"===e?mo:wo)(t,n)},lo.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.Ct(Mi(t,this.value)):null!==t&&Ci(this.value)===Ci(t)&&this.Ct(Mi(t,this.value))},lo.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Er()}},lo.prototype.xt=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},lo);function lo(t,e,n){var r=this;return(r=ho.call(this)||this).field=t,r.op=e,r.value=n,r}var po,yo,vo,go=(h(_o,vo=fo),_o.prototype.matches=function(t){return t=pi.J(t.key,this.key),this.Ct(t)},_o),mo=(h(Io,yo=fo),Io.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Io),wo=(h(bo,po=fo),bo.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},bo);function bo(t,e){var n=this;return(n=po.call(this,t,"not-in",e)||this).keys=Eo(0,e),n}function Io(t,e){var n=this;return(n=yo.call(this,t,"in",e)||this).keys=Eo(0,e),n}function _o(t,e,n){var r=this;return(r=vo.call(this,t,e,n)||this).key=pi.dt(n.referenceValue),r}function Eo(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return pi.dt(t.referenceValue)})}var To,No,So,Ao,xo=(h(Vo,Ao=fo),Vo.prototype.matches=function(t){return Hi(t=t.field(this.field))&&Vi(t.arrayValue,this.value)},Vo),Do=(h(Ro,So=fo),Ro.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Vi(this.value.arrayValue,t)},Ro),Oo=(h(Co,No=fo),Co.prototype.matches=function(t){return!Vi(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Vi(this.value.arrayValue,t))},Co),ko=(h(Lo,To=fo),Lo.prototype.matches=function(t){var e=this;return!(!Hi(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Vi(e.value.arrayValue,t)})},Lo),Po=function(t,e){this.position=t,this.before=e};function Lo(t,e){return To.call(this,t,"array-contains-any",e)||this}function Co(t,e){return No.call(this,t,"not-in",e)||this}function Ro(t,e){return So.call(this,t,"in",e)||this}function Vo(t,e){return Ao.call(this,t,"array-contains",e)||this}function Mo(t){return(t.before?"b":"a")+":"+t.position.map(ji).join(",")}var Uo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function jo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.ht()?pi.J(pi.dt(s.referenceValue),n.key):Mi(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function qo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Ri(t.position[n],e.position[n]))return!1;return!0}var Fo=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ot=null,this.Ft=null,this.startAt,this.endAt};function Ho(t,e,n,r,i,o,s,u){return new Fo(t,e,n,r,i,o,s,u)}function Bo(t){return new Fo(t)}function Go(t){return!ki(t.limit)&&"F"===t.limitType}function zo(t){return!ki(t.limit)&&"L"===t.limitType}function Ko(t){return 0<t.Nt.length?t.Nt[0].field:null}function Jo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function Wo(t){return null!==t.collectionGroup}function Xo(t){var e=t;if(null===e.Ot){e.Ot=[];var n=Jo(e),t=Ko(e);if(null!==n&&null===t)n.ht()||e.Ot.push(new Uo(n)),e.Ot.push(new Uo(li.lt(),"asc"));else{for(var r=!1,i=0,o=e.Nt;i<o.length;i++){var s=o[i];e.Ot.push(s),s.field.ht()&&(r=!0)}r||(n=0<e.Nt.length?e.Nt[e.Nt.length-1].dir:"asc",e.Ot.push(new Uo(li.lt(),n)))}}return e.Ot}function Yo(t){var e=t;if(!e.Ft)if("F"===e.limitType)e.Ft=so(e.path,e.collectionGroup,Xo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Xo(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Uo(o.field,s))}var u=e.endAt?new Po(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Po(e.startAt.position,!e.startAt.before):null;e.Ft=so(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ft}function Qo(t,e,n){return new Fo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function $o(t,e){return ao(Yo(t),Yo(e))&&t.limitType===e.limitType}function Zo(t){return uo(Yo(t))+"|lt:"+t.limitType}function ts(t){return"Query(target="+(n=(e=Yo(t)).path.ot(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.ot()+" "+t.op+" "+ji(t.value)}).join(", ")+"]"),ki(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.ot()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Mo(e.startAt)),e.endAt&&(n+=", endAt: "+Mo(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function es(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.wt(e.collectionGroup)&&e.path.st(n):pi.Et(e.path)?e.path.isEqual(n):e.path.it(n))&&function(t){for(var e=0,n=i.Nt;e<n.length;e++){var r=n[e];if(!r.field.ht()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||jo(t.startAt,Xo(t),n))&&(!t.endAt||!jo(t.endAt,Xo(t),n)));var e,n}function ns(u){return function(t,e){for(var n=!1,r=0,i=Xo(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i;switch(n=t.field.ht()?pi.J(e.key,n.key):(r=t.field,i=n,e=e.field(r),r=i.field(r),null!==e&&null!==r?Mi(e,r):Er()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Er()}}(o,t,e);if(0!==s)return s;n=n||o.field.ht()}return 0}}var rs=(is.prototype.Lt=function(t){return new is(this.target,this.targetId,this.kt,t,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},is.prototype.$t=function(t,e){return new is(this.target,this.targetId,this.kt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},is.prototype.Bt=function(t){return new is(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,t,this.resumeToken)},is);function is(t,e,n,r,i,o,s){void 0===i&&(i=ci.min()),void 0===o&&(o=ci.min()),void 0===s&&(s=Or.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function os(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pi(e)?"-0":e}}function ss(t){return{integerValue:""+t}}function us(t,e){return Li(e)?ss(e):os(t,e)}function as(t,e){return t instanceof Is?Fi(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var cs,hs,fs=(h(ds,hs=me=function(){this.Ut=void 0}),ds),ls=(h(ps,cs=me),ps);function ps(t){var e=this;return(e=cs.call(this)||this).elements=t,e}function ds(){return null!==hs&&hs.apply(this,arguments)||this}function ys(t,e){for(var n=Ts(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Ri(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var vs,gs=(h(ms,vs=me),ms);function ms(t){var e=this;return(e=vs.call(this)||this).elements=t,e}function ws(t,e){for(var n=Ts(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Ri(t,e)})}(i[r]);return{arrayValue:{values:n}}}var bs,Is=(h(_s,bs=me),_s);function _s(t,e){var n=this;return(n=bs.call(this)||this).Kt=t,n.Qt=e,n}function Es(t){return Ai(t.integerValue||t.doubleValue)}function Ts(t){return Hi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ns(t,e){this.version=t,this.transformResults=e}var Ss=function(t,e){this.field=t,this.transform=e},As=(xs.jt=function(){return new xs},xs.exists=function(t){return new xs(void 0,t)},xs.updateTime=function(t){return new xs(t)},Object.defineProperty(xs.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),xs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},xs);function xs(t,e){this.updateTime=t,this.exists=e}function Ds(t,e){return void 0!==t.updateTime?e instanceof Zi&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Zi}function Os(t,e,n,r){return t instanceof Rs?function(t,e,n){if(!Ds(t.Gt,e))return e;var r=t.value,n=Fs(t.fieldTransforms,n,e),r=Hs(t.fieldTransforms,r,n),e=Ps(e);return new Zi(t.key,e,r,{bt:!0})}(t,e,r):t instanceof Vs?function(t,e,n){if(!Ds(t.Gt,e))return e;var r=Ps(e),e=js(t,e,Fs(t.fieldTransforms,n,e));return new Zi(t.key,r,e,{bt:!0})}(t,e,r):Ds(t.Gt,e)?new to(t.key,ci.min()):e}function ks(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&xr(n,r,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ls&&e instanceof ls||t instanceof gs&&e instanceof gs?xr(t.elements,e.elements,Ri):t instanceof Is&&e instanceof Is?Ri(t.Qt,e.Qt):t instanceof fs&&e instanceof fs)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt));var n,r}function Ps(t){return t instanceof Zi?t.version:ci.min()}var Ls,Cs,Rs=(h(Us,Cs=o=function(){}),Us),Vs=(h(Ms,Ls=o),Ms);function Ms(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=Ls.call(this)||this).key=t,o.data=e,o.zt=n,o.Gt=r,o.fieldTransforms=i,o.type=1,o}function Us(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=Cs.call(this)||this).key=t,i.value=e,i.Gt=n,i.fieldTransforms=r,i.type=0,i}function js(t,e,n){var r,i,o=t;return e=e instanceof Zi?e.data():Ki.empty(),i=new Ji(e),o.zt.fields.forEach(function(t){var e;t.nt()||(null!==(e=o.data.field(t))?i.set(t,e):i.delete(t))}),r=i.yt(),Hs(t.fieldTransforms,r,n)}function qs(t,e,n){var r=[];Tr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Zi&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ls?ys(o,s):o instanceof gs?ws(o,s):u))}return r}function Fs(t,e,n){for(var r,i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Zi&&(c=n.field(u.field)),i.push((r=c,u=e,c=void 0,a instanceof fs?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:u.seconds,nanos:u.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):a instanceof ls?ys(a,r):a instanceof gs?ws(a,r):(r=Es(a=as(c=a,r))+Es(c.Qt),Fi(a)&&Fi(c.Qt)?ss(r):os(c.Kt,r))))}return i}function Hs(t,e,n){for(var r=new Ji(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.yt()}function Bs(t){this.count=t}var Gs,zs,Ks,Js=(h(Ys,Ks=o),Ys),Ws=(h(Xs,zs=o),Xs);function Xs(t,e){var n=this;return(n=zs.call(this)||this).key=t,n.Gt=e,n.type=3,n.fieldTransforms=[],n}function Ys(t,e){var n=this;return(n=Ks.call(this)||this).key=t,n.Gt=e,n.type=2,n.fieldTransforms=[],n}function Qs(t){switch(t){case Lr.OK:return Er(),0;case Lr.CANCELLED:case Lr.UNKNOWN:case Lr.DEADLINE_EXCEEDED:case Lr.RESOURCE_EXHAUSTED:case Lr.INTERNAL:case Lr.UNAVAILABLE:case Lr.UNAUTHENTICATED:return;case Lr.INVALID_ARGUMENT:case Lr.NOT_FOUND:case Lr.ALREADY_EXISTS:case Lr.PERMISSION_DENIED:case Lr.FAILED_PRECONDITION:case Lr.ABORTED:case Lr.OUT_OF_RANGE:case Lr.UNIMPLEMENTED:case Lr.DATA_LOSS:return 1;default:return Er(),0}}function $s(t){if(void 0===t)return br("GRPC error has no .code"),Lr.UNKNOWN;switch(t){case Gs.OK:return Lr.OK;case Gs.CANCELLED:return Lr.CANCELLED;case Gs.UNKNOWN:return Lr.UNKNOWN;case Gs.DEADLINE_EXCEEDED:return Lr.DEADLINE_EXCEEDED;case Gs.RESOURCE_EXHAUSTED:return Lr.RESOURCE_EXHAUSTED;case Gs.INTERNAL:return Lr.INTERNAL;case Gs.UNAVAILABLE:return Lr.UNAVAILABLE;case Gs.UNAUTHENTICATED:return Lr.UNAUTHENTICATED;case Gs.INVALID_ARGUMENT:return Lr.INVALID_ARGUMENT;case Gs.NOT_FOUND:return Lr.NOT_FOUND;case Gs.ALREADY_EXISTS:return Lr.ALREADY_EXISTS;case Gs.PERMISSION_DENIED:return Lr.PERMISSION_DENIED;case Gs.FAILED_PRECONDITION:return Lr.FAILED_PRECONDITION;case Gs.ABORTED:return Lr.ABORTED;case Gs.OUT_OF_RANGE:return Lr.OUT_OF_RANGE;case Gs.UNIMPLEMENTED:return Lr.UNIMPLEMENTED;case Gs.DATA_LOSS:return Lr.DATA_LOSS;default:return Er()}}(me=Gs={})[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";var Zs=(iu.prototype.Ht=function(t,e){return new iu(this.J,this.root.Ht(t,e,this.J).copy(null,null,eu.Jt,null,null))},iu.prototype.remove=function(t){return new iu(this.J,this.root.remove(t,this.J).copy(null,null,eu.Jt,null,null))},iu.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},iu.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},iu.prototype.nt=function(){return this.root.nt()},Object.defineProperty(iu.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),iu.prototype.Yt=function(){return this.root.Yt()},iu.prototype.Xt=function(){return this.root.Xt()},iu.prototype.Zt=function(t){return this.root.Zt(t)},iu.prototype.forEach=function(n){this.Zt(function(t,e){return n(t,e),!1})},iu.prototype.toString=function(){var n=[];return this.Zt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},iu.prototype.te=function(t){return this.root.te(t)},iu.prototype.ee=function(){return new tu(this.root,null,this.J,!1)},iu.prototype.ne=function(t){return new tu(this.root,t,this.J,!1)},iu.prototype.se=function(){return new tu(this.root,null,this.J,!0)},iu.prototype.ie=function(t){return new tu(this.root,t,this.J,!0)},iu),tu=(ru.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},ru.prototype.ae=function(){return 0<this.oe.length},ru.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},ru),eu=(nu.prototype.copy=function(t,e,n,r,i){return new nu(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},nu.prototype.nt=function(){return!1},nu.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},nu.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},nu.prototype.min=function(){return this.left.nt()?this:this.left.min()},nu.prototype.Yt=function(){return this.min().key},nu.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},nu.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},nu.prototype.le=function(){if(this.left.nt())return nu.EMPTY;var t=this;return t.left._e()||t.left.left._e()||(t=t.fe()),(t=t.copy(null,null,null,t.left.le(),null)).he()},nu.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.nt()||r.left._e()||r.left.left._e()||(r=r.fe()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left._e()&&(r=r.de()),r.right.nt()||r.right._e()||r.right.left._e()||(r=r.we()),0===e(t,r.key)){if(r.right.nt())return nu.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.le())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.he()},nu.prototype._e=function(){return this.color},nu.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},nu.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},nu.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},nu.prototype.Ee=function(){var t=this.copy(null,null,nu.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},nu.prototype.de=function(){var t=this.copy(null,null,nu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},nu.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},nu.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},nu.prototype.me=function(){if(this._e()&&this.left._e())throw Er();if(this.right._e())throw Er();var t=this.left.me();if(t!==this.right.me())throw Er();return t+(this._e()?0:1)},nu);function nu(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:nu.RED,this.left=null!=r?r:nu.EMPTY,this.right=null!=i?i:nu.EMPTY,this.size=this.left.size+1+this.right.size}function ru(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}function iu(t,e){this.J=t,this.root=e||eu.EMPTY}function ou(){this.size=0}eu.EMPTY=null,eu.RED=!0,eu.Jt=!1,eu.EMPTY=(Object.defineProperty(ou.prototype,"key",{get:function(){throw Er()},enumerable:!1,configurable:!0}),Object.defineProperty(ou.prototype,"value",{get:function(){throw Er()},enumerable:!1,configurable:!0}),Object.defineProperty(ou.prototype,"color",{get:function(){throw Er()},enumerable:!1,configurable:!0}),Object.defineProperty(ou.prototype,"left",{get:function(){throw Er()},enumerable:!1,configurable:!0}),Object.defineProperty(ou.prototype,"right",{get:function(){throw Er()},enumerable:!1,configurable:!0}),ou.prototype.copy=function(t,e,n,r,i){return this},ou.prototype.Ht=function(t,e,n){return new eu(t,e)},ou.prototype.remove=function(t,e){return this},ou.prototype.nt=function(){return!0},ou.prototype.Zt=function(t){return!1},ou.prototype.te=function(t){return!1},ou.prototype.Yt=function(){return null},ou.prototype.Xt=function(){return null},ou.prototype._e=function(){return!1},ou.prototype.Ie=function(){return!0},ou.prototype.me=function(){return 0},new ou);var su=(hu.prototype.has=function(t){return null!==this.data.get(t)},hu.prototype.first=function(){return this.data.Yt()},hu.prototype.last=function(){return this.data.Xt()},Object.defineProperty(hu.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),hu.prototype.indexOf=function(t){return this.data.indexOf(t)},hu.prototype.forEach=function(n){this.data.Zt(function(t,e){return n(t),!1})},hu.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(0<=this.J(r.key,t[1]))return;e(r.key)}},hu.prototype.Re=function(t,e){for(var n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},hu.prototype.Pe=function(t){return(t=this.data.ne(t)).ae()?t.ce().key:null},hu.prototype.ee=function(){return new uu(this.data.ee())},hu.prototype.ne=function(t){return new uu(this.data.ne(t))},hu.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},hu.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},hu.prototype.nt=function(){return this.data.nt()},hu.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},hu.prototype.isEqual=function(t){if(!(t instanceof hu))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ee(),n=t.data.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(0!==this.J(r,i))return!1}return!0},hu.prototype.rt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},hu.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},hu.prototype.copy=function(t){var e=new hu(this.J);return e.data=t,e},hu),uu=(cu.prototype.ce=function(){return this.ge.ce().key},cu.prototype.ae=function(){return this.ge.ae()},cu),au=new Zs(pi.J);function cu(t){this.ge=t}function hu(t){this.J=t,this.data=new Zs(this.J)}var fu=new Zs(pi.J),lu=new Zs(pi.J),pu=new su(pi.J);function du(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=pu,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var yu=new su(Ar),vu=(Pu.be=function(t){return new Pu(t.J)},Pu.prototype.has=function(t){return null!=this.Ve.get(t)},Pu.prototype.get=function(t){return this.Ve.get(t)},Pu.prototype.first=function(){return this.pe.Yt()},Pu.prototype.last=function(){return this.pe.Xt()},Pu.prototype.nt=function(){return this.pe.nt()},Pu.prototype.indexOf=function(t){return(t=this.Ve.get(t))?this.pe.indexOf(t):-1},Object.defineProperty(Pu.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),Pu.prototype.forEach=function(n){this.pe.Zt(function(t,e){return n(t),!1})},Pu.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},Pu.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},Pu.prototype.isEqual=function(t){if(!(t instanceof Pu))return!1;if(this.size!==t.size)return!1;for(var e=this.pe.ee(),n=t.pe.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(!r.isEqual(i))return!1}return!0},Pu.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Pu.prototype.copy=function(t,e){var n=new Pu;return n.J=this.J,n.Ve=t,n.pe=e,n},Pu),gu=(ku.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);!n||0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):Er()},ku.prototype.Se=function(){var n=[];return this.ve.Zt(function(t,e){n.push(e)}),n},ku),mu=(Ou.Oe=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ou(t,e,vu.be(e),i,n,r,!0,!1)},Object.defineProperty(Ou.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),Ou.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&$o(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ou),wu=(Du.$e=function(t,e){var n=new Map;return n.set(t,bu.Be(t,e)),new Du(ci.min(),n,yu,au,du())},Du),bu=(xu.Be=function(t,e){return new xu(Or.h,e,du(),du(),du())},xu),Iu=function(t,e,n,r){this.je=t,this.removedTargetIds=e,this.key=n,this.We=r},_u=function(t,e){this.targetId=t,this.Ge=e},Eu=function(t,e,n,r){void 0===n&&(n=Or.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Tu=(Object.defineProperty(Au.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(Au.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(Au.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(Au.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),Au.prototype.en=function(t){0<t.o()&&(this.Xe=!0,this.Je=t)},Au.prototype.nn=function(){var n=du(),r=du(),i=du();return this.He.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Er()}}),new bu(this.Je,this.Ye,n,r,i)},Au.prototype.sn=function(){this.Xe=!1,this.He=Cu()},Au.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},Au.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},Au.prototype.cn=function(){this.ze+=1},Au.prototype.an=function(){--this.ze},Au.prototype.un=function(){this.Xe=!0,this.Ye=!0},Au),Nu=(Su.prototype.wn=function(t){for(var e=0,n=t.je;e<n.length;e++){var r=n[e];t.We instanceof Zi?this.En(r,t.We):t.We instanceof to&&this.Tn(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Tn(r,t.key,t.We)},Su.prototype.In=function(n){var r=this;this.mn(n,function(t){var e=r.An(t);switch(n.state){case 0:r.Rn(t)&&e.en(n.resumeToken);break;case 1:e.an(),e.Ze||e.sn(),e.en(n.resumeToken);break;case 2:e.an(),e.Ze||r.removeTarget(t);break;case 3:r.Rn(t)&&(e.un(),e.en(n.resumeToken));break;case 4:r.Rn(t)&&(r.Pn(t),e.en(n.resumeToken));break;default:Er()}})},Su.prototype.mn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ln.forEach(function(t,e){r.Rn(e)&&n(e)})},Su.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count;(t=this.gn(e))&&(co(t=t.target)?0===n?(t=new pi(t.path),this.Tn(e,t,new to(t,ci.min()))):Tr(1===n):this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e)))},Su.prototype.pn=function(r){var i=this,o=new Map;this.ln.forEach(function(t,e){var n=i.gn(e);n&&(t.qe&&co(n.target)&&(n=new pi(n.target.path),null!==i._n.get(n)||i.bn(e,n)||i.Tn(e,n,new to(n,r))),t.tn&&(o.set(e,t.nn()),t.sn()))});var s=du();this.fn.forEach(function(t,e){var n=!0;e.Re(function(t){return!(t=i.gn(t))||2===t.kt||(n=!1)}),n&&(s=s.add(t))});var t=new wu(r,o,this.dn,this._n,s);return this._n=au,this.fn=Lu(),this.dn=new su(Ar),t},Su.prototype.En=function(t,e){var n;this.Rn(t)&&(n=this.bn(t,e.key)?2:0,this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t)))},Su.prototype.Tn=function(t,e,n){var r;this.Rn(t)&&(r=this.An(t),this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n)))},Su.prototype.removeTarget=function(t){this.ln.delete(t)},Su.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},Su.prototype.cn=function(t){this.An(t).cn()},Su.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new Tu,this.ln.set(t,e)),e},Su.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new su(Ar),this.fn=this.fn.Ht(t,e)),e},Su.prototype.Rn=function(t){var e=null!==this.gn(t);return e||wr("WatchChangeAggregator","Detected inactive target",t),e},Su.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},Su.prototype.Pn=function(e){var n=this;this.ln.set(e,new Tu),this.hn.Sn(e).forEach(function(t){n.Tn(e,t,null)})},Su.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},Su);function Su(t){this.hn=t,this.ln=new Map,this._n=au,this.fn=Lu(),this.dn=new su(Ar)}function Au(){this.ze=0,this.He=Cu(),this.Je=Or.h,this.Ye=!1,this.Xe=!0}function xu(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}function Du(t,e,n,r,i){this.Mt=t,this.Fe=e,this.ke=n,this.Me=r,this.Le=i}function Ou(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}function ku(){this.ve=new Zs(pi.J)}function Pu(n){this.J=n?function(t,e){return n(t,e)||pi.J(t.key,e.key)}:function(t,e){return pi.J(t.key,e.key)},this.Ve=fu,this.pe=new Zs(this.J)}function Lu(){return new Zs(pi.J)}function Cu(){return new Zs(pi.J)}var Ru={asc:"ASCENDING",desc:"DESCENDING"},Vu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Mu=function(t,e){this.T=t,this.qt=e};function Uu(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ju(t,e){return t.qt?e.toBase64():e.toUint8Array()}function qu(t){return Tr(!!t),ci.j((t=Si(t),new ai(t.seconds,t.nanos)))}function Fu(t,e){return new hi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).ot()}function Hu(t){return Tr(sa(t=hi.ct(t))),t}function Bu(t,e){return Fu(t.T,e.path)}function Gu(t,e){if((e=Hu(e)).get(1)!==t.T.projectId)throw new Cr(Lr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.T.projectId);if(e.get(3)!==t.T.database)throw new Cr(Lr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.T.database);return new pi(Wu(e))}function zu(t,e){return Fu(t.T,e)}function Ku(t){return 4===(t=Hu(t)).length?hi.at():Wu(t)}function Ju(t){return new hi(["projects",t.T.projectId,"databases",t.T.database]).ot()}function Wu(t){return Tr(4<t.length&&"documents"===t.get(4)),t.X(5)}function Xu(t,e,n){return{name:Bu(t,e),fields:n.proto.mapValue.fields}}function Yu(t,e,n){var r=Gu(t,e.name),t=qu(e.updateTime),e=new Ki({mapValue:{fields:e.fields}});return new Zi(r,t,e,{hasCommittedMutations:!!n})}function Qu(t,e){var n,r,i;if(e instanceof Rs)n={update:Xu(t,e.key,e.value)};else if(e instanceof Js)n={delete:Bu(t,e.key)};else if(e instanceof Vs)n={update:Xu(t,e.key,e.data),updateMask:(i=e.zt,r=[],i.fields.forEach(function(t){return r.push(t.ot())}),{fieldPaths:r})};else{if(!(e instanceof Ws))return Er();n={verify:Bu(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof fs)return{fieldPath:t.field.ot(),setToServerValue:"REQUEST_TIME"};if(e instanceof ls)return{fieldPath:t.field.ot(),appendMissingElements:{values:e.elements}};if(e instanceof gs)return{fieldPath:t.field.ot(),removeAllFromArray:{values:e.elements}};if(e instanceof Is)return{fieldPath:t.field.ot(),increment:e.Qt};throw Er()})),e.Gt.Wt||(n.currentDocument=void 0!==(i=e.Gt).updateTime?{updateTime:Uu(e=t,(t=i.updateTime).G())}:void 0!==i.exists?{exists:i.exists}:Er()),n}function $u(i,t){var e=t.currentDocument?void 0!==(s=t.currentDocument).updateTime?As.updateTime(qu(s.updateTime)):void 0!==s.exists?As.exists(s.exists):As.jt():As.jt(),n=t.updateTransforms?t.updateTransforms.map(function(t){return e=i,r=null,"setToServerValue"in(t=t)?(Tr("REQUEST_TIME"===t.setToServerValue),r=new fs):"appendMissingElements"in t?(n=t.appendMissingElements.values||[],r=new ls(n)):"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],r=new gs(n)):"increment"in t?r=new Is(e,t.increment):Er(),t=li._t(t.fieldPath),new Ss(t,r);var e,n,r}):[];if(t.update){t.update.name;var r=Gu(i,t.update.name),o=new Ki({mapValue:{fields:t.update.fields}});if(t.updateMask){var s=(s=t.updateMask.fieldPaths||[],new Ei(s.map(function(t){return li._t(t)})));return new Vs(r,o,s,e,n)}return new Rs(r,o,e,n)}return t.delete?(n=Gu(i,t.delete),new Js(n,e)):t.verify?(t=Gu(i,t.verify),new Ws(t,e)):Er()}function Zu(t,e){return{documents:[zu(t,e.path)]}}function ta(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=zu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=zu(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Gi(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NAN"}};if(Bi(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Gi(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NOT_NAN"}};if(Bi(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ia(t.field),op:(e=t.op,Vu[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:ia(t.field),direction:(t=t.dir,Ru[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.qt||ki(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=na(e.startAt)),e.endAt&&(n.structuredQuery.endAt=na(e.endAt)),n}function ea(t){var e=Ku(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Tr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=oa(t.unaryFilter.field);return fo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=oa(t.unaryFilter.field);return fo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=oa(t.unaryFilter.field),fo.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=oa(t.unaryFilter.field),fo.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Er()}}(e)]:void 0!==e.fieldFilter?[(n=e,fo.create(oa(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Er()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Er():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new Uo(oa((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=ki(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ra(n.startAt));var u=null;return n.endAt&&(u=ra(n.endAt)),Ho(e,i,t,o,r,"F",s,u)}function na(t){return{before:t.before,values:t.position}}function ra(t){var e=!!t.before,t=t.values||[];return new Po(t,e)}function ia(t){return{fieldPath:t.ot()}}function oa(t){return li._t(t.fieldPath)}function sa(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var ua,aa=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},ca=(ma.prototype.catch=function(t){return this.next(void 0,t)},ma.prototype.next=function(r,i){var o=this;return this.On&&Er(),this.On=!0,this.Nn?this.error?this.Fn(i,this.error):this.kn(r,this.result):new ma(function(e,n){o.Cn=function(t){o.kn(r,t).next(e,n)},o.xn=function(t){o.Fn(i,t).next(e,n)}})},ma.prototype.Mn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ma.prototype.Ln=function(t){try{var e=t();return e instanceof ma?e:ma.resolve(e)}catch(t){return ma.reject(t)}},ma.prototype.kn=function(t,e){return t?this.Ln(function(){return t(e)}):ma.resolve(e)},ma.prototype.Fn=function(t,e){return t?this.Ln(function(){return t(e)}):ma.reject(e)},ma.resolve=function(n){return new ma(function(t,e){t(n)})},ma.reject=function(n){return new ma(function(t,e){e(n)})},ma.$n=function(t){return new ma(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ma.Bn=function(t){for(var n=ma.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ma.resolve(t):e()})}(r[e]);return n},ma.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},ma),ha=(ga.open=function(t,e,n,r){try{return new ga(e,t.transaction(r,n))}catch(t){throw new pa(e,t)}},Object.defineProperty(ga.prototype,"Un",{get:function(){return this.qn.promise},enumerable:!1,configurable:!0}),ga.prototype.abort=function(t){t&&this.qn.reject(t),this.aborted||(wr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},ga.prototype.store=function(t){return t=this.transaction.objectStore(t),new ba(t)},ga),fa=(va.delete=function(t){return wr("SimpleDb","Removing database:",t),_a(window.indexedDB.deleteDatabase(t)).Mn()},va.jn=function(){if("undefined"==typeof indexedDB)return!1;if(va.Wn())return!0;var t=p(),e=0<(n=va.Kn(t))&&n<10,n=0<(n=va.Gn(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},va.Wn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.zn)},va.Hn=function(t,e){return t.store(e)},va.Kn=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},va.Gn=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},va.prototype.Jn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(wr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new pa(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new Cr(Lr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new pa(o,t))},r.onupgradeneeded=function(t){wr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Qn.Yn(e,r.transaction,t.oldVersion,i.version).next(function(){wr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Xn&&(this.db.onversionchange=function(t){return i.Xn(t)}),this.db)]}})})},va.prototype.Zn=function(e){this.Xn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},va.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Jn(u)];case 2:return s.db=t.sent(),e=ha.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),ca.reject(t)}).Mn(),r={},n.catch(function(){}),[4,e.Un];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,wr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},va.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},va),la=(Object.defineProperty(ya.prototype,"Nn",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(ya.prototype,"ss",{get:function(){return this.ns},enumerable:!1,configurable:!0}),Object.defineProperty(ya.prototype,"cursor",{set:function(t){this.ts=t},enumerable:!1,configurable:!0}),ya.prototype.done=function(){this.es=!0},ya.prototype.rs=function(t){this.ns=t},ya.prototype.delete=function(){return _a(this.ts.delete())},ya),pa=(h(da,ua=Cr),da);function da(t,e){var n=this;return(n=ua.call(this,Lr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function ya(t){this.ts=t,this.es=!1,this.ns=null}function va(t,e,n){this.name=t,this.version=e,this.Qn=n,12.2===va.Kn(p())&&br("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function ga(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.qn=new aa,this.transaction.oncomplete=function(){n.qn.resolve()},this.transaction.onabort=function(){t.error?n.qn.reject(new pa(e,t.error)):n.qn.resolve()},this.transaction.onerror=function(t){t=Ta(t.target.error),n.qn.reject(new pa(e,t))}}function ma(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.On=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}function wa(t){return"IndexedDbTransactionError"===t.name}var ba=(Ia.prototype.put=function(t,e){return _a(t=void 0!==e?(wr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(wr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Ia.prototype.add=function(t){return wr("SimpleDb","ADD",this.store.name,t,t),_a(this.store.add(t))},Ia.prototype.get=function(e){var n=this;return _a(this.store.get(e)).next(function(t){return void 0===t&&(t=null),wr("SimpleDb","GET",n.store.name,e,t),t})},Ia.prototype.delete=function(t){return wr("SimpleDb","DELETE",this.store.name,t),_a(this.store.delete(t))},Ia.prototype.count=function(){return wr("SimpleDb","COUNT",this.store.name),_a(this.store.count())},Ia.prototype.os=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.cs(e,function(t,e){n.push(e)}).next(function(){return n})},Ia.prototype.us=function(t,e){return wr("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).hs=!1,e=this.cursor(e),this.cs(e,function(t,e,n){return n.delete()})},Ia.prototype.ls=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.cs(n,e)},Ia.prototype._s=function(r){var t=this.cursor({});return new ca(function(n,e){t.onerror=function(t){t=Ta(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Ia.prototype.cs=function(t,i){var o=[];return new ca(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new la(n),(t=i(n.primaryKey,n.value,e))instanceof ca&&(t=t.catch(function(t){return e.done(),ca.reject(t)}),o.push(t)),e.Nn?r():null===e.ss?n.continue():n.continue(e.ss)):r()}}).next(function(){return ca.$n(o)})},Ia.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Ia.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.hs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Ia);function Ia(t){this.store=t}function _a(t){return new ca(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=Ta(t.target.error),n(t)}})}var Ea=!1;function Ta(t){var e=fa.Kn(p());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new Cr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ea||(Ea=!0,setTimeout(function(){throw n},0)),n}return t}var Na=(Sa.Is=function(t,e,n,r,i){return(i=new Sa(t,e,Date.now()+n,r,i)).start(n),i},Sa.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},Sa.prototype.Ps=function(){return this.Rs()},Sa.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new Cr(Lr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Sa.prototype.Rs=function(){var e=this;this.fs.ys(function(){return null!==e.As?(e.clearTimeout(),e.op().then(function(t){return e.Ts.resolve(t)})):Promise.resolve()})},Sa.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},Sa);function Sa(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new aa,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch(function(t){})}function Aa(t,e){if(br("AsyncQueue",e+": "+t),wa(t))return new Cr(Lr.UNAVAILABLE,e+": "+t);throw t}var xa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",o=(Da.prototype.Vs=function(t){this.gs.push(t)},Da.prototype.ps=function(){this.gs.forEach(function(t){return t()})},Da);function Da(){this.gs=[]}function Oa(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=ka(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return ka(o)}function ka(t){return t+""}function Pa(t){var e=t.length;if(Tr(2<=e),2===e)return Tr(""===t.charAt(0)&&""===t.charAt(1)),hi.at();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Er(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Er()}o=s+2}return new hi(r)}function La(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}var Ca=function(t,e){this.seconds=t,this.nanoseconds=e};function Ra(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}function Va(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}La.store="owner",La.key="owner",Ra.store="mutationQueues",Ra.keyPath="userId",Va.store="mutations",Va.keyPath="batchId",Va.userMutationsIndex="userMutationsIndex",Va.userMutationsKeyPath=["userId","batchId"];var Ma=(Ua.prefixForUser=function(t){return[t]},Ua.prefixForPath=function(t,e){return[t,Oa(e)]},Ua.key=function(t,e,n){return[t,Oa(e),n]},Ua);function Ua(){}function ja(t,e){this.path=t,this.readTime=e}function qa(t,e){this.path=t,this.version=e}Ma.store="documentMutations",Ma.PLACEHOLDER=new Ma;var Fa=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};function Ha(t){this.byteSize=t}function Ba(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s}Fa.store="remoteDocuments",Fa.readTimeIndex="readTimeIndex",Fa.readTimeIndexPath="readTime",Fa.collectionReadTimeIndex="collectionReadTimeIndex",Fa.collectionReadTimeIndexPath=["parentPath","readTime"],Ha.store="remoteDocumentGlobal",Ha.key="remoteDocumentGlobalKey",Ba.store="targets",Ba.keyPath="targetId",Ba.queryTargetsIndexName="queryTargetsIndex",Ba.queryTargetsKeyPath=["canonicalId","targetId"];var Ga=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};function za(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}function Ka(t,e){this.collectionId=t,this.parent=e}function Ja(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}function Wa(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}function Xa(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}Ga.store="targetDocuments",Ga.keyPath=["targetId","path"],Ga.documentTargetsIndex="documentTargetsIndex",Ga.documentTargetsKeyPath=["path","targetId"],za.key="targetGlobalKey",za.store="targetGlobal",Ka.store="collectionParents",Ka.keyPath=["collectionId","parent"],Ja.store="clientMetadata",Ja.keyPath="clientId",Wa.store="bundles",Wa.keyPath="bundleId",Xa.store="namedQueries",Xa.keyPath="name";var Ya,Qa=f(f(f(f([Ra.store,Va.store,Ma.store,Fa.store,Ba.store,La.store,za.store,Ga.store],[Ja.store]),[Ha.store]),[Ka.store]),[Wa.store,Xa.store]),$a=(h(Za,Ya=o),Za);function Za(t,e){var n=this;return(n=Ya.call(this)||this).bs=t,n.vs=e,n}function tc(t,e){return fa.Hn(t.bs,e)}var ec=(oc.prototype.Ds=function(t,e,n){for(var r,i,o,s,u,a,c=n.Cs,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,u=e,i=c[h],f=a=void 0,e=r instanceof Rs?(a=i,f=(o=r).value,a.transformResults&&(s=qs(o.fieldTransforms,u,a.transformResults),f=Hs(o.fieldTransforms,f,s)),new Zi(o.key,a.version,f,{hasCommittedMutations:!0})):r instanceof Vs?(a=u,f=i,Ds((u=r).Gt,a)?(a=js(u,a,f.transformResults?qs(u.fieldTransforms,a,f.transformResults):[]),new Zi(u.key,f.version,a,{hasCommittedMutations:!0})):new eo(u.key,f.version)):new to(r.key,i.version,{hasCommittedMutations:!0}))}return e},oc.prototype.xs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(i=r[n]).key.isEqual(t)&&(e=Os(i,e,0,this.Ss));for(var i,o=0,s=this.mutations;o<s.length;o++)(i=s[o]).key.isEqual(t)&&(e=Os(i,e,0,this.Ss));return e},oc.prototype.Ns=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.xs(t.key,n.get(t.key));e&&(i=i.Ht(t.key,e))}),i},oc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},du())},oc.prototype.isEqual=function(t){return this.batchId===t.batchId&&xr(this.mutations,t.mutations,ks)&&xr(this.baseMutations,t.baseMutations,ks)},oc),nc=(ic.from=function(t,e,n){Tr(t.mutations.length===n.length);for(var r=lu,i=t.mutations,o=0;o<i.length;o++)r=r.Ht(i[o].key,n[o].version);return new ic(t,e,n,r)},ic),rc=function(t){this.ks=t};function ic(t,e,n,r){this.batch=t,this.Os=e,this.Cs=n,this.Fs=r}function oc(t,e,n,r){this.batchId=t,this.Ss=e,this.baseMutations=n,this.mutations=r}function sc(t,e){if(e.document)return Yu(t.ks,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=pi.Tt(e.noDocument.path),r=fc(e.noDocument.readTime);return new to(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(n=pi.Tt(e.unknownDocument.path),r=fc(e.unknownDocument.version),new eo(n,r)):Er()}function uc(t,e,n){var r=ac(n),n=e.key.path.Z().rt();if(e instanceof Zi){var i={name:Bu(o=t.ks,(s=e).key),fields:s.vt().mapValue.fields,updateTime:Uu(o,s.version.G())},o=e.hasCommittedMutations;return new Fa(null,null,i,o,r,n)}if(e instanceof to){var s=e.key.path.rt(),i=hc(e.version),o=e.hasCommittedMutations;return new Fa(null,new ja(s,i),null,o,r,n)}return e instanceof eo?(o=e.key.path.rt(),e=hc(e.version),new Fa(new qa(o,e),null,null,!0,r,n)):Er()}function ac(t){return[(t=t.G()).seconds,t.nanoseconds]}function cc(t){return t=new ai(t[0],t[1]),ci.j(t)}function hc(t){return t=t.G(),new Ca(t.seconds,t.nanoseconds)}function fc(t){return t=new ai(t.seconds,t.nanoseconds),ci.j(t)}function lc(e,t){for(var n=(t.baseMutations||[]).map(function(t){return $u(e.ks,t)}),r=t.mutations.length-1;0<=r;--r){var i=t.mutations[r];void 0!==(null==i?void 0:i.transform)&&(t.mutations[r-1].updateTransforms=i.transform.fieldTransforms,t.mutations.splice(r,1),--r)}var o=t.mutations.map(function(t){return $u(e.ks,t)}),s=ai.fromMillis(t.localWriteTimeMs);return new ec(t.batchId,s,n,o)}function pc(t){var e=fc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?fc(t.lastLimboFreeSnapshotVersion):ci.min(),r=void 0!==t.query.documents?(Tr(1===(r=t.query).documents.length),Yo(Bo(Ku(r.documents[0])))):Yo(ea(t.query));return new rs(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Or.fromBase64String(t.resumeToken))}function dc(t,e){var n=hc(e.Mt),r=hc(e.lastLimboFreeSnapshotVersion),i=(co(e.target)?Zu:ta)(t.ks,e.target),t=e.resumeToken.toBase64();return new Ba(e.targetId,uo(e.target),n,t,e.sequenceNumber,r,i)}function yc(t){var e=ea({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Qo(e,e.limit,"L"):e}var vc=(gc.prototype.Ms=function(t,e){return mc(t).get(e).next(function(t){if(t)return{id:t.bundleId,createTime:fc(t.createTime),version:t.version}})},gc.prototype.Ls=function(t,e){return mc(t).put({bundleId:e.id,createTime:hc(qu(e.createTime)),version:e.version})},gc.prototype.$s=function(t,e){return wc(t).get(e).next(function(t){if(t)return{name:t.name,query:yc(t.bundledQuery),readTime:fc(t.readTime)}})},gc.prototype.Bs=function(t,e){return wc(t).put({name:e.name,readTime:hc(qu(e.readTime)),bundledQuery:e.bundledQuery})},gc);function gc(){}function mc(t){return tc(t,Wa.store)}function wc(t){return tc(t,Xa.store)}var bc=(Nc.prototype.Us=function(t,e){return this.qs.add(e),ca.resolve()},Nc.prototype.Qs=function(t,e){return ca.resolve(this.qs.getEntries(e))},Nc),Ic=(Tc.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new su(hi.J),t=!r.has(n);return this.index[e]=r.add(n),t},Tc.prototype.has=function(t){var e=t.et(),t=t.Z();return(e=this.index[e])&&e.has(t)},Tc.prototype.getEntries=function(t){return(this.index[t]||new su(hi.J)).rt()},Tc),_c=(Ec.prototype.Us=function(t,e){var n=this;if(this.Ks.has(e))return ca.resolve();var r=e.et(),i=e.Z();return t.Vs(function(){n.Ks.add(e)}),i={collectionId:r,parent:Oa(i)},Sc(t).put(i)},Ec.prototype.Qs=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Dr(i),""],!1,!0);return Sc(t).os(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Pa(r.parent))}return o})},Ec);function Ec(){this.Ks=new Ic}function Tc(){this.index={}}function Nc(){this.qs=new Ic}function Sc(t){return tc(t,Ka.store)}var Ac={js:!1,Ws:0,Gs:0,zs:0},xc=(Dc.Xs=function(t){return new Dc(t,Dc.Zs,Dc.ti)},Dc);function Dc(t,e,n){this.Hs=t,this.Js=e,this.Ys=n}function Oc(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Lr.FAILED_PRECONDITION||e.message!==xa)throw e;return wr("LocalStore","Unexpectedly lost primary lease"),[2]})})}xc.Zs=10,xc.ti=1e3,xc.ei=new xc(41943040,xc.Zs,xc.ti),xc.ni=new xc(-1,0,0);var kc=(Lc.prototype.get=function(t){var e=this.si(t);if(void 0!==(e=this.ri[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.ii(i,t))return o}},Lc.prototype.has=function(t){return void 0!==this.get(t)},Lc.prototype.set=function(t,e){var n=this.si(t),r=this.ri[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ii(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ri[n]=[[t,e]]},Lc.prototype.delete=function(t){var e=this.si(t),n=this.ri[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ii(n[r][0],t))return 1===n.length?delete this.ri[e]:n.splice(r,1),!0;return!1},Lc.prototype.forEach=function(s){Ii(this.ri,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Lc.prototype.nt=function(){return _i(this.ri)},Lc),me=(Pc.prototype.ai=function(t){return(t=this.oi.get(t))?t.readTime:ci.min()},Pc.prototype.ui=function(t,e){this.hi(),this.oi.set(t.key,{li:t,readTime:e})},Pc.prototype._i=function(t,e){void 0===e&&(e=null),this.hi(),this.oi.set(t,{li:null,readTime:e})},Pc.prototype.fi=function(t,e){this.hi();var n=this.oi.get(e);return void 0!==n?ca.resolve(n.li):this.di(t,e)},Pc.prototype.getEntries=function(t,e){return this.wi(t,e)},Pc.prototype.apply=function(t){return this.hi(),this.ci=!0,this.Ei(t)},Pc.prototype.hi=function(){},Pc);function Pc(){this.oi=new kc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ci=!1}function Lc(t,e){this.si=t,this.ii=e,this.ri={}}function Cc(t,e,n){var r=t.store(Va.store),i=t.store(Ma.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.ls({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Tr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=Ma.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return ca.$n(o).next(function(){return u})}function Rc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Er();e=t.noDocument}return JSON.stringify(e).length}var Vc=(Mc.Ai=function(t,e,n,r){return Tr(""!==t.uid),new Mc(t.A()?t.uid:"",e,n,r)},Mc.prototype.Ri=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return jc(t).ls({index:Va.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Mc.prototype.Pi=function(d,y,v,g){var m=this,w=qc(d),b=jc(d);return b.add({}).next(function(t){Tr("number"==typeof t);for(var e,n,r,i,o,s=new ec(t,y,v,g),u=(e=m.Kt,n=m.userId,i=(r=s).baseMutations.map(function(t){return Qu(e.ks,t)}),o=r.mutations.map(function(t){return Qu(e.ks,t)}),new Va(n,r.batchId,r.Ss.toMillis(),i,o)),a=[],c=new su(function(t,e){return Ar(t.ot(),e.ot())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Ma.key(m.userId,l.key.path,t),c=c.add(l.key.path.Z());a.push(b.put(u)),a.push(w.put(p,Ma.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Ti.Us(d,t))}),d.Vs(function(){m.mi[t]=s.keys()}),ca.$n(a).next(function(){return s})})},Mc.prototype.yi=function(t,e){var n=this;return jc(t).get(e).next(function(t){return t?(Tr(t.userId===n.userId),lc(n.Kt,t)):null})},Mc.prototype.gi=function(t,e){var n=this;return this.mi[e]?ca.resolve(this.mi[e]):this.yi(t,e).next(function(t){return t?(t=t.keys(),n.mi[e]=t):null})},Mc.prototype.Vi=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return jc(t).ls({index:Va.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Tr(e.batchId>=i),o=lc(r.Kt,e)),n.done()}).next(function(){return o})},Mc.prototype.pi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return jc(t).ls({index:Va.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Mc.prototype.bi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return jc(t).os(Va.userMutationsIndex,n).next(function(t){return t.map(function(t){return lc(e.Kt,t)})})},Mc.prototype.vi=function(o,s){var u=this,t=Ma.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return qc(o).ls({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Pa(i);if(r===u.userId&&s.path.isEqual(i))return jc(o).get(t).next(function(t){if(!t)throw Er();Tr(t.userId===u.userId),a.push(lc(u.Kt,t))});n.done()}).next(function(){return a})},Mc.prototype.Si=function(e,t){var s=this,u=new su(Ar),n=[];return t.forEach(function(o){var t=Ma.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=qc(e).ls({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Pa(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),ca.$n(n).next(function(){return s.Di(e,u)})},Mc.prototype.Ci=function(t,e){var o=this,s=e.path,u=s.length+1,e=Ma.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new su(Ar);return qc(t).ls({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Pa(i);r===o.userId&&s.st(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Di(t,a)})},Mc.prototype.Di=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(jc(e).get(t).next(function(t){if(null===t)throw Er();Tr(t.userId===n.userId),r.push(lc(n.Kt,t))}))}),ca.$n(i).next(function(){return r})},Mc.prototype.xi=function(e,n){var r=this;return Cc(e.bs,this.userId,n).next(function(t){return e.Vs(function(){r.Ni(n.batchId)}),ca.forEach(t,function(t){return r.Ii.Oi(e,t)})})},Mc.prototype.Ni=function(t){delete this.mi[t]},Mc.prototype.Fi=function(e){var i=this;return this.Ri(e).next(function(t){if(!t)return ca.resolve();var t=IDBKeyRange.lowerBound(Ma.prefixForUser(i.userId)),r=[];return qc(e).ls({range:t},function(t,e,n){t[0]===i.userId?(t=Pa(t[1]),r.push(t)):n.done()}).next(function(){Tr(0===r.length)})})},Mc.prototype.ki=function(t,e){return Uc(t,this.userId,e)},Mc.prototype.Mi=function(t){var e=this;return Fc(t).get(this.userId).next(function(t){return t||new Ra(e.userId,-1,"")})},Mc);function Mc(t,e,n,r){this.userId=t,this.Kt=e,this.Ti=n,this.Ii=r,this.mi={}}function Uc(t,o,e){var s=(e=Ma.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return qc(t).ls({range:e,hs:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function jc(t){return tc(t,Va.store)}function qc(t){return tc(t,Ma.store)}function Fc(t){return tc(t,Ra.store)}var Hc=(zc.prototype.next=function(){return this.Li+=2,this.Li},zc.$i=function(){return new zc(0)},zc.Bi=function(){return new zc(-1)},zc),Bc=(Gc.prototype.qi=function(n){var r=this;return this.Ui(n).next(function(t){var e=new Hc(t.highestTargetId);return t.highestTargetId=e.next(),r.Qi(n,t).next(function(){return t.highestTargetId})})},Gc.prototype.Ki=function(t){return this.Ui(t).next(function(t){return ci.j(new ai(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Gc.prototype.ji=function(t){return this.Ui(t).next(function(t){return t.highestListenSequenceNumber})},Gc.prototype.Wi=function(e,n,r){var i=this;return this.Ui(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.G()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Qi(e,t)})},Gc.prototype.Gi=function(e,n){var r=this;return this.zi(e,n).next(function(){return r.Ui(e).next(function(t){return t.targetCount+=1,r.Hi(n,t),r.Qi(e,t)})})},Gc.prototype.Ji=function(t,e){return this.zi(t,e)},Gc.prototype.Yi=function(e,t){var n=this;return this.Xi(e,t.targetId).next(function(){return Kc(e).delete(t.targetId)}).next(function(){return n.Ui(e)}).next(function(t){return Tr(0<t.targetCount),--t.targetCount,n.Qi(e,t)})},Gc.prototype.Zi=function(n,r,i){var o=this,s=0,u=[];return Kc(n).ls(function(t,e){(e=pc(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.Yi(n,e)))}).next(function(){return ca.$n(u)}).next(function(){return s})},Gc.prototype.mn=function(t,n){return Kc(t).ls(function(t,e){e=pc(e),n(e)})},Gc.prototype.Ui=function(t){return Jc(t).get(za.key).next(function(t){return Tr(null!==t),t})},Gc.prototype.Qi=function(t,e){return Jc(t).put(za.key,e)},Gc.prototype.zi=function(t,e){return Kc(t).put(dc(this.Kt,e))},Gc.prototype.Hi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Gc.prototype.tr=function(t){return this.Ui(t).next(function(t){return t.targetCount})},Gc.prototype.er=function(t,r){var e=uo(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Kc(t).ls({range:e,index:Ba.queryTargetsIndexName},function(t,e,n){e=pc(e),ao(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Gc.prototype.nr=function(n,t,r){var i=this,o=[],s=Wc(n);return t.forEach(function(t){var e=Oa(t.path);o.push(s.put(new Ga(r,e))),o.push(i.Ii.sr(n,r,t))}),ca.$n(o)},Gc.prototype.ir=function(n,t,r){var i=this,o=Wc(n);return ca.forEach(t,function(t){var e=Oa(t.path);return ca.$n([o.delete([r,e]),i.Ii.rr(n,r,t)])})},Gc.prototype.Xi=function(t,e){return t=Wc(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},Gc.prototype.cr=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Wc(t),r=du();return t.ls({range:e,hs:!0},function(t,e,n){t=Pa(t[1]),t=new pi(t),r=r.add(t)}).next(function(){return r})},Gc.prototype.ki=function(t,e){var e=Oa(e.path),e=IDBKeyRange.bound([e],[Dr(e)],!1,!0),i=0;return Wc(t).ls({index:Ga.documentTargetsIndex,hs:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Gc.prototype.Dn=function(t,e){return Kc(t).get(e).next(function(t){return t?pc(t):null})},Gc);function Gc(t,e){this.Ii=t,this.Kt=e}function zc(t){this.Li=t}function Kc(t){return tc(t,Ba.store)}function Jc(t){return tc(t,za.store)}function Wc(t){return tc(t,Ga.store)}function Xc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=Ar(n,t))?Ar(r,e):t}var Yc=(rh.prototype.hr=function(){return++this.ur},rh.prototype.lr=function(t){var e=[t,this.hr()];this.buffer.size<this.ar?this.buffer=this.buffer.add(e):Xc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(rh.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),rh),Qc=(nh.prototype.start=function(t){-1!==this._r.params.Hs&&this.Er(t)},nh.prototype.stop=function(){this.wr&&(this.wr.cancel(),this.wr=null)},Object.defineProperty(nh.prototype,"Tr",{get:function(){return null!==this.wr},enumerable:!1,configurable:!0}),nh.prototype.Er=function(n){var t=this,e=this.dr?3e5:6e4;wr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.wr=this.fs.Ir("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.wr=null,this.dr=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.mr(this._r)];case 2:return t.sent(),[3,7];case 3:return wa(e=t.sent())?(wr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Oc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Er(n)];case 8:return t.sent(),[2]}})})})},nh),$c=(eh.prototype.Rr=function(t,e){return this.Ar.Pr(t).next(function(t){return Math.floor(e/100*t)})},eh.prototype.yr=function(t,e){var n=this;if(0===e)return ca.resolve(ti.U);var r=new Yc(e);return this.Ar.mn(t,function(t){return r.lr(t.sequenceNumber)}).next(function(){return n.Ar.gr(t,function(t){return r.lr(t)})}).next(function(){return r.maxValue})},eh.prototype.Zi=function(t,e,n){return this.Ar.Zi(t,e,n)},eh.prototype.Vr=function(t,e){return this.Ar.Vr(t,e)},eh.prototype.pr=function(e,n){var r=this;return-1===this.params.Hs?(wr("LruGarbageCollector","Garbage collection skipped; disabled"),ca.resolve(Ac)):this.br(e).next(function(t){return t<r.params.Hs?(wr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Hs),Ac):r.vr(e,n)})},eh.prototype.br=function(t){return this.Ar.br(t)},eh.prototype.vr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Rr(e,this.params.Js).next(function(t){return i=t>h.params.Ys?(wr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Ys+" from "+t),h.params.Ys):t,s=Date.now(),h.yr(e,i)}).next(function(t){return r=t,u=Date.now(),h.Zi(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.Vr(e,r)}).next(function(t){return c=Date.now(),mr()<=l.DEBUG&&wr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ca.resolve({js:!0,Ws:i,Gs:o,zs:t})})},eh),Zc=(th.prototype.Pr=function(t){var n=this.Sr(t);return this.db.Dr().tr(t).next(function(e){return n.next(function(t){return e+t})})},th.prototype.Sr=function(t){var e=0;return this.gr(t,function(t){e++}).next(function(){return e})},th.prototype.mn=function(t,e){return this.db.Dr().mn(t,e)},th.prototype.gr=function(t,n){return this.Cr(t,function(t,e){return n(e)})},th.prototype.sr=function(t,e,n){return ih(t,n)},th.prototype.rr=function(t,e,n){return ih(t,n)},th.prototype.Zi=function(t,e,n){return this.db.Dr().Zi(t,e,n)},th.prototype.Oi=ih,th.prototype.Nr=function(t,e){return r=e,i=!1,Fc(n=t)._s(function(t){return Uc(n,t,r).next(function(t){return t&&(i=!0),ca.resolve(!t)})}).next(function(){return i});var n,r,i},th.prototype.Vr=function(n,r){var i=this,o=this.db.Fr().Or(),s=[],u=0;return this.Cr(n,function(e,t){t<=r&&(t=i.Nr(n,e).next(function(t){if(!t)return u++,o.fi(n,e).next(function(){return o._i(e),Wc(n).delete([0,Oa(e.path)])})}),s.push(t))}).next(function(){return ca.$n(s)}).next(function(){return o.apply(n)}).next(function(){return u})},th.prototype.removeTarget=function(t,e){return e=e.Lt(t.vs),this.db.Dr().Ji(t,e)},th.prototype.kr=ih,th.prototype.Cr=function(t,r){var i,t=Wc(t),o=ti.U;return t.ls({index:Ga.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==ti.U&&r(new pi(Pa(i)),o),o=e,i=t):o=ti.U}).next(function(){o!==ti.U&&r(new pi(Pa(i)),o)})},th.prototype.br=function(t){return this.db.Fr().Mr(t)},th);function th(t,e){this.db=t,this._r=new $c(this,e)}function eh(t,e){this.Ar=t,this.params=e}function nh(t,e){this._r=t,this.fs=e,this.dr=!1,this.wr=null}function rh(t){this.ar=t,this.buffer=new su(Xc),this.ur=0}function ih(t,e){return Wc(t).put((t=t.vs,new Ga(0,Oa(e.path),t)))}var oh,sh=(ch.prototype.ui=function(t,e,n){return fh(t).put(lh(e),n)},ch.prototype._i=function(t,e){return t=fh(t),e=lh(e),t.delete(e)},ch.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Lr(e,t)})},ch.prototype.fi=function(t,e){var n=this;return fh(t).get(lh(e)).next(function(t){return n.$r(t)})},ch.prototype.Br=function(t,e){var n=this;return fh(t).get(lh(e)).next(function(t){var e=n.$r(t);return e?{li:e,size:Rc(t)}:null})},ch.prototype.getEntries=function(t,e){var n=this,r=au;return this.qr(t,e,function(t,e){e=n.$r(e),r=r.Ht(t,e)}).next(function(){return r})},ch.prototype.Ur=function(t,e){var r=this,i=au,o=new Zs(pi.J);return this.qr(t,e,function(t,e){var n=r.$r(e);o=n?(i=i.Ht(t,n),o.Ht(t,Rc(e))):(i=i.Ht(t,null),o.Ht(t,0))}).next(function(){return{Qr:i,Kr:o}})},ch.prototype.qr=function(t,e,i){if(e.nt())return ca.resolve();var n=IDBKeyRange.bound(e.first().path.rt(),e.last().path.rt()),o=e.ee(),s=o.ce();return fh(t).ls({range:n},function(t,e,n){for(var r=pi.Tt(t);s&&pi.J(s,r)<0;)i(s,null),s=o.ce();s&&s.isEqual(r)&&(i(s,e),s=o.ae()?o.ce():null),s?n.rs(s.path.rt()):n.done()}).next(function(){for(;s;)i(s,null),s=o.ae()?o.ce():null})},ch.prototype.jr=function(t,r,e){var n,i=this,o=fu,s=r.path.length+1,u={};return e.isEqual(ci.min())?(n=r.path.rt(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.rt(),e=ac(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Fa.collectionReadTimeIndex),fh(t).ls(u,function(t,e,n){t.length===s&&(e=sc(i.Kt,e),r.path.st(e.key.path)?e instanceof Zi&&es(r,e)&&(o=o.Ht(e.key,e)):n.done())}).next(function(){return o})},ch.prototype.Or=function(t){return new uh(this,!!t&&t.Wr)},ch.prototype.Mr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},ch.prototype.getMetadata=function(t){return hh(t).get(Ha.key).next(function(t){return Tr(!!t),t})},ch.prototype.Lr=function(t,e){return hh(t).put(Ha.key,e)},ch.prototype.$r=function(t){return!t||(t=sc(this.Kt,t))instanceof to&&t.version.isEqual(ci.min())?null:t},ch),uh=(h(ah,oh=me),ah.prototype.Ei=function(i){var o=this,s=[],u=0,a=new su(function(t,e){return Ar(t.ot(),e.ot())});return this.oi.forEach(function(t,e){var n,r=o.zr.get(t);e.li?(n=uc(o.Gr.Kt,e.li,o.ai(t)),a=a.add(t.path.Z()),e=Rc(n),u+=e-r,s.push(o.Gr.ui(i,t,n))):(u-=r,o.Wr?(r=uc(o.Gr.Kt,new to(t,ci.min()),o.ai(t)),s.push(o.Gr.ui(i,t,r))):s.push(o.Gr._i(i,t)))}),a.forEach(function(t){s.push(o.Gr.Ti.Us(i,t))}),s.push(this.Gr.updateMetadata(i,u)),ca.$n(s)},ah.prototype.di=function(t,e){var n=this;return this.Gr.Br(t,e).next(function(t){return null===t?(n.zr.set(e,0),null):(n.zr.set(e,t.size),t.li)})},ah.prototype.wi=function(t,e){var n=this;return this.Gr.Ur(t,e).next(function(t){var e=t.Qr;return t.Kr.forEach(function(t,e){n.zr.set(t,e)}),e})},ah);function ah(t,e){var n=this;return(n=oh.call(this)||this).Gr=t,n.Wr=e,n.zr=new kc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function ch(t,e){this.Kt=t,this.Ti=e}function hh(t){return tc(t,Ha.store)}function fh(t){return tc(t,Fa.store)}function lh(t){return t.path.rt()}var ph=(dh.prototype.Yn=function(e,n,t,r){var i=this;Tr(t<r&&0<=t&&r<=11);var o=new ha("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(La.store),(s=e).createObjectStore(Ra.store,{keyPath:Ra.keyPath}),s.createObjectStore(Va.store,{keyPath:Va.keyPath,autoIncrement:!0}).createIndex(Va.userMutationsIndex,Va.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Ma.store),yh(e),e.createObjectStore(Fa.store));var s,u=ca.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(Ga.store),s.deleteObjectStore(Ba.store),s.deleteObjectStore(za.store),yh(e)),u=u.next(function(){return t=o.store(za.store),e=new za(0,0,ci.min().G(),0),t.put(za.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Va.store).os().next(function(t){n.deleteObjectStore(Va.store),n.createObjectStore(Va.store,{keyPath:Va.keyPath,autoIncrement:!0}).createIndex(Va.userMutationsIndex,Va.userMutationsKeyPath,{unique:!0});var e=r.store(Va.store),t=t.map(function(t){return e.put(t)});return ca.$n(t)});var n,r})),u=u.next(function(){e.createObjectStore(Ja.store,{keyPath:Ja.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.Hr(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Ha.store),i.Jr(o)})),t<7&&7<=r&&(u=u.next(function(){return i.Yr(o)})),t<8&&8<=r&&(u=u.next(function(){return i.Xr(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Fa.store)).createIndex(Fa.readTimeIndex,Fa.readTimeIndexPath,{unique:!1}),t.createIndex(Fa.collectionReadTimeIndex,Fa.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.Zr(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(Wa.store,{keyPath:Wa.keyPath}),e.createObjectStore(Xa.store,{keyPath:Xa.keyPath})})),u},dh.prototype.Jr=function(e){var n=0;return e.store(Fa.store).ls(function(t,e){n+=Rc(e)}).next(function(){var t=new Ha(n);return e.store(Ha.store).put(Ha.key,t)})},dh.prototype.Hr=function(n){var r=this,t=n.store(Ra.store),i=n.store(Va.store);return t.os().next(function(t){return ca.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.os(Va.userMutationsIndex,t).next(function(t){return ca.forEach(t,function(t){return Tr(t.userId===e.userId),t=lc(r.Kt,t),Cc(n,e.userId,t).next(function(){})})})})})},dh.prototype.Yr=function(t){var o=t.store(Ga.store),e=t.store(Fa.store);return t.store(za.store).get(za.key).next(function(r){var i=[];return e.ls(function(t,e){var n=new hi(t),t=[0,Oa(n)];i.push(o.get(t).next(function(t){return t?ca.resolve():o.put(new Ga(0,Oa(n),r.highestListenSequenceNumber))}))}).next(function(){return ca.$n(i)})})},dh.prototype.Xr=function(t,e){function r(t){if(i.add(t)){var e=t.et(),t=t.Z();return n.put({collectionId:e,parent:Oa(t)})}}t.createObjectStore(Ka.store,{keyPath:Ka.keyPath});var n=e.store(Ka.store),i=new Ic;return e.store(Fa.store).ls({hs:!0},function(t,e){return r((t=new hi(t)).Z())}).next(function(){return e.store(Ma.store).ls({hs:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],Pa(n))).Z())})})},dh.prototype.Zr=function(t){var n=this,r=t.store(Ba.store);return r.ls(function(t,e){return e=pc(e),e=dc(n.Kt,e),r.put(e)})},dh);function dh(t){this.Kt=t}function yh(t){t.createObjectStore(Ga.store,{keyPath:Ga.keyPath}).createIndex(Ga.documentTargetsIndex,Ga.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ba.store,{keyPath:Ba.keyPath}).createIndex(Ba.queryTargetsIndexName,Ba.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(za.store)}var vh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",gh=(mh.prototype.start=function(){var e=this;return this.Io().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Cr(Lr.FAILED_PRECONDITION,vh);return e.mo(),e.Ao(),e.Ro(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.fo.ji(t)})}).then(function(t){e.io=new ti(t,e.no)}).then(function(){e.ro=!0}).catch(function(t){return e._o&&e._o.close(),Promise.reject(t)})},mh.prototype.Po=function(n){var t=this;return this.ho=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Tr?[2,n(e)]:[2]})})},n(this.isPrimary)},mh.prototype.yo=function(n){var t=this;this._o.Zn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},mh.prototype.Vo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.eo.ys(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Tr?[4,this.Io()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},mh.prototype.Io=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return bh(e).put(new Ja(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.po(e).next(function(t){t||(n.isPrimary=!1,n.eo.bo(function(){return n.ho(!1)}))})}).next(function(){return n.vo(e)}).next(function(t){return n.isPrimary&&!t?n.So(e).next(function(){return!1}):!!t&&n.Do(e).next(function(){return!0})})}).catch(function(t){if(wa(t))return wr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return wr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.eo.bo(function(){return n.ho(t)}),n.isPrimary=t})},mh.prototype.po=function(t){var e=this;return wh(t).get(La.key).next(function(t){return ca.resolve(e.Co(t))})},mh.prototype.xo=function(t){return bh(t).delete(this.clientId)},mh.prototype.No=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Oo(this.uo,18e5)?[3,2]:(this.uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=tc(t,Ja.store);return r.os().next(function(t){var e=o.Fo(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ca.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.To)for(n=0,r=e;n<r.length;n++)i=r[n],this.To.removeItem(this.ko(i.clientId));t.label=2;case 2:return[2]}})})},mh.prototype.Ro=function(){var t=this;this.ao=this.eo.Ir("client_metadata_refresh",4e3,function(){return t.Io().then(function(){return t.No()}).then(function(){return t.Ro()})})},mh.prototype.Co=function(t){return!!t&&t.ownerId===this.clientId},mh.prototype.vo=function(e){var r=this;return this.so?ca.resolve(!0):wh(e).get(La.key).next(function(t){if(null!==t&&r.Oo(t.leaseTimestampMs,5e3)&&!r.Mo(t.ownerId)){if(r.Co(t)&&r.networkEnabled)return!0;if(!r.Co(t)){if(!t.allowTabSynchronization)throw new Cr(Lr.FAILED_PRECONDITION,vh);return!1}}return!(!r.networkEnabled||!r.inForeground)||bh(e).os().next(function(t){return void 0===r.Fo(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&wr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},mh.prototype.Lo=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.ro=!1,this.$o(),this.ao&&(this.ao.cancel(),this.ao=null),this.Bo(),this.qo(),[4,this._o.runTransaction("shutdown","readwrite",[La.store,Ja.store],function(t){var e=new $a(t,ti.U);return n.So(e).next(function(){return n.xo(e)})})];case 1:return t.sent(),this._o.close(),this.Uo(),[2]}})})},mh.prototype.Fo=function(t,e){var n=this;return t.filter(function(t){return n.Oo(t.updateTimeMs,e)&&!n.Mo(t.clientId)})},mh.prototype.Qo=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return bh(t).os().next(function(t){return e.Fo(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(mh.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),mh.prototype.Ko=function(t){return Vc.Ai(t,this.Kt,this.Ti,this.Ii)},mh.prototype.Dr=function(){return this.fo},mh.prototype.Fr=function(){return this.wo},mh.prototype.jo=function(){return this.Ti},mh.prototype.Wo=function(){return this.Eo},mh.prototype.runTransaction=function(e,n,r){var i=this;wr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this._o.runTransaction(e,t,Qa,function(t){return o=new $a(t,i.io?i.io.next():ti.U),"readwrite-primary"===n?i.po(o).next(function(t){return!!t||i.vo(o)}).next(function(t){if(!t)throw br("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.eo.bo(function(){return i.ho(!1)}),new Cr(Lr.FAILED_PRECONDITION,xa);return r(o)}).next(function(t){return i.Do(o).next(function(){return t})}):i.Go(o).next(function(){return r(o)})}).then(function(t){return o.ps(),t})},mh.prototype.Go=function(t){var e=this;return wh(t).get(La.key).next(function(t){if(null!==t&&e.Oo(t.leaseTimestampMs,5e3)&&!e.Mo(t.ownerId)&&!e.Co(t)&&!(e.so||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Cr(Lr.FAILED_PRECONDITION,vh)})},mh.prototype.Do=function(t){var e=new La(this.clientId,this.allowTabSynchronization,Date.now());return wh(t).put(La.key,e)},mh.jn=function(){return fa.jn()},mh.prototype.So=function(t){var e=this,n=wh(t);return n.get(La.key).next(function(t){return e.Co(t)?(wr("IndexedDbPersistence","Releasing primary lease."),n.delete(La.key)):ca.resolve()})},mh.prototype.Oo=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(br("Detected an update time that is in the future: "+t+" > "+n),1))},mh.prototype.mo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.co=function(){t.eo.ys(function(){return t.inForeground="visible"===t.document.visibilityState,t.Io()})},this.document.addEventListener("visibilitychange",this.co),this.inForeground="visible"===this.document.visibilityState)},mh.prototype.Bo=function(){this.co&&(this.document.removeEventListener("visibilitychange",this.co),this.co=null)},mh.prototype.Ao=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.oo=function(){e.$o(),e.eo.ys(function(){return e.Lo()})},this.window.addEventListener("unload",this.oo))},mh.prototype.qo=function(){this.oo&&(this.window.removeEventListener("unload",this.oo),this.oo=null)},mh.prototype.Mo=function(t){try{var e=null!==(null===(e=this.To)||void 0===e?void 0:e.getItem(this.ko(t)));return wr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return br("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},mh.prototype.$o=function(){if(this.To)try{this.To.setItem(this.ko(this.clientId),String(Date.now()))}catch(t){br("Failed to set zombie client id.",t)}},mh.prototype.Uo=function(){if(this.To)try{this.To.removeItem(this.ko(this.clientId))}catch(t){}},mh.prototype.ko=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},mh);function mh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.eo=i,this.window=o,this.document=s,this.no=a,this.so=c,this.io=null,this.ro=!1,this.isPrimary=!1,this.networkEnabled=!0,this.oo=null,this.inForeground=!1,this.co=null,this.ao=null,this.uo=Number.NEGATIVE_INFINITY,this.ho=function(t){return Promise.resolve()},!mh.jn())throw new Cr(Lr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ii=new Zc(this,r),this.lo=e+"main",this.Kt=new rc(u),this._o=new fa(this.lo,11,new ph(this.Kt)),this.fo=new Bc(this.Ii,this.Kt),this.Ti=new _c,this.wo=(e=this.Kt,u=this.Ti,new sh(e,u)),this.Eo=new vc,this.window&&this.window.localStorage?this.To=this.window.localStorage:(this.To=null,!1===c&&br("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function wh(t){return tc(t,La.store)}function bh(t){return tc(t,Ja.store)}function Ih(t,e){var n=t.projectId;return t.m||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}function _h(t,e){this.progress=t,this.zo=e}var Eh=(Oh.prototype.Jo=function(e,n){var r=this;return this.Ho.vi(e,n).next(function(t){return r.Yo(e,n,t)})},Oh.prototype.Yo=function(t,r,i){return this.wo.fi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].xs(r,t);return t})},Oh.prototype.Xo=function(t,e,i){var o=au;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].xs(t,e);o=o.Ht(t,e)}),o},Oh.prototype.Zo=function(e,t){var n=this;return this.wo.getEntries(e,t).next(function(t){return n.tc(e,t)})},Oh.prototype.tc=function(e,r){var i=this;return this.Ho.Si(e,r).next(function(t){var t=i.Xo(e,r,t),n=au;return t.forEach(function(t,e){e=e||new to(t,ci.min()),n=n.Ht(t,e)}),n})},Oh.prototype.jr=function(t,e,n){return r=e,pi.Et(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ec(t,e.path):Wo(e)?this.nc(t,e,n):this.sc(t,e,n);var r},Oh.prototype.ec=function(t,e){return this.Jo(t,new pi(e)).next(function(t){var e=fu;return t instanceof Zi&&(e=e.Ht(t.key,t)),e})},Oh.prototype.nc=function(n,r,i){var o=this,s=r.collectionGroup,u=fu;return this.Ti.Qs(n,s).next(function(t){return ca.forEach(t,function(t){var e=(e=r,t=t.child(s),new Fo(t,null,e.Nt.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.sc(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Ht(t,e)})})}).next(function(){return u})})},Oh.prototype.sc=function(e,n,t){var a,c,r=this;return this.wo.jr(e,n,t).next(function(t){return a=t,r.Ho.Ci(e,n)}).next(function(t){return c=t,r.ic(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key;a=(s=Os(s,a.get(u),0,r.Ss))instanceof Zi?a.Ht(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){es(n,e)||(a=a.remove(t))}),a})},Oh.prototype.ic=function(t,e,n){for(var r=du(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Vs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.wo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Zi&&(c=c.Ht(t,e))}),c})},Oh),Th=(Dh.cc=function(t,e){for(var n=du(),r=du(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Dh(t,e.fromCache,n,r)},Dh),Nh=(xh.prototype.ac=function(t){this.uc=t},xh.prototype.jr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.Nt.length||1===r.Nt.length&&r.Nt[0].field.ht())||i.isEqual(ci.min())?this.hc(e,r):this.uc.Zo(e,o).next(function(t){var n=s.lc(r,t);return(Go(r)||zo(r))&&s._c(r.limitType,n,o,i)?s.hc(e,r):(mr()<=l.DEBUG&&wr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ts(r)),s.uc.jr(e,r,i).next(function(e){return n.forEach(function(t){e=e.Ht(t.key,t)}),e}))})},xh.prototype.lc=function(n,t){var r=new su(ns(n));return t.forEach(function(t,e){e instanceof Zi&&es(n,e)&&(r=r.add(e))}),r},xh.prototype._c=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.u(r))},xh.prototype.hc=function(t,e){return mr()<=l.DEBUG&&wr("QueryEngine","Using full collection scan to execute query:",ts(e)),this.uc.jr(t,e,ci.min())},xh),Sh=(Ah.prototype.mr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.pr(t,n.dc)})},Ah);function Ah(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new Zs(Ar),this.wc=new kc(uo,ao),this.Ec=ci.min(),this.Ho=t.Ko(n),this.Tc=t.Fr(),this.fo=t.Dr(),this.Ic=new Eh(this.Tc,this.Ho,this.persistence.jo()),this.Eo=t.Wo(),this.fc.ac(this.Ic)}function xh(){}function Dh(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}function Oh(t,e,n){this.wo=t,this.Ho=e,this.Ti=n}function kh(t,e,n,r){return new Sh(t,e,n,r)}function Ph(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ho,m=e.Ic,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Ho.bi(v).next(function(t){return g=t,n=e.persistence.Ko(o),m=new Eh(e.Tc,n,e.persistence.jo()),n.bi(v)}).next(function(t){for(var e=[],n=[],r=du(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Zo(v,r).next(function(t){return{mc:t,Ac:e,Rc:n}})})})];case 1:return r=t.sent(),[2,(e.Ho=n,e.Ic=m,e.fc.ac(e.Ic),r)]}})})}function Lh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.fo.Ki(t)})}function Ch(t,s,e,u,a){var n=du();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=au;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof to&&e.version.isEqual(ci.min())?(s._i(t,r),o=o.Ht(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.ui(e,r),o=o.Ht(t,e)):wr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Rh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.fo.er(e,r).next(function(t){return t?(n=t,ca.resolve(n)):i.fo.qi(e).next(function(t){return n=new rs(r,t,0,e.vs),i.fo.Gi(e,n).next(function(){return n})})})}).then(function(t){var e=i.dc.get(t.targetId);return(null===e||0<t.Mt.u(e.Mt))&&(i.dc=i.dc.Ht(t.targetId,t),i.wc.set(r,t.targetId)),t})}function Vh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).dc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ii.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!wa(r=t.sent()))throw r;return wr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.dc=e.dc.remove(o),e.wc.delete(n.target),[2]}})})}function Mh(t,o,s){var u=t,a=ci.min(),c=du();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Yo(o),(void 0!==(t=(i=t).wc.get(r))?ca.resolve(i.dc.get(t)):i.fo.er(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.fo.cr(e,t.targetId).next(function(t){c=t})}).next(function(){return u.fc.jr(e,o,s?a:ci.min(),s?c:du())}).next(function(t){return{documents:t,Pc:c}});var t,n,r,i})}function Uh(t,e){var n=t,r=n.fo;return(t=n.dc.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Dn(t,e).next(function(t){return t?t.target:null})})}function jh(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Tc,n=t,t=s.Ec,r=e,i=au,o=ac(t),t=fh(n),n=IDBKeyRange.lowerBound(o,!0),t.ls({index:Fa.readTimeIndex,range:n},function(t,e){var n=sc(r.Kt,e);i=i.Ht(n.key,n),o=e.readTime}).next(function(){return{zo:i,readTime:cc(o)}});var e,n,r,i,o}).then(function(t){var e=t.zo,t=t.readTime;return s.Ec=t,e})}var qh,Fh,Hh=(af.prototype.Ms=function(t,e){return ca.resolve(this.bc.get(e))},af.prototype.Ls=function(t,e){return this.bc.set(e.id,{id:e.id,version:e.version,createTime:qu(e.createTime)}),ca.resolve()},af.prototype.$s=function(t,e){return ca.resolve(this.vc.get(e))},af.prototype.Bs=function(t,e){return this.vc.set(e.name,{name:e.name,query:yc(e.bundledQuery),readTime:qu(e.readTime)}),ca.resolve()},af),Bh=(uf.prototype.nt=function(){return this.Sc.nt()},uf.prototype.sr=function(t,e){e=new Gh(t,e),this.Sc=this.Sc.add(e),this.Cc=this.Cc.add(e)},uf.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.sr(t,e)})},uf.prototype.rr=function(t,e){this.Oc(new Gh(t,e))},uf.prototype.Fc=function(t,e){var n=this;t.forEach(function(t){return n.rr(t,e)})},uf.prototype.kc=function(t){var e=this,n=new pi(new hi([])),r=new Gh(n,t),t=new Gh(n,t+1),i=[];return this.Cc.Ae([r,t],function(t){e.Oc(t),i.push(t.key)}),i},uf.prototype.Mc=function(){var e=this;this.Sc.forEach(function(t){return e.Oc(t)})},uf.prototype.Oc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},uf.prototype.Lc=function(t){var e=new pi(new hi([])),n=new Gh(e,t),t=new Gh(e,t+1),r=du();return this.Cc.Ae([n,t],function(t){r=r.add(t.key)}),r},uf.prototype.ki=function(t){var e=new Gh(t,0);return null!==(e=this.Sc.Pe(e))&&t.isEqual(e.key)},uf),Gh=(sf.Dc=function(t,e){return pi.J(t.key,e.key)||Ar(t.$c,e.$c)},sf.xc=function(t,e){return Ar(t.$c,e.$c)||pi.J(t.key,e.key)},sf),zh=(of.prototype.Ri=function(t){return ca.resolve(0===this.Ho.length)},of.prototype.Pi=function(t,e,n,r){var i=this.Bc;this.Bc++,0<this.Ho.length&&this.Ho[this.Ho.length-1],n=new ec(i,e,n,r),this.Ho.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.qc=this.qc.add(new Gh(u.key,i)),this.Ti.Us(t,u.key.path.Z())}return ca.resolve(n)},of.prototype.yi=function(t,e){return ca.resolve(this.Uc(e))},of.prototype.Vi=function(t,e){return e+=1,e=(e=this.Qc(e))<0?0:e,ca.resolve(this.Ho.length>e?this.Ho[e]:null)},of.prototype.pi=function(){return ca.resolve(0===this.Ho.length?-1:this.Bc-1)},of.prototype.bi=function(t){return ca.resolve(this.Ho.slice())},of.prototype.vi=function(t,e){var n=this,r=new Gh(e,0),e=new Gh(e,Number.POSITIVE_INFINITY),i=[];return this.qc.Ae([r,e],function(t){t=n.Uc(t.$c),i.push(t)}),ca.resolve(i)},of.prototype.Si=function(t,e){var n=this,r=new su(Ar);return e.forEach(function(t){var e=new Gh(t,0),t=new Gh(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,t],function(t){r=r.add(t.$c)})}),ca.resolve(this.Kc(r))},of.prototype.Ci=function(t,e){var n=e.path,r=n.length+1,e=n;pi.Et(e)||(e=e.child(""));var e=new Gh(new pi(e),0),i=new su(Ar);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(i=i.add(t.$c)),!0)},e),ca.resolve(this.Kc(i))},of.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Uc(t))&&n.push(t)}),n},of.prototype.xi=function(n,r){var i=this;Tr(0===this.jc(r.batchId,"removed")),this.Ho.shift();var o=this.qc;return ca.forEach(r.mutations,function(t){var e=new Gh(t.key,r.batchId);return o=o.delete(e),i.Ii.Oi(n,t.key)}).next(function(){i.qc=o})},of.prototype.Ni=function(t){},of.prototype.ki=function(t,e){var n=new Gh(e,0),n=this.qc.Pe(n);return ca.resolve(e.isEqual(n&&n.key))},of.prototype.Fi=function(t){return this.Ho.length,ca.resolve()},of.prototype.jc=function(t,e){return this.Qc(t)},of.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},of.prototype.Uc=function(t){return(t=this.Qc(t))<0||t>=this.Ho.length?null:this.Ho[t]},of),Kh=(rf.prototype.ui=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.Wc(e);return this.docs=this.docs.Ht(r,{li:e,size:o,readTime:n}),this.size+=o-i,this.Ti.Us(t,r.path.Z())},rf.prototype._i=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},rf.prototype.fi=function(t,e){return e=this.docs.get(e),ca.resolve(e?e.li:null)},rf.prototype.getEntries=function(t,e){var n=this,r=au;return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e.li:null)}),ca.resolve(r)},rf.prototype.jr=function(t,e,n){for(var r=fu,i=new pi(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=(u=o.ce()).key,u=(a=u.value).li,a=a.readTime;if(!e.path.st(s.path))break;a.u(n)<=0||u instanceof Zi&&es(e,u)&&(r=r.Ht(u.key,u))}return ca.resolve(r)},rf.prototype.Gc=function(t,e){return ca.forEach(this.docs,function(t){return e(t)})},rf.prototype.Or=function(t){return new Jh(this)},rf.prototype.Mr=function(t){return ca.resolve(this.size)},rf),Jh=(h(nf,Fh=me),nf.prototype.Ei=function(n){var r=this,i=[];return this.oi.forEach(function(t,e){e&&e.li?i.push(r.Gr.ui(n,e.li,r.ai(t))):r.Gr._i(t)}),ca.$n(i)},nf.prototype.di=function(t,e){return this.Gr.fi(t,e)},nf.prototype.wi=function(t,e){return this.Gr.getEntries(t,e)},nf),Wh=(ef.prototype.mn=function(t,n){return this.zc.forEach(function(t,e){return n(e)}),ca.resolve()},ef.prototype.Ki=function(t){return ca.resolve(this.lastRemoteSnapshotVersion)},ef.prototype.ji=function(t){return ca.resolve(this.Hc)},ef.prototype.qi=function(t){return this.highestTargetId=this.Yc.next(),ca.resolve(this.highestTargetId)},ef.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),ca.resolve()},ef.prototype.zi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new Hc(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},ef.prototype.Gi=function(t,e){return this.zi(e),this.targetCount+=1,ca.resolve()},ef.prototype.Ji=function(t,e){return this.zi(e),ca.resolve()},ef.prototype.Yi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),--this.targetCount,ca.resolve()},ef.prototype.Zi=function(n,r,i){var o=this,s=0,u=[];return this.zc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.zc.delete(t),u.push(o.Xi(n,e.targetId)),s++)}),ca.$n(u).next(function(){return s})},ef.prototype.tr=function(t){return ca.resolve(this.targetCount)},ef.prototype.er=function(t,e){return e=this.zc.get(e)||null,ca.resolve(e)},ef.prototype.nr=function(t,e,n){return this.Jc.Nc(e,n),ca.resolve()},ef.prototype.ir=function(e,t,n){this.Jc.Fc(t,n);var r=this.persistence.Ii,i=[];return r&&t.forEach(function(t){i.push(r.Oi(e,t))}),ca.$n(i)},ef.prototype.Xi=function(t,e){return this.Jc.kc(e),ca.resolve()},ef.prototype.cr=function(t,e){return e=this.Jc.Lc(e),ca.resolve(e)},ef.prototype.ki=function(t,e){return ca.resolve(this.Jc.ki(e))},ef),Xh=(tf.prototype.start=function(){return Promise.resolve()},tf.prototype.Lo=function(){return this.ro=!1,Promise.resolve()},Object.defineProperty(tf.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),tf.prototype.yo=function(){},tf.prototype.Vo=function(){},tf.prototype.jo=function(){return this.Ti},tf.prototype.Ko=function(t){var e=this.Xc[t.R()];return e||(e=new zh(this.Ti,this.Ii),this.Xc[t.R()]=e),e},tf.prototype.Dr=function(){return this.fo},tf.prototype.Fr=function(){return this.wo},tf.prototype.Wo=function(){return this.Eo},tf.prototype.runTransaction=function(t,e,n){var r=this;wr("MemoryPersistence","Starting transaction:",t);var i=new Yh(this.io.next());return this.Ii.ta(),n(i).next(function(t){return r.Ii.ea(i).next(function(){return t})}).Mn().then(function(t){return i.ps(),t})},tf.prototype.na=function(e,n){return ca.Bn(Object.values(this.Xc).map(function(t){return function(){return t.ki(e,n)}}))},tf),Yh=(h(Zh,qh=o),Zh),Qh=($h.ra=function(t){return new $h(t)},Object.defineProperty($h.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw Er()},enumerable:!1,configurable:!0}),$h.prototype.sr=function(t,e,n){return this.sa.sr(n,e),this.oa.delete(n.toString()),ca.resolve()},$h.prototype.rr=function(t,e,n){return this.sa.rr(n,e),this.oa.add(n.toString()),ca.resolve()},$h.prototype.Oi=function(t,e){return this.oa.add(e.toString()),ca.resolve()},$h.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Dr();return r.cr(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Yi(t,e)})},$h.prototype.ta=function(){this.ia=new Set},$h.prototype.ea=function(n){var r=this,i=this.persistence.Fr().Or();return ca.forEach(this.oa,function(t){var e=pi.ft(t);return r.ca(n,e).next(function(t){t||i._i(e)})}).next(function(){return r.ia=null,i.apply(n)})},$h.prototype.kr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},$h.prototype.Zc=function(t){return 0},$h.prototype.ca=function(t,e){var n=this;return ca.Bn([function(){return ca.resolve(n.sa.ki(e))},function(){return n.persistence.Dr().ki(t,e)},function(){return n.persistence.na(t,e)}])},$h);function $h(t){this.persistence=t,this.sa=new Bh,this.ia=null}function Zh(t){var e=this;return(e=qh.call(this)||this).vs=t,e}function tf(t,e){var n=this;this.Xc={},this.io=new ti(0),this.ro=!1,this.ro=!0,this.Ii=t(this),this.fo=new Wh(this),this.Ti=new bc,this.wo=(t=this.Ti,new Kh(t,function(t){return n.Ii.Zc(t)})),this.Kt=new rc(e),this.Eo=new Hh(this.Kt)}function ef(t){this.persistence=t,this.zc=new kc(uo,ao),this.lastRemoteSnapshotVersion=ci.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new Bh,this.targetCount=0,this.Yc=Hc.$i()}function nf(t){var e=this;return(e=Fh.call(this)||this).Gr=t,e}function rf(t,e){this.Ti=t,this.Wc=e,this.docs=new Zs(pi.J),this.size=0}function of(t,e){this.Ti=t,this.Ii=e,this.Ho=[],this.Bc=1,this.qc=new su(Gh.Dc)}function sf(t,e){this.key=t,this.$c=e}function uf(){this.Sc=new su(Gh.Dc),this.Cc=new su(Gh.xc)}function af(t){this.Kt=t,this.bc=new Map,this.vc=new Map}function cf(t,e){return"firestore_clients_"+t+"_"+e}function hf(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.A()&&(n+="_"+e.uid),n}function ff(t,e){return"firestore_targets_"+t+"_"+e}var lf,pf=(Vf.aa=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Cr(r.error.code,r.error.message)),i?new Vf(t,e,r.state,o):(br("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Vf.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Vf),df=(Rf.aa=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Cr(n.error.code,n.error.message)),r?new Rf(t,n.state,i):(br("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Rf.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Rf),yf=(Cf.aa=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=yu,o=0;r&&o<n.activeTargetIds.length;++o)r=Li(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Cf(t,i):(br("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Cf),vf=(Lf.aa=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Lf(e.clientId,e.onlineState):(br("SharedClientState","Failed to parse online state: "+t),null)},Lf),gf=(Pf.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Pf.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Pf.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},Pf),mf=(kf.jn=function(t){return!(!t||!t.localStorage)},kf.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.fa.Qo()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this._a&&(i=this.getItem(cf(this.persistenceKey,r)))&&(o=yf.aa(r,i))&&(this.Ta=this.Ta.Ht(o.clientId,o));for(this.pa(),(s=this.storage.getItem(this.ga))&&(u=this.ba(s))&&this.va(u),a=0,c=this.Ia;a<c.length;a++)h=c[a],this.Ea(h);return this.Ia=[],this.window.addEventListener("unload",function(){return f.Lo()}),this.Tr=!0,[2]}})})},kf.prototype.q=function(t){this.setItem(this.Aa,JSON.stringify(t))},kf.prototype.Sa=function(){return this.Da(this.Ta)},kf.prototype.Ca=function(n){var r=!1;return this.Ta.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},kf.prototype.xa=function(t){this.Na(t,"pending")},kf.prototype.Oa=function(t,e,n){this.Na(t,e,n),this.Fa(t)},kf.prototype.ka=function(t){var e,n="not-current";return this.Ca(t)&&(!(e=this.storage.getItem(ff(this.persistenceKey,t)))||(e=df.aa(t,e))&&(n=e.state)),this.Ma.ha(t),this.pa(),n},kf.prototype.La=function(t){this.Ma.la(t),this.pa()},kf.prototype.$a=function(t){return this.Ma.activeTargetIds.has(t)},kf.prototype.Ba=function(t){this.removeItem(ff(this.persistenceKey,t))},kf.prototype.qa=function(t,e,n){this.Ua(t,e,n)},kf.prototype.Qa=function(t,e,n){var r=this;e.forEach(function(t){r.Fa(t)}),this.currentUser=t,n.forEach(function(t){r.xa(t)})},kf.prototype.Ka=function(t){this.ja(t)},kf.prototype.Wa=function(){this.Ga()},kf.prototype.Lo=function(){this.Tr&&(this.window.removeEventListener("storage",this.wa),this.removeItem(this.ma),this.Tr=!1)},kf.prototype.getItem=function(t){var e=this.storage.getItem(t);return wr("SharedClientState","READ",t,e),e},kf.prototype.setItem=function(t,e){wr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},kf.prototype.removeItem=function(t){wr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},kf.prototype.Ea=function(t){var e=this,o=t;o.storageArea===this.storage&&(wr("SharedClientState","EVENT",o.key,o.newValue),o.key!==this.ma?this.eo.bo(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.Tr){if(null!==o.key)if(this.Ra.test(o.key)){if(null==o.newValue)return e=this.za(o.key),[2,this.Ha(e,null)];if(e=this.Ja(o.key,o.newValue))return[2,this.Ha(e.clientId,e)]}else if(this.Pa.test(o.key)){if(null!==o.newValue&&(n=this.Ya(o.key,o.newValue)))return[2,this.Xa(n)]}else if(this.ya.test(o.key)){if(null!==o.newValue&&(r=this.Za(o.key,o.newValue)))return[2,this.tu(r)]}else if(o.key===this.ga){if(null!==o.newValue&&(i=this.ba(o.newValue)))return[2,this.va(i)]}else if(o.key===this.Aa)(i=function(t){var e=ti.U;if(null!=t)try{var n=JSON.parse(t);Tr("number"==typeof n),e=n}catch(t){br("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==ti.U&&this.L(i);else if(o.key===this.Va)return[2,this.fa.eu()]}else this.Ia.push(o);return[2]})})}):br("Received WebStorage notification for local change. Another client might have garbage-collected our state"))},Object.defineProperty(kf.prototype,"Ma",{get:function(){return this.Ta.get(this._a)},enumerable:!1,configurable:!0}),kf.prototype.pa=function(){this.setItem(this.ma,this.Ma.ua())},kf.prototype.Na=function(t,e,n){n=new pf(this.currentUser,t,e,n),t=hf(this.persistenceKey,this.currentUser,t),this.setItem(t,n.ua())},kf.prototype.Fa=function(t){t=hf(this.persistenceKey,this.currentUser,t),this.removeItem(t)},kf.prototype.ja=function(t){t={clientId:this._a,onlineState:t},this.storage.setItem(this.ga,JSON.stringify(t))},kf.prototype.Ua=function(t,e,n){var r=ff(this.persistenceKey,t),n=new df(t,e,n);this.setItem(r,n.ua())},kf.prototype.Ga=function(){this.setItem(this.Va,"value-not-used")},kf.prototype.za=function(t){return(t=this.Ra.exec(t))?t[1]:null},kf.prototype.Ja=function(t,e){return t=this.za(t),yf.aa(t,e)},kf.prototype.Ya=function(t,e){var n=this.Pa.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return pf.aa(new zr(n),t,e)},kf.prototype.Za=function(t,e){return t=this.ya.exec(t),t=Number(t[1]),df.aa(t,e)},kf.prototype.ba=function(t){return vf.aa(t)},kf.prototype.Xa=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.fa.nu(e.batchId,e.state,e.error)]:(wr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},kf.prototype.tu=function(t){return this.fa.su(t.targetId,t.state,t.error)},kf.prototype.Ha=function(t,e){var n=this,r=e?this.Ta.Ht(t,e):this.Ta.remove(t),i=this.Da(this.Ta),o=this.Da(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fa.iu(s,u).then(function(){n.Ta=r})},kf.prototype.va=function(t){this.Ta.get(t.clientId)&&this.da(t.onlineState)},kf.prototype.Da=function(t){var n=yu;return t.forEach(function(t,e){n=n.ye(e.activeTargetIds)}),n},kf),wf=(Of.prototype.xa=function(t){},Of.prototype.Oa=function(t,e,n){},Of.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},Of.prototype.qa=function(t,e,n){this.ou[t]=e},Of.prototype.La=function(t){this.ru.la(t)},Of.prototype.$a=function(t){return this.ru.activeTargetIds.has(t)},Of.prototype.Ba=function(t){delete this.ou[t]},Of.prototype.Sa=function(){return this.ru.activeTargetIds},Of.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},Of.prototype.start=function(){return this.ru=new gf,Promise.resolve()},Of.prototype.Qa=function(t,e,n){},Of.prototype.Ka=function(t){},Of.prototype.Lo=function(){},Of.prototype.q=function(t){},Of.prototype.Wa=function(){},Of),bf=(Df.prototype.cu=function(t){},Df.prototype.Lo=function(){},Df),If=(xf.prototype.cu=function(t){this._u.push(t)},xf.prototype.Lo=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},xf.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},xf.prototype.uu=function(){wr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},xf.prototype.lu=function(){wr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},xf.jn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},xf),_f={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Ef=(Af.prototype.Eu=function(t){this.Tu=t},Af.prototype.Iu=function(t){this.mu=t},Af.prototype.onMessage=function(t){this.Au=t},Af.prototype.close=function(){this.wu()},Af.prototype.send=function(t){this.du(t)},Af.prototype.Ru=function(){this.Tu()},Af.prototype.Pu=function(t){this.mu(t)},Af.prototype.yu=function(t){this.Au(t)},Af),Tf=(Sf.prototype.bu=function(e,t,n,r){var i=this.vu(e,t);return wr("RestConnection","Sending: ",i,n),t={},this.Su(t,r),this.Du(e,i,t,n).then(function(t){return wr("RestConnection","Received: ",t),t},function(t){throw Ir("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Sf.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},Sf.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.3",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},Sf.prototype.vu=function(t,e){return t=_f[t],this.Vu+"/v1/"+e+":"+t},h(Nf,lf=Sf),Nf.prototype.Du=function(o,e,s,u){return new Promise(function(n,r){var i=new vr;i.listenOnce(pr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case lr.NO_ERROR:var t=i.getResponseJson();wr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case lr.TIMEOUT:wr("Connection",'RPC "'+o+'" timed out'),r(new Cr(Lr.DEADLINE_EXCEEDED,"Request time out"));break;case lr.HTTP_ERROR:var e=i.getStatus();wr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(Lr).indexOf(e)?e:Lr.UNKNOWN,r(new Cr(e,t.message))):r(new Cr(Lr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Cr(Lr.UNAVAILABLE,"Connection failed."));break;default:Er()}}finally{wr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Nf.prototype.xu=function(t,e){var n,r=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,o=fr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),wr("Connection","Creating WebChannel: "+(r=r.join("")),t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new Ef({du:function(t){a?wr("Connection","Not sending because WebChannel is closed:",t):(u||(wr("Connection","Opening WebChannel transport."),s.open(),u=!0),wr("Connection","WebChannel sending:",t),s.send(t))},wu:function(){return s.close()}});return(t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})})(s,yr.EventType.OPEN,function(){a||wr("Connection","WebChannel transport opened.")}),t(s,yr.EventType.CLOSE,function(){a||(a=!0,wr("Connection","WebChannel transport closed"),c.Pu())}),t(s,yr.EventType.ERROR,function(t){a||(a=!0,Ir("Connection","WebChannel transport errored:",t),c.Pu(new Cr(Lr.UNAVAILABLE,"The operation could not be completed")))}),t(s,yr.EventType.MESSAGE,function(t){var e,n,r,i;a||(Tr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(wr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Gs[r];if(void 0!==t)return $s(t)}(),i=n.message,void 0===t&&(t=Lr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.Pu(new Cr(t,i)),s.close()):(wr("Connection","WebChannel received:",e),c.yu(e)))}),t(o,dr.STAT_EVENT,function(t){10===t.stat?wr("Connection","Detected buffering proxy"):11===t.stat&&wr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Ru()},0),c},Nf);function Nf(t){var e=this;return(e=lf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.I=t.I,e}function Sf(t){this.gu=t,this.T=t.T;var e=t.ssl?"https":"http";this.Vu=e+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}function Af(t){this.du=t.du,this.wu=t.wu}function xf(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}function Df(){}function Of(){this.ru=new gf,this.ou={},this.da=null,this.L=null}function kf(t,e,n,r,i){this.window=t,this.eo=e,this.persistenceKey=n,this._a=r,this.fa=null,this.da=null,this.L=null,this.wa=this.Ea.bind(this),this.Ta=new Zs(Ar),this.Tr=!1,this.Ia=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.ma=cf(this.persistenceKey,this._a),this.Aa="firestore_sequence_number_"+this.persistenceKey,this.Ta=this.Ta.Ht(this._a,new gf),this.Ra=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Pa=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.ya=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.ga="firestore_online_state_"+this.persistenceKey,this.Va="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.wa)}function Pf(){this.activeTargetIds=yu}function Lf(t,e){this.clientId=t,this.onlineState=e}function Cf(t,e){this.clientId=t,this.activeTargetIds=e}function Rf(t,e,n){this.targetId=t,this.state=e,this.error=n}function Vf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Mf(){return"undefined"!=typeof window?window:null}function Uf(){return"undefined"!=typeof document?document:null}function jf(t){return new Mu(t,!0)}function qf(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Oh=new Set,this.Fh=[],this.kh=i,this.kh.cu(function(t){n.ys(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return cl(this)?(wr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Oh.add(4),[4,nl(e)];case 1:return t.sent(),e.Mh.set("Unknown"),e.Oh.delete(4),[4,el(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Mh=new Wf(n,r)}var Ff,Hf,Bf,Gf=(tl.prototype.reset=function(){this.ku=0},tl.prototype.$u=function(){this.ku=this.Fu},tl.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.Lu),i=Math.max(0,n-r);0<i&&wr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.eo.Ir(this.ds,i,function(){return e.Lu=Date.now(),t()}),this.ku*=this.Ou,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Fu&&(this.ku=this.Fu)},tl.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},tl.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},tl.prototype.qu=function(){return(Math.random()-.5)*this.ku},tl),me=(Zf.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},Zf.prototype.Ju=function(){return 2===this.state},Zf.prototype.start=function(){3!==this.state?this.auth():this.Yu()},Zf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Zf.prototype.Xu=function(){this.state=0,this.zu.reset()},Zf.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.eo.Ir(this.Qu,6e4,function(){return t.th()}))},Zf.prototype.eh=function(t){this.nh(),this.stream.send(t)},Zf.prototype.th=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Ju()?[2,this.close(0)]:[2]})})},Zf.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},Zf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.nh(),this.zu.cancel(),this.Wu++,3!==e?this.zu.reset():n&&n.code===Lr.RESOURCE_EXHAUSTED?(br(n.toString()),br("Using maximum backoff delay to prevent overloading the backend."),this.zu.$u()):n&&n.code===Lr.UNAUTHENTICATED&&this.ju.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Iu(n)];case 1:return t.sent(),[2]}})})},Zf.prototype.sh=function(){},Zf.prototype.auth=function(){var n=this;this.state=1;var t=this.ih(this.Wu),e=this.Wu;this.ju.getToken().then(function(t){n.Wu===e&&n.rh(t)},function(e){t(function(){var t=new Cr(Lr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.oh(t)})})},Zf.prototype.rh=function(t){var e=this,n=this.ih(this.Wu);this.stream=this.ah(t),this.stream.Eu(function(){n(function(){return e.state=2,e.listener.Eu()})}),this.stream.Iu(function(t){n(function(){return e.oh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Zf.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Zf.prototype.oh=function(t){return wr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Zf.prototype.ih=function(e){var n=this;return function(t){n.eo.ys(function(){return n.Wu===e?t():(wr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Zf),zf=(h($f,Bf=me),$f.prototype.ah=function(t){return this.Ku.xu("Listen",t)},$f.prototype.onMessage=function(t){this.zu.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Er(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.qt?(Tr(void 0===s||"string"==typeof s),Or.fromBase64String(s||"")):(Tr(void 0===s||s instanceof Uint8Array),Or.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?Lr.UNKNOWN:$s(c.code),new Cr(a,c.message||"")),s=new Eu(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=Gu(t,n.document.name),i=qu(n.document.updateTime);var u=new Ki({mapValue:{fields:n.document.fields}}),a=(o=new Zi(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[],s=new Iu(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=Gu(t,n.document),i=n.readTime?qu(n.readTime):ci.min(),u=new to(r,i),o=n.removedTargetIds||[],s=new Iu([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=Gu(t,n.document),i=n.removedTargetIds||[],s=new Iu([],i,r,null);else{if(!("filter"in e))return Er();e.filter,(e=e.filter).targetId,r=new Bs(n=e.count||0),i=e.targetId,s=new _u(i,r)}return s}(this.Kt,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?ci.min():qu(e.readTime);return this.listener.uh(n,t)},$f.prototype.hh=function(t){var e,n,r,i,o={};o.database=Ju(this.Kt),o.addTarget=(e=this.Kt,(r=co(r=(n=t).target)?{documents:Zu(e,r)}:{query:ta(e,r)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=ju(e,n.resumeToken):0<n.Mt.u(ci.min())&&(r.readTime=Uu(e,n.Mt.G())),r),(t=(this.Kt,i=t,null==(t=function(){switch(i.kt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Er()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.eh(o)},$f.prototype.lh=function(t){var e={};e.database=Ju(this.Kt),e.removeTarget=t,this.eh(e)},$f),Kf=(h(Qf,Hf=me),Object.defineProperty(Qf.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),Qf.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,Hf.prototype.start.call(this)},Qf.prototype.sh=function(){this._h&&this.dh([])},Qf.prototype.ah=function(t){return this.Ku.xu("Write",t)},Qf.prototype.onMessage=function(t){if(Tr(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Tr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?qu(e.updateTime):qu(n)).isEqual(ci.min())&&(t=qu(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new Ns(t,n);var e,n})):[]),n=qu(t.commitTime);return this.listener.wh(n,e)}var r;return Tr(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},Qf.prototype.Th=function(){var t={};t.database=Ju(this.Kt),this.eh(t)},Qf.prototype.dh=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Qu(e.Kt,t)})};this.eh(t)},Qf),Jf=(h(Yf,Ff=function(){}),Yf.prototype.mh=function(){if(this.Ih)throw new Cr(Lr.FAILED_PRECONDITION,"The client has already been terminated.")},Yf.prototype.bu=function(e,n,r){var i=this;return this.mh(),this.credentials.getToken().then(function(t){return i.Ku.bu(e,n,r,t)}).catch(function(t){throw t.code===Lr.UNAUTHENTICATED&&i.credentials.v(),t})},Yf.prototype.Cu=function(e,n,r){var i=this;return this.mh(),this.credentials.getToken().then(function(t){return i.Ku.Cu(e,n,r,t)}).catch(function(t){throw t.code===Lr.UNAUTHENTICATED&&i.credentials.v(),t})},Yf.prototype.terminate=function(){this.Ih=!1},Yf),Wf=(Xf.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.Ir("online_state_timeout",1e4,function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()}))},Xf.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,1<=this.Ah&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},Xf.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},Xf.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},Xf.prototype.Vh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Ph?(br(t),this.Ph=!1):wr("OnlineStateTracker",t)},Xf.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},Xf);function Xf(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}function Yf(t,e,n){var r=this;return(r=Ff.call(this)||this).credentials=t,r.Ku=e,r.Kt=n,r.Ih=!1,r}function Qf(t,e,n,r,i){var o=this;return(o=Hf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).Kt=r,o._h=!1,o}function $f(t,e,n,r,i){var o=this;return(o=Bf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).Kt=r,o}function Zf(t,e,n,r,i,o){this.eo=t,this.Qu=n,this.Ku=r,this.ju=i,this.listener=o,this.state=0,this.Wu=0,this.Gu=null,this.stream=null,this.zu=new Gf(t,e)}function tl(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.eo=t,this.ds=e,this.Nu=n,this.Ou=r,this.Fu=i,this.ku=0,this.Mu=null,this.Lu=Date.now(),this.reset()}function el(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!cl(r))return[3,4];e=0,n=r.Fh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function nl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Fh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function rl(t,e){t.Nh.has(e.targetId)||(t.Nh.set(e.targetId,e),al(t)?ul(t):gl(t).Ju()&&ol(t,e))}function il(t,e){var n=t,t=gl(n);n.Nh.delete(e),t.Ju()&&sl(n,e),0===n.Nh.size&&(t.Ju()?t.Zu():cl(n)&&n.Mh.set("Unknown"))}function ol(t,e){t.Lh.cn(e.targetId),gl(t).hh(e)}function sl(t,e){t.Lh.cn(e),gl(t).lh(e)}function ul(e){e.Lh=new Nu({Sn:function(t){return e.Ch.Sn(t)},Dn:function(t){return e.Nh.get(t)||null}}),gl(e).start(),e.Mh.yh()}function al(t){return cl(t)&&!gl(t).Hu()&&0<t.Nh.size}function cl(t){return 0===t.Oh.size}function hl(t){t.Lh=void 0}function fl(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!wa(r))throw r;return n.Oh.add(1),[4,nl(n)];case 1:return t.sent(),n.Mh.set("Offline"),i=i||function(){return Lh(n.Sh)},n.fs.bo(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return wr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Oh.delete(1),[4,el(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function ll(e,n){return n().catch(function(t){return fl(e,t,n)})}function pl(c){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=ml(o=c),u=0<o.xh.length?o.xh[o.xh.length-1].batchId:-1,t.label=1;case 1:if(!(cl(o)&&o.xh.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.Sh,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.Ho.Vi(t,r)}))];case 3:return null===(a=t.sent())?(0===o.xh.length&&s.Zu(),[3,7]):(u=a.batchId,e=a,(n=o).xh.push(e),(n=ml(n)).Ju()&&n.fh&&n.dh(e.mutations),[3,6]);case 4:return a=t.sent(),[4,fl(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return dl(o)&&yl(o),[2]}var e,n,r,i})})}function dl(t){return cl(t)&&!ml(t).Hu()&&0<t.xh.length}function yl(t){ml(t).start()}function vl(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Oh.delete(2),[4,el(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Oh.add(2),[4,nl(e)]);case 3:t.sent(),e.Mh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function gl(n){var t,e,r,i=this;return n.Qh||(n.Qh=(t=n.Dh,e=n.fs,r={Eu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Nh.forEach(function(t,e){ol(n,t)}),[2]})})}.bind(null,n),Iu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return hl(e),al(e)?(e.Mh.ph(n),ul(e)):e.Mh.set("Unknown"),[2]})})}.bind(null,n),uh:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Mh.set("Online"),!(u instanceof Eu&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Nh.has(i)?[4,o.Ch.$h(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Nh.delete(i),o.Lh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),wr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,fl(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Iu?s.Lh.wn(u):u instanceof _u?s.Lh.yn(u):s.Lh.In(u),a.isEqual(ci.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Lh(s.Sh)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).Lh.pn(i)).Fe.forEach(function(t,e){var n;0<t.resumeToken.o()&&(n=r.Nh.get(e))&&r.Nh.set(e,n.$t(t.resumeToken,i))}),e.ke.forEach(function(t){var e=r.Nh.get(t);e&&(r.Nh.set(t,e.$t(Or.h,e.Mt)),sl(r,t),e=new rs(e.target,t,1,e.sequenceNumber),ol(r,e))}),r.Ch.Bh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return wr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,fl(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.mh(),new zf(e,t.Ku,t.credentials,t.Kt,r)),n.Fh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Qh.Xu(),al(n)?ul(n):n.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Qh.stop()];case 2:t.sent(),hl(n),t.label=3;case 3:return[2]}})})})),n.Qh}function ml(n){var t,e,r,i=this;return n.Kh||(n.Kh=(t=n.Dh,e=n.fs,r={Eu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return ml(e).Th(),[2]})})}.bind(null,n),Iu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&ml(e).fh?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Qs(n=i.code)&&n!==Lr.ABORTED?(e=r.xh.shift(),ml(r).Xu(),[4,ll(r,function(){return r.Ch.Uh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,pl(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return dl(e)&&yl(e),[2]}})})}.bind(null,n),Eh:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=ml(o),n=0,r=o.xh;n<r.length;n++)i=r[n],e.dh(i.mutations);return[2]})})}.bind(null,n),wh:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.xh.shift(),n=nc.from(e,i,o),[4,ll(r,function(){return r.Ch.qh(n)})];case 1:return t.sent(),[4,pl(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.mh(),new Kf(e,t.Ku,t.credentials,t.Kt,r)),n.Fh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Kh.Xu(),[4,pl(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Kh.stop()];case 3:t.sent(),0<n.xh.length&&(wr("RemoteStore","Stopping write stream with "+n.xh.length+" pending writes"),n.xh=[]),t.label=4;case 4:return[2]}})})})),n.Kh}function wl(){this.queries=new kc(Zo,$o),this.onlineState="Unknown",this.Wh=new Set}var bl=function(){this.jh=void 0,this.listeners=[]};function Il(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new bl),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Gh(n)];case 2:return o.jh=t.sent(),[3,4];case 3:return o=Aa(o=t.sent(),"Initialization of query '"+ts(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.zh(e.onlineState),i.jh&&u.Hh(i.jh)&&El(e),[2]}})})}function _l(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Jh(n))]:[2]})})}function El(t){t.Wh.forEach(function(t){t.next()})}var Tl=(kl.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new mu(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},kl.prototype.onError=function(t){this.Yh.error(t)},kl.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},kl.prototype.el=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.sl&&n||t.docs.nt()&&"Offline"!==e)},kl.prototype.tl=function(t){if(0<t.docChanges.length)return!0;var e=this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites;return!(!t.xe&&!e)&&!0===this.options.includeMetadataChanges},kl.prototype.nl=function(t){t=mu.Oe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},kl),Nl=(Ol.prototype.il=function(){return"metadata"in this.payload},Ol),Sl=(Dl.prototype.yc=function(t){return Gu(this.Kt,t)},Dl.prototype.gc=function(t){return t.metadata.exists?Yu(this.Kt,t.document,!1):new to(this.yc(t.metadata.name),this.Vc(t.metadata.readTime))},Dl.prototype.Vc=qu,Dl),Al=(xl.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},xl.prototype.cl=function(t){for(var e=new Map,n=new Sl(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||du()).add(s);e.set(c,h)}}return e},xl.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,l,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,u,a,c,h;return v(this,function(t){switch(t.label){case 0:for(n=f,r=du(),i=au,o=lu,e=0,s=p;e<s.length;e++)u=s[e],a=l.yc(u.metadata.name),u.document&&(r=r.add(a)),i=i.Ht(a,l.gc(u)),o=o.Ht(a,l.Vc(u.metadata.readTime));return c=n.Tc.Or({Wr:!0}),[4,Rh(n,Yo(Bo(hi.ct("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Ch(e,c,i,ci.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.fo.Xi(e,h.targetId).next(function(){return n.fo.nr(e,r,h.targetId)}).next(function(){return n.Ic.tc(e,t)})})})]}})})}(this.Sh,new Sl(this.Kt),this.documents,this.rl.id)];case 1:e=t.sent(),n=this.cl(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=du()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Rh(e,Yo(yc(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=qu(i.readTime);return 0<=n.Mt.u(e)?r.Eo.Bs(t,i):(e=n.$t(Or.h,e),r.dc=r.dc.Ht(e.targetId,e),r.fo.Ji(t,e).next(function(){return r.fo.Xi(t,n.targetId)}).next(function(){return r.fo.nr(t,o,n.targetId)}).next(function(){return r.Eo.Bs(t,i)}))})]}})})}(this.Sh,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new _h(Object.assign({},this.progress),e))]}})})},xl);function xl(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=Pl(t)}function Dl(t){this.Kt=t}function Ol(t,e){this.payload=t,this.byteLength=e}function kl(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}function Pl(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Ll=function(t){this.key=t},Cl=function(t){this.key=t},Rl=(Object.defineProperty(ql.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),ql.prototype.dl=function(t,e){var s=this,u=e?e.wl:new gu,a=(e||this)._l,c=(e||this).Ce,h=a,f=!1,l=Go(this.query)&&a.size===this.query.limit?a.last():null,p=zo(this.query)&&a.size===this.query.limit?a.first():null;if(t.Zt(function(t,e){var n=a.get(t),r=(r=e instanceof Zi?e:null)&&(es(s.query,r)?r:null),i=!!n&&s.Ce.has(n.key),o=!!r&&(r.bt||s.Ce.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.El(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.ll(r,l)||p&&s.ll(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),Go(this.query)||zo(this.query))for(;h.size>this.query.limit;){var n=Go(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{_l:h,wl:u,_c:f,Ce:c}},ql.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},ql.prototype.Ei=function(t,e,n){var o=this,r=this._l;this._l=t._l,this.Ce=t.Ce;var i=t.wl.Se();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.ll(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Er()}}var r,i}),this.Tl(n);var s=e?this.Il():[],e=(n=0===this.hl.size&&this.qe?1:0)!==this.ul;return this.ul=n,0!==i.length||e?{snapshot:new mu(this.query,t._l,r,i,t.Ce,0==n,e,!1),ml:s}:{ml:s}},ql.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ei({_l:this._l,wl:new gu,Ce:this.Ce,_c:!1},!1)):{ml:[]}},ql.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},ql.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e.al=e.al.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e.al=e.al.delete(t)}),this.qe=t.qe)},ql.prototype.Il=function(){var e=this;if(!this.qe)return[];var n=this.hl;this.hl=du(),this._l.forEach(function(t){e.Al(t.key)&&(e.hl=e.hl.add(t.key))});var r=[];return n.forEach(function(t){e.hl.has(t)||r.push(new Cl(t))}),this.hl.forEach(function(t){n.has(t)||r.push(new Ll(t))}),r},ql.prototype.Rl=function(t){return this.al=t.Pc,this.hl=du(),t=this.dl(t.documents),this.Ei(t,!0)},ql.prototype.Pl=function(){return mu.Oe(this.query,this._l,this.Ce,0===this.ul)},ql),Vl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Ml=function(t){this.key=t,this.yl=!1},Ul=(Object.defineProperty(jl.prototype,"$l",{get:function(){return!0===this.Ll},enumerable:!1,configurable:!0}),jl);function jl(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new kc(Zo,$o),this.Dl=new Map,this.Cl=[],this.xl=new Zs(pi.J),this.Nl=new Map,this.Ol=new Bh,this.Fl={},this.kl=new Map,this.Ml=Hc.Bi(),this.onlineState="Unknown",this.Ll=void 0}function ql(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=du(),this.Ce=du(),this.ll=ns(t),this._l=new vu(this.ll)}function Fl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Bl=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.dl(o))._c?[4,Mh(r.Sh,i.query,!1).then(function(t){return t=t.documents,i.view.dl(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Fe.get(i.targetId),n=i.view.Ei(e,r.$l,n),[2,(Yl(r,i.targetId,n.ml),n.snapshot)]}})})}(i,t,e,n)},[4,Mh(i.Sh,o,!0)];case 1:return n=t.sent(),r=new Rl(o,n.Pc),e=r.dl(n.documents),n=bu.Be(s,u&&"Offline"!==i.onlineState),n=r.Ei(e,i.$l,n),Yl(i,s,n.ml),r=new Vl(o,s,r),[2,(i.Sl.set(o,r),i.Dl.has(s)?i.Dl.get(s).push(o):i.Dl.set(s,[o]),n.snapshot)]}})})}function Hl(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=np(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Sh,a=p,h=i,f=ai.now(),o=a.reduce(function(t,e){return t.add(e.key)},du()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ic.Zo(u,o).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Zi?e.field(o.field):void 0;null!=(s=as(o.transform,s||null))&&(n=(null==n?new Ji:n).set(o.field,s))}return n?n.yt():null}(e.fieldTransforms,s));null!=s&&n.push(new Vs(o.key,s,function s(t){var u=[];return Ii(t.fields||{},function(t,e){var n=new li([t]);if(zi(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ei(u)}(s.proto.mapValue),As.exists(!0)))}return h.Ho.Pi(u,f,n,a)})}).then(function(t){var e=t.Ns(c);return{batchId:t.batchId,oi:e}}))];case 2:return s=t.sent(),u.pl.xa(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.Fl[e.currentUser.R()])||new Zs(Ar)).Ht(n,r),e.Fl[e.currentUser.R()]=i,[4,$l(u,s.oi)];case 3:return t.sent(),[4,pl(u.gl)];case 4:return t.sent(),[3,6];case 5:return u=Aa(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function Bl(o,s){return y(this,void 0,void 0,function(){var n,i;return v(this,function(t){switch(t.label){case 0:n=o,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Sh,a=e,c=(r=s).Mt,h=a.dc,a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Tc.Or({Wr:!0});h=a.dc;var u=[];r.Fe.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.fo.ir(s,t.Ke,e).next(function(){return a.fo.nr(s,t.Ue,e)})),0<(i=t.resumeToken).o()&&(n=o.$t(i,c).Lt(s.vs),h=h.Ht(e,n),r=o,i=t,Tr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.Mt.W()-r.Mt.W()||0<i.Ue.size+i.Qe.size+i.Ke.size)&&u.push(a.fo.Ji(s,n))))});var e,n=au;return r.Me.forEach(function(t,e){r.Le.has(t)&&u.push(a.persistence.Ii.kr(s,t))}),u.push(Ch(s,t,r.Me,c,void 0).next(function(t){n=t})),c.isEqual(ci.min())||(e=a.fo.Ki(s).next(function(t){return a.fo.Wi(s,s.vs,c)}),u.push(e)),ca.$n(u).next(function(){return t.apply(s)}).next(function(){return a.Ic.tc(s,n)})}).then(function(t){return a.dc=h,t}))];case 2:return i=t.sent(),s.Fe.forEach(function(t,e){(e=n.Nl.get(e))&&(Tr(t.Ue.size+t.Qe.size+t.Ke.size<=1),0<t.Ue.size?e.yl=!0:0<t.Qe.size?Tr(e.yl):0<t.Ke.size&&(Tr(e.yl),e.yl=!1))}),[4,$l(n,i,s)];case 3:return t.sent(),[3,6];case 4:return[4,Oc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,a,c,h})})}function Gl(t,n,e){var r;((t=t).$l&&0===e||!t.$l&&1===e)&&(r=[],t.Sl.forEach(function(t,e){(e=e.view.zh(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].zh(i)&&(o=!0)}),o&&El(t)}(t.Vl,n),r.length&&t.vl.uh(r),t.onlineState=n,t.$l&&t.pl.Ka(n))}function zl(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:cl((n=o).gl)||wr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Sh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.pi(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.kl.get(r)||[]).push(s),n.kl.set(r,i),[3,4]);case 3:return i=Aa(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Kl(t,e){(t.kl.get(e)||[]).forEach(function(t){t.resolve()}),t.kl.delete(e)}function Jl(t,e,n){var r=t,i=r.Fl[r.currentUser.R()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Fl[r.currentUser.R()]=i)}function Wl(e,t,n){void 0===n&&(n=null),e.pl.La(t);for(var r=0,i=e.Dl.get(t);r<i.length;r++){var o=i[r];e.Sl.delete(o),n&&e.vl.ql(o,n)}e.Dl.delete(t),e.$l&&e.Ol.kc(t).forEach(function(t){e.Ol.ki(t)||Xl(e,t)})}function Xl(t,e){var n=t.xl.get(e);null!==n&&(il(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),Ql(t))}function Yl(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Ll?(t.Ol.sr(u.key,e),r=t,i=(i=u).key,r.xl.get(i)||(wr("SyncEngine","New document in limbo: "+i),r.Cl.push(i),Ql(r))):u instanceof Cl?(wr("SyncEngine","Document no longer in limbo: "+u.key),t.Ol.rr(u.key,e),t.Ol.ki(u.key)||Xl(t,u.key)):Er()}}function Ql(t){for(;0<t.Cl.length&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new Ml(e)),t.xl=t.xl.Ht(e,n),rl(t.gl,new rs(Yo(Bo(e.path)),n,2,ti.U))}}function $l(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Sl.nt()?[3,3]:(n.Sl.forEach(function(t,e){o.push(n.Bl(e,s,u).then(function(t){t&&(n.$l&&n.pl.qa(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Th.cc(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.vl.uh(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ca.forEach(c,function(e){return ca.forEach(e.rc,function(t){return r.persistence.Ii.sr(n,e.targetId,t)}).next(function(){return ca.forEach(e.oc,function(t){return r.persistence.Ii.rr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!wa(e=t.sent()))throw e;return wr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.dc.get(o),u=s.Mt,u=s.Bt(u),r.dc=r.dc.Ht(o,u));return[2]}})})}(n.Sh,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Zl(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Dl.get(s))&&0!==a.length?[4,Rh(e.Sh,Yo(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Sl.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Mh((e=r).Sh,i.query,!0)];case 1:return n=t.sent(),n=i.view.Rl(n),[2,(e.$l&&Yl(e,i.targetId,n.ml),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Uh(e.Sh,s)];case 8:return l=t.sent(),[4,Rh(e.Sh,l)];case 9:return u=t.sent(),[4,Fl(e,tp(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.vl.uh(r),n)]}})})}function tp(t){return Ho(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function ep(t){return t.gl.Ch.Bh=Bl.bind(null,t),t.gl.Ch.Sn=function(t,e){var n=t;if((t=n.Nl.get(e))&&t.yl)return du().add(t.key);var r=du();if(!(e=n.Dl.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Sl.get(s),r=r.ye(s.view.fl);return r}.bind(null,t),t.gl.Ch.$h=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).pl.qa(s,"rejected",u),i=e.Nl.get(s),(n=i&&i.key)?(r=(r=new Zs(pi.J)).Ht(n,new to(n,ci.min())),i=du().add(n),i=new wu(ci.min(),new Map,new su(Ar),r,i),[4,Bl(e,i)]):[3,2];case 1:return t.sent(),e.xl=e.xl.remove(n),e.Nl.delete(s),Ql(e),[3,4];case 2:return[4,Vh(e.Sh,s,!1).then(function(){return Wl(e,s,u)}).catch(Oc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.vl.uh=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Hh(s)&&(r=!0);u.jh=s}}r&&El(n)}.bind(null,t.Vl),t.vl.ql=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.Vl),t}function np(t){return t.gl.Ch.qh=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Sh,h=s,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=f.Tc.Or({Wr:!0}),i=f,o=t,s=n,u=(r=h).batch,a=u.keys(),c=ca.resolve();return a.forEach(function(n){c=c.next(function(){return s.fi(o,n)}).next(function(t){var e=t;Tr(null!==(t=r.Fs.get(n))),(!e||e.version.u(t)<0)&&(e=u.Ds(n,e,r))&&s.ui(e,r.Os)})}),c.next(function(){return i.Ho.xi(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.Ho.Fi(t)}).next(function(){return f.Ic.Zo(t,e)})}))];case 2:return i=t.sent(),Jl(n,r,null),Kl(n,r),n.pl.Oa(r,"acknowledged"),[4,$l(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Oc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})}.bind(null,t),t.gl.Ch.Uh=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Sh,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Ho.yi(e,r).next(function(t){return Tr(null!==t),n=t.keys(),i.Ho.xi(e,t)}).next(function(){return i.Ho.Fi(e)}).next(function(){return i.Ic.Zo(e,n)})}))];case 2:return o=t.sent(),Jl(n,u,a),Kl(n,u),n.pl.Oa(u,"rejected",a),[4,$l(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Oc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}function rp(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.Sh,o=r,s=qu((i=u).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.Eo.Ms(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Ul({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Ql(Pl(u)),a=new Al(u,l.Sh,p.Kt),[4,p.Kl()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.ol(c)]:[3,10];case 7:return(h=t.sent())&&d.Ql(h),[4,p.Kl()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,$l(l,f.zo,void 0)];case 12:return t.sent(),[4,(r=l.Sh,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.Eo.Ls(t,e)}))];case 13:return t.sent(),d.Ul(f.progress),[3,15];case 14:return Ir("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.jl(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.pl.Wa()})}var ip,op,sp=(pp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Kt=jf(e.gu.T),this.pl=this.Wl(e),this.persistence=this.Gl(e),[4,this.persistence.start()];case 1:return t.sent(),this.zl=this.Hl(e),this.Sh=this.Jl(e),[2]}})})},pp.prototype.Hl=function(t){return null},pp.prototype.Jl=function(t){return kh(this.persistence,new Nh,t.Yl,this.Kt)},pp.prototype.Gl=function(t){return new Xh(Qh.ra,this.Kt)},pp.prototype.Wl=function(t){return new wf},pp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.Lo()];case 1:return t.sent(),[4,this.persistence.Lo()];case 2:return t.sent(),[2]}})})},pp),up=(h(lp,op=sp),lp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,op.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=fh(t),r=ci.min(),t.ls({index:Fa.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=cc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.Ec=t})]})})}(this.Sh)];case 2:return t.sent(),[4,this.Xl.initialize(this,e)];case 3:return t.sent(),[4,np(this.Xl.fa)];case 4:return t.sent(),[4,pl(this.Xl.gl)];case 5:return t.sent(),[2]}})})},lp.prototype.Jl=function(t){return kh(this.persistence,new Nh,t.Yl,this.Kt)},lp.prototype.Hl=function(t){var e=this.persistence.Ii._r;return new Qc(e,t.fs)},lp.prototype.Gl=function(t){var e=Ih(t.gu.T,t.gu.persistenceKey),n=void 0!==this.cacheSizeBytes?xc.Xs(this.cacheSizeBytes):xc.ei;return new gh(this.synchronizeTabs,e,t.clientId,n,t.fs,Mf(),Uf(),this.Kt,this.pl,!!this.forceOwnership)},lp.prototype.Wl=function(t){return new wf},lp),ap=(h(fp,ip=up),fp.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,ip.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Xl.fa,this.pl instanceof mf?(this.pl.fa={nu:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Sh,n=a,i=(r=e).Ho,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.gi(e,n).next(function(t){return t?r.Ic.Zo(e,t):ca.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,pl(o.gl)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(Jl(o,a,h||null),Kl(o,a),o.Sh.Ho.Ni(a)):Er(),t.label=4;case 4:return[4,$l(o,s)];case 5:return t.sent(),[3,7];case 6:wr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),su:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).Ll?(wr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.Dl.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,jh(e.Sh)];case 3:return n=t.sent(),r=wu.$e(o,"current"===s),[4,$l(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,Vh(e.Sh,o,!0)];case 6:return t.sent(),Wl(e,o,u),[3,8];case 7:Er(),t.label=8;case 8:return[2]}})})}.bind(null,e),iu:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=ep(c)).Ll)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.Dl.has(r)?(wr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Uh(n.Sh,r)]):[3,6];case 2:return i=t.sent(),[4,Rh(n.Sh,i)];case 3:return o=t.sent(),[4,Fl(n,tp(i),o.targetId,!1)];case 4:t.sent(),rl(n.gl,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.Dl.has(e)?[4,Vh(n.Sh,e,!1).then(function(){il(n.gl,e),Wl(n,e)}).catch(Oc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Qo:function(t){return t.Sh.persistence.Qo()}.bind(null,e),eu:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,jh((e=n).Sh).then(function(t){return $l(e,t)})]})})}.bind(null,e)},[4,this.pl.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Po(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return ep(r=h),np(r),!0!==f||!0===r.Ll?[3,3]:(e=r.pl.Sa(),[4,Zl(r,e.rt())]);case 1:return i=t.sent(),r.Ll=!0,[4,vl(r.gl,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],rl(r.gl,u);return[3,7];case 3:return!1!==f||!1===r.Ll?[3,7]:(a=[],c=Promise.resolve(),r.Dl.forEach(function(t,e){r.pl.$a(e)?a.push(e):c=c.then(function(){return Wl(r,e),Vh(r.Sh,e,!0)}),il(r.gl,e)}),[4,c]);case 4:return t.sent(),[4,Zl(r,a)];case 5:return t.sent(),(n=r).Nl.forEach(function(t,e){il(n.gl,e)}),n.Ol.Mc(),n.Nl=new Map,n.xl=new Zs(pi.J),r.Ll=!1,[4,vl(r.gl,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.Xl.fa,e)];case 1:return t.sent(),this.zl&&(e&&!this.zl.Tr?this.zl.start(this.Sh):e||this.zl.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},fp.prototype.Wl=function(t){var e=Mf();if(!mf.jn(e))throw new Cr(Lr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ih(t.gu.T,t.gu.persistenceKey);return new mf(e,t.fs,n,t.clientId,t.Yl)},fp),cp=(hp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Sh?[3,2]:(this.Sh=n.Sh,this.pl=n.pl,this.Dh=this.Zl(r),this.gl=this.t_(r),this.Vl=this.e_(r),this.fa=this.n_(r,!n.synchronizeTabs),this.pl.da=function(t){return Gl(e.fa,t,1)},this.gl.Ch.s_=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(wr("SyncEngine","User change. New user:",o.R()),[4,Ph(n.Sh,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).kl.forEach(function(t){t.forEach(function(t){t.reject(new Cr(Lr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.kl.clear(),n.pl.Qa(o,r.Ac,r.Rc),[4,$l(n,r.mc)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.fa),[4,vl(this.gl,this.fa.$l)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},hp.prototype.e_=function(t){return new wl},hp.prototype.Zl=function(t){var e=jf(t.gu.T),n=(n=t.gu,new Tf(n));return t=t.credentials,new Jf(t,n,e)},hp.prototype.t_=function(t){var e=this;return new qf(this.Sh,this.Dh,t.fs,function(t){return Gl(e.fa,t,0)},t=new(If.jn()?If:bf))},hp.prototype.n_=function(t,e){return n=this.Sh,r=this.gl,i=this.Vl,o=this.pl,s=t.Yl,t=t.bl,e=e,t=new Ul(n,r,i,o,s,t),e&&(t.Ll=!0),t;var n,r,i,o,s},hp.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,wr("RemoteStore","RemoteStore shutting down."),e.Oh.add(5),[4,nl(e)];case 1:return t.sent(),e.kh.Lo(),e.Mh.set("Unknown"),[2]}})})}(this.gl)},hp);function hp(){}function fp(t,e){var n=this;return(n=ip.call(this,t,e,!1)||this).Xl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function lp(t,e,n){var r=this;return(r=op.call(this)||this).Xl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function pp(){this.synchronizeTabs=!1}function dp(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}var yp=(Ip.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},Ip.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Ip.prototype.r_=function(){this.muted=!0},Ip.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Ip),vp=(bp.prototype.close=function(){return this.o_.cancel()},bp.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},bp.prototype.Kl=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}})})},bp.prototype.a_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.u_()];case 1:return null===(e=t.sent())?[2,null]:(r=this.c_.decode(e),n=Number(r),isNaN(n)&&this.h_("length string ("+r+") is not valid number"),[4,this.l_(n)]);case 2:return r=t.sent(),[2,new Nl(JSON.parse(r),e.length+n)]}})})},bp.prototype.__=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},bp.prototype.u_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},bp.prototype.l_=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.f_()]:[3,3];case 1:t.sent()&&this.h_("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},bp.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},bp.prototype.f_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.o_.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},bp),gp=(wp.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},wp),mp=function(t){this._methodName=t};function wp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Cr(Lr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new li(t)}function bp(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new aa,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then(function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Ip(t){this.observer=t,this.muted=!1}function _p(t,e,n){if(!n)throw new Cr(Lr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Ep(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Cr(Lr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Tp(t,e,n,r){if(!0===e&&!0===r)throw new Cr(Lr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Np(t){if(!pi.Et(t))throw new Cr(Lr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Sp(t){if(pi.Et(t))throw new Cr(Lr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Ap(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Er();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function xp(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new Cr(Lr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Ap(t),new Cr(Lr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Dp(t,e){if(e<=0)throw new Cr(Lr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Op,kp=(Fp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Fp),Pp=new Map,Lp=(Object.defineProperty(qp.prototype,"app",{get:function(){if(!this.A_)throw new Cr(Lr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(qp.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(qp.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),qp.prototype.g_=function(t){if(this.T_)throw new Cr(Lr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new kp(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Yr;switch(t.type){case"gapi":var e=t.client;return Tr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Zr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Cr(Lr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},qp.prototype.V_=function(){return this.E_},qp.prototype.p_=function(){return this.T_=!0,this.E_},qp.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},qp.prototype.b_=function(){return(t=Pp.get(this))&&(wr("ComponentProvider","Removing Datastore"),Pp.delete(this),t.terminate()),Promise.resolve();var t},qp),Cp=(Object.defineProperty(jp.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(jp.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(jp.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(jp.prototype,"parent",{get:function(){return new Vp(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),jp.prototype.withConverter=function(t){return new jp(this.firestore,t,this.S_)},jp),Rp=(Up.prototype.withConverter=function(t){return new Up(this.firestore,t,this.C_)},Up),Vp=(h(Mp,Op=Rp),Object.defineProperty(Mp.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Mp.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(Mp.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new Cp(this.firestore,null,new pi(t))},enumerable:!1,configurable:!0}),Mp.prototype.withConverter=function(t){return new Mp(this.firestore,t,this.D_)},Mp);function Mp(t,e,n){var r=this;return(r=Op.call(this,t,e,Bo(n))||this).firestore=t,r.D_=n,r.type="collection",r}function Up(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}function jp(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}function qp(t,e){this.w_="(lite)",this.E_=new kp({}),this.T_=!1,t instanceof Gr?(this.I_=t,this.m_=new Yr):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Cr(Lr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gr(t.options.projectId)}(t),this.m_=new Qr(e))}function Fp(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Cr(Lr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Cr(Lr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Tp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Hp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Vr&&(t=t._),_p("collection","path",e),t instanceof Lp)return Sp(n=hi.ct.apply(hi,f([e],r))),new Vp(t,null,n);if(!(t instanceof Cp||t instanceof Vp))throw new Cr(Lr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Sp(n=hi.ct.apply(hi,f([t.path],r)).child(hi.ct(e))),new Vp(t.firestore,null,n)}function Bp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Vr&&(t=t._),1===arguments.length&&(e=Nr.t()),_p("doc","path",e),t instanceof Lp)return Np(n=hi.ct.apply(hi,f([e],r))),new Cp(t,null,new pi(n));if(!(t instanceof Cp||t instanceof Vp))throw new Cr(Lr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Np(n=t.D_.child(hi.ct.apply(hi,f([e],r)))),new Cp(t.firestore,t instanceof Vp?t.v_:null,new pi(n))}function Gp(t,e){return t instanceof Vr&&(t=t._),e instanceof Vr&&(e=e._),(t instanceof Cp||t instanceof Vp)&&(e instanceof Cp||e instanceof Vp)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function zp(t,e){return t instanceof Vr&&(t=t._),e instanceof Vr&&(e=e._),t instanceof Rp&&e instanceof Rp&&t.firestore===e.firestore&&$o(t.C_,e.C_)&&t.v_===e.v_}var Kp=(Object.defineProperty($p.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty($p.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),$p.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},$p.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},$p.prototype.K=function(t){return Ar(this.x_,t.x_)||Ar(this.N_,t.N_)},$p),Jp=/^__.*__$/,Wp=(Qp.prototype.O_=function(t,e){return null!==this.zt?new Vs(t,this.data,this.zt,e,this.fieldTransforms):new Rs(t,this.data,e,this.fieldTransforms)},Qp),Xp=(Yp.prototype.O_=function(t,e){return new Vs(t,this.data,this.zt,e,this.fieldTransforms)},Yp);function Yp(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function Qp(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function $p(t,e){if(!isFinite(t)||t<-90||90<t)throw new Cr(Lr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Cr(Lr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}function Zp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Er()}}var td=(Object.defineProperty(rd.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(rd.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),rd.prototype.M_=function(t){return new rd(Object.assign(Object.assign({},this.settings),t),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},rd.prototype.L_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.M_({path:e,B_:!1})).q_(t),e},rd.prototype.U_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.M_({path:t,B_:!1})).F_(),t},rd.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},rd.prototype.K_=function(t){return Pd(t,this.settings.methodName,this.settings.j_||!1,this.path,this.settings.W_)},rd.prototype.contains=function(e){return void 0!==this.zt.find(function(t){return e.st(t)})||void 0!==this.fieldTransforms.find(function(t){return e.st(t.field)})},rd.prototype.F_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},rd.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(Zp(this.k_)&&Jp.test(t))throw this.K_('Document fields cannot begin and end with "__"')},rd),ed=(nd.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new td({k_:t,methodName:e,W_:n,path:li.at(),B_:!1,j_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},nd);function nd(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||jf(t)}function rd(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.F_(),this.fieldTransforms=i||[],this.zt=o||[]}function id(t){var e=t.p_(),n=jf(t.I_);return new ed(t.I_,!!e.ignoreUndefinedProperties,n)}function od(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);xd("Data must be an object, but it was:",s,r);var u,a,r=Sd(r,s);if(o.merge)u=new Ei(s.zt),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Dd(e,f[h],n);if(!s.contains(l))throw new Cr(Lr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");Ld(c,l)||c.push(l)}u=new Ei(c),a=s.fieldTransforms.filter(function(t){return u.It(t.field)})}else u=null,a=s.fieldTransforms;return new Wp(new Ki(r),u,a)}var sd,ud=(h(ad,sd=mp),ad.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},ad.prototype.isEqual=function(t){return t instanceof ad},ad);function ad(){return null!==sd&&sd.apply(this,arguments)||this}function cd(t,e,n){return new td({k_:3,W_:e.settings.W_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var hd,fd,ld,pd,dd=(h(Id,pd=mp),Id.prototype.z_=function(t){return new Ss(t.path,new fs)},Id.prototype.isEqual=function(t){return t instanceof Id},Id),yd=(h(bd,ld=mp),bd.prototype.z_=function(t){var e=cd(this,t,!0),n=this.H_.map(function(t){return Nd(t,e)}),n=new ls(n);return new Ss(t.path,n)},bd.prototype.isEqual=function(t){return this===t},bd),vd=(h(wd,fd=mp),wd.prototype.z_=function(t){var e=cd(this,t,!0),n=this.H_.map(function(t){return Nd(t,e)}),n=new gs(n);return new Ss(t.path,n)},wd.prototype.isEqual=function(t){return this===t},wd),gd=(h(md,hd=mp),md.prototype.z_=function(t){var e=new Is(t.Kt,us(t.Kt,this.J_));return new Ss(t.path,e)},md.prototype.isEqual=function(t){return this===t},md);function md(t,e){var n=this;return(n=hd.call(this,t)||this).J_=e,n}function wd(t,e){var n=this;return(n=fd.call(this,t)||this).H_=e,n}function bd(t,e){var n=this;return(n=ld.call(this,t)||this).H_=e,n}function Id(){return null!==pd&&pd.apply(this,arguments)||this}function _d(t,r,i,e){var o=t.G_(1,r,i);xd("Data must be an object, but it was:",o,e);var s=[],u=new Ji;return Ii(e,function(t,e){var n=kd(r,t,i);e instanceof Vr&&(e=e._),t=o.U_(n),e instanceof ud?s.push(n):null!=(t=Nd(e,t))&&(s.push(n),u.set(n,t))}),e=new Ei(s),new Xp(u.yt(),e,o.fieldTransforms)}function Ed(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[Dd(e,r,n)],a=[i];if(o.length%2!=0)throw new Cr(Lr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Dd(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Ji,y=u.length-1;0<=y;--y)Ld(p,u[y])||(h=u[y],(f=a[y])instanceof Vr&&(f=f._),l=s.U_(h),f instanceof ud?p.push(h):null!=(l=Nd(f,l))&&(p.push(h),d.set(h,l)));return i=new Ei(p),new Xp(d.yt(),i,s.fieldTransforms)}function Td(t,e,n,r){return void 0===r&&(r=!1),Nd(n,t.G_(r?4:3,e))}function Nd(s,t){if(s instanceof Vr&&(s=s._),Ad(s))return xd("Unsupported field value:",t,s),Sd(s,t);if(s instanceof mp)return function(t,e){if(!Zp(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");(t=t.z_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.zt.push(t.path),s instanceof Array){if(t.settings.B_&&4!==t.k_)throw t.K_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Nd(i[r],t.Q_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Vr&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return us(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ai.fromDate(t);return{timestampValue:Uu(e.Kt,n)}}if(t instanceof ai)return n=new ai(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Uu(e.Kt,n)};if(t instanceof Kp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Rr)return{bytesValue:ju(e.Kt,t.l)};if(t instanceof Cp){n=e.T;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Fu(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+Ap(t))}(s,t)}function Sd(t,n){var r={};return _i(t)?n.path&&0<n.path.length&&n.zt.push(n.path):Ii(t,function(t,e){null!=(e=Nd(e,n.L_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Ad(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ai||t instanceof Kp||t instanceof Rr||t instanceof Cp||t instanceof mp)}function xd(t,e,n){if(!Ad(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Ap(n))?e.K_(t+" a custom object"):e.K_(t+" "+n);var r}function Dd(t,e,n){if(e instanceof Vr&&(e=e._),e instanceof gp)return e.d_;if("string"==typeof e)return kd(t,e);throw Pd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Od=new RegExp("[~\\*/\\[\\]]");function kd(e,n,r){if(0<=n.search(Od))throw Pd("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(gp.bind.apply(gp,f([void 0],n.split("."))))).d_}catch(t){throw Pd("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Pd(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Cr(Lr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Ld(t,e){return t.some(function(t){return t.isEqual(e)})}var Cd=(jd.prototype.ef=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),0<this.mutations.length)throw new Cr(Lr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=Ju((r=s).Kt)+"/documents",n={documents:u.map(function(t){return Bu(r.Kt,t)})},[4,r.Cu("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.Kt,"found"in t?function(t,e){Tr(!!e.found),e.found.name,e.found.updateTime;var n=Gu(t,e.found.name),t=qu(e.found.updateTime),e=new Ki({mapValue:{fields:e.found.fields}});return new Zi(n,t,e,{})}(n,t):"missing"in t?(e=n,Tr(!!(n=t).missing),Tr(!!n.readTime),e=Gu(e,n.missing),n=qu(n.readTime),new to(e,n)):Er());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Tr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.Dh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof to||t instanceof Zi?n.sf(t):Er()}),e)]}})})},jd.prototype.set=function(t,e){this.write(e.O_(t,this.Gt(t))),this.tf.add(t.toString())},jd.prototype.update=function(t,e){try{this.write(e.O_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},jd.prototype.delete=function(t){this.write(new Js(t,this.Gt(t))),this.tf.add(t.toString())},jd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return e=this.Y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=pi.ft(e),n.mutations.push(new Ws(e,n.Gt(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Ju((e=i).Kt)+"/documents",r={writes:o.map(function(t){return Qu(e.Kt,t)})},[4,e.bu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Dh,this.mutations)];case 1:return t.sent(),this.X_=!0,[2]}})})},jd.prototype.sf=function(t){var e;if(t instanceof Zi)e=t.version;else{if(!(t instanceof to))throw Er();e=ci.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Cr(Lr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},jd.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?As.updateTime(e):As.jt()},jd.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(this.tf.has(t.toString())||!e)return As.exists(!0);if(e.isEqual(ci.min()))throw new Cr(Lr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return As.updateTime(e)},jd.prototype.write=function(t){this.nf(),this.mutations.push(t)},jd.prototype.nf=function(){},jd),Rd=(Ud.prototype.run=function(){this.af()},Ud.prototype.af=function(){var t=this;this.zu.Bu(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Cd(this.Dh),(n=this.uf(e))&&n.then(function(t){r.fs.ys(function(){return e.commit().then(function(){r.Ts.resolve(t)}).catch(function(t){r.hf(t)})})}).catch(function(t){r.hf(t)}),[2]})})})},Ud.prototype.uf=function(t){try{var e=this.updateFunction(t);return!ki(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},Ud.prototype.hf=function(t){var e=this;0<this.cf&&this.lf(t)?(--this.cf,this.fs.ys(function(){return e.af(),Promise.resolve()})):this.Ts.reject(t)},Ud.prototype.lf=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Qs(t))},Ud),Vd=(Md.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}})})},Md.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then(function(){return e._f(e.user)})},Md.prototype.df=function(){if(this.fs.wf)throw new Cr(Lr.FAILED_PRECONDITION,"The client has already been terminated.")},Md.prototype.terminate=function(){var t=this;this.fs.Ef();var n=new aa;return this.fs.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.D(),n.resolve(),[3,6];case 5:return e=Aa(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Md);function Md(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=zr.UNAUTHENTICATED,this.clientId=Nr.t(),this._f=function(){},this.N=new aa,this.credentials.S(function(t){wr("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()})}function Ud(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new Gf(this.fs,"transaction_retry")}function jd(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}function qd(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return i.fs.Af(),wr("FirestoreClient","Initializing OfflineComponentProvider"),[4,i.getConfiguration()];case 1:return e=t.sent(),[4,o.initialize(e)];case 2:return t.sent(),n=e.Yl,i.ff(function(e){n.isEqual(e)||(n=e,i.fs.bo(function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Ph(o.Sh,e)];case 1:return t.sent(),[2]}})})}))}),o.persistence.yo(function(){return i.terminate()}),i.mf=o,[2]}})})}function Fd(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.fs.Af(),[4,Hd(r)];case 1:return e=t.sent(),wr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ff(function(t){return r.fs.bo(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).fs.Af(),wr("RemoteStore","RemoteStore received new credentials"),n=cl(e),e.Oh.add(3),[4,nl(e)];case 1:return t.sent(),n&&e.Mh.set("Unknown"),[4,e.Ch.s_(i)];case 2:return t.sent(),e.Oh.delete(3),[4,el(e)];case 3:return t.sent(),[2]}})})}(i.gl,t)})}),r.If=i,[2]}})})}function Hd(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.mf?[3,2]:(wr("FirestoreClient","Using default OfflineComponentProvider"),[4,qd(e,new sp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.mf]}})})}function Bd(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.If?[3,2]:(wr("FirestoreClient","Using default OnlineComponentProvider"),[4,Fd(e,new cp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.If]}})})}function Gd(t){return Hd(t).then(function(t){return t.persistence})}function zd(t){return Hd(t).then(function(t){return t.Sh})}function Kd(t){return Bd(t).then(function(t){return t.gl})}function Jd(t){return Bd(t).then(function(t){return t.fa})}function Wd(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Bd(r)];case 1:return e=t.sent(),[2,((n=e.Vl).Gh=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=ep(s),(o=e.Sl.get(u))?(n=o.targetId,e.pl.ka(n),r=o.view.Pl(),[3,4]):[3,1];case 1:return[4,Rh(e.Sh,Yo(u))];case 2:return i=t.sent(),o=e.pl.ka(i.targetId),n=i.targetId,[4,Fl(e,u,n,"current"===o)];case 3:r=t.sent(),e.$l&&rl(e.gl,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.fa),n.Jh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Sl.get(o),1<(r=e.Dl.get(n.targetId)).length?[2,(e.Dl.set(n.targetId,r.filter(function(t){return!$o(t,o)})),void e.Sl.delete(o))]:e.$l?(e.pl.La(n.targetId),e.pl.Ca(n.targetId)?[3,2]:[4,Vh(e.Sh,n.targetId,!1).then(function(){e.pl.Ba(n.targetId),il(e.gl,n.targetId),Wl(e,n.targetId)}).catch(Oc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Wl(e,n.targetId),[4,Vh(e.Sh,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.fa),n)]}})})}function Xd(n,r,i){var t=this;void 0===i&&(i={});var o=new aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new yp({next:function(t){r.ys(function(){return _l(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Cr(Lr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Cr(Lr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Tl(Bo(i.path),t,{includeMetadataChanges:!0,sl:!0});return Il(n,u)},[4,Wd(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.fs,r,i,o])]}})})}),o.promise}function Yd(n,r,i){var t=this;void 0===i&&(i={});var o=new aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new yp({next:function(t){n.ys(function(){return _l(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Cr(Lr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Tl(t,o,{includeMetadataChanges:!0,sl:!0});return Il(e,s)},[4,Wd(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.fs,r,i,o])]}})})}),o.promise}var Qd,$d=(Object.defineProperty(ey.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),ey.prototype.ys=function(t){this.enqueue(t)},ey.prototype.Tf=function(t){this.Sf(),this.Df(t)},ey.prototype.Ef=function(){var t;this.yf||(this.yf=!0,(t=Uf())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf))},ey.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},ey.prototype.bo=function(t){var e=this;this.ys(function(){return e.Pf.push(t),e.Cf()})},ey.prototype.Cf=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Pf.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return t.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!wa(e=t.sent()))throw e;return wr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Pf.length&&this.zu.Bu(function(){return n.Cf()}),t.label=5;case 5:return[2]}})})},ey.prototype.Df=function(t){var r=this,e=this.Rf.then(function(){return r.pf=!0,t().catch(function(t){throw r.Vf=t,r.pf=!1,br("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.pf=!1,t})});return this.Rf=e},ey.prototype.Ir=function(t,e,n){var r=this;return this.Sf(),-1<this.bf.indexOf(t)&&(e=0),n=Na.Is(this,t,e,n,function(t){return r.xf(t)}),this.gf.push(n),n},ey.prototype.Sf=function(){this.Vf&&Er()},ey.prototype.Af=function(){},ey.prototype.Nf=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Rf];case 1:t.sent(),t.label=2;case 2:if(e!==this.Rf)return[3,0];t.label=3;case 3:return[2]}})})},ey.prototype.Of=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},ey.prototype.Ff=function(r){var i=this;return this.Nf().then(function(){i.gf.sort(function(t,e){return t.ws-e.ws});for(var t=0,e=i.gf;t<e.length;t++){var n=e[t];if(n.Ps(),"all"!==r&&n.ds===r)break}return i.Nf()})},ey.prototype.kf=function(t){this.bf.push(t)},ey.prototype.xf=function(t){t=this.gf.indexOf(t),this.gf.splice(t,1)},ey),Zd=(h(ty,Qd=Lp),ty.prototype.b_=function(){return this.Lf||ry(this),this.Lf.terminate()},ty);function ty(t,e){var n=this;return(n=Qd.call(this,t,e)||this).Mf=new $d,n.w_="name"in t?t.name:"[DEFAULT]",n}function ey(){var e=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new Gf(this,"async_queue_retry"),this.vf=function(){var t=Uf();t&&wr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.zu.Uu()};var t=Uf();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.vf)}function ny(t){return t.Lf||ry(t),t.Lf.df(),t.Lf}function ry(t){var e,n,r=t.p_(),r=(e=t.I_,n=t.w_,new Br(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Lf=new Vd(t.m_,t.Mf,r)}function iy(n,r,i){var t=this,o=new aa;return n.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,qd(n,i)];case 1:return t.sent(),[4,Fd(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===Lr.FAILED_PRECONDITION||t.code===Lr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function oy(t){if(t.R_||t.P_)throw new Cr(Lr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var sy,o=(fy.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),Ci(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ai(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(xi(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.jf(t.arrayValue,e);case 10:return this.Wf(t.mapValue,e);default:throw Er()}},fy.prototype.Wf=function(t,n){var r=this,i={};return Ii(t.fields||{},function(t,e){i[t]=r.$f(e,n)}),i},fy.prototype.Kf=function(t){return new Kp(Ai(t.latitude),Ai(t.longitude))},fy.prototype.jf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.$f(t,e)})},fy.prototype.qf=function(t,e){switch(e){case"previous":var n=function t(e){return Di(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(Oi(t));default:return null}},fy.prototype.Bf=function(t){return t=Si(t),new ai(t.seconds,t.nanos)},fy.prototype.Gf=function(t,e){var n=hi.ct(t);return Tr(sa(n)),t=new Gr(n.get(1),n.get(3)),n=new pi(n.X(5)),t.isEqual(e)||br("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},fy),uy=(Object.defineProperty(hy.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(hy.prototype,"ref",{get:function(){return new Cp(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),hy.prototype.exists=function(){return null!==this.Jf},hy.prototype.data=function(){if(this.Jf){if(this.v_){var t=new ay(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.vt())}},hy.prototype.get=function(t){if(this.Jf&&null!==(t=this.Jf.data().field(ly("DocumentSnapshot.get",t))))return this.Hf.$f(t)},hy),ay=(h(cy,sy=uy),cy.prototype.data=function(){return sy.prototype.data.call(this)},cy);function cy(){return null!==sy&&sy.apply(this,arguments)||this}function hy(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}function fy(){}function ly(t,e){return"string"==typeof e?kd(t,e):(e instanceof Vr?e._:e).d_}function py(t){if(zo(t)&&0===t.Nt.length)throw new Cr(Lr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}function dy(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].Yf(t);return t}var yy,vy,gy,my,wy,by=(h(Dy,wy=me=function(){}),Dy.prototype.Yf=function(t){var e=id(t.firestore),e=function(t,e,n,r,i,o){if(r.ht()){if("array-contains"===i||"array-contains-any"===i)throw new Cr(Lr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Py(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(ky(n,t,c))}h={arrayValue:{values:s}}}else h=ky(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Py(o,i),h=Td(e,"where",o,"in"===i||"not-in"===i);var h=fo.create(r,i,h);return function(t,e){if(e.xt()){var n=Jo(t);if(null!==n&&!n.isEqual(e.field))throw new Cr(Lr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=Ko(t))&&Ly(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Cr(Lr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Cr(Lr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.C_,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new Rp(t.firestore,t.v_,(e=(t=t.C_).filters.concat([e]),new Fo(t.path,t.collectionGroup,t.Nt.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Dy),Iy=(h(xy,my=me),xy.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Cr(Lr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Cr(Lr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Uo(e,n);return e=r,null!==Ko(n=t)||null!==(t=Jo(n))&&Ly(0,t,e.field),r}(t.C_,this.Xf,this.ed);return new Rp(t.firestore,t.v_,(e=(t=t.C_).Nt.concat([e]),new Fo(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},xy),_y=(h(Ay,gy=me),Ay.prototype.Yf=function(t){return new Rp(t.firestore,t.v_,Qo(t.C_,this.nd,this.sd))},Ay),Ey=(h(Sy,vy=me),Sy.prototype.Yf=function(t){var e=Oy(t,this.type,this.rd,this.od);return new Rp(t.firestore,t.v_,(t=t.C_,new Fo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Sy),Ty=(h(Ny,yy=me),Ny.prototype.Yf=function(t){var e=Oy(t,this.type,this.rd,this.od);return new Rp(t.firestore,t.v_,(t=t.C_,new Fo(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},Ny);function Ny(t,e,n){var r=this;return(r=yy.call(this)||this).type=t,r.rd=e,r.od=n,r}function Sy(t,e,n){var r=this;return(r=vy.call(this)||this).type=t,r.rd=e,r.od=n,r}function Ay(t,e,n){var r=this;return(r=gy.call(this)||this).type=t,r.nd=e,r.sd=n,r}function xy(t,e){var n=this;return(n=my.call(this)||this).Xf=t,n.ed=e,n.type="orderBy",n}function Dy(t,e,n){var r=this;return(r=wy.call(this)||this).Xf=t,r.Zf=e,r.td=n,r.type="where",r}function Oy(t,c,e,n){if(e[0]instanceof Vr&&(e[0]=e[0]._),e[0]instanceof uy)return function(t,e,n,r){if(!n)throw new Cr(Lr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Xo(t);o<s.length;o++){var u=s[o];if(u.field.ht())i.push(qi(e,n.key));else{var a=n.field(u.field);if(Di(a))throw new Cr(Lr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.ot(),new Cr(Lr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Po(i,r)}(t.C_,t.firestore.I_,e[0].Jf,n);var r=id(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new Cr(Lr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new Cr(Lr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Wo(t)&&-1!==c.indexOf("/"))throw new Cr(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(hi.ct(c));if(!pi.Et(h))throw new Cr(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new pi(h),u.push(qi(e,h))}else c=Td(n,r,c),u.push(c)}return new Po(u,o)}(t.C_,t.firestore.I_,r,c,e,n)}function ky(t,e,n){if(n instanceof Vr&&(n=n._),"string"==typeof n){if(""===n)throw new Cr(Lr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Wo(e)&&-1!==n.indexOf("/"))throw new Cr(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(hi.ct(n)),!pi.Et(e))throw new Cr(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return qi(t,new pi(e))}if(n instanceof Cp)return qi(t,n.S_);throw new Cr(Lr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ap(n)+".")}function Py(t,e){if(!Array.isArray(t)||0===t.length)throw new Cr(Lr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Cr(Lr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Ly(t,e,n){if(!n.isEqual(e))throw new Cr(Lr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Cy(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}function Ry(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Vy,My,Uy,jy=(h(Wy,Uy=o),Wy.prototype.Uf=function(t){return new Rr(t)},Wy.prototype.Qf=function(t){return t=this.Gf(t,this.firestore.I_),new Cp(this.firestore,null,t)},Wy),qy=(Jy.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Jy),Fy=(h(Ky,My=uy),Ky.prototype.exists=function(){return My.prototype.exists.call(this)},Ky.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new Hy(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.vt(),t.serverTimestamps)}},Ky.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf&&null!==(t=this.Jf.data().field(ly("DocumentSnapshot.get",t))))return this.Hf.$f(t,e.serverTimestamps)},Ky),Hy=(h(zy,Vy=Fy),zy.prototype.data=function(t){return void 0===t&&(t={}),Vy.prototype.data.call(this,t)},zy),By=(Object.defineProperty(Gy.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Gy.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Gy.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Gy.prototype.forEach=function(e,n){var r=this;this.ud.docs.forEach(function(t){e.call(n,new Hy(r.zf,r.Hf,t.key,t,new qy(r.ud.Ce.has(t.key),r.ud.fromCache),r.query.v_))})},Gy.prototype.docChanges=function(t){if(void 0===t&&(t={}),(t=!!t.includeMetadataChanges)&&this.ud.Ne)throw new Cr(Lr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===t||(this.hd=function(i,e){if(i.ud.De.nt()){var n=0;return i.ud.docChanges.map(function(t){var e=new Hy(i.zf,i.Hf,t.doc.key,t.doc,new qy(i.ud.Ce.has(t.doc.key),i.ud.fromCache),i.query.v_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.ud.De;return i.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Hy(i.zf,i.Hf,t.doc.key,t.doc,new qy(i.ud.Ce.has(t.doc.key),i.ud.fromCache),i.query.v_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Er()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.ld=t),this.hd},Gy);function Gy(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new qy(r.hasPendingWrites,r.fromCache),this.query=n}function zy(){return null!==Vy&&Vy.apply(this,arguments)||this}function Ky(t,e,n,r,i,o){var s=this;return(s=My.call(this,t,e,n,r,o)||this).zf=t,s.ad=t,s.metadata=i,s}function Jy(t,e){this.hasPendingWrites=t,this.fromCache=e}function Wy(t){var e=this;return(e=Uy.call(this)||this).firestore=t,e}function Xy(t,e){return t instanceof Fy&&e instanceof Fy?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof By&&e instanceof By&&t.zf===e.zf&&zp(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var Yy,Qy=(h($y,Yy=o),$y.prototype.Uf=function(t){return new Rr(t)},$y.prototype.Qf=function(t){return t=this.Gf(t,this.firestore.I_),new Cp(this.firestore,null,t)},$y);function $y(t){var e=this;return(e=Yy.call(this)||this).firestore=t,e}function Zy(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=xp(t,Cp);var o=xp(t.firestore,Zd),s=id(o);return e instanceof Vr&&(e=e._),ev(o,[("string"==typeof e||e instanceof gp?Ed(s,"updateDoc",t.S_,e,n,r):_d(s,"updateDoc",t.S_,e)).O_(t.S_,As.exists(!0))])}function tv(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Vr&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Cy(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return Cy(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof Cp?(u=xp(e.firestore,Zd),a=Bo(e.S_.path),h={next:function(t){n[i]&&n[i](nv(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=xp(e,Rp),u=xp(s.firestore,Zd),a=s.C_,c=new Qy(u),h={next:function(t){n[i]&&n[i](new By(u,c,s,t))},error:n[i+1],complete:n[i+2]},py(e.C_)),function(n,t,e){var r=this,i=new yp(h),o=new Tl(t,i,e);return n.fs.ys(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Il,[4,Wd(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.r_(),n.fs.ys(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=_l,[4,Wd(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(ny(u),a,f)}function ev(t,e){return function(n,r){var t=this,i=new aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Hl,[4,Jd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(ny(t),e)}function nv(t,e,n){var r=n.docs.get(e.S_),i=new Qy(t);return new Fy(t,i,e.S_,r,new qy(n.hasPendingWrites,n.fromCache),e.v_)}var rv=(iv.prototype.set=function(t,e,n){return this.Ed(),e=Ry((t=ov(t,this.zf)).v_,e,n),n=od(this.wd,"WriteBatch.set",t.S_,e,null!==t.v_,n),this.fd.push(n.O_(t.S_,As.jt())),this},iv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.Ed(),t=ov(t,this.zf),e instanceof Vr&&(e=e._),e="string"==typeof e||e instanceof gp?Ed(this.wd,"WriteBatch.update",t.S_,e,n,r):_d(this.wd,"WriteBatch.update",t.S_,e),this.fd.push(e.O_(t.S_,As.exists(!0))),this},iv.prototype.delete=function(t){return this.Ed(),t=ov(t,this.zf),this.fd=this.fd.concat(new Js(t.S_,As.jt())),this},iv.prototype.commit=function(){return this.Ed(),this.dd=!0,0<this.fd.length?this._d(this.fd):Promise.resolve()},iv.prototype.Ed=function(){if(this.dd)throw new Cr(Lr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},iv);function iv(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=id(t)}function ov(t,e){if(t instanceof Vr&&(t=t._),t.firestore!==e)throw new Cr(Lr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var sv,uv,av,cv=(gv.prototype.get=function(t){var e=this,n=ov(t,this.zf),r=new jy(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return Er();if((t=t[0])instanceof to)return new uy(e.zf,r,n.S_,null,n.v_);if(t instanceof Zi)return new uy(e.zf,r,t.key,t,n.v_);throw Er()})},gv.prototype.set=function(t,e,n){return e=Ry((t=ov(t,this.zf)).v_,e,n),n=od(this.wd,"Transaction.set",t.S_,e,null!==t.v_,n),this.Td.set(t.S_,n),this},gv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=ov(t,this.zf),e instanceof Vr&&(e=e._),e="string"==typeof e||e instanceof gp?Ed(this.wd,"Transaction.update",t.S_,e,n,r):_d(this.wd,"Transaction.update",t.S_,e),this.Td.update(t.S_,e),this},gv.prototype.delete=function(t){return t=ov(t,this.zf),this.Td.delete(t.S_),this},h(vv,av=gv),vv.prototype.get=function(t){var e=this,n=ov(t,this.zf),r=new Qy(this.zf);return av.prototype.get.call(this,t).then(function(t){return new Fy(e.zf,r,n.S_,t.Jf,new qy(!1,!1),n.v_)})},vv),hv=(yv.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){oy(t=xp(t,Zd));var n=ny(t),r=t.p_();return iy(n,t=new cp,new up(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},yv.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){oy(t=xp(t,Zd));var e=ny(t),n=t.p_();return iy(e,t=new cp,new ap(t,n.cacheSizeBytes))}(t._)},yv.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.R_&&!n.P_)throw new Cr(Lr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new aa;return n.Mf.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return fa.jn()?(e=n+"main",[4,fa.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Ih(n.I_,n.w_))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t._)},yv),fv=(h(dv,uv=Vr),Object.defineProperty(dv.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),dv.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},dv.prototype.useEmulator=function(t,e){var n=this._,r=t;t=e,"firestore.googleapis.com"!==(e=(n=xp(n,Lp)).V_()).host&&e.host!==r&&Ir("Host has been set in both settings() and useEmulator(), emulator host will be used"),n.g_(Object.assign(Object.assign({},e),{host:r+":"+t,ssl:!1}))},dv.prototype.enableNetwork=function(){return function(r){var t=this;return r.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Gd(r)];case 1:return e=t.sent(),[4,Kd(r)];case 2:return n=t.sent(),[2,(e.Vo(!0),(t=n).Oh.delete(0),el(t))]}})})})}(ny(xp(this._,Zd)))},dv.prototype.disableNetwork=function(){return function(r){var t=this;return r.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Gd(r)];case 1:return e=t.sent(),[4,Kd(r)];case 2:return n=t.sent(),[2,(e.Vo(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Oh.add(0),[4,nl(e)];case 1:return t.sent(),e.Mh.set("Offline"),[2]}})})}(n))]}})})})}(ny(xp(this._,Zd)))},dv.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Tp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},dv.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},dv.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},dv.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=zl,[4,Jd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(ny(xp(this._,Zd)))},dv.prototype.onSnapshotsInSync=function(t){return function(n,t){var e=this,r=new yp(t);return n.fs.ys(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Wh.add(e),e.next()},[4,Wd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.r_(),n.fs.ys(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Wh.delete(e)},[4,Wd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(ny(xp(this._,Zd)),Cy(t)?t:{next:t})},Object.defineProperty(dv.prototype,"app",{get:function(){if(!this.md)throw new Cr(Lr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),dv.prototype.collection=function(t){try{return new Fv(this,Hp(this._,t))}catch(t){throw Av(t,"collection()","Firestore.collection()")}},dv.prototype.doc=function(t){try{return new Ev(this,Bp(this._,t))}catch(t){throw Av(t,"doc()","Firestore.doc()")}},dv.prototype.collectionGroup=function(t){try{return new Uv(this,function(t,e){if(t=xp(t,Lp),_p("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Cr(Lr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Rp(t,null,new Fo(hi.at(),e))}(this._,t))}catch(t){throw Av(t,"collectionGroup()","Firestore.collectionGroup()")}},dv.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Bd(n).then(function(t){return t.Dh})];case 1:return e=t.sent(),new Rd(n.fs,e,r,i).run(),[2]}})})}),i.promise}(ny(n=this._),function(t){return t=new cv(n,t),e(new Iv(r,t))})},dv.prototype.batch=function(){var e=this;return ny(this._),new _v(new rv(this._,function(t){return ev(e._,t)}))},dv.prototype.loadBundle=function(t){throw new Cr(Lr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},dv.prototype.namedQuery=function(t){throw new Cr(Lr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},dv),lv=(h(pv,sv=o),pv.prototype.Uf=function(t){return new Hr(new Rr(t))},pv.prototype.Qf=function(t){return t=this.Gf(t,this.firestore.I_),Ev.Ad(t,this.firestore,null)},pv);function pv(t){var e=this;return(e=sv.call(this)||this).firestore=t,e}function dv(t,e,n){var r=this;return(r=uv.call(this,e)||this).Id=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Gr||(r.md=t),r}function yv(){}function vv(t,e){var n=this;return(n=av.call(this,t,e)||this).zf=t,n}function gv(t,e){this.zf=t,this.Td=e,this.wd=id(t)}var mv,wv,bv,Iv=(h(Sv,bv=Vr),Sv.prototype.get=function(t){var e=this,n=Wv(t);return this._.get(n).then(function(t){return new Vv(e.zf,new Fy(e.zf._,e.Hf,t.S_,t.Jf,t.metadata,n.v_))})},Sv.prototype.set=function(t,e,n){return t=Wv(t),n?(Ep("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},Sv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Wv(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Sv.prototype.delete=function(t){return t=Wv(t),this._.delete(t),this},Sv),_v=(h(Nv,wv=Vr),Nv.prototype.set=function(t,e,n){return t=Wv(t),n?(Ep("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},Nv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Wv(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,f([o,e,n],r)),this},Nv.prototype.delete=function(t){return t=Wv(t),this._.delete(t),this},Nv.prototype.commit=function(){return this._.commit()},Nv),Ev=(h(Tv,mv=Vr),Tv.Rd=function(t,e,n){if(t.length%2!=0)throw new Cr(Lr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new Tv(e,new Cp(e._,n,new pi(t)))},Tv.Ad=function(t,e,n){return new Tv(e,new Cp(e._,n,t))},Object.defineProperty(Tv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Tv.prototype,"parent",{get:function(){return new Fv(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Tv.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Tv.prototype.collection=function(t){try{return new Fv(this.firestore,Hp(this._,t))}catch(t){throw Av(t,"collection()","DocumentReference.collection()")}},Tv.prototype.isEqual=function(t){return t instanceof Vr&&(t=t._),t instanceof Cp&&Gp(this._,t)},Tv.prototype.set=function(t,e){e=Ep("DocumentReference.set",e);try{return function(t,e,n){t=xp(t,Cp);var r=xp(t.firestore,Zd),e=Ry(t.v_,e,n);return ev(r,[od(id(r),"setDoc",t.S_,e,null!==t.v_,n).O_(t.S_,As.jt())])}(this._,t,e)}catch(t){throw Av(t,"setDoc()","DocumentReference.set()")}},Tv.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Zy(this._,t):Zy.apply(void 0,f([this._,t,e],n))}catch(t){throw Av(t,"updateDoc()","DocumentReference.update()")}},Tv.prototype.delete=function(){return ev(xp((t=this._).firestore,Zd),[new Js(t.S_,As.jt())]);var t},Tv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=xv(t),i=Dv(t,function(t){return new Vv(e.firestore,new Fy(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))});return tv(this._,r,i)},Tv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=xp(e,Cp);var n=xp(e.firestore,Zd),t=ny(n),r=new Qy(n);return function(n,r){var t=this,i=new aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(o,s,u){return y(this,void 0,void 0,function(){var r,i;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)}))];case 1:return(i=t.sent())instanceof Zi?u.resolve(i):i instanceof to?u.resolve(null):u.reject(new Cr(Lr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=Aa(r,"Failed to get document '"+s+" from cache"),u.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,zd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.S_).then(function(t){return new Fy(n,r,e.S_,t,new qy(t instanceof Zi&&t.bt,!0),e.v_)})}:"server"===(null==t?void 0:t.source)?function(e){e=xp(e,Cp);var n=xp(e.firestore,Zd);return Xd(ny(n),e.S_,{source:"server"}).then(function(t){return nv(n,e,t)})}:function(e){e=xp(e,Cp);var n=xp(e.firestore,Zd);return Xd(ny(n),e.S_).then(function(t){return nv(n,e,t)})})(this._).then(function(t){return new Vv(e.firestore,new Fy(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},Tv.prototype.withConverter=function(t){return new Tv(this.firestore,this._.withConverter(t))},Tv);function Tv(t,e){var n=this;return(n=mv.call(this,e)||this).firestore=t,n.Hf=new lv(t),n}function Nv(){return null!==wv&&wv.apply(this,arguments)||this}function Sv(t,e){var n=this;return(n=bv.call(this,e)||this).zf=t,n.Hf=new lv(t),n}function Av(t,e,n){return t.message=t.message.replace(e,n),t}function xv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Cy(r))return r}return{}}function Dv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Cy(t[0])?t[0]:Cy(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Ov,kv,Pv,Lv,Cv,Rv,Vv=(h(Jv,Rv=Vr),Object.defineProperty(Jv.prototype,"ref",{get:function(){return new Ev(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Jv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Jv.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Jv.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),Jv.prototype.data=function(t){return this._.data(t)},Jv.prototype.get=function(t,e){return this._.get(t,e)},Jv.prototype.isEqual=function(t){return Xy(this._,t._)},Jv),Mv=(h(Kv,Cv=Vv),Kv.prototype.data=function(t){return this._.data(t)},Kv),Uv=(h(zv,Lv=Vr),zv.prototype.where=function(t,e,n){try{return new zv(this.firestore,dy(this._,(r=n,i=e,o=ly("where",t),new by(o,i,r))))}catch(t){throw Av(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},zv.prototype.orderBy=function(n,t){try{return new zv(this.firestore,dy(this._,function(t){void 0===t&&(t="asc");var e=t,t=ly("orderBy",n);return new Iy(t,e)}(t)))}catch(n){throw Av(n,/(orderBy|where)\(\)/,"Query.$1()")}},zv.prototype.limit=function(t){try{return new zv(this.firestore,dy(this._,(Dp("limit",e=t),new _y("limit",e,"F"))))}catch(t){throw Av(t,"limit()","Query.limit()")}var e},zv.prototype.limitToLast=function(t){try{return new zv(this.firestore,dy(this._,(Dp("limitToLast",e=t),new _y("limitToLast",e,"L"))))}catch(t){throw Av(t,"limitToLast()","Query.limitToLast()")}var e},zv.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new zv(this.firestore,dy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ey("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Av(t,"startAt()","Query.startAt()")}},zv.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new zv(this.firestore,dy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ey("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Av(t,"startAfter()","Query.startAfter()")}},zv.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new zv(this.firestore,dy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ty("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Av(t,"endBefore()","Query.endBefore()")}},zv.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new zv(this.firestore,dy(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ty("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Av(t,"endAt()","Query.endAt()")}},zv.prototype.isEqual=function(t){return zp(this._,t._)},zv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=xp(e,Rp);var n=xp(e.firestore,Zd),t=ny(n),r=new Qy(n);return function(n,r){var t=this,i=new aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Mh(i,o,!0)];case 1:return r=t.sent(),e=new Rl(o,r.Pc),n=e.dl(r.documents),n=e.Ei(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=Aa(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,zd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.C_).then(function(t){return new By(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=xp(e,Rp);var n=xp(e.firestore,Zd),t=ny(n),r=new Qy(n);return Yd(t,e.C_,{source:"server"}).then(function(t){return new By(n,r,e,t)})}:function(e){e=xp(e,Rp);var n=xp(e.firestore,Zd),t=ny(n),r=new Qy(n);return py(e.C_),Yd(t,e.C_).then(function(t){return new By(n,r,e,t)})})(this._).then(function(t){return new qv(e.firestore,new By(e.firestore._,e.Hf,e._,t.ud))})},zv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=xv(t),i=Dv(t,function(t){return new qv(e.firestore,new By(e.firestore._,e.Hf,e._,t.ud))});return tv(this._,r,i)},zv.prototype.withConverter=function(t){return new zv(this.firestore,this._.withConverter(t))},zv),jv=(h(Gv,Pv=Vr),Object.defineProperty(Gv.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"doc",{get:function(){return new Mv(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),Gv),qv=(h(Bv,kv=Vr),Object.defineProperty(Bv.prototype,"query",{get:function(){return new Uv(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new Mv(e.zf,t)})},enumerable:!1,configurable:!0}),Bv.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new jv(e.zf,t)})},Bv.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new Mv(r.zf,t))})},Bv.prototype.isEqual=function(t){return Xy(this._,t._)},Bv),Fv=(h(Hv,Ov=Uv),Object.defineProperty(Hv.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Hv.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(Hv.prototype,"parent",{get:function(){var t=this._.parent;return t?new Ev(this.firestore,t):null},enumerable:!1,configurable:!0}),Hv.prototype.doc=function(t){try{return new Ev(this.firestore,void 0===t?Bp(this._):Bp(this._,t))}catch(t){throw Av(t,"doc()","CollectionReference.doc()")}},Hv.prototype.add=function(t){var e,n=this,r=this._,i=t;return t=xp(r.firestore,Zd),e=Bp(r),i=Ry(r.v_,i),ev(t,[od(id(r.firestore),"addDoc",e.S_,i,null!==r.v_,{}).O_(e.S_,As.exists(!1))]).then(function(){return e}).then(function(t){return new Ev(n.firestore,t)})},Hv.prototype.isEqual=function(t){return Gp(this._,t._)},Hv.prototype.withConverter=function(t){return new Hv(this.firestore,this._.withConverter(t))},Hv);function Hv(t,e){var n=this;return(n=Ov.call(this,t,e)||this).firestore=t,n._=e,n}function Bv(t,e){var n=this;return(n=kv.call(this,e)||this).zf=t,n}function Gv(t,e){var n=this;return(n=Pv.call(this,e)||this).zf=t,n}function zv(t,e){var n=this;return(n=Lv.call(this,e)||this).firestore=t,n.Hf=new lv(t),n}function Kv(){return null!==Cv&&Cv.apply(this,arguments)||this}function Jv(t,e){var n=this;return(n=Rv.call(this,e)||this).zf=t,n}function Wv(t){return t instanceof Vr&&(t=t._),xp(t,Cp)}var Xv,Yv,me=(h(tg,Yv=Vr),tg.documentId=function(){return new tg(li.lt().ot())},tg.prototype.isEqual=function(t){return t instanceof Vr&&(t=t._),t instanceof gp&&this._.d_.isEqual(t.d_)},tg),o=(h(Zv,Xv=Vr),Zv.serverTimestamp=function(){var t=new dd("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new Zv(t)},Zv.delete=function(){var t=new ud("deleteField");return t._methodName="FieldValue.delete",new Zv(t)},Zv.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new yd("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new Zv(n)},Zv.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vd("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new Zv(n)},Zv.increment=function(t){return(t=new gd("increment",t))._methodName="FieldValue.increment",new Zv(t)},Zv.prototype.isEqual=function(t){return this._.isEqual(t._)},Zv),Qv=($v.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},$v.prototype.catch=function(t){return this.yd.promise.catch(t)},$v.prototype.then=function(t,e){return this.yd.promise.then(t,e)},$v.prototype.Ul=function(t){this.Ql(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},$v.prototype.jl=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},$v.prototype.Ql=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)},$v);function $v(){this.Pd={},this.yd=new aa,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function Zv(){return null!==Xv&&Xv.apply(this,arguments)||this}function tg(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Yv.call(this,new(gp.bind.apply(gp,f([void 0],t))))||this}eg.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},eg.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},eg.prototype.setServiceProps=function(t){return this.serviceProps=t,this},ge=eg;function eg(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}o={Firestore:fv,GeoPoint:Kp,Timestamp:ai,Blob:Hr,Transaction:Iv,WriteBatch:_v,DocumentReference:Ev,DocumentSnapshot:Vv,Query:Uv,QueryDocumentSnapshot:Mv,QuerySnapshot:qv,CollectionReference:Fv,FieldPath:me,FieldValue:o,setLogLevel:function(t){gr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(e=e.default).INTERNAL.registerComponent(new ge("firestore",function(t){var e=t.getProvider("app").getImmediate();return t=t.getProvider("auth-internal"),new fv(e,new Zd(e,t),new hv)},"PUBLIC").setServiceProps(Object.assign({},o))),e.registerVersion("@firebase/firestore","2.1.2"),fv.prototype.loadBundle=function(t){return e=this,s=t,t=new Qv,function(n,t,r){var e,i=this,o=(e=s,t=jf(t),e=function(t){if(t instanceof Uint8Array)return dp(t,void 0);if(t instanceof ArrayBuffer)return dp(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new vp(e,t));n.fs.ys(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=rp,[4,Jd(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(ny(e._),e.I_,t),t;var e,s},fv.prototype.namedQuery=function(t){return function(n,r){var t=this;return n.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.Eo.$s(t,e)})},[4,zd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(ny((e=this)._),t).then(function(t){return t?new Uv(e,new Rp(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
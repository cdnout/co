(function(t){function i(t,i){t.prototype=Object.create(i.prototype),t.prototype.$super=i.prototype}function d(){return[].slice.call(arguments).reduce(function(t,i){return void 0!==t?t:i})}function p(t,i){var h=t-i;switch(f.INTERNAL_ALIGNMENT){case"left":return[0,h];case"right":return[h,0];case"center":default:return[h/2,h/2]}}function e(t){return"string"==typeof t?new A(t):t}function u(t,i,h){return this instanceof u?(this.children=h||[],this.tagName=t,this.attrs=d(i,{}),this):new u(t,i,h)}function c(t,i){if(!(this instanceof c))return new c(t,i);u.call(this,"path"),this.attrs.d="M"+t+" "+i}function f(t){if(!(this instanceof f))return new f([].slice.call(arguments));u.call(this,"svg",{class:f.DIAGRAM_CLASS}),this.items=t.map(e),this.items.unshift(new a),this.items.push(new m),this.width=this.items.reduce(function(t,i){return t+i.width+(i.needsSpace?20:0)},0)+1,this.up=Math.max.apply(null,this.items.map(function(t){return t.up})),this.down=Math.max.apply(null,this.items.map(function(t){return t.down})),this.formatted=!1}for(var h in u.prototype.format=function(t,i,h){},u.prototype.addTo=function(t){if(t instanceof u)return t.children.push(this),this;var i=this.toSVG();return t.appendChild(i),i},u.prototype.escapeString=function(t){return t.replace(/[*_\`\[\]<&]/g,function(t){return"&#"+t.charCodeAt(0)+";"})},u.prototype.toSVG=function(){var i=function(t,i,h){i=i||{},h=h||"";var s=document.createElementNS("http://www.w3.org/2000/svg",t);for(var e in i)s.setAttribute(e,i[e]);return s.textContent=h,s}(this.tagName,this.attrs);return"string"==typeof this.children?i.innerHTML=u.prototype.escapeString(this.children):this.children.forEach(function(t){i.appendChild(t.toSVG())}),i},u.prototype.toString=function(){var i="<"+this.tagName,t="g"==this.tagName||"svg"==this.tagName;for(var h in this.attrs)i+=" "+h+'="'+(this.attrs[h]+"").replace(/&/g,"&amp;").replace(/"/g,"&quot;")+'"';return i+=">",t&&(i+="\n"),"string"==typeof this.children?i+=u.prototype.escapeString(this.children):this.children.forEach(function(t){i+=t}),i+="</"+this.tagName+">\n"},i(c,u),c.prototype.m=function(t,i){return this.attrs.d+="m"+t+" "+i,this},c.prototype.right=c.prototype.h=function(t){return this.attrs.d+="h"+t,this},c.prototype.left=function(t){return this.h(-t)},c.prototype.down=c.prototype.v=function(t){return this.attrs.d+="v"+t,this},c.prototype.up=function(t){return this.v(-t)},c.prototype.arc=function(t){var i,h=f.ARC_RADIUS,s=f.ARC_RADIUS;return"e"!=t[0]&&"w"!=t[1]||(h*=-1),"s"!=t[0]&&"n"!=t[1]||(s*=-1),i="ne"==t||"es"==t||"sw"==t||"wn"==t?1:0,this.attrs.d+="a"+f.ARC_RADIUS+" "+f.ARC_RADIUS+" 0 0 "+i+" "+h+" "+s,this},c.prototype.format=function(){return this.attrs.d+="h.5",this},i(f,u),t)f[h]=t[h];function s(t){if(!(this instanceof s))return new s([].slice.call(arguments));u.call(this,"g"),this.items=t.map(e),this.width=this.items.reduce(function(t,i){return t+i.width+(i.needsSpace?20:0)},0),this.up=this.items.reduce(function(t,i){return Math.max(t,i.up)},0),this.down=this.items.reduce(function(t,i){return Math.max(t,i.down)},0)}function n(t,i){if(!(this instanceof n))return new n(t,[].slice.call(arguments,1));if(u.call(this,"g"),"number"!=typeof t||t!==Math.floor(t))throw new TypeError("The first argument of Choice() must be an integer.");if(t<0||t>=i.length)throw new RangeError("The first argument of Choice() must be an index for one of the items.");this.normal=t,this.items=i.map(e),this.width=this.items.reduce(function(t,i){return Math.max(t,i.width)},0)+4*f.ARC_RADIUS,this.up=this.down=0;for(var h=0;h<this.items.length;h++){var s=this.items[h];h<t&&(this.up+=Math.max(f.ARC_RADIUS,s.up+s.down+f.VERTICAL_SEPARATION)),h==t&&(this.up+=Math.max(f.ARC_RADIUS,s.up),this.down+=Math.max(f.ARC_RADIUS,s.down)),t<h&&(this.down+=Math.max(f.ARC_RADIUS,f.VERTICAL_SEPARATION+s.up+s.down))}}function r(t,i){if(void 0===i)return n(1,l(),t);if("skip"===i)return n(0,l(),t);throw"Unknown value for Optional()'s 'skip' argument."}function o(t,i){if(!(this instanceof o))return new o(t,i);u.call(this,"g"),i=i||new l,this.item=e(t),this.rep=e(i),this.width=Math.max(this.item.width,this.rep.width)+2*f.ARC_RADIUS,this.up=this.item.up,this.down=Math.max(2*f.ARC_RADIUS,this.item.down+f.VERTICAL_SEPARATION+this.rep.up+this.rep.down)}function a(t){if(!(this instanceof a))return new a;u.call(this,"path"),this.width=20,this.up=10,this.down=10,this.simpleType=t}function m(t){if(!(this instanceof m))return new m;u.call(this,"path"),this.width=20,this.up=10,this.down=10,this.simpleType=t}function A(t){if(!(this instanceof A))return new A(t);u.call(this,"g"),this.text=t,this.width=8*t.length+20,this.up=11,this.down=11}function w(t){if(!(this instanceof w))return new w(t);u.call(this,"g"),this.text=t,this.width=8*t.length+20,this.up=11,this.down=11}function R(t){if(!(this instanceof R))return new R(t);u.call(this,"g"),this.text=t,this.width=7*t.length+10,this.up=11,this.down=11}function l(){if(!(this instanceof l))return new l;u.call(this,"g"),this.width=0,this.up=0,this.down=0}var S;f.prototype.format=function(t,i,h,s){t=d(t,20),i=d(i,t,20),h=d(h,t,20);var e=s=d(s,i,20),n=t;n+=this.up;for(var r=u("g",f.STROKE_ODD_PIXEL_LENGTH?{transform:"translate(.5 .5)"}:{}),o=0;o<this.items.length;o++){var a=this.items[o];a.needsSpace&&(c(e,n).h(10).addTo(r),e+=10),a.format(e,n,a.width).addTo(r),e+=a.width,a.needsSpace&&(c(e,n).h(10).addTo(r),e+=10)}return this.attrs.width=this.width+s+i,this.attrs.height=this.up+this.down+t+h,this.attrs.viewBox="0 0 "+this.attrs.width+" "+this.attrs.height,r.addTo(this),this.formatted=!0,this},f.prototype.addTo=function(t){var i=document.getElementsByTagName("script"),h=(i=i[i.length-1]).parentNode;return t=t||h,this.$super.addTo.call(this,t)},f.prototype.toSVG=function(){return this.formatted||this.format(),this.$super.toSVG.call(this)},f.prototype.toString=function(){return this.formatted||this.format(),this.$super.toString.call(this)},i(s,u),s.prototype.format=function(t,i,h){var s=p(h,this.width);c(t,i).h(s[0]).addTo(this),c(t+s[0]+this.width,i).h(s[1]).addTo(this),t+=s[0];for(var e=0;e<this.items.length;e++){var n=this.items[e];n.needsSpace&&(c(t,i).h(10).addTo(this),t+=10),n.format(t,i,n.width).addTo(this),t+=n.width,n.needsSpace&&(c(t,i).h(10).addTo(this),t+=10)}return this},i(n,u),n.prototype.format=function(t,i,h){var s=p(h,this.width);c(t,i).h(s[0]).addTo(this),c(t+s[0]+this.width,i).h(s[1]).addTo(this),t+=s[0];for(var e=this.items.length-1,n=this.width-4*f.ARC_RADIUS,r=this.normal-1;0<=r;r--){var o=this.items[r];r==this.normal-1&&(a=Math.max(2*f.ARC_RADIUS,this.items[r+1].up+f.VERTICAL_SEPARATION+o.down)),c(t,i).arc("se").up(a-2*f.ARC_RADIUS).arc("wn").addTo(this),o.format(t+2*f.ARC_RADIUS,i-a,n).addTo(this),c(t+2*f.ARC_RADIUS+n,i-a).arc("ne").down(a-2*f.ARC_RADIUS).arc("ws").addTo(this),a+=Math.max(f.ARC_RADIUS,o.up+f.VERTICAL_SEPARATION+(0==r?0:this.items[r-1].down))}c(t,i).right(2*f.ARC_RADIUS).addTo(this),this.items[this.normal].format(t+2*f.ARC_RADIUS,i,n).addTo(this),c(t+2*f.ARC_RADIUS+n,i).right(2*f.ARC_RADIUS).addTo(this);for(r=this.normal+1;r<=e;r++){var a,o=this.items[r];r==this.normal+1&&(a=Math.max(2*f.ARC_RADIUS,this.items[r-1].down+f.VERTICAL_SEPARATION+o.up)),c(t,i).arc("ne").down(a-2*f.ARC_RADIUS).arc("ws").addTo(this),o.format(t+2*f.ARC_RADIUS,i+a,n).addTo(this),c(t+2*f.ARC_RADIUS+n,i+a).arc("se").up(a-2*f.ARC_RADIUS).arc("wn").addTo(this),a+=Math.max(f.ARC_RADIUS,o.down+f.VERTICAL_SEPARATION+(r==e?0:this.items[r+1].up))}return this},i(o,u),o.prototype.needsSpace=!0,o.prototype.format=function(t,i,h){var s=p(h,this.width);c(t,i).h(s[0]).addTo(this),c(t+s[0]+this.width,i).h(s[1]).addTo(this),c(t+=s[0],i).right(f.ARC_RADIUS).addTo(this),this.item.format(t+f.ARC_RADIUS,i,this.width-2*f.ARC_RADIUS).addTo(this),c(t+this.width-f.ARC_RADIUS,i).right(f.ARC_RADIUS).addTo(this);var e=Math.max(2*f.ARC_RADIUS,this.item.down+f.VERTICAL_SEPARATION+this.rep.up);return c(t+f.ARC_RADIUS,i).arc("nw").down(e-2*f.ARC_RADIUS).arc("ws").addTo(this),this.rep.format(t+f.ARC_RADIUS,i+e,this.width-2*f.ARC_RADIUS).addTo(this),c(t+this.width-f.ARC_RADIUS,i+e).arc("se").up(e-2*f.ARC_RADIUS).arc("en").addTo(this),this},i(a,u),a.prototype.format=function(t,i){return!1===this.simpleType?this.attrs.d="M "+t+" "+(i-10)+" v 20 m 0 -10 h 20.5":this.attrs.d="M "+t+" "+(i-10)+" v 20 m 10 -20 v 20 m -10 -10 h 20.5",this},i(m,u),m.prototype.format=function(t,i){return!1===this.simpleType?this.attrs.d="M "+t+" "+i+" h 20 m 0 -10 v 20":this.attrs.d="M "+t+" "+i+" h 20 m -10 -10 v 20 m 10 -20 v 20",this},i(A,u),A.prototype.needsSpace=!0,A.prototype.format=function(t,i,h){var s=p(h,this.width);return c(t,i).h(s[0]).addTo(this),c(t+s[0]+this.width,i).h(s[1]).addTo(this),u("rect",{x:t+=s[0],y:i-11,width:this.width,height:this.up+this.down,rx:10,ry:10}).addTo(this),u("text",{x:t+this.width/2,y:i+4},this.text).addTo(this),this},i(w,u),w.prototype.needsSpace=!0,w.prototype.format=function(t,i,h){var s=p(h,this.width);return c(t,i).h(s[0]).addTo(this),c(t+s[0]+this.width,i).h(s[1]).addTo(this),u("rect",{x:t+=s[0],y:i-11,width:this.width,height:this.up+this.down}).addTo(this),u("text",{x:t+this.width/2,y:i+4},this.text).addTo(this),this},i(R,u),R.prototype.needsSpace=!0,R.prototype.format=function(t,i,h){var s=p(h,this.width);return c(t,i).h(s[0]).addTo(this),c(t+s[0]+this.width,i).h(s[1]).addTo(this),u("text",{x:(t+=s[0])+this.width/2,y:i+5,class:"comment"},this.text).addTo(this),this},i(l,u),l.prototype.format=function(t,i,h){return c(t,i).right(h).addTo(this),this},"function"==typeof define&&define.amd?(S={},define([],function(){return S})):S="object"==typeof exports?exports:this;var T=[f,function(){var t=new f([].slice.call(arguments)),i=t.items;return i.shift(),i.pop(),i.unshift(new a(!1)),i.push(new m(!1)),t.items=i,t},s,n,r,o,function(t,i,h){return r(o(t,i),h)},A,w,R,l];["Diagram","ComplexDiagram","Sequence","Choice","Optional","OneOrMore","ZeroOrMore","Terminal","NonTerminal","Comment","Skip"].forEach(function(t,i){S[t]=T[i]})}).call(this,{VERTICAL_SEPARATION:8,ARC_RADIUS:10,DIAGRAM_CLASS:"railroad-diagram",STROKE_ODD_PIXEL_LENGTH:!0,INTERNAL_ALIGNMENT:"center"});
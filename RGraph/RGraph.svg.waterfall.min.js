RGraph=window.RGraph||{isrgraph:!0,isRGraph:!0,rgraph:!0},RGraph.SVG=RGraph.SVG||{},window,document,RGraph.SVG.Waterfall=function(t){this.set=function(t,e){if("colorsConnector"===t&&(t="colorsConnectors"),1===arguments.length&&"object"==typeof t)for(l in arguments[0])"string"==typeof l&&(t=a.name,e=a.value,this.set(t,e));else{var a=RGraph.SVG.commonSetter({object:this,name:t,value:e});t=a.name,e=a.value,this.properties[t]=e,"colors"===t&&(this.originalColors=RGraph.SVG.arrayClone(e),this.colorsParsed=!1)}return this},this.get=function(t){return this.properties[t]},t.data=RGraph.SVG.stringsToNumbers(t.data),this.id=t.id,this.uid=RGraph.SVG.createUID(),this.container=document.getElementById(this.id),this.layers={},this.svg=RGraph.SVG.createSVG({object:this,container:this.container}),this.isRGraph=!0,this.isrgraph=!0,this.rgraph=!0,this.data=t.data,this.type="waterfall",this.coords=[],this.colorsParsed=!1,this.originalColors={},this.gradientCounter=1,this.totalColumns=[],this.firstDraw=!0,RGraph.SVG.OR.add(this),this.container.style.display="inline-block";for(var l=0;l<this.data.length;++l)RGraph.SVG.isNull(this.data[l])&&(this.totalColumns[l]=!0);this.properties={marginLeft:35,marginRight:35,marginTop:35,marginBottom:35,marginInner:5,backgroundColor:null,backgroundImage:null,backgroundImageAspect:"none",backgroundImageStretch:!0,backgroundImageOpacity:null,backgroundImageX:null,backgroundImageY:null,backgroundImageW:null,backgroundImageH:null,backgroundGrid:!0,backgroundGridColor:"#ddd",backgroundGridLinewidth:1,backgroundGridHlines:!0,backgroundGridHlinesCount:null,backgroundGridVlines:!0,backgroundGridVlinesCount:null,backgroundGridBorder:!0,backgroundGridDashed:!1,backgroundGridDotted:!1,backgroundGridDashArray:null,colors:["black","red","blue"],colorsSequential:!1,colorsStroke:"#aaa",colorsConnectors:"#666",total:!0,linewidth:1,yaxis:!0,yaxisTickmarks:!0,yaxisTickmarksLength:5,yaxisColor:"black",yaxisScale:!0,yaxisLabels:null,yaxisLabelsOffsetx:0,yaxisLabelsOffsety:0,yaxisLabelsCount:5,yaxisScaleUnitsPre:"",yaxisScaleUnitsPost:"",yaxisScaleStrict:!1,yaxisScaleDecimals:0,yaxisScalePoint:".",yaxisScaleThousand:",",yaxisScaleRound:!1,yaxisScaleMax:null,yaxisScaleMin:0,yaxisScaleFormatter:null,yaxisLabelsColor:null,yaxisLabelsBold:null,yaxisLabelsItalic:null,yaxisLabelsFont:null,yaxisLabelsSize:null,yaxisTitle:"",yaxisTitleBold:null,yaxisTitleSize:null,yaxisTitleFont:null,yaxisTitleColor:null,yaxisTitleItalic:null,yaxisTitleOffsetx:0,yaxisTitleOffsety:0,yaxisTitleX:null,yaxisTitleY:null,yaxisTitleHalign:null,yaxisTitleValign:null,xaxis:!0,xaxisTickmarks:!0,xaxisTickmarksLength:5,xaxisLabels:null,xaxisLabelsFont:null,xaxisLabelsSize:null,xaxisLabelsColor:null,xaxisLabelsBold:null,xaxisLabelsItalic:null,xaxisLabelsPosition:"section",xaxisLabelsPositionEdgeTickmarksCount:null,xaxisLabelsFormattedDecimals:0,xaxisLabelsFormattedPoint:".",xaxisLabelsFormattedThousand:",",xaxisLabelsFormattedUnitsPre:"",xaxisLabelsFormattedUnitsPost:"",xaxisColor:"black",xaxisLabelsOffsetx:0,xaxisLabelsOffsety:0,xaxisTitle:"",xaxisTitleBold:null,xaxisTitleSize:null,xaxisTitleFont:null,xaxisTitleColor:null,xaxisTitleItalic:null,xaxisTitleOffsetx:0,xaxisTitleOffsety:0,xaxisTitleX:null,xaxisTitleY:null,xaxisTitleHalign:null,xaxisTitleValign:null,labelsAbove:!1,labelsAboveFont:null,labelsAboveSize:null,labelsAboveBold:null,labelsAboveItalic:null,labelsAboveColor:null,labelsAboveBackground:"rgba(255,255,255,0.5)",labelsAboveBackgroundPadding:2,labelsAboveUnitsPre:null,labelsAboveUnitsPost:null,labelsAbovePoint:null,labelsAboveThousand:null,labelsAboveFormatter:null,labelsAboveDecimals:null,labelsAboveOffsetx:0,labelsAboveOffsety:0,labelsAboveHalign:"center",labelsAboveValign:"bottom",labelsAboveSpecific:null,labelsAboveLastFont:null,labelsAboveLastBold:null,labelsAboveLastItalic:null,labelsAboveLastSize:null,labelsAboveLastColor:null,labelsAboveLastBackground:null,labelsAboveLastBackgroundPadding:null,textColor:"black",textFont:"Arial, Verdana, sans-serif",textSize:12,textBold:!1,textItalic:!1,text:null,tooltips:null,tooltipsOverride:null,tooltipsEffect:"fade",tooltipsCssClass:"RGraph_tooltip",tooltipsCss:null,tooltipsEvent:"click",tooltipsFormattedThousand:",",tooltipsFormattedPoint:".",tooltipsFormattedDecimals:0,tooltipsFormattedUnitsPre:"",tooltipsFormattedUnitsPost:"",tooltipsFormattedKeyColors:null,tooltipsFormattedKeyColorsShape:"square",tooltipsFormattedKeyLabels:[],tooltipsFormattedTableHeaders:null,tooltipsFormattedTableData:null,tooltipsPointer:!0,tooltipsPositionStatic:!0,highlightStroke:"rgba(0,0,0,0)",highlightFill:"rgba(255,255,255,0.7)",highlightLinewidth:1,title:"",titleX:null,titleY:null,titleHalign:"center",titleValign:null,titleSize:null,titleColor:null,titleFont:null,titleBold:null,titleItalic:null,titleSubtitle:null,titleSubtitleSize:null,titleSubtitleColor:"#aaa",titleSubtitleFont:null,titleSubtitleBold:null,titleSubtitleItalic:null,key:null,keyColors:null,keyOffsetx:0,keyOffsety:0,keyLabelsOffsetx:0,keyLabelsOffsety:-1,keyLabelsFont:null,keyLabelsSize:null,keyLabelsColor:null,keyLabelsBold:null,keyLabelsItalic:null},RGraph.SVG.getGlobals(this),RGraph.SVG.FX&&"function"==typeof RGraph.SVG.FX.decorate&&RGraph.SVG.FX.decorate(this),this.responsive=RGraph.SVG.responsive,RGraph.SVG.addCreateFunction(this);var m=this.properties;for(l in this.draw=function(){if(RGraph.SVG.fireCustomEvent(this,"onbeforedraw"),this.width=Number(this.svg.getAttribute("width")),this.height=Number(this.svg.getAttribute("height")),m.xaxisLabels&&m.xaxisLabels.length){"string"==typeof m.xaxisLabels&&(m.xaxisLabels=RGraph.SVG.arrayPad({array:[],length:this.data.length+(m.total?1:0),value:m.xaxisLabels}));for(var t=0;t<m.xaxisLabels.length;++t)m.xaxisLabels[t]=RGraph.SVG.labelSubstitution({object:this,text:m.xaxisLabels[t],index:t,value:this.data[t],decimals:m.xaxisLabelsFormattedDecimals||0,unitsPre:m.xaxisLabelsFormattedUnitsPre||"",unitsPost:m.xaxisLabelsFormattedUnitsPost||"",thousand:m.xaxisLabelsFormattedThousand||",",point:m.xaxisLabelsFormattedPoint||"."})}var e;RGraph.SVG.createDefs(this),this.coords=[],this.graphWidth=this.width-m.marginLeft-m.marginRight,this.graphHeight=this.height-m.marginTop-m.marginBottom,RGraph.SVG.resetColorsToOriginalValues({object:this}),this.parseColors(),m.total&&!this.totalAdded&&(this.totalAdded=!0,e=RGraph.SVG.arraySum(this.data),this.data.push(e),m.xaxisLabels&&m.xaxisLabels.length===this.data.length-1&&m.xaxisLabels.push(""));for(var a,t=0,l=0,i=0;t<this.data.length-(m.total?1:0);++t)i+=this.data[t],l=Math.max(Math.abs(l),Math.abs(i));return"number"==typeof m.yaxisScaleMax&&(l=m.yaxisScaleMax),"mirror"!==m.yaxisScaleMin&&"middle"!==m.yaxisScaleMin&&"center"!==m.yaxisScaleMin||(a=!0,m.yaxisScaleMin=0),this.scale=RGraph.SVG.getScale({object:this,numlabels:m.yaxisLabelsCount,unitsPre:m.yaxisScaleUnitsPre,unitsPost:m.yaxisScaleUnitsPost,max:l,min:m.yaxisScaleMin,point:m.yaxisScalePoint,round:m.yaxisScaleRound,thousand:m.yaxisScaleThousand,decimals:m.yaxisScaleDecimals,strict:"number"==typeof m.yaxisScaleMax,formatter:m.yaxisScaleFormatter}),a&&(this.scale=RGraph.SVG.getScale({object:this,numlabels:m.yaxisLabelsCount,unitsPre:m.yaxisScaleUnitsPre,unitsPost:m.yaxisScaleUnitsPost,max:this.scale.max,min:-1*this.scale.max,point:m.yaxisScalePoint,round:!1,thousand:m.yaxisScaleThousand,decimals:m.yaxisScaleDecimals,strict:"number"==typeof m.yaxisScaleMax,formatter:m.yaxisScaleFormatter})),this.max=this.scale.max,this.min=this.scale.min,m.yaxisScaleMax=this.scale.max,m.yaxisScaleMin=this.scale.min,RGraph.SVG.drawBackground(this),RGraph.SVG.drawXAxis(this),RGraph.SVG.drawYAxis(this),this.drawBars(),this.drawLabelsAbove(),null!==typeof m.key&&RGraph.SVG.drawKey?RGraph.SVG.drawKey(this):RGraph.SVG.isNull(m.key)||alert("The drawKey() function does not exist - have you forgotten to include the key library?"),RGraph.SVG.addCustomText(this),this.firstDraw&&(this.firstDraw=!1,RGraph.SVG.fireCustomEvent(this,"onfirstdraw")),RGraph.SVG.fireCustomEvent(this,"ondraw"),this},this.drawBars=function(){this.graphWidth=this.width-m.marginLeft-m.marginRight,this.graphHeight=this.height-m.marginTop-m.marginBottom;for(var t=this.graphWidth/this.data.length-2*m.marginInner,e=this.graphWidth/this.data.length,a=this.getYCoord(0),l=0,i=0;i<this.data.length;++i){var s=this.data[i-1],o=(this.data[i+1],this.data[i]),r=l;l+=parseFloat(this.data[i])||0;var n=Math.abs(this.data[i]/(this.scale.max-this.scale.min)*this.graphHeight);RGraph.SVG.isNull(s)?a=0<o?this.getYCoord(r)-n:this.getYCoord(r):0==i&&0<this.data[i]||0<this.data[i]&&0<this.data[i-1]?a-=n:0<this.data[i]&&this.data[i-1]<0?a=a+u-n:this.data[i]<0&&0<this.data[i-1]||this.data[i]<0&&this.data[i-1]<0&&(a+=u);o=0<this.data[i]?m.colors[0]:m.colors[1];m.colorsSequential&&(o=m.colors[i]),m.total&&(i===this.data.length-1&&0<=this.data[this.data.length-1]?(a=this.getYCoord(0)-n,m.colorsSequential||(o=m.colors[2])):i===this.data.length-1&&this.data[this.data.length-1]<0&&(a=this.getYCoord(0),m.colorsSequential||(o=m.colors[2])));r=m.marginLeft+e*i+m.marginInner;null!==this.data[i]&&void 0!==this.data[i]||(this.getYCoord(0),a=s<0?b+u:b,n=this.getYCoord(0)-this.getYCoord(l),m.colorsSequential||(o=m.colors[3]||m.colors[2]),n<0&&(a+=n,n*=-1));var h,d=RGraph.SVG.create({svg:this.svg,type:"rect",parent:this.svg.all,attr:{x:r,y:a,width:t,height:n,stroke:m.colorsStroke,fill:o,"stroke-width":m.linewidth,"shape-rendering":"crispEdges","data-index":i,"data-original-x":r,"data-original-y":a,"data-original-width":t,"data-original-height":n,"data-original-stroke":m.colorsStroke,"data-original-fill":o,"data-value":String(this.data[i])}});this.coords.push({object:this,element:d,x:r,y:a,width:t,height:n}),RGraph.SVG.isNull(m.tooltips)||!m.tooltips[i]&&"string"!=typeof m.tooltips||(h=this,function(e){d.addEventListener(m.tooltipsEvent.replace(/^on/,""),function(t){h.removeHighlight(),RGraph.SVG.tooltip({object:h,index:e,group:0,sequentialIndex:e,text:"string"==typeof m.tooltips?m.tooltips:m.tooltips[e],event:t}),h.highlight(t.target)},!1),d.addEventListener("mousemove",function(t){t.target.style.cursor="pointer"},!1)}(i));var b=a,u=n,s=this.data[i]}for(i=0;i<this.coords.length;++i)if(this.coords[i+1]&&this.coords[i+1].element){var c=Number(this.coords[i].element.getAttribute("x"))+Number(this.coords[i].element.getAttribute("width")),g=parseInt(this.coords[i].element.getAttribute("y"))+(0<this.data[i]?0:parseInt(this.coords[i].element.getAttribute("height"))),p=c+2*m.marginInner,x=parseInt(this.coords[i].element.getAttribute("y"))+(0<this.data[i]?0:parseInt(this.coords[i].element.getAttribute("height")));if("null"===this.coords[i].element.getAttribute("data-value")&&(i===this.data.length-1&&(g=parseFloat(this.coords[i].element.getAttribute("y")),x=parseFloat(g)),this.totalColumns[i])){for(var y=0,l=0;y<i;++y)l+=this.data[y];0<l&&0<this.data[i-1]?x=g=Number(this.coords[i-1].element.getAttribute("y")):0<l&&this.data[i-1]<0&&(x=g=Number(this.coords[i-1].element.getAttribute("y"))+Number(this.coords[i-1].element.getAttribute("height")))}RGraph.SVG.create({svg:this.svg,type:"line",parent:this.svg.all,attr:{x1:c,y1:g+.5,x2:p,y2:x+.5,stroke:m.colorsConnectors||m.colorsStroke,"stroke-width":m.linewidth,"data-index":i,"data-original-x1":c,"data-original-y1":g+.5,"data-original-x2":p,"data-original-y2":x+.5}})}},this.getYCoord=function(t){if(t>this.scale.max)return null;m.xaxispos;return t<this.scale.min?null:(t=(t-this.scale.min)/(this.scale.max-this.scale.min),t*=this.height-m.marginTop-m.marginBottom,t=this.height-m.marginBottom-t)},this.highlight=function(t){var e=parseFloat(t.getAttribute("x"))-.5,a=parseFloat(t.getAttribute("y"))-.5,l=parseFloat(t.getAttribute("width"))+1,t=parseFloat(t.getAttribute("height"))+1,t=RGraph.SVG.create({svg:this.svg,type:"rect",parent:this.svg.all,attr:{stroke:m.highlightStroke,fill:m.highlightFill,x:e,y:a,width:l,height:t,"stroke-width":m.highlightLinewidth},style:{pointerEvents:"none"}});RGraph.SVG.REG.set("highlight",t)},this.parseColors=function(){Object.keys(this.originalColors).length||(this.originalColors={colors:RGraph.SVG.arrayClone(m.colors),backgroundGridColor:RGraph.SVG.arrayClone(m.backgroundGridColor),highlightFill:RGraph.SVG.arrayClone(m.highlightFill),backgroundColor:RGraph.SVG.arrayClone(m.backgroundColor)});var t=m.colors;if(t)for(var e=0;e<t.length;++e)t[e]=RGraph.SVG.parseColorLinear({object:this,color:t[e]});m.backgroundGridColor=RGraph.SVG.parseColorLinear({object:this,color:m.backgroundGridColor}),m.highlightFill=RGraph.SVG.parseColorLinear({object:this,color:m.highlightFill}),m.backgroundColor=RGraph.SVG.parseColorLinear({object:this,color:m.backgroundColor})},this.drawLabelsAbove=function(){if(m.labelsAbove)for(var t=0,e=0;e<this.coords.length;++e){var a=this.data[e],t=t+a;if("number"==typeof a||RGraph.SVG.isNull(a)){RGraph.SVG.isNull(a)&&(a=t);var l=RGraph.SVG.numberFormat({object:this,num:a.toFixed(m.labelsAboveDecimals),prepend:"string"==typeof m.labelsAboveUnitsPre?m.labelsAboveUnitsPre:null,append:"string"==typeof m.labelsAboveUnitsPost?m.labelsAboveUnitsPost:null,point:"string"==typeof m.labelsAbovePoint?m.labelsAbovePoint:null,thousand:"string"==typeof m.labelsAboveThousand?m.labelsAboveThousand:null,formatter:"function"==typeof m.labelsAboveFormatter?m.labelsAboveFormatter:null});if(m.labelsAboveSpecific&&m.labelsAboveSpecific.length&&("string"==typeof m.labelsAboveSpecific[e]||"number"==typeof m.labelsAboveSpecific[e]))l=m.labelsAboveSpecific[e];else if(m.labelsAboveSpecific&&m.labelsAboveSpecific.length&&"string"!=typeof m.labelsAboveSpecific[e]&&"number"!=typeof m.labelsAboveSpecific[e])continue;var i,s,o,r,n=parseFloat(this.coords[e].element.getAttribute("x"))+parseFloat(this.coords[e].element.getAttribute("width")/2)+m.labelsAboveOffsetx;a=0<=this.data[e]?(i=parseFloat(this.coords[e].element.getAttribute("y"))-7+m.labelsAboveOffsety,m.labelsAboveValign):(i=parseFloat(this.coords[e].element.getAttribute("y"))+parseFloat(this.coords[e].element.getAttribute("height"))+7-m.labelsAboveOffsety,"top"===m.labelsAboveValign?"bottom":"top"),m.total&&e===this.coords.length-1?(s=m.labelsAboveLastBackground||m.labelsAboveBackground||null,o=("number"==typeof m.labelsAboveLastBackgroundPadding?m.labelsAboveLastBackgroundPadding:m.labelsAboveBackgroundPadding)||0,(r={}).font=m.labelsAboveLastFont||m.labelsAboveFont||m.textFont,r.color=m.labelsAboveLastColor||m.labelsAboveColor||m.textColor,"number"==typeof m.labelsAboveLastSize?r.size=m.labelsAboveLastSize:"number"==typeof m.labelsAboveSize?r.size=m.labelsAboveSize:r.size=m.textSize,"boolean"==typeof m.labelsAboveLastBold?r.bold=m.labelsAboveLastBold:"boolean"==typeof m.labelsAboveBold?r.bold=m.labelsAboveBold:r.bold=m.textBold,"boolean"==typeof m.labelsAboveLastItalic?r.italic=m.labelsAboveLastItalic:"boolean"==typeof m.labelsAboveItalic?r.italic=m.labelsAboveItalic:r.italic=m.textItalic):(s=m.labelsAboveBackground||null,o=m.labelsAboveBackgroundPadding||0,r=RGraph.SVG.getTextConf({object:this,prefix:"labelsAbove"})),RGraph.SVG.text({object:this,parent:this.svg.all,tag:"labels.above",text:l,x:n,y:i,halign:m.labelsAboveHalign,valign:a,font:r.font,size:r.size,bold:r.bold,italic:r.italic,color:r.color,background:s,padding:o})}}},this.on=function(t,e){return"on"!==t.substr(0,2)&&(t="on"+t),RGraph.SVG.addCustomEventListener(this,t,e),this},this.exec=function(t){return t(this),this},this.removeHighlight=function(){var t=RGraph.SVG.REG.get("highlight");t&&t.parentNode&&t.parentNode.removeChild(t),RGraph.SVG.REG.set("highlight",null)},this.tooltipSubstitutions=function(t){return{index:t.index,dataset:0,sequentialIndex:t.index,value:this.data[t.index],values:[this.data[t.index]]}},this.tooltipsFormattedCustom=function(t,e){var a,l,i,s,o=m.colors,r=(o=m.tooltipsFormattedKeyColors&&m.tooltipsFormattedKeyColors[0]&&m.tooltipsFormattedKeyColors[1]&&m.tooltipsFormattedKeyColors[2]?m.tooltipsFormattedKeyColors:o)[0];if(t.value<0&&(r=o[1]),t.index+1!==this.data.length&&!RGraph.SVG.isNull(this.data[t.index])||(r=o[2]),m.tooltipsFormattedKeyLabels&&"object"==typeof m.tooltipsFormattedKeyLabels&&(l=t.index===this.data.length-1,i=RGraph.SVG.isNull(this.data[t.index]),s=0<t.value,o=t.value<0,l?a="string"==typeof m.tooltipsFormattedKeyLabels[2]?m.tooltipsFormattedKeyLabels[2]:"":!l&&i?a="string"==typeof m.tooltipsFormattedKeyLabels[3]?m.tooltipsFormattedKeyLabels[3]:"":"string"==typeof m.tooltipsFormattedKeyLabels[0]&&s&&!l?a=m.tooltipsFormattedKeyLabels[0]:"string"==typeof m.tooltipsFormattedKeyLabels[1]&&o?a=m.tooltipsFormattedKeyLabels[1]:"string"==typeof m.tooltipsFormattedKeyLabels[2]&&l&&(a=m.tooltipsFormattedKeyLabels[2])),RGraph.SVG.isNull(this.data[t.index]))for(var n=0,h=0;n<=t.index;++n)h+=this.data[n];return{label:a,color:r,value:h}},this.positionTooltipStatic=function(t){var e=t.object,a=(t.event,t.tooltip),l=(t.index,RGraph.SVG.getSVGXY(e.svg)),e=this.coords[t.index];t.tooltip.style.left=l[0]+e.x-a.offsetWidth/2+e.width/2+"px",t.tooltip.style.top=l[1]+e.y-a.offsetHeight-10+"px",parseFloat(t.tooltip.style.top)<0&&(t.tooltip.style.top=l[1]+e.y+e.height/2-a.offsetHeight-10+"px")},t.options)"string"==typeof l&&this.set(l,t.options[l])};
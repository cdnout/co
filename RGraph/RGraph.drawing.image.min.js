RGraph=window.RGraph||{isrgraph:!0,isRGraph:!0,rgraph:!0},RGraph.Drawing=RGraph.Drawing||{},RGraph.Drawing.Image=function(t){var s,h=t.id,o=(document.getElementById(h),t.x),e=t.y,r=t.src;this.id=h,this.canvas=document.getElementById(this.id),this.context=this.canvas.getContext("2d"),this.colorsParsed=!1,(this.canvas.__object__=this).alignmentProcessed=!1,this.original_colors=[],this.firstDraw=!0,this.x=o,this.y=e,this.src=r,this.img=new Image,this.img.src=this.src,this.type="drawing.image",this.isRGraph=!0,this.isrgraph=!0,this.rgraph=!0,this.uid=RGraph.createUID(),this.canvas.uid=this.canvas.uid||RGraph.createUID(),this.properties={src:null,width:null,height:null,halign:"left",valign:"top",shadow:!1,shadowColor:"gray",shadowOffsetx:3,shadowOffsety:3,shadowBlur:5,tooltips:null,tooltipsHighlight:!0,tooltipsCssClass:"RGraph_tooltip",tooltipsCss:null,tooltipsEffect:"slide",tooltipsEvent:"onclick",tooltipsFormattedPoint:".",tooltipsFormattedThousand:",",tooltipsFormattedDecimals:0,tooltipsFormattedUnitsPre:"",tooltipsFormattedUnitsPost:"",tooltipsFormattedListType:"ul",tooltipsFormattedListItems:null,tooltipsPointer:!0,tooltipsPositionStatic:!0,highlightStroke:"rgba(0,0,0,0)",highlightFill:"rgba(255,255,255,0.7)",colorsAlpha:1,border:!1,borderColor:"black",borderLinewidth:1,borderRadius:0,backgroundColor:"rgba(0,0,0,0)",text:null,clearto:"rgba(0,0,0,0)"},this.canvas?(this.coords=[],this.$0={},s=this.properties,this.path=RGraph.pathObjectFunction,RGraph.Effects&&"function"==typeof RGraph.Effects.decorate&&RGraph.Effects.decorate(this),this.set=function(t){var h=void 0===arguments[1]?null:arguments[1];if(1!==arguments.length||"object"!=typeof t)return s[t]=h,this;for(i in t)"string"==typeof i&&this.set(i,t[i]);return this},this.get=function(t){return s[t]},this.draw=function(){RGraph.fireCustomEvent(this,"onbeforedraw"),this.canvas.__rgraph_aa_translated__||(this.context.translate(.5,.5),this.canvas.__rgraph_aa_translated__=!0);var i=this;this.img.onload=function(){var t;i.colorsParsed||(i.parseColors(),i.colorsParsed=!0),i.width=this.width,i.height=this.height,i.alignmentProcessed||(t="number"==typeof i.properties.width&&"number"==typeof i.properties.width,"center"===i.properties.halign?i.x-=t?i.properties.width/2:this.width/2:"right"==i.properties.halign&&(i.x-=(t?i.properties:this).width),"center"===i.properties.valign?i.y-=t?i.properties.height/2:this.height/2:"bottom"==i.properties.valign&&(i.y-=(t?i.properties:this).height),i.alignmentProcessed=!0)},!this.img.complete&&4!==this.img.readyState||this.img.onload(),s.shadow&&RGraph.setShadow(this,s.shadowColor,s.shadowOffsetx,s.shadowOffsety,s.shadowBlur);var t,h=this.context.globalAlpha;this.context.globalAlpha=s.colorsAlpha,s.border&&(this.context.strokeStyle=s.borderColor,this.context.lineWidth=s.borderLinewidth,t=0,(this.width||this.height)&&(t=Math.min(this.width/2,this.height/2)),s.width/2>t&&s.height/2>t&&(t=Math.min(s.width/2,s.height/2)),s.borderRadius<t&&(t=s.borderRadius),this.context.beginPath(),this.roundedRect(Math.round(this.x)-Math.round(this.context.lineWidth/2),Math.round(this.y)-Math.round(this.context.lineWidth/2),(s.width||this.img.width)+this.context.lineWidth,(s.height||this.img.height)+this.context.lineWidth,t)),t?(this.context.save(),this.drawBackgroundColor(t),this.context.beginPath(),this.roundedRect(Math.round(this.x)-Math.round(this.context.lineWidth/2),Math.round(this.y)-Math.round(this.context.lineWidth/2),(s.width||this.img.width)+this.context.lineWidth,(s.height||this.img.height)+this.context.lineWidth,t),this.context.clip()):this.drawBackgroundColor(0),"number"==typeof s.height||"number"==typeof s.width?this.context.drawImage(this.img,Math.round(this.x),Math.round(this.y),s.width||this.width,s.height||this.height):this.context.drawImage(this.img,Math.round(this.x),Math.round(this.y)),t&&this.context.restore(),RGraph.noShadow(this),s.border&&this.context.stroke(),this.context.globalAlpha=h;i=this;return this.img.onload=function(){RGraph.redrawCanvas(i.canvas),i.coords[0]=[Math.round(i.x),Math.round(i.y),("number"==typeof s.width?s:this).width,("number"==typeof s.height?s:this).height]},RGraph.noShadow(this),RGraph.addCustomText(this),RGraph.installEventListeners(this),this.firstDraw&&(this.firstDraw=!1,RGraph.fireCustomEvent(this,"onfirstdraw"),this.firstDrawFunc()),RGraph.fireCustomEvent(this,"ondraw"),this},this.exec=function(t){return t(this),this},this.getObjectByXY=function(t){RGraph.getMouseXY(t);if(this.getShape(t))return this},this.getShape=function(t){var i,t=RGraph.getMouseXY(t);t[0],t[1];return this.coords&&this.coords[0]&&t[0]>=this.coords[0][0]&&t[0]<=this.coords[0][0]+this.coords[0][2]&&t[1]>=this.coords[0][1]&&t[1]<=this.coords[0][1]+this.coords[0][3]?(RGraph.parseTooltipText&&s.tooltips&&(i=RGraph.parseTooltipText(s.tooltips,0)),{object:this,x:this.coords[0][0],y:this.coords[0][1],width:this.coords[0][2],height:this.coords[0][3],dataset:0,index:0,sequentialIndex:0,tooltip:"string"==typeof i?i:null}):null},this.highlight=function(t){s.tooltipsHighlight&&("function"==typeof s.highlightStyle?s.highlightStyle(t):this.path("b r % % % % f % s %",this.coords[0][0],this.coords[0][1],this.coords[0][2],this.coords[0][3],s.highlightFill,s.highlightStroke))},this.parseColors=function(){0===this.original_colors.length&&(this.original_colors.colorsBackground=RGraph.arrayClone(s.colorsBackground),this.original_colors.highlightStroke=RGraph.arrayClone(s.highlightStroke),this.original_colors.highlightFill=RGraph.arrayClone(s.highlightFill)),s.colorsBackground=this.parseSingleColorForGradient(s.colorsBackground),s.highlightStroke=this.parseSingleColorForGradient(s.highlightStroke),s.highlightFill=this.parseSingleColorForGradient(s.highlightFill)},this.reset=function(){},this.parseSingleColorForGradient=function(t){if(!t)return t;if("string"==typeof t&&t.match(/^gradient\((.*)\)$/i)){if(t.match(/^gradient\(({.*})\)$/i))return RGraph.parseJSONGradient({object:this,def:RegExp.$1});var i=RegExp.$1.split(":"),h=this.context.createLinearGradient(this.x,this.y,this.x+this.img.width,this.y),o=1/(i.length-1);h.addColorStop(0,RGraph.trim(i[0]));for(var s=1;s<i.length;++s)h.addColorStop(s*o,RGraph.trim(i[s]))}return h||t},this.on=function(t,i){return"function"!=typeof this[t="on"!==t.substr(0,2)?"on"+t:t]?this[t]=i:RGraph.addCustomEventListener(this,t,i),this},this.firstDrawFunc=function(){},this.roundedRect=function(t,i,h,o,s){this.context.save(),this.context.translate(t,i),this.context.moveTo(h/2,0),this.context.arcTo(h,0,h,o,Math.min(o/2,s)),this.context.arcTo(h,o,0,o,Math.min(h/2,s)),this.context.arcTo(0,o,0,0,Math.min(o/2,s)),this.context.arcTo(0,0,s,0,Math.min(h/2,s)),this.context.lineTo(h/2,0),this.context.restore()},this.drawBackgroundColor=function(t){this.context.beginPath(),this.context.fillStyle=s.backgroundColor,this.roundedRect(Math.round(this.x)-Math.round(this.context.lineWidth/2),Math.round(this.y)-Math.round(this.context.lineWidth/2),(s.width||this.img.width)+this.context.lineWidth,(s.height||this.img.height)+this.context.lineWidth,t),this.context.fill()},this.tooltipSubstitutions=function(t){return{index:0,dataset:0,sequentialIndex:0,value:null}},this.positionTooltipStatic=function(t){var i=t.object,h=(t.event,t.tooltip),o=(t.index,RGraph.getCanvasXY(i.canvas));t.tooltip.style.left=o[0]+this.x+(s.width||this.img.width)/2-h.offsetWidth/2+i.properties.tooltipsOffsetx+"px",t.tooltip.style.top=o[1]-h.offsetHeight+i.properties.tooltipsOffsety+this.y-10+"px"},RGraph.register(this),RGraph.parseObjectStyleConfig(this,t.options)):alert("[DRAWING.IMAGE] No canvas support")};
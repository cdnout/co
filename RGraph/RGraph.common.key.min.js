RGraph=window.RGraph||{isrgraph:!0,isRGraph:!0,rgraph:!0},RGraph.HTML=RGraph.HTML||{},function(n){RGraph.drawKey=function(){var f=RGraph.getArgs(arguments,"object,key,colors");if(f.key){f.object.properties;var k=f.object.properties,e=k.keyPosition,t=(k.textSize,[]),o=[];f.object.context.lineWidth=1,f.object.context.beginPath(),"number"==typeof k.keyVpos&&f.object.set("keyPositionY",k.keyVpos*f.object.get("marginTop"));for(var i=0;i<f.key.length;++i)null!=f.key[i]&&(o.push(f.colors[i]),t.push(f.key[i]));key=t,colors=o;var p=!1;if("boolean"==typeof k.keyTextAccessible&&(p=k.keyTextAccessible),!e||"gutter"!==e&&"margin"!==e?!e||"graph"!==e&&"chart"!==e?alert("[KEY] ("+f.object.id+") Unknown key position: "+e):function(e,t,o,i){var c=f.object.marginLeft,n=f.object.marginRight,r=f.object.marginTop,s=(f.object.marginBottom,"right"==k.yaxisPosition?c+10:f.object.canvas.width-n-10),l=r+10,b=(k.title,k.keyBackground,0),a=RGraph.getTextConf({object:f.object,prefix:"keyLabels"});for(blob_size=a.size,text_size=a.size,f.object.coords||(f.object.coords={}),f.object.coords.key=[],f.object.context.font=(a.italic?"italic ":"")+(a.bold?"bold ":"")+a.size+"pt "+a.font,y=0;y<key.length;++y)b=Math.max(b,f.object.context.measureText(key[y]).width);b+=5,b+=blob_size,b+=5,b+=5,b+=5,("left"==k.yaxisPosition||"pie"===f.object.type&&!k.yaxisPosition||"pie"===f.object.type&&!k.yaxisPosition||"hbar"===f.object.type&&!k.yaxisPosition||"hbar"===f.object.type&&"center"===k.yaxisPosition||"hbar"===f.object.type&&"right"===k.yaxisPosition||"rscatter"===f.object.type&&!k.yaxisPosition||"radar"===f.object.type&&!k.yaxisPosition||"rose"===f.object.type&&!k.yaxisPosition||"funnel"===f.object.type&&!k.yaxisPosition||"vprogress"===f.object.type&&!k.yaxisPosition||"hprogress"===f.object.type&&!k.yaxisPosition)&&(s-=b),"string"==typeof k.keyHalign&&("left"===k.keyHalign?s=c+10:"right"==k.keyHalign&&(s=f.object.canvas.width-n-b)),"number"==typeof k.keyPositionX&&(s=k.keyPositionX),"number"==typeof k.keyPositionY&&(l=k.keyPositionY),"number"==typeof k.keyPositionOffsetx&&(s+=k.keyPositionOffsetx),"number"==typeof k.keyPositionOffsety&&(l+=k.keyPositionOffsety),k.keyShadow&&(f.object.context.shadowColor=k.keyShadowColor,f.object.context.shadowBlur=k.keyShadowBlur,f.object.context.shadowOffsetX=k.keyShadowOffsetx,f.object.context.shadowOffsetY=k.keyShadowOffsety),f.object.context.beginPath(),f.object.context.fillStyle=k.keyBackground,f.object.context.strokeStyle="black",(void 0===k.keyPositionGraphBoxed||"boolean"==typeof k.keyPositionGraphBoxed&&k.keyPositionGraphBoxed)&&0!=i&&(f.object.context.lineWidth="number"==typeof k.keyLinewidth?k.keyLinewidth:1,1==k.keyRounded?(f.object.context.beginPath(),f.object.context.strokeStyle="#333",RGraph.roundedRect({context:f.object.context,x:Math.round(s),y:Math.round(l),width:b-5,height:5+(text_size+5)*RGraph.getKeyLength(key),radius:4}),f.object.context.stroke(),f.object.context.fill(),RGraph.noShadow(f.object)):(f.object.context.strokeRect(Math.round(s),Math.round(l),b-5,5+(text_size+5)*RGraph.getKeyLength(key)),f.object.context.fillRect(Math.round(s),Math.round(l),b-5,5+(text_size+5)*RGraph.getKeyLength(key)))),RGraph.noShadow(f.object),f.object.context.beginPath(),k.keyColors&&(colors=k.keyColors);for(var y=key.length-1;0<=y;y--){var h,x=Number(y)+1;"circle"==(h="object"==typeof k.keyColorShape&&"string"==typeof k.keyColorShape[y]||"object"==typeof k.keyColorShape&&"function"==typeof k.keyColorShape[y]?k.keyColorShape[y]:"string"==typeof k.keyColorShape||"function"==typeof k.keyColorShape?k.keyColorShape:"rect")?(f.object.context.beginPath(),f.object.context.fillStyle=colors[y],f.object.context.arc(s+5+blob_size/2,l+5*x+text_size*x-text_size+blob_size/2,blob_size/2,0,6.26,0),f.object.context.fill()):"line"==h?(f.object.context.beginPath(),f.object.context.strokeStyle=colors[y],f.object.context.moveTo(s+5,l+5*x+text_size*x-text_size+blob_size/2),f.object.context.lineTo(s+blob_size+5,l+5*x+text_size*x-text_size+blob_size/2),f.object.context.stroke()):"triangle"==h?(f.object.context.beginPath(),f.object.context.strokeStyle=colors[y],f.object.context.moveTo(s+5,l+5*x+text_size*x-text_size+blob_size),f.object.context.lineTo(s+blob_size/2+5,l+5*x+text_size*x-text_size),f.object.context.lineTo(s+blob_size+5,l+5*x+text_size*x-text_size+blob_size),f.object.context.closePath(),f.object.context.fillStyle=colors[y],f.object.context.fill()):"function"==typeof h?h({object:f.object,color:colors[y],x:s+5,y:l+5*x+text_size*x-text_size,width:text_size,height:text_size+1}):(f.object.context.fillStyle=colors[y],f.object.context.fillRect(s+5,l+5*x+text_size*x-text_size,text_size,text_size+1)),f.object.context.beginPath(),ret=RGraph.text({object:f.object,font:a.font,size:a.size,bold:a.bold,italic:a.italic,color:"object"==typeof a.color?a.color[y]:a.color,x:s+blob_size+5+5+(k.keyLabelsOffsetx||0),y:l+5*x+text_size*x+3+(k.keyLabelsOffsety||0),text:key[y],accessible:p}),f.object.coords.key[y]=[ret.x,ret.y,ret.width,ret.height,key[y],colors[y],f.object]}f.object.context.fill()}():function(){var e="number"==typeof k.keyLabelsSize?k.keyLabelsSize:k.textSize,t=k.keyLabelsBold,o=k.keyLabelsItalic,i=k.keyLabelsFont||k.keyFont||k.textFont,c=k.keyLabelsColor||k.textColor,n=f.object.marginLeft,r=f.object.marginRight,s=f.object.marginTop,l=(f.object.marginBottom,(f.object.canvas.width-n-r)/2+f.object.marginLeft),b=s-e-5,a=(k.title,e),s=k.keyBackground,y=0;for(f.object.coords||(f.object.coords={}),f.object.coords.key=[],f.object.context.font=(f.object.properties.keyLabelsItalic?"italic ":"")+(f.object.properties.keyLabelsBold?"bold ":"")+e+"pt "+i,h=0;h<key.length;++h)y+=8,y+=a,y+=8,y+=f.object.context.measureText(key[h]).width;"pie"==f.object.type&&(l="left"==k.align?f.object.radius+n:"right"==k.align?f.object.canvas.width-f.object.radius-r:f.object.canvas.width/2),l-=(y+=8)/2,"number"==typeof k.keyPositionX&&(l=k.keyPositionX),"number"==typeof k.keyPositionY&&(b=k.keyPositionY),"number"==typeof k.keyPositionOffsetx&&(l+=k.keyPositionOffsetx),"number"==typeof k.keyPositionOffsety&&(b+=k.keyPositionOffsety),(f.object.get("keyPositionGutterBoxed")||f.object.get("keyPositionMarginBoxed"))&&(k.keyShadow&&(f.object.context.shadowColor=k.keyShadowColor,f.object.context.shadowBlur=k.keyShadowBlur,f.object.context.shadowOffsetX=k.keyShadowOffsetx,f.object.context.shadowOffsetY=k.keyShadowOffsety),f.object.context.beginPath(),f.object.context.fillStyle=s,f.object.context.strokeStyle="#999",k.keyRounded?RGraph.roundedRect({context:f.object.context,x:l,y:b-4,width:y,height:e+4+4}):f.object.context.rect(l,b-4,y,e+4+4),f.object.context.stroke(),f.object.context.fill(),RGraph.noShadow(f.object)),k.keyColors&&(colors=k.keyColors);for(var h=0,x=l;h<key.length;++h){x+=8,"line"==(j="object"==typeof k.keyColorShape&&"string"==typeof k.keyColorShape[h]||"object"==typeof k.keyColorShape&&"function"==typeof k.keyColorShape[h]?k.keyColorShape[h]:"function"==typeof k.keyColorShape||"string"==typeof k.keyColorShape?k.keyColorShape:"square")?(f.object.context.beginPath(),f.object.context.strokeStyle=colors[h],f.object.context.moveTo(x,b+a/2),f.object.context.lineTo(x+a,b+a/2),f.object.context.stroke()):"circle"==j?(f.object.context.beginPath(),f.object.context.fillStyle=colors[h],f.object.context.moveTo(x,b+a/2),f.object.context.arc(x+a/2,b+a/2,a/2,0,6.28,0),f.object.context.fill()):"triangle"==j?(f.object.context.fillStyle=colors[h],f.object.context.beginPath(),f.object.context.strokeStyle=colors[h],f.object.context.moveTo(x,b+a),f.object.context.lineTo(x+a/2,b),f.object.context.lineTo(x+a,b+a),f.object.context.closePath(),f.object.context.fill()):"function"==typeof j?j({object:f.object,color:colors[h],x:x,y:b,width:a,height:a}):(f.object.context.beginPath(),f.object.context.fillStyle=colors[h],f.object.context.rect(x,b,a,a),f.object.context.fill()),x+=a,x+=8,f.object.context.beginPath(),f.object.context.fillStyle="object"==typeof c?c[h]:c;var j=RGraph.text({object:f.object,font:i,bold:t,size:e,italic:o,x:x+ +(k.keyLabelsOffsetx||0),y:b+e+1+ +(k.keyLabelsOffsety||0),text:key[h],accessible:p});f.object.context.fill(),x+=f.object.context.measureText(key[h]).width,f.object.coords.key[h]=[j.x,j.y,j.width,j.height,key[h],colors[h],f.object]}}(),k.keyInteractive){RGraph.Drawing&&RGraph.Drawing.Rect||alert("[INTERACTIVE KEY] The drawing API Rect library does not appear to have been included (which the interactive key uses)"),RGraph.installWindowMousedownListener||alert("[INTERACTIVE KEY] The dynamic library does not appear to have been included");for(var i=0,c=f.object.coords.key.length,n=0;i<c;i+=1)n=Math.max(n,f.object.coords.key[i][2]);for(i=0,c=f.object.coords.key.length;i<c;i+=1)!function(o){f.object.coords.key;var e=f.object.coords.key[o],i=o,c=new RGraph.Drawing.Rect({id:f.object.id,x:e[0],y:e[1],width:"gutter"===k.keyPosition||"margin"===k.keyPosition?e[2]:n,height:e[3],options:{colorsFill:"rgba(0,0,0,0)"}}).draw();c.onclick=function(e,t){c.context.fillStyle=k.keyInteractiveHighlightLabel,c.context.fillRect(t.x,t.y,t.width,t.height),"function"==typeof f.object.interactiveKeyHighlight&&(f.object.set("keyInteractiveIndex",o),RGraph.fireCustomEvent(f.object,"onbeforeinteractivekey"),f.object.interactiveKeyHighlight(i),RGraph.fireCustomEvent(f.object,"onafterinteractivekey"))},c.onmousemove=function(e,t){return!0}}(i)}}},RGraph.getKeyLength=function(e){for(var t=0,o=0,i=e.length;o<i;o+=1)null!=e[o]&&++t;return t},RGraph.HTML.key=RGraph.HTML.Key=function(e,o){for(var t=n.getElementById(e),e=RGraph.createUID(),i='<table border="0" cellspacing="0" cellpadding="0" id="rgraph_key_'+e+'" style="display: inline;'+function(){var e="";for(c in o.tableCss)"string"==typeof c&&(e=e+c+": "+o.tableCss[c]+";");return e}()+'" '+(o.tableClass?'class="'+o.tableClass+'"':"")+">",c=0;c<o.labels.length;c+=1)i+='<tr><td><div style="'+function(){var e,t="";for(e in o.blobCss)"string"==typeof e&&(t=t+e+": "+o.blobCss[e]+";");return t}()+"display: inline-block; margin-right: 5px; margin-top: 4px; width: 15px; height: 15px; background-color: "+o.colors[c]+'"'+(o.blobClass?'class="'+o.blobClass+'"':"")+">&nbsp;</div><td>"+(o.links&&o.links[c]?'<a href="'+o.links[c]+'">':"")+"<span "+(o.labelClass?'class="'+o.labelClass+'"':"")+'" style="'+function(){var e,t="";for(e in o.labelCss)"string"==typeof e&&(t=t+e+": "+o.labelCss[e]+";");return t}()+" "+function(){var e="";if(o["labelCss_"+c])for(var t in o["labelCss_"+c])e=e+t+": "+o["labelCss_"+c][t]+";";return e?e+'"':'"'}()+">"+o.labels[c]+"</span>"+(o.links&&o.links[c]?"</a>":"")+"</td></tr>";return t.innerHTML+=i+"</table>",n.getElementById("rgraph_key_"+e)}}((window,document));
RGraph=window.RGraph||{isrgraph:!0,isRGraph:!0,rgraph:!0},function(win,doc,undefined){RGraph.Sheets=function(){var e=RGraph.Sheets.getArgs(arguments,"oauth,key,worksheet,callback");1===arguments.length||(3===arguments.length?(e.oauth=e.oauth,e.key=e.key,e.callback=e.worksheet,e.worksheet="Sheet1"):4===arguments.length&&(e.worksheet=e.worksheet));e.worksheet,e.callback;var f="ABCDEFGHIJKLMNOPQRSTUVWXYZ",t=(e.key,e.oauth,"https://sheets.googleapis.com/v4/spreadsheets/[KEY]/values/[WORKSHEET]?alt=json&key=[OAUTH_KEY]".replace(/\[KEY\]/,e.key).replace(/\[WORKSHEET\]/,encodeURIComponent(e.worksheet)).replace(/\[OAUTH_KEY\]/,e.oauth));this.load=function(e,h){var i=this;RGraph.Sheets.AJAX.getJSON(e,function(e){for(var t=e.values,r=(t.length,0),a=0;a<t.length;++a)r=Math.max(r,t[a].length);for(a=0;a<t.length;++a)for(var s=t[a].length;s<r;++s)t[a][s]="";for(a=0;a<t.length;++a)for(s=0;s<r;++s)t[a][s].match(/^[0-9]+$/)?t[a][s]=parseInt(t[a][s]):t[a][s].match(/^[0-9.]+$/)&&(t[a][s]=parseFloat(t[a][s]));i.data=t,h(i)})},this.row=function(e,t){var r,a={};return this.data[e-1]?(t=t||1,arguments&&"object"==typeof arguments[2]&&"boolean"==typeof arguments[2].trim?a.trim=arguments[2].trim:a.trim=!0,r=this.data[e-1].slice(t-1),a.trim?RGraph.Sheets.arrayRTrim(r):r):[]},this.col=function(e,t){var r={},a=[];t=t||1,arguments&&"object"==typeof arguments[2]&&"boolean"==typeof arguments[2].trim?r.trim=arguments[2].trim:r.trim=!0;for(var s=0;s<this.data.length;++s)a.push(this.data[s][e-1]);return a=(a=r.trim?RGraph.Sheets.arrayRTrim(a):a).slice(t-1)},this.getIndexOfLetters=function(e){var t=e.split("");return 1===t.length?f.indexOf(e)+1:2===t.length?26*(f.indexOf(t[0])+1)+(f.indexOf(t[1])+1):void 0},this.get=function(e){if((e=e.toUpperCase()).match(/^\s*([a-z]+)\s*$/i)){if(1===(e=RegExp.$1).length){var t=f.indexOf(e)+1;return this.col(t,1,arguments[1])}if(2===e.length){t=26*(f.indexOf(e[0])+1)+f.indexOf(e[1])+1;return this.col(t,1,arguments[1])}}if(e.match(/^\s*[0-9]+\s*$/i))return this.row(e,null,arguments[1]);if(e.match(/^\s*([a-z]{1,2})([0-9]+)\s*$/i)){var r=RegExp.$1,a=RegExp.$2;return(n=this.get(r,{trim:!1}))[a-1]}if(e.match(/^\s*([a-z]{1,2})([0-9]+)\s*:\s*([a-z]{1,2})([0-9]+)\s*$/i)){var s=RegExp.$1,r=RegExp.$3,a=parseInt(RegExp.$2),h=parseInt(RegExp.$4);if(s===r)for(var i=[],t=this.getIndexOfLetters(s),n=this.col(t,null,{trim:!1}),o=a-1;o<=h-1;++o)i.push(n[o]);else if(a===h)for(var i=[],l=this.row(a,null,{trim:!1}),c=this.getIndexOfLetters(s),u=this.getIndexOfLetters(r),o=c-1;o<=u-1;++o)i.push(l[o]);else if(s!==r&&a!==h)for(i=[],c=this.getIndexOfLetters(s),u=this.getIndexOfLetters(r),l=[],o=a;o<=h;++o)l=this.row(o).slice(c-1,u),i.push(l);return i=!arguments[1]||!1!==arguments[1].trim?RGraph.Sheets.arrayRTrim(i):i}},this.load(t,e.callback)},RGraph.Sheets.arrayRTrim=function(e){for(var t=[],r=!1,a=e.length-1;0<=a;a--)(e[a]||r)&&(t.push(e[a]),r=!0);return e=t.reverse(),t},RGraph.Sheets.getArgs=function(e,t){var r={},a=0;if(t=t.trim().split(/ *, */),e&&e[0]&&1===e.length&&void 0!==e[0][t[0]]){for(var s=0;s<t.length;++s)void 0===e[0][t[s]]&&(e[0][t[s]]=null);return e[0]}for(s in t)r[t[s]]=void 0===e[a]?null:e[a],a+=1;return r},RGraph.Sheets.AJAX=function(){var e,t=RGraph.Sheets.getArgs(arguments,"url,callback");window.XMLHttpRequest?e=new XMLHttpRequest:window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLHTTP")),e.onreadystatechange=function(){4==this.readyState&&200==this.status&&(this.__user_callback__=t.callback,this.__user_callback__(this.responseText))},e.open("GET",t.url,!0),e&&e.setRequestHeader&&e.setRequestHeader("Cache-Control","no-cache"),e.send()},RGraph.Sheets.AJAX.getJSON=function(){var args=RGraph.Sheets.getArgs(arguments,"url,callback");RGraph.Sheets.AJAX(args.url,function(){var json=eval("("+this.responseText+")");args.callback(json)})}}(window,document);
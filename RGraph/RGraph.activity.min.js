RGraph=window.RGraph||{isrgraph:!0,isRGraph:!0,rgraph:!0},RGraph.Activity=function(t){var s=t.id,i=document.getElementById(s),e=t.min,r=t.max,a=t.value;this.id=s,this.canvas=i,this.context=this.canvas.getContext?this.canvas.getContext("2d",{alpha:"object"!=typeof s||!1!==s.alpha}):null,(this.canvas.__object__=this).type="activity",this.min=RGraph.stringsToNumbers(e),this.max=RGraph.stringsToNumbers(r),this.value=RGraph.stringsToNumbers(a),this.centerx=null,this.centery=null,this.radius=null,this.isRGraph=!0,this.isrgraph=!0,this.rgraph=!0,this.currentValue=null,this.uid=RGraph.createUID(),this.canvas.uid=this.canvas.uid||RGraph.createUID(),this.colorsParsed=!1,this.coordsText=[],this.angles=this.coords=[],this.original_colors=[],this.images=[],this.firstDraw=!0,"number"==typeof this.value&&(this.value=[this.value]);for(var n,o=0;o<this.value.length;++o)this.value[o]<=1e-7&&(this.value[o]=1e-7);this.properties={radius:null,centerx:null,centery:null,width:null,ends:"round",marginLeft:15,marginRight:15,marginTop:15,marginBottom:15,marginInner:1,backgroundGrid:!1,backgroundGridColor:"#666",backgroundGridCircles:!0,backgroundGridCirclesCount:null,backgroundGridRadials:!0,backgroundGridRadialsCount:8,backgroundRings:!0,backgroundRingsColors:null,backgroundRingsAlpha:.5,backgroundColor:"black",colors:["#F45B5B","#90EE7E","#2B908F","red","green","blue","yellow","pink"],icons:[],iconsWidth:null,iconsHeight:null,iconsOffsetx:0,iconsOffsety:0,textFont:"Arial, Verdana, sans-serif",textSize:12,textColor:"#aaa",textBold:!1,textItalic:!1,textAccessible:!0,textAccessibleOverflow:"visible",textAccessiblePointerevents:!1,text:null,labelsCenter:!1,labelsCenterIndex:0,labelsCenterFont:null,labelsCenterSize:50,labelsCenterColor:null,labelsCenterBold:null,labelsCenterItalic:null,labelsCenterUnitsPre:"",labelsCenterUnitsPost:"",labelsCenterDecimals:0,labelsCenterPoint:".",labelsCenterThousand:",",labelsCenterSpecific:"",labelsCenterOffsetx:0,labelsCenterOffsety:0,labels:[],labelsColor:null,labelsFont:null,labelsSize:null,labelsBold:null,labelsItalic:null,labelsBackgroundFill:"transparent",labelsBackgroundStroke:"transparent",labelsOffsetx:0,labelsOffsety:0,labelsFormattedDecimals:0,labelsFormattedPoint:".",labelsFormattedThousand:",",labelsFormattedUnitsPre:"",labelsFormattedUnitsPost:"",contextmenu:null,annotatable:!1,annotatableColor:"black",annotatableLinewidth:1,adjustable:!1,tooltips:null,tooltipsEffect:"slide",tooltipsCssClass:"RGraph_tooltip",tooltipsCss:null,tooltipsEvent:"onclick",tooltipsHighlight:!0,tooltipsHotspotXonly:!1,tooltipsFormattedThousand:",",tooltipsFormattedPoint:".",tooltipsFormattedDecimals:0,tooltipsFormattedUnitsPre:"",tooltipsFormattedUnitsPost:"",tooltipsFormattedKeyColors:null,tooltipsFormattedKeyColorsShape:"square",tooltipsFormattedKeyLabels:[],tooltipsFormattedListType:"ul",tooltipsFormattedListItems:null,tooltipsFormattedTableHeaders:null,tooltipsFormattedTableData:null,tooltipsPointer:!0,tooltipsPositionStatic:!0,highlightStyle:null,highlightStroke:"rgba(0,0,0,0)",highlightFill:"rgba(255,255,255,0.5)",clearto:"rgba(0,0,0,0)"},this.canvas?(n=this.properties,this.path=RGraph.pathObjectFunction,RGraph.Effects&&"function"==typeof RGraph.Effects.decorate&&RGraph.Effects.decorate(this),this.responsive=RGraph.responsive,this.set=function(t){var s=void 0===arguments[1]?null:arguments[1];if(1!==arguments.length||"object"!=typeof t)return n[t]=s,this;for(o in t)"string"==typeof o&&this.set(o,t[o]);return this},this.get=function(t){return n[t]},this.draw=function(){RGraph.fireCustomEvent(this,"onbeforedraw"),this.canvas.__rgraph_aa_translated__||(this.context.translate(.5,.5),this.canvas.__rgraph_aa_translated__=!0),"number"==typeof this.value&&(this.value=[this.value]);for(var t=0;t<this.value.length;++t)this.value[t]>this.max&&(this.value[t]=this.max),this.value[t]<this.min&&(this.value[t]=this.min);return this.currentValue=RGraph.arrayClone(this.value),this.marginLeft=n.marginLeft,this.marginRight=n.marginRight,this.marginTop=n.marginTop,this.marginBottom=n.marginBottom,this.centerx=(this.canvas.width-this.marginLeft-this.marginRight)/2+this.marginLeft,this.centery=(this.canvas.height-this.marginBottom-this.marginTop)/2+this.marginTop,this.radius=Math.min((this.canvas.width-this.marginLeft-this.marginRight)/2,(this.canvas.height-this.marginTop-this.marginBottom)/2),this.coordsText=[],"number"==typeof n.centerx&&(this.centerx=n.centerx),"number"==typeof n.centery&&(this.centery=n.centery),"number"==typeof n.radius&&(this.radius=n.radius),this.width="number"==typeof n.width?n.width:.75*this.radius/this.value.length,this.width=this.width-n.marginInner-n.marginInner,"string"==typeof n.width&&(this.width+=Number(n.width)),this.colorsParsed||(this.parseColors(),this.colorsParsed=!0),this.drawBackground(),this.drawMeter(),this.drawLabels(),this.drawIcons(),this.drawEnds(),n.contextmenu&&RGraph.showContext(this),RGraph.addCustomText(this),RGraph.installEventListeners(this),this.firstDraw&&(this.firstDraw=!1,RGraph.fireCustomEvent(this,"onfirstdraw"),this.firstDrawFunc()),RGraph.fireCustomEvent(this,"ondraw"),this},this.exec=function(t){return t(this),this},this.drawBackground=function(){if(n.backgroundColor&&this.path("fs % fr -5 -5 % %",n.backgroundColor,this.canvas.width+10,this.canvas.height+10),n.backgroundGrid&&n.backgroundGridCircles){var t;t="number"==typeof n.backgroundGridCirclesCount?n.backgroundGridCirclesCount:this.value.length+1;for(var s=0;s<t;s++){var i=this.radius-s*(this.width+2*n.marginInner);this.path("b a % % % 0 6.29 false s %",this.centerx,this.centery,i,n.backgroundGridColor)}if(n.backgroundGridRadials)for(var e=RGraph.TWOPI/n.backgroundGridRadialsCount,s=0;s<=n.backgroundGridRadialsCount;++s)this.path("b    a % % % % % %     a % % % % % %    s %",this.centerx,this.centery,i,s*e-RGraph.HALFPI,s*e-RGraph.HALFPI,!1,this.centerx,this.centery,this.radius,s*e-RGraph.HALFPI,s*e-RGraph.HALFPI,!1,n.backgroundGridColor)}},this.drawMeter=function(){var t,s=this.radius-n.marginInner;if(n.backgroundRings){this.context.globalAlpha=n.backgroundRingsAlpha;for(var i=0;i<this.value.length;++i)t=(RGraph.isArray(n.backgroundRingsColors)&&"string"==typeof n.backgroundRingsColors[i]?n.backgroundRingsColors:n.colors)[i],this.path("b       a % % % % % false          a % % % % % true       f %",this.centerx,this.centery,s-i*(n.marginInner+n.marginInner+this.width),0-RGraph.HALFPI,RGraph.TWOPI-RGraph.HALFPI,this.centerx,this.centery,s-this.width-i*(n.marginInner+n.marginInner+this.width),RGraph.TWOPI-RGraph.HALFPI,0-RGraph.HALFPI,t);this.context.globalAlpha=1}for(i=0;i<this.value.length;++i){var e=(this.value[i]-this.min)/(this.max-this.min)*RGraph.TWOPI;this.path("b       a % % % % % false          a % % % % % true       f %",this.centerx,this.centery,s-i*(n.marginInner+n.marginInner+this.width),0-RGraph.HALFPI,e-RGraph.HALFPI,this.centerx,this.centery,s-this.width-i*(n.marginInner+n.marginInner+this.width),e-RGraph.HALFPI,0-RGraph.HALFPI,n.colors[i]),this.angles[i]=this.coords[i]={x:this.centerx,y:this.centery,angleStart:0-RGraph.HALFPI,angleEnd:e-RGraph.HALFPI,radiusInner:s-this.width-i*(n.marginInner+n.marginInner+this.width),radiusOuter:s-i*(n.marginInner+n.marginInner+this.width),color:n.colors[i]}}RGraph.text({object:this,x:-1e4,y:-1e4,color:"transparent",text:""})},this.drawLabels=function(){n.labelsCenter&&(t=RGraph.getTextConf({object:this,prefix:"labelsCenter"}),RGraph.text({object:this,text:String(n.labelsCenterSpecific||RGraph.numberFormat({object:this,number:this.value[n.labelsCenterIndex].toFixed(n.labelsCenterDecimals),unitspre:n.labelsCenterUnitsPre,unitspost:n.labelsCenterUnitsPost,point:n.labelsCenterPoint,thousand:n.labelsCenterThousand})),x:this.centerx+n.labelsCenterOffsetx,y:this.centery+n.labelsCenterOffsety,halign:"center",valign:"center",color:t.color,size:t.size,font:t.font,bold:t.bold,italic:t.italic}));var t=RGraph.getTextConf({object:this,prefix:"labels"});"string"==typeof n.labels&&(n.labels=RGraph.arrayPad({array:[],length:this.coords.length,value:n.labels}));for(var s,i=0;i<n.labels.length;++i)"object"==typeof n.labels&&n.labels.length&&"string"==typeof n.labels[i]&&(s=RGraph.labelSubstitution({object:this,text:n.labels[i],index:i,value:this.value[i],decimals:n.labelsFormattedDecimals,point:n.labelsFormattedPoint,thousand:n.labelsFormattedThousand,unitsPre:n.labelsFormattedUnitsPre,unitsPost:n.labelsFormattedUnitsPost})),RGraph.text({object:this,text:RGraph.isString(n.labels[i])||RGraph.isNumber(n.labels[i])?s:"",x:this.coords[i].x-5+n.labelsOffsetx,y:this.coords[i].y-this.coords[i].radiusOuter+(this.coords[i].radiusOuter-this.coords[i].radiusInner)/2+n.labelsOffsety,valign:"center",halign:"right",bounding:!0,boundingFill:n.labelsBackgroundFill,boundingStroke:n.labelsBackgroundStroke,textConfPrefix:"labels"})},this.drawIcons=function(){for(var r,t=0;t<this.value.length;++t)"string"==typeof n.icons[t]&&n.icons[t].length&&(this.images[t]=new Image,this.images[t].src=n.icons[t],this.images[t].index=t,(r=this).images[t].onload=function(){var t=this.width,s=t;t>=r.width&&(t-=10,s-=10),"number"==typeof n.iconsWidth&&(t=n.iconsWidth),"number"==typeof n.iconsHeight&&(s=n.iconsHeight);var i=r.centerx-t/3+("straight"===n.ends||"square"===n.ends?15:0),e=r.centery-r.coords[this.index].radiusOuter+(r.coords[this.index].radiusOuter-r.coords[this.index].radiusInner)/2-s/2;i+=n.iconsOffsetx,e+=n.iconsOffsety,r.context.drawImage(this,i,e,t,s)})},this.drawEnds=function(){if("straight"!==n.ends&&"square"!==n.ends)for(var t=0;t<this.coords.length;++t){var s=this.coords[t].x,i=this.coords[t].y-(this.coords[t].radiusOuter-this.coords[t].radiusInner)/2-this.coords[t].radiusInner;this.path("b a % % % % % false f %",s,i,this.width/2,0,6.29,n.colors[t]);i=RGraph.getRadiusEndPoint({cx:this.centerx,cy:this.centery,angle:this.coords[t].angleEnd,radius:(this.coords[t].radiusOuter-this.coords[t].radiusInner)/2+this.coords[t].radiusInner});this.path("b a % % % % % false f %",i[0],i[1],(this.coords[t].radiusOuter-this.coords[t].radiusInner)/2,0,6.29,n.colors[t])}},this.getShape=function(t){for(var s,i,t=RGraph.getMouseXY(t),e=t[0],r=t[1],a=0;a<this.coords.length;++a)if(this.path("b    a % % % % % false    a % % % % % true",this.coords[a].x,this.coords[a].y,this.coords[a].radiusOuter,this.coords[a].angleStart,this.coords[a].angleEnd,this.coords[a].x,this.coords[a].y,this.coords[a].radiusInner,this.coords[a].angleEnd,this.coords[a].angleStart),n.ends&&(this.path("a % % % % % false",this.coords[a].x,this.coords[a].y-this.coords[a].radiusInner-this.width/2,this.width/2,RGraph.HALFPI,RGraph.PI+RGraph.HALFPI),s=RGraph.getRadiusEndPoint({cx:this.centerx,cy:this.centery,angle:this.coords[a].angleEnd,radius:(this.coords[a].radiusOuter-this.coords[a].radiusInner)/2+this.coords[a].radiusInner}),this.path("m % %    a % % % % % false",s[0],s[1],s[0],s[1],(this.coords[a].radiusOuter-this.coords[a].radiusInner)/2,0,6.29)),this.context.isPointInPath(e,r))return RGraph.parseTooltipText&&(i=RGraph.parseTooltipText(n.tooltips,a)),{object:this,x:this.coords[a].x,y:this.coords[a].y,radiusInner:this.coords[a].radiusInner,radiusOuter:this.coords[a].radiusOuter,angleStart:this.coords[a].angleStart,angleEnd:this.coords[a].angleEnd,tooltip:"string"==typeof i?i:null,label:n.labels&&"string"==typeof n.labels[a]?n.labels[a]:null,dataset:0,index:a,sequentialIndex:a}},this.getValue=function(t){t=RGraph.getMouseXY(t),t=RGraph.getAngleByXY(this.centerx,this.centery,t[0],t[1]);(t+=RGraph.HALFPI)>RGraph.TWOPI&&(t-=RGraph.TWOPI);t=t/RGraph.TWOPI*(this.max-this.min)+this.min,t=Math.max(t,this.min);return t=Math.min(t,this.max)},this.getObjectByXY=function(t){t=RGraph.getMouseXY(t),this.width,t=RGraph.getHypLength(this.centerx,this.centery,t[0],t[1]);return t>this.radius||t<.25*this.radius?null:this},this.adjusting_mousemove=function(t){var s;n.adjustable&&RGraph.Registry.get("adjusting")&&RGraph.Registry.get("adjusting").uid==this.uid&&(s=RGraph.getMouseXY(t),s=RGraph.getHypLength(this.centerx,this.centery,s[0],s[1]),s=this.getIndexByRadius(s),"number"!=typeof RGraph.Registry.get("adjusting.index")?(RGraph.Registry.set("adjusting.index",s),RGraph.addCustomEventListener(this,"onadjustend",function(){RGraph.Registry.set("adjusting.index",null)})):s=RGraph.Registry.get("adjusting.index"),"number"==typeof s&&(this.value[s]=this.getValue(t),RGraph.clear(this.canvas),RGraph.redrawCanvas(this.canvas),RGraph.fireCustomEvent(this,"onadjust")))},this.getIndexByRadius=function(t){for(var s=0;s<this.coords.length;++s)if(t<this.coords[s].radiusOuter&&t>this.coords[s].radiusInner)return s;return null},this.getAngle=function(t){if(t>this.max||t<this.min)return null;var s=(t-this.min)/(this.max-this.min)*RGraph.TWOPI-RGraph.HALFPI;return t===this.max&&(s-=1e-5),t===this.min&&(s+=1e-5),s},this.highlight=function(t){if("function"==typeof n.highlightStyle)n.tooltipsHighlight&&n.highlightStyle(t);else if("string"==typeof n.highlightStyle&&"invert"===n.highlightStyle){if(n.tooltipsHighlight){this.context.beginPath();for(var s=0;s<this.coords.length;++s)t.index!==s&&this.pathBar(s);this.context.fillStyle=n.highlightFill,this.context.strokeStyle=n.highlightStroke,this.context.stroke(),this.context.fill()}}else n.tooltipsHighlight&&(this.context.beginPath(),this.pathBar(t.index),this.context.fillStyle=n.highlightFill,this.context.strokeStyle=n.highlightStroke,this.context.stroke(),this.context.fill())},this.pathBar=function(t){this.path("a % % % % % false",this.coords[t].x,this.coords[t].y,this.coords[t].radiusOuter,0-RGraph.HALFPI,this.coords[t].angleEnd);var s=RGraph.getRadiusEndPoint({cx:this.centerx,cy:this.centery,angle:this.coords[t].angleEnd,radius:this.coords[t].radiusInner+(this.coords[t].radiusOuter-this.coords[t].radiusInner)/2});"round"===n.ends&&this.path("a % % % % % false",s[0],s[1],this.width/2,this.coords[t].angleEnd,this.coords[t].angleEnd+RGraph.PI),this.path("a % % % % % true",this.coords[t].x,this.coords[t].y,this.coords[t].radiusInner,this.coords[t].angleEnd,this.coords[t].angleStart),"round"===n.ends&&this.path("a % % % % % false",this.centerx,this.centery-this.coords[t].radiusInner-(this.coords[t].radiusOuter-this.coords[t].radiusInner)/2,this.width/2,RGraph.HALFPI,RGraph.PI+RGraph.HALFPI)},this.tooltipSubstitutions=function(t){return{index:t.index,dataset:0,sequentialIndex:t.index,value:this.value[t.index],values:this.value}},this.tooltipsFormattedCustom=function(t,s){return{label:n.tooltipsFormattedKeyLabels[s]}},this.positionTooltipStatic=function(t){var s=t.object,i=(t.event,t.tooltip),e=(t.index,RGraph.getCanvasXY(s.canvas));coords=this.coords[t.index];var r=RGraph.getRadiusEndPoint({cx:this.centerx,cy:this.centery,radius:(coords.radiusOuter-coords.radiusInner)/2+coords.radiusInner,angle:(coords.angleEnd-coords.angleStart)/2+(0-RGraph.HALFPI)});t.tooltip.style.left=e[0]+r[0]-i.offsetWidth/2+s.properties.tooltipsOffsetx+"px",t.tooltip.style.top=e[1]+r[1]-i.offsetHeight-10+s.properties.tooltipsOffsety+"px",parseFloat(t.tooltip.style.top)<0&&(t.tooltip.style.top="5px")},this.parseColors=function(){0===this.original_colors.length&&(this.original_colors.backgroundColor=RGraph.arrayClone(n.backgroundColor),this.original_colors.colors=RGraph.arrayClone(n.colors)),n.backgroundColor=this.parseSingleColorForGradient(n.backgroundColor);var t=n.colors;if(t&&t.length)for(var s=0;s<t.length;++s)t[s]=this.parseSingleColorForGradient(t[s])},this.reset=function(){},this.parseSingleColorForGradient=function(t){if(!t||"string"!=typeof t)return t;if(t.match(/^gradient\((.*)\)$/i)){if(t.match(/^gradient\(({.*})\)$/i))return RGraph.parseJSONGradient({object:this,def:RegExp.$1,radial:!0});var s=RegExp.$1.split(":"),i=this.context.createLinearGradient(n.marginLeft,0,this.canvas.width-n.marginLeft-n.marginRight,0),e=1/(s.length-1);i.addColorStop(0,RGraph.trim(s[0]));for(var r=1,a=s.length;r<a;++r)i.addColorStop(r*e,RGraph.trim(s[r]))}return i||t},this.on=function(t,s){return"function"!=typeof this[t="on"!==t.substr(0,2)?"on"+t:t]?this[t]=s:RGraph.addCustomEventListener(this,t,s),this},this.firstDrawFunc=function(){},this.grow=function(){var i=this;if("number"==typeof this.value&&(this.value=[this.value]),RGraph.isNull(this.currentValue)){this.currentValue=[];for(var t=0;t<this.value.length;++t)this.currentValue[t]=this.min}for(var e=(arguments[0]||{}).frames||30,r=0,s=[],a=[],n=arguments[1]||function(){},o=[],t=0;t<this.value.length;++t)s[t]=this.value[t]-this.currentValue[t],a[t]=s[t]/e,o[t]=this.currentValue[t];return function t(){for(var s=0;s<i.value.length;++s)i.value[s]=o[s]+r*a[s];r++,RGraph.clear(i.canvas),RGraph.redrawCanvas(i.canvas),r<=e?RGraph.Effects.updateCanvas(t):n(i)}(),this},RGraph.register(this),RGraph.parseObjectStyleConfig(this,t.options)):alert("[SDONUT] No canvas support")};
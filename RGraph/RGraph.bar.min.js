RGraph=window.RGraph||{isrgraph:!0,isRGraph:!0,rgraph:!0},RGraph.Bar=function(t){var e=t.id,a=document.getElementById(e),u=t.data;if(this.id=e,this.canvas=a,this.context=this.canvas.getContext("2d"),(this.canvas.__object__=this).type="bar",this.max=0,this.stackedOrGrouped=!1,this.isRGraph=!0,this.isrgraph=!0,this.rgraph=!0,this.uid=RGraph.createUID(),this.canvas.uid=this.canvas.uid||RGraph.createUID(),this.colorsParsed=!1,this.original_colors=[],this.cachedBackgroundCanvas=null,this.firstDraw=!0,this.properties={backgroundBarsCount:null,backgroundBarsColor1:"rgba(0,0,0,0)",backgroundBarsColor2:"rgba(0,0,0,0)",backgroundGrid:!0,backgroundGridColor:"#ddd",backgroundGridLinewidth:1,backgroundGridHsize:20,backgroundGridVsize:20,backgroundGridVlines:!0,backgroundGridHlines:!0,backgroundGridBorder:!0,backgroundGridAutofit:!0,backgroundGridAutofitAlign:!0,backgroundGridHlinesCount:5,backgroundGridDashed:!1,backgroundGridDotted:!1,backgroundImage:null,backgroundImageStretch:!0,backgroundImageX:null,backgroundImageY:null,backgroundImageW:null,backgroundImageH:null,backgroundImageAlign:null,backgroundColor:null,backgroundHbars:null,marginTop:35,marginBottom:35,marginLeft:35,marginRight:35,marginInner:5,marginInnerGrouped:1,labelsIngraph:null,labelsIngraphFont:null,labelsIngraphSize:null,labelsIngraphColor:null,labelsIngraphBold:null,labelsIngraphItalic:null,labelsIngraphOffsetx:0,labelsIngraphOffsety:0,labelsAbove:!1,labelsAboveDecimals:0,labelsAboveSize:null,labelsAboveColor:null,labelsAboveBold:null,labelsAboveItalic:null,labelsAboveFont:null,labelsAbovePoint:".",labelsAboveThousand:",",labelsAboveBackground:"rgba(0,0,0,0)",labelsAboveAngle:null,labelsAboveOffset:null,labelsAboveOffsetx:0,labelsAboveOffsety:0,labelsAboveUnitsPre:"",labelsAboveUnitsPost:"",labelsAboveFormatter:null,yaxis:!0,yaxisLinewidth:1,yaxisColor:"black",yaxisTickmarks:!0,yaxisTickmarksCount:null,yaxisTickmarksLastTop:null,yaxisTickmarksLastBottom:null,yaxisTickmarksLength:3,yaxisScale:!0,yaxisScaleMin:0,yaxisScaleMax:null,yaxisScaleUnitsPre:"",yaxisScaleUnitsPost:"",yaxisScaleDecimals:0,yaxisScalePoint:".",yaxisScaleThousand:",",yaxisScaleRound:!1,yaxisScaleFormatter:null,yaxisLabelsSpecific:null,yaxisLabelsCount:5,yaxisLabelsOffsetx:0,yaxisLabelsOffsety:0,yaxisLabelsHalign:null,yaxisLabelsValign:null,yaxisLabelsFont:null,yaxisLabelsSize:null,yaxisLabelsColor:null,yaxisLabelsBold:null,yaxisLabelsItalic:null,yaxisLabelsPosition:"edge",yaxisPosition:"left",yaxisTitle:"",yaxisTitleAccessible:null,yaxisTitleBold:null,yaxisTitleSize:null,yaxisTitleFont:null,yaxisTitleColor:null,yaxisTitleItalic:null,yaxisTitlePos:null,yaxisTitleX:null,yaxisTitleY:null,yaxisTitleOffsetx:0,yaxisTitleOffsety:0,yaxisTitleHalign:null,yaxisTitleValign:null,xaxis:!0,xaxisLinewidth:1,xaxisColor:"black",xaxisTickmarks:!0,xaxisTickmarksLength:3,xaxisTickmarksLastLeft:null,xaxisTickmarksLastRight:null,xaxisTickmarksCount:null,xaxisLabels:null,xaxisLabelsSize:null,xaxisLabelsFont:null,xaxisLabelsItalic:null,xaxisLabelsBold:null,xaxisLabelsColor:null,xaxisLabelsFormattedDecimals:0,xaxisLabelsFormattedPoint:".",xaxisLabelsFormattedThousand:",",xaxisLabelsFormattedUnitsPre:"",xaxisLabelsFormattedUnitsPost:"",xaxisLabelsOffsetx:0,xaxisLabelsOffsety:0,xaxisLabelsHalign:null,xaxisLabelsValign:null,xaxisLabelsPosition:"section",xaxisLabelsSpecificAlign:"left",xaxisPosition:"bottom",xaxisLabelsAngle:0,xaxisTitle:"",xaxisTitleBold:null,xaxisTitleSize:null,xaxisTitleFont:null,xaxisTitleColor:null,xaxisTitleItalic:null,xaxisTitlePos:null,xaxisTitleOffsetx:0,xaxisTitleOffsety:0,xaxisTitleX:null,xaxisTitleY:null,xaxisTitleHalign:null,xaxisTitleValign:null,textItalic:!1,textBold:!1,textColor:"black",textSize:12,textFont:"Arial, Verdana, sans-serif",textAccessible:!0,textAccessibleOverflow:"visible",textAccessiblePointerevents:!1,text:null,title:"",titleX:null,titleY:null,titleHalign:null,titleValign:null,titleBackground:null,titleHpos:null,titleVpos:null,titleFont:null,titleSize:null,titleColor:null,titleBold:null,titleItalic:null,titleOffsetx:0,titleOffsety:0,colorsStroke:"rgba(0,0,0,0)",colors:["red","#0f0","blue","pink","orange","cyan","black","white","green","magenta"],colorsSequential:!1,colorsReverse:!1,grouping:"grouped",variant:"bar",variantSketchVerticals:!0,variantThreedXaxis:!0,variantThreedYaxis:!0,variantThreedAngle:.1,variantThreedOffsetx:10,variantThreedOffsety:5,shadow:!1,shadowColor:"#aaa",shadowOffsetx:0,shadowOffsety:0,shadowBlur:15,tooltips:null,tooltipsEffect:"slide",tooltipsCssClass:"RGraph_tooltip",tooltipsCss:null,tooltipsEvent:"onclick",tooltipsHighlight:!0,tooltipsHotspotXonly:!1,tooltipsFormattedThousand:",",tooltipsFormattedPoint:".",tooltipsFormattedDecimals:0,tooltipsFormattedUnitsPre:"",tooltipsFormattedUnitsPost:"",tooltipsFormattedKeyColors:null,tooltipsFormattedKeyColorsShape:"square",tooltipsFormattedKeyLabels:[],tooltipsFormattedListType:"ul",tooltipsFormattedListItems:null,tooltipsFormattedTableHeaders:null,tooltipsFormattedTableData:null,tooltipsPointer:!0,tooltipsPositionStatic:!0,highlightStroke:"rgba(0,0,0,0)",highlightFill:"rgba(255,255,255,0.7)",key:null,keyBackground:"white",keyPosition:"graph",keyShadow:!1,keyShadowColor:"#666",keyShadowBlur:3,keyShadowOffsetx:2,keyShadowOffsety:2,keyPositionMarginBoxed:!1,keyPositionX:null,keyPositionY:null,keyInteractive:!1,keyInteractiveHighlightChartStroke:"black",keyInteractiveHighlightChartFill:"rgba(255,255,255,0.7)",keyInteractiveHighlightLabel:"rgba(255,0,0,0.2)",keyHalign:"right",keyColorShape:"square",keyRounded:!0,keyLinewidth:1,keyColors:null,keyLabelsColor:null,keyLabelsSize:null,keyLabelsFont:null,keyLabelsBold:null,keyLabelsItalic:null,keyLabelsOffsetx:0,keyLabelsOffsety:0,contextmenu:null,crosshairs:!1,crosshairsColor:"#333",crosshairsHline:!0,crosshairsVline:!0,linewidth:1,annotatable:!1,annotatableLinewidth:1,annotatableColor:"black",adjustable:!1,adjustableOnly:null,beveled:!1,errorbars:!1,errorbarsColor:"black",errorbarsCapped:!0,errorbarsCappedWidth:14,errorbarsLinewidth:1,combinedEffect:null,combinedEffectOptions:null,combinedEffectCallback:null,corners:"square",cornersRoundRadius:10,clearto:"rgba(0,0,0,0)"},this.canvas){for(var u=RGraph.stringsToNumbers(u),i=0;i<u.length;++i)"object"!=typeof u[i]||RGraph.isNull(u[i])||(this.stackedOrGrouped=!0);for(var s=RGraph.arrayLinearize(u),i=0;i<s.length;++i)this["$"+i]={};this.data=u,this.original_data=RGraph.arrayClone(u),this.coords=[],this.coords2=[],this.coordsText=[],this.data_arr=RGraph.arrayLinearize(this.data);var A=this.properties;this.path=RGraph.pathObjectFunction,RGraph.Effects&&"function"==typeof RGraph.Effects.decorate&&RGraph.Effects.decorate(this),this.responsive=RGraph.responsive,this.set=function(t){var e=void 0===arguments[1]?null:arguments[1];if("bevelled"===t&&(t="beveled"),1!==arguments.length||"object"!=typeof arguments[0])return A[t]=e,this;for(i in arguments[0])"string"==typeof i&&this.set(i,arguments[0][i]);return this},this.get=function(t){return A[t]},this.draw=function(){if(RGraph.fireCustomEvent(this,"onbeforedraw"),this.canvas.__rgraph_aa_translated__||(this.context.translate(.5,.5),this.canvas.__rgraph_aa_translated__=!0),"string"==typeof A.backgroundImage&&RGraph.drawBackgroundImage(this),"top"===A.xaxisPosition)for(var t=0;t<this.data.length;++t)if("object"==typeof this.data[t]&&"grouped"===A.grouping)for(var e=0;e<this.data[t].length;++e)this.data[t][e]=-1*Math.abs(this.data[t][e]);else"number"==typeof this.data[t]&&(this.data[t]=-1*Math.abs(this.data[t]));return"3d"===A.variant&&(A.textAccessible||this.context.setTransform(1,A.variantThreedAngle,0,1,.5,.5)),this.colorsParsed||(this.parseColors(),this.colorsParsed=!0),this.marginLeft=A.marginLeft,this.marginRight=A.marginRight,this.marginTop=A.marginTop,this.marginBottom=A.marginBottom,("pyramid"==A.variant||"dot"==A.variant)&&"object"==typeof A.tooltips&&A.tooltips&&0<A.tooltips.length&&alert("[BAR] ("+this.id+") Sorry, tooltips are not supported with dot or pyramid charts"),this.coords=[],this.coords2=[],this.coordsText=[],this.max=0,this.grapharea=this.canvas.height-this.marginTop-this.marginBottom,this.halfgrapharea=this.grapharea/2,this.halfTextHeight=A.textSize/2,RGraph.Background.draw(this),this.drawbars(),this.drawAxes(),this.drawLabels(),(A.beveled||A.beveled)&&this.drawBevel(),A.key&&A.key.length&&RGraph.drawKey(this,A.key,A.colors),A.contextmenu&&RGraph.showContext(this),A.errorbars&&this.drawErrorbars(),A.labelsIngraph&&RGraph.drawInGraphLabels(this),RGraph.addCustomText(this),RGraph.installEventListeners(this),this.firstDraw&&(this.firstDraw=!1,RGraph.fireCustomEvent(this,"onfirstdraw"),this.firstDrawFunc()),RGraph.fireCustomEvent(this,"ondraw"),this},this.exec=function(t){return t(this),this},this.drawAxes=function(){if(-1==RGraph.ISSAFARI&&(this.context.lineCap="square"),A.xaxisLabels&&A.xaxisLabels.length){"string"==typeof A.xaxisLabels&&(A.xaxisLabels=RGraph.arrayPad({array:[],length:this.data.length,value:A.xaxisLabels}));for(var t=0;t<A.xaxisLabels.length;++t)A.xaxisLabels[t]=RGraph.labelSubstitution({object:this,text:A.xaxisLabels[t],index:t,value:this.data[t],decimals:A.xaxisLabelsFormattedDecimals||0,unitsPre:A.xaxisLabelsFormattedUnitsPre||"",unitsPost:A.xaxisLabelsFormattedUnitsPost||"",thousand:A.xaxisLabelsFormattedThousand||",",point:A.xaxisLabelsFormattedPoint||"."})}RGraph.drawXAxis(this),RGraph.drawYAxis(this)},this.drawbars=function(){this.context.lineWidth=A.linewidth,this.context.strokeStyle=A.colorsStroke,this.context.fillStyle=A.colors[0];A.yaxisScaleDecimals;if(A.yaxisScaleMax)this.scale2=RGraph.getScale({object:this,options:{"scale.max":A.yaxisScaleMax,"scale.strict":!A.yaxisScaleRound,"scale.min":A.yaxisScaleMin,"scale.thousand":A.yaxisScaleThousand,"scale.point":A.yaxisScalePoint,"scale.decimals":A.yaxisScaleDecimals,"scale.labels.count":A.yaxisLabelsCount,"scale.round":A.yaxisScaleRound,"scale.units.pre":A.yaxisScaleUnitsPre,"scale.units.post":A.yaxisScaleUnitsPost,"scale.formatter":A.yaxisScaleFormatter}});else{var t=A.errorbars;if("number"==typeof t){var e=t;A.errorbars=[];for(var a=0;a<this.data.length;++a)if("number"==typeof this.data[a])A.errorbars.push([e,null]);else if("object"==typeof this.data[a]&&!RGraph.isNull(this.data[a]))for(var i=0;i<this.data[a].length;++i)A.errorbars.push([e,null]);A.errorbars}for(a=0;a<this.data.length;++a)e="object"==typeof this.data[a]?"grouped"===A.grouping?Number(RGraph.arrayMax(this.data[a],!0)):Number(RGraph.arraySum(this.data[a])):Number(this.data[a]),this.max=Math.max(Math.abs(this.max),Math.abs(e)+Number("object"!=typeof A.errorbars||"object"!=typeof A.errorbars[a]||RGraph.isNull(A.errorbars[a])||"number"!=typeof A.errorbars[a][0]?0:A.errorbars[a][0]));this.scale2=RGraph.getScale({object:this,options:{"scale.max":this.max,"scale.min":A.yaxisScaleMin,"scale.thousand":A.yaxisScaleThousand,"scale.point":A.yaxisScalePoint,"scale.decimals":A.yaxisScaleDecimals,"scale.labels.count":A.yaxisLabelsCount,"scale.round":A.yaxisScaleRound,"scale.units.pre":A.yaxisScaleUnitsPre,"scale.units.post":A.yaxisScaleUnitsPost,"scale.formatter":A.yaxisScaleFormatter}}),this.max=this.scale2.max}A.adjustable&&!A.yaxisScaleMax&&this.set("yaxisScaleMax",this.scale2.max),A.backgroundHbars&&0<A.backgroundHbars.length&&RGraph.drawBars(this);var s=A.variant;"3d"===s&&RGraph.draw3DAxes(this);var o=A.xaxisPosition,r=(this.canvas.width-this.marginLeft-this.marginRight)/this.data.length,n=A.marginInner,h=A.shadow,l=A.shadowColor,c=A.shadowBlur,d=A.shadowOffsetx,x=A.shadowOffsety,g=A.colorsStroke,f=A.colors,u=0,a=0;for(len=this.data.length;a<len;a+=1){C=RGraph.arraySum(this.data[a])<0?(RGraph.arraySum(this.data[a])+this.scale2.min)/(this.scale2.max-this.scale2.min):(RGraph.arraySum(this.data[a])-this.scale2.min)/(this.scale2.max-this.scale2.min),C*=Math.abs(this.getYCoord(this.scale2.max)-this.getYCoord(this.scale2.min));var b,p=a*r+this.marginLeft,m="center"==o?(this.canvas.height-this.marginTop-this.marginBottom)/2+this.marginTop-C:this.canvas.height-C-this.marginBottom;if("top"==o&&(m=this.marginTop),C<0&&(m+=C,C=Math.abs(C)),h&&(this.context.shadowColor=l,this.context.shadowBlur=c,this.context.shadowOffsetX=d,this.context.shadowOffsetY=x),this.context.beginPath(),"number"==typeof this.data[a]){if("bottom"===o&&A.yaxisScaleMin<0&&(C=(0<=this.data[a]||(m=this.getYCoord(0)),Math.abs(this.getYCoord(0)-this.getYCoord(this.data[a])))),(v=r-2*n)<0&&alert("[RGRAPH] Warning: you have a negative bar width. This may be caused by the marginInner being too high or the width of the canvas not being sufficient."),this.context.strokeStyle=g,this.context.fillStyle=f[0],A.colorsSequential&&(this.context.fillStyle=f[a]),"sketch"==s){this.context.lineCap="round";if(this.context.beginPath(),this.context.strokeStyle=f[0],A.colorsSequential&&(this.context.strokeStyle=f[a]),this.context.moveTo(p+n+2,m+C-2),this.context.lineTo(p+n-1,m-4),this.context.moveTo(p+n-3,m+-2+(this.data[a]<0?C:0)),this.context.quadraticCurveTo(p+n+(r-n-n)/4,m+0+(this.data[a]<0?C:0)+(0<this.data[a]?10:-10),p+n+r+-1-n-n,m+0+(this.data[a]<0?C:0)),this.context.moveTo(p+n+r-5-n-n,m-5),this.context.lineTo(p+n+r-3-n-n,m+C-3),A.variantSketchVerticals)for(var y=.2;y<=.8;y+=.2)this.context.moveTo(p+n+(r-n-n)*y,m-1),this.context.lineTo(p+n+(r-n-n)*y,m+C+(.2==y?1:-2));this.context.stroke()}else"bar"==s||"3d"==s||"glass"==s||"bevel"==s?("glass"==s?RGraph.roundedRect({context:this.context,x:p+n,y:m,width:v,height:C,radius:5,roundtl:0<this.data[a],roundtr:0<this.data[a],roundbl:this.data[a]<0,roundbr:this.data[a]<0}):"round"===A.corners?(this.context.beginPath(),this.context.lineCap="miter",this.context.lineJoin="square",this.data[a]<0?this.roundedCornersRectNegative(p+n,m,v,C):this.roundedCornersRect(p+n,m,v,C)):(this.context.beginPath(),this.context.lineJoin="miter",this.context.lineCap="square",this.context.rect(p+n,m,v,C)),this.context.stroke(),this.context.fill(),"3d"==s?(w=this.context.strokeStyle,G=this.context.fillStyle,0<=this.data[a]&&(this.context.beginPath(),this.context.moveTo(p+n,m),this.context.lineTo(p+n+A.variantThreedOffsetx,m-A.variantThreedOffsety),this.context.lineTo(p+n+A.variantThreedOffsetx+v,m-A.variantThreedOffsety),this.context.lineTo(p+n+v,m),this.context.closePath(),this.context.stroke(),this.context.fill()),this.context.beginPath(),this.context.moveTo(p+n+v,m),this.context.lineTo(p+n+v+A.variantThreedOffsetx,this.data[a]<0&&"bottom"===o?this.getYCoord(0):this.data[a]<0&&m-A.variantThreedOffsety<this.marginTop+this.halfgrapharea?this.marginTop+this.halfgrapharea:m-A.variantThreedOffsety),this.context.lineTo(p+n+v+A.variantThreedOffsetx,this.data[a]<0&&m-A.variantThreedOffsety+C<this.marginTop+this.getYCoord(0)?this.getYCoord(this.data[a])-A.variantThreedOffsety:0<this.data[a]?m-A.variantThreedOffsety+C:Math.min(m-A.variantThreedOffsety+C,this.canvas.height-this.marginBottom)),this.context.lineTo(p+n+v,m+C),this.context.closePath(),this.context.stroke(),this.context.fill(),0<this.data[a]&&(this.context.beginPath(),this.context.fillStyle="rgba(255,255,255,0.5)",this.context.moveTo(p+n,m),this.context.lineTo(p+n+A.variantThreedOffsetx,m-A.variantThreedOffsety),this.context.lineTo(p+n+A.variantThreedOffsetx+v,m-A.variantThreedOffsety),this.context.lineTo(p+n+v,m),this.context.lineTo(p+n,m),this.context.closePath(),this.context.stroke(),this.context.fill()),this.context.beginPath(),this.context.fillStyle="rgba(0,0,0,0.4)",this.context.moveTo(p+n+v,m),this.context.lineTo(p+n+v+A.variantThreedOffsetx,this.data[a]<0&&"bottom"===o?this.getYCoord(0):this.data[a]<0&&m-A.variantThreedOffsety<this.marginTop+this.halfgrapharea?this.marginTop+this.halfgrapharea:m-A.variantThreedOffsety),this.context.lineTo(p+n+v+A.variantThreedOffsetx,this.data[a]<0&&m-A.variantThreedOffsety+C<this.getYCoord(0)?this.getYCoord(0):0<this.data[a]?m-A.variantThreedOffsety+C:Math.min(m-A.variantThreedOffsety+C,this.canvas.height-this.marginBottom)),this.context.lineTo(p+n+v,m+C),this.context.lineTo(p+n+v,m),this.context.closePath(),this.context.stroke(),this.context.fill(),this.context.strokeStyle=w,this.context.fillStyle=G):"glass"==s&&((b=this.context.createLinearGradient(p+n,m,p+n+v/2,m)).addColorStop(0,"rgba(255,255,255,0.9)"),b.addColorStop(1,"rgba(255,255,255,0.5)"),this.context.beginPath(),this.context.fillStyle=b,this.context.rect(p+n+3,m+(0<this.data[a]?3:0),v/2-2,C-2),this.context.fill())):"dot"==s?(this.context.beginPath(),this.context.strokeStyle=this.properties.colors[0],this.context.moveTo(p+r/2,m),this.context.lineTo(p+r/2,m+C),this.context.stroke(),this.context.beginPath(),this.context.fillStyle=this.properties.colors[a],this.context.arc(p+r/2,m+(0<this.data[a]?0:C),2,0,6.28,0),this.context.fillStyle=A.colors[0],A.colorsSequential&&(this.context.fillStyle=f[a]),this.context.stroke(),this.context.fill()):alert("[BAR] Warning! Unknown variant: "+s);this.coords.push([p+n,m,r-2*n,C]),void 0===this.coords2[a]&&(this.coords2[a]=[]),this.coords2[a].push([p+n,m,r-2*n,C])}else if(this.data[a]&&"object"==typeof this.data[a]&&"stacked"==A.grouping){this.scale2.min&&alert("[ERROR] Stacked Bar charts with a Y min are not supported");var v=r-2*n,T=[],R=0,S=this.data[a];for(v<0&&alert("[RGRAPH] Warning: you have a negative bar width. This may be caused by the marginInner being too high or the width of the canvas not being sufficient."),i=0;i<S.length;++i){if("center"==o)return void alert("[BAR] It's pointless having the X axis position at the center on a stacked bar chart.");if(this.data[a][i]<0)return void alert("[BAR] Negative values are not permitted with a stacked bar chart. Try a grouped one instead.");this.context.strokeStyle=g,this.context.fillStyle=f[i],A.colorsReverse&&(this.context.fillStyle=f[this.data[a].length-i-1]),A.colorsSequential&&f[u]?this.context.fillStyle=f[u++]:A.colorsSequential&&(this.context.fillStyle=f[u-1]);var C=S[i]/this.scale2.max*(this.canvas.height-this.marginTop-this.marginBottom);"center"==o&&(C/=2);RGraph.arraySum(S),this.scale2.max,this.canvas.height,this.marginTop,this.marginBottom;this.coords.push([p+n,m,r-2*n,C]),void 0===this.coords2[a]&&(this.coords2[a]=[]),this.coords2[a].push([p+n,m,r-2*n,C]),0<C&&(0===i&&"round"===A.corners&&"bottom"===A.xaxisPosition?(this.context.beginPath(),this.context.lineCap="miter",this.context.lineJoin="square",this.roundedCornersRect(p+n,m,r-2*n,C),this.context.stroke(),this.context.fill()):i===S.length-1&&"round"===A.corners&&"top"===A.xaxisPosition?(this.context.beginPath(),this.context.lineCap="miter",this.context.lineJoin="square",this.roundedCornersRectNegative(p+n,m,r-2*n,C),this.context.stroke(),this.context.fill()):this.path("b lj % lc % r % % % % s % f %","miter","square",p+n,m,r-2*n,C,this.context.strokeStyle,this.context.fillStyle)),0==i&&(R=m,F=p),h&&T.push([p+n,m,r-2*n,C,this.context.fillStyle]),"3d"==s&&(G=this.context.fillStyle,w=this.context.strokeStyle,0==i&&(this.context.beginPath(),this.context.moveTo(F+n,m),this.context.lineTo(F+A.variantThreedOffsetx+n,m-A.variantThreedOffsety),this.context.lineTo(F+A.variantThreedOffsetx+v+n,m-A.variantThreedOffsety),this.context.lineTo(F+v+n,m),this.context.closePath(),this.context.fill(),this.context.stroke()),this.context.beginPath(),this.context.moveTo(F+v+n,m),this.context.lineTo(F+v+n+A.variantThreedOffsetx,m-A.variantThreedOffsety),this.context.lineTo(F+v+n+A.variantThreedOffsetx,m-A.variantThreedOffsety+C),this.context.lineTo(F+v+n,m+C),this.context.closePath(),this.context.fill(),this.context.stroke(),0==i&&(this.context.fillStyle="rgba(255,255,255,0.5)",this.context.beginPath(),this.context.moveTo(F+n,m),this.context.lineTo(F+A.variantThreedOffsetx+n,m-A.variantThreedOffsety),this.context.lineTo(F+A.variantThreedOffsetx+v+n,m-A.variantThreedOffsety),this.context.lineTo(F+v+n,m),this.context.closePath(),this.context.fill(),this.context.stroke()),this.context.fillStyle="rgba(0,0,0,0.4)",this.context.beginPath(),this.context.moveTo(F+v+n,m),this.context.lineTo(F+v+n+A.variantThreedOffsetx,m-A.variantThreedOffsety),this.context.lineTo(F+v+n+A.variantThreedOffsetx,m-A.variantThreedOffsety+C),this.context.lineTo(F+v+n,m+C),this.context.closePath(),this.context.fill(),this.context.stroke(),this.context.strokeStyle=w,this.context.fillStyle=G),m+=C}if(h){for(RGraph.noShadow(this),k=0;k<T.length;++k)this.context.strokeStyle=g,this.context.fillStyle=T[k][4],this.context.strokeRect(T[k][0],T[k][1],T[k][2],T[k][3]),this.context.fillRect(T[k][0],T[k][1],T[k][2],T[k][3]),this.context.stroke(),this.context.fill();T=[]}}else if(this.data[a]&&"object"==typeof this.data[a]&&"grouped"==A.grouping){T=[];for(this.context.lineWidth=A.linewidth,i=0;i<this.data[a].length;++i){this.context.strokeStyle=g,this.context.fillStyle=f[i],A.colorsSequential&&f[u]?this.context.fillStyle=f[u++]:A.colorsSequential&&(this.context.fillStyle=f[u-1]);var G,w,O,L=(r-2*n)/this.data[a].length,C=(this.data[a][i]+(this.data[a][i]<0?this.scale2.min:-1*this.scale2.min))/(this.scale2.max-this.scale2.min)*(this.canvas.height-this.marginTop-this.marginBottom),P=A.marginInnerGrouped,F=p+n+i*L;L<0&&alert("[RGRAPH] Warning: you have a negative bar width. This may be caused by the marginInner being too high or the width of the canvas not being sufficient."),"center"==o&&(C/=2),"top"==o?(R=this.marginTop,C=Math.abs(C)):"center"==o?R=this.marginTop+this.grapharea/2-C:(R=this.getYCoord(0),C=Math.abs(Math.abs(this.getYCoord(this.data[a][i]))-this.getYCoord(0)),0<=this.data[a][i]&&(R-=C)),"round"===A.corners?(this.context.beginPath(),this.context.lineCap="miter",this.context.lineJoin="square",this.data[a][i]<0?this.roundedCornersRectNegative(F+P,R,L-2*P,C):this.roundedCornersRect(F+P,R,L-2*P,C)):(this.context.beginPath(),this.context.lineJoin="miter",this.context.lineCap="square",this.context.rect(F+P,R,L-2*P,C)),this.context.stroke(),this.context.fill(),m+=C,"3d"==s&&(G=this.context.fillStyle,w=this.context.strokeStyle,O=A.marginInnerGrouped,0<=this.data[a][i]&&(this.context.beginPath(),this.context.moveTo(F+O,R),this.context.lineTo(F+O+A.variantThreedOffsetx,R-A.variantThreedOffsety),this.context.lineTo(F+A.variantThreedOffsetx+L-O,R-A.variantThreedOffsety),this.context.lineTo(F+L-O,R),this.context.closePath(),this.context.fill(),this.context.stroke()),this.context.beginPath(),this.context.moveTo(F+L-O-1,R),this.context.lineTo(F+L-O+A.variantThreedOffsetx,this.data[a][i]<0?this.getYCoord(0)+Math.abs(C)-A.variantThreedOffsety-("center"===A.xaxisPosition?0:Math.abs(C)-this.properties.variantThreedOffsety):this.getYCoord(0)-C-A.variantThreedOffsety),this.context.lineTo(F+L-O+A.variantThreedOffsetx,this.data[a][i]<0&&R+C-A.variantThreedOffsety<this.getYCoord(0)?this.getYCoord(0):R+C-A.variantThreedOffsety),this.context.lineTo(F+L-O-1,R+C),this.context.closePath(),this.context.fill(),this.context.stroke(),0<=this.data[a][i]&&(this.context.fillStyle="rgba(255,255,255,0.5)",this.context.beginPath(),this.context.moveTo(F+O,R),this.context.lineTo(F+O+A.variantThreedOffsetx,R-A.variantThreedOffsety),this.context.lineTo(F+A.variantThreedOffsetx+L-O,R-A.variantThreedOffsety),this.context.lineTo(F+L-O,R),this.context.closePath(),this.context.fill(),this.context.stroke()),this.context.fillStyle="rgba(0,0,0,0.4)",this.context.beginPath(),this.context.moveTo(F+L-O,R),this.context.lineTo(F+L+A.variantThreedOffsetx-O,this.data[a][i]<0?this.getYCoord(0)+Math.abs(C)-A.variantThreedOffsety-("center"===A.xaxisPosition?0:Math.abs(C)-this.properties.variantThreedOffsety):this.getYCoord(0)-C-A.variantThreedOffsety),this.context.lineTo(F+L+A.variantThreedOffsetx-O,+this.data[a][i]<0&&R+C-5<this.getYCoord(0)?C>this.properties.variantThreedOffsety?this.getYCoord(0)+C-this.properties.variantThreedOffsety:this.getYCoord(0):R+C-A.variantThreedOffsety),this.context.lineTo(F+L-O,R+C),this.context.closePath(),this.context.fill(),this.context.stroke(),this.context.strokeStyle=w,this.context.fillStyle=G),C<0&&(R-=C=Math.abs(C)),this.coords.push([F+P,R,L-2*P,C]),void 0===this.coords2[a]&&(this.coords2[a]=[]),this.coords2[a].push([F+P,R,L-2*P,C]),A.shadow&&T.push([F+P,R,L-2*P,C,this.context.fillStyle])}if(T.length){RGraph.noShadow(this),this.context.lineWidth=A.linewidth,this.context.beginPath();for(i=0;i<T.length;++i)this.context.fillStyle=T[i][4],this.context.strokeStyle=A.colorsStroke,this.context.fillRect(T[i][0],T[i][1],T[i][2],T[i][3]),this.context.strokeRect(T[i][0],T[i][1],T[i][2],T[i][3]);this.context.fill(),this.context.stroke(),T=[]}}else this.coords.push([]);this.context.closePath()}"3d"===A.variant&&"right"===A.yaxisPosition&&RGraph.draw3DYAxis(this),RGraph.noShadow(this)},this.drawLabels=function(){this.drawAboveLabels()},this.getShape=function(t){for(var e=arguments[1]||this,a=RGraph.getMouseXY(t),i=a[0],s=a[1],o=(e.canvas,e.context,e.coords),r=0,n=o.length;r<n;r+=1)if(0!=e.coords[r].length){var h,l,c=o[r][0],d=o[r][1],x=o[r][2],g=o[r][3];if(A.tooltipsHotspotXonly?this.path("b r % % % %",c,this.marginTop,x,this.canvas.height-this.marginBottom):(h=RGraph.sequentialIndexToGrouped(r,this.data),"stacked"===A.grouping&&"round"===A.corners&&0===h[1]?(this.context.beginPath(),this.roundedCornersRect(c,d,x,g)):this.path("b r % % % %",c,d,x,g)),this.context.isPointInPath(i,s)){A.tooltips&&RGraph.parseTooltipText&&(l=RGraph.parseTooltipText(A.tooltips,r));for(var f=0,u=r;u>=("object"==typeof e.data[f]&&e.data[f]?e.data[f].length:1);)"number"!=typeof e.data[f]&&e.data[f]?u-=e.data[f].length:--u,f++;return"number"==typeof e.data[f]&&(u=0),{object:this,x:c,y:d,width:x,height:g,tooltip:"string"==typeof l?l:null,label:A.xaxisLabels&&"string"==typeof A.xaxisLabels[f]?A.xaxisLabels[f]:null,dataset:f,index:u,sequentialIndex:r}}}return null},this.getShapeByX=function(t){t.target;for(var e=RGraph.getMouseXY(t),a=arguments[1]||this,i=0,s=a.coords.length;i<s;i++)if(0!=a.coords[i].length){var o,r=e[0],n=(e[1],a.coords[i][0]),h=a.coords[i][1],l=a.coords[i][2],c=a.coords[i][3];if(n<=r&&r<=n+l){A.tooltips&&(o=RGraph.parseTooltipText?RGraph.parseTooltipText(A.tooltips,i):A.tooltips[i]);r=RGraph.sequentialIndexToGrouped(i,this.data);return{object:a,x:n,y:h,width:l,height:c,dataset:r[0],index:r[1],sequentialIndex:i,tooltip:"string"==typeof o?o:null}}}return null},this.getValue=function(t){var e,a,i;return(a=2==t.length?(e=t[0],t[1]):(e=(a=RGraph.getMouseXY(t))[0],a[1]))<A.marginTop||a>this.canvas.height-A.marginBottom||e<A.marginLeft||e>this.canvas.width-A.marginRight?null:("center"==A.xaxisPosition?(i=(this.grapharea/2-(a-A.marginTop))/this.grapharea*(this.scale2.max-this.scale2.min),0<=(i*=2)?i+=this.scale2.min:i-=this.scale2.min):"top"==A.xaxisPosition?(i=(this.grapharea-(a-A.marginTop))/this.grapharea*(this.scale2.max-this.scale2.min),i=this.scale2.max-i,i=-1*Math.abs(i)):(i=(this.grapharea-(a-A.marginTop))/this.grapharea*(this.scale2.max-this.scale2.min),i+=this.scale2.min),i)},this.getYCoord=function(t){if(t>this.scale2.max)return null;var e,a=A.xaxisPosition;return"top"==a?(e=((t=t<0?Math.abs(t):t)-this.scale2.min)/(this.scale2.max-this.scale2.min)*this.grapharea,e+=this.marginTop):"center"==a?(e=(t-this.scale2.min)/(this.scale2.max-this.scale2.min)*(this.grapharea/2),e=this.grapharea/2-e,e+=this.marginTop):(e=((t=t<this.scale2.min?this.scale2.min:t)-this.scale2.min)/(this.scale2.max-this.scale2.min),e*=this.canvas.height-this.marginTop-this.marginBottom,e=this.canvas.height-this.marginBottom-e),e},this.highlight=function(t){if("function"==typeof A.highlightStyle)A.highlightStyle(t);else if("string"==typeof A.highlightStyle&&"invert"===A.highlightStyle)for(var e=0;e<this.coords.length;++e)e!==t.sequentialIndex&&this.path("b r % % % % s % f %",this.coords[e][0],this.coords[e][1],this.coords[e][2],this.coords[e][3],A.highlightStroke,A.highlightFill);else"stacked"===A.grouping&&0===t.index&&"bottom"===A.xaxisPosition?(this.context.beginPath(),this.context.strokeStyle=A.highlightStroke,this.context.fillStyle=A.highlightFill,"round"===A.corners?this.roundedCornersRect(t.x,t.y,t.width,t.height):this.context.rect(t.x,t.y,t.width,t.height),this.context.stroke(),this.context.fill()):RGraph.Highlight.rect(this,t)},this.getObjectByXY=function(t){var e=RGraph.getMouseXY(t);this.getShape(t);if("3d"!==A.variant||A.textAccessible||(t=A.variantThreedAngle*e[0],e[1]-=t),e[0]>=A.marginLeft&&e[0]<=this.canvas.width-A.marginRight&&e[1]>=A.marginTop&&e[1]<=this.canvas.height-A.marginBottom)return this},this.adjusting_mousemove=function(t){var e,a,i;A.adjustable&&RGraph.Registry.get("adjusting")&&RGraph.Registry.get("adjusting").uid==this.uid&&(e=Number(this.getValue(t)),(a=RGraph.Registry.get("adjusting.shape"))&&(RGraph.Registry.set("adjusting.shape",a),this.stackedOrGrouped&&"grouped"==A.grouping?(i=RGraph.sequentialIndexToGrouped(a.sequentialIndex,this.data),"number"==typeof this.data[i[0]]?this.data[i[0]]=Number(e):RGraph.isNull(this.data[i[0]])||(this.data[i[0]][i[1]]=Number(e))):"number"==typeof this.data[a.sequentialIndex]&&(this.data[a.sequentialIndex]=Number(e)),RGraph.redrawCanvas(t.target),RGraph.fireCustomEvent(this,"onadjust")))},this.parseColors=function(){0===this.original_colors.length&&(this.original_colors.colors=RGraph.arrayClone(A.colors),this.original_colors.keyColors=RGraph.arrayClone(A.keyColors),this.original_colors.crosshairsColor=A.crosshairsColor,this.original_colors.highlightStroke=A.highlightStroke,this.original_colors.highlightFill=A.highlightFill,this.original_colors.textColor=A.textColor,this.original_colors.backgroundBarsColor1=A.backgroundBarsColor1,this.original_colors.backgroundBarsColor2=A.backgroundBarsColor2,this.original_colors.backgroundGridColor=A.backgroundGridColor,this.original_colors.backgroundColor=A.backgroundColor,this.original_colors.colorsStroke=A.colorsStroke,this.original_colors.axesColor=A.axesColor);var t=A.colors;if(t)for(var e=0;e<t.length;++e)t[e]=this.parseSingleColorForGradient(t[e]);if(t=A.keyColors)for(e=0;e<t.length;++e)t[e]=this.parseSingleColorForGradient(t[e]);A.crosshairsColor=this.parseSingleColorForGradient(A.crosshairsColor),A.highlightStroke=this.parseSingleColorForGradient(A.highlightStroke),A.highlightFill=this.parseSingleColorForGradient(A.highlightFill),A.textColor=this.parseSingleColorForGradient(A.textColor),A.backgroundBarsColor1=this.parseSingleColorForGradient(A.backgroundBarsColor1),A.backgroundBarsColor2=this.parseSingleColorForGradient(A.backgroundBarsColor2),A.backgroundGridColor=this.parseSingleColorForGradient(A.backgroundGridColor),A.backgroundColor=this.parseSingleColorForGradient(A.backgroundColor),A.colorStroke=this.parseSingleColorForGradient(A.colorStroke),A.axesColor=this.parseSingleColorForGradient(A.axesColor)},this.reset=function(){},this.parseSingleColorForGradient=function(t){if(!t||"string"!=typeof t)return t;if(t.match(/^gradient\((.*)\)$/i)){if(t.match(/^gradient\(({.*})\)$/i))return RGraph.parseJSONGradient({object:this,def:RegExp.$1});var e=RegExp.$1.split(":"),a=this.context.createLinearGradient(0,this.canvas.height-A.marginBottom,0,A.marginTop),i=1/(e.length-1);a.addColorStop(0,RGraph.trim(e[0]));for(var s=1,o=e.length;s<o;++s)a.addColorStop(s*i,RGraph.trim(e[s]))}return a||t},this.drawBevel=function(){var t=this.coords,e=this.coords2;if("stacked"==A.grouping){for(var a=0;a<e.length;++a)if(e[a]&&e[a][0]&&e[a][0][0]){for(var i=e[a][0][0],s=e[a][0][1],o=e[a][0][2],r=[],n=0;n<e[a].length;++n)r.push(e[a][n][3]);var h=RGraph.arraySum(r);this.context.save(),this.context.strokeStyle="black",this.context.beginPath(),this.context.rect(i,s,o,h),this.context.clip(),this.context.shadowColor="black",this.context.shadowOffsetX=0,this.context.shadowOffsetY=0,this.context.shadowBlur=20,this.context.beginPath(),this.context.rect(i-3,s-3,o+6,h+100),this.context.lineWidth=5,this.context.stroke(),this.context.restore()}}else for(var l,c,a=0;a<t.length;++a)t[a]&&(i=t[a][0],s=t[a][1],o=t[a][2],h=t[a][3],l=A.xaxisPosition,c=(this.canvas.height-this.marginTop-this.marginBottom)/2+this.marginTop,this.context.save(),this.context.strokeStyle="black",this.context.beginPath(),this.context.rect(i,s,o,h),this.context.clip(),this.context.shadowColor="black",this.context.shadowOffsetX=0,this.context.shadowOffsetY=0,this.context.shadowBlur=20,("top"==l||"center"==l&&c<s+h)&&(s-=100),h+=100,this.context.beginPath(),this.context.rect(i-3,s-3,o+6,h+6),this.context.lineWidth=5,this.context.stroke(),this.context.restore())},this.interactiveKeyHighlight=function(r){var n=this;this.coords2.forEach(function(t,e,a){var i,s,o;"object"==typeof t[r]&&t[r]&&(i=t[r][0]-.5,s=t[r][1]-.5,o=t[r][2]+1,t=t[r][3]+1,n.context.fillStyle=A.keyInteractiveHighlightChartFill,n.context.strokeStyle=A.keyInteractiveHighlightChartStroke,n.context.lineWidth=2,n.context.strokeRect(i,s,o,t),n.context.fillRect(i,s,o,t))})},this.on=function(t,e){return"function"!=typeof this[t="on"!==t.substr(0,2)?"on"+t:t]?this[t]=e:RGraph.addCustomEventListener(this,t,e),this},this.drawLabelsAbove=this.drawAboveLabels=function(){var t=A.labelsAbove,e=A.labelsAboveSpecific,a=("boolean"==typeof A.labelsAboveBold?A.labelsAboveBold:A.textBold,"boolean"==typeof A.labelsAboveItalic?A.labelsAboveItalic:A.textItalic,A.labelsAboveColor||A.textColor,A.labelsAboveFont||A.textFont,"number"==typeof A.labelsAboveSize?A.labelsAboveSize:A.textSize,A.labelsAboveBackground),i=A.labelsAboveDecimals,s=-1*A.labelsAboveAngle,o=A.labelsAboveUnitsPre,r=A.labelsAboveUnitsPost,n=A.labelsAbovePoint,h=A.labelsAboveThousand,l=A.labelsAboveFormatter,c=(this.coords,this.coords2),d=this.data,x=(RGraph.arrayLinearize(this.data),A.labelsAboveOffsetx),g=A.labelsAboveOffsety,f=(A.textItalic,A.textBold,A.textColor,A.textFont,A.textSize,A.grouping);"number"==typeof A.labelsAboveOffset&&(g=A.labelsAboveOffset);var u=RGraph.getTextConf({object:this,prefix:"labelsAbove"});if(RGraph.noShadow(this),this.context.fillStyle=u.color,t&&"grouped"===f){for(var b=0,p=d.length,m=0;b<p;b+=1)if("number"==typeof d[b]&&0<=d[b]){var y=(s=s)?"left":"center",v=0!==s?"center":"bottom";RGraph.text({object:this,font:u.font,size:u.size,color:u.color,bold:u.bold,italic:u.italic,x:c[b][0][0]+c[b][0][2]/2+x,y:c[b][0][1]-g,text:e?e[m]||"":RGraph.numberFormat({object:this,number:Number(Number("object"==typeof d[b]?d[b][0]:d[b]).toFixed(i)),value:Number(Number("object"==typeof d[b]?d[b][0]:d[b]).toFixed(i)),unitspre:o,unitspost:r,point:n,thousand:h,formatter:l,dataset:0,index:b}),halign:y,valign:v,angle:s,marker:!1,bounding:!0,"bounding.fill":a,"bounding.stroke":"rgba(0,0,0,0)",tag:"labels.above"}),m++}else if("number"==typeof d[b]&&d[b]<0){y=(s=s)?"right":"center",v=0!==s?"center":"top";RGraph.text({object:this,font:u.font,size:u.size,color:u.color,bold:u.bold,italic:u.italic,x:c[b][0][0]+c[b][0][2]/2+x,y:c[b][0][1]+c[b][0][3]+g,text:e?e[m]||"":RGraph.numberFormat({object:this,number:Number(Number("object"==typeof d[b]?d[b][0]:d[b]).toFixed(i)),value:Number(Number("object"==typeof d[b]?d[b][0]:d[b]).toFixed(i)),unitspre:o,unitspost:r,point:n,thousand:h,formatter:l,dataset:0,index:b}),halign:y,valign:v,angle:s,bounding:!0,"bounding.fill":a,"bounding.stroke":"rgba(0,0,0,0)",marker:!1,tag:"labels.above"}),m++}else if("object"==typeof d[b])for(var T=0,k=d[b].length;T<k;T+=1){s=s,y=d[b][T]<0?"right":"left";y=0===s?"center":y;v=d[b][T]<0?"top":"bottom";v=0!=s?"center":v,RGraph.text({object:this,font:u.font,size:u.size,color:u.color,bold:u.bold,italic:u.italic,x:c[b][T][0]+c[b][T][2]/2+x,y:"top"===A.xaxisPosition?c[b][T][1]+c[b][T][3]+5:c[b][T][1]+(d[b][T]<0?c[b][T][3]+g:-g),text:e?e[m]||"":RGraph.numberFormat({object:this,number:Number(Number(d[b][T]).toFixed(i)),value:Number(Number(d[b][T]).toFixed(i)),unitspre:o,unitspost:r,point:n,thousand:h,formatter:l,dataset:b,index:T}),halign:y,valign:"top"===A.xaxisPosition?"top":v,angle:s,bounding:!0,"bounding.fill":a,"bounding.stroke":"rgba(0,0,0,0)",marker:!1,tag:"labels.above"}),m++}}else if(t&&"stacked"===f)for(b=0,p=d.length,m=0;b<p;b+=1)"object"==typeof d[b]?(y=0!=(s=s)?"left":"center",v=0!=s?"center":"bottom",RGraph.text({object:this,font:u.font,size:u.size,color:u.color,bold:u.bold,italic:u.italic,x:c[b][0][0]+c[b][0][2]/2+x,y:c[b][0][1]+(d[b][0]<0?c[b][0][3]:0)-g,text:e?e[m]||"":RGraph.numberFormat({object:this,number:Number(Number(RGraph.arraySum(d[b])).toFixed(i)),value:Number(Number(RGraph.arraySum(d[b])).toFixed(i)),unitspre:o,unitspost:r,point:n,thousand:h,formatter:l,dataset:b}),halign:y,valign:v,angle:s,bounding:!0,"bounding.fill":a,"bounding.stroke":"rgba(0,0,0,0)",marker:!1,tag:"labels.above"}),m+=d[b].length):(y=0!=(s=s)?"left":"center",v=0!=s?"center":"bottom",RGraph.text({object:this,font:u.font,size:u.size,color:u.color,bold:u.bold,italic:u.italic,x:c[b][0][0]+c[b][0][2]/2+x,y:c[b][0][1]+(d[b][0]<0?c[b][0][3]:0)-g,text:e?e[m]||"":RGraph.numberFormat({object:this,number:Number(Number(d[b]).toFixed(i)),value:Number(Number(d[b]).toFixed(i)),unitspre:o,unitspost:r,point:n,thousand:h,formatter:l,dataset:b}),halign:y,valign:v,angle:s,bounding:!0,"bounding.fill":a,"bounding.stroke":"rgba(0,0,0,0)",marker:!1,tag:"labels.above"}),m++)},this.firstDrawFunc=function(){},this.wave=function(){if(1!==this.data.length){var o=this,r=arguments[0]||{},n=this.get("labelsAbove");r.frames=r.frames||60,r.startFrames=[],r.counters=[];var h=r.frames/3,l=-1,c=arguments[1]||function(){},d=RGraph.arrayClone(this.original_data);this.set("labelsAbove",!1);for(var t=0,e=o.data.length;t<e;t+=1)if(r.startFrames[t]=r.frames/2/(o.data.length-1)*t,"object"==typeof o.data[t]&&o.data[t]){r.counters[t]=[];for(var a=0;a<o.data[t].length;a++)r.counters[t][a]=0}else r.counters[t]=0;return o.draw(),o.set("yaxisScaleMax",o.scale2.max),RGraph.clear(o.canvas),function t(){++l;for(var e=0,a=o.data.length;e<a;e+=1)if(l>r.startFrames[e]){if("number"==typeof o.data[e])o.data[e]=Math.min(Math.abs(d[e]),Math.abs(d[e]*(r.counters[e]++/h))),d[e]<0&&(o.data[e]*=-1);else if(!RGraph.isNull(o.data[e]))for(var i=0,s=o.data[e].length;i<s;i+=1)o.data[e][i]=Math.min(Math.abs(d[e][i]),Math.abs(d[e][i]*(r.counters[e][i]++/h))),d[e][i]<0&&(o.data[e][i]*=-1)}else o.data[e]="object"==typeof o.data[e]&&o.data[e]?RGraph.arrayPad([],o.data[e].length,0):RGraph.isNull(o.data[e])?null:0;l>=r.frames?(n&&(o.set("labelsAbove",!0),RGraph.redraw()),c(o)):(RGraph.redrawCanvas(o.canvas),RGraph.Effects.updateCanvas(t))}(),this}this.grow(arguments[0],arguments[1])},this.colorwave=this.colorWave=function(){var i=this,s=arguments[0]||{};s.frames=s.frames||60,s.startFrames=[],s.counters=[],colors=i.properties.colors,colors.length<=i.data.length&&(i.set("colorsSequential",!0),colors=RGraph.arrayPad(colors,i.data.length,colors[colors.length-1]));for(var o=s.frames/2,r=-1,n=arguments[1]||function(){},t=RGraph.arrayClone(i.properties.colors),e=0,a=t.length;e<a;e+=1)s.startFrames[e]=s.frames/2/(t.length-1)*e,s.counters[e]=0;return function t(){++r;for(var e=0,a=colors.length;e<a;e+=1)r>s.startFrames[e]&&colors[e].match(/^rgba?\(([0-9 ]+),([0-9 ]+),([0-9 ]+)(,([ 0-9.]+)?)\)/)?colors[e]="rgba({1},{2},{3},{4})".format(RegExp.$1,RegExp.$2,RegExp.$3,(r-s.startFrames[e])/o):colors[e]=colors[e].replace(/,[0-9. ]+\)/,",0)");r>=s.frames?n(i):(RGraph.redrawCanvas(i.canvas),RGraph.Effects.updateCanvas(t))}(),this},this.grow=function(){var h=arguments[0]||{},l=h.frames||30,c=0,d=arguments[1]||function(){},x=this,g=this.get("labelsAbove");if(RGraph.isArray(h.data)){for(var t=0,e=0;e<h.data.length;++e)if("object"==typeof h.data[e])for(var a=0;a<h.data[e].length;++a)"string"==typeof h.data[e][a]&&h.data[e][a].match(/(\+|\-)([0-9]+)/)&&("+"===RegExp.$1?h.data[e][a]=this.original_data[e][a]+parseInt(RegExp.$2):h.data[e][a]=this.original_data[e][a]-parseInt(RegExp.$2)),t=Math.max(t,h.data[e][a]);else t=("string"==typeof h.data[e]&&h.data[e].match(/(\+|\-)([0-9]+)/)&&("+"===RegExp.$1?h.data[e]=this.original_data[e]+parseInt(RegExp.$2):h.data[e]=this.original_data[e]-parseInt(RegExp.$2)),Math.max(t,h.data[e]));var i=RGraph.getScale({object:this,options:{"scale.max":t}});"number"!=typeof A.yaxisScaleMax&&this.set("yaxisScaleMax",i.max)}if(this.set("labelsAbove",!1),null==A.yaxisScaleMax){for(t=0,e=0;e<this.data.length;++e)if(RGraph.isArray(this.data[e])&&"stacked"===A.grouping)t=Math.max(t,Math.abs(RGraph.arraySum(this.data[e])));else if(RGraph.isArray(this.data[e])&&"grouped"===A.grouping){for(var a=0,s=[];a<this.data[e].length;a++)s.push(Math.abs(this.data[e][a]));t=Math.max(t,Math.abs(RGraph.arrayMax(s)))}else t=Math.max(t,Math.abs(this.data[e]));i=RGraph.getScale({object:this,options:{"scale.max":t}});this.set("yaxisScaleMax",i.max)}"number"==typeof h.ymax&&this.set("yaxisScaleMax",h.ymax);var f=function(){for(var t=RGraph.Effects.getEasingMultiplier(l,c),e=0,a=x.original_data.length;e<a;++e)if("object"!=typeof x.data[e]||RGraph.isNull(x.data[e]))x.firstDraw||!h.data?x.data[e]=t*x.original_data[e]:h.data&&h.data.length===x.original_data.length&&(i=h.data[e]-x.original_data[e],x.data[e]=t*i+x.original_data[e]);else for(var i,s=0,o=x.data[e].length;s<o;++s)x.firstDraw||!h.data?x.data[e][s]=t*x.original_data[e][s]:h.data&&h.data.length===x.original_data.length&&(i=h.data[e][s]-x.original_data[e][s],x.data[e][s]=t*i+x.original_data[e][s]);if(RGraph.redrawCanvas(x.canvas),c<l)c+=1,RGraph.Effects.updateCanvas(f);else{if(RGraph.isArray(h.data))for(var r=RGraph.arrayLinearize(u),n=0;n<r.length;++n)x["$"+n]||(x["$"+n]={});x.data=u,x.original_data=RGraph.arrayClone(u),g&&(x.set("labelsAbove",!0),RGraph.redraw()),d(x)}};return f(),this},this.drawErrorbars=function(){var t,e=this.coords,a=A.errorbarsColor||"black",i=Math.min(A.errorbarsCappedWidth,e[0][2])/2,s=A.errorbars;A.errorbarsCapped||(f=A.errorbarsCappedWidth=0),this.context.lineWidth=A.errorbarsLinewidth;for(var o=0;o<e.length;++o){var r,n,h,l=e[o][0],c=e[o][1],d=e[o][2],x=e[o][3],g=RGraph.sequentialIndexToGrouped(o,this.data);"object"!=typeof this.data[g[0]]||RGraph.isNull(this.data[g[0]])||(r=!0,n=g[0],h=g[1]),a=A.errorbarsColor||"black",s[o]&&"number"==typeof s[o][3]&&(this.context.lineWidth=s[o][3]);var f=s[o]&&"number"==typeof s[o][4]?s[o][4]/2:i;A.errorbarsCapped||(f=0),"number"==typeof s[o]?(t=Math.abs(this.getYCoord(s[o])-this.getYCoord(0)))&&this.path("b % % l % % l % % l % % s %",l+d/2,"number"==typeof this.data[o]&&this.data[o]<0||r&&this.data[n][h]<0?c+x:c,l+d/2,"number"==typeof this.data[o]&&this.data[o]<0||r&&this.data[n][h]<0?c+x+t:c-t,l+d/2-f,"number"==typeof this.data[o]&&this.data[o]<0||r&&this.data[n][h]<0?Math.round(c+x+t):Math.round(c-t),l+d/2+f,"number"==typeof this.data[o]&&this.data[o]<0||r&&this.data[n][h]<0?Math.round(c+x+t):Math.round(c-t),a):"object"!=typeof s[o]||RGraph.isNull(s[o])||(g=Math.abs(this.getYCoord(s[o][0])-this.getYCoord(0)),"string"==typeof s[o][1]?a=s[o][1]:"string"==typeof s[o][2]&&(a=s[o][2]),f="number"==typeof s[o][4]?s[o][4]/2:i,A.errorbarsCapped||(f=0),RGraph.isNull(s[o][0])||this.path("b m % % l % % l % % l % % s %",l+d/2,c+(this.data[o]<0?x:0)+(r&&this.data[n][h]<0?x:0),l+d/2,c-g+(this.data[o]<0?x:0)+(r&&this.data[n][h]<0?x:0),l+d/2-f,Math.round(c-g)+(this.data[o]<0?x:0)+(r&&this.data[n][h]<0?x:0),l+d/2+f,Math.round(c-g)+(this.data[o]<0?x:0)+(r&&this.data[n][h]<0?x:0),a),"number"==typeof s[o][1]&&(g=Math.abs(this.getYCoord(s[o][1])-this.getYCoord(0)),this.path("b m % % l % % l % % l % % s %",l+d/2,c+(this.data[o]<0?x:0)+(r&&this.data[n][h]<0?x:0),l+d/2,c+g+(this.data[o]<0?x:0)+(r&&this.data[n][h]<0?x:0),l+d/2-f,Math.round(e[o][1]+g)+(this.data[o]<0?x:0)+(r&&this.data[n][h]<0?x:0),l+d/2+f,Math.round(c+g)+(this.data[o]<0?x:0)+(r&&this.data[n][h]<0?x:0),a))),s[o]&&"number"==typeof s[o][3]&&(this.context.lineWidth=A.errorbarsLinewidth)}},this.isAdjustable=function(t){return!(!RGraph.isNull(A.adjustableOnly)&&RGraph.isArray(A.adjustableOnly))||!(!RGraph.isArray(A.adjustableOnly)||!A.adjustableOnly[t.sequentialIndex])},this.tooltipSubstitutions=function(t){var e=RGraph.sequentialIndexToGrouped(t.index,this.data),a=this.data[e[0]];return{index:e[1],dataset:e[0],sequentialIndex:t.index,value:this.data_arr[t.index],values:a="number"==typeof a?[a]:a}},this.tooltipsFormattedCustom=function(t,e){t=this.stackedOrGrouped?!RGraph.isNull(A.tooltipsFormattedKeyLabels)&&"object"==typeof A.tooltipsFormattedKeyLabels&&A.tooltipsFormattedKeyLabels[e]?A.tooltipsFormattedKeyLabels[e]:"":!RGraph.isNull(A.tooltipsFormattedKeyLabels)&&"object"==typeof A.tooltipsFormattedKeyLabels&&A.tooltipsFormattedKeyLabels[t.index]?A.tooltipsFormattedKeyLabels[t.index]:"";return{label:t}},this.positionTooltipStatic=function(t){var e=t.object,a=(t.event,t.tooltip),i=t.index,s=RGraph.getCanvasXY(e.canvas);coords=this.coords[t.index],t.tooltip.style.left=s[0]+coords[0]-a.offsetWidth/2+coords[2]/2+e.properties.tooltipsOffsetx+"px",t.tooltip.style.top=s[1]+coords[1]-a.offsetHeight-10+e.properties.tooltipsOffsety+"px","3d"===A.variant&&(a=coords[0],coords[1],e=A.variantThreedAngle,a=Math.tan(e)*a,t.tooltip.style.top=parseInt(t.tooltip.style.top)+a-5+"px"),this.data_arr[i]<0&&(t.tooltip.style.top=parseFloat(t.tooltip.style.top)+coords[3]/2+"px")},this.roundedCornersRect=function(t,e,a,i){var s=A.cornersRoundRadius,s=Math.min(a/2,i/2,s);this.context.save(),this.context.translate(t,e),this.context.moveTo(a/2,0),this.context.arcTo(a,0,a,i,Math.min(i/2,s)),this.context.arcTo(a,i,0,i,0),this.context.arcTo(0,i,0,0,0),this.context.arcTo(0,0,s,0,Math.min(i/2,s)),this.context.lineTo(a/2,0),this.context.restore()},this.roundedCornersRectNegative=function(t,e,a,i){i<0&&(e-=i=Math.abs(i));var s=A.cornersRoundRadius,s=Math.min(Math.abs(a/2),Math.abs(i/2),Math.abs(s));this.context.save(),this.context.translate(t,e),this.context.moveTo(a/2,0),this.context.arcTo(a,0,a,i,0),this.context.arcTo(a,i,0,i,s),this.context.arcTo(0,i,0,0,s),this.context.arcTo(0,0,a,0,0),this.context.lineTo(a/2,0),this.context.restore()},this.install3DAxisNegativeClip=function(){this.path("b m % % l % % l % % l % % l % % l % % c cl",this.marginLeft,this.getYCoord(0),this.marginLeft,this.canvas.height-this.marginBottom,this.canvas.width-this.marginRight,this.canvas.height-this.marginBottom,this.canvas.width-this.marginRight+this.properties.variantThreedOffsetx,this.canvas.height-this.marginBottom-this.properties.variantThreedOffsety,this.canvas.width-this.marginRight+this.properties.variantThreedOffsetx,this.getYCoord(0)-this.properties.variantThreedOffsety,this.canvas.width-this.marginRight,this.getYCoord(0))},RGraph.register(this),RGraph.parseObjectStyleConfig(this,t.options)}else alert("[BAR] No canvas support")},RGraph.CombinedChart=function(){this.objects=[];var t=[];if(RGraph.isArray(arguments[0]))t=arguments[0];else for(var e=0;e<arguments.length;e+=1)t[e]=arguments[e];for(var a,i,e=0;e<t.length;++e)this.objects[e]=t[e],this.objects[e].set({marginLeft:this.objects[0].get("marginLeft"),marginRight:this.objects[0].get("marginRight"),marginTop:this.objects[0].get("marginTop"),marginBottom:this.objects[0].get("marginBottom")}),"line"==this.objects[e].type&&((a=this.objects[e]).set("marginInner",(this.objects[0].canvas.width-this.objects[0].get("marginRight")-this.objects[0].get("marginLeft"))/this.objects[0].data.length/2),a.set("yaxis",!1),a.set("xaxis",!1),a.set("backgroundGrid",!1),a.set("yaxisScale",!1)),this.objects[e].get("resizable")&&(i=a);return i&&RGraph.addCustomEventListener(i,"onresizebeforedraw",function(t){var e=t.get("marginLeft"),a=t.get("marginRight");t.set("marginInner",(t.canvas.width-e-a)/(2*t.original_data[0].length))}),this},RGraph.CombinedChart.prototype.add=function(t){return this.objects.push(t),this},RGraph.CombinedChart.prototype.draw=function(){if(RGraph.isArray(this.objects))for(var i=0,options,callback,func;i<this.objects.length;++i){this.objects[i].properties.combinedEffect?(options=this.objects[i].properties.combinedEffectOptions?eval("("+this.objects[i].properties.combinedEffectOptions+")"):null,callback=this.objects[i].properties.combinedEffectCallback,func=this.objects[i].properties.combinedEffect,this.objects[i][func](options,callback)):this.objects[i].draw()}return this},RGraph.SegmentedBar=function(t){for(i in this.config=t,this.properties={},this.config.data.forEach(function(t,e,a){a[e]=RGraph.arrayPad([],t,1)}),this.config.options)"string"==typeof i&&(this.properties[i]=this.config.options[i]);var s=this;this.background=new RGraph.Bar({id:t.id[0],data:RGraph.arrayPad([],t.data.length),options:{backgroundGridHlinesCount:s.properties.segmentsCount,colors:["rgba(0,0,0,0)"],xaxis:!1,yaxis:!1,yaxisLabels:!1,yaxisScale:!1}}),this.foreground=new RGraph.Bar({id:t.id[1],data:t.data,options:{grouping:"stacked",xaxis:!1,yaxis:!1,backgroundGrid:!1,yaxisLabelsOffsetx:-3,yaxisLabelsOffsety:20}}).on("draw",function(t){for(var e=s.properties.segmentsLinewidth,a=s.properties.segmentsCount,i=0;i<=a;++i)t.path("cr 0 % 1000 %",t.getYCoord(i/a*s.foreground.scale2.max)-e/2,e)}),this.foreground.set({yaxisLabelsOffsety:(this.foreground.canvas.height-this.foreground.properties.marginTop-this.foreground.properties.marginBottom)/s.properties.segmentsCount/2}),this.draw=function(){return this.background.draw(),this.foreground.draw(),this},this.grow=function(){return this.background.draw(),this.foreground.grow(arguments[0],arguments[1]),this},this.wave=function(){return this.background.draw(),this.foreground.wave(arguments[0],arguments[1]),this},this.responsive=function(t){return this.foreground.responsive(t),this.background.responsive(t),this}};
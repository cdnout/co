RGraph=window.RGraph||{isrgraph:!0,isRGraph:!0,rgraph:!0},RGraph.Meter=function(t){var S,e=t.id,s=document.getElementById(e),n=t.min,a=t.max,r=t.value;this.id=e,this.canvas=s,this.context=this.canvas.getContext?this.canvas.getContext("2d",{alpha:"object"!=typeof e||!1!==e.alpha}):null,(this.canvas.__object__=this).type="meter",this.min=RGraph.stringsToNumbers(n),this.max=RGraph.stringsToNumbers(a),this.value=RGraph.stringsToNumbers(r),this.centerx=null,this.centery=null,this.radius=null,this.isRGraph=!0,this.isrgraph=!0,this.rgraph=!0,this.currentValue=null,this.uid=RGraph.createUID(),this.canvas.uid=this.canvas.uid||RGraph.createUID(),this.colorsParsed=!1,this.coordsText=[],this.original_colors=[],this.firstDraw=!0,this.properties={backgroundImageUrl:null,backgroundImageOffsetx:0,backgroundImageOffsety:0,backgroundImageStretch:!0,backgroundColor:"white",marginLeft:35,marginRight:35,marginTop:35,marginBottom:35,linewidth:1,linewidthSegments:0,colorsStroke:null,border:!0,borderColor:"black",textFont:"Arial, Verdana, sans-serif",textSize:12,textColor:"black",textBold:!1,textItalic:!1,textValign:"center",textAccessible:!1,textAccessibleOverflow:"visible",textAccessiblePointerevents:!1,text:null,labels:!0,labelsCount:10,labelsSpecific:null,labelsRadiusOffset:0,labelsOffsetRadius:null,labelsFont:null,labelsSize:null,labelsColor:null,labelsBold:null,labelsItalic:null,labelsValue:!1,labelsValueFont:null,labelsValueSize:null,labelsValueBold:null,labelsValueItalic:null,labelsValueColor:null,labelsValueDecimals:0,labelsValuePoint:".",labelsValueThousand:",",labelsValueUnitsPre:"",labelsValueUnitsPost:"",labelsValueBackground:!0,labelsValueBackgroundFill:"rgba(255,255,255,0.75)",labelsValueBackgroundStroke:"rgba(0,0,0,0)",labelsValueSpecific:null,labelsValueAccessible:!0,labelsValueOffsetx:0,labelsValueOffsety:0,title:"",titleBackground:null,titleHpos:null,titleVpos:null,titleColor:null,titleBold:null,titleFont:null,titleItalic:null,titleSize:null,titleX:null,titleY:null,titleHalign:null,titleValign:null,titleOffsetx:0,titleOffsety:0,colorsGreenStart:.35*(this.max-this.min)+this.min,colorsGreenEnd:this.max,colorsGreenColor:"#207A20",colorsYellowStart:.1*(this.max-this.min)+this.min,colorsYellowEnd:.35*(this.max-this.min)+this.min,colorsYellowColor:"#D0AC41",colorsRedStart:this.min,colorsRedEnd:.1*(this.max-this.min)+this.min,colorsRedColor:"#9E1E1E",colorsRanges:null,contextmenu:null,annotatable:!1,annotatableColor:"black",shadow:!1,shadowColor:"rgba(0,0,0,0.5)",shadowBlur:3,shadowOffsetx:3,shadowOffsety:3,resizable:!1,resizableHandleAdjust:[0,0],resizableHandleBackground:null,tickmarksSmallCount:100,tickmarksSmallColor:"#bbb",tickmarksLargeCount:10,tickmarksLargeColor:"black",scaleUnitsPre:"",scaleUnitsPost:"",scaleDecimals:0,scalePoint:".",scaleThousand:",",radius:null,centerx:null,centery:null,segmentsRadiusStart:0,needleRadius:null,needleType:"normal",needleTail:!1,needleHead:!0,needleHeadLength:30,needleHeadWidth:.088,needleColor:"black",needleImageUrl:null,needleImageOffsetx:0,needleImageOffsety:0,adjustable:!1,anglesStart:RGraph.PI,anglesEnd:RGraph.TWOPI,centerpinStroke:"black",centerpinFill:"white",clearto:"rgba(0,0,0,0)"},this.canvas?(S=this.properties,this.path=RGraph.pathObjectFunction,RGraph.Effects&&"function"==typeof RGraph.Effects.decorate&&RGraph.Effects.decorate(this),this.responsive=RGraph.responsive,this.set=function(t){"labelsValueText"===t.substr(0,15)&&(t=t.replace(/^labelsValueText/,"labelsValue"));var e=void 0===arguments[1]?null:arguments[1];if(1!==arguments.length||"object"!=typeof arguments[0])return S[t]=e,this;for(i in arguments[0])"string"==typeof i&&this.set(i,arguments[0][i]);return this},this.get=function(t){return S[t]},this.draw=function(){return RGraph.fireCustomEvent(this,"onbeforedraw"),this.canvas.__rgraph_aa_translated__||(this.context.translate(.5,.5),this.canvas.__rgraph_aa_translated__=!0),this.value>this.max&&(this.value=this.max),this.value<this.min&&(this.value=this.min),this.currentValue=this.value,this.marginLeft=S.marginLeft,this.marginRight=S.marginRight,this.marginTop=S.marginTop,this.marginBottom=S.marginBottom,this.centerx=(this.canvas.width-this.marginLeft-this.marginRight)/2+this.marginLeft,this.centery=this.canvas.height-this.marginBottom,this.radius=Math.min((this.canvas.width-this.marginLeft-this.marginRight)/2,this.canvas.height-this.marginTop-this.marginBottom),this.coordsText=[],"number"==typeof S.centerx&&(this.centerx=S.centerx),"number"==typeof S.centery&&(this.centery=S.centery),"number"==typeof S.radius&&(this.radius=S.radius),this.colorsParsed||(this.parseColors(),this.colorsParsed=!0),this.drawBackground(),this.drawLabels(),this.drawNeedle(),this.drawReadout(),RGraph.drawTitle(this,S.title,this.marginTop,null,"boolean"==typeof S.titleSize?S.titleSize:S.textSize),S.contextmenu&&RGraph.showContext(this),RGraph.addCustomText(this),RGraph.installEventListeners(this),this.firstDraw&&(this.firstDraw=!1,RGraph.fireCustomEvent(this,"onfirstdraw"),this.firstDrawFunc()),RGraph.fireCustomEvent(this,"ondraw"),this},this.exec=function(t){return t(this),this},this.drawBackground=function(){var t,e,s,i;if("string"!=typeof S.backgroundImageUrl||this.__background_image__?this.__background_image__&&(t=0+S.backgroundImageOffsetx,e=0+S.backgroundImageOffsety,S.backgroundImageStretch?this.context.drawImage(this.__background_image__,t,e,this.canvas.width,this.canvas.height):this.context.drawImage(this.__background_image__,t,e)):(t=0+S.backgroundImageOffsetx,e=0+S.backgroundImageOffsety,i=new Image,(this.__background_image__=i).src=S.backgroundImageUrl,s=this,i.onload=function(){S.backgroundImageStretch?s.context.drawImage(this,t,e,s.canvas.width,s.canvas.height):s.context.drawImage(this,t,e),RGraph.redraw()}),this.context.beginPath(),this.context.fillStyle=S.backgroundColor,S.shadow&&RGraph.setShadow(this,S.shadowColor,S.shadowOffsetx,S.shadowOffsety,S.shadowBlur),this.context.moveTo(this.centerx,this.centery),this.context.arc(this.centerx,this.centery,this.radius,S.anglesStart,S.anglesEnd,!1),this.context.fill(),RGraph.noShadow(this),S.shadow&&(this.context.beginPath(),i=40<.06*this.radius?40:.06*this.radius,this.context.arc(this.centerx,this.centery,i,0,RGraph.TWOPI,0),this.context.fill(),RGraph.noShadow(this)),S.tickmarksSmallCount){for(var n=0;n<S.anglesEnd-S.anglesStart;n+=RGraph.PI/S.tickmarksSmallCount)this.context.beginPath(),this.context.strokeStyle=S.tickmarksSmallColor,this.context.arc(this.centerx,this.centery,this.radius,S.anglesStart+n,S.anglesStart+n+1e-5,0),this.context.arc(this.centerx,this.centery,this.radius-5,S.anglesStart+n,S.anglesStart+n+1e-5,0),this.context.stroke();this.context.beginPath(),this.context.fillStyle=S.backgroundColor,this.context.arc(this.centerx,this.centery,this.radius-4,S.anglesStart,S.anglesEnd,!1),this.context.closePath(),this.context.fill()}if(S.tickmarksLargeCount)for(var a=["white","white",S.tickmarksLargeColor],r=0;r<a.length;++r)for(n=0;n<S.anglesEnd-S.anglesStart;n+=(S.anglesEnd-S.anglesStart)/S.tickmarksLargeCount)this.context.beginPath(),this.context.strokeStyle=a[r],this.context.arc(this.centerx,this.centery,this.radius,S.anglesStart+n,S.anglesStart+n+.001,0),this.context.arc(this.centerx,this.centery,this.radius-5,S.anglesStart+n,S.anglesStart+n+1e-4,0),this.context.stroke();this.context.beginPath(),this.context.fillStyle=S.backgroundColor,this.context.moveTo(this.centerx,this.centery),this.context.arc(this.centerx,this.centery,this.radius-7,S.anglesStart,S.anglesEnd,!1),this.context.closePath(),this.context.fill();S.colorsRanges;if(RGraph.isArray(S.colorsRanges)){for(var l=S.colorsRanges,n=0;n<l.length;++n)this.context.strokeStyle=S.colorsStroke||l[n][2],this.context.fillStyle=l[n][2],this.context.lineWidth=S.linewidthSegments,this.context.beginPath(),this.context.arc(this.centerx,this.centery,.85*this.radius,(l[n][0]-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,(l[n][1]-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,!1),0<S.segmentsRadiusStart?this.context.arc(this.centerx,this.centery,S.segmentsRadiusStart,(l[n][1]-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,(l[n][0]-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,!0):this.context.lineTo(this.centerx,this.centery),this.context.closePath(),this.context.stroke(),this.context.fill();this.context.beginPath()}else this.context.lineWidth=S.linewidth,this.context.strokeStyle=S.colorsStroke||S.colorsGreenColor,this.context.fillStyle=S.colorsGreenColor,this.context.lineWidth=S.linewidthSegments,this.context.beginPath(),this.context.arc(this.centerx,this.centery,.85*this.radius,(S.colorsGreenStart-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,(S.colorsGreenEnd-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,!1),0<S.segmentsRadiusStart?this.context.arc(this.centerx,this.centery,S.segmentsRadiusStart,(S.colorsGreenEnd-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,(S.colorsGreenStart-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,!0):this.context.lineTo(this.centerx,this.centery),this.context.closePath(),this.context.stroke(),this.context.fill(),this.context.strokeStyle=S.colorsStroke||S.colorsYellow,this.context.fillStyle=S.colorsYellowColor,this.context.lineWidth=S.linewidthSegments,this.context.beginPath(),this.context.arc(this.centerx,this.centery,.85*this.radius,(S.colorsYellowStart-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,(S.colorsYellowEnd-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,!1),0<S.segmentsRadiusStart?this.context.arc(this.centerx,this.centery,S.segmentsRadiusStart,(S.colorsYellowEnd-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,(S.colorsYellowStart-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,!0):this.context.lineTo(this.centerx,this.centery),this.context.closePath(),this.context.stroke(),this.context.fill(),this.context.strokeStyle=S.colorsStroke||S.colorsRedColor,this.context.fillStyle=S.colorsRedColor,this.context.lineWidth=S.linewidthSegments,this.context.beginPath(),this.context.arc(this.centerx,this.centery,.85*this.radius,(S.colorsRedStart-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,(S.colorsRedEnd-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,!1),0<S.segmentsRadiusStart?this.context.arc(this.centerx,this.centery,S.segmentsRadiusStart,(S.colorsRedEnd-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,(S.colorsRedStart-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart,!0):this.context.lineTo(this.centerx,this.centery),this.context.closePath(),this.context.stroke(),this.context.fill(),this.context.lineWidth=1;S.border&&(this.context.strokeStyle=S.borderColor,this.context.lineWidth=S.linewidth,this.context.beginPath(),this.context.moveTo(this.centerx,this.centery),this.context.arc(this.centerx,this.centery,this.radius,S.anglesStart,S.anglesEnd,!1),this.context.closePath()),this.context.stroke(),this.context.lineWidth=1},this.drawNeedle=function(){var t,e=(this.value-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart;"string"!=typeof S.needleImageUrl||this.__needle_image__?this.__needle_image__&&(this.context.save(),RGraph.rotateCanvas(this.canvas,this.centerx,this.centery,e),this.context.drawImage(this.__needle_image__,this.centerx+S.needleImageOffsetx,this.centery+S.needleImageOffsety),this.context.restore()):(i=new Image,(this.__needle_image__=i).src=S.needleImageUrl,t=this,i.onload=function(){t.context.save(),RGraph.rotateCanvas(t.canvas,t.centerx,t.centery,e),t.context.drawImage(this,t.centerx+S.needleImageOffsetx,t.centery+S.needleImageOffsety),t.context.restore(),RGraph.redraw()});var s,i="number"==typeof S.needleRadius?S.needleRadius:.7*this.radius;"pointer"===S.needleType?(s=40<.06*this.radius?40:.06*this.radius,this.context.beginPath(),this.context.fillStyle=S.needleColor,this.context.moveTo(this.centerx,this.centery),this.context.arc(this.centerx,this.centery,s,0,RGraph.TWOPI,!1),this.context.fill(),this.context.beginPath(),this.context.arc(this.centerx,this.centery,s,e+RGraph.HALFPI,e+RGraph.HALFPI+1e-4,!1),this.context.arc(this.centerx,this.centery,i,e,e+.001,!1),this.context.arc(this.centerx,this.centery,s,e-RGraph.HALFPI,e-RGraph.HALFPI+.001,!1)):(this.context.fillStyle="black",this.context.lineWidth=200<=this.radius?7:3,this.context.lineCap="round",this.context.beginPath(),this.context.strokeStyle=S.needleColor,"number"==typeof S.needleLinewidth&&(this.context.lineWidth=S.needleLinewidth),this.context.arc(this.centerx,this.centery,i,e,e+.001,!1),this.context.lineTo(this.centerx,this.centery),this.context.stroke(),S.needleHead&&(this.context.fillStyle=S.needleColor,this.context.beginPath(),this.context.lineWidth=1,this.context.arc(this.centerx,this.centery,i+15,e,e+.001,0),this.context.arc(this.centerx,this.centery,i-S.needleHeadLength+15,e+S.needleHeadWidth,e+S.needleHeadWidth,0),this.context.arc(this.centerx,this.centery,i-S.needleHeadLength+15,e-S.needleHeadWidth,e-S.needleHeadWidth,1),this.context.fill()),S.needleTail&&(this.context.beginPath(),this.context.strokeStyle=S.needleColor,"number"==typeof S.needleLinewidth&&(this.context.lineWidth=S.needleLinewidth),e=(this.value-this.min)/(this.max-this.min)*(this.properties.anglesEnd-this.properties.anglesStart)+this.properties.anglesStart+RGraph.PI,this.context.arc(this.centerx,this.centery,25,e,e+.001,!1),this.context.lineTo(this.centerx,this.centery),this.context.stroke()),s=40<.06*this.radius?40:.06*this.radius,this.context.beginPath(),this.context.fillStyle=S.centerpinStroke,this.context.arc(this.centerx,this.centery,s,.001,RGraph.TWOPI,0),this.context.fill(),this.context.fillStyle=S.centerpinFill,this.context.beginPath(),this.context.arc(this.centerx,this.centery,s-2,.001,RGraph.TWOPI,0)),this.context.fill()},this.drawLabels=function(){if(S.labels){this.radius,S.textItalic;var t=S.scaleUnitsPost,e=S.scaleUnitsPre,s=S.scalePoint,i=S.scaleThousand,n=this.centerx,a=this.centery,r=(this.min,this.max,S.scaleDecimals),l=S.labelsCount,h=S.labelsRadiusOffset,o=S.labelsSpecific;"number"==typeof S.labelsOffsetRadius&&(h=S.labelsOffsetRadius);var c=RGraph.getTextConf({object:this,prefix:"labels"});if(o)for(var d,g,u=0;u<o.length;++u)m=(g="string"==typeof o[u]||"number"==typeof o[u]?(d=(x=this.getAngle((this.max-this.min)/o.length/2+(this.max-this.min)/o.length*u+this.min))*(180/RGraph.PI),o[u].toString()):(d=(x=this.getAngle(o[u][1]))*(180/RGraph.PI),o[u][0].toString()),RGraph.getRadiusEndPoint(this.centerx,this.centery,x,.925*this.radius+h)),RGraph.text({object:this,font:c.font,size:c.size,color:c.color,bold:c.bold,italic:c.italic,x:m[0],y:m[1],text:g,halign:"center",valign:"center",angle:d+90,bounding:!1,tag:"labels-specific"});else{this.context.fillStyle=S.textColor,this.context.lineWidth=1,this.context.beginPath();for(u=0;u<=l;++u){var x=(S.anglesEnd-S.anglesStart)*(u/l)+S.anglesStart,m=RGraph.getRadiusEndPoint(n,a,x+(0!=u&&u!=l||!S.border?0:0==u?.05:-.05),.925*this.radius-("bottom"===S.textValign?15:0)+h),f=S.anglesStart,b=S.anglesEnd,p=f*(180/RGraph.PI),b=(RGraph.PI,(b-f)*(180/RGraph.PI));valign=S.textValign,halign=S.border?0==u?"left":u==l?"right":"center":"center";f=(this.max-this.min)*(u/l)+this.min;RGraph.text({object:this,font:c.font,size:c.size,color:c.color,bold:c.bold,italic:c.italic,x:m[0],y:m[1],text:RGraph.numberFormat({object:this,number:f.toFixed(0===f?0:r),unitspre:e,unitspost:t,point:s,thousand:i}),halign:halign,valign:valign,angle:1/l*b*u+p-270,bounding:!1,boundingFill:0==u||u==l?"white":null,tag:"scale"})}}}},this.drawReadout=function(){var t,e;S.labelsValue&&(t=RGraph.numberFormat({object:this,number:this.value.toFixed(0===this.value?0:S.labelsValueDecimals),unitspre:S.labelsValueUnitsPre,unitspost:S.labelsValueUnitsPost,point:S.labelsValuePoint,thousand:S.labelsValueThousand}),"string"==typeof S.labelsValueSpecific&&(t=S.labelsValueSpecific),e=RGraph.getTextConf({object:this,prefix:"labelsValue"}),RGraph.text({object:this,font:e.font,size:e.size,color:e.color,bold:e.bold,italic:e.italic,x:this.centerx+S.labelsValueOffsetx,y:this.centery-e.size-15+S.labelsValueOffsety,text:t,halign:"center",valign:"bottom",bounding:S.labelsValueBackground,boundingFill:S.labelsValueBackgroundFill,boundingStroke:S.labelsValueBackgroundStroke,accessible:S.labelsValueAccessible,tag:"value.text"}))},this.getShape=function(t){},this.getValue=function(t){var e=RGraph.getMouseXY(t),t=RGraph.getAngleByXY(this.centerx,this.centery,e[0],e[1]);if(RGraph.getHypLength(this.centerx,this.centery,e[0],e[1])>this.radius)return null;t<RGraph.HALFPI&&(t+=RGraph.TWOPI);t=(t-S.anglesStart)/(S.anglesEnd-S.anglesStart)*(this.max-this.min)+this.min,t=Math.max(t,this.min);return t=Math.min(t,this.max)},this.getObjectByXY=function(t){var e=RGraph.getMouseXY(t),t=RGraph.getHypLength(this.centerx,this.centery,e[0],e[1]);if(e[0]>this.centerx-this.radius&&e[0]<this.centerx+this.radius&&e[1]>this.centery-this.radius&&e[1]<this.centery+this.radius&&t<=this.radius)return this},this.adjusting_mousemove=function(t){S.adjustable&&RGraph.Registry.get("adjusting")&&RGraph.Registry.get("adjusting").uid==this.uid&&(this.value=this.getValue(t),RGraph.clear(this.canvas),RGraph.redrawCanvas(this.canvas),RGraph.fireCustomEvent(this,"onadjust"))},this.getAngle=function(t){return t>this.max||t<this.min?null:(t-this.min)/(this.max-this.min)*(S.anglesEnd-S.anglesStart)+S.anglesStart},this.parseColors=function(){0===this.original_colors.length&&(this.original_colors.colorsGreenColor=RGraph.arrayClone(S.colorsGreenColor),this.original_colors.colorsYellowColor=RGraph.arrayClone(S.colorsYellowColor),this.original_colors.colorsRedColor=RGraph.arrayClone(S.colorsRedColor),this.original_colors.colorsRanges=RGraph.arrayClone(S.colorsRanges)),S.colorsGreenColor=this.parseSingleColorForGradient(S.colorsGreenColor),S.colorsYellowColor=this.parseSingleColorForGradient(S.colorsYellowColor),S.colorsRedColor=this.parseSingleColorForGradient(S.colorsRedColor);var t=S.colorsRanges;if(t&&t.length)for(var e=0;e<t.length;++e)t[e][2]=this.parseSingleColorForGradient(t[e][2])},this.reset=function(){},this.parseSingleColorForGradient=function(t){if(!t||"string"!=typeof t)return t;if(t.match(/^gradient\((.*)\)$/i)){if(t.match(/^gradient\(({.*})\)$/i))return RGraph.parseJSONGradient({object:this,def:RegExp.$1,radial:!0});for(var e=RegExp.$1.split(":"),s=this.context.createRadialGradient(this.centerx,this.centery,S.segmentsRadiusStart,this.centerx,this.centery,.85*this.radius),i=1/(e.length-1),n=0;n<e.length;++n)s.addColorStop(n*i,RGraph.trim(e[n]))}return s||t},this.on=function(t,e){return"function"!=typeof this[t="on"!==t.substr(0,2)?"on"+t:t]?this[t]=e:RGraph.addCustomEventListener(this,t,e),this},this.firstDrawFunc=function(){},this.grow=function(){var e=this;e.currentValue=e.currentValue||e.min;var s=(arguments[0]||{}).frames||30,i=0,n=(e.value-e.currentValue)/s,a=arguments[1]||function(){},r=e.currentValue;return function t(){e.value=r+i++*n,RGraph.clear(e.canvas),RGraph.redrawCanvas(e.canvas),i<=s?RGraph.Effects.updateCanvas(t):a(e)}(),this},RGraph.register(this),RGraph.parseObjectStyleConfig(this,t.options)):alert("[METER] No canvas support")};
RGraph=window.RGraph||{isrgraph:!0,isRGraph:!0,rgraph:!0},RGraph.Pie=function(t){var e=t.id,i=document.getElementById(e),s=t.data;this.id=e,this.canvas=i,this.context=this.canvas.getContext?this.canvas.getContext("2d",{alpha:"object"!=typeof e||!1!==e.alpha}):null,(this.canvas.__object__=this).total=0,this.subTotal=0,this.angles=[],this.data=s,this.properties=[],this.type="pie",this.isRGraph=!0,this.isrgraph=!0,this.rgraph=!0,this.coords=[],this.coords.key=[],this.coordsSticks=[],this.coordsText=[],this.uid=RGraph.createUID(),this.canvas.uid=this.canvas.uid||RGraph.createUID(),this.colorsParsed=!1,this.original_colors=[],this.firstDraw=!0,this.exploding=null,this.data=RGraph.stringsToNumbers(this.data),this.properties={centerxAdjust:0,centeryAdjust:0,colors:["red","#ccc","#cfc","blue","pink","yellow","black","orange","cyan","purple","#78CAEA","#E284E9","white","blue","#9E7BF6"],colorsStroke:"white",linewidth:3,labels:[],labelsFormattedDecimals:0,labelsFormattedPoint:".",labelsFormattedThousand:",",labelsFormattedUnitsPre:"",labelsFormattedUnitsPost:"",labelsFont:null,labelsSize:null,labelsColor:null,labelsBold:null,labelsItalic:null,labelsOffsetRadius:0,labelsSticks:!1,labelsSticksLength:7,labelsSticksColors:null,labelsSticksLinewidth:1,labelsSticksHlength:5,labelsList:!0,labelsListLeftOffsetx:0,labelsListLeftOffsety:0,labelsListRightOffsetx:0,labelsListRightOffsety:0,labelsIngraph:null,labelsIngraphColor:null,labelsIngraphFont:null,labelsIngraphSize:null,labelsIngraphBold:null,labelsIngraphItalic:null,labelsIngraphBounding:!0,labelsIngraphBoundingFill:"rgba(255,255,255,0.85)",labelsIngraphBoundingStroke:"rgba(0,0,0,0)",labelsIngraphSpecific:null,labelsIngraphUnitsPre:"",labelsIngraphUnitsPost:"",labelsIngraphPoint:".",labelsIngraphThousand:",",labelsIngraphDecimals:0,labelsIngraphRadius:null,labelsIngraphOffsetRadius:0,labelsCenter:null,labelsCenterSize:26,labelsCenterFont:null,labelsCenterColor:null,labelsCenterItalic:null,labelsCenterBold:null,labelsCenterOffsetx:0,labelsCenterOffsety:0,marginLeft:35,marginRight:35,marginTop:35,marginBottom:35,title:"",titleBackground:null,titleHpos:null,titleVpos:.5,titleBold:null,titleFont:null,titleSize:null,titleColor:null,titleItalic:null,titleX:null,titleY:null,titleHalign:null,titleValign:null,titleOffsetx:0,titleOffsety:0,shadow:!0,shadowColor:"#aaa",shadowOffsetx:0,shadowOffsety:0,shadowBlur:15,textBold:!1,textItalic:!1,textSize:12,textColor:"black",textFont:"Arial, Verdana, sans-serif",textAccessible:!0,textAccessibleOverflow:"visible",textAccessiblePointerevents:!1,text:null,contextmenu:null,tooltips:[],tooltipsEvent:"onclick",tooltipsEffect:"slide",tooltipsCssClass:"RGraph_tooltip",tooltipsCss:null,tooltipsHighlight:!0,tooltipsFormattedThousand:",",tooltipsFormattedPoint:".",tooltipsFormattedDecimals:0,tooltipsFormattedUnitsPre:"",tooltipsFormattedUnitsPost:"",tooltipsFormattedKeyColors:null,tooltipsFormattedKeyColorsShape:"square",tooltipsFormattedKeyLabels:[],tooltipsFormattedListType:"ul",tooltipsFormattedListItems:null,tooltipsFormattedTableHeaders:null,tooltipsFormattedTableData:null,tooltipsPointer:!0,tooltipsPositionStatic:!0,highlightStyle:"2d",highlightStyleTwodFill:"rgba(255,255,255,0.7)",highlightStyleTwodStroke:"rgba(255,255,255,0.7)",highlightStyleTwodLinewidth:0,highlightStyleOutlineWidth:null,centerx:null,centery:null,radius:null,border:!1,borderColor:"rgba(255,255,255,0.5)",key:null,keyBackground:"white",keyPosition:"graph",keyHalign:"right",keyShadow:!1,keyShadowColor:"#666",keyShadowBlur:3,keyShadowOffsetx:2,keyShadowOffsety:2,keyPositionGutterBoxed:!1,keyPositionX:null,keyPositionY:null,keyColorShape:"square",keyRounded:!0,keyLinewidth:1,keyColors:null,keyInteractive:!1,keyInteractiveHighlightChartStroke:"black",keyInteractiveHighlightChartFill:"rgba(255,255,255,0.7)",keyInteractiveHighlightLabel:"rgba(255,0,0,0.2)",keyLabelsColor:null,keyLabelsFont:null,keyLabelsSize:null,keyLabelsBold:null,keyLabelsItalic:null,keyLabelsOffsetx:0,keyLabelsOffsety:0,annotatable:!1,annotatableColor:"black",variant:"pie",variantDonutWidth:null,variantThreedDepth:20,exploded:[],effectRoundrobinMultiplier:1,centerpin:null,centerpinFill:"gray",centerpinStroke:"white",origin:0-Math.PI/2,clearto:"rgba(0,0,0,0)",events:!0};for(var a=0,l=s.length;a<l;a++)this.total+=s[a],this["$"+a]={};var S=this.properties;this.path=RGraph.pathObjectFunction,RGraph.Effects&&"function"==typeof RGraph.Effects.decorate&&RGraph.Effects.decorate(this),this.responsive=RGraph.responsive,this.set=function(t){var e=void 0===arguments[1]?null:arguments[1];if(1!==arguments.length||"object"!=typeof t)return S[t]=e,this;for(a in t)"string"==typeof a&&this.set(a,t[a]);return this},this.get=function(t){return S[t]},this.draw=function(){if(RGraph.fireCustomEvent(this,"onbeforedraw"),this.canvas.__rgraph_aa_translated__||(this.context.translate(.5,.5),this.canvas.__rgraph_aa_translated__=!0),this.marginLeft=S.marginLeft,this.marginRight=S.marginRight,this.marginTop=S.marginTop,this.marginBottom=S.marginBottom,this.radius=this.getRadius(),this.centerx=this.graph.width/2+this.marginLeft+S.centerxAdjust,this.centery=this.graph.height/2+this.marginTop+S.centeryAdjust,this.subTotal=S.origin,this.angles=[],this.coordsText=[],"number"==typeof S.radius&&(this.radius=S.radius),"number"==typeof S.centerx&&(this.centerx=S.centerx),"number"==typeof S.centery&&(this.centery=S.centery),!(this.radius<=0)){if(this.colorsParsed||(this.parseColors(),this.colorsParsed=!0),0<S.variant.indexOf("3d"))return this.draw3d();RGraph.drawTitle(this,S.title,this.canvas.height/2-this.radius-5,this.centerx,S.titleSize||S.textSize),this.total=RGraph.arraySum(this.data);for(var t=this.total,e=this.data,i=0,s=this.data.length;i<s;i++){var a=e[i]/t*RGraph.TWOPI;this.drawSegment(a,S.colors[i],i==s-1,i)}RGraph.noShadow(this),0<S.linewidth&&this.drawBorders();for(var s=this.angles.length,l=this.radius,n=0;n<2;n+=1)for(i=0;i<s;i++){this.context.beginPath();var o=this.angles[i];1===n&&(this.context.strokeStyle="object"==typeof S.colorsStroke?S.colorsStroke[i]:S.colorsStroke),S.colors[i]&&(this.context.fillStyle=S.colors[i]),this.context.lineJoin="round",this.context.arc(o[2],o[3],l,o[0],o[1],!1),"donut"==S.variant?this.context.arc(o[2],o[3],"number"==typeof S.variantDonutWidth?l-S.variantDonutWidth:l/2,o[1],o[0],!0):this.context.lineTo(o[2],o[3]),this.context.closePath(),0===n?this.context.fill():this.context.stroke()}return S.labelsSticks&&(this.drawSticks(),S.colorsStroke),S.labels&&this.drawLabels(),S.centerpin&&this.drawCenterpin(),S.labelsIngraph&&this.drawInGraphLabels(),"string"==typeof S.labelsCenter&&this.drawCenterLabel(S.labelsCenter),S.contextmenu&&RGraph.showContext(this),S.border&&(this.context.beginPath(),this.context.lineWidth=5,this.context.strokeStyle=S.borderColor,this.context.arc(this.centerx,this.centery,this.radius-2,0,RGraph.TWOPI,0),this.context.stroke()),S.key&&S.key.length&&RGraph.drawKey(this,S.key,S.colors),RGraph.noShadow(this),RGraph.addCustomText(this),1==S.events&&RGraph.installEventListeners(this),this.firstDraw&&(this.firstDraw=!1,RGraph.fireCustomEvent(this,"onfirstdraw"),this.firstDrawFunc()),RGraph.fireCustomEvent(this,"ondraw"),this}},this.exec=function(t){return t(this),this},this.drawSegment=function(t,e,i,s){var a,l,n,o=this.subTotal;t*=S.effectRoundrobinMultiplier,this.context.beginPath(),e&&(this.context.fillStyle=e),this.context.strokeStyle=S.colorsStroke,this.context.lineWidth=0,S.shadow&&RGraph.setShadow(this,S.shadowColor,S.shadowOffsetx,S.shadowOffsety,S.shadowBlur),"object"==typeof S.exploded&&0<S.exploded[s]||"number"==typeof S.exploded?(l=a=0,h="number"==typeof S.exploded?S.exploded:S.exploded[s],r=o+t/2,a=Math.cos(r)*h,l=Math.sin(r)*h,n=this.radius,this.context.moveTo(this.centerx+a,this.centery+l)):(l=a=0,n=this.radius);var r=o,h=o+t;this.context.arc(this.centerx+a,this.centery+l,n,r,h,0),"donut"==S.variant?this.context.arc(this.centerx+a,this.centery+l,"number"==typeof S.variantDonutWidth?n-S.variantDonutWidth:n/2,h,r,!0):this.context.lineTo(this.centerx+a,this.centery+l),this.context.closePath(),this.angles.push([o,o+t,this.centerx+a,this.centery+l]),this.context.fill(),this.subTotal+=t},this.drawLabels=function(){if(S.labels&&S.labels.length){"string"==typeof S.labels&&(S.labels=RGraph.arrayPad({array:[],length:this.data.length,value:S.labels}));for(var t=0;t<S.labels.length;++t)S.labels[t]=RGraph.labelSubstitution({object:this,text:S.labels[t],index:t,value:this.data[t],decimals:S.labelsFormattedDecimals||0,unitsPre:S.labelsFormattedUnitsPre||"",unitsPost:S.labelsFormattedUnitsPost||"",thousand:S.labelsFormattedThousand||",",point:S.labelsFormattedPoint||"."})}if(S.labels.length&&S.labelsList)return this.drawLabelsList();var e,i=S.labels,s=(this.context,S.textFont,S.labelsBold,S.textSize,this.centerx),a=this.centery,l=this.radius;if(RGraph.noShadow(this),this.context.fillStyle="black",this.context.beginPath(),i&&i.length){for(var n=RGraph.getTextConf({object:this,prefix:"labels"}),t=0;t<this.angles.length;++t){var o,r,h,d,c=this.angles[t];"string"!=typeof i[t]&&"number"!=typeof i[t]||(this.context.moveTo(s,a),d=c[0]+(c[1]-c[0])/2,h=(c[1]-c[0])/2+c[0],r="object"==typeof S.exploded&&S.exploded[t]||"number"==typeof S.exploded?(c[1],c[0],r="number"==typeof S.exploded?S.exploded:S.exploded[t],o=Math.cos(h)*r,Math.sin(h)*r):o=0,S.labelsSticks&&(o+=Math.cos(h)*("object"==typeof S.labelsSticksLength?S.labelsSticksLength[t]:S.labelsSticksLength),r+=Math.sin(h)*("object"==typeof S.labelsSticksLength?S.labelsSticksLength[t]:S.labelsSticksLength)),h=s+o+(l+10+S.labelsOffsetRadius)*Math.cos(d)+(S.labelsSticks?d<RGraph.HALFPI||d>RGraph.TWOPI+RGraph.HALFPI?2:-2:0),d=a+r+(l+10+S.labelsOffsetRadius)*Math.sin(d),this.coordsSticks&&this.coordsSticks[t]&&(h=this.coordsSticks[t][4][0]+(h<s?-5:5),d=this.coordsSticks[t][4][1]),e=h<s?"right":"left",this.context.fillStyle=S.textColor,RGraph.text({object:this,font:n.font,size:n.size,color:n.color,bold:n.bold,italic:n.italic,x:h,y:d,text:i[t],valign:"center",halign:e,tag:"labels",cssClass:RGraph.getLabelsCSSClassName({object:this,name:"labelsClass",index:t})}))}this.context.fill()}},this.drawLabelsList=function(){this.angles[c];for(var t,e,i,s,a,l=S.labels,n=[],o=[],r=this.centerx,h=this.centery,d=this.radius,c=0;c<this.angles.length;++c)RGraph.isNull(this.data[c])||(t=this.angles[c][0]+(this.angles[c][1]-this.angles[c][0])/2,e=RGraph.getRadiusEndPoint(r,h,t,d+5),i=RGraph.getRadiusEndPoint(r,h,t,d+30),s=["number"==typeof S.exploded?S.exploded:S.exploded[c],Math.cos(t)*("number"==typeof S.exploded?S.exploded:S.exploded[c]),Math.sin(t)*("number"==typeof S.exploded?S.exploded:S.exploded[c])],a=RGraph.getTextConf({object:this,prefix:"labels"}),(t>-1*RGraph.HALFPI&&t<RGraph.HALFPI?n:o).push([c,t,l[c]||"",e,i,a.color,RGraph.arrayClone(s)]));for(var g=(this.canvas.height-S.marginTop-S.marginBottom)/n.length,c=0,p=S.marginTop+g/2;c<n.length;p+=g,c++)n[c][2]&&(u=this.centerx+this.radius+50,n[c][0],b=n[c][6][0]?n[c][6][1]:0,f=n[c][6][0]?n[c][6][2]:0,(x=RGraph.text({object:this,font:a.font,size:a.size,color:a.color,bold:a.bold,italic:a.italic,x:u+b+S.labelsListRightOffsetx,y:p+f+S.labelsListRightOffsety,text:n[c][2],valign:"center",halign:"left",tag:"labels",color:n[c][5],cssClass:RGraph.getLabelsCSSClassName({object:this,name:"labelsClass",index:c})}))&&x.node&&(x.node.__index__=n[c][0]),this.path("lc round lw % b m % % qc % % % % s %",S.labelsSticksLinewidth,n[c][3][0]+b,n[c][3][1]+f,n[c][4][0]+b,n[c][4][1]+f,x.x-5,x.y+x.height/2,n[c][5]),this.path("b a % % 2 0 6.2830 false, f %",x.x-5,x.y+x.height/2,n[c][5]));for(var u,b,f,x,y=(this.canvas.height-S.marginTop-S.marginBottom)/o.length,c=o.length-1,p=S.marginTop+y/2;0<=c;p+=y,c--)o[c][2]&&(u=this.centerx-this.radius-50,o[c][0],b=o[c][6][0]?o[c][6][1]:0,f=o[c][6][0]?o[c][6][2]:0,(x=RGraph.text({object:this,font:a.font,size:a.size,color:a.color,bold:a.bold,italic:a.italic,x:u+b+S.labelsListLeftOffsetx,y:p+f+S.labelsListLeftOffsety,text:o[c][2],valign:"center",halign:"right",tag:"labels",cssClass:RGraph.getLabelsCSSClassName({object:this,name:"labelsClass",index:c})}))&&x.node&&(x.node.__index__=o[c][0]),this.path("lw % b m % % qc % % % % s %",S.labelsSticksLinewidth,o[c][3][0]+b,o[c][3][1]+f,o[c][4][0]+b,Math.round(o[c][4][1]+f),x.x+5+x.width,x.y+x.height/2,o[c][5]),this.path("b a % % 2 0 6.2830 false, f %",x.x+5+x.width,x.y+x.height/2,o[c][5]))},this.drawSticks=function(){for(var t=S.linewidth/2,e=S.exploded,i=S.labelsSticks,s=(S.colors,this.centerx),a=this.centery,l=this.radius,n=[],o=S.labelsSticksLinewidth,r=0,h=this.angles.length;r<h;++r){var d,c,g=this.angles[r];"object"==typeof i&&!i[r]||(c=g[1]-g[0],this.context.beginPath(),this.context.strokeStyle="string"==typeof S.labelsSticksColors?S.labelsSticksColors:RGraph.isNull(S.labelsSticksColors)?"gray":S.labelsSticksColors[r],this.context.lineWidth=o,"string"==typeof S.labelsSticksColor&&(this.context.strokeStyle=S.labelsSticksColor),d=g[0]+c/2,g="object"==typeof e&&e[r]?e[r]:"number"==typeof e?e:0,c="object"==typeof S.labelsSticksLength?S.labelsSticksLength[r]:S.labelsSticksLength,n[0]=RGraph.getRadiusEndPoint(s,a,d,l+g+t),n[1]=RGraph.getRadiusEndPoint(s,a,d,l+c+g-5),n[2]=RGraph.getRadiusEndPoint(s,a,d,l+c+g+S.labelsOffsetRadius),n[3]=RGraph.getRadiusEndPoint(s,a,d,l+c+g+S.labelsOffsetRadius),n[3][0]+=n[3][0]>s?5:-5,n[4]=[n[2][0]+(n[2][0]>s?5+S.labelsSticksHlength:-5-S.labelsSticksHlength),n[2][1]],this.context.moveTo(n[0][0],n[0][1]),this.context.quadraticCurveTo(n[2][0],n[2][1],n[4][0],n[4][1]),this.context.stroke(),this.coordsSticks[r]=[n[0],n[1],n[2],n[3],n[4]])}},this.getShape=function(t){this.canvas,this.context;for(var e,i=RGraph.getMouseXY(t),s=i[0],a=i[1],l=(this.radius,this.angles),n=0,o=l.length;n<o;++n)if(this.path("b ss rgba(0,0,0,0) a % % % % % false",l[n][2],l[n][3],this.radius,l[n][0],l[n][1]),"pie"===this.type&&-1!==S.variant.indexOf("donut")?this.path("a % % % % % true",l[n][2],l[n][3],"number"==typeof S.variantDonutWidth?this.radius-S.variantDonutWidth:this.radius/2,l[n][1],l[n][0]):this.path("l % %",l[n][2],l[n][3]),this.path("c"),this.context.isPointInPath(s,a))return l[n][0]<0&&(l[n][0]+=RGraph.TWOPI),l[n][1]>RGraph.TWOPI&&(l[n][1]-=RGraph.TWOPI),RGraph.parseTooltipText&&S.tooltips&&(e=RGraph.parseTooltipText(S.tooltips,n)),{object:this,x:l[n][2],y:l[n][3],radius:this.radius,angleStart:l[n][0],angleEnd:l[n][1],index:n,dataset:0,sequentialIndex:n,label:S.labels&&"string"==typeof S.labels[n]?S.labels[n]:null,tooltip:"string"==typeof e?e:null};return null},this.drawBorders=function(){if(0<S.linewidth){this.context.lineWidth=S.linewidth,this.context.strokeStyle=S.colorsStroke;for(var t=this.radius,e=0,i=this.angles.length;e<i;++e){var s=this.angles[e];this.context.beginPath(),this.context.arc(s[2],s[3],t,s[0],s[0]+.001,0),this.context.arc(s[2],s[3],"donut"==S.variant?"number"==typeof S.variantDonutWidth?this.radius-S.variantDonutWidth:t/2:t,s[0],s[0]+1e-4,0),this.context.closePath(),this.context.stroke()}}},this.getRadius=function(){return this.graph={width:this.canvas.width-S.marginLeft-S.marginRight,height:this.canvas.height-S.marginTop-S.marginBottom},"number"==typeof S.radius?this.radius=S.radius:this.radius=Math.min(this.graph.width,this.graph.height)/2,this.radius},this.explodeSegment=function(t,e){if("number"!=typeof this.exploding||this.exploding!==t){if(S.exploded||(S.exploded=[]),"number"==typeof S.exploded){var i=S.exploded,s=S.exploded;S.exploded=[];for(var a=0,l=this.data.length;a<l;++a)S.exploded[a]=s}S.exploded[t]="number"==typeof i?i:0,this.exploding=t;for(var n=RGraph.ISIE&&!RGraph.ISIE10?25:16.666,o=this,r=0;r<e;++r)setTimeout(function(){S.exploded[t]+=1,RGraph.clear(o.canvas),RGraph.redrawCanvas(o.canvas)},r*n);o=this;setTimeout(function(){o.exploding=null},e*n)}},this.highlight_segment=function(t){this.context.beginPath(),this.context.strokeStyle=S.highlightStyleTwodStroke,this.context.fillStyle=S.highlightStyleTwodFill,this.context.moveTo(t[0],t[1]),this.context.arc(t[0],t[1],t[2],this.angles[t[5]][0],this.angles[t[5]][1],0),this.context.lineTo(t[0],t[1]),this.context.closePath(),this.context.stroke(),this.context.fill()},this.highlight=function(t){if(S.tooltipsHighlight)if("function"==typeof S.highlightStyle)S.highlightStyle(t);else if("invert"===S.highlightStyle)for(var e=0;e<this.angles.length;++e)e!==t.index&&this.path("b lw % m % % a % % % % % false c s % f %",S.highlightStyleTwodLinewidth,this.angles[e][2],this.angles[e][3],this.angles[e][2],this.angles[e][3],t.radius,this.angles[e][0],this.angles[e][1],S.highlightStyleTwodStroke,S.highlightStyleTwodFill);else{var i,s;"3d"==S.highlightStyle?(this.context.lineWidth=1,this.context.beginPath(),RGraph.noShadow(this),this.context.fillStyle="rgba(0,0,0,0)",this.context.arc(t.x,t.y,t.radius,t.angleStart,t.angleEnd,!1),"donut"==S.variant?this.context.arc(t.x,t.y,t.radius/5,t.angleEnd,t.angleStart,!0):this.context.lineTo(t.x,t.y),this.context.closePath(),this.context.fill(),this.context.beginPath(),this.context.shadowColor="#666",this.context.shadowBlur=3,this.context.shadowOffsetX=3,this.context.shadowOffsetY=3,this.context.fillStyle=S.colors[t.index],this.context.strokeStyle=S.colorsStroke,this.context.arc(t.x-2,t.y-2,t.radius,t.angleStart,t.angleEnd,!1),"donut"==S.variant?this.context.arc(t.x-2,t.y-2,t.radius/2,t.angleEnd,t.angleStart,!0):this.context.lineTo(t.x-2,t.y-2),this.context.closePath(),this.context.stroke(),this.context.fill(),RGraph.noShadow(this),S.border&&(this.context.beginPath(),this.context.strokeStyle=S.borderColor,this.context.lineWidth=5,this.context.arc(t.x-2,t.y-2,t.radius-2,t.angleStart,t.angleEnd,!1),this.context.stroke())):"outline"===S.highlightStyle?(s=RGraph.Registry.get("tooltip").__index__,i=this.angles[s],s=this.get("colors")[s],width=this.radius/12.5,"number"==typeof S.highlightStyleOutlineWidth&&(width=S.highlightStyleOutlineWidth),this.path("ga 0.25 b a % % % % % false a % % % % % true c f % ga 1",i[2],i[3],this.radius+2+width,i[0],i[1],i[2],i[3],this.radius+2,i[1],i[0],s)):(this.context.beginPath(),this.context.strokeStyle=S.highlightStyleTwodStroke,this.context.fillStyle=S.highlightStyleTwodFill,-1<S.variant.indexOf("donut")?(this.context.arc(t.x,t.y,t.radius,t.angleStart,t.angleEnd,!1),this.context.arc(t.x,t.y,"number"==typeof S.variantDonutWidth?this.radius-S.variantDonutWidth:t.radius/2,t.angleEnd,t.angleStart,!0)):(this.context.arc(t.x,t.y,t.radius+1,t.angleStart,t.angleEnd,!1),this.context.lineTo(t.x,t.y)),this.context.closePath(),this.context.stroke(),this.context.fill())}},this.getObjectByXY=function(t){if(this.getShape(t))return this},this.drawCenterpin=function(){var t,e;"number"==typeof S.centerpin&&0<S.centerpin&&(t=this.centerx,e=this.centery,this.context.beginPath(),this.context.strokeStyle=S.centerpinStroke||S.colorsStroke,this.context.fillStyle=S.centerpinFill||S.colorsStroke,this.context.moveTo(t,e),this.context.arc(t,e,S.centerpin,0,RGraph.TWOPI,!1),this.context.stroke(),this.context.fill())},this.drawInGraphLabels=function(){this.context,this.centerx,this.centery;var t,e=S.labelsIngraphRadius;radiusFactor=e<=2&&0<e?e:.5,"donut"==S.variant?(t=this.radius*(.5+.5*radiusFactor),"number"==typeof S.variantDonutWidth&&(t=this.radius-S.variantDonutWidth+S.variantDonutWidth/2)):t=this.radius*radiusFactor,2<e&&(t=e);for(var i=0,s=this.angles.length;i<s;++i){o="object"==typeof S.exploded&&"number"==typeof S.exploded[i]?S.exploded[i]:"number"==typeof S.exploded?parseInt(S.exploded):0;var a=this.angles[i][0],l=this.angles[i][1],n=RGraph.getRadiusEndPoint(this.centerx,this.centery,(l-a)/2+a,t+(o||0)+S.labelsIngraphOffsetRadius),l=n[0],a=n[1],o=S.labelsIngraphSpecific&&"string"==typeof S.labelsIngraphSpecific[i]?S.labelsIngraphSpecific[i]:RGraph.numberFormat({object:this,number:this.data[i].toFixed(S.labelsIngraphDecimals),unitspre:S.labelsIngraphUnitsPre,unitspost:S.labelsIngraphUnitsPost,point:S.labelsIngraphPoint,thousand:S.labelsIngraphThousand});o&&(this.context.beginPath(),n=RGraph.getTextConf({object:this,prefix:"labelsIngraph"}),RGraph.text({object:this,font:n.font,size:n.size,color:n.color,bold:n.bold,italic:n.italic,x:l,y:a,text:o,valign:"center",halign:"center",bounding:S.labelsIngraphBounding,boundingFill:S.labelsIngraphBoundingFill,boundingStroke:S.labelsIngraphBoundingStroke,tag:"labels.ingraph"}),this.context.stroke())}},this.drawCenterLabel=function(t){var e=RGraph.getTextConf({object:this,prefix:"labelsCenter"});RGraph.text({object:this,font:e.font,size:e.size,color:e.color,bold:e.bold,italic:e.italic,x:this.centerx+S.labelsCenterOffsetx,y:this.centery+S.labelsCenterOffsety,halign:"center",valign:"center",text:t,bounding:!0,boundingFill:"rgba(255,255,255,0.7)",boundingStroke:"rgba(0,0,0,0)",tag:"labels.center"})},this.getAngle=function(t){if(t>this.total)return null;t=t/this.total*RGraph.TWOPI;return t+=S.origin},this.parseColors=function(){0===this.original_colors.length&&(this.original_colors.colors=RGraph.arrayClone(S.colors),this.original_colors.keyColors=RGraph.arrayClone(S.keyColors),this.original_colors.colorsStroke=RGraph.arrayClone(S.colorsStroke),this.original_colors.highlightStroke=RGraph.arrayClone(S.highlightStroke),this.original_colors.highlightStyleTwodFill=RGraph.arrayClone(S.highlightStyleTwodFill),this.original_colors.highlightStyleTwodStroke=RGraph.arrayClone(S.highlightStyleTwodStroke),this.original_colors.labelsIngraphBoundingFill=RGraph.arrayClone(S.labelsIngraphBoundingFill),this.original_colors.labelsIngraphColor=RGraph.arrayClone(S.labelsIngraphColor));for(var t=0;t<S.colors.length;++t)S.colors[t]=this.parseSingleColorForGradient(S.colors[t]);var e=S.keyColors;if(e)for(t=0;t<e.length;++t)e[t]=this.parseSingleColorForGradient(e[t]);S.colorsStroke=this.parseSingleColorForGradient(S.colorsStroke),S.highlightStroke=this.parseSingleColorForGradient(S.highlightStroke),S.highlightStyleTwodFill=this.parseSingleColorForGradient(S.highlightStyleTwodFill),S.highlightStyleTwodStroke=this.parseSingleColorForGradient(S.highlightStyleTwodStroke),S.labelsIngraphBoundingFill=this.parseSingleColorForGradient(S.labelsIngraphBoundingFill),S.labelsIngraphColor=this.parseSingleColorForGradient(S.labelsIngraphColor)},this.reset=function(){},this.parseSingleColorForGradient=function(t){if(!t||"string"!=typeof t)return t;if(t.match(/^gradient\((.*)\)$/i)){if(t.match(/^gradient\(({.*})\)$/i))return RGraph.parseJSONGradient({object:this,def:RegExp.$1});var e,i=RegExp.$1.split(":");e="donut"==S.variant?"number"==typeof S.variantDonutWidth?this.radius-S.variantDonutWidth:this.radius/2:0;var s=this.context.createRadialGradient(this.centerx,this.centery,e,this.centerx,this.centery,Math.min(this.canvas.width-S.marginLeft-S.marginRight,this.canvas.height-S.marginTop-S.marginBottom)/2),a=1/(i.length-1);s.addColorStop(0,RGraph.trim(i[0]));for(var l=1;l<i.length;++l)s.addColorStop(l*a,RGraph.trim(i[l]))}return s||t},this.interactiveKeyHighlight=function(t){var e,i,s;this.angles&&this.angles[t]&&(e=(s=this.angles[t])[2],i=s[3],t=s[0],s=s[1],this.context.strokeStyle=S.keyInteractiveHighlightChartStroke,this.context.fillStyle=S.keyInteractiveHighlightChartFill,this.context.lineWidth=2,this.context.lineJoin="bevel",this.context.beginPath(),this.context.moveTo(e,i),this.context.arc(e,i,this.radius,t,s,!1),this.context.closePath(),this.context.fill(),this.context.stroke())},this.on=function(t,e){return"function"!=typeof this[t="on"!==t.substr(0,2)?"on"+t:t]?this[t]=e:RGraph.addCustomEventListener(this,t,e),this},this.firstDrawFunc=function(){},this.draw3d=function(){var t=S.variantThreedDepth,e=S.shadow,i=S.labels,s=S.labelsSticks;this.set({labels:[],labelsSticks:!1,strokestyle:"rgba(0,0,0,0)"}),this.set({variant:this.get("variant").replace(/3d/,"")}),this.context.setTransform(1.5,0,0,1,-.5*(1.5*this.canvas.width-this.canvas.width),0);for(var a=t;0<a;--a)if(this.set({centeryAdjust:a}),a===parseInt(t/2)&&this.set({labels:i,labelsSticks:s}),0===a&&this.set({shadow:e}),this.draw(),this.set("shadow",!1),a<=parseInt(t/2)&&this.set({labels:[],labelsSticks:!1}),1<a)if(-1!==S.variant.indexOf("donut"))for(var l=0;l<this.angles.length;++l){var n=this.angles[l][2],o=this.angles[l][3],r=this.radius,h=this.radius/2,d=this.angles[l][0],c=this.angles[l][1];this.path("b a % % % % % false a % % % % % true f rgba(0,0,0,0.15)",n,o,r,d,c,n,o,h,c,d)}else for(l=0;l<this.angles.length;++l){n=this.angles[l][2],o=this.angles[l][3],r=this.radius,h=this.radius/2,d=this.angles[l][0],c=this.angles[l][1];this.path("b m % % a % % % % % false f rgba(0,0,0,0.15)",n,o,n,o,r+1,d,c)}return this.set({variant:this.get("variant")+"3d",shadow:e,labels:i,labelsSticks:s}),this},this.explode=function(){var t=this,e=arguments[0]||{},i=arguments[1]||function(){},s=e.frames||30,a=0,e=Number("number"==typeof e.radius?e.radius:Math.max(this.canvas.width,this.canvas.height)),l=Number(t.get("exploded"))||0,n=(e-l)/s;this.set("labels",null);var o=function(){t.set("exploded",l+n*a),RGraph.clear(t.canvas),RGraph.redrawCanvas(t.canvas),a++<s?RGraph.Effects.updateCanvas(o):i(t)};return o(),this},this.grow=function(){var t=this,e=t.canvas,i=(arguments[0]||{}).frames||30,s=0,a=arguments[1]||function(){},l=t.getRadius();S.radius=0;var n=function(){t.set("radius",s/i*l),RGraph.redrawCanvas(e),s++<i?RGraph.Effects.updateCanvas(n):(RGraph.redrawCanvas(t.canvas),a(t))};return n(),this},this.roundrobin=this.roundRobin=function(){var t=this,e=arguments[0]||{},i=arguments[1]||function(){},s=0,a=e.frames||30,l=(t.getRadius(),t.get("labels"));t.set("events",!1),t.set("labels",[]);var n=function(){t.set("effectRoundrobinMultiplier",RGraph.Effects.getEasingMultiplier(a,s)),RGraph.redrawCanvas(t.canvas),s<a?(RGraph.Effects.updateCanvas(n),s++):(t.set({events:!0,labels:l}),RGraph.redrawCanvas(t.canvas),i(t))};return n(),this},this.implode=function(){var e=this,t=arguments[0]||{},i=arguments[1]||function(){},s=t.frames||30,a=0,l=Math.max(this.canvas.width,this.canvas.height),n=l;return function t(){n=l-a/s*l,e.set("exploded",n),RGraph.clear(e.canvas),RGraph.redrawCanvas(e.canvas),a++<s?RGraph.Effects.updateCanvas(t):(RGraph.clear(e.canvas),RGraph.redrawCanvas(e.canvas),i(e))}(),this},this.tooltipSubstitutions=function(t){return{index:t.index,dataset:0,sequentialIndex:t.index,value:this.data[t.index],values:[this.data[t.index]]}},this.tooltipsFormattedCustom=function(t,e,i){return{color:i[t.index],label:"object"==typeof S.tooltipsFormattedKeyLabels&&"string"==typeof S.tooltipsFormattedKeyLabels[t.index]?S.tooltipsFormattedKeyLabels[t.index]:""}},this.positionTooltipStatic=function(t){var e,i=t.object,s=(t.event,t.tooltip),a=t.index,l=RGraph.getCanvasXY(i.canvas);segment=this.angles[t.index],angle=(segment[1]-segment[0])/2+segment[0],multiplier=.5,e=0<=S.variant.indexOf("donut")?RGraph.isNull(S.variantDonutWidth)?this.radius/2+this.radius/4:this.radius-S.variantDonutWidth+S.variantDonutWidth/2:this.radius*multiplier;a="number"==typeof S.exploded?S.exploded:S.exploded[a],a=RGraph.getRadiusEndPoint(this.centerx,this.centery,angle,e+(a||0));0<S.variant.indexOf("3d")&&("number"===S.variantDonutWidth?S.variantDonutWidth:this.radius,a[0]=1.5*(a[0]-this.centerx)+this.centerx),t.tooltip.style.left=l[0]+a[0]-s.offsetWidth/2+i.properties.tooltipsOffsetx+"px",t.tooltip.style.top=l[1]+a[1]-s.offsetHeight+i.properties.tooltipsOffsety-10+"px"},RGraph.register(this),RGraph.parseObjectStyleConfig(this,t.options)};
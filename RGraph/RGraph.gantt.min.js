RGraph=window.RGraph||{isrgraph:!0,isRGraph:!0,rgraph:!0},RGraph.Gantt=function(t){var a=t.id,i=document.getElementById(a),s=t.data;if(this.id=a,this.canvas=i,this.context=this.canvas.getContext?this.canvas.getContext("2d",{alpha:"object"!=typeof a||!1!==a.alpha}):null,(this.canvas.__object__=this).type="gantt",this.isRGraph=!0,this.isrgraph=!0,this.rgraph=!0,this.uid=RGraph.createUID(),this.canvas.uid=this.canvas.uid||RGraph.createUID(),this.data=s,this.colorsParsed=!1,this.coordsText=[],this.original_colors=[],this.firstDraw=!0,this.properties={backgroundBarsCount:null,backgroundBarsColor1:"rgba(0,0,0,0)",backgroundBarsColor2:"rgba(0,0,0,0)",backgroundGrid:!0,backgroundGridLinewidth:1,backgroundGridColor:"#ddd",backgroundGridHsize:20,backgroundGridVsize:20,backgroundGridHlines:!0,backgroundGridVlines:!0,backgroundGridBorder:!0,backgroundGridAlign:!0,backgroundGridAutofit:!0,backgroundGridAutofitAlign:!0,backgroundGridHlinesCount:null,backgroundGridVlinesCount:null,backgroundVbars:[],backgroundHbars:[],textSize:12,textFont:"Arial, Verdana, sans-serif",textColor:"black",textBold:!1,textItalic:!1,textAccessible:!0,textAccessibleOverflow:"visible",textAccessiblePointerevents:!1,text:null,marginLeft:75,marginRight:35,marginTop:35,marginBottom:35,marginInner:2,labelsInbar:null,labelsInbarBgcolor:null,labelsInbarAlign:"left",labelsInbarSize:null,labelsInbarFont:null,labelsInbarColor:null,labelsInbarBold:null,labelsInbarItalic:null,labelsInbarAbove:!1,labelsInbarOffsetx:0,labelsInbarOffsety:0,labelsComplete:!0,labelsCompleteFont:null,labelsCompleteSize:null,labelsCompleteColor:null,labelsCompleteBold:null,labelsCompleteItalic:null,labelsCompleteOffsetx:0,labelsCompleteOffsety:0,title:"",titleBackground:null,titleX:null,titleY:null,titleBold:null,titleItalic:null,titleFont:null,titleSize:null,titleColor:null,titleHalign:null,titleValign:null,titleOffsetx:0,titleOffsety:0,xaxis:!1,xaxisLinewidth:1,xaxisColor:"black",xaxisTickmarks:!0,xaxisTickmarksLength:3,xaxisTickmarksLastLeft:null,xaxisTickmarksLastRight:null,xaxisTickmarksCount:null,xaxisLabels:null,xaxisLabelsSize:null,xaxisLabelsFont:null,xaxisLabelsItalic:null,xaxisLabelsBold:null,xaxisLabelsColor:null,xaxisLabelsOffsetx:0,xaxisLabelsOffsety:0,xaxisLabelsHalign:null,xaxisLabelsValign:null,xaxisLabelsPosition:"section",xaxisPosition:"bottom",xaxisLabelsAngle:0,xaxisTitle:null,xaxisTitleBold:null,xaxisTitleSize:null,xaxisTitleFont:null,xaxisTitleColor:null,xaxisTitleItalic:null,xaxisTitlePos:null,xaxisTitleOffsetx:0,xaxisTitleOffsety:0,xaxisTitleX:null,xaxisTitleY:null,xaxisTitleHalign:null,xaxisTitleValign:null,xaxisScaleMin:0,xaxisScaleMax:0,yaxis:!1,yaxisColor:"black",yaxisLinewidth:1,yaxisTickmarks:!1,yaxisTickmarksLength:null,yaxisTickmarksCount:null,yaxisTickmarksLastTop:null,yaxisTickmarksLastBottom:null,yaxisScale:!1,yaxisLabelsPosition:"section",yaxisLabels:null,yaxisLabelsFont:null,yaxisLabelsSize:null,yaxisLabelsColor:null,yaxisLabelsBold:null,yaxisLabelsItalic:null,yaxisLabelsOffsety:0,yaxisLabelsOffsetx:0,yaxisLabelsValign:"center",yaxisLabelsHalign:"right",yaxisTitle:"",yaxisTitleBold:null,yaxisTitleItalic:null,yaxisTitleFont:null,yaxisTitleSize:null,yaxisTitleColor:null,yaxisTitlePos:null,yaxisTitleOffsetx:null,yaxisTitleOffsety:null,yaxisTitleX:null,yaxisTitleY:null,yaxisTitleHalign:null,yaxisTitleValign:null,yaxisTitleAccessible:null,colorsDefault:"white",borders:!0,coords:[],tooltips:null,tooltipsEffect:"slide",tooltipsCssClass:"RGraph_tooltip",tooltipsCss:null,tooltipsHighlight:!0,tooltipsEvent:"click",tooltipsFormattedThousand:",",tooltipsFormattedPoint:".",tooltipsFormattedDecimals:0,tooltipsFormattedUnitsPre:"",tooltipsFormattedUnitsPost:"",tooltipsFormattedTableHeaders:null,tooltipsFormattedTableData:null,tooltipsPointer:!0,tooltipsPositionStatic:!0,highlightStroke:"rgba(0,0,0,0)",highlightFill:"rgba(255,255,255,0.7)",contextmenu:null,annotatable:!1,annotatableColor:"black",annotatableLinewidth:1,adjustable:!1,adjustableOnly:null,clearto:"rgba(0,0,0,0)"},s)for(var n=0,r=0;n<s.length;++n)"string"==typeof s[n].start&&(s[n].start=parseFloat(s[n].start)),"string"==typeof s[n].duration&&(s[n].duration=parseFloat(s[n].duration)),"string"==typeof s[n].complete&&(s[n].complete=parseFloat(s[n].complete)),"string"==typeof s[n].linewidth&&(s[n].linewidth=parseFloat(s[n].linewidth));else alert("[GANTT] The Gantt chart event data is now supplied as the second argument to the constructor - please update your code");this.properties.yaxisLabels=[];for(n=0,r=0;n<s.length;++n)if(RGraph.isArray(this.data[n]))for(var e=0;e<this.data[n].length;++e)this.data[n][e].index=e,this.data[n][e].dataset=n,this["$"+r++]=this.data[n][e],this.data[n][e].label&&(this.properties.yaxisLabels[n]=this.data[n][e].label);else this.data[n].index=0,this.data[n].dataset=n,this["$"+r++]=this.data[n],this.properties.yaxisLabels[n]=this.data[n].label;var u=this.properties;this.path=RGraph.pathObjectFunction,RGraph.Effects&&"function"==typeof RGraph.Effects.decorate&&RGraph.Effects.decorate(this),this.responsive=RGraph.responsive,this.set=function(t){var a=void 0===arguments[1]?null:arguments[1];if(1!==arguments.length||"object"!=typeof t)return u[t]=a,this;for(n in t)"string"==typeof n&&this.set(n,t[n]);return this},this.get=function(t){return u[t]},this.draw=function(){RGraph.fireCustomEvent(this,"onbeforedraw"),this.canvas.__rgraph_aa_translated__||(this.context.translate(.5,.5),this.canvas.__rgraph_aa_translated__=!0),this.marginLeft=u.marginLeft,this.marginRight=u.marginRight,this.marginTop=u.marginTop,this.marginBottom=u.marginBottom,this.coordsText=[],this.colorsParsed||(this.parseColors(),this.colorsParsed=!0),this.graphArea=this.canvas.width-this.marginLeft-this.marginRight,this.graphHeight=this.canvas.height-this.marginTop-this.marginBottom,this.numEvents=this.data.length,this.barHeight=this.graphHeight/this.numEvents,this.halfBarHeight=this.barHeight/2,RGraph.isNull(u.backgroundGridHlinesCount)&&this.set("backgroundGridHlinesCount",this.data.length),u.yaxisLabelsSpecific=[];for(var t=0;t<this.data.length;++t)"object"==typeof this.data[t]&&"object"==typeof this.data[t][0]?u.yaxisLabelsSpecific.push(this.data[t][0].label):u.yaxisLabelsSpecific.push(this.data[t].label);return u.yaxisLabels=u.yaxisLabelsSpecific,RGraph.Background.draw(this),this.drawLabels(),this.drawEvents(),u.contextmenu&&RGraph.showContext(this),RGraph.addCustomText(this),RGraph.installEventListeners(this),this.firstDraw&&(this.firstDraw=!1,RGraph.fireCustomEvent(this,"onfirstdraw"),this.firstDrawFunc()),RGraph.fireCustomEvent(this,"ondraw"),this},this.exec=function(t){return t(this),this},this.drawLabels=function(){RGraph.drawXAxis(this),RGraph.drawYAxis(this)},this.drawEvents=function(){var t=this.data;if(this.coords=[],u.backgroundVbars)for(n=0,len=u.backgroundVbars.length;n<len;++n){u.backgroundVbars[n][0]+u.backgroundVbars[n][1]>u.xaxisScaleMax&&(u.backgroundVbars[n][1]=364-u.backgroundVbars[n][0]);var a=this.marginLeft+(u.backgroundVbars[n][0]-u.xaxisScaleMin)/(u.xaxisScaleMax-u.xaxisScaleMin)*this.graphArea,i=this.marginTop,s=this.graphArea/(u.xaxisScaleMax-u.xaxisScaleMin)*u.backgroundVbars[n][1],r=this.canvas.height-this.marginTop-this.marginBottom;a+s>this.canvas.width-this.marginRight&&(s=this.canvas.width-this.marginRight-a),this.context.fillStyle=u.backgroundVbars[n][2],this.context.fillRect(a,i,s,r)}if(u.backgroundHbars)for(n=0,len=u.backgroundHbars.length;n<len;++n)u.backgroundHbars[n]&&(a=this.marginLeft,i=(this.canvas.height-this.marginTop-this.marginBottom)/this.data.length*n+this.marginTop,s=this.graphArea,r=this.barHeight,this.context.fillStyle=u.backgroundHbars[n],this.context.fillRect(a,i,s,r));var e=0;for(n=0;n<t.length;++n)if("number"==typeof t[n].start)this.drawSingleEvent(t[n],n,e++);else for(var l=0;l<t[n].length;++l){var o=l;this.drawSingleEvent(t[n][l],n,e++,o)}},this.getShape=function(t){for(var t=RGraph.getMouseXY(t),a=t[0],i=t[1],s=0,r=this.coords.length;s<r;s++){var e,l=this.coords[s][0],o=this.coords[s][1],n=this.coords[s][2],h=this.coords[s][3];if(l<=a&&a<=l+n&&o<=i&&i<=o+h){RGraph.parseTooltipText&&u.tooltips&&(e=RGraph.parseTooltipText(u.tooltips,s));var d=this.coords[s][4].dataset,c=this.coords[s][4]&&"number"==typeof this.coords[s][4].index?this.coords[s][4].index:0,g=this.coords[s][4].label;return{object:this,x:l,y:o,width:n,height:h,dataset:d,index:c,sequentialIndex:this.coords[s][5],label:g,tooltip:"string"==typeof e?e:null}}}},this.drawSingleEvent=function(t,a,i){t.dataset=a,"number"==typeof arguments[3]&&(t.index=arguments[3]);var s=u.xaxisScaleMin;this.context.beginPath(),this.context.strokeStyle="black",this.context.fillStyle=t.color||u.colorsDefault;var r=this.marginLeft+(t.start-s)/(u.xaxisScaleMax-s)*this.graphArea,e=this.marginTop+a*this.barHeight,l=t.duration/(u.xaxisScaleMax-s)*this.graphArea;r+l>this.canvas.width-this.marginRight&&(l=this.canvas.width-this.marginRight-r),this.coords.push([r,e+u.marginInner,l,this.barHeight-2*u.marginInner,t,i]),!u.borders&&"number"!=typeof t.border||(this.context.strokeStyle="string"==typeof t.border?t.border:"black",this.context.lineWidth="number"==typeof t.linewidth?t.linewidth:1,0!==t.linewidth&&this.context.strokeRect(r,e+u.marginInner,l,this.barHeight-2*u.marginInner)),RGraph.isNull(t.complete)?this.context.fillStyle=t.color||u.colorsDefault:this.context.fillStyle=t.background||u.colorsDefault,this.context.fillRect(r,e+u.marginInner,l,this.barHeight-2*u.marginInner);var o,n,h;t.complete;"number"==typeof t.complete&&(this.context.fillStyle=t.color||"#0c0",this.context.fillRect(r,e+u.marginInner,t.complete/100*l,this.barHeight-2*u.marginInner),u.labelsComplete&&(this.context.beginPath(),h=RGraph.getTextConf({object:this,prefix:"labelsComplete"}),RGraph.text({object:this,font:h.font,size:h.size,color:h.color,bold:h.bold,italic:h.italic,x:r+l+5+u.labelsCompleteOffsetx,y:e+this.halfBarHeight+u.labelsCompleteOffsety,text:String(t.complete)+"%",valign:"center",tag:"labels.complete"}))),u.labelsInbar&&u.labelsInbar[i]&&(o=String(u.labelsInbar[i]),n="left"==u.labelsInbarAlign?"left":"center",s="right"==(n="right"==u.labelsInbarAlign?"right":n)?r+l-5:"center"==n?r+l/2:r+5,u.labelsInbarAbove&&(s=r+l+5,n="left"),h=RGraph.getTextConf({object:this,prefix:"labelsInbar"}),this.context.fillStyle=u.labelsInbarColor,RGraph.text({object:this,font:h.font,size:h.size,color:h.color,bold:h.bold,italic:h.italic,x:s+u.labelsInbarOffsetx,y:e+this.halfBarHeight+u.labelsInbarOffsety,text:o,valign:"center",halign:n,bounding:"string"==typeof u.labelsInbarBgcolor,boundingFill:"string"==typeof u.labelsInbarBgcolor?u.labelsInbarBgcolor:null,tag:"labels.inbar"}))},this.highlight=function(t){if("string"!=typeof u.highlightStyle||"invert"!==u.highlightStyle)"function"==typeof u.highlightStyle?u.highlightStyle(t):RGraph.Highlight.rect(this,t);else for(var a=0;a<this.coords.length;++a)a!==t.sequentialIndex&&this.path("b r % % % % s % f %",this.coords[a][0]-.5,this.coords[a][1]-.5,this.coords[a][2]+1,this.coords[a][3]+1,u.highlightStroke,u.highlightFill)},this.getObjectByXY=function(t){t=RGraph.getMouseXY(t);if(t[0]>this.marginLeft&&t[0]<this.canvas.width-this.marginRight&&t[1]>this.marginTop&&t[1]<this.canvas.height-this.marginBottom)return this},this.adjusting_mousemove=function(t){var a,i,s,r,e,l,o,n;u.adjustable&&RGraph.Registry.get("adjusting")&&RGraph.Registry.get("adjusting").uid==this.uid&&((a=RGraph.Registry.get("adjusting.gantt"))&&(i=RGraph.getMouseXY(t),s=a.object,l=a.dataset,o=a.index,n=(i[0]-a.mousex)/(s.canvas.width-s.marginLeft-s.marginRight)*u.xaxisScaleMax,r=a.event_start||0,e=a.event_duration,t="object"==typeof s.data[l][o]?s.data[l][o]:s.data[l],"move"===a.mode?(n=Math.round(n),RGraph.isArray(s.data[l])?(l=a.dataset,o="number"==typeof a.index?a.index:0,(t=s.data[l][o]).start=r+n,r+n<0?t.start=0:r+n+t.duration>u.xaxisScaleMax&&(t.start=u.xaxisScaleMax-t.duration)):(t.start=r+n,r+n<0?s.data[l].start=0:r+n+s.data[l].duration>u.xaxisScaleMax&&(s.data[l].start=u.xaxisScaleMax-s.data[l].duration))):"resize"==a.mode&&(i[0]>s.canvas.width-s.marginRight&&(i[0]=s.canvas.width-s.marginRight),n=(i[0]-RGraph.Registry.get("adjusting.gantt").mousex)/(s.canvas.width-s.marginLeft-s.marginRight)*u.xaxisScaleMax,n=Math.round(n),RGraph.isArray(s.data[l])?(s.data[l][o].duration=e+n,s.data[l][o].duration<=0&&(s.data[l][o].duration=1)):(s.data[l].duration=e+n,s.data[l].duration<0&&(s.data[l].duration=1))),RGraph.resetColorsToOriginalValues(s),RGraph.redrawCanvas(s.canvas),RGraph.fireCustomEvent(s,"onadjust")))},this.getXCoord=function(t){var a=u.xaxisScaleMin,i=u.xaxisScaleMax,s=this.canvas.width-this.marginLeft-this.marginRight;return i<t||t<a?null:(t-a)/(i-a)*s+this.marginLeft},this.getValue=function(t){var a,t=(a=2==t.length?t:RGraph.getMouseXY(t))[0],t=(a[1],(t-this.marginLeft)/(this.canvas.width-this.marginLeft-this.marginRight));return t=(t*=u.xaxisScaleMax-u.xaxisScaleMin)<u.xaxisScaleMin||t>u.xaxisScaleMax?null:t},this.parseColors=function(){0===this.original_colors.length&&(this.original_colors.data=RGraph.arrayClone(this.data),this.original_colors.backgroundBarsColor1=RGraph.arrayClone(u.backgroundBarsColor1),this.original_colors.backgroundBarsColor2=RGraph.arrayClone(u.backgroundBarsColor2),this.original_colors.backgroundGridColor=RGraph.arrayClone(u.backgroundGridColor),this.original_colors.colorsDefault=RGraph.arrayClone(u.colorsDefault),this.original_colors.highlightStroke=RGraph.arrayClone(u.highlightStroke),this.original_colors.highlightFill=RGraph.arrayClone(u.highlightFill));for(var t=0;t<this.data.length;++t)if(RGraph.isArray(this.data[t])&&"object"==typeof this.data[t][0]&&"number"==typeof this.data[t][0].start)for(var a=0,i=this.data[t].length;a<i;a+=1,0)this.data[t][a].background=this.parseSingleColorForGradient(this.data[t][a].background,{start:this.data[t][a].start,duration:this.data[t][a].duration}),this.data[t][a].color=this.parseSingleColorForGradient(this.data[t][a].color,{start:this.data[t][a].start,duration:this.data[t][a].duration});else"string"==typeof this.data[t].background&&(this.data[t].background=this.parseSingleColorForGradient(this.data[t].background,{start:this.data[t].start,duration:this.data[t].duration})),"string"==typeof this.data[t].color&&(this.data[t].color=this.parseSingleColorForGradient(this.data[t].color,{start:this.data[t].start,duration:this.data[t].duration})),0;u.backgroundBarsColor1=this.parseSingleColorForGradient(u.backgroundBarsColor1),u.backgroundBarsColor2=this.parseSingleColorForGradient(u.backgroundBarsColor2),u.backgroundGridColor=this.parseSingleColorForGradient(u.backgroundGridColor),u.backgroundColor=this.parseSingleColorForGradient(u.backgroundColor),u.colorsDefault=this.parseSingleColorForGradient(u.colorsDefault),u.highlightStroke=this.parseSingleColorForGradient(u.highlightStroke),u.highlightFill=this.parseSingleColorForGradient(u.highlightFill)},this.reset=function(){},this.parseSingleColorForGradient=function(t){var a=arguments[1]||{};if(!t||"string"!=typeof t)return t;if(t.match(/^gradient\((.*)\)$/i)){if(t.match(/^gradient\(({.*})\)$/i))return RGraph.parseJSONGradient({object:this,def:RegExp.$1});var i=RegExp.$1.split(":"),s=a.start+a.duration>u.xaxisScaleMax?u.xaxisScaleMax:a.start+a.duration,r=this.context.createLinearGradient("number"==typeof a.start?this.getXCoord(a.start):this.marginLeft,0,"number"==typeof a.start?this.getXCoord(s):this.canvas.width-this.marginRight,0),e=1/(i.length-1);r.addColorStop(0,RGraph.trim(i[0]));for(var l=1;l<i.length;++l)r.addColorStop(l*e,RGraph.trim(i[l]))}return r||t},this.on=function(t,a){return"function"!=typeof this[t="on"!==t.substr(0,2)?"on"+t:t]?this[t]=a:RGraph.addCustomEventListener(this,t,a),this},this.firstDrawFunc=function(){},this.grow=function(){var r=this,t=arguments[0]||{},e=arguments[1]||function(){},l=(r.canvas,r.context,t.frames||30),o=0;return original_events=RGraph.arrayClone(r.data),function t(){if(RGraph.clear(r.canvas),RGraph.redrawCanvas(r.canvas),o<=l){for(var a=0,i=r.data.length;a<i;++a)if("object"==typeof r.data[a]&&r.data[a][0]&&"object"==typeof r.data[a][0])for(var s=0;s<r.data[a].length;++s)r.data[a][s].duration=o/l*original_events[a][s].duration;else r.data[a].duration=o/l*original_events[a].duration;r.reset(),o++,RGraph.Effects.updateCanvas(t)}else e(r)}(),this},this.resetColorsToOriginalValues=function(){for(var t=0;t<this.original_colors.data.length;++t)if(this.original_colors.data[t].background&&(this.data[t].background=RGraph.arrayClone(this.original_colors.data[t].background)),this.original_colors.data[t].color&&(this.data[t].color=RGraph.arrayClone(this.original_colors.data[t].color)),"object"==typeof this.original_colors.data[t][0]&&"number"==typeof this.original_colors.data[t][0].start)for(var a=0,i=this.original_colors.data[t].length;a<i;++a)this.data[t][a].background=RGraph.arrayClone(this.original_colors.data[t][a].background),this.data[t][a].color=RGraph.arrayClone(this.original_colors.data[t][a].color)},this.reset=function(){this.resetColorsToOriginalValues(),this.colorsParsed=!1,this.coordsText=[],this.original_colors=[],this.firstDraw=!0,this.coords=[]},this.sequentialIndex2Grouped=function(){alert("[RGRAPH] Something went badly wrong - contact support")},this.isAdjustable=function(t){return!!RGraph.isNull(u.adjustableOnly)||!!(RGraph.isArray(u.adjustableOnly)&&t&&u.adjustableOnly[t.sequentialIndex])},this.tooltipSubstitutions=function(t){var a=this["$"+t.index],i={start:a.start,duration:a.duration,complete:a.complete};return{index:a.index,dataset:a.dataset,sequentialIndex:t.index,value:i}},this.tooltipsFormattedCustom=function(t,a){return{}},this.positionTooltipStatic=function(t){var a=t.object,i=(t.event,t.tooltip),s=(t.index,RGraph.getCanvasXY(a.canvas));coords=this.coords[t.index],t.tooltip.style.left=s[0]+coords[0]+coords[2]/2-i.offsetWidth/2+a.properties.tooltipsOffsetx+"px",t.tooltip.style.top=s[1]+coords[1]-i.offsetHeight-10+a.properties.tooltipsOffsety+"px",parseFloat(t.tooltip.style.top)<0&&(t.tooltip.style.top=parseFloat(t.tooltip.style.top)+coords[3]/2+5+"px")},RGraph.register(this),RGraph.parseObjectStyleConfig(this,t.options)};
RGraph=window.RGraph||{isrgraph:!0,isRGraph:!0,rgraph:!0},RGraph.SVG=RGraph.SVG||{},window,document,RGraph.SVG.Activity=function(t){this.set=function(t,e){if(1===arguments.length&&"object"==typeof t)for(i in arguments[0])"string"==typeof i&&(t=r.name,e=r.value,this.set(t,e));else{var r=RGraph.SVG.commonSetter({object:this,name:t,value:e});t=r.name,e=r.value,this.properties[t]=e}return this},this.get=function(t){return this.properties[t]},this.min=RGraph.SVG.stringsToNumbers(t.min),this.max=RGraph.SVG.stringsToNumbers(t.max),this.value=RGraph.SVG.stringsToNumbers(t.value),this.currentValue=null,this.id=t.id,this.uid=RGraph.SVG.createUID(),this.container=document.getElementById(this.id),this.layers={},this.svg=RGraph.SVG.createSVG({object:this,container:this.container}),this.isRGraph=!0,this.isrgraph=!0,this.rgraph=!0,this.width=Number(this.svg.getAttribute("width")),this.height=Number(this.svg.getAttribute("height")),this.type="activity",this.colorsParsed=!1,this.originalColors={},this.gradientCounter=1,this.adjusting_index=null,this.nodes={},this.firstDraw=!0,RGraph.SVG.OR.add(this),this.container.style.display="inline-block",this.properties={radius:null,centerx:null,centery:null,width:null,ends:"round",marginLeft:15,marginRight:15,marginTop:15,marginBottom:15,marginInner:1,backgroundColor:"black",backgroundGrid:!1,backgroundGridColor:"#ddd",backgroundGridRadials:!0,backgroundGridRadialsCount:8,backgroundRings:!0,backgroundRingsColors:null,backgroundRingsAlpha:.5,colors:["#F45B5B","#90EE7E","#2B908F","red","green","blue","yellow","pink"],icons:null,iconsWidth:null,iconsHeight:null,iconsOffsetx:0,iconsOffsety:0,textFont:"Arial, Verdana, sans-serif",textSize:12,textColor:"#aaa",textBold:!1,textItalic:!1,text:null,labelsCenter:!1,labelsCenterIndex:0,labelsCenterFont:null,labelsCenterSize:40,labelsCenterColor:null,labelsCenterBold:null,labelsCenterItalic:null,labelsCenterUnitsPre:"",labelsCenterUnitsPost:"",labelsCenterDecimals:0,labelsCenterPoint:".",labelsCenterThousand:",",labelsCenterSpecific:null,labelsCenterHalign:"center",labelsCenterValign:"center",labelsCenterOffsetx:0,labelsCenterOffsety:0,labels:[],labelsColor:null,labelsFont:null,labelsSize:null,labelsBold:null,labelsItalic:null,labelsBackgroundFill:"transparent",labelsBackgroundStroke:"transparent",labelsHalign:"right",labelsValign:"center",labelsOffsetx:0,labelsOffsety:0,labelsFormattedDecimals:0,labelsFormattedPoint:".",labelsFormattedThousand:",",labelsFormattedUnitsPre:"",labelsFormattedUnitsPost:"",adjustable:!1,tooltips:null,tooltipsOverride:null,tooltipsEffect:"fade",tooltipsCssClass:"RGraph_tooltip",tooltipsCss:null,tooltipsEvent:"click",tooltipsFormattedThousand:",",tooltipsFormattedPoint:".",tooltipsFormattedDecimals:0,tooltipsFormattedUnitsPre:"",tooltipsFormattedUnitsPost:"",tooltipsFormattedKeyColors:null,tooltipsFormattedKeyColorsShape:"square",tooltipsFormattedKeyLabels:[],tooltipsFormattedTableHeaders:null,tooltipsFormattedTableData:null,tooltipsPointer:!0,tooltipsPositionStatic:!0,highlightStroke:"rgba(0,0,0,0)",highlightFill:"rgba(255,255,255,0.7)",highlightLinewidth:1},RGraph.SVG.getGlobals(this),RGraph.SVG.FX&&"function"==typeof RGraph.SVG.FX.decorate&&RGraph.SVG.FX.decorate(this),this.responsive=RGraph.SVG.responsive;var l=this.properties;for(i in this.draw=function(){RGraph.SVG.fireCustomEvent(this,"onbeforedraw"),"number"==typeof this.value&&(this.value=[this.value]);for(var e,t=0;t<this.value.length;++t)this.value[t]>this.max&&(this.value[t]=this.max),this.value[t]<this.min&&(this.value[t]=this.min);this.nodes={},this.width=Number(this.svg.getAttribute("width")),this.height=Number(this.svg.getAttribute("height")),RGraph.SVG.createDefs(this),this.graphWidth=this.width-l.marginLeft-l.marginRight,this.graphHeight=this.height-l.marginTop-l.marginBottom,this.centerx=this.graphWidth/2+l.marginLeft,this.centery=this.graphHeight/2+l.marginTop,this.radius=Math.min(this.graphWidth/2,this.graphHeight/2),this.centerx=("number"==typeof l.centerx?l:this).centerx,this.centery=("number"==typeof l.centery?l:this).centery,this.radius=("number"==typeof l.radius?l:this).radius,"string"==typeof l.radius&&l.radius.match(/^\+|-\d+$/)&&(this.radius+=parseFloat(l.radius)),"string"==typeof l.centerx&&l.centerx.match(/^\+|-\d+$/)&&(this.centerx+=parseFloat(l.centerx)),"string"==typeof l.centery&&l.centery.match(/^\+|-\d+$/)&&(this.centery+=parseFloat(l.centery)),RGraph.SVG.resetColorsToOriginalValues({object:this}),this.parseColors(),l.width||(l.width=.75*this.radius/this.value.length,l.width-=2*l.marginInner),this.drawBackground(),this.drawMeter(),this.drawLabels(),this.drawIcons(),l.adjustable&&!this.adjusting_event_listeners_installed&&(this.adjusting_mousedown=!1,e=function(t){t.currentTarget,t.offsetX,t.offsetY;RGraph.SVG.ISFF&&(t.pageX,t.currentTarget.offsetLeft,t.pageY,t.currentTarget.offsetTop);var e,i=r.getRadius(t);i>r.radius||("number"!=typeof r.adjusting_index?(e=r.getIndexByRadius({radius:i}),r.adjusting_index=e):e=r.adjusting_index,t=r.getValue(t),r.value[e]=t,r.currentValue=RGraph.SVG.arrayClone(t),RGraph.SVG.clear(r.svg),r.draw())},(r=this).container.addEventListener("mousedown",function(t){r.adjusting_mousedown=!0,e(t),RGraph.SVG.fireCustomEvent(r,"onadjustbegin")},!1),this.container.addEventListener("mousemove",function(t){r.adjusting_mousedown&&(e(t),RGraph.SVG.fireCustomEvent(r,"onadjust"))},!1),window.addEventListener("mouseup",function(t){r.adjusting_mousedown=!1,r.adjusting_index=null,RGraph.SVG.fireCustomEvent(r,"onadjustend")},!1),this.adjusting_event_listeners_installed=!0);var r=this;return document.body.addEventListener("mouseup",function(t){r.removeHighlight()},!1),RGraph.SVG.addCustomText(this),this.firstDraw&&(this.firstDraw=!1,RGraph.SVG.fireCustomEvent(this,"onfirstdraw")),RGraph.SVG.fireCustomEvent(this,"ondraw"),this},this.getIndexByRadius=function(t){for(var e=t.radius,i=0;i<this.nodes.bars.length;++i){var r=parseFloat(this.nodes.bars[i].getAttribute("data-radius-inner")),s=parseFloat(this.nodes.bars[i].getAttribute("data-radius-outer"));if(r<=e&&e<=s)return i}return null},this.drawBackground=function(){if(l.backgroundColor&&RGraph.SVG.create({svg:this.svg,type:"rect",parent:this.svg.all,attr:{fill:l.backgroundColor,x:0,y:0,width:this.width,height:this.height}}),l.backgroundGrid){for(var t=this.value.length+1,e=0;e<t;e++){var i=this.radius-e*(l.width+2*l.marginInner);RGraph.SVG.create({svg:this.svg,type:"circle",parent:this.svg.all,attr:{fill:"transparent",stroke:l.backgroundGridColor,cx:this.centerx,cy:this.centery,r:i}})}var r=i;if(l.backgroundGridRadials)for(var s=RGraph.SVG.TRIG.TWOPI/l.backgroundGridRadialsCount,e=0;e<=l.backgroundGridRadialsCount;++e){var a=RGraph.SVG.TRIG.getArcPath3({svg:this.svg,cx:this.centerx,cy:this.centery,radius:this.radius,start:e*s,end:e*s,lineto:!1}),n=RGraph.SVG.TRIG.getArcPath3({svg:this.svg,cx:this.centerx,cy:this.centery,radius:r,start:e*s,end:e*s,lineto:!0});RGraph.SVG.create({svg:this.svg,type:"path",parent:this.svg.all,attr:{fill:"transparent",stroke:l.backgroundGridColor,d:a+" "+n}})}}},this.drawMeter=function(){this.nodes.bars=[];for(var t=0;t<this.value.length;++t){var e=this.radius-l.marginInner-t*l.marginInner*2-t*l.width-l.width,i=this.radius-l.marginInner-t*l.marginInner*2-t*l.width;n=(RGraph.SVG.isArray(l.backgroundRingsColors)&&"string"==typeof l.backgroundRingsColors[t]?l.backgroundRingsColors:l.colors)[t],l.backgroundRings&&((o=RGraph.SVG.donut({svg:this.svg.all,cx:this.centerx,cy:this.centery,innerRadius:e,outerRadius:i,fill:n,opacity:l.backgroundRingsAlpha})).setAttribute("data-radiusInner",e),o.setAttribute("data-radiusOuter",i),o.setAttribute("data-centerx",this.centerx),o.setAttribute("data-centery",this.centery));var r,s=RGraph.SVG.create({svg:this.svg,type:"g",parent:this.svg.all,attr:{"data-index":t}}),a=(this.value[t]-this.min)/(this.max-this.min)*RGraph.SVG.TRIG.TWOPI,n=this.pathBar({radiusInner:e,radiusOuter:i,angle:a}),o=RGraph.SVG.create({svg:this.svg,type:"path",parent:s,attr:{fill:l.colors[t],d:n,"data-index":t,"data-centerx":this.centerx,"data-centery":this.centery,"data-angles-info":"These angles are designed to be used with the RGraph.SVG.TRIG.getArcPath3() function","data-start-angle":0,"data-end-angle":a,"data-radius-inner":e,"data-radius-outer":i}});s.setAttribute("data-centerx",this.centerx),s.setAttribute("data-centery",this.centery),s.setAttribute("data-start-angle",0),s.setAttribute("data-end-angle",a),s.setAttribute("data-radius-inner",e),s.setAttribute("data-radius-outer",i),this.nodes.bars[t]=s,l.ends,RGraph.SVG.isNull(l.tooltips)||RGraph.SVG.isNull(l.tooltips[t])&&"string"!=typeof l.tooltips||(r=this,function(e){s.addEventListener(l.tooltipsEvent.replace(/^on/,""),function(t){r.removeHighlight(),RGraph.SVG.tooltip({object:r,index:e,group:null,sequentialIndex:e,text:"string"==typeof l.tooltips?l.tooltips:l.tooltips[e],event:t}),r.highlight(t.target)},!1),s.addEventListener("mousemove",function(t){t.target.style.cursor="pointer"},!1)}(t))}this.currentValue=RGraph.SVG.arrayClone(this.value)},this.pathBar=function(t){var e=t.radiusInner,i=t.radiusOuter,r=t.angle,s=RGraph.SVG.TRIG.getArcPath3({svg:this.svg,cx:this.centerx,cy:this.centery,radius:i,start:0,end:r,lineto:!1}),a="round"===l.ends?(a=RGraph.SVG.TRIG.getRadiusEndPoint({cx:this.centerx,cy:this.centery,radius:(i-e)/2+e,angle:t.angle-RGraph.SVG.TRIG.HALFPI}),RGraph.SVG.TRIG.getArcPath3({svg:this.svg,cx:this.centerx+a[0],cy:this.centery+a[1],radius:(i-e)/2,start:r,end:r+RGraph.SVG.TRIG.PI,lineto:!1,moveto:!1})):"",r=RGraph.SVG.TRIG.getArcPath3({svg:this.svg,cx:this.centerx,cy:this.centery,radius:e,start:r,end:0,anticlockwise:!0}),e="round"===l.ends?RGraph.SVG.TRIG.getArcPath3({svg:this.svg,cx:this.centerx,cy:this.centery-e-(i-e)/2,radius:(i-e)/2,start:RGraph.SVG.TRIG.PI,end:RGraph.SVG.TRIG.TWOPI,lineto:!0}):"";return s+" "+a+" "+r+" "+e+" z"},this.highlight=function(t){var e=t.parentNode,i=e.getAttribute("data-index"),r=parseFloat(e.getAttribute("data-radius-inner")),s=parseFloat(e.getAttribute("data-radius-outer")),a=parseFloat(e.getAttribute("data-end-angle")),t=RGraph.SVG.create({svg:this.svg,type:"g",parent:this.svg.all,attr:{fill:l.highlightFill,stroke:l.highlightStroke},style:{pointerEvents:"none"}}),e=this.pathBar({radiusInner:r,radiusOuter:s,angle:a});RGraph.SVG.create({svg:this.svg,type:"path",parent:t,attr:{d:e,"stroke-width":l.highlightLinewidth,"data-highlight":"true","data-index":i,"data-centerx":this.centerx,"data-centery":this.centery,"data-angles-info":"These angles are designed to be used with the RGraph.SVG.TRIG.getArcPath3() function","data-start-angle":0,"data-end-angle":a,"data-radius-inner":r,"data-radius-outer":s}});this.nodes.highlight=t,RGraph.SVG.REG.set("highlight",t)},this.removeHighlight=function(){var t=RGraph.SVG.REG.get("highlight");t&&t.parentNode&&t.parentNode.removeChild(t),RGraph.SVG.REG.set("highlight",null)},this.drawLabels=function(){var t;if(l.labelsCenter&&(t=RGraph.SVG.numberFormat({object:this,num:this.value[l.labelsCenterIndex].toFixed(l.labelsCenterDecimals),prepend:l.labelsCenterUnitsPre,append:l.labelsCenterUnitsPost,point:l.labelsCenterPoint,thousand:l.labelsCenterThousand,formatter:l.labelsCenterFormatter}),e=RGraph.SVG.getTextConf({object:this,prefix:"labelsCenter"}),i=RGraph.SVG.text({object:this,parent:this.svg.all,tag:"labels.center",text:"string"==typeof l.labelsCenterSpecific?l.labelsCenterSpecific:t,x:this.centerx+l.labelsCenterOffsetx,y:this.centery+l.labelsCenterOffsety,valign:l.labelsCenterValign,halign:l.labelsCenterHalign,font:e.font,size:e.size,bold:e.bold,italic:e.italic,color:e.color}),this.nodes.labelsCenter=i),l.labels.length){var e=RGraph.SVG.getTextConf({object:this,prefix:"labels"});"string"==typeof l.labels&&(l.labels=RGraph.SVG.arrayPad({array:[],length:this.value.length,value:l.labels}));for(var i,r=0;r<l.labels.length;++r)"object"==typeof l.labels&&l.labels.length&&"string"==typeof l.labels[r]&&(i=RGraph.SVG.labelSubstitution({object:this,text:l.labels[r],index:r,value:this.value[r],decimals:l.labelsFormattedDecimals,point:l.labelsFormattedPoint,thousand:l.labelsFormattedThousand,unitsPre:l.labelsFormattedUnitsPre,unitsPost:l.labelsFormattedUnitsPost})),RGraph.SVG.text({object:this,parent:this.svg.all,color:e.color,font:e.font,size:e.size,bold:e.bold,italic:e.italic,text:i,x:this.centerx-5+l.labelsOffsetx-(l.ends?l.width/2:0),y:this.centery-this.radius+l.marginInner+r*l.width+l.width/2+2*r*l.marginInner+l.labelsOffsety,valign:l.labelsValign,halign:l.labelsHalign,background:l.labelsBackground,padding:2})}},this.drawIcons=function(){if(RGraph.SVG.isArray(l.icons))for(var t,e=0,i=[];e<this.value.length;++e)"string"==typeof l.icons[e]&&l.icons[e].length&&(t=[],i[e]=new Image,i[e].src=l.icons[e],t[i[e].index=e]=RGraph.SVG.create({svg:this.svg,parent:this.svg.all,type:"image",attr:{href:l.icons[e],x:this.centerx+l.iconsOffsetx-(l.ends?l.width/2:0)+5,y:this.centery-this.radius+l.marginInner+e*l.width+l.width/2+2*e*l.marginInner+l.iconsOffsety,index:e}}),"number"==typeof l.iconsWidth&&t[e].setAttribute("width",l.iconsWidth),"number"==typeof l.iconsHeight&&t[e].setAttribute("height",l.iconsHeight),t[e].onload=function(){var t=this.getAttribute("index"),t=(l.iconsWidth||i[t].width,l.iconsHeight||i[t].height);this.setAttribute("y",parseInt(this.getAttribute("y"))-t/2)})},this.parseColors=function(){Object.keys(this.originalColors).length||(this.originalColors={colors:RGraph.SVG.arrayClone(l.colors),backgroundColor:RGraph.SVG.arrayClone(l.backgroundColor)});var t=l.colors;if(t)for(var e=0;e<t.length;++e)t[e]=RGraph.SVG.parseColorLinear({object:this,color:t[e],start:this.centerx-this.radius,end:this.centerx+this.radius,direction:"horizontal"});l.backgroundColor=RGraph.SVG.parseColorLinear({object:this,color:l.backgroundColor,start:l.marginLeft,end:this.width-l.marginRight,direction:"horizontal"})},this.on=function(t,e){return"on"!==t.substr(0,2)&&(t="on"+t),RGraph.SVG.addCustomEventListener(this,t,e),this},this.exec=function(t){return t(this),this},this.getAngle=function(t){var e,i;return i="number"==typeof t?(t-this.min)/(this.max-this.min)*RGraph.SVG.TRIG.TWOPI:(e=t.offsetX,i=t.offsetY,RGraph.SVG.TRIG.getAngleByXY({cx:this.centerx,cy:this.centery,x:e,y:i})),i-=RGraph.SVG.TRIG.HALFPI},this.getValue=function(t){t=(("number"==typeof t?t:this.getAngle(t))+RGraph.SVG.TRIG.HALFPI)/RGraph.SVG.TRIG.TWOPI*(this.max-this.min)+this.min,t=Math.max(t,this.min);return t=Math.min(t,this.max)},this.getRadius=function(t){var e=t.offsetX,t=t.offsetY;return RGraph.SVG.TRIG.getHypLength({x1:e,y1:t,x2:this.centerx,y2:this.centery})},this.grow=function(){var i=this;if("number"==typeof this.value&&(this.value=[this.value]),RGraph.SVG.isNull(this.currentValue)){this.currentValue=[];for(var t=0;t<this.value.length;++t)this.currentValue[t]=this.min}for(var r=(arguments[0]||{}).frames||30,s=0,e=[],a=[],n=arguments[1]||function(){},o=[],t=0;t<this.value.length;++t)e[t]=this.value[t]-this.currentValue[t],a[t]=e[t]/r,o[t]=this.currentValue[t];return function t(){for(var e=0;e<i.value.length;++e)i.value[e]=o[e]+s*a[e];s++,RGraph.SVG.clear(i.svg),RGraph.SVG.redraw(),s<=r?RGraph.SVG.FX.update(t):n(i)}(),this},this.tooltipSubstitutions=function(t){t=[0,t.index];return{index:t[1],dataset:t[0],sequentialIndex:t[1],value:this.value[t[1]],values:[this.value[t[1]]]}},this.tooltipsFormattedCustom=function(t,e){return{label:(RGraph.SVG.isArray(l.tooltipsFormattedKeyLabels)&&"string"==typeof l.tooltipsFormattedKeyLabels[t.index]?l.tooltipsFormattedKeyLabels:l.labels)[t.index],color:(RGraph.SVG.isArray(l.tooltipsFormattedKeyColors)&&l.tooltipsFormattedKeyColors[t.index]?l.tooltipsFormattedKeyColors:l.colors)[t.index],value:this.value[t.index]}},this.positionTooltipStatic=function(t){var e=t.object,i=(t.event,t.tooltip),r=t.index,s=RGraph.SVG.getSVGXY(e.svg),a=parseFloat(this.nodes.bars[r].firstChild.getAttribute("data-radius-outer")),n=parseFloat(this.nodes.bars[r].firstChild.getAttribute("data-radius-inner")),e=parseFloat(this.nodes.bars[r].firstChild.getAttribute("data-start-angle"))-RGraph.SVG.TRIG.HALFPI;end=parseFloat(this.nodes.bars[r].firstChild.getAttribute("data-end-angle"))-RGraph.SVG.TRIG.HALFPI;e=RGraph.SVG.TRIG.getRadiusEndPoint({cx:this.centerx,cy:this.centery,radius:n+(a-n)/2,angle:(end-e)/2+e});t.tooltip.style.left=s[0]+(this.centerx+e[0])-i.offsetWidth/2+"px",t.tooltip.style.top=s[1]+(this.centery+e[1])-i.offsetHeight-10+"px"},t.options)"string"==typeof i&&this.set(i,t.options[i]);return this};
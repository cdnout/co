var __decorate=this&&this.__decorate||function(t,e,i,r){var a,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,r);else for(var d=t.length-1;d>=0;d--)(a=t[d])&&(o=(s<3?a(o):s>3?a(e,i,o):a(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o};import{customElement,html,LitElement,property}from"lit-element";import{fireEvent}from"./util/fire-event";import{getMouseTouchLocation}from"./util/get-mouse-touch-location";import{getTouchIdentifier}from"./util/get-touch-identifier";import{matchesSelectorAndParentsTo}from"./util/match-selector";let LitDraggable=class extends LitElement{constructor(){super(...arguments),this.disabled=!1,this._dragging=!1}firstUpdated(){this.addEventListener("mousedown",this._dragStart.bind(this),{capture:!0,passive:!1}),this.addEventListener("touchstart",this._dragStart.bind(this),{capture:!0,passive:!1}),document.addEventListener("mousemove",this._drag.bind(this),{capture:!0,passive:!1}),document.addEventListener("touchmove",this._drag.bind(this),{capture:!0,passive:!1}),document.addEventListener("mouseup",this._dragEnd.bind(this),{capture:!0,passive:!1}),document.addEventListener("touchcancel",this._dragEnd.bind(this),{capture:!0,passive:!1}),document.addEventListener("touchend",this._dragEnd.bind(this),{capture:!0,passive:!1})}render(){return html`<slot></slot>`}_dragStart(t){if(t.type.startsWith("mouse")&&0!==t.button||this.disabled)return;if(this.handle&&!matchesSelectorAndParentsTo(t,this.handle,this.offsetParent))return;t.preventDefault(),t.stopPropagation(),"touchstart"===t.type&&(this._touchIdentifier=getTouchIdentifier(t));const e=getMouseTouchLocation(t,this._touchIdentifier);e&&(this.startX=e.x,this.startY=e.y,this._dragging=!0,fireEvent(this,"dragStart",{startX:this.startX,startY:this.startY}))}_drag(t){if(!this._dragging||this.disabled)return;t.preventDefault(),t.stopPropagation();const e=getMouseTouchLocation(t,this._touchIdentifier);if(!e)return;let i=e.x-this.startX,r=e.y-this.startY;this.grid&&(i=Math.round(i/this.grid[0])*this.grid[0],r=Math.round(r/this.grid[1])*this.grid[1]),(i||r)&&fireEvent(this,"dragging",{deltaX:i,deltaY:r})}_dragEnd(t){this._dragging&&!this.disabled&&(t.preventDefault(),t.stopPropagation(),this._touchIdentifier=void 0,this._dragging=!1,fireEvent(this,"dragEnd"))}};__decorate([property({type:Array})],LitDraggable.prototype,"grid",void 0),__decorate([property({type:Boolean,reflect:!0})],LitDraggable.prototype,"disabled",void 0),__decorate([property()],LitDraggable.prototype,"handle",void 0),LitDraggable=__decorate([customElement("lit-draggable")],LitDraggable);export{LitDraggable};
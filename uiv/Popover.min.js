function isExist(t){return null!=t}function isFunction(t){return"function"==typeof t}function isString(t){return"string"==typeof t}var EVENTS={MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_DOWN:"mousedown",MOUSE_UP:"mouseup",FOCUS:"focus",BLUR:"blur",CLICK:"click",INPUT:"input",KEY_DOWN:"keydown",KEY_UP:"keyup",KEY_PRESS:"keypress",RESIZE:"resize",SCROLL:"scroll",TOUCH_START:"touchstart",TOUCH_END:"touchend"},TRIGGERS={CLICK:"click",HOVER:"hover",FOCUS:"focus",HOVER_FOCUS:"hover-focus",OUTSIDE_CLICK:"outside-click",MANUAL:"manual"},PLACEMENTS={TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"};function getViewportSize(){return{width:Math.max(document.documentElement.clientWidth,window.innerWidth)||0,height:Math.max(document.documentElement.clientHeight,window.innerHeight)||0}}function on(t,e,i){t.addEventListener(e,i)}function off(t,e,i){t.removeEventListener(e,i)}function isElement(t){return t&&t.nodeType===Node.ELEMENT_NODE}function removeFromDom(t){isElement(t)&&isElement(t.parentNode)&&t.parentNode.removeChild(t)}function ensureElementMatchesFunction(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),i=e.length;--i>=0&&e.item(i)!==this;);return i>-1})}function addClass(t,e){if(isElement(t))if(t.className){var i=t.className.split(" ");i.indexOf(e)<0&&(i.push(e),t.className=i.join(" "))}else t.className=e}function removeClass(t,e){if(isElement(t)&&t.className){for(var i=t.className.split(" "),o=[],s=0,n=i.length;s<n;s++)i[s]!==e&&o.push(i[s]);t.className=o.join(" ")}}function hasClass(t,e){if(!isElement(t))return!1;for(var i=t.className.split(" "),o=0,s=i.length;o<s;o++)if(i[o]===e)return!0;return!1}function isAvailableAtPosition(t,e,i){var o=t.getBoundingClientRect(),s=e.getBoundingClientRect(),n=getViewportSize(),h=!0,r=!0,l=!0,u=!0;switch(i){case PLACEMENTS.TOP:h=o.top>=s.height,u=o.left+o.width/2>=s.width/2,r=o.right-o.width/2+s.width/2<=n.width;break;case PLACEMENTS.BOTTOM:l=o.bottom+s.height<=n.height,u=o.left+o.width/2>=s.width/2,r=o.right-o.width/2+s.width/2<=n.width;break;case PLACEMENTS.RIGHT:r=o.right+s.width<=n.width,h=o.top+o.height/2>=s.height/2,l=o.bottom-o.height/2+s.height/2<=n.height;break;case PLACEMENTS.LEFT:u=o.left>=s.width,h=o.top+o.height/2>=s.height/2,l=o.bottom-o.height/2+s.height/2<=n.height}return h&&r&&l&&u}function setTooltipPosition(t,e,i,o,s,n,h){if(isElement(t)&&isElement(e)){var r,l,u=t&&t.className&&t.className.indexOf("popover")>=0;if(isExist(s)&&"body"!==s&&"body"!==n){var a=getElementBySelectorOrRef(n||s);l=a.scrollLeft,r=a.scrollTop}else{var E=document.documentElement;l=(window.pageXOffset||E.scrollLeft)-(E.clientLeft||0),r=(window.pageYOffset||E.scrollTop)-(E.clientTop||0)}if(o){var d=[PLACEMENTS.RIGHT,PLACEMENTS.BOTTOM,PLACEMENTS.LEFT,PLACEMENTS.TOP],c=function(e){d.forEach(function(e){removeClass(t,e)}),addClass(t,e)};if(!isAvailableAtPosition(e,t,i)){for(var g=0,m=d.length;g<m;g++)if(c(d[g]),isAvailableAtPosition(e,t,d[g])){i=d[g];break}c(i)}}var T,f,p,S=e.getBoundingClientRect(),w=t.getBoundingClientRect();if(i===PLACEMENTS.BOTTOM?(T=r+S.top+S.height,f=l+S.left+S.width/2-w.width/2):i===PLACEMENTS.LEFT?(T=r+S.top+S.height/2-w.height/2,f=l+S.left-w.width):i===PLACEMENTS.RIGHT?(T=r+S.top+S.height/2-w.height/2,f=l+S.left+S.width+1):(T=r+S.top-w.height,f=l+S.left+S.width/2-w.width/2),isString(h)?p=document.querySelector(h):isFunction(h)&&(p=h(e)),isElement(p)){var C=u?11:0,O=p.getBoundingClientRect(),I=r+O.top,N=l+O.left,v=I+O.height,L=N+O.width;T<I?T=I:T+w.height>v&&(T=v-w.height),f<N?f=N:f+w.width>L&&(f=L-w.width),i===PLACEMENTS.BOTTOM?T-=C:i===PLACEMENTS.LEFT?f+=C:i===PLACEMENTS.RIGHT?f-=C:T+=C}t.style.top=T+"px",t.style.left=f+"px"}}var MODAL_BACKDROP="modal-backdrop";function getOpenModals(){return document.querySelectorAll("."+MODAL_BACKDROP)}function getOpenModalNum(){return getOpenModals().length}function getElementBySelectorOrRef(t){return isString(t)?document.querySelector(t):isElement(t)?t:isElement(t.$el)?t.$el:null}var SHOW_CLASS="in",popupMixin={props:{value:{type:Boolean,default:!1},tag:{type:String,default:"span"},placement:{type:String,default:PLACEMENTS.TOP},autoPlacement:{type:Boolean,default:!0},appendTo:{type:null,default:"body"},positionBy:{type:null,default:null},transition:{type:Number,default:150},hideDelay:{type:Number,default:0},showDelay:{type:Number,default:0},enable:{type:Boolean,default:!0},enterable:{type:Boolean,default:!0},target:null,viewport:null,customClass:String},data:function(){return{triggerEl:null,hideTimeoutId:0,showTimeoutId:0,transitionTimeoutId:0,autoTimeoutId:0}},watch:{value:function(t){t?this.show():this.hide()},trigger:function(){this.clearListeners(),this.initListeners()},target:function(t){this.clearListeners(),this.initTriggerElByTarget(t),this.initListeners()},allContent:function(t){var e=this;this.isNotEmpty()?this.$nextTick(function(){e.isShown()&&e.resetPosition()}):this.hide()},enable:function(t){t||this.hide()}},mounted:function(){var t=this;ensureElementMatchesFunction(),removeFromDom(this.$refs.popup),this.$nextTick(function(){t.initTriggerElByTarget(t.target),t.initListeners(),t.value&&t.show()})},beforeDestroy:function(){this.clearListeners(),removeFromDom(this.$refs.popup)},methods:{initTriggerElByTarget:function(t){if(t)this.triggerEl=getElementBySelectorOrRef(t);else{var e=this.$el.querySelector('[data-role="trigger"]');if(e)this.triggerEl=e;else{var i=this.$el.firstChild;this.triggerEl=i===this.$refs.popup?null:i}}},initListeners:function(){this.triggerEl&&(this.trigger===TRIGGERS.HOVER?(on(this.triggerEl,EVENTS.MOUSE_ENTER,this.show),on(this.triggerEl,EVENTS.MOUSE_LEAVE,this.hide)):this.trigger===TRIGGERS.FOCUS?(on(this.triggerEl,EVENTS.FOCUS,this.show),on(this.triggerEl,EVENTS.BLUR,this.hide)):this.trigger===TRIGGERS.HOVER_FOCUS?(on(this.triggerEl,EVENTS.MOUSE_ENTER,this.handleAuto),on(this.triggerEl,EVENTS.MOUSE_LEAVE,this.handleAuto),on(this.triggerEl,EVENTS.FOCUS,this.handleAuto),on(this.triggerEl,EVENTS.BLUR,this.handleAuto)):this.trigger!==TRIGGERS.CLICK&&this.trigger!==TRIGGERS.OUTSIDE_CLICK||on(this.triggerEl,EVENTS.CLICK,this.toggle)),on(window,EVENTS.CLICK,this.windowClicked)},clearListeners:function(){this.triggerEl&&(off(this.triggerEl,EVENTS.FOCUS,this.show),off(this.triggerEl,EVENTS.BLUR,this.hide),off(this.triggerEl,EVENTS.MOUSE_ENTER,this.show),off(this.triggerEl,EVENTS.MOUSE_LEAVE,this.hide),off(this.triggerEl,EVENTS.CLICK,this.toggle),off(this.triggerEl,EVENTS.MOUSE_ENTER,this.handleAuto),off(this.triggerEl,EVENTS.MOUSE_LEAVE,this.handleAuto),off(this.triggerEl,EVENTS.FOCUS,this.handleAuto),off(this.triggerEl,EVENTS.BLUR,this.handleAuto)),off(window,EVENTS.CLICK,this.windowClicked),this.clearTimeouts()},clearTimeouts:function(){this.hideTimeoutId&&(clearTimeout(this.hideTimeoutId),this.hideTimeoutId=0),this.showTimeoutId&&(clearTimeout(this.showTimeoutId),this.showTimeoutId=0),this.transitionTimeoutId&&(clearTimeout(this.transitionTimeoutId),this.transitionTimeoutId=0),this.autoTimeoutId&&(clearTimeout(this.autoTimeoutId),this.autoTimeoutId=0)},resetPosition:function(){var t=this.$refs.popup;t&&(setTooltipPosition(t,this.triggerEl,this.placement,this.autoPlacement,this.appendTo,this.positionBy,this.viewport),t.offsetHeight)},hideOnLeave:function(){(this.trigger===TRIGGERS.HOVER||this.trigger===TRIGGERS.HOVER_FOCUS&&!this.triggerEl.matches(":focus"))&&this.$hide()},toggle:function(){this.isShown()?this.hide():this.show()},show:function(){var t=this;if(this.enable&&this.triggerEl&&this.isNotEmpty()&&!this.isShown()){var e=this.hideTimeoutId>0;e&&(clearTimeout(this.hideTimeoutId),this.hideTimeoutId=0),this.transitionTimeoutId>0&&(clearTimeout(this.transitionTimeoutId),this.transitionTimeoutId=0),clearTimeout(this.showTimeoutId),this.showTimeoutId=setTimeout(function(){t.showTimeoutId=0;var i=t.$refs.popup;if(i){var o=getOpenModalNum();if(o>1){var s="popover"===t.name?1060:1070,n=20*(o-1);i.style.zIndex=""+(s+n)}if(!e)i.className=t.name+" "+t.placement+" "+(t.customClass?t.customClass:"")+" fade",getElementBySelectorOrRef(t.appendTo).appendChild(i),t.resetPosition();addClass(i,SHOW_CLASS),t.$emit("input",!0),t.$emit("show")}},this.showDelay)}},hide:function(){var t=this;this.showTimeoutId>0&&(clearTimeout(this.showTimeoutId),this.showTimeoutId=0),this.isShown()&&(!this.enterable||this.trigger!==TRIGGERS.HOVER&&this.trigger!==TRIGGERS.HOVER_FOCUS?this.$hide():(clearTimeout(this.hideTimeoutId),this.hideTimeoutId=setTimeout(function(){t.hideTimeoutId=0;var e=t.$refs.popup;e&&!e.matches(":hover")&&t.$hide()},100)))},$hide:function(){var t=this;this.isShown()&&(clearTimeout(this.hideTimeoutId),this.hideTimeoutId=setTimeout(function(){t.hideTimeoutId=0,removeClass(t.$refs.popup,SHOW_CLASS),t.transitionTimeoutId=setTimeout(function(){t.transitionTimeoutId=0,removeFromDom(t.$refs.popup),t.$emit("input",!1),t.$emit("hide")},t.transition)},this.hideDelay))},isShown:function(){return hasClass(this.$refs.popup,SHOW_CLASS)},windowClicked:function(t){!this.triggerEl||!isFunction(this.triggerEl.contains)||this.triggerEl.contains(t.target)||this.trigger!==TRIGGERS.OUTSIDE_CLICK||this.$refs.popup&&this.$refs.popup.contains(t.target)||!this.isShown()||this.hide()},handleAuto:function(){var t=this;clearTimeout(this.autoTimeoutId),this.autoTimeoutId=setTimeout(function(){t.autoTimeoutId=0,t.triggerEl.matches(":hover, :focus")?t.show():t.hide()},20)}}},Popover={mixins:[popupMixin],data:function(){return{name:"popover"}},render:function(t){return t(this.tag,[this.$slots.default,t("div",{style:{display:"block"},ref:"popup",on:{mouseleave:this.hideOnLeave}},[t("div",{class:"arrow"}),t("h3",{class:"popover-title",directives:[{name:"show",value:this.title}]},this.title),t("div",{class:"popover-content"},[this.content||this.$slots.popover])])])},props:{title:{type:String,default:""},content:{type:String,default:""},trigger:{type:String,default:TRIGGERS.OUTSIDE_CLICK}},computed:{allContent:function(){return this.title+this.content}},methods:{isNotEmpty:function(){return this.title||this.content||this.$slots.popover}}};export default Popover;
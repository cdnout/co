!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).ShareThis=t()}(this,function(){"use strict";var i;function u(e,t){for(var n,o,r=e;r&&(1!==r.nodeType||(o=t,!(n=r)[i=i||function(e){for(var t="atchesSelector",n=0,o=["matches","m"+t,"webkitM"+t,"mozM"+t,"msM"+t,"oM"+t];n<o.length;n++){var r=o[n];if(e[r])return r}}(n)](o)));)r=r.parentNode;return r}function g(e){return"function"==typeof e}function b(e,s,t){var n,o=t.document,r=o.defaultView,i=function(e){if(e.isCollapsed)return!0;var t=e.anchorNode.compareDocumentPosition(e.focusNode);return t?0<(4&t):e.anchorOffset<e.focusOffset}(r.getSelection()),a=function(e){var t,n=s.getClientRects(),o=[].slice.bind(n);if(e){for(var r=1/0,i=n.length;i--;){var a=n[i];if(a.left>r)break;r=a.left}t=o(i+1)}else{for(var c=-1/0,u=0;u<n.length;u++){var f=n[u];if(f.right<c)break;c=f.right}t=o(0,u)}return{top:Math.min.apply(Math,t.map(function(e){return e.top})),bottom:Math.max.apply(Math,t.map(function(e){return e.bottom})),left:t[0].left,right:t[t.length-1].right}}(i),c=(n=r.document.body,("static"===r.getComputedStyle(n).position?n.parentNode:n).getBoundingClientRect()),u=e.style;i?u.right=o.documentElement.clientWidth-a.right+c.left+"px":u.left=a.left-c.left+"px",u.width=a.right-a.left+"px",u.height=a.bottom-a.top+"px",u.top=a.top-c.top+"px",u.position="absolute",e.className=t.popoverClass}var a="data-share-via";function f(t){return{createPopover:function(){var e=t.createElement("div");return e.addEventListener("click",function(e){var t,n,o,r;t=this.sharers,!(r=u((n=e).target,"["+a+"]"))||(o=function(e,t){for(var n=0;n<e.length;n++){var o=e[n];if(o.name===t)return o}}(t,r.getAttribute(a)))&&g(o.action)&&o.action(n,r)}),e},attachPopover:function(e){t.body.appendChild(e)},removePopover:function(e){var t=e.parentNode;t&&t.removeChild(e)}}}var y,s=["selectionchange","mouseup","touchend","touchcancel"];return function(e){var l=(Object.assign||function(e,t){if(t&&"object"==typeof t)for(var n in t)e[n]=t[n];return e})({document:document,selector:"body",sharers:[],popoverClass:"share-this-popover",transformer:function(e){return e.trim().replace(/\s+/g," ")}},e||{}),t=!1,n=!1,o=y,p=y,d=y,h=y;return{init:function(){return!t&&(o=l.document,(p=o.defaultView).getSelection?(s.forEach(r),p.addEventListener("resize",a),h=f(o),t=!0):(console.warn("share-this: Selection API isn't supported"),!1))},destroy:function(){return!(!t||n)&&(s.forEach(i),p.removeEventListener("resize",a),m(),n=!(p=o=y))},reposition:function(){return d&&b(d,v(),l),!!d}};function r(e){o.addEventListener(e,c)}function i(e){o.removeEventListener(e,c)}function a(){d&&b(d,v(),l)}function c(e){var t=e.type;!d!=("selectionchange"===t)&&setTimeout(function(){var e,t,n,o,r,i,a,c,u,f,s;p&&((e=v())?(c=!d,u=(t=e).toString(),f=l.transformer(u),(s=l.sharers.filter(function(e,t,n){var o=n.active;return g(o)?o(e,t):o===y||o}.bind(null,f,u))).length?(c&&(d=h.createPopover()),d.sharers=s,d.innerHTML=(o=s,r=f,i=u,a=(n=l).shareUrl||n.document.defaultView.location,"<ul>"+o.map(function(e){return'<li data-share-via="'+e.name+'">'+e.render.call(e,r,i,a)+"</li>"}).join("")+"</ul>"),b(d,t,l),c&&(h.attachPopover(d),g(l.onOpen)&&l.onOpen(d,f,u))):d&&m()):m())},10)}function v(){var e=p.getSelection(),t=e.rangeCount&&e.getRangeAt(0);if(t){var n=function(e,t){var n=e.cloneRange();if(e.collapsed||!t)return n;var o,r,i=u(e.startContainer,t);return i?(o=e.endContainer,!(r=i.compareDocumentPosition(o))||0<(16&r)||n.setEnd(i,i.childNodes.length)):(i=u(e.endContainer,t))?n.setStart(i,0):n.collapse(),n}(t,l.selector);if(!n.collapsed&&n.getClientRects().length)return n}}function m(){d&&(h.removePopover(d),d=y,g(l.onClose)&&l.onClose())}}});
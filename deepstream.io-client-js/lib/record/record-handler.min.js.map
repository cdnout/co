{"version":3,"sources":["record-handler.js"],"names":["_typeof","Symbol","iterator","obj","constructor","prototype","Record","require","AnonymousRecord","List","Listener","SingleNotifier","C","messageParser","messageBuilder","EventEmitter","RecordHandler","options","connection","client","this","_options","_connection","_client","_records","_lists","_listener","_writeCallbacks","_destroyEventEmitter","_hasRegistry","TOPIC","RECORD","ACTIONS","HAS","recordReadTimeout","_snapshotRegistry","SNAPSHOT","_headRegistry","HEAD","recordNames","Object","keys","getRecord","name","recordOptions","on","_onRecordError","bind","_onDestroyPending","_removeRecord","usages","getList","getAnonymousRecord","listen","pattern","callback","length","Error","destroyPending","destroy","_$onError","EVENT","LISTENER_EXISTS","unlisten","listener","sendDestroy","NOT_LISTENING","snapshot","_this","record","isReady","get","Promise","resolve","request","reject","has","_this2","head","_this3","version","setDataWithAck","recordName","pathOrData","dataOrCallback","_this4","setData","error","path","data","cb","arguments","set","recordData","typed","config","writeSuccess","push","sendMsg","CREATEANDUPDATE","_$handle","message","action","ERROR","VERSION_EXISTS","MESSAGE_DENIED","processedError","ACK","DELETE","UNSUBSCRIBE","emit","_$onMessage","recieve","processed","READ","hasRequest","JSON","parse","convertTyped","Number","WRITE_ACKNOWLEDGEMENT","UNLISTEN","SUBSCRIPTION_FOR_PATTERN_REMOVED","SUBSCRIPTION_HAS_PROVIDER","_handleWriteAcknowledgements","UNSOLICITED_MESSAGE","onMessage","once","module","exports"],"mappings":"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"}
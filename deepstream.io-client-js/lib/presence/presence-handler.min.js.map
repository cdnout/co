{"version":3,"sources":["presence-handler.js"],"names":["_typeof","Symbol","iterator","obj","constructor","prototype","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","_classCallCheck","instance","TypeError","EventEmitter","require","C","ResubscribeNotifier","validateArguments","userId","callback","defaultAction","undefined","Error","module","exports","PresenceHandler","options","connection","client","this","_options","_connection","_client","_queryEmitter","_subscribeEmitter","_ackTimeoutRegistry","_$getAckTimeoutRegistry","_resubscribeNotifier","_resubscribe","bind","_counter","_flush","_flushTimeout","_pendingSubscribes","_pendingUnsubscribes","value","users","sendMsg","TOPIC","PRESENCE","ACTIONS","QUERY","once","queryId","args","SUBSCRIBE","hasListeners","_sendGlobalSubscription","on","setTimeout","UNSUBSCRIBE","off","message","action","ERROR","data","EVENT","MESSAGE_DENIED","remove","processedError","_$onError","ACK","clear","PRESENCE_JOIN","emit","PRESENCE_LEAVE","JSON","parse","e","UNSOLICITED_MESSAGE","callbacks","keys","_callbacks","indexOf","splice","_sendSubscriptionBulk","pendingSubscribes","pendingUnsubscribes","names","correlationId","add","topic","name"],"mappings":"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"}
"use strict";var C=require("../constants/constants"),utils=require("../utils/utils"),messageBuilder=require("../message/message-builder"),RpcResponse=function(e,t,s){this._connection=e,this._name=t,this._correlationId=s,this._isAcknowledged=!1,this._isComplete=!1,this.autoAck=!0,utils.nextTick(this._performAutoAck.bind(this))};RpcResponse.prototype.ack=function(){!1===this._isAcknowledged&&(this._connection.sendMsg(C.TOPIC.RPC,C.ACTIONS.ACK,[C.ACTIONS.REQUEST,this._name,this._correlationId]),this._isAcknowledged=!0)},RpcResponse.prototype.reject=function(){this.autoAck=!1,this._isComplete=!0,this._isAcknowledged=!0,this._connection.sendMsg(C.TOPIC.RPC,C.ACTIONS.REJECTION,[this._name,this._correlationId])},RpcResponse.prototype.error=function(e){this.autoAck=!1,this._isComplete=!0,this._isAcknowledged=!0,this._connection.sendMsg(C.TOPIC.RPC,C.ACTIONS.ERROR,[e,this._name,this._correlationId])},RpcResponse.prototype.send=function(e){if(!0===this._isComplete)throw new Error("Rpc "+this._name+" already completed");this.ack();var t=messageBuilder.typed(e);this._connection.sendMsg(C.TOPIC.RPC,C.ACTIONS.RESPONSE,[this._name,this._correlationId,t]),this._isComplete=!0},RpcResponse.prototype._performAutoAck=function(){!0===this.autoAck&&this.ack()},module.exports=RpcResponse;
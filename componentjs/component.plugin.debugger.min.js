ComponentJS.plugin("debugger",function(e,t,o){e.jq=function(t,n){var d=[];if(1===arguments.length&&"string"!=typeof t)d.push(t);else{void 0===n&&(n=o.document);try{d=n.querySelectorAll(t)}catch(e){d=o.document}d=e.concat([],d)}return e.extend(d,e.jq_methods),d},e.jq_methods={ready:function(e){for(var t=0;t<this.length;t++)!function(o){var n=this[t];setTimeout(function(){e.call(n)},250)}()},bind:function(e,t){for(var o=0;o<this.length;o++)"function"==typeof this[o].addEventListener?this[o].addEventListener(e,t,!1):"function"==typeof this[o].attachEvent&&this[o].attachEvent("on"+e,t);return this},width:function(e){for(var t=void 0!==e?this:void 0,o=0;o<this.length;o++)void 0===e?(void 0===(t=this[o].offsetWidth)&&(t=this[o].innerWidth),void 0===t&&(t=this[o].clientWidth)):this[o].style.width=e;return t},height:function(e){for(var t=void 0!==e?this:void 0,o=0;o<this.length;o++)void 0===e?(void 0===(t=this[o].offsetHeight)&&(t=this[o].innerHeight),void 0===t&&(t=this[o].clientHeight)):this[o].style.height=e;return t},css:function(t,o){for(var n=void 0!==o?this:void 0,d=t.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()}),i=0;i<this.length;i++)void 0===o?n=this[i].style[d]:e.isIE()?this[i].style.cssText=t+":"+o+";":this[i].style[d]=o;return n},attr:function(e,t){for(var o=void 0!==t?this:void 0,n=0;n<this.length;n++)void 0===t?o=this[n].getAttribute(e):this[n].setAttribute(e,t);return o},html:function(t){for(var o=0;o<this.length;o++)try{this[o].innerHTML=t}catch(i){var n=e.dbg.document.createElement("div");for(n.innerHTML="<div>"+t+"</div>";this[o].firstChild;)this[o].removeChild(this[o].firstChild);for(var d=0;d<n.firstChild.childNodes.length;d++)this[o].appendChild(n.firstChild.childNodes[d])}return this},scrollTop:function(e){for(var t=0;t<this.length;t++)this[t].scrollTop=e;return this},get:function(e){return this[e]}},e.dbg_view_mask=function(t){e.jq("html head",e.dbg.document).html("<title>"+t+"</title>"),e.jq("html body",e.dbg.document).html("<style type=\"text/css\">html, body {margin: 0px;padding: 0px;}.dbg {width: 100%;height: 100%;font-family: Helvetica, Arial, sans-serif;background-color: #e0e0e0;overflow: hidden;font-size: 9pt;}.dbg .header {width: 100%;height: 30px;background: #666666;background: -moz-linear-gradient(top,  #666666 0%, #333333 49%, #222222 51%, #000000 100%);background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#666666), color-stop(49%,#333333), color-stop(51%,#222222), color-stop(100%,#000000));background: -webkit-linear-gradient(top,  #666666 0%,#333333 49%,#222222 51%,#000000 100%);background: -o-linear-gradient(top,  #666666 0%,#333333 49%,#222222 51%,#000000 100%);background: -ms-linear-gradient(top,  #666666 0%,#333333 49%,#222222 51%,#000000 100%);background: linear-gradient(to bottom,  #666666 0%,#333333 49%,#222222 51%,#000000 100%);filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#666666', endColorstr='#000000',GradientType=0 );text-align: center;position: relative;}.dbg .header .text {position: relative;top: 6px;color: #ffffff;font-size: 12pt;font-weight: bold;}.dbg .viewer {position: relative;width: 100%;height: 50%;background: #d0d0d0;background: -moz-linear-gradient(top,  #d0d0d0 0%, #e8e8e8 50%, #d0d0d0 100%);background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#d0d0d0), color-stop(50%,#e8e8e8), color-stop(100%,#d0d0d0));background: -webkit-linear-gradient(top,  #d0d0d0 0%,#e8e8e8 50%,#d0d0d0 100%);background: -o-linear-gradient(top,  #d0d0d0 0%,#e8e8e8 50%,#d0d0d0 100%);background: -ms-linear-gradient(top,  #d0d0d0 0%,#e8e8e8 50%,#d0d0d0 100%);background: linear-gradient(to bottom,  #d0d0d0 0%,#e8e8e8 50%,#d0d0d0 100%);filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#d0d0d0', endColorstr='#d0d0d0',GradientType=0 );overflow: hidden;}.dbg .viewer canvas {position: absolute;top: 0px;left: 0px;}.dbg .status {width: 100%;height: 20px;background: #666666;background: -moz-linear-gradient(top,  #666666 0%, #333333 49%, #222222 51%, #000000 100%);background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#666666), color-stop(49%,#333333), color-stop(51%,#222222), color-stop(100%,#000000));background: -webkit-linear-gradient(top,  #666666 0%,#333333 49%,#222222 51%,#000000 100%);background: -o-linear-gradient(top,  #666666 0%,#333333 49%,#222222 51%,#000000 100%);background: -ms-linear-gradient(top,  #666666 0%,#333333 49%,#222222 51%,#000000 100%);background: linear-gradient(to bottom,  #666666 0%,#333333 49%,#222222 51%,#000000 100%);filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#666666', endColorstr='#000000',GradientType=0 );color: #f0f0f0;text-align: center;}.dbg .filter input {width: 100%;background: #eeeeee;border: none;padding: 2px 2px 3px 52px;}.dbg .status .text {position: relative;top: 3px;color: #ffffff;font-size: 9pt;}.dbg .console {width: 100%;height: 50%;background-color: #ffffff;color: #000000;overflow-y: scroll;font-size: 9pt;}.dbg .console .text {width: 100%;height: auto;}.dbg .console .text .line {border-collapse: collapse;width: 100%;border-bottom: 1px solid #e0e0e0;font-size: 9pt;}.dbg .console .text .num {width: 40px;background-color: #f0f0f0;text-align: right;}.dbg .console .text .msg {padding-left: 10px;}.dbg .console .text .msg .prefix {color: #999999;}.dbg .console .text .msg .context {font-weight: bold;}.dbg .console .text .msg .path {color: #003399;}.dbg .console .text .msg .state {font-style: italic;}.dbg .console .text .msg .arrow {color: #999999;}.dbg .console .text .msg .method {font-family: monospace;}.dbg .grabber {position: absolute; cursor: move; width: 100%;height: 20px;background-color: transparent;opacity: 0.5;z-index: 100;}.dbg .infobox {position: absolute;top: 0px;left: 0px;width: 100%;background-color: #ffffff;color: #000000;z-index: 200;display: none;}.dbg .infobox table {border-collapse: collapse;width: 100%;}.dbg .infobox table tr td {border-bottom: 1px solid #e0e0e0;}.dbg .infobox table tr td {font-size: 11pt;}.dbg .infobox table tr td.label {padding-left: 10px;background-color: #f0f0f0;color: #909090;vertical-align: top;width: 160px;}.dbg .infobox table tr td.value {padding-left: 10px;vertical-align: top;}.dbg .infobox table tr td.value span.none {color: #909090;font-style: italic;}.dbg .plus, .dbg .reset, .dbg .minus, .dbg .exporter {cursor: pointer; position: absolute; top: 4px; width: 10px; text-align: center; font-weight: bold; padding: 2px 8px 2px 8px; border-top: 1px solid #777777;border-left: 1px solid #777777;border-right: 1px solid #555555;border-bottom: 1px solid #555555;background: #666666;background: -moz-linear-gradient(top,  #666666 0%, #333333 49%, #222222 51%, #000000 100%);background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#666666), color-stop(49%,#333333), color-stop(51%,#222222), color-stop(100%,#000000));background: -webkit-linear-gradient(top,  #666666 0%,#333333 49%,#222222 51%,#000000 100%);background: -o-linear-gradient(top,  #666666 0%,#333333 49%,#222222 51%,#000000 100%);background: -ms-linear-gradient(top,  #666666 0%,#333333 49%,#222222 51%,#000000 100%);background: linear-gradient(to bottom,  #666666 0%,#333333 49%,#222222 51%,#000000 100%);filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#666666', endColorstr='#000000',GradientType=0 );color: #c0c0c0;z-index: 100;}.dbg .plus {right: 80px; }.dbg .reset {right: 110px; }.dbg .minus {right: 140px; }.dbg .exporter {right: 20px; font-weight: normal; width: auto;}</style><div class=\"dbg\">"+'<div class="header"><div class="text">'+t+'</div></div><div class="viewer"><canvas></canvas></div><div class="grabber"></div><div class="plus">+</div><div class="reset">0</div><div class="minus">-</div><div class="exporter">Export</div><div class="status"><div class="text"></div></div><div class="filter"><input type="text" placeholder="Filter messages - RegExp enabled"></div><div class="console"><div class="text"></div></div><div class="infobox"></div></div>')},e.dbg_logline=0,e.dbg_logbook=[],e.dbg_filter="",e.dbg_log=function(t){if(null!==e.dbg){var o=t;t=t.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;").replace("\n","<br/>"),e.dbg_logline++,t=(t=(t=(t=t.replace(/(DEBUG\[\d+\]: )([^:]+)/,'<span class="prefix">$1</span><span class="context">$2</span>')).replace(/(\s+)(\/[^:\s]*)/g,'$1<span class="path">$2</span>')).replace(/(\s+)(@[a-z]+)/g,'$1<span class="state">$2</span>')).replace(/((?:&lt;)?--\()([a-z]+)(\)--(?:&gt;)?)/g,'<span class="arrow">$1</span><span class="method">$2</span><span class="arrow">$3</span>'),e.dbg_logbook.push({logline:e.dbg_logline,msg:t,originalMsg:o}),e.dbg_state_invalidate("console"),e.dbg_update()}},e.dbg_logbook_render=function(){var t="",o=/^\/(.*)\/(.*)?$/gm.exec(e.dbg_filter),n=e.dbg_filter,d="";o&&o.length>=2&&(n=o[1]),o&&3===o.length&&(d=o[2]);var i=new RegExp(n,d);for(var a in e.dbg_logbook)if(e.isown(e.dbg_logbook,a)){var r=e.dbg_logbook[a];i.exec(r.originalMsg)&&(t='<table class="line"><tr><td class="num">'+r.logline+'.</td><td class="msg">'+r.msg+"</td></tr></table>"+t)}return t},e.dbg_infobox_content=function(o){var n,d,i,a="",r=function(e){e.sort();var t="";for(i in e)t+="<code>"+e[i]+"</code>, ";return""===(t=t.replace(/, $/,""))&&(t='<span class="none">none</span>'),t},s=function(e,t){return'<tr><td class="label">'+e+'</td><td class="value">'+t+"</td></tr>"};a+=s("Name:","<b>"+(n=o.name().replace(/</,"&lt;").replace(/>/,"&gt;"))+"</b>"),a+=s("Path:","<code>"+o.path("/")+"</code>");var g="";t.marked(o.obj(),"view")&&(g+="view, "),t.marked(o.obj(),"model")&&(g+="model, "),t.marked(o.obj(),"controller")&&(g+="controller, "),t.marked(o.obj(),"service")&&(g+="service, "),""===(g=g.replace(/, $/,""))&&(g='<span class="none">none</span>'),a+=s("Markers:",g),a+=s("State:","<code>"+o.state()+"</code>");var b="";for(d in o.__state_guards)e.isown(o.__state_guards,d)&&"number"==typeof o.__state_guards[d]&&0!==o.__state_guards[d]&&(b+="<code>"+d+"</code> ("+o.__state_guards[d]+"), ");""===(b=b.replace(/, $/,""))&&(b='<span class="none">none</span>'),a+=s("Guards:",b);var l="";for(n in o.__spool)e.isown(o.__spool,n)&&void 0!==o.__spool[n]&&o.__spool[n].length>0&&(l+="<code>"+n+"</code> ("+o.__spool[n].length+"), ");""===(l=l.replace(/, $/,""))&&(l='<span class="none">none</span>'),a+=s("Spools:",l);var c=[];for(i in o.__config)if(e.isown(o.__config,i)&&i.match(/^ComponentJS:property:ComponentJS:model/)&&"object"==typeof o.__config[i])for(n in o.__config[i].data)e.isown(o.__config[i].data,n)&&c.push(n);a+=s("Model Values:",r(c));var f=[];for(i in o.__config)e.isown(o.__config,i)&&i.match(/^ComponentJS:property:ComponentJS:socket:/)&&"object"==typeof o.__config[i]&&f.push(i.replace(/^ComponentJS:property:ComponentJS:socket:/,""));a+=s("Sockets:",r(f));var u=[],_=[],p=[];for(i in o.__subscription)e.isown(o.__subscription,i)&&"object"==typeof o.__subscription[i]&&"string"==typeof o.__subscription[i].name&&(o.__subscription[i].name.match(/^ComponentJS:/)||u.push(o.__subscription[i].name),o.__subscription[i].name.match(/^ComponentJS:service:/)&&_.push(o.__subscription[i].name.replace(/^ComponentJS:service:/,"")),o.__subscription[i].name.match(/^ComponentJS:hook:/)&&p.push(o.__subscription[i].name.replace(/^ComponentJS:hook:/,"")));return a+=s("Event Subscriptions:",r(u)),a+=s("Service Registrations:",r(_)),a="<table>"+(a+=s("Hook Points:",r(p)))+"</table>"},e.dbg=null,e.dbg_state_invalid={components:!1,states:!1,requests:!1,console:!1},e.dbg_state_invalidate=function(t){e.dbg_state_invalid[t]=!0},e.dbg_natural=!1,t.debug_instrumented=function(){return void 0!==o&&o.console&&(o.console.firebug||o.outerHeight-o.innerHeight>120)},e.isIE=function(){return"undefined"!=typeof navigator&&"Microsoft Internet Explorer"===navigator.appName&&navigator.userAgent.match(new RegExp("MSIE ([0-9]+[.0-9]*)"))},t.debug_window=function(){var n=t.params("debugger",arguments,{enable:{pos:0,def:null},autoclose:{pos:1,def:!1},name:{pos:2,def:null},width:{def:800},height:{def:600},natural:{def:!1}});if(null===n.enable)return null!==e.dbg;if(n.enable){if(e.dbg_natural=n.natural,null===e.dbg){var d="ComponentJS Debugger";null!==n.name&&(d+=" ("+n.name+")");var i=d,a="location=no,scrollbars=no,toolbars=no,menubar=no,status=no";a+=",width="+n.width+",height="+n.height,e.isIE()?i=i.replace(/[^a-zA-Z0-9_]/g,"_"):a+=",replace=yes",e.dbg=o.open("about:blank",i,a),e.isIE()&&(e.dbg.close(),e.dbg=o.open("about:blank",i,a)),setTimeout(e.hook("ComponentJS:plugin:debugger:settimeout:func","pass",function(){e.jq(e.dbg.document).ready(function(){n.autoclose&&e.jq(o).bind("beforeunload",function(){null!==e.dbg&&e.dbg.close()}),e.dbg_view_mask(d),e.dbg_refresh(),e.jq(e.dbg).bind("resize",function(){e.dbg_refresh()}),e.jq(".dbg",e.dbg.document).bind("selectstart",function(e){return e.preventDefault(),!1});var t=!1,i=!1,a=-1,r=-1;e.jq(".dbg .grabber",e.dbg.document).bind("mousedown",function(o){t=!0,e.jq(".dbg .grabber",e.dbg.document).css("background-color","red"),o.preventDefault()}),e.jq(".dbg",e.dbg.document).bind("mousemove",function(o){if(t){var n=o.pageY;n<300&&(n=300);var d=e.jq(e.dbg).height();n>d-100&&(n=d-100),e.jq(".dbg .grabber",e.dbg.document).css("top",n),e.dbg_grabber_offset=n,o.preventDefault()}else if(i){-1===a&&(a=o.pageX),-1===r&&(r=o.pageY);var s=a-o.pageX,g=r-o.pageY;a=o.pageX,r=o.pageY,e.dbg_canvas_info.x+=s,e.dbg_canvas_info.y+=g,e.dbg_reposition()}}),e.jq(".dbg",e.dbg.document).bind("mouseup",function(o){t&&(e.jq(".dbg .grabber",e.dbg.document).css("background-color","transparent"),e.dbg_refresh(),t=!1,o.preventDefault())}),e.jq(".dbg .exporter",e.dbg.document).bind("click",function(t){var n=e.jq(".dbg .viewer canvas",e.dbg.document).get(0);if(void 0!==n){var d=n.toDataURL("image/png");o.open(d)}return t.preventDefault(),!1});e.jq(".dbg .plus",e.dbg.document).bind("click",function(){e.dbg_canvas_info.w+=100,e.dbg_canvas_info.h+=100,e.dbg_refresh()}),e.jq(".dbg .minus",e.dbg.document).bind("click",function(){e.dbg_canvas_info.w-=100,e.dbg_canvas_info.h-=100,e.dbg_refresh()}),e.jq(".dbg .reset",e.dbg.document).bind("click",function(){e.dbg_canvas_info.w=e.dbg_canvas_info.wmin,e.dbg_canvas_info.h=e.dbg_canvas_info.hmin,e.dbg_refresh()}),e.jq(".dbg .viewer canvas",e.dbg.document).bind("mousedown",function(){i=!0,a=-1,r=-1}),e.jq(".dbg .viewer canvas",e.dbg.document).bind("mouseup",function(){i=!1}),e.jq(e.dbg.document).bind("keydown",function(t){43===t.keyCode||107===t.keyCode||187===t.keyCode?(e.dbg_canvas_info.w+=100,e.dbg_canvas_info.h+=100,e.dbg_refresh()):45===t.keyCode||109===t.keyCode||189===t.keyCode?(e.dbg_canvas_info.w-=100,e.dbg_canvas_info.h-=100,e.dbg_refresh()):48===t.keyCode?(e.dbg_canvas_info.w=e.dbg_canvas_info.wmin,e.dbg_canvas_info.h=e.dbg_canvas_info.hmin,e.dbg_refresh()):37===t.keyCode?(e.dbg_canvas_info.x+=10,e.dbg_reposition()):38===t.keyCode?(e.dbg_canvas_info.y+=10,e.dbg_reposition()):39===t.keyCode?(e.dbg_canvas_info.x-=10,e.dbg_reposition()):40===t.keyCode&&(e.dbg_canvas_info.y-=10,e.dbg_reposition())}),e.dbg_filter_timeout=null,e.jq(".dbg .filter input",e.dbg.document).bind("keydown",function(e){e.stopPropagation()}),e.jq(".dbg .filter input",e.dbg.document).bind("keyup",function(t){e.dbg_filter_timeout&&(o.clearTimeout(e.dbg_filter_timeout),e.dbg_filter_timeout=null),e.dbg_filter_timeout=o.setTimeout(function(){e.dbg_filter=t.target.value,e.dbg_update_once(),e.dbg_filter_timeout&&(o.clearTimeout(e.dbg_filter_timeout),e.dbg_filter_timeout=null)},1e3)})})}),500)}t.debug(3,"debugger enabled")}else null!==e.dbg&&(t.debug(3,"debugger disabled"),e.dbg.close(),e.dbg=null)},e.dbg_grabber_offset=-1,e.dbg_canvas_info={x:0,y:0,w:-1,h:-1,wmin:-1,hmin:-1},e.dbg_refresh=function(){var t=e.jq(e.dbg).width(),o=e.jq(e.dbg).height();if(e.jq(".dbg",e.dbg.document).width(t).height(o),e.jq(".dbg .grabber",e.dbg.document).height(e.jq(".dbg .status",e.dbg.document).height()),-1===e.dbg_grabber_offset){var n=o-e.jq(".dbg .header",e.dbg.document).height();e.dbg_grabber_offset=Math.floor(n/2)+e.jq(".dbg .header",e.dbg.document).height()}var d=e.dbg_grabber_offset-e.jq(".dbg .header",e.dbg.document).height(),i=o-e.dbg_grabber_offset-e.jq(".dbg .status",e.dbg.document).height();e.jq(".dbg .viewer",e.dbg.document).height(d),e.jq(".dbg .console",e.dbg.document).height(i-e.jq(".dbg .filter",e.dbg.document).height()),e.jq(".dbg .infobox",e.dbg.document).height(i),e.jq(".dbg .infobox",e.dbg.document).css("top",e.dbg_grabber_offset+e.jq(".dbg .status",e.dbg.document).height()),e.jq(".dbg .grabber",e.dbg.document).css("top",e.dbg_grabber_offset),e.dbg_canvas_info.wmin=t,e.dbg_canvas_info.hmin=d,e.dbg_canvas_info.w<e.dbg_canvas_info.wmin&&(e.dbg_canvas_info.w=e.dbg_canvas_info.wmin),e.dbg_canvas_info.h<e.dbg_canvas_info.hmin&&(e.dbg_canvas_info.h=e.dbg_canvas_info.hmin),e.jq(".dbg .viewer canvas",e.dbg.document).height(e.dbg_canvas_info.h).attr("height",e.dbg_canvas_info.h).width(e.dbg_canvas_info.w).attr("width",e.dbg_canvas_info.w),e.dbg_reposition(),e.dbg_update()},e.dbg_reposition=function(){e.dbg_canvas_info.x<0&&(e.dbg_canvas_info.x=0),e.dbg_canvas_info.x>e.dbg_canvas_info.w-e.dbg_canvas_info.wmin&&(e.dbg_canvas_info.x=e.dbg_canvas_info.w-e.dbg_canvas_info.wmin),e.dbg_canvas_info.y<0&&(e.dbg_canvas_info.y=0),e.dbg_canvas_info.y>e.dbg_canvas_info.h-e.dbg_canvas_info.hmin&&(e.dbg_canvas_info.y=e.dbg_canvas_info.h-e.dbg_canvas_info.hmin),e.jq(".dbg .viewer canvas",e.dbg.document).css("top",-e.dbg_canvas_info.y).css("left",-e.dbg_canvas_info.x)},e.dbg_timer=null,e.dbg_update=function(){null!==e.dbg&&null===e.dbg_timer&&(e.dbg_timer=setTimeout(e.hook("ComponentJS:plugin:debugger:settimeout:func","pass",function(){e.dbg_update_once(),e.dbg_timer=null}),250))},e.dbg_update_once=function(){if(e.dbg_state_invalid.console&&(e.jq(".dbg .console .text",e.dbg.document).html(e.dbg_logbook_render()),e.jq(".dbg .console",e.dbg.document).scrollTop(0),e.dbg_state_invalid.console=!0),e.dbg_state_invalid.components||e.dbg_state_invalid.requests||e.dbg_state_invalid.states){var o,n,d;if((e.dbg_state_invalid.components||e.dbg_state_invalid.states)&&(o=e.root.walk_down(function(t,o,n,d){if(d){for(var i=0,a=0,r=o.children(),s=0;s<r.length;s++)i+=e.annotation(r[s],"debugger_width"),a+=e.annotation(r[s],"debugger_total");0===a&&i++,a++,e.annotation(o,"debugger_width",i),e.annotation(o,"debugger_total",a)}else e.annotation(o,"debugger_depth",t),n=t>n?t:n;return n},1),n=e.annotation(e.root,"debugger_width"),d=e.annotation(e.root,"debugger_total")),e.dbg_state_invalid.components||e.dbg_state_invalid.requests){var i=0;for(var a in e.state_requests)e.isown(e.state_requests,a)&&i++;e.jq(".dbg .status .text",e.dbg.document).html("Created Components: <b>"+d+"</b>, Pending Transition Requests: <b>"+i+"</b>"),e.dbg_state_invalid.requests=!0}if(e.dbg_state_invalid.components||e.dbg_state_invalid.states){var r=e.jq(".dbg .viewer canvas",e.dbg.document).get(0);if(void 0===r)return;r=r.getContext("2d");var s=e.jq(".dbg .viewer canvas",e.dbg.document).height()-20,g=e.jq(".dbg .viewer canvas",e.dbg.document).width()-20,b=Math.floor(g/n),l=Math.floor(s/(o+1)),c=Math.floor(b/8),f=Math.floor(l/4);r.clearRect(0,0,g,s);var u=e.dbg_natural;e.root.walk_down(function(o,n,d,i){if(i){var a,g,_,p,h=e.annotation(n,"debugger_depth");if(1===e.annotation(n,"debugger_total"))a=10+b*d++,g=u?s-l*h-l+10:l*h-10,_=b-c,p=l-f;else{var v=n.children(),m=e.annotation(v[0],"debugger_x"),w=m;v.length>1&&(w=e.annotation(v[v.length-1],"debugger_x")),a=m+Math.ceil((w-m)/2),g=u?s-l*h-l+10:l*h-10,_=b-c,p=l-f;for(var x=0;x<v.length;x++){var k=e.annotation(v[x],"debugger_x"),y=e.annotation(v[x],"debugger_y"),j=e.annotation(v[x],"debugger_w");r.strokeStyle="#888888",r.lineWidth=2,r.beginPath(),r.moveTo(a+Math.ceil(_/2),g+(u?0:p)),r.lineTo(a+Math.ceil(_/2),g+(u?-Math.ceil(f/2):p+Math.ceil(f/2))),r.lineTo(k+Math.ceil(j/2),g+(u?-Math.ceil(f/2):p+Math.ceil(f/2))),r.lineTo(k+Math.ceil(j/2),y+(u?p:0)),r.stroke()}}var q="";t.marked(n.obj(),"view")&&(q+="V"),t.marked(n.obj(),"model")&&(q+="M"),t.marked(n.obj(),"controller")&&(q+="C"),t.marked(n.obj(),"service")&&(q+="S");var C,S,M,T;"V"===q?(C="#14426f",S="#ffffff",M="#2068b0",T="#adcef0"):"M"===q?(C="#6f5014",S="#ffffff",M="#9a6f1c",T="#e8c581"):"S"===q?(C="#e8e8e8",S="#000000",M="#ffffff",T="#666666"):(C="#444444",S="#ffffff",M="#777777",T="#cccccc"),r.save(),r.fillStyle=C,r.shadowColor="#888888",r.shadowBlur=6,r.shadowOffsetX=1,r.shadowOffsetY=1,r.fillRect(a,g,_,p),r.restore(),r.fillStyle=M,r.fillRect(a,g+p/2,_,p/2),r.save(),r.fillStyle=e.states[n.__state].color,r.shadowColor="#000000",r.shadowBlur=2,r.shadowOffsetX=0,r.shadowOffsetY=0,r.beginPath(),r.arc(a+_-p/4-1,g+p/4*3,p/4-3,0,2*Math.PI,!0),r.closePath(),r.fill(),r.restore();var z=!1;for(var J in n.__state_guards)if("number"==typeof n.__state_guards[J]&&0!==n.__state_guards[J]){z=!0;break}z&&(r.save(),r.fillStyle="#ff0000",r.shadowColor="#000000",r.shadowBlur=2,r.shadowOffsetX=0,r.shadowOffsetY=0,r.beginPath(),r.arc(a+_-p/4*2-1,g+p/4*3,p/4-3,0,2*Math.PI,!0),r.closePath(),r.fill(),r.restore());var E=function(e,t,o,n,d){r.fillStyle=t;var i=r.measureText(e);if(i.width>d)for(;""!==e;){if((i=r.measureText(e+"...")).width<=d){e+="...";break}e=e.substr(0,e.length-1)}r.fillText(e,o,n,d)},$=0;if(""!==q){r.font="bold "+p/2*.7+"px Helvetica, Arial, sans-serif",r.textBaseline="top";var X=r.measureText(q);E(q,T,a+_-X.width-4,g+2,X.width),$=X.width}r.font=p/2*.7+"px Helvetica, Arial, sans-serif",r.textBaseline="top",E(n.name(),S,a+4,g+2,_-$-8),E(n.state(),T,a+4,g+p/2+2,_-p/2-8),e.annotation(n,"debugger_x",a),e.annotation(n,"debugger_y",g),e.annotation(n,"debugger_w",_),e.annotation(n,"debugger_h",p)}return d},0);var _=function(t){var o=t.offsetX;void 0===o&&(o=t.layerX),void 0===o&&(o=t.clientX);var n=t.offsetY;void 0===n&&(n=t.layerY),void 0===n&&(n=t.clientY-e.jq(".dbg .header",e.dbg.document).height());var d=null;if(e.root.walk_down(function(t,i,a,r){if(r){var s=e.annotation(i,"debugger_x"),g=e.annotation(i,"debugger_y"),b=e.annotation(i,"debugger_w"),l=e.annotation(i,"debugger_h");s<=o&&o<=s+b&&g<=n&&n<=g+l&&(d=i)}},0),null!==d){var i=e.dbg_infobox_content(d);e.jq(".dbg .infobox",e.dbg.document).html(i),e.jq(".dbg .infobox",e.dbg.document).css("display","block")}},p=!1;e.jq(".dbg .viewer canvas",e.dbg.document).bind("mousedown",function(t){t.target===e.jq(".dbg .viewer canvas",e.dbg.document).get(0)&&(_(t),p=!0)}),e.jq(".dbg .viewer canvas",e.dbg.document).bind("mousemove",function(t){t.target===e.jq(".dbg .viewer canvas",e.dbg.document).get(0)&&p&&_(t)}),e.jq(".dbg .viewer canvas",e.dbg.document).bind("mouseup",function(t){t.target===e.jq(".dbg .viewer canvas",e.dbg.document).get(0)&&(e.jq(".dbg .infobox",e.dbg.document).css("display","none"),p=!1)})}e.dbg_state_invalid.components=!0,e.dbg_state_invalid.states=!0}},e.latch("ComponentJS:log",function(t){var o=!1;return null!==e.dbg&&(e.dbg_log(t),o=!0),o}),e.latch("ComponentJS:state-change",function(){e.dbg_update()}),e.latch("ComponentJS:state-invalidate",function(t){e.dbg_state_invalidate(t)})});
var singleSpa=Object.freeze({__proto__:null,get start(){return start},get ensureJQuerySupport(){return ensureJQuerySupport},get setBootstrapMaxTime(){return setBootstrapMaxTime},get setMountMaxTime(){return setMountMaxTime},get setUnmountMaxTime(){return setUnmountMaxTime},get setUnloadMaxTime(){return setUnloadMaxTime},get registerApplication(){return registerApplication},get unregisterApplication(){return unregisterApplication},get getMountedApps(){return getMountedApps},get getAppStatus(){return getAppStatus},get unloadApplication(){return unloadApplication},get checkActivityFunctions(){return checkActivityFunctions},get getAppNames(){return getAppNames},get pathToActiveWhen(){return pathToActiveWhen},get navigateToUrl(){return navigateToUrl},get patchHistoryApi(){return patchHistoryApi},get triggerAppChange(){return triggerAppChange},get addErrorHandler(){return addErrorHandler},get removeErrorHandler(){return removeErrorHandler},get mountRootParcel(){return mountRootParcel},get NOT_LOADED(){return NOT_LOADED},get LOADING_SOURCE_CODE(){return LOADING_SOURCE_CODE},get NOT_BOOTSTRAPPED(){return NOT_BOOTSTRAPPED},get BOOTSTRAPPING(){return BOOTSTRAPPING},get NOT_MOUNTED(){return NOT_MOUNTED},get MOUNTING(){return MOUNTING},get UPDATING(){return UPDATING},get LOAD_ERROR(){return LOAD_ERROR},get MOUNTED(){return MOUNTED},get UNMOUNTING(){return UNMOUNTING},get SKIP_BECAUSE_BROKEN(){return SKIP_BECAUSE_BROKEN}}),commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},NativeCustomEvent=commonjsGlobal.CustomEvent;function useNative(){try{var e=new NativeCustomEvent("cat",{detail:{foo:"bar"}});return"cat"===e.type&&"bar"===e.detail.foo}catch(e){}return!1}var customEvent=useNative()?NativeCustomEvent:"undefined"!=typeof document&&"function"==typeof document.createEvent?function(e,t){var r=document.createEvent("CustomEvent");return t?r.initCustomEvent(e,t.bubbles,t.cancelable,t.detail):r.initCustomEvent(e,!1,!1,void 0),r}:function(e,t){var r=document.createEventObject();return r.type=e,t?(r.bubbles=Boolean(t.bubbles),r.cancelable=Boolean(t.cancelable),r.detail=t.detail):(r.bubbles=!1,r.cancelable=!1,r.detail=void 0),r};let errorHandlers=[];function handleAppError(e,t,r){const n=transformErr(e,t,r);errorHandlers.length?errorHandlers.forEach(e=>e(n)):setTimeout(()=>{throw n})}function addErrorHandler(e){if("function"!=typeof e)throw Error(formatErrorMessage(28,"a single-spa error handler must be a function"));errorHandlers.push(e)}function removeErrorHandler(t){if("function"!=typeof t)throw Error(formatErrorMessage(29,"a single-spa error handler must be a function"));let r=!1;return errorHandlers=errorHandlers.filter(e=>{e=e===t;return r=r||e,!e}),r}function formatErrorMessage(e,t,...r){return`single-spa minified message #${e}: ${t?t+" ":""}See https://single-spa.js.org/error/?code=${e}${r.length?`&arg=${r.join("&arg=")}`:""}`}function transformErr(t,e,r){var n=`${objectType(e)} '${toName(e)}' died in status ${e.status}: `;let o;if(t instanceof Error){try{t.message=n+t.message}catch(e){}o=t}else{console.warn(formatErrorMessage(30,`While ${e.status}, '${toName(e)}' rejected its lifecycle function promise with a non-Error. This will cause stack traces to not be accurate.`,e.status,toName(e)));try{o=Error(n+JSON.stringify(t))}catch(e){o=t}}return o.appOrParcelName=toName(e),e.status=r,o}const NOT_LOADED="NOT_LOADED",LOADING_SOURCE_CODE="LOADING_SOURCE_CODE",NOT_BOOTSTRAPPED="NOT_BOOTSTRAPPED",BOOTSTRAPPING="BOOTSTRAPPING",NOT_MOUNTED="NOT_MOUNTED",MOUNTING="MOUNTING",MOUNTED="MOUNTED",UPDATING="UPDATING",UNMOUNTING="UNMOUNTING",UNLOADING="UNLOADING",LOAD_ERROR="LOAD_ERROR",SKIP_BECAUSE_BROKEN="SKIP_BECAUSE_BROKEN";function isActive(e){return e.status===MOUNTED}function shouldBeActive(t){try{return t.activeWhen(window.location)}catch(e){return handleAppError(e,t,SKIP_BECAUSE_BROKEN),!1}}function toName(e){return e.name}function isParcel(e){return Boolean(e.unmountThisParcel)}function objectType(e){return isParcel(e)?"parcel":"application"}function assign(){for(let e=arguments.length-1;0<e;e--)for(var t in arguments[e])"__proto__"!==t&&(arguments[e-1][t]=arguments[e][t]);return arguments[0]}function find(t,r){for(let e=0;e<t.length;e++)if(r(t[e]))return t[e];return null}function validLifecycleFn(e){return e&&("function"==typeof e||(t=e,Array.isArray(t)&&!find(t,e=>"function"!=typeof e)));var t}function flattenFnArray(e,o){let t=e[o]||[];t=Array.isArray(t)?t:[t],0===t.length&&(t=[()=>Promise.resolve()]);const a=objectType(e),i=toName(e);return function(n){return t.reduce((e,t,r)=>e.then(()=>{var e=t(n);return smellsLikeAPromise(e)?e:Promise.reject(formatErrorMessage(15,`Within ${a} ${i}, the lifecycle function ${o} at array index ${r} did not return a promise`,a,i,o,r))}),Promise.resolve())}}function smellsLikeAPromise(e){return e&&"function"==typeof e.then&&"function"==typeof e.catch}function toBootstrapPromise(t,r){return Promise.resolve().then(()=>t.status!==NOT_BOOTSTRAPPED?t:(t.status=BOOTSTRAPPING,t.bootstrap?reasonableTime(t,"bootstrap").then(e).catch(e=>{if(r)throw transformErr(e,t,SKIP_BECAUSE_BROKEN);return handleAppError(e,t,SKIP_BECAUSE_BROKEN),t}):Promise.resolve().then(e)));function e(){return t.status=NOT_MOUNTED,t}}function toUnmountPromise(n,o){return Promise.resolve().then(()=>{if(n.status!==MOUNTED)return n;n.status=UNMOUNTING;var e=Object.keys(n.parcels).map(e=>n.parcels[e].unmountThisParcel());return Promise.all(e).then(r,t=>r().then(()=>{var e=Error(t.message);if(o)throw transformErr(e,n,SKIP_BECAUSE_BROKEN);handleAppError(e,n,SKIP_BECAUSE_BROKEN)})).then(()=>n);function r(){return reasonableTime(n,"unmount").then(()=>{n.status=NOT_MOUNTED}).catch(e=>{if(o)throw transformErr(e,n,SKIP_BECAUSE_BROKEN);handleAppError(e,n,SKIP_BECAUSE_BROKEN)})}})}let beforeFirstMountFired=!1,firstMountFired=!1;function toMountPromise(r,n){return Promise.resolve().then(()=>r.status!==NOT_MOUNTED?r:(beforeFirstMountFired||(window.dispatchEvent(new customEvent("single-spa:before-first-mount")),beforeFirstMountFired=!0),r.status=MOUNTING,reasonableTime(r,"mount").then(()=>(r.status=MOUNTED,firstMountFired||(window.dispatchEvent(new customEvent("single-spa:first-mount")),firstMountFired=!0),r)).catch(e=>{return r.status=MOUNTED,toUnmountPromise(r,!0).then(t,t);function t(){if(n)throw transformErr(e,r,SKIP_BECAUSE_BROKEN);return handleAppError(e,r,SKIP_BECAUSE_BROKEN),r}})))}function toUpdatePromise(t){return Promise.resolve().then(()=>{if(t.status!==MOUNTED)throw Error(formatErrorMessage(32,`Cannot update parcel '${toName(t)}' because it is not mounted`,toName(t)));return t.status=UPDATING,reasonableTime(t,"update").then(()=>(t.status=MOUNTED,t)).catch(e=>{throw transformErr(e,t,SKIP_BECAUSE_BROKEN)})})}let parcelCount=0;const rootParcels={parcels:{}};function mountRootParcel(){return mountParcel.apply(rootParcels,arguments)}function mountParcel(e,t){const r=this;if(!e||"object"!=typeof e&&"function"!=typeof e)throw Error(formatErrorMessage(2,"Cannot mount parcel without a config object or config loading function"));if(e.name&&"string"!=typeof e.name)throw Error(formatErrorMessage(3,`Parcel name must be a string, if provided. Was given ${typeof e.name}`,typeof e.name));const o=parcelCount++;let a=e.name||`parcel-${o}`;if("object"!=typeof t)throw Error(formatErrorMessage(4,`Parcel ${a} has invalid customProps -- must be an object but was given ${typeof t}`,a,typeof t));if(!t.domElement)throw Error(formatErrorMessage(5,`Parcel ${a} cannot be mounted without a domElement provided as a prop`,a));var n="function"==typeof e;const i=n?e:()=>Promise.resolve(e),s={id:o,parcels:{},status:n?LOADING_SOURCE_CODE:NOT_BOOTSTRAPPED,customProps:t,parentName:toName(r),unmountThisParcel(){return c.then(()=>{if(s.status!==MOUNTED)throw Error(formatErrorMessage(6,`Cannot unmount parcel '${a}' -- it is in a ${s.status} status`,a,s.status));return toUnmountPromise(s,!0)}).then(e=>(s.parentName&&delete r.parcels[s.id],e)).then(e=>(m(e),e)).catch(e=>{throw s.status=SKIP_BECAUSE_BROKEN,f(e),e})}};let u;r.parcels[o]=s;let l=i();if(!l||"function"!=typeof l.then)throw Error(formatErrorMessage(7,"When mounting a parcel, the config loading function must return a promise that resolves with the parcel config"));l=l.then(e=>{if(!e)throw Error(formatErrorMessage(8,"When mounting a parcel, the config loading function returned a promise that did not resolve with a parcel config"));if(a=e.name||`parcel-${o}`,Object.prototype.hasOwnProperty.call(e,"bootstrap")&&!validLifecycleFn(e.bootstrap))throw Error(formatErrorMessage(9,`Parcel ${a} provided an invalid bootstrap function`,a));if(!validLifecycleFn(e.mount))throw Error(formatErrorMessage(10,`Parcel ${a} must have a valid mount function`,a));if(!validLifecycleFn(e.unmount))throw Error(formatErrorMessage(11,`Parcel ${a} must have a valid unmount function`,a));if(e.update&&!validLifecycleFn(e.update))throw Error(formatErrorMessage(12,`Parcel ${a} provided an invalid update function`,a));var t=flattenFnArray(e,"bootstrap"),r=flattenFnArray(e,"mount"),n=flattenFnArray(e,"unmount");s.status=NOT_BOOTSTRAPPED,s.name=a,s.bootstrap=t,s.mount=r,s.unmount=n,s.timeouts=ensureValidAppTimeouts(e.timeouts),e.update&&(s.update=flattenFnArray(e,"update"),u.update=function(e){return s.customProps=e,promiseWithoutReturnValue(toUpdatePromise(s))})});const p=l.then(()=>toBootstrapPromise(s,!0)),c=p.then(()=>toMountPromise(s,!0));let m,f;t=new Promise((e,t)=>{m=e,f=t});return u={mount(){return promiseWithoutReturnValue(Promise.resolve().then(()=>{if(s.status!==NOT_MOUNTED)throw Error(formatErrorMessage(13,`Cannot mount parcel '${a}' -- it is in a ${s.status} status`,a,s.status));return r.parcels[o]=s,toMountPromise(s)}))},unmount(){return promiseWithoutReturnValue(s.unmountThisParcel())},getStatus(){return s.status},loadPromise:promiseWithoutReturnValue(l),bootstrapPromise:promiseWithoutReturnValue(p),mountPromise:promiseWithoutReturnValue(c),unmountPromise:promiseWithoutReturnValue(t)},u}function promiseWithoutReturnValue(e){return e.then(()=>null)}function getProps(e){var t=toName(e);let r="function"==typeof e.customProps?e.customProps(t,window.location):e.customProps;"object"==typeof r&&null!==r&&!Array.isArray(r)||(r={},console.warn(formatErrorMessage(40,`single-spa: ${t}'s customProps function must return an object. Received ${r}`),t,r));const n=assign({},r,{name:t,mountParcel:mountParcel.bind(e),singleSpa:singleSpa});return isParcel(e)&&(n.unmountSelf=e.unmountThisParcel),n}const defaultWarningMillis=1e3,globalTimeoutConfig={bootstrap:{millis:4e3,dieOnTimeout:!1,warningMillis:defaultWarningMillis},mount:{millis:3e3,dieOnTimeout:!1,warningMillis:defaultWarningMillis},unmount:{millis:3e3,dieOnTimeout:!1,warningMillis:defaultWarningMillis},unload:{millis:3e3,dieOnTimeout:!1,warningMillis:defaultWarningMillis},update:{millis:3e3,dieOnTimeout:!1,warningMillis:defaultWarningMillis}};function setBootstrapMaxTime(e,t,r){if("number"!=typeof e||e<=0)throw Error(formatErrorMessage(16,"bootstrap max time must be a positive integer number of milliseconds"));globalTimeoutConfig.bootstrap={millis:e,dieOnTimeout:t,warningMillis:r||defaultWarningMillis}}function setMountMaxTime(e,t,r){if("number"!=typeof e||e<=0)throw Error(formatErrorMessage(17,"mount max time must be a positive integer number of milliseconds"));globalTimeoutConfig.mount={millis:e,dieOnTimeout:t,warningMillis:r||defaultWarningMillis}}function setUnmountMaxTime(e,t,r){if("number"!=typeof e||e<=0)throw Error(formatErrorMessage(18,"unmount max time must be a positive integer number of milliseconds"));globalTimeoutConfig.unmount={millis:e,dieOnTimeout:t,warningMillis:r||defaultWarningMillis}}function setUnloadMaxTime(e,t,r){if("number"!=typeof e||e<=0)throw Error(formatErrorMessage(19,"unload max time must be a positive integer number of milliseconds"));globalTimeoutConfig.unload={millis:e,dieOnTimeout:t,warningMillis:r||defaultWarningMillis}}function reasonableTime(e,s){const u=e.timeouts[s],l=u.warningMillis,p=objectType(e);return new Promise((t,r)=>{let n=!1,o=!1;e[s](getProps(e)).then(e=>{n=!0,t(e)}).catch(e=>{n=!0,r(e)}),setTimeout(()=>i(1),l),setTimeout(()=>i(!0),u.millis);const a=formatErrorMessage(31,`Lifecycle function ${s} for ${p} ${toName(e)} lifecycle did not resolve or reject for ${u.millis} ms.`,s,p,toName(e),u.millis);function i(e){if(!n)if(!0===e)o=!0,u.dieOnTimeout?r(Error(a)):console.error(a);else if(!o){const t=e;e=t*l;console.warn(a),e+l<u.millis&&setTimeout(()=>i(t+1),l)}}})}function ensureValidAppTimeouts(e){const t={};for(var r in globalTimeoutConfig)t[r]=assign({},globalTimeoutConfig[r],e&&e[r]||{});return t}function toLoadPromise(a){return Promise.resolve().then(()=>{if(a.loadPromise)return a.loadPromise;if(a.status!==NOT_LOADED&&a.status!==LOAD_ERROR)return a;a.status=LOADING_SOURCE_CODE;let o,r;return a.loadPromise=Promise.resolve().then(()=>{const e=a.loadApp(getProps(a));if(!smellsLikeAPromise(e))throw r=!0,Error(formatErrorMessage(33,`single-spa loading function did not return a promise. Check the second argument to registerApplication('${toName(a)}', loadingFunction, activityFunction)`,toName(a)));return e.then(t=>{a.loadErrorTime=null,o=t;let r,n;"object"!=typeof o&&(n=34,r="does not export anything"),Object.prototype.hasOwnProperty.call(o,"bootstrap")&&!validLifecycleFn(o.bootstrap)&&(n=35,r="does not export a valid bootstrap function or array of functions"),validLifecycleFn(o.mount)||(n=36,r="does not export a mount function or array of functions"),validLifecycleFn(o.unmount)||(n=37,r="does not export a unmount function or array of functions");t=objectType(o);if(n){let e;try{e=JSON.stringify(o)}catch(e){}return console.error(formatErrorMessage(n,`The loading function for single-spa ${t} '${toName(a)}' resolved with the following, which does not have bootstrap, mount, and unmount functions`,t,toName(a),e),o),handleAppError(r,a,SKIP_BECAUSE_BROKEN),a}return o.devtools&&o.devtools.overlays&&(a.devtools.overlays=assign({},a.devtools.overlays,o.devtools.overlays)),a.status=NOT_BOOTSTRAPPED,a.bootstrap=flattenFnArray(o,"bootstrap"),a.mount=flattenFnArray(o,"mount"),a.unmount=flattenFnArray(o,"unmount"),a.unload=flattenFnArray(o,"unload"),a.timeouts=ensureValidAppTimeouts(o.timeouts),delete a.loadPromise,a})}).catch(e=>{delete a.loadPromise;let t;return r?t=SKIP_BECAUSE_BROKEN:(t=LOAD_ERROR,a.loadErrorTime=(new Date).getTime()),handleAppError(e,a,t),a})})}const isInBrowser="undefined"!=typeof window,capturedEventListeners={hashchange:[],popstate:[]},routingEventsListeningTo=["hashchange","popstate"];function navigateToUrl(e){let t;if("string"==typeof e)t=e;else if(this&&this.href)t=this.href;else{if(!(e&&e.currentTarget&&e.currentTarget.href&&e.preventDefault))throw Error(formatErrorMessage(14,"singleSpaNavigate/navigateToUrl must be either called with a string url, with an <a> tag as its context, or with an event whose currentTarget is an <a> tag"));t=e.currentTarget.href,e.preventDefault()}var r=parseUri(window.location.href),e=parseUri(t);0===t.indexOf("#")?window.location.hash=e.hash:r.host!==e.host&&e.host?window.location.href=t:e.pathname===r.pathname&&e.search===r.search?window.location.hash=e.hash:window.history.pushState(null,null,t)}function callCapturedEventListeners(t){var e;t&&(e=t[0].type,0<=routingEventsListeningTo.indexOf(e)&&capturedEventListeners[e].forEach(e=>{try{e.apply(this,t)}catch(e){setTimeout(()=>{throw e})}}))}let urlRerouteOnly;function urlReroute(){reroute([],arguments)}function patchedUpdateState(n,o){return function(){var e=window.location.href,t=n.apply(this,arguments),r=window.location.href;return urlRerouteOnly&&e===r||window.dispatchEvent(createPopStateEvent(window.history.state,o)),t}}function createPopStateEvent(t,e){let r;try{r=new PopStateEvent("popstate",{state:t})}catch(e){r=document.createEvent("PopStateEvent"),r.initPopStateEvent("popstate",!1,!1,t)}return r.singleSpa=!0,r.singleSpaTrigger=e,r}let originalReplaceState=null,historyApiIsPatched=!1;function patchHistoryApi(e){if(historyApiIsPatched)throw Error(formatErrorMessage(43,"single-spa: patchHistoryApi() was called after the history api was already patched."));urlRerouteOnly=!e||!e.hasOwnProperty("urlRerouteOnly")||e.urlRerouteOnly,historyApiIsPatched=!0,originalReplaceState=window.history.replaceState,window.addEventListener("hashchange",urlReroute),window.addEventListener("popstate",urlReroute);const r=window.addEventListener,n=window.removeEventListener;window.addEventListener=function(e,t){if(!("function"==typeof t&&0<=routingEventsListeningTo.indexOf(e))||find(capturedEventListeners[e],e=>e===t))return r.apply(this,arguments);capturedEventListeners[e].push(t)},window.removeEventListener=function(e,t){if(!("function"==typeof t&&0<=routingEventsListeningTo.indexOf(e)))return n.apply(this,arguments);capturedEventListeners[e]=capturedEventListeners[e].filter(e=>e!==t)},window.history.pushState=patchedUpdateState(window.history.pushState,"pushState"),window.history.replaceState=patchedUpdateState(originalReplaceState,"replaceState")}function parseUri(e){const t=document.createElement("a");return t.href=e,t}isInBrowser&&(window.singleSpaNavigate?console.warn(formatErrorMessage(41,"single-spa has been loaded twice on the page. This can result in unexpected behavior.")):window.singleSpaNavigate=navigateToUrl);let hasInitialized=!1;function ensureJQuerySupport(e=window.jQuery){if(e||window.$&&window.$.fn&&window.$.fn.jquery&&(e=window.$),e&&!hasInitialized){const r=e.fn.on,n=e.fn.off;e.fn.on=function(e,t){return captureRoutingEvents.call(this,r,window.addEventListener,e,t,arguments)},e.fn.off=function(e,t){return captureRoutingEvents.call(this,n,window.removeEventListener,e,t,arguments)},hasInitialized=!0}}function captureRoutingEvents(e,t,r,n,o){if("string"!=typeof r)return e.apply(this,o);const a=r.split(/\s+/);return a.forEach(e=>{0<=routingEventsListeningTo.indexOf(e)&&(t(e,n),r=r.replace(e,""))}),""===r.trim()?this:e.apply(this,o)}const appsToUnload={};function toUnloadPromise(r){return Promise.resolve().then(()=>{const t=appsToUnload[toName(r)];if(!t)return r;if(r.status===NOT_LOADED)return finishUnloadingApp(r,t),r;if(r.status===UNLOADING)return t.promise.then(()=>r);if(r.status!==NOT_MOUNTED&&r.status!==LOAD_ERROR)return r;const e=r.status===LOAD_ERROR?Promise.resolve():reasonableTime(r,"unload");return r.status=UNLOADING,e.then(()=>(finishUnloadingApp(r,t),r)).catch(e=>(errorUnloadingApp(r,t,e),r))})}function finishUnloadingApp(e,t){delete appsToUnload[toName(e)],delete e.bootstrap,delete e.mount,delete e.unmount,delete e.unload,e.status=NOT_LOADED,t.resolve()}function errorUnloadingApp(e,t,r){delete appsToUnload[toName(e)],delete e.bootstrap,delete e.mount,delete e.unmount,delete e.unload,handleAppError(r,e,SKIP_BECAUSE_BROKEN),t.reject(r)}function addAppToUnload(e,t,r,n){appsToUnload[toName(e)]={app:e,resolve:r,reject:n},Object.defineProperty(appsToUnload[toName(e)],"promise",{get:t})}function getAppUnloadInfo(e){return appsToUnload[e]}const apps=[];function getAppChanges(){const r=[],n=[],o=[],a=[],i=(new Date).getTime();return apps.forEach(e=>{var t=e.status!==SKIP_BECAUSE_BROKEN&&shouldBeActive(e);switch(e.status){case LOAD_ERROR:t&&200<=i-e.loadErrorTime&&o.push(e);break;case NOT_LOADED:case LOADING_SOURCE_CODE:t&&o.push(e);break;case NOT_BOOTSTRAPPED:case NOT_MOUNTED:!t&&getAppUnloadInfo(toName(e))?r.push(e):t&&a.push(e);break;case MOUNTED:t||n.push(e)}}),{appsToUnload:r,appsToUnmount:n,appsToLoad:o,appsToMount:a}}function getMountedApps(){return apps.filter(isActive).map(toName)}function getAppNames(){return apps.map(toName)}function getRawAppData(){return[...apps]}function getAppStatus(t){var e=find(apps,e=>toName(e)===t);return e?e.status:null}let startWarningInitialized=!1;function registerApplication(e,t,r,n){n=sanitizeArguments(e,t,r,n);if(isStarted()||startWarningInitialized||(startWarningInitialized=!0,setTimeout(()=>{isStarted()||console.warn(formatErrorMessage(1,"singleSpa.start() has not been called, 5000ms after single-spa was loaded. Before start() is called, apps can be declared and loaded, but not bootstrapped or mounted."))},5e3)),-1!==getAppNames().indexOf(n.name))throw Error(formatErrorMessage(21,`There is already an app registered with name ${n.name}`,n.name));apps.push(assign({loadErrorTime:null,status:NOT_LOADED,parcels:{},devtools:{overlays:{options:{},selectors:[]}}},n)),isInBrowser&&(ensureJQuerySupport(),reroute())}function checkActivityFunctions(t=window.location){return apps.filter(e=>e.activeWhen(t)).map(toName)}function unregisterApplication(t){if(0===apps.filter(e=>toName(e)===t).length)throw Error(formatErrorMessage(25,`Cannot unregister application '${t}' because no such application has been registered`,t));return unloadApplication(t).then(()=>{var e=apps.map(toName).indexOf(t);apps.splice(e,1)})}function unloadApplication(t,e={waitForUnmount:!1}){if("string"!=typeof t)throw Error(formatErrorMessage(26,"unloadApplication requires a string 'appName'"));const n=find(apps,e=>toName(e)===t);if(!n)throw Error(formatErrorMessage(27,`Could not unload application '${t}' because no such application has been registered`,t));var o=getAppUnloadInfo(toName(n));if(e&&e.waitForUnmount){if(o)return o.promise;{const r=new Promise((e,t)=>{addAppToUnload(n,()=>r,e,t)});return r}}{let r;return o?(r=o.promise,immediatelyUnloadApp(n,o.resolve,o.reject)):r=new Promise((e,t)=>{addAppToUnload(n,()=>r,e,t),immediatelyUnloadApp(n,e,t)}),r}}function immediatelyUnloadApp(e,t,r){toUnmountPromise(e).then(toUnloadPromise).then(()=>{t(),setTimeout(()=>{reroute()})}).catch(r)}function validateRegisterWithArguments(e,t,r,n){if("string"!=typeof e||0===e.length)throw Error(formatErrorMessage(20,"The 1st argument to registerApplication must be a non-empty string 'appName'"));if(!t)throw Error(formatErrorMessage(23,"The 2nd argument to registerApplication must be an application or loading application function"));if("function"!=typeof r)throw Error(formatErrorMessage(24,"The 3rd argument to registerApplication must be an activeWhen function"));if(!validCustomProps(n))throw Error(formatErrorMessage(22,"The optional 4th argument is a customProps and must be an object"))}function validateRegisterWithConfig(e){if(Array.isArray(e)||null===e)throw Error(formatErrorMessage(39,"Configuration object can't be an Array or null!"));const r=["name","app","activeWhen","customProps"],t=Object.keys(e).reduce((e,t)=>0<=r.indexOf(t)?e:e.concat(t),[]);if(0!==t.length)throw Error(formatErrorMessage(38,`The configuration object accepts only: ${r.join(", ")}. Invalid keys: ${t.join(", ")}.`,r.join(", "),t.join(", ")));if("string"!=typeof e.name||0===e.name.length)throw Error(formatErrorMessage(20,"The config.name on registerApplication must be a non-empty string"));if("object"!=typeof e.app&&"function"!=typeof e.app)throw Error(formatErrorMessage(20,"The config.app on registerApplication must be an application or a loading function"));var n=e=>"string"==typeof e||"function"==typeof e;if(!(n(e.activeWhen)||Array.isArray(e.activeWhen)&&e.activeWhen.every(n)))throw Error(formatErrorMessage(24,"The config.activeWhen on registerApplication must be a string, function or an array with both"));if(!validCustomProps(e.customProps))throw Error(formatErrorMessage(22,"The optional config.customProps must be an object"))}function validCustomProps(e){return!e||"function"==typeof e||"object"==typeof e&&null!==e&&!Array.isArray(e)}function sanitizeArguments(e,t,r,n){const o={name:null,loadApp:null,activeWhen:null,customProps:null};return"object"==typeof e?(validateRegisterWithConfig(e),o.name=e.name,o.loadApp=e.app,o.activeWhen=e.activeWhen,o.customProps=e.customProps):(validateRegisterWithArguments(e,t,r,n),o.name=e,o.loadApp=t,o.activeWhen=r,o.customProps=n),o.loadApp=sanitizeLoadApp(o.loadApp),o.customProps=sanitizeCustomProps(o.customProps),o.activeWhen=sanitizeActiveWhen(o.activeWhen),o}function sanitizeLoadApp(e){return"function"!=typeof e?()=>Promise.resolve(e):e}function sanitizeCustomProps(e){return e||{}}function sanitizeActiveWhen(e){let r=Array.isArray(e)?e:[e];return r=r.map(e=>"function"==typeof e?e:pathToActiveWhen(e)),t=>r.some(e=>e(t))}function pathToActiveWhen(e,t){const r=toDynamicPathValidatorRegex(e,t);return e=>{let t=e.origin;t=t||`${e.protocol}//${e.host}`;e=e.href.replace(t,"").replace(e.search,"").split("?")[0];return r.test(e)}}function toDynamicPathValidatorRegex(r,n){let o=0,a=!1,i="^";"/"!==r[0]&&(r="/"+r);for(let e=0;e<r.length;e++){var t=r[e],s=!a&&":"===t,t=a&&"/"===t;(s||t)&&u(e)}return u(r.length),new RegExp(i,"i");function u(e){var t=r.slice(o,e).replace(/[|\\{}()[\]^$+*?.]/g,"\\$&");i+=a?"[^/]+/?":t,e===r.length&&(a?n&&(i+="$"):(t=n?"":".*",i="/"===i.charAt(i.length-1)?`${i}${t}$`:`${i}(/${t})?(#.*)?$`)),a=!a,o=e}}let appChangeUnderway=!1,peopleWaitingOnAppChange=[],currentUrl=isInBrowser&&window.location.href;function triggerAppChange(){return reroute()}function reroute(a=[],i,r=!1){if(appChangeUnderway)return new Promise((e,t)=>{peopleWaitingOnAppChange.push({resolve:e,reject:t,eventArguments:i})});const{appsToUnload:s,appsToUnmount:u,appsToLoad:l,appsToMount:p}=getAppChanges();let c,n=[],m=currentUrl,f=currentUrl=window.location.href;return isStarted()?(appChangeUnderway=!0,c=s.concat(l,u,p),Promise.resolve().then(()=>(E(0===c.length?"before-no-app-change":"before-app-change",g(!0)),E("before-routing-event",g(!0,{cancelNavigation:e})),Promise.all(n).then(e=>{if(e.some(e=>e))return originalReplaceState.call(window.history,history.state,"",m.substring(location.origin.length)),currentUrl=location.href,appChangeUnderway=!1,reroute(a,i,!0);e=s.map(toUnloadPromise);const t=u.map(toUnmountPromise).map(e=>e.then(toUnloadPromise));e=t.concat(e);const r=Promise.all(e);r.then(()=>{E("before-mount-routing-event",g(!0))});const n=l.map(e=>toLoadPromise(e).then(e=>tryToBootstrapAndMount(e,r))),o=p.filter(e=>l.indexOf(e)<0).map(e=>tryToBootstrapAndMount(e,r));return r.catch(e=>{throw h(),e}).then(()=>(h(),Promise.all(n.concat(o)).catch(t=>{throw a.forEach(e=>e.reject(t)),t}).then(d)))})))):(c=l,Promise.resolve().then(()=>{var e=l.map(toLoadPromise);return Promise.all(e).then(h).then(()=>[]).catch(e=>{throw h(),e})}));function e(e=!0){const t="function"==typeof(null==e?void 0:e.then)?e:Promise.resolve(e);n.push(t.catch(e=>(console.warn(Error(formatErrorMessage(42,`single-spa: A cancelNavigation promise rejected with the following value: ${e}`))),console.warn(e),!1)))}function d(){const t=getMountedApps();a.forEach(e=>e.resolve(t));try{E(0===c.length?"no-app-change":"app-change",g()),E("routing-event",g())}catch(e){setTimeout(()=>{throw e})}var e;return appChangeUnderway=!1,0<peopleWaitingOnAppChange.length&&(e=peopleWaitingOnAppChange,peopleWaitingOnAppChange=[],reroute(e)),t}function h(){r||(a.forEach(e=>{callCapturedEventListeners(e.eventArguments)}),callCapturedEventListeners(i))}function g(e=!1,t){const n={},o={[MOUNTED]:[],[NOT_MOUNTED]:[],[NOT_LOADED]:[],[SKIP_BECAUSE_BROKEN]:[]};e?(l.concat(p).forEach((e,t)=>{r(e,MOUNTED)}),s.forEach(e=>{r(e,NOT_LOADED)}),u.forEach(e=>{r(e,NOT_MOUNTED)})):c.forEach(e=>{r(e)});e={detail:{newAppStatuses:n,appsByNewStatus:o,totalAppChanges:c.length,originalEvent:null==i?void 0:i[0],oldUrl:m,newUrl:f}};return t&&assign(e.detail,t),e;function r(e,t){e=toName(e);t=t||getAppStatus(e),n[e]=t;const r=o[t]=o[t]||[];r.push(e)}}function E(e,t){r||window.dispatchEvent(new customEvent(`single-spa:${e}`,t))}}function tryToBootstrapAndMount(e,t){return shouldBeActive(e)?toBootstrapPromise(e).then(e=>t.then(()=>shouldBeActive(e)?toMountPromise(e):e)):t.then(()=>e)}let started=!1;function start(e){started=!0,isInBrowser&&(patchHistoryApi(e),reroute())}function isStarted(){return started}var devtools={getRawAppData:getRawAppData,reroute:reroute,NOT_LOADED:NOT_LOADED,toLoadPromise:toLoadPromise,toBootstrapPromise:toBootstrapPromise,unregisterApplication:unregisterApplication};isInBrowser&&window.__SINGLE_SPA_DEVTOOLS__&&(window.__SINGLE_SPA_DEVTOOLS__.exposedMethods=devtools);export{BOOTSTRAPPING,LOADING_SOURCE_CODE,LOAD_ERROR,MOUNTED,MOUNTING,NOT_BOOTSTRAPPED,NOT_LOADED,NOT_MOUNTED,SKIP_BECAUSE_BROKEN,UNMOUNTING,UPDATING,addErrorHandler,checkActivityFunctions,ensureJQuerySupport,getAppNames,getAppStatus,getMountedApps,mountRootParcel,navigateToUrl,patchHistoryApi,pathToActiveWhen,registerApplication,removeErrorHandler,setBootstrapMaxTime,setMountMaxTime,setUnloadMaxTime,setUnmountMaxTime,start,triggerAppChange,unloadApplication,unregisterApplication};
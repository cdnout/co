!function(){"use strict";provide(["/demand/weakmap","/demand/function/iterate"],function(t,p){var n=/^(_|((get|has|is)([A-Z]|$))|(on|one|off|emit|constructor)$)/,f=Object.defineProperty,c=Object.getOwnPropertyNames,u=Object.getOwnPropertyDescriptor,e=Object.getPrototypeOf,s=Object.prototype,r=new t;function a(t){return r.get(t)||r.set(t,{})&&r.get(t)}function o(){return e(self)!==o.prototype&&function(){var o=this,i=o.constructor.prototype;(function(){var t,e,r,o=i,n=[];try{for(;o!==s;){for(t=c(o),e=0;r=t[e];e++)-1===n.indexOf(r)&&n.push(r);o=o.__proto__}}catch(t){}return n})().forEach(function(e){var r,t=function(t){for(var e,r=i;r&&!(e=u(r,t));)r=r.__proto__;return e}(e);t.get||"function"!=typeof o[e]||!1!==n.test(e)||(r=e.charAt(0).toUpperCase()+e.slice(1),t.value=function(){var t;return o.emit("pre"+r,arguments),t=i[e].apply(o,arguments),o.emit("post"+r,arguments,t),t},f(o,e,t))})}.call(this),this}return o.prototype={on:function(t,e){var r,o=a(this),n=0;for(t=t.split(" ");void 0!==(r=t[n]);n++)(o[r]=o[r]||[]).push(e);return this},one:function(r,o,n){var i=this;return n=!1!==n,i.on(r,function t(e){i.off(!0===n?e:r,t),o.apply(this,arguments)}),i},off:function(t,e){var r,o,n,i=this,f=a(i),c=0;if(t)for(t=t.split(" ");void 0!==(r=t[c]);c++)if(f[r]=f[r]||[],e)for(o=0;void 0!==(n=f[r][o]);o++)n===e&&(f[r].splice(o,1),o--);else f[r].length=0;else p(i.listener,function(t){f[t].length=0});return i},emit:function(t){var e,r,o,n=this,i=0;if(t)for((e=a(n))[t]=e[t]||[],r=e[t].slice();void 0!==(o=r[i]);i++)o.apply(n,arguments);return n}},o})}();
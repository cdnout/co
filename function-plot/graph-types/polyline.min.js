"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const d3_selection_1=require("d3-selection"),d3_shape_1=require("d3-shape"),clamp_1=__importDefault(require("clamp")),utils_1=__importDefault(require("../utils")),evaluate_1=__importDefault(require("../evaluate"));function polyline(e){return function t(r){r.each(function(r){const a=t.el=d3_selection_1.select(this),l=r.index,n=evaluate_1.default(e,r),i=utils_1.default.color(r,l),u=a.selectAll(":scope > path.line").data(n),o=e.meta.yScale.range();let c=o[0],s=o[1];const _=c-s;function p(t){return clamp_1.default(e.meta.yScale(t[1]),s,c)}c+=1e6*_,s-=1e6*_,r.skipBoundsCheck&&(c=1/0,s=-1/0);const d=d3_shape_1.line().curve(d3_shape_1.curveLinear).x(function(t){return e.meta.xScale(t[0])}).y(p),f=d3_shape_1.area().x(function(t){return e.meta.yScale(t[0])}).y0(e.meta.yScale(0)).y1(p),m=u.enter().append("path").attr("class","line line-"+l).attr("stroke-width",1).attr("stroke-linecap","round");u.merge(m).each(function(){const t=d3_selection_1.select(this);let a;if(r.closed?(t.attr("fill",i),t.attr("fill-opacity",.3),a=f):(t.attr("fill","none"),a=d),t.attr("stroke",i).attr("marker-end",function(){return"vector"===r.fnType?"url(#"+e.markerId+")":null}).attr("d",a),r.attr)for(let e in r.attr)r.attr.hasOwnProperty(e)&&t.attr(e,r.attr[e])}),u.exit().remove()})}}exports.default=polyline;
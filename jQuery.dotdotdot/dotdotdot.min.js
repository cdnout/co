var Dotdotdot=function(){function c(t,e){void 0===e&&(e=c.options);var i=this;for(var n in this.container=t,this.options=e||{},this.watchTimeout=null,this.watchInterval=null,this.resizeEvent=null,c.options)c.options.hasOwnProperty(n)&&void 0===this.options[n]&&(this.options[n]=c.options[n]);var o=this.container.dotdotdot;o&&o.destroy(),this.API={},["truncate","restore","destroy","watch","unwatch"].forEach(function(t){i.API[t]=function(){return i[t].call(i)}}),this.container.dotdotdot=this.API,this.originalStyle=this.container.getAttribute("style")||"",this.originalContent=this._getOriginalContent(),this.ellipsis=document.createTextNode(this.options.ellipsis);var r=window.getComputedStyle(this.container);"break-word"!==r["word-wrap"]&&(this.container.style["word-wrap"]="break-word"),"pre"===r["white-space"]?this.container.style["white-space"]="pre-wrap":"nowrap"===r["white-space"]&&(this.container.style["white-space"]="normal"),null===this.options.height&&(this.options.height=this._getMaxHeight()),this.truncate(),this.options.watch&&this.watch()}return c.prototype.restore=function(){var e=this;this.unwatch(),this.container.setAttribute("style",this.originalStyle),this.container.classList.remove("ddd-truncated"),this.container.innerHTML="",this.originalContent.forEach(function(t){e.container.append(t)})},c.prototype.destroy=function(){this.restore(),this.container.dotdotdot=null},c.prototype.watch=function(){var o=this;this.unwatch();function e(t,e,i){if(o.container.offsetWidth||o.container.offsetHeight||o.container.getClientRects().length){var n={width:t[e],height:t[i]};return r.width==n.width&&r.height==n.height||o.truncate(),n}return r}var r={width:null,height:null};"window"===this.options.watch?(this.resizeEvent=function(t){o.watchTimeout&&clearTimeout(o.watchTimeout),o.watchTimeout=setTimeout(function(){r=e(window,"innerWidth","innerHeight")},100)},window.addEventListener("resize",this.resizeEvent)):this.watchInterval=setInterval(function(){r=e(o.container,"clientWidth","clientHeight")},1e3)},c.prototype.unwatch=function(){this.resizeEvent&&(window.removeEventListener("resize",this.resizeEvent),this.resizeEvent=null),this.watchInterval&&clearInterval(this.watchInterval),this.watchTimeout&&clearTimeout(this.watchTimeout)},c.prototype.truncate=function(){var e=this,t=!1;return this.container.innerHTML="",this.originalContent.forEach(function(t){e.container.append(t.cloneNode(!0))}),this.maxHeight=this._getMaxHeight(),this._fits()||(t=!0,this._truncateToNode(this.container)),this.container.classList[t?"add":"remove"]("ddd-truncated"),this.options.callback.call(this.container,t),t},c.prototype._truncateToNode=function(t){var i=[],n=[];if(c.$.contents(t).forEach(function(t){var e;1==t.nodeType&&t.matches(".ddd-keep")||(e=document.createComment(""),t.replaceWith(e),n.push(t),i.push(e))}),n.length){for(var e=0;e<n.length;e++){i[e].replaceWith(n[e]);var o=this.ellipsis.cloneNode(!0);switch(n[e].nodeType){case 1:n[e].append(o);break;case 3:n[e].after(o)}var r=this._fits();if(o.parentElement.removeChild(o),!r){if("node"==this.options.truncate&&1<e)return void n[e-2].remove();break}}for(var s=e;s<i.length;s++)i[s].remove();var a,h=n[Math.max(0,Math.min(e,n.length-1))];1==h.nodeType&&((a=document.createElement(h.nodeName)).append(this.ellipsis),h.replaceWith(a),this._fits()?a.replaceWith(h):(a.remove(),h=n[Math.max(0,e-1)])),1==h.nodeType?this._truncateToNode(h):this._truncateToWord(h)}},c.prototype._truncateToWord=function(t){for(var e=t.textContent,i=-1!==e.indexOf(" ")?" ":"　",n=e.split(i),o=n.length;0<=o;o--)if(t.textContent=this._addEllipsis(n.slice(0,o).join(i)),this._fits()){"letter"==this.options.truncate&&(t.textContent=n.slice(0,o+1).join(i),this._truncateToLetter(t));break}},c.prototype._truncateToLetter=function(t){for(var e=t.textContent.split(""),i="",n=e.length;0<=n&&(!(i=e.slice(0,n).join("")).length||(t.textContent=this._addEllipsis(i),!this._fits()));n--);},c.prototype._fits=function(){return this.container.scrollHeight<=this.maxHeight+this.options.tolerance},c.prototype._addEllipsis=function(t){for(var e=[" ","　",",",";",".","!","?"];-1<e.indexOf(t.slice(-1));)t=t.slice(0,-1);return t+this.ellipsis.textContent},c.prototype._getOriginalContent=function(){var t="script, style";this.options.keep&&(t+=", "+this.options.keep),c.$.find(t,this.container).forEach(function(t){t.classList.add("ddd-keep")});var o="div, section, article, header, footer, p, h1, h2, h3, h4, h5, h6, table, td, td, dt, dd, li";[this.container].concat(c.$.find("*",this.container)).forEach(function(n){n.normalize(),c.$.contents(n).forEach(function(t){8==t.nodeType&&n.removeChild(t)}),c.$.contents(n).forEach(function(t){var e,i;3==t.nodeType&&""==t.textContent.trim()&&(e=t.previousSibling,i=t.nextSibling,(t.parentElement.matches("table, thead, tbody, tfoot, tr, dl, ul, ol, video")||!e||1==e.nodeType&&e.matches(o)||!i||1==i.nodeType&&i.matches(o))&&n.removeChild(t))})});var e=[];return c.$.contents(this.container).forEach(function(t){e.push(t.cloneNode(!0))}),e},c.prototype._getMaxHeight=function(){if("number"==typeof this.options.height)return this.options.height;for(var t,e=window.getComputedStyle(this.container),i=["maxHeight","height"],n=0,o=0;o<i.length;o++)if("px"==(t=e[i[o]]).slice(-2)){n=parseFloat(t);break}if("border-box"==e.boxSizing)for(i=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],o=0;o<i.length;o++){"px"==(t=e[i[o]]).slice(-2)&&(n-=parseFloat(t))}return Math.max(n,0)},c.version="4.1.0",c.options={ellipsis:"… ",callback:function(t){},truncate:"word",tolerance:0,keep:null,watch:"window",height:null},c.$={find:function(t,e){return e=e||document,Array.prototype.slice.call(e.querySelectorAll(t))},contents:function(t){return t=t||document,Array.prototype.slice.call(t.childNodes)}},c}();!function(t){void 0!==t&&(t.fn.dotdotdot=function(n){return this.each(function(t,e){var i=new Dotdotdot(e,n);e.dotdotdot=i.API})})}(window.Zepto||window.jQuery);
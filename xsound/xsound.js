/*! For license information please see xsound.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.xsound=e():t.xsound=e()}(self,(function(){return(()=>{"use strict";var t={1114:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=this&&this.__assign||function(){return s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},s.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.AudioModule=void 0;var o=r(2188),a=r(3449),u=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.buffer=null,n.currentTime=0,n.stopped=!0,n.source=e.createBufferSource(),n.vocalcanceler=new a.VocalCanceler,n}return i(e,t),e.prototype.setup=function(t){var e=null!=t?t:{},r=e.decodeCallback,n=e.updateCallback,i=e.endedCallback,s=e.errorCallback;return r&&(this.decodeCallback=r),n&&(this.updateCallback=n),i&&(this.endedCallback=i),s&&(this.errorCallback=s),this.envelopegenerator.setGenerator(0),this.envelopegenerator.param({attack:0,decay:.01,sustain:1,release:.01}),this},e.prototype.ready=function(t){var e=this;if(t instanceof ArrayBuffer){this.buffer=null;this.context.decodeAudioData(t,(function(t){e.buffer=t,e.analyser.start("timeoverview",0,e.buffer),e.analyser.start("timeoverview",1,e.buffer),e.decodeCallback&&e.decodeCallback(e.buffer)}),this.errorCallback)}else t instanceof AudioBuffer&&(this.buffer=t);return this},e.prototype.start=function(t,e){var r=this;if(null===this.buffer||!this.stopped)return this;var n=this.context.currentTime,i=null!=t?t:0,s=null!=e?e:this.buffer.duration;this.currentTime=s>=0?i>=0&&i<=s?i:0:i>=0&&i<=this.buffer.duration?i:0;var o=this.source.playbackRate.value,a=this.source.detune.value,u=this.source.loop;this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.playbackRate.value=o,this.source.detune.value=a,this.source.loop=u,this.source.loopStart=this.currentTime,this.source.loopEnd=s>=0?s:this.buffer.duration,this.envelopegenerator.ready(0,this.source,this.processor),this.connect(this.processor),s>=0?this.source.start(n,this.currentTime,s-i):this.source.start(n,this.currentTime,this.buffer.duration-this.currentTime),this.analyser.start("time"),this.analyser.start("fft"),this.stopped=!1,this.envelopegenerator.start(n),s>=0?this.envelopegenerator.stop(n+(s-i)/this.source.playbackRate.value,!0):this.envelopegenerator.stop(n+(this.buffer.duration-i)/this.source.playbackRate.value,!0),this.on(n);var c=this.processor.bufferSize,l=this.analyser.domain("timeoverview",0),h=this.analyser.domain("timeoverview",1);return this.processor.onaudioprocess=function(t){var e=t.inputBuffer.getChannelData(0),n=t.inputBuffer.getChannelData(1),i=t.outputBuffer.getChannelData(0),s=t.outputBuffer.getChannelData(1);if(null!==r.buffer)if(r.currentTime<Math.trunc(r.source.loopEnd)){for(var o=0;o<c;o++)i[o]=r.vocalcanceler.start(e[o],n[o]),s[o]=r.vocalcanceler.start(n[o],e[o]),r.currentTime+=1*r.source.playbackRate.value/r.buffer.sampleRate,r.updateCallback&&r.updateCallback(r.source,r.currentTime);l.update(r.currentTime),h.update(r.currentTime)}else r.source.loop?(r.stop(),"sprite"===l.param("mode")?r.start(r.source.loopStart,r.source.loopEnd):r.start(0,r.buffer.duration)):r.end();else r.end()},this},e.prototype.stop=function(){if(null===this.buffer||this.stopped)return this;var t=this.context.currentTime;return this.source.stop(t),this.off(t),this.analyser.stop("time"),this.analyser.stop("fft"),this.mixed||(this.processor.disconnect(0),this.processor.onaudioprocess=null),this.stopped=!0,this},e.prototype.param=function(t){var e,r,n,i,s,o,a,u,c,l;if("string"==typeof t)switch(t){case"mastervolume":return this.mastervolume.gain.value;case"playbackRate":return this.source.playbackRate.value;case"detune":return this.source.detune.value;case"loop":return this.source.loop;case"currentTime":return this.currentTime;case"duration":return null!==(r=null===(e=this.source.buffer)||void 0===e?void 0:e.duration)&&void 0!==r?r:0;case"sampleRate":return null!==(i=null===(n=this.source.buffer)||void 0===n?void 0:n.sampleRate)&&void 0!==i?i:this.context.sampleRate;case"numberOfChannels":return null!==(o=null===(s=this.source.buffer)||void 0===s?void 0:s.numberOfChannels)&&void 0!==o?o:0;default:return this}for(var h=0,p=Object.entries(t);h<p.length;h++){var f=p[h],d=f[0],v=f[1];switch(d){case"mastervolume":"number"==typeof v&&(this.mastervolume.gain.value=v);break;case"playbackRate":if("number"==typeof v&&v>0){this.source.playbackRate.value=v;var y=this.context.currentTime,m=this.currentTime,b=null!==(u=null===(a=this.source.buffer)||void 0===a?void 0:a.duration)&&void 0!==u?u:0;this.envelopegenerator.start(y),this.envelopegenerator.stop(y+(b-m)/v,!0)}break;case"detune":if("number"==typeof v){this.source.detune.value=v;var g=v>0?v/1200+1:Math.abs(1/(v/1200-1));y=this.context.currentTime,m=this.currentTime,b=null!==(l=null===(c=this.source.buffer)||void 0===c?void 0:c.duration)&&void 0!==l?l:0;this.envelopegenerator.start(y),this.envelopegenerator.stop(y+(b-m)/g,!0)}break;case"loop":"boolean"==typeof v&&(this.source.loop=v);break;case"currentTime":"number"==typeof v&&(this.currentTime=v,this.stopped||(this.stop(),this.start(v)))}}return this},e.prototype.get=function(){return this.source},e.prototype.end=function(){return this.stop(),this.currentTime=0,this.endedCallback&&this.endedCallback(this.source,0),this},e.prototype.has=function(){return null!==this.buffer},e.prototype.paused=function(){return this.stopped},e.prototype.fadeIn=function(t){var e,r;if("number"!=typeof t)return this.envelopegenerator.param("attack");this.envelopegenerator.param({attack:t});var n=this.context.currentTime,i=this.currentTime,s=null!==(r=null===(e=this.source.buffer)||void 0===e?void 0:e.duration)&&void 0!==r?r:0,o=this.source.playbackRate.value;return this.envelopegenerator.start(n),this.envelopegenerator.stop(n+(s-i)/o,!0),this},e.prototype.fadeOut=function(t){var e,r;if("number"!=typeof t)return this.envelopegenerator.param("release");this.envelopegenerator.param({release:t});var n=this.context.currentTime,i=this.currentTime,s=null!==(r=null===(e=this.source.buffer)||void 0===e?void 0:e.duration)&&void 0!==r?r:0,o=this.source.playbackRate.value;return this.envelopegenerator.start(n),this.envelopegenerator.stop(n+(s-i)/o,!0),this},e.prototype.slice=function(t,e){if(null===this.buffer)return null;var r=this.buffer.duration,n=this.buffer.sampleRate,i=this.buffer.numberOfChannels,s=Math.trunc((null!=t?t:0)*n),o=Math.trunc((null!=e?e:r)*n),a=i>0?this.buffer.getChannelData(0):null,u=i>1?this.buffer.getChannelData(1):null,c=o-s;switch(i){case 1:if(null===a)return null;for(var l=new Float32Array(c),h=s;h<o;h++)l[h-s]=a[h];return(f=this.context.createBuffer(1,c,n)).copyToChannel(l,0),f;case 2:if(null===a||null===u)return null;l=new Float32Array(c);var p=new Float32Array(c);for(h=s;h<o;h++)l[h-s]=a[h],p[h-s]=u[h];var f;return(f=this.context.createBuffer(2,c,n)).copyToChannel(l,0),f.copyToChannel(p,1),f;default:return null}},e.prototype.sprite=function(t){var e=this;return null===this.buffer?null:Object.keys(t).reduce((function(r,n){var i=t[n],s=e.slice.apply(e,i);return null!==s&&(r[n]=s),r}),{})},e.prototype.module=function(t){switch(t){case"analyser":return this.analyser;case"recorder":return this.recorder;case"session":return this.session;case"autopanner":return this.autopanner;case"chorus":return this.chorus;case"compressor":return this.compressor;case"delay":return this.delay;case"distortion":return this.distortion;case"equalizer":return this.equalizer;case"filter":return this.filter;case"flanger":return this.flanger;case"listener":return this.listener;case"panner":return this.panner;case"phaser":return this.phaser;case"pitchshifter":return this.pitchshifter;case"reverb":return this.reverb;case"ringmodulator":return this.ringmodulator;case"stereo":return this.stereo;case"tremolo":return this.tremolo;case"wah":return this.wah;case"envelopegenerator":return this.envelopegenerator;case"vocalcanceler":return this.vocalcanceler;default:return null}},e.prototype.resize=function(e){return t.prototype.init.call(this,this.context,e),this},e.prototype.on=function(e){return t.prototype.on.call(this,e),this},e.prototype.off=function(e){return t.prototype.off.call(this,e),this},e.prototype.suspend=function(){return t.prototype.suspend.call(this),this},e.prototype.mix=function(){return t.prototype.mix.call(this),this},e.prototype.demix=function(){return t.prototype.demix.call(this),this},e.prototype.params=function(){var e,r,n,i,o,a,u=t.prototype.params.call(this);return s(s({},u),{playbackRate:this.source.playbackRate.value,detune:this.source.detune.value,loop:this.source.loop,currentTime:this.currentTime,duration:null!==(r=null===(e=this.buffer)||void 0===e?void 0:e.duration)&&void 0!==r?r:0,sampleRate:null!==(i=null===(n=this.buffer)||void 0===n?void 0:n.sampleRate)&&void 0!==i?i:this.context.sampleRate,numberOfChannels:null!==(a=null===(o=this.buffer)||void 0===o?void 0:o.numberOfChannels)&&void 0!==a?a:0,vocalcanceler:this.vocalcanceler.params()})},Object.defineProperty(e.prototype,"INPUT",{get:function(){return this.processor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"OUTPUT",{get:function(){return this.mastervolume},enumerable:!1,configurable:!0}),e}(o.SoundModule);e.AudioModule=u},9206:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MIDI=void 0;var r=function(){function t(){this.midiAccess=null,this.inputs=[],this.outputs=[]}return t.prototype.setup=function(t){var e=this;if(!navigator.requestMIDIAccess)return Promise.reject();var r=t.options,n=t.successCallback,i=t.errorCallback;return navigator.requestMIDIAccess(r).then((function(t){e.midiAccess=t;for(var r=t.inputs.values(),i=t.outputs.values(),s=r.next();!s.done;s=r.next())e.inputs.push(s.value);for(var o=i.next();!o.done;o=i.next())e.outputs.push(o.value);n&&n(e.midiAccess,e.inputs,e.outputs)})).catch((function(t){i&&i(t)}))},t.prototype.get=function(){return this.midiAccess},t}();e.MIDI=r},5822:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Part=void 0;var n=r(6667),i=r(5146),s=r(4903),o=r(2811),a=r(9171),u=r(9646),c=r(1358),l=function(){function t(t){this.sequences=[],this.previous=null,this.timerId=null,this.currentIndex=0,this.currentPosition=0,this.offset=0;var e=t.source,r=t.mml,n=t.offset,i=t.startCallback,s=t.stopCallback,l=t.endedCallback,h=t.errorCallback;this.source=e,this.mml=r,this.offset=null!=n?n:0,i&&(this.startCallback=i),s&&(this.stopCallback=s),l&&(this.endedCallback=l),h&&(this.errorCallback=h);var p=new a.Tokenizer(r),f=new u.TreeConstructor(p),d=new c.Sequencer(f).get();d instanceof o.MMLSyntaxError?this.errorCallback&&this.errorCallback(d):this.sequences=d}return t.prototype.start=function(t){var e=this;if(!this.sequences[this.currentIndex])return this.stop(),void(this.endedCallback&&this.endedCallback());var r=this.sequences[this.currentIndex++];if(t){var o=this.mml.slice(0,this.currentPosition),a=this.mml.slice(this.currentPosition).replace(r.note,'<span class="x-highlight">'.concat(r.note,"</span>"));this.mml="".concat(o).concat(a),this.currentPosition+=this.mml.slice(this.currentPosition).indexOf("</span>")+"</span>".length}else{o=this.mml.slice(0,this.currentPosition),a=r.note;this.mml="".concat(o).concat(a),this.currentPosition+=a.length}if(this.source instanceof n.OscillatorModule)this.source.ready(0,r.duration).start(r.frequencies),this.startCallback&&this.startCallback(r);else if(this.source instanceof i.OneshotModule){var u=r.indexes.filter((function(t){return-1!==t})).map((function(t){return t+e.offset}));this.source.ready(0,r.duration).start(u),this.startCallback&&this.startCallback(r,this.offset)}else this.source instanceof s.NoiseModule&&(this.source.start(),this.startCallback&&this.startCallback(r));this.timerId=window.setTimeout((function(){e.source instanceof n.OscillatorModule?e.stopCallback&&e.stopCallback(r):e.source instanceof i.OneshotModule?e.stopCallback&&e.stopCallback(r,e.offset):e.source instanceof s.NoiseModule&&(e.source.stop(),e.stopCallback&&e.stopCallback(r)),e.previous=r,e.start(t)}),1e3*r.duration)},t.prototype.stop=function(){var t=this;if(null!==this.previous){if(this.source instanceof n.OscillatorModule)this.source.stop(),this.stopCallback&&this.stopCallback(this.previous);else if(this.source instanceof i.OneshotModule){var e=this.previous.indexes.filter((function(t){return-1!==t})).map((function(e){return e+t.offset}));this.source.stop(e),this.stopCallback&&this.stopCallback(this.previous,this.offset)}else this.source instanceof s.NoiseModule&&(this.source.stop(),this.stopCallback&&this.stopCallback(this.previous));this.timerId&&window.clearTimeout(this.timerId),this.timerId=null}},t.prototype.getMML=function(){return this.mml},t.prototype.getSequences=function(){return this.sequences},t.prototype.has=function(){return this.sequences.length>0},t.prototype.paused=function(){return null===this.timerId},t.prototype.getCurrentIndex=function(){return this.currentIndex},t.prototype.setCurrentIndex=function(t){t>=0&&t<this.sequences.length&&(this.currentIndex=t)},t}();e.Part=l},6478:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Sequence=void 0;var r=function(){function t(t){var e=t.id,r=t.note,n=t.indexes,i=t.frequencies,s=t.start,o=t.stop,a=t.duration;this._id=e,this._note=r,this._indexes=n,this._frequencies=i,this._start=s,this._stop=o,this._duration=a}return t.prototype.concat=function(e){return new t({id:this._id,note:"".concat(this._note,"&").concat(e.note),indexes:this._indexes,frequencies:this._frequencies,start:this._start,duration:this._duration+e.duration,stop:this._start+(this._duration+e.duration)})},Object.defineProperty(t.prototype,"note",{get:function(){return this._note},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"indexes",{get:function(){return this._indexes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frequencies",{get:function(){return this._frequencies},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){return this._start},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stop",{get:function(){return this._stop},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return JSON.stringify({id:this._id,note:this._note,indexes:this._indexes,frequencies:this._frequencies,start:this._start,stop:this._stop,duration:this._duration})},t}();e.Sequence=r},1358:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Sequencer=void 0;var n=r(999),i=r(2811),s=r(9646),o=r(6478),a=function(){function t(t){this.sequences=[],this.timeOf4note=0,this.octave=-1,this.currentTime=0,this.treeConstructor=t}return t.prototype.get=function(){var t,e;s.TreeConstructor.id=0;var r=this.treeConstructor.parse();if(r instanceof i.MMLSyntaxError)return r;this.timeOf4note=0,this.octave=-1,this.currentTime=0;for(var n=r[0];null!==n;){if(n instanceof i.MMLSyntaxError)return n;var o=n.operator,a=o.type,u=n.left,c=null!==u?u.operator.value:-1;switch(a){case"TEMPO":if(c<=0)return new i.MMLSyntaxError(o);this.timeOf4note=60/c,n=n.right;break;case"OCTAVE":if(c<0)return new i.MMLSyntaxError(o);this.octave=c,n=n.right;break;case"NOTE":case"REST":case"TIE":var l=this.push("TIE"===a?n.right:n);if(l instanceof i.MMLSyntaxError)return l;"TIE"===a?(this.concat(),n=null!==(e=null===(t=n.right)||void 0===t?void 0:t.right)&&void 0!==e?e:null):n=n.right;break;case"EOS":n=n.right;break;default:return new i.MMLSyntaxError(n.operator)}}return this.treeConstructor.free(),this.sequences},t.prototype.push=function(t){if(null!==t){var e=t.left,r=t.right;if(null!==e&&null!==r){var i=e.operator,s=r.operator;if(null===i&&null===s)return this.push(e),void this.push(r);var a=t.operator.token,u=i.value,c=i.token,l=[],h=[];if(a){for(var p=0,f=a.length;p<f;p++){var d=a.charAt(p);if((0,n.isPitchChar)(d)){var v=(0,n.computeIndex)(this.octave,d);switch(a.charAt(p+1)){case n.HALF_UP:case n.SHARP:v++,p++;break;case n.HALF_DOWN:v--,p++}if(v>=l[0]&&(v-=n.EQUAL_TEMPERAMENT),-1!==v&&v<0)return;l.push(v)}}for(var y=0,m=l;y<m.length;y++){v=m[y];var b=(0,n.computeFrequency)(v);if(b<0)return;h.push(b)}var g=0;switch(u){case 1:case 2:case 4:case 8:case 16:case 32:case 64:case 128:case 256:if(c){var w=n.QUARTER_NOTE/u;c.includes(n.DOT)?g+=w*this.timeOf4note*1.5:g+=w*this.timeOf4note}break;case 6:g+=2*this.timeOf4note/3;break;case 12:g+=this.timeOf4note/3;break;case 18:g+=2*this.timeOf4note/9;break;case 24:g+=.5*this.timeOf4note/3;break;case 36:g+=this.timeOf4note/9;break;case 48:g+=.25*this.timeOf4note/3;break;case 72:g+=.5*this.timeOf4note/9;break;case 96:g+=.125*this.timeOf4note/3;break;case 144:g+=.25*this.timeOf4note/9;break;case 192:g+=.0625*this.timeOf4note/3}var T=(this.sequences.length+1).toString(10),k="".concat(a).concat(c),_=this.currentTime,A=_+g;this.sequences.push(new o.Sequence({id:T,note:k,indexes:l,frequencies:h,start:_,stop:A,duration:g})),this.currentTime+=g}}}},t.prototype.concat=function(){var t=this.sequences.pop(),e=this.sequences.pop();e&&t&&this.sequences.push(e.concat(t))},t}();e.Sequencer=a},6806:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Token=e.TokenMap=void 0,e.TokenMap=new Map([["T","TEMPO"],["O","OCTAVE"],["C","NOTE"],["D","NOTE"],["E","NOTE"],["F","NOTE"],["G","NOTE"],["A","NOTE"],["B","NOTE"],["+","NOTE"],["-","NOTE"],["#","NOTE"],["R","REST"],["0","NUMBER"],["1","NUMBER"],["2","NUMBER"],["3","NUMBER"],["4","NUMBER"],["5","NUMBER"],["6","NUMBER"],["7","NUMBER"],["8","NUMBER"],["9","NUMBER"],[".","NUMBER"],["&","TIE"],[" ","SPACE"],[void 0,"EOS"]]);var r=function(){function t(t,e,r){this._id=t,this._type=e,this._token=r,this._value=r?parseInt(r,10):-1}return Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"token",{get:function(){return this._token},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return Number.isNaN(this._value)?-1:this._value},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return JSON.stringify({id:this._id,type:this._type,token:this._token,value:this._value})},t}();e.Token=r},9171:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Tokenizer=void 0;var n=r(6806),i=function(){function t(t){this.tokens=[],this.notes=[],this.numbers=[],this.tokens=t.trim().toUpperCase().split("").reverse()}return t.prototype.get=function(){var e=this.tokens.pop(),r=n.TokenMap.get(e);if(t.id++,!r)return new n.Token(t.id.toString(10),"UNKNOWN",e);for(;"SPACE"===r;)if(e=this.tokens.pop(),!(r=n.TokenMap.get(e)))return new n.Token(t.id.toString(10),"UNKNOWN",e);if("EOS"===r)return new n.Token(t.id.toString(10),"EOS",e);switch(this.notes.length=0,this.numbers.length=0,r){case"TEMPO":if(e)return new n.Token(t.id.toString(10),"TEMPO",e);break;case"OCTAVE":if(e)return new n.Token(t.id.toString(10),"OCTAVE",e);break;case"NOTE":if(e){if(this.notes.push(e),!(e=this.tokens.pop()))return new n.Token(t.id.toString(10),"NOTE",this.notes.join(""));if(!(r=n.TokenMap.get(e)))return new n.Token(t.id.toString(10),"UNKNOWN",e);for(;"NOTE"===r;){if(this.notes.push(e),!(e=this.tokens.pop()))return new n.Token(t.id.toString(10),"NOTE",this.notes.join(""));if(!(r=n.TokenMap.get(e)))return new n.Token(t.id.toString(10),"UNKNOWN",e)}return this.tokens.push(e),new n.Token(t.id.toString(10),"NOTE",this.notes.join(""))}break;case"REST":if(e)return new n.Token(t.id.toString(10),"REST",e);break;case"NUMBER":if(e){if(this.numbers.push(e),!(e=this.tokens.pop()))return new n.Token(t.id.toString(10),"NUMBER",this.numbers.join(""));if(!(r=n.TokenMap.get(e)))return new n.Token(t.id.toString(10),"UNKNOWN",e);for(;"NUMBER"===r;){if(this.numbers.push(e),!(e=this.tokens.pop()))return new n.Token(t.id.toString(10),"NUMBER",this.numbers.join(""));if(!(r=n.TokenMap.get(e)))return new n.Token(t.id.toString(10),"UNKNOWN",e)}return this.tokens.push(e),new n.Token(t.id.toString(10),"NUMBER",this.numbers.join(""))}break;case"TIE":if(e)return new n.Token(t.id.toString(10),"TIE",e);break;default:if(e)return new n.Token(t.id.toString(10),"UNKNOWN",e)}return null},t.id=0,t}();e.Tokenizer=i},2811:function(t,e){var r,n=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.MMLSyntaxError=e.Tree=void 0;var i=function(){function t(t,e,r,n){this.indent=0,this._id=t,this._operator=e,this._left=r,this._right=n}return t.prototype.concat=function(t){this._right=t},Object.defineProperty(t.prototype,"operator",{get:function(){return this._operator},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this._left},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this._right},enumerable:!1,configurable:!0}),t.prototype.clear=function(){this.indent=0},t.prototype.toString=function(){for(var t="",e=0;e<this.indent;e++)t+="    ";return this.indent++,"\n          ".concat(t,"  ").concat("".concat(this._operator.token," (id = ").concat(this._id,")"),"\n          ").concat(t,"  /\\\n          ").concat(t).concat(null!==this._left?"".concat(this._left._operator.token," (id = ").concat(this._left._id,")"):"","\n          ").concat(t).concat(null!==this._right&&void 0!==this._right._operator.token?this.toString.call(this._right):"EOS","\n        ")},t}();e.Tree=i;var s=function(t){function e(e){var r=t.call(this)||this;return r._token=e,r}return n(e,t),Object.defineProperty(e.prototype,"token",{get:function(){return this._token},enumerable:!1,configurable:!0}),e}(Error);e.MMLSyntaxError=s},9646:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TreeConstructor=void 0;var n=r(9171),i=r(2811),s=function(){function t(t){this.syntaxTree=[],this.tokenizer=t}return t.prototype.parse=function(){n.Tokenizer.id=0;for(var e=this.tokenizer.get(),r=this.tokenizer.get();;){if(!e||!r)return this.syntaxTree;switch(t.id+=2,e.type){case"TEMPO":if("NUMBER"===r.type){var s=new i.Tree((t.id-0).toString(10),r,null,null),o=new i.Tree((t.id-1).toString(10),e,s,null);this.syntaxTree.push(o);break}return new i.MMLSyntaxError(e);case"OCTAVE":if(this.syntaxTree.length>0&&"NUMBER"===r.type){s=new i.Tree((t.id-0).toString(10),r,null,null),o=new i.Tree((t.id-1).toString(10),e,s,null);this.syntaxTree[this.syntaxTree.length-1].concat(o),this.syntaxTree.push(o);break}return new i.MMLSyntaxError(e);case"NOTE":if(this.syntaxTree.length>0&&"NUMBER"===r.type){s=new i.Tree((t.id-0).toString(10),r,null,null),o=new i.Tree((t.id-1).toString(10),e,s,null);this.syntaxTree[this.syntaxTree.length-1].concat(o),this.syntaxTree.push(o);break}return new i.MMLSyntaxError(e);case"REST":if(this.syntaxTree.length>0&&"NUMBER"===r.type){s=new i.Tree((t.id-0).toString(10),r,null,null),o=new i.Tree((t.id-1).toString(10),e,s,null);this.syntaxTree[this.syntaxTree.length-1].concat(o),this.syntaxTree.push(o);break}return new i.MMLSyntaxError(e);case"NUMBER":t.id-=2;break;case"TIE":if(this.syntaxTree.length>0){t.id--;o=new i.Tree((t.id-0).toString(10),e,null,null);this.syntaxTree[this.syntaxTree.length-1].concat(o),this.syntaxTree.push(o);break}return new i.MMLSyntaxError(e);case"EOS":if(this.syntaxTree.length>0){o=new i.Tree((t.id-1).toString(10),e,null,null);this.syntaxTree[this.syntaxTree.length-1].concat(o),this.syntaxTree.push(o)}else{o=new i.Tree((t.id-1).toString(10),e,null,null);this.syntaxTree.push(o)}return this.syntaxTree;default:return new i.MMLSyntaxError(e)}e=r,r=this.tokenizer.get()}},t.prototype.free=function(){this.syntaxTree.length=0},t.id=0,t}();e.TreeConstructor=s},7087:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MML=void 0;r(6806),r(2811),r(6478);var n=r(5822),i=function(){function t(){this.parts=[]}return t.prototype.setup=function(t){return(null==t?void 0:t.startCallback)&&(this.startCallback=t.startCallback),(null==t?void 0:t.stopCallback)&&(this.stopCallback=t.stopCallback),(null==t?void 0:t.endedCallback)&&(this.endedCallback=t.endedCallback),(null==t?void 0:t.errorCallback)&&(this.errorCallback=t.errorCallback),this},t.prototype.ready=function(t){var e=t.source,r=t.mmls,i=t.offset;this.stop(),this.clear();for(var s=0,o=r;s<o.length;s++){var a=o[s];this.parts.push(new n.Part({source:e,mml:a,offset:i,startCallback:this.startCallback,stopCallback:this.stopCallback,endedCallback:this.endedCallback,errorCallback:this.errorCallback}))}return this},t.prototype.start=function(t,e){t>=0&&t<this.parts.length&&this.parts[t].start(null!=e&&e);return this},t.prototype.stop=function(){for(var t=0,e=this.parts;t<e.length;t++){e[t].stop()}return this},t.prototype.getMML=function(t){return t>=0&&t<this.parts.length?this.parts[t].getMML():null},t.prototype.getMMLs=function(){return this.parts.map((function(t){return t.getMML()}))},t.prototype.has=function(){return this.parts.length>0&&this.parts.every((function(t){return t.has()}))},t.prototype.getSequences=function(t){return t>=0&&t<this.parts.length?this.parts[t].getSequences():null},t.prototype.getAllSequences=function(){return this.parts.map((function(t){return t.getSequences()}))},t.prototype.paused=function(){return 0===this.parts.length||this.parts.every((function(t){return t.paused()}))},t.prototype.currentIndex=function(t,e){return t<0||t>=this.parts.length?this:e?(this.parts[t].setCurrentIndex(e),this):this.parts[t].getCurrentIndex()},t.prototype.clear=function(){for(var t=0,e=this.parts;t<e.length;t++){e[t].stop()}return this.parts.length=0,this},t.prototype.toABC=function(t,e,r,n,i,s){var o,a="";a+="X:".concat(e||1,"\n"),a+="T:".concat(r||"","\n"),a+="M:".concat(n||"4/4","\n"),a+="L:".concat(i||"1/256","\n"),a+="K:".concat(s||"","\n");var u=t.match(/\s*(?:T\d+)\s*|\s*(?:O\d+)\s*|\s*(?:(?:[CDEFGABR][#+-]?)+(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?)(?:&(?:[CDEFGABR][#+-]?)+(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?)*\s*/gi);if(null===u)return a;for(var c=null,l=0;u.length>0;){var h=null===(o=u.shift())||void 0===o?void 0:o.trim();if(!h)return a;if(/T\d+/i.test(h)){var p=parseInt(h.slice(1),10);if(p<=0)return a;a+="Q:1/4=".concat(p,"\n")}else if(/O\d+/i.test(h)){if((c=parseInt(h.slice(1),10))<0)return a}else if(/(?:(?:[CDEFGABR][#+-]?)+)(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)(?:&(?:[CDEFGABR][#+-]?)+(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?)*/i.test(h)){if(null===c)return a;var f=null;f=h.includes("&")?h.split("&"):[h];for(var d="";f.length>0;){var v=f.shift();if(!v)return a;var y="",m=0;switch(parseInt(v.replace(/^.+?(\d+)\.*$/,"$1"),10)){case 1:y=v.replace("1","256");break;case 2:y=v.replace("2","128");break;case 4:y=v.replace("4","64");break;case 8:y=v.replace("8","32");break;case 16:y=v.replace("16","16");break;case 32:y=v.replace("32","8");break;case 64:y=v.replace("64","4");break;case 128:y=v.replace("128","2");break;case 256:y=v.replace("256","1");break;case 6:y="(3".concat(v.replace("6","128")),m=128/3;break;case 12:y="(3".concat(v.replace("12","64")),m=64/3;break;case 18:y="(9".concat(v.replace("18","128")),m=128/9;break;case 24:y="(3".concat(v.replace("24","32")),m=32/3;break;case 36:y="(9".concat(v.replace("36","64")),m=64/9;break;case 48:y="(3".concat(v.replace("48","16")),m=16/3;break;case 72:y="(9".concat(v.replace("72","32")),m=32/9;break;case 96:y="(3".concat(v.replace("96","8")),m=8/3;break;case 144:y="(9".concat(v.replace("144","16")),m=16/9;break;case 192:y="(3".concat(v.replace("192","4")),m=4/3;break;default:return a}if(y.includes(".")&&(y=y.replace(/^(.+?)\d+\.+$/,"$1".concat(1.5*parseInt(y.replace(/^.+?(\d+)\.+$/,"$1"),10)))),y.includes("(")?l+=parseInt(y.replace(/^.+?(\d+)\.*$/i,"$1"),10):l+=m,l>=256&&(y+=" | ",l=0),/R/i.test(y))a+="".concat(y," ");else{var b="";switch(c){case 0:b=",,,,";break;case 1:b=",,,";break;case 2:b=",,";break;case 3:b=",";break;case 5:b="'";break;case 6:b="''";break;case 7:b="'''"}var g=y.match(/^(\(\d+)?((?:[CDEFGAB][#+-]?)+)(.*)$/i);if(null===g)return a;var w=g[1]?g[1]:"",T=g[2].length,k=g[3]?g[3]:"",_=0;if(w.length>0&&(y=y.replace(/^(?:\(\d+)?((?:[CDEFGAB][#+-]?)+)(.*)$/i,"$1$2")),1===T)d+="".concat(w).concat(y.slice(0,1)).concat(b).concat(k);else if(2===T&&/[#+-]/.test(y.charAt(1)))d+="".concat(w).concat(y.slice(1,2)).concat(y.slice(0,1)).concat(b).concat(k);else for(;_<T;)0===_&&(d+="".concat(w,"[")),/[#+-]/.test(y.charAt(_+1))?(d+="".concat(y.slice(_+1,_+2)).concat(y.slice(_,_+1)).concat(b),_+=2):(d+="".concat(y.slice(_,_+1)).concat(b),_++),_===T&&(d+="]".concat(k));f.length>0?d+="&":a+="".concat(d," ")}}}}return a.replace(/R/gi,"z").replace(/[#+]/g,"^").replace(/-/g,"_").replace(/&/g,"-").replace(/\s{2}/g," ").trim()},t}();e.MML=i},7878:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=this&&this.__assign||function(){return s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},s.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.MediaModule=void 0;var o=r(2188),a=r(3449),u=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.source=null,n.media=null,n.ext="",n.autoplay=!1,n.mediaSource=null,n.sourceBuffer=null,n.file="",n.mimeType="",n.listeners={},n.vocalcanceler=new a.VocalCanceler,n.onSourceOpen=n.onSourceOpen.bind(n),n.onSourceEnded=n.onSourceEnded.bind(n),n.onSourceClose=n.onSourceClose.bind(n),n.onSourceBufferUpdateEnd=n.onSourceBufferUpdateEnd.bind(n),n.onSourceBufferError=n.onSourceBufferError.bind(n),n}return i(e,t),e.prototype.setup=function(t){var e=this;this.envelopegenerator.setGenerator(0),this.envelopegenerator.param({attack:0,decay:.01,sustain:1,release:.01});var r=t.media,n=t.formats,i=t.listeners,s=t.autoplay;if(!r)return this;this.media=r;for(var o=0,a=null!=n?n:[];o<a.length;o++){var u=a[o],c="audio/".concat(u),l="video/".concat(u),h=this.media.canPlayType(c),p=this.media.canPlayType(l);if(/^(?:maybe|probably)/.test(h)||/^(?:maybe|probably)/.test(p)){this.ext=u;break}}return i&&(this.listeners=i,Object.keys(i).forEach((function(t){var r=i[t];"function"==typeof r&&(i[t]=r),e.media&&e.media.addEventListener(t,r,!1)}))),this.media.addEventListener("loadstart",(function(t){null!==e.media&&null===e.source&&(e.source=e.context.createMediaElementSource(e.media))}),!1),this.media.addEventListener("ended",(function(t){null!==e.media&&(e.media.pause(),e.off(e.context.currentTime),e.analyser.stop("time"),e.analyser.stop("fft"),e.processor.disconnect(0),e.processor.onaudioprocess=null)}),!1),this.autoplay=null!=s&&s,this.autoplay&&null===this.source&&(this.source=this.context.createMediaElementSource(this.media)),this.autoplay&&this.media.src&&this.context.resume().then((function(){var t,r;e.start(null!==(r=null===(t=e.media)||void 0===t?void 0:t.currentTime)&&void 0!==r?r:0)})).catch((function(){throw new Error("Autoplay is failed")})),this},e.prototype.ready=function(t,e){if(null===this.media)return this;this.mediaSource&&"open"===this.mediaSource.readyState&&(this.mediaSource.endOfStream(),window.URL.revokeObjectURL(this.media.src),this.mediaSource.removeEventListener("sourceopen",this.onSourceOpen,!1),this.mediaSource.removeEventListener("sourceended",this.onSourceEnded,!1),this.mediaSource.removeEventListener("sourceclose",this.onSourceClose,!1),this.sourceBuffer&&(this.sourceBuffer.removeEventListener("updateend",this.onSourceBufferUpdateEnd,!1),this.sourceBuffer.removeEventListener("error",this.onSourceBufferError,!1)));try{if(e){if(!MediaSource||!MediaSource.isTypeSupported(e))throw new Error("This Browser does not support `MediaSource` or MIME type");this.media.removeAttribute("src"),this.media.load(),this.mediaSource=new MediaSource,this.media.src=window.URL.createObjectURL(this.mediaSource),this.mimeType=e,this.file=t,this.mediaSource.addEventListener("sourceopen",this.onSourceOpen,!1),this.mediaSource.addEventListener("sourceended",this.onSourceEnded,!1),this.mediaSource.addEventListener("sourceclose",this.onSourceClose,!1)}else t.startsWith("data:")||t.startsWith("blob:")||""===this.ext?this.media.src=t:this.media.src="".concat(t,".").concat(this.ext)}catch(t){if(t instanceof Error)throw new Error(t.message)}return this},e.prototype.start=function(t){var e=this;return null===this.source||null===this.media||(this.envelopegenerator.ready(0,this.source,this.processor),this.connect(this.processor),this.media.play().then((function(){if(null!==e.media){var r=e.context.currentTime;e.media.currentTime=null!=t?t:0,e.envelopegenerator.start(r),Number.isFinite(e.media.duration)&&e.envelopegenerator.stop(r+(e.media.duration-e.media.currentTime)/e.media.playbackRate,!0),e.on(r),e.analyser.start("time"),e.analyser.start("fft");var n=e.processor.bufferSize;e.processor.onaudioprocess=function(t){for(var r=t.inputBuffer.getChannelData(0),i=t.inputBuffer.getChannelData(1),s=t.outputBuffer.getChannelData(0),o=t.outputBuffer.getChannelData(1),a=0;a<n;a++)s[a]=e.vocalcanceler.start(r[a],i[a]),o[a]=e.vocalcanceler.start(i[a],r[a])}}})).catch((function(){e.stop((function(){null!==e.media&&(e.autoplay&&(e.media.muted=!0,e.media.volume=0),e.start(t))}),(function(){}))}))),this},e.prototype.stop=function(t,e){var r=this;return null===this.source||null===this.media||this.media.play().then((function(){null!==r.media&&(r.media.pause(),r.off(r.context.currentTime),r.analyser.stop("time"),r.analyser.stop("fft"),r.media||(r.processor.disconnect(0),r.processor.onaudioprocess=null),t&&t())})).catch((function(t){e&&e(t)})),this},e.prototype.param=function(t){var e,r,n,i,s,o,a,u,c,l,h,p,f,d;if("string"==typeof t)switch(t){case"mastervolume":return this.mastervolume.gain.value;case"autoplay":return this.autoplay;case"playbackRate":return null!==(r=null===(e=this.media)||void 0===e?void 0:e.playbackRate)&&void 0!==r?r:1;case"currentTime":return null!==(i=null===(n=this.media)||void 0===n?void 0:n.currentTime)&&void 0!==i?i:0;case"controls":return null!==(o=null===(s=this.media)||void 0===s?void 0:s.controls)&&void 0!==o&&o;case"loop":return null!==(u=null===(a=this.media)||void 0===a?void 0:a.loop)&&void 0!==u&&u;case"muted":return null!==(l=null===(c=this.media)||void 0===c?void 0:c.muted)&&void 0!==l&&l;case"duration":return Number.isNaN(null!==(p=null===(h=this.media)||void 0===h?void 0:h.duration)&&void 0!==p?p:0)?0:null!==(d=null===(f=this.media)||void 0===f?void 0:f.duration)&&void 0!==d?d:0;default:return this}for(var v=0,y=Object.entries(t);v<y.length;v++){var m=y[v],b=m[0],g=m[1];switch(b){case"mastervolume":"number"==typeof g&&(this.mastervolume.gain.value=g);break;case"playbackRate":if(this.media&&"number"==typeof g&&g>0){this.media.playbackRate=g;var w=this.context.currentTime,T=this.media.currentTime,k=this.media.duration;this.envelopegenerator.start(w),Number.isFinite(k)&&this.envelopegenerator.stop(w+(k-T)/g,!0)}break;case"currentTime":if(this.media&&"number"==typeof g){this.media.currentTime=g;w=this.context.currentTime,k=this.media.duration;var _=this.media.playbackRate;this.envelopegenerator.start(w),Number.isFinite(k)&&this.envelopegenerator.stop(w+(k-g)/_,!0)}break;case"controls":this.media&&"boolean"==typeof g&&(this.media.controls=g);break;case"loop":this.media&&"boolean"==typeof g&&(this.media.loop=g);break;case"muted":this.media&&"boolean"==typeof g&&(this.media.muted=g)}}return this},e.prototype.get=function(){return this.source},e.prototype.hasMedia=function(){return null!==this.media},e.prototype.hasSource=function(){return null!==this.source},e.prototype.paused=function(){return null===this.media||this.media.paused},e.prototype.fadeIn=function(t){var e,r,n,i,s,o;if("number"!=typeof t)return this.envelopegenerator.param("attack");this.envelopegenerator.param({attack:t});var a=this.context.currentTime,u=null!==(r=null===(e=this.media)||void 0===e?void 0:e.currentTime)&&void 0!==r?r:0,c=null!==(i=null===(n=this.media)||void 0===n?void 0:n.duration)&&void 0!==i?i:0,l=null!==(o=null===(s=this.media)||void 0===s?void 0:s.playbackRate)&&void 0!==o?o:1;return this.envelopegenerator.start(a),this.envelopegenerator.stop(a+(c-u)/l,!0),this},e.prototype.fadeOut=function(t){var e,r,n,i,s,o;if("number"!=typeof t)return this.envelopegenerator.param("release");this.envelopegenerator.param({release:t});var a=this.context.currentTime,u=null!==(r=null===(e=this.media)||void 0===e?void 0:e.currentTime)&&void 0!==r?r:0,c=null!==(i=null===(n=this.media)||void 0===n?void 0:n.duration)&&void 0!==i?i:0,l=null!==(o=null===(s=this.media)||void 0===s?void 0:s.playbackRate)&&void 0!==o?o:1;return this.envelopegenerator.start(a),this.envelopegenerator.stop(a+(c-u)/l,!0),this},e.prototype.requestPictureInPicture=function(){return this.media instanceof HTMLVideoElement&&"pictureInPictureEnabled"in document&&document.pictureInPictureEnabled?this.media.disablePictureInPicture||0===this.media.readyState||this.media===document.pictureInPictureElement?Promise.reject():this.media.requestPictureInPicture():Promise.reject()},e.prototype.exitPictureInPicture=function(){return this.media instanceof HTMLVideoElement&&"pictureInPictureEnabled"in document&&document.pictureInPictureEnabled?this.media.disablePictureInPicture||0===this.media.readyState||this.media!==document.pictureInPictureElement?Promise.reject():document.exitPictureInPicture():Promise.reject()},e.prototype.module=function(t){switch(t){case"analyser":return this.analyser;case"recorder":return this.recorder;case"session":return this.session;case"autopanner":return this.autopanner;case"chorus":return this.chorus;case"compressor":return this.compressor;case"delay":return this.delay;case"distortion":return this.distortion;case"equalizer":return this.equalizer;case"filter":return this.filter;case"flanger":return this.flanger;case"listener":return this.listener;case"panner":return this.panner;case"phaser":return this.phaser;case"pitchshifter":return this.pitchshifter;case"reverb":return this.reverb;case"ringmodulator":return this.ringmodulator;case"stereo":return this.stereo;case"tremolo":return this.tremolo;case"wah":return this.wah;case"envelopegenerator":return this.envelopegenerator;case"vocalcanceler":return this.vocalcanceler;default:return null}},e.prototype.resize=function(e){return t.prototype.init.call(this,this.context,e),this},e.prototype.on=function(e){return t.prototype.on.call(this,e),this},e.prototype.off=function(e){return t.prototype.off.call(this,e),this},e.prototype.suspend=function(){return t.prototype.suspend.call(this),this},e.prototype.mix=function(){return t.prototype.mix.call(this),this},e.prototype.demix=function(){return t.prototype.demix.call(this),this},e.prototype.params=function(){var e,r,n,i,o,a,u,c,l,h,p,f,d,v,y=t.prototype.params.call(this);return s(s({},y),{autoplay:this.autoplay,playbackRate:null!==(r=null===(e=this.media)||void 0===e?void 0:e.playbackRate)&&void 0!==r?r:1,controls:null!==(i=null===(n=this.media)||void 0===n?void 0:n.controls)&&void 0!==i&&i,loop:null!==(a=null===(o=this.media)||void 0===o?void 0:o.loop)&&void 0!==a&&a,muted:null!==(c=null===(u=this.media)||void 0===u?void 0:u.muted)&&void 0!==c&&c,currentTime:null!==(h=null===(l=this.media)||void 0===l?void 0:l.currentTime)&&void 0!==h?h:0,duration:Number.isNaN(null!==(f=null===(p=this.media)||void 0===p?void 0:p.duration)&&void 0!==f?f:0)?0:null!==(v=null===(d=this.media)||void 0===d?void 0:d.duration)&&void 0!==v?v:0,vocalcanceler:this.vocalcanceler.params()})},Object.defineProperty(e.prototype,"INPUT",{get:function(){return this.processor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"OUTPUT",{get:function(){return this.mastervolume},enumerable:!1,configurable:!0}),e.prototype.onSourceOpen=function(t){var e=this;if(null!==this.mediaSource){this.sourceBuffer=this.mediaSource.addSourceBuffer(this.mimeType),this.sourceBuffer.mode="sequence",this.sourceBuffer.addEventListener("updateend",this.onSourceBufferUpdateEnd,!1),this.sourceBuffer.addEventListener("error",this.onSourceBufferError,!1);var r=new Request(this.file);fetch(r).then((function(t){return t.arrayBuffer()})).then((function(t){e.sourceBuffer&&e.sourceBuffer.appendBuffer(t)})).catch((function(t){e.listeners.error&&e.listeners.error(t)}))}},e.prototype.onSourceEnded=function(t){this.listeners.sourceclose&&this.listeners.sourceclose(t)},e.prototype.onSourceClose=function(t){this.listeners.sourceended&&this.listeners.sourceclose(t)},e.prototype.onSourceBufferUpdateEnd=function(t){this.listeners.updateend&&this.listeners.updateend(t)},e.prototype.onSourceBufferError=function(t){this.listeners.error&&this.listeners.error(t)},e}(o.SoundModule);e.MediaModule=u},6567:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.MixerModule=void 0;var s=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.sources=[],n.gainNodes=[],n}return i(e,t),e.prototype.setup=function(){return this},e.prototype.ready=function(){return this},e.prototype.start=function(t,e){this.sources=t;for(var r=0,n=this.sources.length;r<n;r++){var i=this.sources[r],s=this.context.currentTime;i.off(s),i.suspend(),i.mix(),i.INPUT&&(this.gainNodes[r]=this.context.createGain(),this.gainNodes[r].gain.value=e?e[r]:1,i.INPUT.connect(this.gainNodes[r]),this.gainNodes[r].connect(this.processor))}this.connect(this.processor);var o=this.context.currentTime;return this.on(o),this.runningAnalyser||(this.analyser.start("time"),this.analyser.start("fft"),this.runningAnalyser=!0),this.processor.onaudioprocess=function(t){var e=t.inputBuffer.getChannelData(0),r=t.inputBuffer.getChannelData(1),n=t.outputBuffer.getChannelData(0),i=t.outputBuffer.getChannelData(1);n.set(e),i.set(r)},this},e.prototype.stop=function(){var t=this.context.currentTime;this.off(t),this.suspend();for(var e=0,r=this.sources;e<r.length;e++){var n=r[e];n.demix(),n.INPUT&&(n.INPUT.disconnect(0),n.connect(n.INPUT))}for(var i=0,s=this.gainNodes;i<s.length;i++){s[i].disconnect(0)}return this},e.prototype.param=function(t){if("string"==typeof t)return"mastervolume"===t?this.mastervolume.gain.value:this;for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];if("mastervolume"===i)"number"==typeof s&&(this.mastervolume.gain.value=s)}return this},e.prototype.get=function(){return this.sources},e.prototype.module=function(t){switch(t){case"analyser":return this.analyser;case"recorder":return this.recorder;case"session":return this.session;case"autopanner":return this.autopanner;case"chorus":return this.chorus;case"compressor":return this.compressor;case"delay":return this.delay;case"distortion":return this.distortion;case"equalizer":return this.equalizer;case"filter":return this.filter;case"flanger":return this.flanger;case"listener":return this.listener;case"panner":return this.panner;case"phaser":return this.phaser;case"pitchshifter":return this.pitchshifter;case"reverb":return this.reverb;case"ringmodulator":return this.ringmodulator;case"stereo":return this.stereo;case"tremolo":return this.tremolo;case"wah":return this.wah;case"envelopegenerator":return this.envelopegenerator;default:return null}},e.prototype.resize=function(e){return t.prototype.init.call(this,this.context,e),this},e.prototype.on=function(e){return t.prototype.on.call(this,e),this},e.prototype.off=function(e){return t.prototype.off.call(this,e),this},e.prototype.suspend=function(){return t.prototype.suspend.call(this),this},e.prototype.mix=function(){return t.prototype.mix.call(this),this},e.prototype.demix=function(){return t.prototype.demix.call(this),this},Object.defineProperty(e.prototype,"INPUT",{get:function(){return this.processor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"OUTPUT",{get:function(){return this.mastervolume},enumerable:!1,configurable:!0}),e}(r(2188).SoundModule);e.MixerModule=s},4903:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=this&&this.__assign||function(){return s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},s.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.NoiseModule=void 0;var o=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.type="whitenoise",n.envelopegenerator.setGenerator(0),n}return i(e,t),e.prototype.setup=function(){return this},e.prototype.ready=function(){return this},e.prototype.start=function(){var t=this,e=this.context.currentTime;if(!this.mixed){this.envelopegenerator.clear(!0),this.processor.disconnect(0),this.processor.onaudioprocess=null;var r=this.envelopegenerator.getGenerator(0);r&&this.connect(r)}this.envelopegenerator.ready(0,this.processor,null),this.envelopegenerator.start(e),this.runningAnalyser||(this.analyser.start("time"),this.analyser.start("fft"),this.runningAnalyser=!0),this.on(e);var n=this.processor.bufferSize,i=0;return this.processor.onaudioprocess=function(e){var r=e.outputBuffer.getChannelData(0),s=e.outputBuffer.getChannelData(1);if(t.envelopegenerator.paused())t.mixed||(t.processor.disconnect(0),t.processor.onaudioprocess=null),t.analyser.stop("time"),t.analyser.stop("fft"),t.runningAnalyser=!1;else switch(t.type){case"whitenoise":for(var o=0;o<n;o++)r[o]=2*(Math.random()-.5),s[o]=2*(Math.random()-.5);break;case"pinknoise":var a=0,u=0,c=0,l=0,h=0,p=0,f=0;for(o=0;o<n;o++){a=.99886*a+.0555179*(d=2*Math.random()-1),u=.99332*u+.0750759*d,c=.969*c+.153852*d,l=.8665*l+.3104856*d,h=.55*h+.5329522*d,p=-.7616*p-.016898*d,r[o]=a+u+c+l+h+p+f+.5362*d,s[o]=a+u+c+l+h+p+f+.5362*d,r[o]*=.11,s[o]*=.11,f=.115926*d}break;case"browniannoise":for(o=0;o<n;o++){var d=2*Math.random()-1;r[o]=(i+.02*d)/1.02,s[o]=(i+.02*d)/1.02,i=(i+.02*d)/1.02,r[o]*=3.5,s[o]*=3.5}}},this},e.prototype.stop=function(){var t=this.context.currentTime;return this.envelopegenerator.stop(t),this.off(t),this},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"mastervolume":return this.mastervolume.gain.value;case"type":return this.type;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"mastervolume":"number"==typeof s&&(this.mastervolume.gain.value=s);break;case"type":"string"==typeof s&&(this.type=s)}}return this},e.prototype.module=function(t){switch(t){case"analyser":return this.analyser;case"recorder":return this.recorder;case"session":return this.session;case"autopanner":return this.autopanner;case"chorus":return this.chorus;case"compressor":return this.compressor;case"delay":return this.delay;case"distortion":return this.distortion;case"equalizer":return this.equalizer;case"filter":return this.filter;case"flanger":return this.flanger;case"listener":return this.listener;case"panner":return this.panner;case"phaser":return this.phaser;case"pitchshifter":return this.pitchshifter;case"reverb":return this.reverb;case"ringmodulator":return this.ringmodulator;case"stereo":return this.stereo;case"tremolo":return this.tremolo;case"wah":return this.wah;case"envelopegenerator":return this.envelopegenerator;default:return null}},e.prototype.resize=function(e){return t.prototype.init.call(this,this.context,e),this},e.prototype.on=function(e){return t.prototype.on.call(this,e),this},e.prototype.off=function(e){return t.prototype.off.call(this,e),this},e.prototype.suspend=function(){t.prototype.suspend.call(this);var e=this.envelopegenerator.getGenerator(0);return e&&(e.disconnect(0),this.processor.connect(e)),this},e.prototype.mix=function(){return t.prototype.mix.call(this),this},e.prototype.demix=function(){return t.prototype.demix.call(this),this},e.prototype.params=function(){var e=t.prototype.params.call(this);return s(s({},e),{type:this.type})},Object.defineProperty(e.prototype,"INPUT",{get:function(){var t=this.envelopegenerator.getGenerator(0);return t||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"OUTPUT",{get:function(){return this.mastervolume},enumerable:!1,configurable:!0}),e}(r(2188).SoundModule);e.NoiseModule=o},5146:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=this&&this.__assign||function(){return s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},s.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.OneshotModule=void 0;var o=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.sources=[],n.resources=[],n.buffers=[],n.volumes=[],n.states=[],n.settings=[],n.startTime=0,n.duration=0,n.transpose=1,n.paused=!0,n.isLoadError=!1,n}return i(e,t),e.prototype.setup=function(t){for(var e=t.resources,r=t.settings,n=t.timeout,i=t.successCallback,s=t.errorCallback,o=t.progressCallback,a=0,u=r.length;a<u;a++)this.states[a]=!1,this.volumes[a]=this.context.createGain(),this.settings[a]=r[a],this.envelopegenerator.setGenerator(a);var c=0;for(u=e.length;c<u;c++){this.resources[c]=e[c];var l=this.resources[c];"string"==typeof l?this.load({url:l,index:c,timeout:n,successCallback:i,errorCallback:s,progressCallback:o}):this.buffers[c]=l}return this},e.prototype.ready=function(t,e){return this.startTime=null!=t?t:this.context.currentTime,this.duration=null!=e?e:0,this.envelopegenerator.clear(!1),this},e.prototype.start=function(t){var e=this,r=this.context.currentTime+this.startTime;this.mixed||(this.envelopegenerator.clear(!1),this.connect(this.processor));for(var n=function(t){if(t<0||t>=i.settings.length)return"continue";var n=i.settings[t],s=n.bufferIndex,o=n.playbackRate,a=n.loop,u=n.loopStart,c=n.loopEnd,l=n.volume,h=i.context.createBufferSource();h.buffer=i.buffers[s],h.playbackRate.value=(null!=o?o:1)*i.transpose,h.loop=null!=a&&a,h.loopStart=null!=u?u:0,h.loopEnd=null!=c?c:h.buffer.duration,i.volumes[t].gain.value=null!=l?l:1,i.envelopegenerator.ready(t,h,i.volumes[t]),i.volumes[t].connect(i.processor),h.loop?h.start(r,r+h.loopStart,h.loopEnd-r):h.start(r),i.sources[t]=h,i.states[t]=!0,h.onended=function(){e.states[t]=!1}},i=this,s=0,o=t;s<o.length;s++){n(o[s])}return this.envelopegenerator.start(r),this.on(r),this.runningAnalyser||(this.analyser.start("time"),this.analyser.start("fft"),this.runningAnalyser=!0),this.processor.onaudioprocess=function(r){if(e.paused=!e.states.some((function(t){return t})),e.paused)e.stop(t),e.off(e.context.currentTime),e.envelopegenerator.clear(!1),e.analyser.stop("time"),e.analyser.stop("fft"),e.runningAnalyser=!1,e.mixed||(e.processor.disconnect(0),e.processor.onaudioprocess=null);else{var n=r.inputBuffer.getChannelData(0),i=r.inputBuffer.getChannelData(1),s=r.outputBuffer.getChannelData(0),o=r.outputBuffer.getChannelData(1);s.set(n),o.set(i)}},this},e.prototype.stop=function(t){var e=this;if(t.every((function(t){return!(t<0||t>=e.settings.length)&&"number"==typeof e.settings[t].bufferIndex}))){var r=this.context.currentTime+this.startTime+this.duration;this.envelopegenerator.stop(r),this.filter.stop(r)}return this},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"mastervolume":return this.mastervolume.gain.value;case"transpose":return this.transpose;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"mastervolume":"number"==typeof s&&(this.mastervolume.gain.value=s);break;case"transpose":"number"==typeof s&&(this.transpose=s)}}return this},e.prototype.get=function(t){return"number"==typeof t&&t>=0&&t<this.buffers.length?this.buffers[t]:this.buffers},e.prototype.reset=function(t,e,r){if(t>=0&&t<this.settings.length)switch(e){case"bufferIndex":case"playbackRate":case"loopStart":case"loopEnd":case"volume":"number"==typeof r&&(this.settings[t][e]=r);break;case"loop":"boolean"==typeof r&&(this.settings[t][e]=r)}return this},e.prototype.module=function(t){switch(t){case"analyser":return this.analyser;case"recorder":return this.recorder;case"session":return this.session;case"autopanner":return this.autopanner;case"chorus":return this.chorus;case"compressor":return this.compressor;case"delay":return this.delay;case"distortion":return this.distortion;case"equalizer":return this.equalizer;case"filter":return this.filter;case"flanger":return this.flanger;case"listener":return this.listener;case"panner":return this.panner;case"phaser":return this.phaser;case"pitchshifter":return this.pitchshifter;case"reverb":return this.reverb;case"ringmodulator":return this.ringmodulator;case"stereo":return this.stereo;case"tremolo":return this.tremolo;case"wah":return this.wah;case"envelopegenerator":return this.envelopegenerator;default:return null}},e.prototype.resize=function(e){return t.prototype.init.call(this,this.context,e),this},e.prototype.on=function(e){return t.prototype.on.call(this,e),this},e.prototype.off=function(e){return t.prototype.off.call(this,e),this},e.prototype.suspend=function(){return t.prototype.suspend.call(this),this},e.prototype.mix=function(){return t.prototype.mix.call(this),this},e.prototype.demix=function(){return t.prototype.demix.call(this),this},e.prototype.params=function(){var e=t.prototype.params.call(this);return s(s({},e),{transpose:this.transpose})},Object.defineProperty(e.prototype,"INPUT",{get:function(){return this.processor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"OUTPUT",{get:function(){return this.mastervolume},enumerable:!1,configurable:!0}),e.prototype.load=function(t){var e=this,r=t.url,n=t.index,i=t.timeout,s=t.successCallback,o=t.errorCallback,a=t.progressCallback,u=new XMLHttpRequest;u.timeout=null!=i?i:6e4,u.ontimeout=function(t){!e.isLoadError&&o&&o(t,"timeout"),e.isLoadError=!0},u.onprogress=function(t){e.isLoadError?u.abort():a&&a(t)},u.onerror=function(t){!e.isLoadError&&o&&o(t,"error"),e.isLoadError=!0},u.onload=function(t){if(200===u.status){var r=u.response;if(!(r instanceof ArrayBuffer))return;e.context.decodeAudioData(r,(function(r){e.buffers[n]=r;for(var i=0,o=e.buffers;i<o.length;i++){if(void 0===o[i])return}s&&s(t,e.buffers)}),(function(t){o&&o(t,"decode")}))}},u.open("GET",r,!0),u.responseType="arraybuffer",u.send(null)},e}(r(2188).SoundModule);e.OneshotModule=o},9069:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Glide=void 0;var r=function(){function t(t){this.type="linear",this.time=0,this.prevFrequency=-1,this.nextFrequency=0,this.context=t}return t.prototype.ready=function(t){this.nextFrequency=t;var e=-1===this.prevFrequency?0:this.nextFrequency-this.prevFrequency;0!==this.time&&0!==e||(this.prevFrequency=this.nextFrequency)},t.prototype.start=function(t,e){var r=null!=e?e:this.context.currentTime,n=r+this.time;t.frequency.cancelScheduledValues(r),t.frequency.setValueAtTime(this.prevFrequency,r),"exponential"===this.type?t.frequency.exponentialRampToValueAtTime(this.nextFrequency,n):t.frequency.linearRampToValueAtTime(this.nextFrequency,n)},t.prototype.stop=function(){this.prevFrequency=this.nextFrequency},t.prototype.param=function(t){if("string"==typeof t)switch(t){case"type":return this.type;case"time":return this.time;default:return}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"type":"string"==typeof s&&(this.type=s);break;case"time":"number"==typeof s&&(this.time=s)}}},t.prototype.params=function(){return{type:this.type,time:this.time}},t}();e.Glide=r},9565:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Oscillator=void 0;var r=function(){function t(t,e){this.octave=0,this.fine=0,this.custom={real:new Float32Array([0,1]),imag:new Float32Array([0,1])},this.paused=!0,this.context=t,this.source=t.createOscillator(),this.volume=t.createGain(),this.isActive=e}return t.prototype.ready=function(t){if(this.isActive){var e=this.source.type,r=this.source.frequency.value,n=this.source.detune.value;if(this.paused||(this.source.stop(this.context.currentTime),this.source.disconnect(0)),this.source=this.context.createOscillator(),"custom"===e){var i=this.custom.real,s=this.custom.imag,o=this.context.createPeriodicWave(i,s);this.source.setPeriodicWave(o)}else this.source.type=e;this.source.frequency.value=r,this.source.detune.value=n,this.volume.connect(t)}},t.prototype.start=function(t){this.isActive?(this.source.start(null!=t?t:this.context.currentTime),this.paused=!1):(this.paused||(this.source.stop(this.context.currentTime),this.paused=!0),this.source.disconnect(0))},t.prototype.stop=function(t){this.paused||(this.source.stop(null!=t?t:this.context.currentTime),this.source.disconnect(0),this.paused=!0)},t.prototype.param=function(e){if("string"==typeof e)switch(e){case"type":return this.source.type;case"octave":return this.octave;case"fine":return this.fine;case"volume":return this.volume.gain.value;default:return this}for(var r=0,n=Object.entries(e);r<n.length;r++){var i=n[r],s=i[0],o=i[1];switch(s){case"type":if("string"==typeof o)this.source.type=o;else if("object"==typeof o){var a=o.real,u=o.imag,c=4096;a.length>c&&(a=a.subarray(0,c)),u.length>c&&(u=u.subarray(0,c)),0!==a[0]&&(a[0]=0),0!==u[0]&&(u[0]=0);var l=this.context.createPeriodicWave(a,u);this.source.setPeriodicWave(l),this.custom.real=a,this.custom.imag=u}break;case"octave":"number"==typeof o&&(this.octave=o,this.source.detune.value=this.fine+o*t.OCTAVE);break;case"fine":"number"==typeof o&&(this.fine=o,this.source.detune.value=o+this.octave*t.OCTAVE);break;case"volume":"number"==typeof o&&(this.volume.gain.value=o)}}return this},t.prototype.get=function(){return this.source},t.prototype.state=function(){return this.isActive},t.prototype.activate=function(){return this.isActive=!0,this},t.prototype.deactivate=function(){return this.isActive=!1,this},t.prototype.params=function(){return{state:this.isActive,type:this.source.type,octave:this.octave,fine:this.fine,volume:this.volume.gain.value}},Object.defineProperty(t.prototype,"INPUT",{get:function(){return this.source},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"OUTPUT",{get:function(){return this.volume},enumerable:!1,configurable:!0}),t.OCTAVE=1200,t}();e.Oscillator=r},6667:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=this&&this.__assign||function(){return s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},s.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.OscillatorModule=void 0;var o=r(2188),a=r(9069),u=r(9565),c=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.sources=[],n.startTime=0,n.duration=0,n.glide=new a.Glide(e),n}return i(e,t),e.prototype.setup=function(t){this.sources.length=0,Array.isArray(t)||(t=[t]);for(var e=0,r=t.length;e<r;e++)this.sources[e]=new u.Oscillator(this.context,Boolean(t[e])),this.envelopegenerator.setGenerator(e);return this},e.prototype.ready=function(t,e){return this.startTime=t<0?t:0,this.duration=e<0?e:0,this.envelopegenerator.clear(!0),this},e.prototype.start=function(t){var e=this,r=this.context.currentTime+this.startTime;this.mixed||(this.envelopegenerator.clear(!0),this.processor.disconnect(0),this.processor.onaudioprocess=null,this.connect(this.processor));for(var n=0,i=t.length;n<i&&!(n>=this.sources.length);n++){var s=this.sources[n],o=t[n];s.ready(this.processor),this.envelopegenerator.ready(n,s.INPUT,s.OUTPUT),this.glide.ready(o),this.glide.start(s.INPUT,r),s.start(r)}return this.envelopegenerator.start(r),this.on(r),this.runningAnalyser||(this.analyser.start("time"),this.analyser.start("fft"),this.runningAnalyser=!0),this.processor.onaudioprocess=function(t){var r=t.inputBuffer.getChannelData(0),n=t.inputBuffer.getChannelData(1),i=t.outputBuffer.getChannelData(0),s=t.outputBuffer.getChannelData(1);if(e.envelopegenerator.paused()){for(var o=e.context.currentTime,a=0,u=e.sources;a<u.length;a++){u[a].stop(o)}e.off(o),e.analyser.stop("time"),e.analyser.stop("fft"),e.runningAnalyser=!1,e.mixed||(e.processor.disconnect(0),e.processor.onaudioprocess=null)}else i.set(r),s.set(n)},this},e.prototype.stop=function(){var t=this.context.currentTime+this.startTime+this.duration;return this.envelopegenerator.stop(t,!1),this.glide.stop(),this.filter.stop(t),this},e.prototype.param=function(t){if("string"==typeof t)return"mastervolume"===t?this.mastervolume.gain.value:this;for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];if("mastervolume"===i)"number"==typeof s&&(this.mastervolume.gain.value=s)}return this},e.prototype.get=function(t){return"number"==typeof t&&t>=0&&t<this.sources.length?this.sources[t]:this.sources},e.prototype.length=function(){return this.sources.length},e.prototype.module=function(t){switch(t){case"analyser":return this.analyser;case"recorder":return this.recorder;case"session":return this.session;case"autopanner":return this.autopanner;case"chorus":return this.chorus;case"compressor":return this.compressor;case"delay":return this.delay;case"distortion":return this.distortion;case"equalizer":return this.equalizer;case"filter":return this.filter;case"flanger":return this.flanger;case"listener":return this.listener;case"panner":return this.panner;case"phaser":return this.phaser;case"pitchshifter":return this.pitchshifter;case"reverb":return this.reverb;case"ringmodulator":return this.ringmodulator;case"stereo":return this.stereo;case"tremolo":return this.tremolo;case"wah":return this.wah;case"envelopegenerator":return this.envelopegenerator;case"glide":return this.glide;default:return null}},e.prototype.resize=function(e){return t.prototype.init.call(this,this.context,e),this},e.prototype.on=function(e){return t.prototype.on.call(this,e),this},e.prototype.off=function(e){return t.prototype.off.call(this,e),this},e.prototype.suspend=function(){return t.prototype.suspend.call(this),this},e.prototype.mix=function(){return t.prototype.mix.call(this),this},e.prototype.demix=function(){return t.prototype.demix.call(this),this},e.prototype.params=function(){var e=t.prototype.params.call(this);return s(s({},e),{oscillator:{glide:this.glide.params(),params:this.sources.map((function(t){return t.params()}))}})},Object.defineProperty(e.prototype,"INPUT",{get:function(){return this.processor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"OUTPUT",{get:function(){return this.mastervolume},enumerable:!1,configurable:!0}),e}(o.SoundModule);e.OscillatorModule=c},6954:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.ProcessorModule=void 0;var s=r(2188),o=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.worklet=null,n.workletName="",n.options={},n.moduleURL="",n.envelopegenerator.setGenerator(0),window.AudioWorkletNode||(n.worklet=n.context.createScriptProcessor(r,s.SoundModule.NUMBER_OF_INPUTS,s.SoundModule.NUMBER_OF_OUTPUTS)),n}return i(e,t),e.prototype.setup=function(t,e){return this.workletName=t,this.options=null!=e?e:{},this},e.prototype.ready=function(t,e){var r=this;return window.AudioWorkletNode?(this.moduleURL=t,this.context.audioWorklet.addModule(this.moduleURL,null!=e?e:{credentials:"same-origin"}).then((function(){r.worklet=new AudioWorkletNode(r.context,r.workletName,r.options)}))):Promise.reject()},e.prototype.start=function(t){var e=this.envelopegenerator.getGenerator(0);if(null===this.worklet||null===e)return this;var r=this.context.currentTime;return this.mixed||(this.envelopegenerator.clear(!0),this.worklet.disconnect(0),this.worklet instanceof ScriptProcessorNode&&(this.worklet.onaudioprocess=null),this.connect(e)),this.envelopegenerator.ready(0,this.worklet,null),this.envelopegenerator.start(r),this.runningAnalyser||(this.analyser.start("time"),this.analyser.start("fft"),this.runningAnalyser=!0),this.on(r),this.worklet instanceof ScriptProcessorNode&&t&&(this.worklet.onaudioprocess=t),this},e.prototype.stop=function(){if(null===this.worklet)return this;var t=this.context.currentTime;return this.mixed||this.worklet.disconnect(0),this.envelopegenerator.stop(t),this.off(t),this},e.prototype.postMessage=function(t){return null===this.worklet||this.worklet instanceof ScriptProcessorNode||this.worklet.port.postMessage(t),this},e.prototype.onMessage=function(t){return null===this.worklet||this.worklet instanceof ScriptProcessorNode||(this.worklet.port.onmessage=t),this},e.prototype.onMessageError=function(t){return null===this.worklet||this.worklet instanceof ScriptProcessorNode||(this.worklet.port.onmessageerror=t),this},e.prototype.map=function(){return null===this.worklet||this.worklet instanceof ScriptProcessorNode?null:this.worklet.parameters},e.prototype.get=function(){return this.worklet},e.prototype.module=function(t){switch(t){case"analyser":return this.analyser;case"recorder":return this.recorder;case"session":return this.session;case"autopanner":return this.autopanner;case"chorus":return this.chorus;case"compressor":return this.compressor;case"delay":return this.delay;case"distortion":return this.distortion;case"equalizer":return this.equalizer;case"filter":return this.filter;case"flanger":return this.flanger;case"listener":return this.listener;case"panner":return this.panner;case"phaser":return this.phaser;case"pitchshifter":return this.pitchshifter;case"reverb":return this.reverb;case"ringmodulator":return this.ringmodulator;case"stereo":return this.stereo;case"tremolo":return this.tremolo;case"wah":return this.wah;case"envelopegenerator":return this.envelopegenerator;default:return null}},e.prototype.resize=function(e){return t.prototype.init.call(this,this.context,e),this},e.prototype.on=function(e){return t.prototype.on.call(this,e),this},e.prototype.off=function(e){return t.prototype.off.call(this,e),this},e.prototype.suspend=function(){t.prototype.suspend.call(this);var e=this.envelopegenerator.getGenerator(0);return this.worklet&&e&&(e.disconnect(0),this.worklet.connect(e)),this},e.prototype.mix=function(){return t.prototype.mix.call(this),this},e.prototype.demix=function(){return t.prototype.demix.call(this),this},Object.defineProperty(e.prototype,"INPUT",{get:function(){var t=this.envelopegenerator.getGenerator(0);return t||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"OUTPUT",{get:function(){return this.mastervolume},enumerable:!1,configurable:!0}),e}(s.SoundModule);e.ProcessorModule=o},6354:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.FFT=void 0;var s=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.type="uint",n.size=256,n.textInterval=1e3,n}return i(e,t),e.prototype.setup=function(e){return t.prototype.setup.call(this,e),this},e.prototype.param=function(e){if("string"==typeof e)switch(e){case"type":return this.type;case"size":return this.size;case"textInterval":return this.textInterval;case"interval":case"styles":return t.prototype.param.call(this,e);default:return this}for(var r=0,n=Object.entries(e);r<n.length;r++){var i=n[r],s=i[0],o=i[1];switch(s){case"type":"string"==typeof o&&("uint"!==o&&"float"!==o||(this.type=o));break;case"size":"number"==typeof o&&(this.size=o);break;case"textInterval":"number"==typeof o&&(this.textInterval=o)}}return t.prototype.param.call(this,e),this},e.prototype.clear=function(){return t.prototype.clear.call(this),this},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e.prototype.visualizeOnCanvas=function(t,e,r){var n,i,s,o,a,u,c,l,h,p,f,d;if(null!==this.canvas&&null!==this.context&&this.isActive){var v=null!=e?e:-100,y=null!=r?r:-30,m=y-v,b=this.context,g=this.canvas.width,w=this.canvas.height,T=null!==(n=this.styles.top)&&void 0!==n?n:0,k=null!==(i=this.styles.bottom)&&void 0!==i?i:0,_=null!==(s=this.styles.left)&&void 0!==s?s:30,A=g-(_+(null!==(o=this.styles.right)&&void 0!==o?o:30)),x=w-(T+k),O=null!==(a=this.styles.width)&&void 0!==a?a:1.5,S=null!==(u=this.styles.cap)&&void 0!==u?u:"round",M=null!==(c=this.styles.join)&&void 0!==c?c:"miter",E=null!==(l=this.styles.wave)&&void 0!==l?l:"rgba(0, 0, 255, 1.0)",P=null!==(h=this.styles.grid)&&void 0!==h?h:"none",C=null!==(p=this.styles.text)&&void 0!==p?p:"none",R=parseInt(null!==(d=null===(f=this.styles.font)||void 0===f?void 0:f.size)&&void 0!==d?d:"13px",10),j=this.size>t.length?t.length:this.size,N=this.sampleRate/(2*t.length),I=Math.trunc(this.textInterval/N);if(b.clearRect(0,0,g,w),"float"===this.type){b.strokeStyle=E,b.lineWidth=O,b.lineCap=S,b.lineJoin=M,b.beginPath();for(var q=0;q<j;q++){var D=q/j*A+_,F=Math.abs(t[q]-y)*(x/m)+T;0===q?b.moveTo(D+O/2,F):b.lineTo(D,F)}b.stroke()}else switch(this.styles.shape){case"line":b.strokeStyle=E,b.lineWidth=O,b.lineCap=S,b.lineJoin=M,b.beginPath();for(q=0;q<j;q++){D=q/j*A+_,F=(1-t[q]/255)*x+T;0===q?b.moveTo(D+O/2,F):b.lineTo(D,F)}b.stroke();break;case"rect":for(q=0;q<j;q++){D=q/j*A+_,F=t[q]/255*x*-1;if(this.styles.gradients){for(var U=x+T,L=b.createLinearGradient(0,U,0,U+F),z=0,B=this.styles.gradients;z<B.length;z++){var G=B[z];L.addColorStop(G.offset,G.color)}b.fillStyle=L}else b.fillStyle=E;b.fillRect(D,x+T,O,F)}}if("none"!==P||"none"!==C){for(q=0;q<j;q++)if(q%I==0){D=Math.trunc(q/j*A)+_;var Q=Math.trunc(this.textInterval*(q/I)),X=Q<1e3?"".concat(Q," Hz"):"".concat(String(Q/1e3).slice(0,3)," kHz");"none"!==P&&(b.fillStyle=P,b.fillRect(D,T,1,x)),"none"!==C&&(b.fillStyle=C,b.font=this.createFontString(),b.fillText(X,D-b.measureText(X).width/2,T+x+R))}if("float"===this.type)for(q=v;q<=y;q+=10){X="".concat(q," dB"),D=Math.trunc(_-b.measureText(X).width),F=Math.trunc(-1*(q-y)/m*x)+T;"none"!==P&&(b.fillStyle=P,b.fillRect(_,F,A,1)),"none"!==C&&(b.fillStyle=C,b.font=this.createFontString(),b.fillText(X,D,F))}else for(var V=0,W=["0.00","0.25","0.50","0.75","1.00"];V<W.length;V++){X=W[V],D=Math.trunc(_-b.measureText(X).width),F=(1-parseFloat(X))*x+T;"none"!==P&&(b.fillStyle=P,b.fillRect(_,F,A,1)),"none"!==C&&(b.fillStyle=C,b.font=this.createFontString(),b.fillText(X,D,F))}}}},e.prototype.visualizeBySVG=function(t,r,n){var i,s,o,a,u,c,l,h,p,f,d,v,y,m,b,g,w,T,k,_,A,x,O,S,M,E,P,C,R,j,N,I;if(null!==this.svg&&this.isActive){var q=null!=r?r:-100,D=null!=n?n:-30,F=D-q,U=this.svg,L=parseInt(null!==(i=U.getAttribute("width"))&&void 0!==i?i:"0",10),z=parseInt(null!==(s=U.getAttribute("height"))&&void 0!==s?s:"0",10),B=null!==(o=this.styles.top)&&void 0!==o?o:0,G=null!==(a=this.styles.bottom)&&void 0!==a?a:0,Q=null!==(u=this.styles.left)&&void 0!==u?u:30,X=L-(Q+(null!==(c=this.styles.right)&&void 0!==c?c:30)),V=z-(B+G),W=null!==(l=this.styles.wave)&&void 0!==l?l:"rgba(0, 0, 255, 1.0)",H=null!==(h=this.styles.width)&&void 0!==h?h:1.5,Y=null!==(p=this.styles.cap)&&void 0!==p?p:"round",J=null!==(f=this.styles.join)&&void 0!==f?f:"miter",$=null!==(d=this.styles.grid)&&void 0!==d?d:"none",K=null!==(v=this.styles.text)&&void 0!==v?v:"none",Z=parseInt(null!==(m=null===(y=this.styles.font)||void 0===y?void 0:y.size)&&void 0!==m?m:"13px",10),tt=this.size>t.length?t.length:this.size,et=this.sampleRate/(2*t.length),rt=Math.trunc(this.textInterval/et);if(U.innerHTML="","float"===this.type){for(var nt=document.createElementNS(e.XMLNS,"path"),it="",st=0;st<tt;st++){var ot=Math.trunc(st/tt*X)+Q,at=Math.trunc(-1*(t[st]-D)*(V/F))+B;it+=0===st?"M".concat(ot+H/2," ").concat(at):" L".concat(ot," ").concat(at)}nt.setAttribute("d",it),nt.setAttribute("stroke",W),nt.setAttribute("fill","none"),nt.setAttribute("stroke-width",H.toString(10)),nt.setAttribute("stroke-linecap",Y),nt.setAttribute("stroke-linejoin",J),U.appendChild(nt)}else switch(this.styles.shape){case"line":for(nt=document.createElementNS(e.XMLNS,"path"),it="",st=0;st<tt;st++){ot=Math.trunc(st/tt*X)+Q,at=Math.trunc((1-t[st]/255)*V)+B;it+=0===st?"M".concat(ot+H/2," ").concat(at):" L".concat(ot," ").concat(at)}nt.setAttribute("d",it),nt.setAttribute("stroke",W),nt.setAttribute("fill","none"),nt.setAttribute("stroke-width",H.toString(10)),nt.setAttribute("stroke-linecap",Y),nt.setAttribute("stroke-linejoin",J),U.appendChild(nt);break;case"rect":var ut=null;this.styles.gradients&&(ut=this.createSVGLinearGradient("".concat(e.SVG_LINEAR_GRADIENT_ID_FFT,"-").concat(this.channel)));var ct=document.createElementNS(e.XMLNS,"g");null!==ut&&ct.appendChild(ut);for(st=0;st<tt;st++){var lt=document.createElementNS(e.XMLNS,"rect");ot=Math.trunc(st/tt*X)+Q,at=Math.trunc(t[st]/255*V);lt.setAttribute("x",ot.toString(10)),lt.setAttribute("y",(B+V).toString(10)),lt.setAttribute("width",H.toString(10)),lt.setAttribute("height",Math.abs(at).toString(10)),at>=0&&lt.setAttribute("transform","rotate(180 ".concat(ot+H/2," ").concat(B+V,")")),lt.setAttribute("stroke","none"),lt.setAttribute("fill",null===ut?W:"url(#".concat(e.SVG_LINEAR_GRADIENT_ID_FFT,"-").concat(this.channel,")")),ct.appendChild(lt)}U.appendChild(ct)}if("none"!==$||"none"!==K){for(st=0;st<tt;st++)if(st%rt==0){ot=Math.trunc(st/tt*X)+Q;var ht=Math.trunc(this.textInterval*(st/rt)),pt=ht<1e3?"".concat(ht," Hz"):"".concat(String(ht/1e3).slice(0,3)," kHz");if("none"!==$)(lt=document.createElementNS(e.XMLNS,"rect")).setAttribute("x",ot.toString(10)),lt.setAttribute("y",B.toString(10)),lt.setAttribute("width","1"),lt.setAttribute("height",V.toString(10)),lt.setAttribute("stroke","none"),lt.setAttribute("fill",$),U.appendChild(lt);if("none"!==K)(vt=document.createElementNS(e.XMLNS,"text")).textContent=pt,vt.setAttribute("x",ot.toString(10)),vt.setAttribute("y",(B+V).toString(10)),vt.setAttribute("text-anchor","middle"),vt.setAttribute("stroke","none"),vt.setAttribute("fill",K),vt.setAttribute("font-family",null!==(g=null===(b=this.styles.font)||void 0===b?void 0:b.family)&&void 0!==g?g:"Arial"),vt.setAttribute("font-size",Z.toString(10)),vt.setAttribute("font-style",null!==(T=null===(w=this.styles.font)||void 0===w?void 0:w.style)&&void 0!==T?T:"normal"),vt.setAttribute("font-weight",null!==(_=null===(k=this.styles.font)||void 0===k?void 0:k.weight)&&void 0!==_?_:"normal"),U.appendChild(vt)}if("float"===this.type)for(st=q;st<=D;st+=10){pt="".concat(st,"dB"),ot=Q,at=Math.trunc(-1*(st-D)/F*V)+B;if("none"!==$)(lt=document.createElementNS(e.XMLNS,"rect")).setAttribute("x",ot.toString(10)),lt.setAttribute("y",at.toString(10)),lt.setAttribute("width",X.toString(10)),lt.setAttribute("height","1"),lt.setAttribute("stroke","none"),lt.setAttribute("fill",$),U.appendChild(lt);if("none"!==$)(vt=document.createElementNS(e.XMLNS,"text")).textContent=pt,vt.setAttribute("x",ot.toString(10)),vt.setAttribute("y",(at-Math.trunc(Z/4)).toString(10)),vt.setAttribute("text-anchor","end"),vt.setAttribute("stroke","none"),vt.setAttribute("fill",K),vt.setAttribute("font-family",null!==(x=null===(A=this.styles.font)||void 0===A?void 0:A.family)&&void 0!==x?x:"Arial"),vt.setAttribute("font-size",Z.toString(10)),vt.setAttribute("font-style",null!==(S=null===(O=this.styles.font)||void 0===O?void 0:O.style)&&void 0!==S?S:"normal"),vt.setAttribute("font-weight",null!==(E=null===(M=this.styles.font)||void 0===M?void 0:M.weight)&&void 0!==E?E:"normal"),U.appendChild(vt)}else for(var ft=0,dt=["0.00","0.25","0.50","0.75","1.00"];ft<dt.length;ft++){var vt;pt=dt[ft],ot=Q,at=(1-parseFloat(pt))*V+B;if("none"!==$)(lt=document.createElementNS(e.XMLNS,"rect")).setAttribute("x",ot.toString(10)),lt.setAttribute("y",at.toString(10)),lt.setAttribute("width",X.toString(10)),lt.setAttribute("height","1"),lt.setAttribute("stroke","none"),lt.setAttribute("fill",$),U.appendChild(lt);if("none"!==K)(vt=document.createElementNS(e.XMLNS,"text")).textContent=pt,vt.setAttribute("x",ot.toString(10)),vt.setAttribute("y",(at-Math.trunc(Z/4)).toString(10)),vt.setAttribute("text-anchor","end"),vt.setAttribute("stroke","none"),vt.setAttribute("fill",K),vt.setAttribute("font-family",null!==(C=null===(P=this.styles.font)||void 0===P?void 0:P.family)&&void 0!==C?C:"Arial"),vt.setAttribute("font-size",Z.toString(10)),vt.setAttribute("font-style",null!==(j=null===(R=this.styles.font)||void 0===R?void 0:R.style)&&void 0!==j?j:"normal"),vt.setAttribute("font-weight",null!==(I=null===(N=this.styles.font)||void 0===N?void 0:N.weight)&&void 0!==I?I:"normal"),U.appendChild(vt)}}}},e}(r(1386).Visualizer);e.FFT=s},235:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Time=void 0;var s=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.type="uint",n.textInterval=.005,n}return i(e,t),e.prototype.setup=function(e){return t.prototype.setup.call(this,e),this},e.prototype.param=function(e){if("string"==typeof e)switch(e){case"type":return this.type;case"textInterval":return this.textInterval;case"interval":case"styles":return t.prototype.param.call(this,e);default:return this}for(var r=0,n=Object.entries(e);r<n.length;r++){var i=n[r],s=i[0],o=i[1];switch(s){case"type":"string"==typeof o&&("uint"!==o&&"float"!==o||(this.type=o));break;case"textInterval":"number"==typeof o&&(this.textInterval=o)}}return t.prototype.param.call(this,e),this},e.prototype.clear=function(){return t.prototype.clear.call(this),this},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e.prototype.visualizeOnCanvas=function(t,e,r){var n,i,s,o,a,u,c,l,h,p,f,d;if(null!==this.canvas&&null!==this.context&&this.isActive){var v=this.context,y=this.canvas.width,m=this.canvas.height,b=null!==(n=this.styles.top)&&void 0!==n?n:15,g=null!==(i=this.styles.bottom)&&void 0!==i?i:15,w=null!==(s=this.styles.left)&&void 0!==s?s:30,T=y-(w+(null!==(o=this.styles.right)&&void 0!==o?o:30)),k=m-(b+g),_=Math.trunc(k/2)+b,A=null!==(a=this.styles.width)&&void 0!==a?a:1.5,x=null!==(u=this.styles.cap)&&void 0!==u?u:"round",O=null!==(c=this.styles.join)&&void 0!==c?c:"miter",S=null!==(l=this.styles.wave)&&void 0!==l?l:"rgba(0, 0, 255, 1.0)",M=null!==(h=this.styles.grid)&&void 0!==h?h:"none",E=null!==(p=this.styles.text)&&void 0!==p?p:"none",P=parseInt(null!==(d=null===(f=this.styles.font)||void 0===f?void 0:f.size)&&void 0!==d?d:"13px",10),C=Math.trunc(this.textInterval*this.sampleRate);if(v.clearRect(0,0,y,m),"float"===this.type)t instanceof Float32Array&&this.visualizeTimeDomainFloat32ArrayOnCanvas(v,t,T,k,_);else switch(this.styles.shape){case"line":v.strokeStyle=S,v.lineWidth=A,v.lineCap=x,v.lineJoin=O,v.beginPath();for(var R=0,j=t.length;R<j;R++){var N=R/j*T+w,I=(1-t[R]/255)*k+b;0===R?v.moveTo(N+A/2,I):v.lineTo(N,I)}v.stroke();break;case"rect":for(R=0,j=t.length;R<j;R++){N=R/j*T+w,I=(.5-t[R]/255)*k;if(this.styles.gradients){for(var q=k/2+b,D=v.createLinearGradient(0,q,0,q+I),F=0,U=this.styles.gradients;F<U.length;F++){var L=U[F];D.addColorStop(L.offset,L.color)}v.fillStyle=D}else v.fillStyle=S;v.fillRect(N,_,1,I)}}if("none"!==M||"none"!==E){for(R=0,j=t.length;R<j;R++)if(R%C==0){N=Math.trunc(R/j*T)+w;var z="".concat(Math.trunc(R/this.sampleRate*1e3)," ms");"none"!==M&&(v.fillStyle=M,v.fillRect(N,b,1,k)),"none"!==E&&(v.fillStyle=E,v.font=this.createFontString(),v.fillText(z,N-v.measureText(z).width/2,b+k+P))}for(var B=0,G=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];B<G.length;B++){z=G[B],N=Math.trunc(w-v.measureText(z).width),I=Math.trunc((1-parseFloat(z.trim()))*(k/2))+b;"none"!==M&&(v.fillStyle=M,v.fillRect(w,I,T,1)),"none"!==E&&(v.fillStyle=E,v.font=this.createFontString(),v.fillText(z,N,I-Math.trunc(P/4)))}}}},e.prototype.visualizeBySVG=function(t,r,n){var i,s,o,a,u,c,l,h,p,f,d,v,y,m,b,g,w,T,k,_,A,x,O,S,M,E;if(null!==this.svg&&this.isActive){var P=this.svg,C=parseInt(null!==(i=P.getAttribute("width"))&&void 0!==i?i:"0",10),R=parseInt(null!==(s=P.getAttribute("height"))&&void 0!==s?s:"0",10),j=null!==(o=this.styles.top)&&void 0!==o?o:15,N=null!==(a=this.styles.bottom)&&void 0!==a?a:15,I=null!==(u=this.styles.left)&&void 0!==u?u:30,q=C-(I+(null!==(c=this.styles.right)&&void 0!==c?c:30)),D=R-(j+N),F=Math.trunc(D/2)+j,U=null!==(l=this.styles.width)&&void 0!==l?l:1.5,L=null!==(h=this.styles.cap)&&void 0!==h?h:"round",z=null!==(p=this.styles.join)&&void 0!==p?p:"miter",B=null!==(f=this.styles.wave)&&void 0!==f?f:"rgba(0, 0, 255, 1.0)",G=null!==(d=this.styles.grid)&&void 0!==d?d:"none",Q=null!==(v=this.styles.text)&&void 0!==v?v:"none",X=parseInt(null!==(m=null===(y=this.styles.font)||void 0===y?void 0:y.size)&&void 0!==m?m:"13px",10),V=Math.trunc(this.textInterval*this.sampleRate);if(P.innerHTML="","float"===this.type){if(t instanceof Float32Array){var W=this.visualizeTimeDomainFloat32ArrayBySVG(t,q,D,F,0,e.SVG_LINEAR_GRADIENT_ID_TIME);null!==W&&P.appendChild(W)}}else switch(this.styles.shape){case"line":for(var H=document.createElementNS(e.XMLNS,"path"),Y="",J=0,$=t.length;J<$;J++){var K=J/$*q+I,Z=(1-t[J]/255)*D+j;Y+=0===J?"M".concat(K+U/2," ").concat(Z):" L".concat(K," ").concat(Z)}H.setAttribute("d",Y),H.setAttribute("stroke",B),H.setAttribute("fill","none"),H.setAttribute("stroke-width",U.toString(10)),H.setAttribute("stroke-linecap",L),H.setAttribute("stroke-linejoin",z),P.appendChild(H);break;case"rect":var tt=null;this.styles.gradients&&(tt=this.createSVGLinearGradient("".concat(e.SVG_LINEAR_GRADIENT_ID_TIME,"-").concat(this.channel)));var et=document.createElementNS(e.XMLNS,"g");null!==tt&&et.appendChild(tt);for(J=0,$=t.length;J<$;J++){var rt=document.createElementNS(e.XMLNS,"rect");K=J/$*q+I,Z=(t[J]/255-.5)*D;rt.setAttribute("x",K.toString(10)),rt.setAttribute("y",F.toString(10)),rt.setAttribute("width",U.toString(10)),rt.setAttribute("height",Math.abs(Z).toString(10)),Z>=0&&rt.setAttribute("transform","rotate(180 ".concat(K+U/2," ").concat(F,")")),rt.setAttribute("stroke","none"),rt.setAttribute("fill",null===tt?B:"url(#".concat(e.SVG_LINEAR_GRADIENT_ID_TIME,"-").concat(this.channel,")")),et.appendChild(rt)}P.appendChild(et)}if("none"!==G||"none"!==Q){for(J=0,$=t.length;J<$;J++)if(J%V==0){K=Math.trunc(J/$*q)+I;var nt="".concat(Math.trunc(J/this.sampleRate*1e3)," ms");if("none"!==G)(rt=document.createElementNS(e.XMLNS,"rect")).setAttribute("x",K.toString(10)),rt.setAttribute("y",j.toString(10)),rt.setAttribute("width","1"),rt.setAttribute("height",D.toString(10)),rt.setAttribute("stroke","none"),rt.setAttribute("fill",G),P.appendChild(rt);if("none"!==Q)(ot=document.createElementNS(e.XMLNS,"text")).textContent=nt,ot.setAttribute("x",K.toString(10)),ot.setAttribute("y",(j+D+X).toString(10)),ot.setAttribute("text-anchor","middle"),ot.setAttribute("stroke","none"),ot.setAttribute("fill",Q),ot.setAttribute("font-family",null!==(g=null===(b=this.styles.font)||void 0===b?void 0:b.family)&&void 0!==g?g:"Arial"),ot.setAttribute("font-size",X.toString(10)),ot.setAttribute("font-style",null!==(T=null===(w=this.styles.font)||void 0===w?void 0:w.style)&&void 0!==T?T:"normal"),ot.setAttribute("font-weight",null!==(_=null===(k=this.styles.font)||void 0===k?void 0:k.weight)&&void 0!==_?_:"normal"),P.appendChild(ot)}for(var it=0,st=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];it<st.length;it++){var ot;nt=st[it],K=I,Z=Math.trunc((1-parseFloat(nt.trim()))*(D/2))+j;if("none"!==G)(rt=document.createElementNS(e.XMLNS,"rect")).setAttribute("x",K.toString(10)),rt.setAttribute("y",Z.toString(10)),rt.setAttribute("width",q.toString(10)),rt.setAttribute("height","1"),rt.setAttribute("stroke","none"),rt.setAttribute("fill",G),P.appendChild(rt);if("none"!==Q)(ot=document.createElementNS(e.XMLNS,"text")).textContent=nt,ot.setAttribute("x",K.toString(10)),ot.setAttribute("y",(Z-Math.trunc(X/4)).toString(10)),ot.setAttribute("text-anchor","end"),ot.setAttribute("stroke","none"),ot.setAttribute("fill",Q),ot.setAttribute("font-family",null!==(x=null===(A=this.styles.font)||void 0===A?void 0:A.family)&&void 0!==x?x:"Arial"),ot.setAttribute("font-size",X.toString(10)),ot.setAttribute("font-style",null!==(S=null===(O=this.styles.font)||void 0===O?void 0:O.style)&&void 0!==S?S:"normal"),ot.setAttribute("font-weight",null!==(E=null===(M=this.styles.font)||void 0===M?void 0:M.weight)&&void 0!==E?E:"normal"),P.appendChild(ot)}}}},e}(r(1386).Visualizer);e.Time=s},9076:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=this&&this.__assign||function(){return s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},s.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.TimeOverview=void 0;var o=r(1386),a="xsound-svg-current-time",u="xsound-svg-sprite",c=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.callback=function(){},n.currentImageData=null,n.currentSVGElement=null,n.currentDataSize=0,n.currentTime={width:1,color:"rgba(0, 0, 0, 0.5)"},n.sprite="rgba(255, 255, 255, 0.25)",n.plotInterval=.0625,n.textInterval=60,n.isDown=!1,n.mode="update",n.offsetX=0,n.startTime=0,n.endTime=0,n.onMouseStart=n.onMouseStart.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n.onTouchStart=n.onTouchStart.bind(n),n.onTouchMove=n.onTouchMove.bind(n),n.onTouchEnd=n.onTouchEnd.bind(n),n}return i(e,t),e.prototype.setup=function(e){return t.prototype.setup.call(this,e),this},e.prototype.param=function(e){if("string"==typeof e)switch(e){case"currentTime":return this.currentTime;case"sprite":return this.sprite;case"plotInterval":return this.plotInterval;case"textInterval":return this.textInterval;case"mode":return this.mode;case"interval":case"styles":return t.prototype.param.call(this,e);default:return this}for(var r=0,n=Object.entries(e);r<n.length;r++){var i=n[r],o=i[0],a=i[1];switch(o){case"currentTime":"object"==typeof a&&(this.currentTime=s(s({},this.currentTime),a));break;case"sprite":"string"==typeof a&&(this.sprite=a);break;case"plotInterval":"number"==typeof a&&(this.plotInterval=a);break;case"textInterval":"number"==typeof a&&(this.textInterval=a);break;case"mode":"string"==typeof a&&("update"!==a&&"sprite"!==a||(this.mode=a))}}return t.prototype.param.call(this,e),this},e.prototype.update=function(t){var r,n,i,s,o,c,l,h,p,f,d,v,y;switch(this.graphics){case"canvas":if(null===this.currentImageData)return this;if(null===this.canvas||null===this.context)return this;var m=this.context,b=this.canvas.width,g=this.canvas.height,w=b-((null!==(r=this.styles.left)&&void 0!==r?r:30)+(null!==(n=this.styles.right)&&void 0!==n?n:30)),T=g-((null!==(i=this.styles.top)&&void 0!==i?i:15)+(null!==(s=this.styles.bottom)&&void 0!==s?s:15)),k=t*this.sampleRate/this.currentDataSize*w,_=null!==(o=this.styles.left)&&void 0!==o?o:30,A=null!==(c=this.styles.top)&&void 0!==c?c:15,x=null!==(l=this.currentTime.color)&&void 0!==l?l:"rgba(0, 0, 0, 0.5)";switch(m.clearRect(0,0,b,g),m.putImageData(this.currentImageData,0,0),this.mode){case"update":m.fillStyle=x,m.fillRect(_,A+1,k,T-1);break;case"sprite":if(0!==this.endTime){var O=Math.trunc(Math.abs(this.endTime-this.startTime)*this.sampleRate/this.currentDataSize*w);m.fillStyle=this.sprite,k>=this.offsetX?m.fillRect(_+this.offsetX,A+1,O,T-1):m.fillRect(_+this.offsetX-O,A+1,O,T-1)}m.fillStyle=x,k>=this.offsetX?m.fillRect(_+this.offsetX,A+1,Math.abs(k-this.offsetX),T-1):m.fillRect(_+k,A+1,Math.abs(k-this.offsetX),T-1)}break;case"svg":if(null===this.currentSVGElement)return this;if(this.svg){var S=this.svg.querySelector(".".concat(a));if(null===S)return this;b=parseInt(null!==(h=this.svg.getAttribute("width"))&&void 0!==h?h:"0",10),A=null!==(p=this.styles.top)&&void 0!==p?p:15,w=b-((_=null!==(f=this.styles.left)&&void 0!==f?f:30)+(null!==(d=this.styles.right)&&void 0!==d?d:30)),k=t*this.sampleRate/this.currentDataSize*w;if("update"===this.mode)S.setAttribute("x",_.toString(10)),S.setAttribute("width",k.toString(10)),S.setAttribute("aria-label","current time");else if("sprite"===this.mode){if(0!==this.endTime){var M=this.svg.querySelector(".".concat(u));M&&(null===(v=M.parentNode)||void 0===v||v.removeChild(M));var E=document.createElementNS(e.XMLNS,"rect");E.classList.add(u);O=Math.trunc(Math.abs(this.endTime-this.startTime)*this.sampleRate/this.currentDataSize*w);E.setAttribute("y",(A+1).toString(10)),E.setAttribute("height",null!==(y=S.getAttribute("height"))&&void 0!==y?y:"0"),E.setAttribute("stroke","none"),E.setAttribute("fill",this.sprite),E.setAttribute("aria-label","current time"),k>=this.offsetX?E.setAttribute("x",(_+this.offsetX).toString(10)):E.setAttribute("x",(_+this.offsetX-O).toString(10)),E.setAttribute("width",O.toString(10)),this.svg.appendChild(E),this.svg.appendChild(S)}k>=this.offsetX?S.setAttribute("x",(_+this.offsetX).toString(10)):S.setAttribute("x",(_+k).toString(10)),S.setAttribute("width",Math.abs(k-this.offsetX).toString(10)),S.setAttribute("aria-label","sprite time")}}}return this},e.prototype.drag=function(t){var e=null;switch(this.graphics){case"canvas":if(null===this.canvas)return this;e=this.canvas;break;case"svg":if(null===this.svg)return this;e=this.svg;break;default:return this}return null===e||(t&&(this.callback=t),e.removeEventListener("mousedown",{handleEvent:this.onMouseStart},!1),e.removeEventListener("mousemove",{handleEvent:this.onMouseMove},!1),window.removeEventListener("mouseup",{handleEvent:this.onMouseUp},!1),e.removeEventListener("touchstart",{handleEvent:this.onTouchStart},!1),e.removeEventListener("touchmove",{handleEvent:this.onTouchMove},!1),window.removeEventListener("touchend",{handleEvent:this.onTouchEnd},!1),e.addEventListener("mousedown",{handleEvent:this.onMouseStart},!1),e.addEventListener("mousemove",{handleEvent:this.onMouseMove},!1),window.addEventListener("mouseup",{handleEvent:this.onMouseUp},!1),e.addEventListener("touchstart",{handleEvent:this.onTouchStart},!1),e.addEventListener("touchmove",{handleEvent:this.onTouchMove},!1),window.addEventListener("touchend",{handleEvent:this.onTouchEnd},!1)),this},e.prototype.clear=function(){return t.prototype.clear.call(this),this},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e.prototype.visualizeOnCanvas=function(t,e,r){var n,i,s,o,a,u,c,l,h;if(null!==this.canvas&&null!==this.context&&this.isActive&&!(t instanceof Uint8Array)){var p=this.context,f=this.canvas.width,d=this.canvas.height,v=null!==(n=this.styles.top)&&void 0!==n?n:15,y=null!==(i=this.styles.bottom)&&void 0!==i?i:15,m=null!==(s=this.styles.left)&&void 0!==s?s:30,b=f-(m+(null!==(o=this.styles.right)&&void 0!==o?o:30)),g=d-(v+y),w=Math.trunc(g/2)+v,T=null!==(a=this.styles.grid)&&void 0!==a?a:"none",k=null!==(u=this.styles.text)&&void 0!==u?u:"none",_=parseInt(null!==(l=null===(c=this.styles.font)||void 0===c?void 0:c.size)&&void 0!==l?l:"13px",10),A=Math.trunc(this.plotInterval*this.sampleRate),x=Math.trunc(this.textInterval*this.sampleRate);if(p.clearRect(0,0,f,d),this.visualizeTimeDomainFloat32ArrayOnCanvas(p,t,b,g,w,A),"none"!==T||"none"!==k){for(var O=0,S=t.length;O<S;O++)if(O%x==0){var M=Math.trunc(O/S*b)+m,E="".concat(Math.trunc(O/this.sampleRate/60)," min");"none"!==T&&(p.fillStyle=T,p.fillRect(M,v,1,g)),"none"!==k&&(p.fillStyle=k,p.font=this.createFontString(),p.fillText(E,M-p.measureText(E).width/2,v+g+_))}for(var P=0,C=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];P<C.length;P++){E=C[P],M=Math.trunc(m-p.measureText(E).width);var R=Math.trunc((1-parseFloat(E.trim()))*(g/2))+v;"none"!==T&&(p.fillStyle=T,p.fillRect(m,R,b,1)),"none"!==k&&(p.fillStyle=k,p.font=this.createFontString(),p.fillText(E,M,R-Math.trunc(_/4)))}}this.currentImageData=p.getImageData(0,0,f,d),this.currentDataSize=t.length,p.fillStyle=null!==(h=this.currentTime.color)&&void 0!==h?h:"rgba(0, 0, 0, 0.5)",p.fillRect(m,v,1,g)}},e.prototype.visualizeBySVG=function(t,r,n){var i,s,o,u,c,l,h,p,f,d,v,y,m,b,g,w,T,k,_,A,x,O,S;if(null!==this.svg&&this.isActive&&!(t instanceof Uint8Array)){var M=this.svg,E=parseInt(null!==(i=M.getAttribute("width"))&&void 0!==i?i:"0",10),P=parseInt(null!==(s=M.getAttribute("height"))&&void 0!==s?s:"0",10),C=null!==(o=this.styles.top)&&void 0!==o?o:15,R=null!==(u=this.styles.bottom)&&void 0!==u?u:15,j=null!==(c=this.styles.left)&&void 0!==c?c:30,N=E-(j+(null!==(l=this.styles.right)&&void 0!==l?l:30)),I=P-(C+R),q=Math.trunc(I/2)+C,D=null!==(h=this.styles.grid)&&void 0!==h?h:"none",F=null!==(p=this.styles.text)&&void 0!==p?p:"none",U=parseInt(null!==(d=null===(f=this.styles.font)||void 0===f?void 0:f.size)&&void 0!==d?d:"13px",10),L=Math.trunc(this.plotInterval*this.sampleRate),z=Math.trunc(this.textInterval*this.sampleRate);M.innerHTML="";var B=this.visualizeTimeDomainFloat32ArrayBySVG(t,N,I,q,L,"".concat(e.SVG_LINEAR_GRADIENT_ID_TIME_OVERVIEW,"-").concat(this.channel));if(B&&M.appendChild(B),"none"!==D||"none"!==F){for(var G=0,Q=t.length;G<Q;G++)if(G%z==0){var X=Math.trunc(G/Q*N)+j,V="".concat(Math.trunc(G/this.sampleRate/60)," min");if("none"!==D){var W=document.createElementNS(e.XMLNS,"rect");W.setAttribute("x",X.toString(10)),W.setAttribute("y",C.toString(10)),W.setAttribute("width","1"),W.setAttribute("height",I.toString(10)),W.setAttribute("stroke","none"),W.setAttribute("fill",D),M.appendChild(W)}if("none"!==F)(J=document.createElementNS(e.XMLNS,"text")).textContent=V,J.setAttribute("x",X.toString(10)),J.setAttribute("y",(C+I+U).toString(10)),J.setAttribute("text-anchor","middle"),J.setAttribute("stroke","none"),J.setAttribute("fill",F),J.setAttribute("font-family",null!==(y=null===(v=this.styles.font)||void 0===v?void 0:v.family)&&void 0!==y?y:"Arial"),J.setAttribute("font-size",U.toString(10)),J.setAttribute("font-style",null!==(b=null===(m=this.styles.font)||void 0===m?void 0:m.style)&&void 0!==b?b:"normal"),J.setAttribute("font-weight",null!==(w=null===(g=this.styles.font)||void 0===g?void 0:g.weight)&&void 0!==w?w:"normal"),M.appendChild(J)}for(var H=0,Y=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];H<Y.length;H++){V=Y[H],X=j;var J,$=Math.trunc((1-parseFloat(V.trim()))*(I/2))+C;if("none"!==D){var K=document.createElementNS(e.XMLNS,"rect");K.setAttribute("x",X.toString(10)),K.setAttribute("y",$.toString(10)),K.setAttribute("width",N.toString(10)),K.setAttribute("height","1"),K.setAttribute("stroke","none"),K.setAttribute("fill",D),M.appendChild(K)}if("none"!==F)(J=document.createElementNS(e.XMLNS,"text")).textContent=V,J.setAttribute("x",X.toString(10)),J.setAttribute("y",($-Math.trunc(U/4)).toString(10)),J.setAttribute("text-anchor","end"),J.setAttribute("stroke","none"),J.setAttribute("fill",F),J.setAttribute("font-family",null!==(k=null===(T=this.styles.font)||void 0===T?void 0:T.family)&&void 0!==k?k:"Arial"),J.setAttribute("font-size",U.toString(10)),J.setAttribute("font-style",null!==(A=null===(_=this.styles.font)||void 0===_?void 0:_.style)&&void 0!==A?A:"normal"),J.setAttribute("font-weight",null!==(O=null===(x=this.styles.font)||void 0===x?void 0:x.weight)&&void 0!==O?O:"normal"),M.appendChild(J)}}var Z=document.createElementNS(e.XMLNS,"rect");Z.classList.add(a),Z.setAttribute("y",(C+1).toString(10)),Z.setAttribute("height",(I-1).toString(10)),Z.setAttribute("stroke","none"),Z.setAttribute("fill",null!==(S=this.currentTime.color)&&void 0!==S?S:"rgba(0, 0, 0, 0.5)"),M.appendChild(Z),this.currentSVGElement=M,this.currentDataSize=t.length}},e.prototype.visualize=function(t,e,r){var n,i,s,o,a,u,c,l,h=0,p=0;switch(this.graphics){case"canvas":if(null===this.canvas)return;h=this.canvas.offsetLeft,p=this.canvas.width;break;case"svg":if(null===this.svg)return;h=null!==(i=null===(n=this.svg.parentElement)||void 0===n?void 0:n.offsetLeft)&&void 0!==i?i:0,p=parseInt(null!==(s=this.svg.getAttribute("width"))&&void 0!==s?s:"0",10)}var f=r-(h+(null!==(o=this.styles.left)&&void 0!==o?o:30));"canvas"===this.graphics&&(null===(a=this.canvas)||void 0===a?void 0:a.parentElement)&&(f+=this.canvas.parentElement.scrollLeft),"svg"===this.graphics&&(null===(u=this.svg)||void 0===u?void 0:u.parentElement)&&(f+=this.svg.parentElement.scrollLeft),f<0&&(f=0),f>(p-=(null!==(c=this.styles.left)&&void 0!==c?c:30)+(null!==(l=this.styles.right)&&void 0!==l?l:30))&&(f=p);var d=f/p*this.currentDataSize/this.sampleRate;"mousedown"!==e&&"touchstart"!==e||(this.offsetX=f,this.startTime=d,this.endTime=0),"mouseup"!==e&&"touchend"!==e||(this.endTime=d),this.update(d),this.startTime<=d?this.callback(t,this.startTime,d,this.mode,!0):this.startTime>d&&this.callback(t,d,this.startTime,this.mode,!1)},e.prototype.onMouseStart=function(t){"mousedown"===t.type&&this.visualize(t,t.type,this.getOffsetX(t)),this.isDown=!0},e.prototype.onMouseMove=function(t){this.isDown&&(t.stopPropagation(),"mousemove"===t.type&&this.visualize(t,t.type,this.getOffsetX(t)))},e.prototype.onMouseUp=function(t){this.isDown&&("mouseup"===t.type&&this.visualize(t,t.type,this.getOffsetX(t)),this.isDown=!1)},e.prototype.onTouchStart=function(t){"touchstart"===t.type&&this.visualize(t,t.type,this.getOffsetX(t)),this.isDown=!0},e.prototype.onTouchMove=function(t){this.isDown&&(t.stopPropagation(),t.preventDefault(),"touchmove"===t.type&&this.visualize(t,t.type,this.getOffsetX(t)))},e.prototype.onTouchEnd=function(t){this.isDown&&("touchend"===t.type&&this.visualize(t,t.type,this.getOffsetX(t)),this.isDown=!1)},e.prototype.getOffsetX=function(t){return t instanceof MouseEvent?t.pageX:t instanceof TouchEvent?t.touches[0].pageX:0},e}(o.Visualizer);e.TimeOverview=c},1386:function(t,e){var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Visualizer=void 0;var n=function(){function t(t,e){this.isActive=!1,this.graphics="",this.canvas=null,this.context=null,this.svg=null,this.interval=1e3,this.styles={shape:"line",gradients:[{offset:0,color:"rgba(0, 128, 255, 1.0)"},{offset:1,color:"rgba(0, 0, 255, 1.0)"}],wave:"rgba(0, 0, 255, 1.0)",grid:"rgba(255, 0, 0, 1.0)",text:"rgba(255, 255, 255, 1.0)",font:{family:"Arial",size:"13px",style:"normal",weight:"normal"},width:1.5,cap:"round",join:"miter",top:15,right:30,bottom:15,left:30},this.sampleRate=t,this.channel=e}return t.prototype.setup=function(t){return t instanceof HTMLCanvasElement?(this.graphics="canvas",this.canvas=t,this.context=this.canvas.getContext("2d")):t instanceof SVGSVGElement&&(this.graphics="svg",this.svg=t),this},t.prototype.start=function(t,e,r){switch(this.graphics){case"canvas":this.visualizeOnCanvas(t,e,r);break;case"svg":this.visualizeBySVG(t,e,r)}return this},t.prototype.param=function(t){if("string"==typeof t)switch(t){case"interval":return this.interval;case"styles":return this.styles;default:return}for(var e=0,n=Object.entries(t);e<n.length;e++){var i=n[e],s=i[0],o=i[1];switch(s){case"interval":"number"==typeof o&&(this.interval=o);break;case"styles":"object"==typeof o&&(this.styles=r(r({},this.styles),o))}}},t.prototype.get=function(){switch(this.graphics){case"canvas":return this.canvas;case"svg":return this.svg;default:return null}},t.prototype.clear=function(){switch(this.graphics){case"canvas":this.canvas&&this.context&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height);break;case"svg":this.svg&&(this.svg.innerHTML="")}return this},t.prototype.create=function(){switch(this.graphics){case"canvas":return null===this.canvas?"":this.canvas.toDataURL("image/png").replace("image/png","image/octet-stream");case"svg":return null===this.svg?"":this.svg.outerHTML;default:return""}},t.prototype.state=function(){return this.isActive},t.prototype.activate=function(){return this.isActive=!0,this},t.prototype.deactivate=function(){return this.isActive=!1,this},t.prototype.visualizeTimeDomainFloat32ArrayOnCanvas=function(t,e,r,n,i,s){var o,a,u,c,l,h,p=null!==(o=this.styles.top)&&void 0!==o?o:15,f=null!==(a=this.styles.left)&&void 0!==a?a:30,d=null!==(u=this.styles.width)&&void 0!==u?u:1.5,v=null!==(c=this.styles.cap)&&void 0!==c?c:"round",y=null!==(l=this.styles.join)&&void 0!==l?l:"miter",m=null!==(h=this.styles.wave)&&void 0!==h?h:"rgba(0, 0, 255, 1.0)";switch(this.styles.shape){case"line":t.strokeStyle=m,t.lineWidth=d,t.lineCap=v,t.lineJoin=y,t.beginPath();for(var b=0,g=e.length;b<g;b++)if(!s||b%s==0){var w=b/g*r+f,T=(1-e[b])*(n/2)+p;0===b?t.moveTo(w+t.lineWidth/2,T):t.lineTo(w,T)}t.stroke();break;case"rect":for(b=0,g=e.length;b<g;b++)if(!s||b%s==0){w=b/g*r+f,T=e[b]*(n/2)*-1;if(this.styles.gradients){for(var k=n/2+p,_=t.createLinearGradient(0,k,0,k+T),A=0,x=this.styles.gradients;A<x.length;A++){var O=x[A];_.addColorStop(O.offset,O.color)}t.fillStyle=_}else t.fillStyle=m;t.fillRect(w,i,d,T)}}},t.prototype.visualizeTimeDomainFloat32ArrayBySVG=function(e,r,n,i,s,o){var a,u,c,l,h,p,f,d=null!==(a=this.styles.top)&&void 0!==a?a:15,v=null!==(u=this.styles.left)&&void 0!==u?u:30,y=null!==(c=this.styles.width)&&void 0!==c?c:1.5,m=null!==(l=this.styles.cap)&&void 0!==l?l:"round",b=null!==(h=this.styles.join)&&void 0!==h?h:"miter",g=null!==(p=this.styles.wave)&&void 0!==p?p:"rgba(0, 0, 255, 1.0)";switch(this.styles.shape){case"line":for(var w=document.createElementNS(t.XMLNS,"path"),T="",k=0,_=e.length;k<_;k++)if(k%s==0){var A=k/_*r+v,x=(1-e[k])*(n/2)+d;T+=0===k?"M".concat(A+(null!==(f=this.styles.width)&&void 0!==f?f:1.5)/2," ").concat(x):" L".concat(A," ").concat(x)}return w.setAttribute("d",T),w.setAttribute("stroke",g),w.setAttribute("fill","none"),w.setAttribute("stroke-width",y.toString(10)),w.setAttribute("stroke-linecap",m),w.setAttribute("stroke-linejoin",b),w;case"rect":var O=null;this.styles.gradients&&(O=this.createSVGLinearGradient(o));var S=document.createElementNS(t.XMLNS,"g");null!==O&&S.appendChild(O);for(k=0,_=e.length;k<_;k++)if(k%s==0){var M=document.createElementNS(t.XMLNS,"rect");A=k/_*r+v,x=e[k]*(n/2);M.setAttribute("x",A.toString(10)),M.setAttribute("y",i.toString(10)),M.setAttribute("width",y.toString(10)),M.setAttribute("height",Math.abs(x).toString(10)),x>=0&&M.setAttribute("transform","rotate(180 ".concat(A+y/2," ").concat(i,")")),M.setAttribute("stroke","none"),M.setAttribute("fill",null===O?g:"url(#".concat(o,")")),S.appendChild(M)}return S;default:return null}},t.prototype.createSVGLinearGradient=function(e){if(!this.styles.gradients)return null;var r=document.createElementNS(t.XMLNS,"defs"),n=document.createElementNS(t.XMLNS,"linearGradient");n.setAttribute("id",e),n.setAttribute("x1","0%"),n.setAttribute("y1","0%"),n.setAttribute("x2","0%"),n.setAttribute("y2","100%");for(var i=0,s=this.styles.gradients;i<s.length;i++){var o=s[i],a=document.createElementNS(t.XMLNS,"stop");a.setAttribute("offset",o.offset.toString(10)),a.setAttribute("stop-color",o.color),n.appendChild(a)}return r.appendChild(n),r},t.prototype.createFontString=function(){var t,e=null!==(t=this.styles.font)&&void 0!==t?t:{},r=e.style,n=e.weight,i=e.size,s=e.family;return"".concat(null!=r?r:"normal"," ").concat(null!=n?n:"normal"," ").concat(null!=i?i:"13px",' "').concat(null!=s?s:"Arial",'"')},t.XMLNS="http://www.w3.org/2000/svg",t.XLINK="http://www.w3.org/1999/xlink",t.SVG_LINEAR_GRADIENT_ID_TIME_OVERVIEW="svg-linear-gradient-time-overview",t.SVG_LINEAR_GRADIENT_ID_TIME="svg-linear-gradient-time",t.SVG_LINEAR_GRADIENT_ID_FFT="svg-linear-gradient-fft",t}();e.Visualizer=n},8397:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Analyser=void 0;r(1386);var n=r(9076),i=r(235),s=r(6354),o=function(){function t(t){this.timeDomainAnimationId=null,this.timeDomainTimerId=null,this.frequencyDomainAnimationId=null,this.frequencyDomainTimerId=null,this.analyser=t.createAnalyser(),this.input=t.createGain(),this.input.connect(this.analyser),this.timeOverviewL=new n.TimeOverview(t.sampleRate,0),this.timeOverviewR=new n.TimeOverview(t.sampleRate,1),this.time=new i.Time(t.sampleRate,0),this.fft=new s.FFT(t.sampleRate,0),this.analyser.fftSize=2048,this.analyser.minDecibels=-100,this.analyser.maxDecibels=-30,this.analyser.smoothingTimeConstant=.8}return t.prototype.start=function(t,e,r){var n=this;switch(t){case"timeoverview":if((0===e||1===e)&&r)switch(e){case 0:if(r.numberOfChannels>e)(s=new Float32Array(r.length)).set(r.getChannelData(e)),this.timeOverviewL.start(s);break;case 1:if(r.numberOfChannels>e)(s=new Float32Array(r.length)).set(r.getChannelData(e)),this.timeOverviewR.start(s)}break;case"time":var i=this.time.param("interval");if("uint"===this.time.param("type")){var s=new Uint8Array(this.analyser.fftSize);this.analyser.getByteTimeDomainData(s),this.time.start(s)}else{s=new Float32Array(this.analyser.fftSize);this.analyser.getFloatTimeDomainData(s),this.time.start(s)}"number"==typeof i&&(this.stop(t),i<0?this.timeDomainAnimationId=window.requestAnimationFrame((function(){n.start(t)})):this.timeDomainTimerId=window.setTimeout((function(){n.start(t)}),i));break;case"fft":i=this.fft.param("interval");if("uint"===this.fft.param("type")){s=new Uint8Array(this.analyser.frequencyBinCount);this.analyser.getByteFrequencyData(s),this.fft.start(s)}else{s=new Float32Array(this.analyser.frequencyBinCount);this.analyser.getFloatFrequencyData(s),this.fft.start(s,this.analyser.minDecibels,this.analyser.maxDecibels)}"number"==typeof i&&(this.stop(t),i<0?this.frequencyDomainAnimationId=window.requestAnimationFrame((function(){n.start(t)})):this.frequencyDomainTimerId=window.setTimeout((function(){n.start(t)}),i))}return this},t.prototype.stop=function(t){switch(t){case"time":"number"==typeof(e=this.time.param("interval"))&&(e<0&&this.timeDomainAnimationId?(window.cancelAnimationFrame(this.timeDomainAnimationId),this.timeDomainAnimationId=null):this.timeDomainTimerId&&(window.clearTimeout(this.timeDomainTimerId),this.timeDomainTimerId=null));break;case"fft":var e;"number"==typeof(e=this.fft.param("interval"))&&(e<0&&this.frequencyDomainAnimationId?(window.cancelAnimationFrame(this.frequencyDomainAnimationId),this.frequencyDomainAnimationId=null):this.frequencyDomainTimerId&&(window.clearTimeout(this.frequencyDomainTimerId),this.frequencyDomainTimerId=null))}return this},t.prototype.param=function(t){if("string"==typeof t)switch(t){case"fftSize":return this.analyser.fftSize;case"frequencyBinCount":return this.analyser.frequencyBinCount;case"minDecibels":return this.analyser.minDecibels;case"maxDecibels":return this.analyser.maxDecibels;case"smoothingTimeConstant":return this.analyser.smoothingTimeConstant;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"fftSize":this.analyser.fftSize=s;break;case"minDecibels":this.analyser.minDecibels=s;break;case"maxDecibels":this.analyser.maxDecibels=s;break;case"smoothingTimeConstant":this.analyser.smoothingTimeConstant=s}}return this},t.prototype.domain=function(t,e){switch(t){case"timeoverview":switch(e){case 0:default:return this.timeOverviewL;case 1:return this.timeOverviewR}case"time":return this.time;case"fft":return this.fft;default:return this}return this},t.prototype.get=function(){return this.analyser},Object.defineProperty(t.prototype,"INPUT",{get:function(){return this.input},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"OUTPUT",{get:function(){return this.input},enumerable:!1,configurable:!0}),t}();e.Analyser=o},8044:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Autopanner=void 0;var s=function(t){function e(e){var r=t.call(this,e,0)||this;return r.panner=r.context.createStereoPanner(),r.panner.pan.value=0,r.depth.gain.value=0,r.rate.value=0,r.deactivate(),r.lfo.connect(r.depth),r.depth.connect(r.panner.pan),r}return i(e,t),e.prototype.stop=function(e,r){t.prototype.stop.call(this,e,r),this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.panner.pan))},e.prototype.connect=function(){return this.input.disconnect(0),this.panner.disconnect(0),this.isActive?(this.input.connect(this.panner),this.panner.connect(this.output)):this.input.connect(this.output),this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"depth":return this.depth.gain.value;case"rate":return this.rate.value;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"depth":"number"==typeof s&&(this.depth.gain.value=s);break;case"rate":"number"==typeof s&&(this.rate.value=s)}}return this},e.prototype.params=function(){return{state:this.isActive,depth:this.depth.gain.value,rate:this.rate.value}},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e}(r(1643).Effector);e.Autopanner=s},8649:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Chorus=void 0;var s=function(t){function e(e){var r=t.call(this,e,0)||this;return r.depthRate=0,r.delay=e.createDelay(),r.mix=e.createGain(),r.tone=e.createBiquadFilter(),r.feedback=e.createGain(),r.delay.delayTime.value=0,r.depth.gain.value=0,r.rate.value=0,r.mix.gain.value=0,r.tone.type="lowpass",r.tone.frequency.value=350,r.tone.Q.value=Math.SQRT1_2,r.tone.gain.value=0,r.feedback.gain.value=0,r.depthRate=0,r.deactivate(),r.lfo.connect(r.depth),r.depth.connect(r.delay.delayTime),r}return i(e,t),e.prototype.stop=function(e,r){t.prototype.stop.call(this,e,r),this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.delay.delayTime))},e.prototype.connect=function(){return this.input.disconnect(0),this.delay.disconnect(0),this.mix.disconnect(0),this.tone.disconnect(0),this.feedback.disconnect(0),this.input.connect(this.output),this.isActive&&(this.input.connect(this.tone),this.tone.connect(this.delay),this.delay.connect(this.mix),this.mix.connect(this.output),this.delay.connect(this.feedback),this.feedback.connect(this.delay)),this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"time":return this.delay.delayTime.value;case"depth":return this.depthRate;case"rate":return this.rate.value;case"mix":return this.mix.gain.value;case"tone":return this.tone.frequency.value;case"feedback":return this.feedback.gain.value;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"time":"number"==typeof s&&(this.delay.delayTime.value=s,this.depth.gain.value=this.delay.delayTime.value*this.depthRate);break;case"depth":"number"==typeof s&&(this.depthRate=s,this.depth.gain.value=this.delay.delayTime.value*s);break;case"rate":"number"==typeof s&&(this.rate.value=s);break;case"mix":"number"==typeof s&&(this.mix.gain.value=s);break;case"tone":"number"==typeof s&&(this.tone.frequency.value=s);break;case"feedback":"number"==typeof s&&(this.feedback.gain.value=s)}}return this},e.prototype.params=function(){return{state:this.isActive,time:this.delay.delayTime.value,depth:this.depthRate,rate:this.rate.value,mix:this.mix.gain.value,tone:this.tone.frequency.value,feedback:this.feedback.gain.value}},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e}(r(1643).Effector);e.Chorus=s},346:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Compressor=void 0;var s=function(t){function e(e){var r=t.call(this,e,0)||this;return r.compressor=e.createDynamicsCompressor(),r.compressor.threshold.value=-24,r.compressor.knee.value=30,r.compressor.ratio.value=12,r.compressor.attack.value=.003,r.compressor.release.value=.25,r.activate(),r}return i(e,t),e.prototype.connect=function(){return this.input.disconnect(0),this.compressor.disconnect(0),this.isActive?(this.input.connect(this.compressor),this.compressor.connect(this.output)):this.input.connect(this.output),this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"threshold":return this.compressor.threshold.value;case"knee":return this.compressor.knee.value;case"ratio":return this.compressor.ratio.value;case"attack":return this.compressor.attack.value;case"release":return this.compressor.release.value;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"threshold":"number"==typeof s&&(this.compressor.threshold.value=s);break;case"knee":"number"==typeof s&&(this.compressor.knee.value=s);break;case"ratio":"number"==typeof s&&(this.compressor.ratio.value=s);break;case"attack":"number"==typeof s&&(this.compressor.attack.value=s);break;case"release":"number"==typeof s&&(this.compressor.release.value=s)}}return this},e.prototype.params=function(){return{state:this.isActive,threshold:this.compressor.threshold.value,knee:this.compressor.knee.value,ratio:this.compressor.ratio.value,attack:this.compressor.attack.value,release:this.compressor.release.value}},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e}(r(1643).Effector);e.Compressor=s},4535:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Delay=void 0;var s=function(t){function e(r){var n=t.call(this,r,0)||this;return n.delay=r.createDelay(e.MAX_DELAY_TIME),n.dry=r.createGain(),n.wet=r.createGain(),n.tone=r.createBiquadFilter(),n.feedback=r.createGain(),n.delay.delayTime.value=0,n.dry.gain.value=1,n.wet.gain.value=0,n.tone.type="lowpass",n.tone.frequency.value=350,n.tone.Q.value=Math.SQRT1_2,n.tone.gain.value=0,n.feedback.gain.value=0,n.deactivate(),n}return i(e,t),e.prototype.connect=function(){return this.input.disconnect(0),this.delay.disconnect(0),this.dry.disconnect(0),this.wet.disconnect(0),this.tone.disconnect(0),this.feedback.disconnect(0),this.isActive?(this.input.connect(this.dry),this.dry.connect(this.output),this.input.connect(this.tone),this.tone.connect(this.delay),this.delay.connect(this.wet),this.wet.connect(this.output),this.delay.connect(this.feedback),this.feedback.connect(this.delay)):this.input.connect(this.output),this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"time":return this.delay.delayTime.value;case"dry":return this.dry.gain.value;case"wet":return this.wet.gain.value;case"tone":return this.tone.frequency.value;case"feedback":return this.feedback.gain.value;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"time":"number"==typeof s&&(this.delay.delayTime.value=s);break;case"dry":"number"==typeof s&&(this.dry.gain.value=s);break;case"wet":"number"==typeof s&&(this.wet.gain.value=s);break;case"tone":"number"==typeof s&&(this.tone.frequency.value=s);break;case"feedback":"number"==typeof s&&(this.feedback.gain.value=s)}}return this},e.prototype.params=function(){return{state:this.isActive,time:this.delay.delayTime.value,dry:this.dry.gain.value,wet:this.wet.gain.value,tone:this.tone.frequency.value,feedback:this.feedback.gain.value}},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e.MAX_DELAY_TIME=5,e}(r(1643).Effector);e.Delay=s},1605:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Distortion=e.Cabinet=e.PostEqualizer=e.PreEqualizer=void 0;var s=r(1643),o=function(t){function e(e){var r=t.call(this,e,0)||this;return r.preAmp=e.createWaveShaper(),r.gain=e.createGain(),r.leadGain=e.createGain(),r.lowpass=e.createBiquadFilter(),r.highpass1=e.createBiquadFilter(),r.highpass2=e.createBiquadFilter(),r.highpass3=e.createBiquadFilter(),r.gain.gain.value=.5,r.leadGain.gain.value=.5,r.lowpass.type="lowpass",r.lowpass.frequency.value=3200,r.lowpass.Q.value=Math.SQRT1_2,r.lowpass.gain.value=0,r.highpass1.type="highpass",r.highpass1.frequency.value=80,r.highpass1.Q.value=Math.SQRT1_2,r.highpass1.gain.value=0,r.highpass2.type="highpass",r.highpass2.frequency.value=640,r.highpass2.Q.value=Math.SQRT1_2,r.highpass2.gain.value=0,r.highpass3.type="highpass",r.highpass3.frequency.value=80,r.highpass3.Q.value=Math.SQRT1_2,r.highpass3.gain.value=0,r.deactivate(),r}return i(e,t),e.prototype.connect=function(){return this.input.disconnect(0),this.isActive?(this.input.connect(this.highpass1),this.highpass1.connect(this.gain),this.gain.connect(this.highpass3),this.input.connect(this.highpass2),this.highpass2.connect(this.leadGain),this.leadGain.connect(this.highpass3),this.highpass3.connect(this.preAmp),this.preAmp.connect(this.output)):this.input.connect(this.output),this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"state":return this.isActive;case"curve":return this.preAmp.curve;case"gain":return this.gain.gain.value;case"lead":return this.leadGain.gain.value;default:return}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"state":"boolean"==typeof s&&(s?this.activate():this.deactivate());break;case"curve":"number"!=typeof s&&"boolean"!=typeof s&&(this.preAmp.curve=s);break;case"gain":"number"==typeof s&&(this.gain.gain.value=s);break;case"lead":"number"==typeof s&&(this.leadGain.gain.value=s)}}},e.prototype.params=function(){return{state:this.isActive,curve:this.preAmp.curve,gain:this.gain.gain.value,lead:this.leadGain.gain.value}},e}(s.Effector);e.PreEqualizer=o;var a=function(t){function e(e){var r=t.call(this,e,0)||this;return r.distortion=e.createWaveShaper(),r.bass=e.createBiquadFilter(),r.middle=e.createBiquadFilter(),r.treble=e.createBiquadFilter(),r.bass.type="lowshelf",r.middle.type="peaking",r.treble.type="highshelf",r.bass.frequency.value=240,r.middle.frequency.value=500,r.treble.frequency.value=1600,r.bass.Q.value=Math.SQRT1_2,r.middle.Q.value=Math.SQRT1_2,r.treble.Q.value=Math.SQRT1_2,r.bass.gain.value=0,r.middle.gain.value=0,r.treble.gain.value=0,r.lowpass=e.createBiquadFilter(),r.highpass=e.createBiquadFilter(),r.lowpass.type="lowpass",r.lowpass.frequency.value=24e3,r.lowpass.Q.value=Math.SQRT1_2,r.lowpass.gain.value=0,r.highpass.type="highpass",r.highpass.frequency.value=40,r.highpass.Q.value=Math.SQRT1_2,r.highpass.gain.value=0,r.deactivate(),r}return i(e,t),e.prototype.connect=function(){return this.input.disconnect(0),this.isActive?(this.input.connect(this.lowpass),this.lowpass.connect(this.highpass),this.highpass.connect(this.distortion),this.distortion.connect(this.bass),this.bass.connect(this.middle),this.middle.connect(this.treble),this.treble.connect(this.output)):this.input.connect(this.output),this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"state":return this.isActive;case"curve":return this.distortion.curve;case"bass":return this.bass.gain.value;case"middle":return this.middle.gain.value;case"treble":return this.treble.gain.value;case"frequency":return this.middle.frequency.value;default:return}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"state":"boolean"==typeof s&&(s?this.activate():this.deactivate());break;case"curve":"number"!=typeof s&&"boolean"!=typeof s&&(this.distortion.curve=s);break;case"bass":"number"==typeof s&&(this.bass.gain.value=s);break;case"middle":"number"==typeof s&&(this.middle.gain.value=s);break;case"treble":"number"==typeof s&&(this.treble.gain.value=s);break;case"frequency":"number"==typeof s&&(this.middle.frequency.value=s)}}},e.prototype.params=function(){return{state:this.isActive,curve:this.distortion.curve,bass:this.bass.gain.value,middle:this.middle.gain.value,treble:this.treble.gain.value,frequency:this.middle.frequency.value}},e}(s.Effector);e.PostEqualizer=a;var u=function(t){function e(e){var r=t.call(this,e,0)||this;return r.lowpass=e.createBiquadFilter(),r.notch=e.createBiquadFilter(),r.lowpass.type="lowpass",r.lowpass.frequency.value=3200,r.lowpass.Q.value=6,r.lowpass.gain.value=0,r.notch.type="notch",r.notch.frequency.value=8e3,r.notch.Q.value=1,r.notch.gain.value=0,r.deactivate(),r}return i(e,t),e.prototype.connect=function(){return this.input.disconnect(0),this.isActive?(this.input.connect(this.notch),this.notch.connect(this.lowpass),this.lowpass.connect(this.output)):this.input.connect(this.output),this.output},e.prototype.params=function(){return{state:this.isActive}},e}(s.Effector);e.Cabinet=u;var c=function(t){function e(e){var r=t.call(this,e,0)||this;return r.numberOfSamples=256,r.preEQ=new o(e),r.postEQ=new a(e),r.cabinet=new u(e),r.type="clean",r.param({curve:"clean"}),r.deactivate(),r}return i(e,t),e.createCurve=function(t,e){var r=Math.trunc((e-1)/2),n=new Float32Array(e),i=(Math.pow(10,t/5-1)-.1)/5+1,s=.4;1===i?s=1:i>1&&i<1.04&&(s=-15.5*i+16.52);for(var o=0;o<r;o++)n[r+o]=s*(1-Math.pow(i,-o)+o*Math.pow(i,-r)/r),n[r-o]=s*(-1+Math.pow(i,-o)-o*Math.pow(i,-r)/r);return n[r]=0,n},e.prototype.connect=function(){return this.input.disconnect(0),this.isActive?(this.input.connect(this.preEQ.INPUT),this.preEQ.OUTPUT.connect(this.postEQ.INPUT),this.postEQ.OUTPUT.connect(this.cabinet.INPUT),this.cabinet.OUTPUT.connect(this.output)):this.input.connect(this.output),this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"curve":return this.type;case"samples":return this.numberOfSamples;case"pre":return this.preEQ.params();case"post":return this.postEQ.params();case"cabinet":return this.cabinet.params();default:return this}for(var r=0,n=Object.entries(t);r<n.length;r++){var i=n[r],s=i[0],o=i[1];switch(s){case"curve":var a=null;switch(o){case"clean":this.type="clean",a=e.createCurve(0,this.numberOfSamples);break;case"crunch":this.type="crunch",a=e.createCurve(3,this.numberOfSamples);break;case"overdrive":this.type="overdrive",a=e.createCurve(5,this.numberOfSamples);break;case"distortion":this.type="distortion",a=e.createCurve(8,this.numberOfSamples);break;case"fuzz":this.type="fuzz",a=e.createCurve(10,this.numberOfSamples);break;default:o instanceof Float32Array&&(a=o)}this.preEQ.param({curve:a}),this.postEQ.param({curve:a});break;case"samples":"number"==typeof o&&(this.numberOfSamples=o);break;case"pre":"object"==typeof o&&this.preEQ.param(o);break;case"post":"object"==typeof o&&this.postEQ.param(o);break;case"cabinet":this.cabinet.state()?this.cabinet.deactivate():this.cabinet.activate()}}return this},e.prototype.params=function(){return{state:this.isActive,curve:this.type,samples:this.numberOfSamples,pre:this.preEQ.params(),post:this.postEQ.params(),cabinet:this.cabinet.params()}},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e}(s.Effector);e.Distortion=c},1643:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Effector=void 0;var r=function(){function t(t,e){this.isActive=!0,this.paused=!0,this.context=t,this.input=t.createGain(),this.output=t.createGain(),this.lfo=t.createOscillator(),this.depth=t.createGain(),this.rate=this.lfo.frequency,this.processor=t.createScriptProcessor(e,2,2)}return t.prototype.start=function(t){this.isActive&&this.paused&&(this.lfo.start(null!=t?t:this.context.currentTime),this.paused=!1)},t.prototype.stop=function(t,e){if(this.isActive&&!this.paused){var r=this.lfo.type,n=this.lfo.frequency.value;this.lfo.stop((null!=t?t:this.context.currentTime)+(null!=e?e:0)),this.lfo=this.context.createOscillator(),this.lfo.type=r,this.lfo.frequency.value=n,this.rate=this.lfo.frequency,this.paused=!0}},t.prototype.toJSON=function(){return JSON.stringify(this.params())},t.prototype.state=function(){return this.isActive},t.prototype.activate=function(){return this.isActive=!0,this.connect(),this.start(0),this},t.prototype.deactivate=function(){return this.isActive=!1,this.connect(),this.start(0),this},Object.defineProperty(t.prototype,"INPUT",{get:function(){return this.input},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"OUTPUT",{get:function(){return this.output},enumerable:!1,configurable:!0}),t}();e.Effector=r},8137:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.EnvelopeGenerator=void 0;var r=function(){function t(t){this.generators=[],this.activeIndexes=[],this.activeCounter=0,this.attack=.01,this.decay=.3,this.sustain=.5,this.release=1,this.context=t}return t.prototype.ready=function(t,e,r){e&&r&&this.generators[t]?(e.connect(this.generators[t]),this.generators[t].connect(r)):e&&null===r&&this.generators[t]?e.connect(this.generators[t]):null===e&&r&&this.generators[t]&&this.generators[t].connect(r),this.activeIndexes[t]=t,this.activeCounter++},t.prototype.start=function(t){for(var e=t,r=e+this.attack,n=this.decay,i=this.sustain,s=0,o=this.activeIndexes;s<o.length;s++){var a=o[s];void 0!==a&&(this.generators[a].gain.cancelScheduledValues(e),this.generators[a].gain.setValueAtTime(0,e),this.generators[a].gain.linearRampToValueAtTime(1,r),this.generators[a].gain.setTargetAtTime(i,r,n))}},t.prototype.stop=function(t,e){for(var r=t-this.release,n=r>=this.context.currentTime?r:this.context.currentTime,i=this.release,s=0,o=this.activeIndexes;s<o.length;s++){var a=o[s];void 0!==a&&(this.generators[a].gain.cancelScheduledValues(n),e?this.generators[a].gain.setValueCurveAtTime(new Float32Array([1,.5,.25,0]),n,i):this.generators[a].gain.setTargetAtTime(0,n,i))}},t.prototype.param=function(t){if("string"==typeof t)switch(t){case"attack":return this.attack;case"decay":return this.decay;case"sustain":return this.sustain;case"release":return this.release;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"attack":"number"==typeof s&&(this.attack=s);break;case"decay":"number"==typeof s&&(this.decay=s);break;case"sustain":"number"==typeof s&&(this.sustain=s);break;case"release":"number"==typeof s&&(this.release=s)}}return this},t.prototype.getGenerator=function(t){return t>=0&&t<this.generators.length?this.generators[t]:null},t.prototype.setGenerator=function(t){this.generators[t]=this.context.createGain()},t.prototype.paused=function(){for(var e=0,r=0,n=this.activeIndexes;r<n.length;r++){var i=n[r];if(void 0!==i){if(this.generators[i].gain.value>t.MIN_GAIN)return!1;if(++e===this.activeCounter)return!0}}return!1},t.prototype.clear=function(t){this.activeIndexes.length=0,this.activeCounter=0;for(var e=0,r=this.generators;e<r.length;e++){var n=r[e];n.gain.cancelScheduledValues(this.context.currentTime),n.gain.value=1,t&&n.disconnect(0)}},t.prototype.params=function(){return{attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release}},t.prototype.toJSON=function(){return JSON.stringify(this.params())},t.MIN_GAIN=.001,t}();e.EnvelopeGenerator=r},111:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Equalizer=void 0;var s=function(t){function e(e){var r=t.call(this,e,0)||this;return r.bass=e.createBiquadFilter(),r.middle=e.createBiquadFilter(),r.treble=e.createBiquadFilter(),r.presence=e.createBiquadFilter(),r.bass.type="lowshelf",r.middle.type="peaking",r.treble.type="highshelf",r.presence.type="highshelf",r.bass.frequency.value=500,r.middle.frequency.value=1e3,r.treble.frequency.value=2e3,r.presence.frequency.value=4e3,r.bass.Q.value=Math.SQRT1_2,r.middle.Q.value=Math.SQRT1_2,r.treble.Q.value=Math.SQRT1_2,r.presence.Q.value=Math.SQRT1_2,r.bass.gain.value=0,r.middle.gain.value=0,r.treble.gain.value=0,r.presence.gain.value=0,r.deactivate(),r}return i(e,t),e.prototype.connect=function(){return this.input.disconnect(0),this.bass.disconnect(0),this.middle.disconnect(0),this.treble.disconnect(0),this.presence.disconnect(0),this.isActive?(this.input.connect(this.bass),this.bass.connect(this.middle),this.middle.connect(this.treble),this.treble.connect(this.presence),this.presence.connect(this.output)):this.input.connect(this.output),this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"bass":return this.bass.gain.value;case"middle":return this.middle.gain.value;case"treble":return this.treble.gain.value;case"presence":return this.presence.gain.value;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"bass":"number"==typeof s&&(this.bass.gain.value=s);break;case"middle":"number"==typeof s&&(this.middle.gain.value=s);break;case"treble":"number"==typeof s&&(this.treble.gain.value=s);break;case"presence":"number"==typeof s&&(this.presence.gain.value=s)}}return this},e.prototype.params=function(){return{state:this.isActive,bass:this.bass.gain.value,middle:this.middle.gain.value,treble:this.treble.gain.value,presence:this.presence.gain.value}},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e}(r(1643).Effector);e.Equalizer=s},7369:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Filter=void 0;var s=function(t){function e(e){var r=t.call(this,e,0)||this;return r.range=.1,r.attack=.01,r.decay=.3,r.sustain=1,r.release=1,r.filter=e.createBiquadFilter(),r.filter.type="lowpass",r.filter.frequency.value=350,r.filter.Q.value=1,r.filter.gain.value=0,r.maxFrequency=r.filter.frequency.value,r.deactivate(),r}return i(e,t),e.prototype.start=function(t){if(this.isActive){var e=null!=t?t:this.context.currentTime,r=e+this.attack,n=this.decay,i=this.sustain*this.maxFrequency,s=this.maxFrequency*this.range;this.filter.frequency.cancelScheduledValues(e),this.filter.frequency.setValueAtTime(s,e),this.filter.frequency.linearRampToValueAtTime(this.maxFrequency,r),this.filter.frequency.setTargetAtTime(i,r,n)}},e.prototype.stop=function(t){if(this.isActive){var e=null!=t?t:this.context.currentTime,r=this.release,n=this.maxFrequency*this.range;this.filter.frequency.cancelScheduledValues(e),this.filter.frequency.setValueAtTime(this.filter.frequency.value,e),this.filter.frequency.setTargetAtTime(n,e,r)}},e.prototype.connect=function(){return this.input.disconnect(0),this.filter.disconnect(0),this.isActive?(this.input.connect(this.filter),this.filter.connect(this.output)):this.input.connect(this.output),this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"type":return this.filter.type;case"frequency":return this.filter.frequency.value;case"Q":return this.filter.Q.value;case"gain":return this.filter.gain.value;case"range":return this.range;case"attack":return this.attack;case"decay":return this.decay;case"sustain":return this.sustain;case"release":return this.release;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"type":"string"==typeof s&&(this.filter.type=s);break;case"frequency":"number"==typeof s&&(this.filter.frequency.value=s,this.maxFrequency=s);break;case"Q":"number"==typeof s&&(this.filter.Q.value=s);break;case"gain":"number"==typeof s&&(this.filter.gain.value=s);break;case"range":"number"==typeof s&&(this.range=s);break;case"attack":"number"==typeof s&&(this.attack=s);break;case"decay":"number"==typeof s&&(this.decay=s);break;case"sustain":"number"==typeof s&&(this.sustain=s);break;case"release":"number"==typeof s&&(this.release=s)}}return this},e.prototype.params=function(){return{state:this.isActive,type:this.filter.type,frequency:this.filter.frequency.value,Q:this.filter.Q.value,gain:this.filter.gain.value,range:this.range,attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release}},e.prototype.activate=function(){return this.isActive=!0,this.connect(),this},e.prototype.deactivate=function(){return this.isActive=!1,this.connect(),this},e}(r(1643).Effector);e.Filter=s},6548:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Flanger=void 0;var s=function(t){function e(e){var r=t.call(this,e,0)||this;return r.depthRate=0,r.delay=e.createDelay(),r.mix=e.createGain(),r.tone=e.createBiquadFilter(),r.feedback=e.createGain(),r.delay.delayTime.value=0,r.depth.gain.value=0,r.rate.value=0,r.mix.gain.value=0,r.tone.type="lowpass",r.tone.frequency.value=350,r.tone.Q.value=Math.SQRT1_2,r.tone.gain.value=0,r.feedback.gain.value=0,r.depthRate=0,r.deactivate(),r.lfo.connect(r.depth),r.depth.connect(r.delay.delayTime),r}return i(e,t),e.prototype.stop=function(e,r){t.prototype.stop.call(this,e,r),this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.delay.delayTime))},e.prototype.connect=function(){return this.input.disconnect(0),this.delay.disconnect(0),this.mix.disconnect(0),this.tone.disconnect(0),this.feedback.disconnect(0),this.input.connect(this.output),this.isActive&&(this.input.connect(this.tone),this.tone.connect(this.delay),this.delay.connect(this.mix),this.mix.connect(this.output),this.delay.connect(this.feedback),this.feedback.connect(this.delay)),this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"time":return this.delay.delayTime.value;case"depth":return this.depthRate;case"rate":return this.rate.value;case"mix":return this.mix.gain.value;case"tone":return this.tone.frequency.value;case"feedback":return this.feedback.gain.value;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"time":"number"==typeof s&&(this.delay.delayTime.value=s,this.depth.gain.value=this.delay.delayTime.value*this.depthRate);break;case"depth":"number"==typeof s&&(this.depthRate=s,this.depth.gain.value=this.delay.delayTime.value*s);break;case"rate":"number"==typeof s&&(this.rate.value=s);break;case"mix":"number"==typeof s&&(this.mix.gain.value=s);break;case"tone":"number"==typeof s&&(this.tone.frequency.value=s);break;case"feedback":"number"==typeof s&&(this.feedback.gain.value=s)}}return this},e.prototype.params=function(){return{state:this.isActive,time:this.delay.delayTime.value,depth:this.depthRate,rate:this.rate.value,mix:this.mix.gain.value,tone:this.tone.frequency.value,feedback:this.feedback.gain.value}},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e}(r(1643).Effector);e.Flanger=s},4226:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Listener=void 0;var s=function(t){function e(e){var r=t.call(this,e,0)||this;return r.listener=e.listener,r.positions={x:0,y:0,z:0},r.forwards={x:0,y:0,z:-1},r.ups={x:0,y:1,z:0},r.listener.setPosition(r.positions.x,r.positions.y,r.positions.z),r.listener.setOrientation(r.forwards.x,r.forwards.y,r.forwards.z,r.ups.x,r.ups.y,r.ups.z),r}return i(e,t),e.prototype.connect=function(){return this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"x":return this.positions.x;case"y":return this.positions.y;case"z":return this.positions.z;case"fx":return this.forwards.x;case"fy":return this.forwards.y;case"fz":return this.forwards.z;case"ux":return this.ups.x;case"uy":return this.ups.y;case"uz":return this.ups.z;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"x":"number"==typeof s&&(this.positions.x=s,this.listener.setPosition(this.positions.x,this.positions.y,this.positions.z));break;case"y":"number"==typeof s&&(this.positions.y=s,this.listener.setPosition(this.positions.x,this.positions.y,this.positions.z));break;case"z":"number"==typeof s&&(this.positions.z=s,this.listener.setPosition(this.positions.x,this.positions.y,this.positions.z));break;case"fx":"number"==typeof s&&(this.forwards.x=s,this.listener.setOrientation(this.forwards.x,this.forwards.y,this.forwards.z,this.ups.x,this.ups.y,this.ups.z));break;case"fy":"number"==typeof s&&(this.forwards.y=s,this.listener.setOrientation(this.forwards.x,this.forwards.y,this.forwards.z,this.ups.x,this.ups.y,this.ups.z));break;case"fz":"number"==typeof s&&(this.forwards.z=s,this.listener.setOrientation(this.forwards.x,this.forwards.y,this.forwards.z,this.ups.x,this.ups.y,this.ups.z));break;case"ux":"number"==typeof s&&(this.ups.x=s,this.listener.setOrientation(this.forwards.x,this.forwards.y,this.forwards.z,this.ups.x,this.ups.y,this.ups.z));break;case"uy":"number"==typeof s&&(this.ups.y=s,this.listener.setOrientation(this.forwards.x,this.forwards.y,this.forwards.z,this.ups.x,this.ups.y,this.ups.z));break;case"uz":"number"==typeof s&&(this.ups.z=s,this.listener.setOrientation(this.forwards.x,this.forwards.y,this.forwards.z,this.ups.x,this.ups.y,this.ups.z))}}return this},e.prototype.params=function(){return{x:this.positions.x,y:this.positions.y,z:this.positions.z,fx:this.forwards.x,fy:this.forwards.y,fz:this.forwards.z,ux:this.ups.x,uy:this.ups.y,uz:this.ups.z}},e}(r(1643).Effector);e.Listener=s},3751:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Panner=void 0;var s=function(t){function e(e){var r=t.call(this,e,0)||this;return r.panner=e.createPanner(),r.positions={x:0,y:0,z:0},r.orientations={x:1,y:0,z:0},r.panner.refDistance=1,r.panner.maxDistance=1e4,r.panner.rolloffFactor=1,r.panner.coneInnerAngle=360,r.panner.coneOuterAngle=360,r.panner.coneOuterGain=0,r.panner.panningModel="HRTF",r.panner.distanceModel="inverse",r.panner.positionX.value=r.positions.x,r.panner.positionY.value=r.positions.y,r.panner.positionZ.value=r.positions.z,r.panner.orientationX.value=r.orientations.x,r.panner.orientationY.value=r.orientations.y,r.panner.orientationZ.value=r.orientations.z,r.deactivate(),r}return i(e,t),e.prototype.connect=function(){return this.input.disconnect(0),this.panner.disconnect(0),this.isActive?(this.input.connect(this.panner),this.panner.connect(this.output)):this.input.connect(this.output),this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"x":return this.panner.positionX.value;case"y":return this.panner.positionY.value;case"z":return this.panner.positionZ.value;case"ox":return this.panner.orientationX.value;case"oy":return this.panner.orientationY.value;case"oz":return this.panner.orientationZ.value;case"refDistance":return this.panner.refDistance;case"maxDistance":return this.panner.maxDistance;case"rolloffFactor":return this.panner.rolloffFactor;case"coneInnerAngle":return this.panner.coneInnerAngle;case"coneOuterAngle":return this.panner.coneOuterAngle;case"coneOuterGain":return this.panner.coneOuterGain;case"panningModel":return this.panner.panningModel;case"distanceModel":return this.panner.distanceModel;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"x":"number"==typeof s&&(this.panner.positionX.value=s);break;case"y":"number"==typeof s&&(this.panner.positionY.value=s);break;case"z":"number"==typeof s&&(this.panner.positionZ.value=s);break;case"ox":"number"==typeof s&&(this.panner.orientationX.value=s);break;case"oy":"number"==typeof s&&(this.panner.orientationY.value=s);break;case"oz":"number"==typeof s&&(this.panner.orientationZ.value=s);break;case"refDistance":"number"==typeof s&&(this.panner.refDistance=s);break;case"maxDistance":"number"==typeof s&&(this.panner.maxDistance=s);break;case"rolloffFactor":"number"==typeof s&&(this.panner.rolloffFactor=s);break;case"coneInnerAngle":"number"==typeof s&&(this.panner.coneInnerAngle=s);break;case"coneOuterAngle":"number"==typeof s&&(this.panner.coneOuterAngle=s);break;case"coneOuterGain":"number"==typeof s&&(this.panner.coneOuterGain=s);break;case"panningModel":"HRTF"!==s&&"equalpower"!==s||(this.panner.panningModel=s);break;case"distanceModel":"linear"!==s&&"inverse"!==s&&"exponential"!==s||(this.panner.distanceModel=s)}}return this},e.prototype.params=function(){return{state:this.isActive,x:this.positions.x,y:this.positions.y,z:this.positions.z,ox:this.orientations.x,oy:this.orientations.y,oz:this.orientations.z,refDistance:this.panner.refDistance,maxDistance:this.panner.maxDistance,rolloffFactor:this.panner.rolloffFactor,coneInnerAngle:this.panner.coneInnerAngle,coneOuterAngle:this.panner.coneOuterAngle,coneOuterGain:this.panner.coneOuterGain,panningModel:this.panner.panningModel,distanceModel:this.panner.distanceModel}},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e}(r(1643).Effector);e.Panner=s},2393:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Phaser=void 0;var s=function(t){function e(r){var n=t.call(this,r,0)||this;n.numberOfStages=12,n.filters=[],n.depthRate=0;for(var i=0;i<e.MAX_STAGES;i++){var s=r.createBiquadFilter();s.type="allpass",s.frequency.value=350,s.Q.value=1,s.gain.value=0,n.filters.push(s)}n.mix=r.createGain(),n.feedback=r.createGain(),n.depth.gain.value=0,n.rate.value=0,n.mix.gain.value=0,n.feedback.gain.value=0,n.deactivate(),n.lfo.connect(n.depth);for(i=0;i<e.MAX_STAGES;i++)n.depth.connect(n.filters[i].frequency);return n}return i(e,t),e.prototype.stop=function(r,n){if(t.prototype.stop.call(this,r,n),this.isActive){this.lfo.connect(this.depth);for(var i=0;i<e.MAX_STAGES;i++)this.depth.connect(this.filters[i].frequency)}},e.prototype.connect=function(){this.input.disconnect(0);for(var t=0;t<e.MAX_STAGES;t++)this.filters[t].disconnect(0);if(this.mix.disconnect(0),this.feedback.disconnect(0),this.input.connect(this.output),this.isActive&&this.numberOfStages>0){this.input.connect(this.filters[0]);for(t=0;t<this.numberOfStages;t++)t<this.numberOfStages-1?this.filters[t].connect(this.filters[t+1]):(this.filters[t].connect(this.mix),this.mix.connect(this.output),this.filters[t].connect(this.feedback),this.feedback.connect(this.filters[0]))}return this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"stage":return this.numberOfStages;case"frequency":return this.filters[0].frequency.value;case"resonance":return this.filters[0].Q.value;case"depth":return this.depthRate;case"rate":return this.rate.value;case"mix":return this.mix.gain.value;case"feedback":return this.feedback.gain.value;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"stage":switch(s){case 0:case 2:case 4:case 8:case 12:case 24:this.numberOfStages=s,this.connect()}break;case"frequency":if("number"==typeof s){for(var o=0,a=this.filters;o<a.length;o++){a[o].frequency.value=s}this.depth.gain.value=this.filters[0].frequency.value*this.depthRate}break;case"resonance":if("number"==typeof s)for(var u=0,c=this.filters;u<c.length;u++){c[u].Q.value=s}break;case"depth":"number"==typeof s&&(this.depthRate=s,this.depth.gain.value=this.filters[0].frequency.value*s);break;case"rate":"number"==typeof s&&(this.rate.value=s);break;case"mix":"number"==typeof s&&(this.mix.gain.value=s);break;case"feedback":"number"==typeof s&&(this.feedback.gain.value=s)}}return this},e.prototype.params=function(){return{state:this.isActive,stage:this.numberOfStages,frequency:this.filters[0].frequency.value,resonance:this.filters[0].Q.value,depth:this.depthRate,rate:this.rate.value,mix:this.mix.gain.value,feedback:this.feedback.gain.value}},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e.MAX_STAGES=24,e}(r(1643).Effector);e.Phaser=s},4833:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.PitchShifter=void 0;var s=r(999),o=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.pitch=1,n.deactivate(),n.connect(),n}return i(e,t),e.prototype.start=function(){var t=this;if(this.isActive&&this.paused){this.paused=!1;var r=this.processor.bufferSize;this.processor.onaudioprocess=function(n){var i=n.inputBuffer.getChannelData(0),o=n.inputBuffer.getChannelData(1),a=n.outputBuffer.getChannelData(0),u=n.outputBuffer.getChannelData(1);if(t.isActive&&1!==t.pitch){var c=new Float32Array(i),l=new Float32Array(o),h=new Float32Array(r),p=new Float32Array(r);(0,s.fft)(c,h,r),(0,s.fft)(l,p,r);for(var f=new Float32Array(r),d=new Float32Array(r),v=new Float32Array(r),y=new Float32Array(r),m=0;m<r;m++){var b=Math.trunc(t.pitch*m),g=1;m>r/2&&(g=0),b>=0&&b<r&&(f[b]+=e.GAIN_CORRECTION*g*c[m],v[b]+=e.GAIN_CORRECTION*g*h[m],d[b]+=e.GAIN_CORRECTION*g*l[m],y[b]+=e.GAIN_CORRECTION*g*p[m])}(0,s.ifft)(f,v,r),(0,s.ifft)(d,y,r),a.set(f),u.set(d)}else a.set(i),u.set(o)}}},e.prototype.stop=function(){this.isActive&&(this.paused=!0,this.processor.disconnect(0),this.processor.onaudioprocess=null,this.connect())},e.prototype.connect=function(){return this.input.disconnect(0),this.processor.disconnect(0),this.isActive?(this.input.connect(this.processor),this.processor.connect(this.output)):this.input.connect(this.output),this.output},e.prototype.param=function(t){if("string"==typeof t)return"pitch"===t?this.pitch:this;for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];if("pitch"===i)"number"==typeof s&&s>0&&(this.pitch=s)}return this},e.prototype.params=function(){return{state:this.isActive,pitch:this.pitch}},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e.GAIN_CORRECTION=2,e}(r(1643).Effector);e.PitchShifter=o},1063:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Reverb=void 0;var s=function(t){function e(e){var r=t.call(this,e,0)||this;return r.rirs=[],r.isLoadError=!1,r.convolver=e.createConvolver(),r.dry=e.createGain(),r.wet=e.createGain(),r.tone=e.createBiquadFilter(),r.dry.gain.value=1,r.wet.gain.value=0,r.tone.type="lowpass",r.tone.frequency.value=350,r.tone.Q.value=Math.SQRT1_2,r.tone.gain.value=0,r.deactivate(),r}return i(e,t),e.prototype.connect=function(){return this.input.disconnect(0),this.convolver.disconnect(0),this.dry.disconnect(0),this.wet.disconnect(0),this.tone.disconnect(0),this.isActive?(this.input.connect(this.dry),this.dry.connect(this.output),this.input.connect(this.tone),this.tone.connect(this.convolver),this.convolver.connect(this.wet),this.wet.connect(this.output)):this.input.connect(this.output),this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"buffer":return this.convolver.buffer;case"dry":return this.dry.gain.value;case"wet":return this.wet.gain.value;case"tone":return this.tone.frequency.value;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"buffer":"number"==typeof s?s>=0&&s<this.rirs.length&&(this.convolver.buffer=this.rirs[s],this.connect()):s instanceof AudioBuffer?(this.convolver.buffer=s,this.connect()):null===s&&(this.convolver.buffer=null,this.input.disconnect(0),this.input.connect(this.output));break;case"dry":"number"==typeof s&&(this.dry.gain.value=s);break;case"wet":"number"==typeof s&&(this.wet.gain.value=s);break;case"tone":"number"==typeof s&&(this.tone.frequency.value=s)}}return this},e.prototype.add=function(t,e){var r=this;if(t instanceof AudioBuffer)this.convolver.buffer=t,this.rirs.push(t);else if(t instanceof ArrayBuffer){this.context.decodeAudioData(t,(function(t){r.convolver.buffer=t,r.rirs.push(t)}),null!=e?e:function(){})}return this},e.prototype.preset=function(t){for(var e=t.rirs,r=t.timeout,n=t.successCallback,i=t.errorCallback,s=t.progressCallback,o=0,a=e.length;o<a;o++){var u=e[o];"string"==typeof u?this.load({rir:u,index:o,timeout:r,successCallback:n,errorCallback:i,progressCallback:s}):this.rirs[o]=u}},e.prototype.params=function(){return{state:this.isActive,dry:this.dry.gain.value,wet:this.wet.gain.value,tone:this.tone.frequency.value}},e.prototype.activate=function(){return this.isActive=!0,this.connect(),this},e.prototype.deactivate=function(){return this.isActive=!1,this.connect(),this},e.prototype.load=function(t){var e=this,r=t.rir,n=t.index,i=t.timeout,s=t.successCallback,o=t.errorCallback,a=t.progressCallback,u=new XMLHttpRequest;u.timeout=null!=i?i:6e4,u.ontimeout=function(t){!e.isLoadError&&o&&o(t,"timeout"),e.isLoadError=!0},u.onprogress=function(t){e.isLoadError?u.abort():a&&a(t)},u.onerror=function(t){!e.isLoadError&&o&&o(t,"error"),e.isLoadError=!0},u.onload=function(t){if(200===u.status){var r=u.response;e.context.decodeAudioData(r,(function(r){e.rirs[n]=r;for(var i=0,o=e.rirs;i<o.length;i++){if(void 0===o[i])return}s&&s(t)}),(function(t){o&&o(t,"decode")}))}},u.open("GET",r,!0),u.responseType="arraybuffer",u.send(null)},e}(r(1643).Effector);e.Reverb=s},7223:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Ringmodulator=void 0;var s=function(t){function e(e){var r=t.call(this,e,0)||this;return r.amplitude=e.createGain(),r.amplitude.gain.value=0,r.depth.gain.value=1,r.rate.value=0,r.deactivate(),r.lfo.connect(r.depth),r.depth.connect(r.amplitude.gain),r}return i(e,t),e.prototype.stop=function(e,r){t.prototype.stop.call(this,e,r),this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.amplitude.gain))},e.prototype.connect=function(){return this.input.disconnect(0),this.amplitude.disconnect(0),this.isActive?(this.input.connect(this.amplitude),this.amplitude.connect(this.output)):this.input.connect(this.output),this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"depth":return this.depth.gain.value;case"rate":return this.rate.value;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"depth":"number"==typeof s&&(this.depth.gain.value=s);break;case"rate":"number"==typeof s&&(this.rate.value=s)}}return this},e.prototype.params=function(){return{state:this.isActive,depth:this.depth.gain.value,rate:this.rate.value}},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e}(r(1643).Effector);e.Ringmodulator=s},8976:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Stereo=void 0;var s=function(t){function e(r,n){var i=t.call(this,r,n)||this;return i.splitter=r.createChannelSplitter(2),i.merger=r.createScriptProcessor(n,2,2),i.delayL=r.createDelay(e.MAX_DELAY_TIME),i.delayR=r.createDelay(e.MAX_DELAY_TIME),i.delayL.delayTime.value=0,i.delayR.delayTime.value=0,i.deactivate(),i}return i(e,t),e.prototype.start=function(){var t=this;if(this.isActive&&this.paused){this.paused=!1;var e=this.processor.bufferSize;this.processor.onaudioprocess=function(r){var n=r.inputBuffer.getChannelData(0),i=r.inputBuffer.getChannelData(1),s=r.outputBuffer.getChannelData(0),o=r.outputBuffer.getChannelData(1);if(t.isActive&&0!==t.delayL.delayTime.value&&0!==t.delayR.delayTime.value)for(var a=0;a<e;a++)s[a]=n[a],o[a]=-i[a];else s.set(n),o.set(i)}}},e.prototype.stop=function(){this.isActive&&(this.paused=!0,this.processor.disconnect(0),this.processor.onaudioprocess=null,this.connect())},e.prototype.connect=function(){return this.input.disconnect(0),this.splitter.disconnect(0),this.delayL.disconnect(0),this.delayR.disconnect(0),this.merger.disconnect(0),this.isActive?(this.input.connect(this.splitter),this.splitter.connect(this.delayL,0,0),this.splitter.connect(this.delayR,1,0),this.delayL.connect(this.merger),this.delayR.connect(this.merger),this.merger.connect(this.output)):this.input.connect(this.output),this.output},e.prototype.param=function(t){if("string"==typeof t)return"time"===t?this.delayL.delayTime.value:this;for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];if("time"===i)"number"==typeof s&&(this.delayL.delayTime.value=s,this.delayR.delayTime.value=s)}return this},e.prototype.params=function(){return{state:this.isActive,time:this.delayL.delayTime.value}},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e.MAX_DELAY_TIME=1,e}(r(1643).Effector);e.Stereo=s},4979:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Tremolo=void 0;var s=function(t){function e(e){var r=t.call(this,e,0)||this;return r.amplitude=e.createGain(),r.amplitude.gain.value=1,r.lfo.type="sine",r.depth.gain.value=0,r.rate.value=0,r.deactivate(),r.lfo.connect(r.depth),r.depth.connect(r.amplitude.gain),r}return i(e,t),e.prototype.stop=function(e,r){t.prototype.stop.call(this,e,r),this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.amplitude.gain))},e.prototype.connect=function(){return this.input.disconnect(0),this.amplitude.disconnect(0),this.isActive?(this.input.connect(this.amplitude),this.amplitude.connect(this.output)):this.input.connect(this.output),this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"type":return this.lfo.type;case"depth":return this.depth.gain.value;case"rate":return this.rate.value;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"type":"string"==typeof s&&(this.lfo.type=s);break;case"depth":"number"==typeof s&&(this.depth.gain.value=s);break;case"rate":"number"==typeof s&&(this.rate.value=s)}}return this},e.prototype.params=function(){return{state:this.isActive,type:this.lfo.type,depth:this.depth.gain.value,rate:this.rate.value}},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e}(r(1643).Effector);e.Tremolo=s},3449:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VocalCanceler=void 0;var r=function(){function t(){this.depth=0}return t.prototype.start=function(t,e){return t-this.depth*e},t.prototype.param=function(t){if("string"==typeof t)return"depth"===t?this.depth:this;for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];if("depth"===i)"number"==typeof s&&(this.depth=s)}return this},t.prototype.params=function(){return{depth:this.depth}},t}();e.VocalCanceler=r},6813:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Wah=void 0;var s=function(t){function e(e){var r=t.call(this,e,0)||this;return r.auto=!1,r.depthRate=0,r.lowpass=e.createBiquadFilter(),r.envelopeFollower=e.createWaveShaper(),r.sensitivity=e.createBiquadFilter(),r.lowpass.type="lowpass",r.lowpass.frequency.value=r.auto?20:350,r.lowpass.Q.value=1,r.lowpass.gain.value=0,r.envelopeFollower.curve=new Float32Array([1,0,1]),r.sensitivity.type="lowpass",r.sensitivity.frequency.value=350,r.sensitivity.Q.value=1,r.sensitivity.gain.value=0,r.depth.gain.value=0,r.rate.value=0,r.deactivate(),r.connect(),r}return i(e,t),e.prototype.stop=function(e,r){t.prototype.stop.call(this,e,r),!this.auto&&this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.lowpass.frequency))},e.prototype.connect=function(){return this.input.disconnect(0),this.sensitivity.disconnect(0),this.envelopeFollower.disconnect(0),this.lowpass.disconnect(0),this.depth.disconnect(0),this.isActive?this.auto?(this.input.connect(this.sensitivity),this.sensitivity.connect(this.output),this.input.connect(this.envelopeFollower),this.envelopeFollower.connect(this.lowpass),this.lowpass.connect(this.depth),this.depth.connect(this.sensitivity.frequency)):(this.input.connect(this.lowpass),this.lowpass.connect(this.output),this.lfo.connect(this.depth),this.depth.connect(this.lowpass.frequency)):this.input.connect(this.output),this.output},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"auto":return this.auto;case"cutoff":return this.auto?this.sensitivity.frequency.value:this.lowpass.frequency.value;case"depth":return this.depthRate;case"rate":return this.rate.value;case"resonance":return this.auto?this.sensitivity.Q.value:this.lowpass.Q.value;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"auto":"boolean"==typeof s&&(this.auto=s,this.connect());break;case"cutoff":"number"==typeof s&&(this.auto?(this.sensitivity.frequency.value=s,this.lowpass.frequency.value=20):this.lowpass.frequency.value=s);break;case"depth":"number"==typeof s&&(this.depthRate=s,this.depth.gain.value=this.auto?1e4*s:this.lowpass.frequency.value*s);break;case"rate":"number"==typeof s&&(this.rate.value=s);break;case"resonance":"number"==typeof s&&(this.auto?(this.sensitivity.Q.value=s,this.lowpass.Q.value=1):this.lowpass.Q.value=s)}}return this},e.prototype.params=function(){return{state:this.isActive,auto:this.auto,cutoff:this.auto?this.sensitivity.frequency.value:this.lowpass.frequency.value,depth:this.auto?this.depth.gain.value:this.depthRate,rate:this.rate.value,resonance:this.auto?this.sensitivity.Q.value:this.lowpass.Q.value}},e.prototype.activate=function(){return t.prototype.activate.call(this),this},e.prototype.deactivate=function(){return t.prototype.deactivate.call(this),this},e}(r(1643).Effector);e.Wah=s},422:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Channel=void 0;var r=function(){function t(t){this.tracks=[],this.channelGain=1,this.id=t}return t.prototype.append=function(t){return this.tracks.push(t),this},t.prototype.get=function(t){return"number"==typeof t&&t>=0&&t<this.tracks.length?this.tracks[t]:this.tracks},t.prototype.gain=function(t){if(!("number"==typeof t&&t>=0&&t<=1))return this.channelGain;this.channelGain=t},t.prototype.length=function(){return this.tracks.length},t.prototype.toString=function(){return this.id},t}();e.Channel=r},81:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Track=void 0;var r=function(){function t(t){this.dataBlocks=[],this.id=t}return t.prototype.get=function(){return this.dataBlocks},t.prototype.append=function(t){return this.dataBlocks.push(t),this},t.prototype.clear=function(){this.dataBlocks.length=0},t.prototype.has=function(){return this.dataBlocks.length>0},t.prototype.toString=function(){return this.id},t}();e.Track=r},7806:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Recorder=void 0;var n=r(81),i=r(422),s=function(){function t(t,e,r,n){this.channels=[],this.activeTrack=-1,this.paused=!0,this.processor=t.createScriptProcessor(e,r,n),this.sampleRate=t.sampleRate}return t.prototype.setup=function(t,e){this.channels.push(new i.Channel("0")),this.channels.push(new i.Channel("1"));for(var r=0,s=this.channels;r<s.length;r++)for(var o=s[r],a=0;a<e;a++)o.append(new n.Track(a.toString(10)));return this},t.prototype.ready=function(t){return this.hasTrack(t)?this.activeTrack=t:this.activeTrack=-1,this},t.prototype.start=function(){var t=this;if(-1===this.activeTrack||!this.paused)return this;this.paused=!1;var e=this.channels[0].gain(),r=this.channels[1].gain(),n=this.channels[0].get(this.activeTrack),i=this.channels[1].get(this.activeTrack),s=this.processor.bufferSize;return this.processor.onaudioprocess=function(o){if(-1!==t.activeTrack){for(var a=o.inputBuffer.getChannelData(0),u=o.inputBuffer.getChannelData(1),c=new Float32Array(s),l=new Float32Array(s),h=0;h<s;h++)c[h]=e*a[h],l[h]=r*u[h];null==n||n.append(c),null==i||i.append(l)}else t.processor.disconnect(0),t.processor.onaudioprocess=null},this},t.prototype.stop=function(){return this.activeTrack=-1,this.paused=!0,this.processor.disconnect(0),this.processor.onaudioprocess=null,this},t.prototype.param=function(t){if("string"==typeof t)switch(t){case"0":if(this.channels[0])return this.channels[0].gain();break;case"1":if(this.channels[1])return this.channels[1].gain();break;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"0":this.channels[0]&&"number"==typeof s&&this.channels[0].gain(s);break;case"1":this.channels[1]&&"number"==typeof s&&this.channels[1].gain(s)}}return this},t.prototype.get=function(){return this.activeTrack},t.prototype.clear=function(t){if(-1!==this.activeTrack&&this.stop(),-1===t)for(var e=0,r=this.channels;e<r.length;e++)for(var n=0,i=r[e].get();n<i.length;n++){(a=i[n]).clear()}else if(this.hasTrack(t))for(var s=0,o=this.channels;s<o.length;s++){var a;null==(a=o[s].get(t))||a.clear()}return this},t.prototype.create=function(t,e,r,n){-1!==this.activeTrack&&this.stop();var i=null,s=null;if(-1===t&&this.has(-1,-1))i=this.mixTrack(0),s=this.mixTrack(1);else{if(!this.has(0,t)||!this.has(1,t))return"";i=this.flatTrack(0,t),s=this.flatTrack(1,t)}if(null===i||null===s)return"";var o=this.sampleRate,a=r,u=e,c=1===u?Math.min(i.length,s.length):2*Math.min(i.length,s.length),l=36+c*(a/8),h=8+(28+(8+c*(a/8))),p=o*u*(a/8),f=c*(a/8),d=null;switch(a){case 8:d=new Uint8Array(c);for(var v=0;v<c;v++){var y=0;(y=v%u==0?Math.round((i[Math.trunc(v/u)]+1)/2*(Math.pow(2,8)-1)):Math.round((s[Math.trunc(v/u)]+1)/2*(Math.pow(2,8)-1)))>Math.pow(2,8)-1&&(y=Math.pow(2,8)-1),y<Math.pow(2,0)-1&&(y=Math.pow(2,0)-1),d[v]=y}break;case 16:d=new Int16Array(c);for(v=0;v<c;v++){y=0;(y=v%u==0?Math.round(i[Math.trunc(v/u)]*Math.pow(2,15)):Math.round(s[Math.trunc(v/u)]*Math.pow(2,15)))>+Math.pow(2,15)-1&&(y=+Math.pow(2,15)-1),y<-Math.pow(2,15)-0&&(y=-Math.pow(2,15)-0),d[v]=y}}if(null===d)return"";var m=new Uint8Array(44+f);m[0]=82,m[1]=73,m[2]=70,m[3]=70,m[4]=l>>0&255,m[5]=l>>8&255,m[6]=l>>16&255,m[7]=l>>24&255,m[8]=87,m[9]=65,m[10]=86,m[11]=69,m[12]=102,m[13]=109,m[14]=116,m[15]=32,m[16]=16,m[17]=0,m[18]=0,m[19]=0,m[20]=1,m[21]=0,m[22]=u,m[23]=0,m[24]=o>>0&255,m[25]=o>>8&255,m[26]=o>>16&255,m[27]=o>>24&255,m[28]=p>>0&255,m[29]=p>>8&255,m[30]=p>>16&255,m[31]=p>>24&255,m[32]=u*(a/8),m[33]=0,m[34]=a,m[35]=0,m[36]=100,m[37]=97,m[38]=116,m[39]=97,m[40]=f>>0&255,m[41]=f>>8&255,m[42]=f>>16&255,m[43]=f>>24&255;for(v=0;v<c;v++)switch(a){case 8:m[h-f+v]=d[v];break;case 16:m[h-f+2*v+0]=d[v]>>0&255,m[h-f+2*v+1]=d[v]>>8&255}switch(n){case"base64":case"dataURL":var b=window.btoa(Array.from(m).map((function(t){return String.fromCodePoint(t)})).join(""));return"base64"===n?b:"data:audio/wav;base64,".concat(b);case"blob":case"objectURL":var g=new Blob([m],{type:"audio/wav"});return"blob"===n?g:window.URL.createObjectURL(g);default:return""}},t.prototype.has=function(t,e){var r;if(!this.hasChannel(t))return this.channels.some((function(t){return t.get().some((function(t){return t.has()}))}));var n=this.channels[t].get();if(!this.hasTrack(e))return n.some((function(t){return t.has()}));var i=this.channels[t].get(e);return null!==(r=null==i?void 0:i.has())&&void 0!==r&&r},t.prototype.hasChannel=function(t){return t>=0&&t<this.channels.length},t.prototype.hasTrack=function(t){return t>=0&&this.channels.every((function(e){return t<e.length()}))},Object.defineProperty(t.prototype,"INPUT",{get:function(){return this.processor},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"OUTPUT",{get:function(){return this.processor},enumerable:!1,configurable:!0}),t.prototype.flatTrack=function(t,e){if(!this.hasChannel(t)||!this.hasTrack(e))return null;var r=this.channels[t].get(e);if(null===r)return null;for(var n=r.get(),i=this.processor.bufferSize,s=new Float32Array(n.length*i),o=0,a=n.length;o<a;o++)for(var u=n[o],c=0;c<i;c++)s[o*i+c]=u[c];return s},t.prototype.mixTrack=function(t){if(!this.hasChannel(t))return null;for(var e=this.channels[t].get(),r=this.processor.bufferSize,n=0,i=0,s=0,o=0,a=0,u=0,c=e;u<c.length;u++){a<(f=c[u].get()).length&&(a=f.length)}for(var l=new Float32Array(a*r);;){for(var h=0,p=e.length;h<p;h++){var f,d=(f=e[h].get())[s];d&&o>=0&&o<=d.length&&(n+=d[o],i++)}if(i<=0)return l;l[s*r+o]=n/i,n=0,i=0,o<r-1?o++:(s++,o=0)}},t}();e.Recorder=s},7836:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Room=void 0;var r=function(){function t(e,r,n,i,s,o){this.websocket=null,this.id=e,this.context=r,this.analyser=o,this.sender=r.createScriptProcessor(t.BUFFER_SIZE,i,s),this.receiver=r.createScriptProcessor(t.BUFFER_SIZE,i,s)}return t.prototype.join=function(t){var e=this,r=t.tls,n=t.host,i=t.port,s=t.path,o=t.openCallback,a=t.closeCallback,u=t.errorCallback,c=r?"wss://":"ws://";this.websocket=new WebSocket("".concat(c).concat(n,":").concat(i).concat(s)),this.websocket.binaryType="arraybuffer",this.websocket.onopen=function(t){null!==e.websocket&&(e.websocket.send(e.id),o&&o(t))},this.websocket.onclose=function(t){a&&a(t)},this.websocket.onerror=function(t){u&&u(t)},this.websocket.onmessage=function(t){if(null!==e.websocket&&t.data instanceof ArrayBuffer){var r=t.data.byteLength/Float32Array.BYTES_PER_ELEMENT,n=Math.trunc(r/2),i=n*Float32Array.BYTES_PER_ELEMENT,s=new Float32Array(t.data,0,n),o=new Float32Array(t.data,i,n);e.connect(),e.analyser.start("time"),e.analyser.start("fft"),e.receiver.onaudioprocess=function(t){var r=t.outputBuffer.getChannelData(0),n=t.outputBuffer.getChannelData(1);r.set(s),n.set(o),e.connected()||(e.analyser.stop("time"),e.analyser.stop("fft"))}}}},t.prototype.send=function(){var t=this;if(null!==this.websocket){var e=this.sender.bufferSize;this.sender.onaudioprocess=function(r){if(t.connected()){for(var n=r.inputBuffer.getChannelData(0),i=r.inputBuffer.getChannelData(1),s=new Float32Array(2*e),o=Math.trunc(s.length/2),a=0;a<e;a++)s[a]=n[a],s[o+a]=i[a];null!==t.websocket&&0===t.websocket.bufferedAmount&&(t.websocket.send(t.id),t.websocket.send(s))}}}},t.prototype.leave=function(){this.connected()&&(this.sender.disconnect(0),this.receiver.disconnect(0))},t.prototype.clear=function(){null!==this.websocket&&(this.websocket.send(this.id),this.websocket.close(),this.websocket=null)},t.prototype.connect=function(){this.receiver.connect(this.analyser.INPUT),this.receiver.connect(this.context.destination)},t.prototype.connected=function(){return null!==this.websocket&&this.websocket.readyState===WebSocket.OPEN},t.prototype.get=function(){var t;return(t={})[this.id]=this.websocket,t},Object.defineProperty(t.prototype,"INPUT",{get:function(){return this.sender},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"OUTPUT",{get:function(){return this.sender},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this.id},t.BUFFER_SIZE=2048,t}();e.Room=r},173:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Session=void 0;var n=r(7836),i=function(){function t(t){this.rooms=[],this.context=t,this.input=t.createGain(),this.output=t.createGain()}return t.prototype.setup=function(t,e,r,i,s){return this.rooms.push(new n.Room(t,this.context,e,r,i,s)),this},t.prototype.ready=function(t,e){var r=this.get(t);return null===r||r.join(e),this},t.prototype.start=function(t){var e=this.get(t);return null===e||(this.connect(t),e.send()),this},t.prototype.stop=function(t){var e=this.get(t);return null===e||e.leave(),this},t.prototype.clear=function(t){var e=this.get(t);return null===e||e.clear(),this},t.prototype.connect=function(t){var e=this.get(t);return null===e||(this.input.connect(e.INPUT),e.OUTPUT.connect(this.output)),this},t.prototype.connected=function(t){var e=this.get(t);return null!==e&&e.connected()},t.prototype.get=function(t){return this.rooms.find((function(e){return e.toString()===t}))||null},Object.defineProperty(t.prototype,"INPUT",{get:function(){return this.input},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"OUTPUT",{get:function(){return this.output},enumerable:!1,configurable:!0}),t}();e.Session=i},2188:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SoundModule=void 0;var n=r(8397),i=r(7806),s=r(173),o=r(8044),a=r(8649),u=r(346),c=r(4535),l=r(1605),h=r(8137),p=r(111),f=r(7369),d=r(6548),v=r(4226),y=r(3751),m=r(2393),b=r(4833),g=r(1063),w=r(7223),T=r(8976),k=r(4979),_=r(6813),A=function(){function t(e,r){this.modules=[],this.runningAnalyser=!1,this.mixed=!1,this.context=e,this.mastervolume=e.createGain(),this.processor=e.createScriptProcessor(r,t.NUMBER_OF_INPUTS,t.NUMBER_OF_OUTPUTS),this.analyser=new n.Analyser(e),this.recorder=new i.Recorder(e,r,2,2),this.session=new s.Session(e),this.stereo=new T.Stereo(e,r),this.compressor=new u.Compressor(e),this.distortion=new l.Distortion(e),this.wah=new _.Wah(e),this.pitchshifter=new b.PitchShifter(e,r),this.equalizer=new p.Equalizer(e),this.filter=new f.Filter(e),this.autopanner=new o.Autopanner(e),this.tremolo=new k.Tremolo(e),this.ringmodulator=new w.Ringmodulator(e),this.phaser=new m.Phaser(e),this.flanger=new d.Flanger(e),this.chorus=new a.Chorus(e),this.delay=new c.Delay(e),this.reverb=new g.Reverb(e),this.panner=new y.Panner(e),this.listener=new v.Listener(e),this.envelopegenerator=new h.EnvelopeGenerator(e),this.modules=[this.stereo,this.compressor,this.distortion,this.wah,this.pitchshifter,this.equalizer,this.filter,this.autopanner,this.tremolo,this.ringmodulator,this.phaser,this.flanger,this.chorus,this.delay,this.reverb,this.panner]}return t.prototype.connect=function(t){var e=this.modules[0].INPUT;if(null!==e){t.disconnect(0),this.modules.length>0?t.connect(e):t.connect(this.mastervolume);for(var r=0,n=this.modules.length;r<n;r++){var i=this.modules[r].OUTPUT;if(null!==i)if(i.disconnect(0),r<this.modules.length-1){var s=this.modules[r+1].INPUT;if(null===s)continue;i.connect(s)}else i.connect(this.mastervolume)}this.mastervolume.connect(this.context.destination),this.mastervolume.connect(this.analyser.INPUT),this.mastervolume.connect(this.recorder.INPUT),this.recorder.OUTPUT.connect(this.context.destination),this.mastervolume.connect(this.session.INPUT),this.session.OUTPUT.connect(this.context.destination)}},t.prototype.resize=function(t){return this.init(this.context,t),this},t.prototype.getBufferSize=function(){return this.processor.bufferSize},t.prototype.install=function(t,e){return this.modules.every((function(t){return t!==e}))&&this.modules.push(e),e},t.prototype.on=function(t){var e=null!=t?t:this.context.currentTime;return this.stereo.start(),this.chorus.start(e),this.flanger.start(e),this.phaser.start(e),this.autopanner.start(e),this.tremolo.start(e),this.ringmodulator.start(e),this.wah.start(e),this.filter.start(e),this},t.prototype.off=function(t){var e=null!=t?t:this.context.currentTime;return this.stereo.stop(),this.chorus.stop(e),this.flanger.stop(e),this.phaser.stop(e),this.autopanner.stop(e),this.tremolo.stop(e),this.ringmodulator.stop(e),this.wah.stop(e),this.filter.stop(e),this},t.prototype.suspend=function(){return this.analyser.stop("time"),this.analyser.stop("fft"),this.runningAnalyser=!1,this.recorder.stop(),this.processor.disconnect(0),this},t.prototype.mix=function(){return this.mixed=!0,this},t.prototype.demix=function(){return this.mixed=!1,this},t.prototype.params=function(){return{mastervolume:this.mastervolume.gain.value,stereo:this.stereo.params(),compressor:this.compressor.params(),distortion:this.distortion.params(),wah:this.wah.params(),pitchshifter:this.pitchshifter.params(),equalizer:this.equalizer.params(),filter:this.filter.params(),autopanner:this.autopanner.params(),tremolo:this.tremolo.params(),ringmodulator:this.ringmodulator.params(),phaser:this.phaser.params(),flanger:this.flanger.params(),chorus:this.chorus.params(),delay:this.delay.params(),reverb:this.reverb.params(),panner:this.panner.params(),listener:this.listener.params(),envelopegenerator:this.envelopegenerator.params()}},t.prototype.toJSON=function(){return JSON.stringify(this.params())},t.prototype.init=function(e,r){if(this.modules.length>0){this.mastervolume.disconnect(0),this.processor.disconnect(0),this.analyser.INPUT.disconnect(0),this.recorder.INPUT.disconnect(0),this.session.INPUT.disconnect(0);for(var A=0,x=this.modules;A<x.length;A++){var O=x[A];O.INPUT&&O.INPUT.disconnect(0),O.OUTPUT&&O.OUTPUT.disconnect(0)}this.modules.length=0}this.processor=e.createScriptProcessor(r,t.NUMBER_OF_INPUTS,t.NUMBER_OF_OUTPUTS),this.analyser=new n.Analyser(e),this.recorder=new i.Recorder(e,r,2,2),this.session=new s.Session(e),this.stereo=new T.Stereo(e,r),this.compressor=new u.Compressor(e),this.distortion=new l.Distortion(e),this.wah=new _.Wah(e),this.pitchshifter=new b.PitchShifter(e,r),this.equalizer=new p.Equalizer(e),this.filter=new f.Filter(e),this.autopanner=new o.Autopanner(e),this.tremolo=new k.Tremolo(e),this.ringmodulator=new w.Ringmodulator(e),this.phaser=new m.Phaser(e),this.flanger=new d.Flanger(e),this.chorus=new a.Chorus(e),this.delay=new c.Delay(e),this.reverb=new g.Reverb(e),this.panner=new y.Panner(e),this.listener=new v.Listener(e),this.envelopegenerator=new h.EnvelopeGenerator(e),this.modules=[this.stereo,this.compressor,this.distortion,this.wah,this.pitchshifter,this.equalizer,this.filter,this.autopanner,this.tremolo,this.ringmodulator,this.phaser,this.flanger,this.chorus,this.delay,this.reverb,this.panner]},t.NUMBER_OF_INPUTS=2,t.NUMBER_OF_OUTPUTS=2,t}();e.SoundModule=A},553:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NoiseGate=void 0;var r=function(){function t(){this.level=0}return t.prototype.start=function(t){return Math.abs(t)>this.level?t:0},t.prototype.param=function(t){if("string"==typeof t)return"level"===t?this.level:void 0;for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];if("level"===i)"number"==typeof s&&(this.level=s)}},t.prototype.params=function(){return{level:this.level}},t}();e.NoiseGate=r},5413:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NoiseSuppressor=void 0;var n=r(999),i=function(){function t(){this.threshold=0}return t.prototype.start=function(t,e,r){if(0!==this.threshold){var i=new Float32Array(t),s=new Float32Array(r),o=new Float32Array(r),a=new Float32Array(r),u=new Float32Array(r),c=new Float32Array(r);(0,n.fft)(i,s,r);for(var l=0;l<r;l++)u[l]=Math.sqrt(Math.pow(i[l],2)+Math.pow(s[l],2)),0!==i[l]&&0!==s[l]&&(c[l]=Math.atan2(s[l],i[l]));for(l=0;l<r;l++)u[l]-=this.threshold,u[l]<0&&(u[l]=0);for(l=0;l<r;l++)o[l]=u[l]*Math.cos(c[l]),a[l]=u[l]*Math.sin(c[l]);(0,n.ifft)(o,a,r),e.set(o)}else e.set(t)},t.prototype.param=function(t){if("string"==typeof t)return"threshold"===t?this.threshold:void 0;for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];if("threshold"===i)"number"==typeof s&&s>=0&&(this.threshold=s)}},t.prototype.params=function(){return{threshold:this.threshold}},t}();e.NoiseSuppressor=i},3594:function(t,e,r){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=this&&this.__assign||function(){return s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},s.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.StreamModule=void 0;var o=r(2188),a=r(553),u=r(5413),c=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.sources=[],n.stream=null,n.constraints={audio:!0,video:!1},n.output=!0,n.track=!1,n.paused=!0,n.noisegate=new a.NoiseGate,n.noisesuppressor=new u.NoiseSuppressor,n}return i(e,t),e.prototype.setup=function(t){return t&&(this.constraints=s(s({},this.constraints),t)),this},e.prototype.ready=function(t){var e=this;return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&window.MediaStream?(this.paused=!1,(null==t?void 0:t.stream)?(this.stream=t.stream,Promise.resolve(this.stream)):navigator.mediaDevices.getUserMedia(this.constraints).then((function(r){return e.paused||(e.stream=r,(null==t?void 0:t.successCallback)&&t.successCallback(r)),r})).catch((function(e){return(null==t?void 0:t.errorCallback)&&t.errorCallback(e),e}))):Promise.reject()},e.prototype.start=function(){var t=this;if(null===this.stream)return this;var e=this.processor.bufferSize;if(this.track)for(var r=this.stream.getAudioTracks(),n=0,i=r.length;n<i;n++)this.sources[n]=this.context.createMediaStreamTrackSource(r[n]),this.sources[n].connect(this.processor),this.connect(this.processor);else this.sources[0]=this.context.createMediaStreamSource(this.stream),this.sources[0].connect(this.processor),this.connect(this.processor);return this.output||(this.mastervolume.disconnect(0),this.mastervolume.connect(this.analyser.INPUT),this.mastervolume.connect(this.recorder.INPUT),this.recorder.OUTPUT.connect(this.context.destination),this.mastervolume.connect(this.session.INPUT),this.session.OUTPUT.connect(this.context.destination)),this.on(this.context.currentTime),this.runningAnalyser||(this.analyser.start("time"),this.analyser.start("fft"),this.runningAnalyser=!0),this.processor.onaudioprocess=function(r){var n=r.inputBuffer.getChannelData(0),i=r.inputBuffer.getChannelData(1),s=r.outputBuffer.getChannelData(0),o=r.outputBuffer.getChannelData(1),a=t.noisesuppressor.param("threshold"),u=t.noisegate.param("level");if("number"==typeof a&&a>0)t.noisesuppressor.start(n,s,e),t.noisesuppressor.start(i,o,e);else if("number"==typeof u&&u>0)for(var c=0;c<e;c++)s[c]=t.noisegate.start(n[c]),o[c]=t.noisegate.start(i[c]);else s.set(n),o.set(i)},this},e.prototype.stop=function(){return this.sources.length=0,this.off(this.context.currentTime),this.analyser.stop("time"),this.analyser.stop("fft"),this.mixed||(this.processor.disconnect(0),this.processor.onaudioprocess=null),this.paused=!0,this},e.prototype.param=function(t){if("string"==typeof t)switch(t){case"mastervolume":return this.mastervolume.gain.value;case"output":return this.output;case"track":return this.track;default:return this}for(var e=0,r=Object.entries(t);e<r.length;e++){var n=r[e],i=n[0],s=n[1];switch(i){case"mastervolume":"number"==typeof s&&(this.mastervolume.gain.value=s);break;case"output":"boolean"==typeof s&&(this.output=s);break;case"track":"boolean"==typeof s&&(this.track=s)}}return this},e.prototype.get=function(t){return"number"==typeof t&&t>=0&&t<this.sources.length?this.sources[t]:this.sources},e.prototype.getStream=function(){return this.stream},e.prototype.clear=function(){return this.stop(),this.clearAudioDevices(),this.clearVideoDevices(),this.stream=null,this},e.prototype.clearAudioDevices=function(){if(null===this.stream)return this;this.stop();for(var t=0,e=this.stream.getAudioTracks();t<e.length;t++){e[t].stop()}return this},e.prototype.clearVideoDevices=function(){if(null===this.stream)return this;this.stop();for(var t=0,e=this.stream.getVideoTracks();t<e.length;t++){e[t].stop()}return this.stream=null,this},e.prototype.devices=function(){return navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices():Promise.reject()},e.prototype.streaming=function(){return!this.paused},e.prototype.module=function(t){switch(t){case"analyser":return this.analyser;case"recorder":return this.recorder;case"session":return this.session;case"autopanner":return this.autopanner;case"chorus":return this.chorus;case"compressor":return this.compressor;case"delay":return this.delay;case"distortion":return this.distortion;case"equalizer":return this.equalizer;case"filter":return this.filter;case"flanger":return this.flanger;case"listener":return this.listener;case"panner":return this.panner;case"phaser":return this.phaser;case"pitchshifter":return this.pitchshifter;case"reverb":return this.reverb;case"ringmodulator":return this.ringmodulator;case"stereo":return this.stereo;case"tremolo":return this.tremolo;case"wah":return this.wah;case"envelopegenerator":return this.envelopegenerator;case"noisegate":return this.noisegate;case"noisesuppressor":return this.noisesuppressor;default:return null}},e.prototype.resize=function(e){return t.prototype.init.call(this,this.context,e),this},e.prototype.on=function(e){return t.prototype.on.call(this,e),this},e.prototype.off=function(e){return t.prototype.off.call(this,e),this},e.prototype.suspend=function(){return t.prototype.suspend.call(this),this},e.prototype.mix=function(){return t.prototype.mix.call(this),this},e.prototype.demix=function(){return t.prototype.demix.call(this),this},e.prototype.params=function(){var e=t.prototype.params.call(this);return s(s({},e),{output:this.output,track:this.track,noisegate:this.noisegate.params(),noisesuppressor:this.noisesuppressor.params()})},Object.defineProperty(e.prototype,"INPUT",{get:function(){return this.processor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"OUTPUT",{get:function(){return this.mastervolume},enumerable:!1,configurable:!0}),e}(o.SoundModule);e.StreamModule=c},999:(t,e)=>{function r(t){return t>=0?e.MIN_A*Math.pow(e.FREQUENCY_RATIO,t):0}function n(t){var e=t.file,r=t.type,n=t.successCallback,i=t.errorCallback,s=t.progressCallback,o=new FileReader;switch(o.onprogress=function(t){s&&s(t)},o.onerror=function(t){var e,r,n,s,a;if(i){var u;switch(null===(e=o.error)||void 0===e?void 0:e.code){case null===(r=o.error)||void 0===r?void 0:r.NOT_FOUND_ERR:u="NOT_FOUND_ERR";break;case null===(n=o.error)||void 0===n?void 0:n.SECURITY_ERR:u="SECURITY_ERR";break;case null===(s=o.error)||void 0===s?void 0:s.ABORT_ERR:u="ABORT_ERR";break;case null===(a=o.error)||void 0===a?void 0:a.NOT_SUPPORTED_ERR:u="NOT_READABLE_ERR";break;default:u="ERR"}i(t,u)}},o.onload=function(t){if(n){var e=o.result;"string"!=typeof e||e.startsWith("data:")||e.startsWith("blob:")||(e=e.replace(/<(\/?script.*?)>/gi,"&lt;$1&gt;")),"string"==typeof e&&"json"===r&&(e=JSON.parse(e)),n(t,e)}},r){case"arraybuffer":o.readAsArrayBuffer(e);break;case"dataURL":o.readAsDataURL(e);break;case"text":case"json":o.readAsText(e,"UTF-8")}}Object.defineProperty(e,"__esModule",{value:!0}),e.toTextFile=e.toFrequencies=e.file=e.drop=e.read=e.exitFullscreen=e.requestFullscreen=e.decode=e.convertTime=e.ajax=e.ifft=e.fft=e.computeFrequency=e.computeIndex=e.isPitchChar=e.DOT=e.HALF_DOWN=e.HALF_UP=e.SHARP=e.QUARTER_NOTE=e.MIN_A=e.FREQUENCY_RATIO=e.EQUAL_TEMPERAMENT=void 0,e.EQUAL_TEMPERAMENT=12,e.FREQUENCY_RATIO=1.0594630943592953,e.MIN_A=27.5,e.QUARTER_NOTE=4,e.SHARP="#",e.HALF_UP="+",e.HALF_DOWN="-",e.DOT=".",e.isPitchChar=function(t){switch(t.toUpperCase()){case"C":case"D":case"E":case"F":case"G":case"A":case"B":case"R":return!0;default:return!1}},e.computeIndex=function(t,r){var n=0;switch(r){case"C":n=3;break;case"D":n=5;break;case"E":n=7;break;case"F":n=8;break;case"G":n=10;break;case"A":n=12;break;case"B":n=14;break;case"R":return-1}var i=e.EQUAL_TEMPERAMENT*(t-1)+n;return i>=0?i:-1},e.computeFrequency=r,e.fft=function(t,e,r){for(var n=function(t){return Math.pow(2,t)},i=new Float32Array(r),s=Math.log2(r),o=1;o<=s;o++)for(var a=0;a<n(o-1);a++)for(var u=s-o,c=0;c<n(u);c++){var l=a*n(u+1)+c,h=n(u)+l,p=c*n(o-1),f=t[l],d=e[l],v=t[h],y=e[h],m=Math.cos(2*Math.PI*p/r),b=-1*Math.sin(2*Math.PI*p/r);o<s?(t[l]=f+v,e[l]=d+y,t[h]=m*(f-v)-b*(d-y),e[h]=m*(d-y)+b*(f-v)):(t[l]=f+v,e[l]=d+y,t[h]=f-v,e[h]=d-y)}for(o=1;o<=s;o++)for(u=s-o,a=0;a<n(o-1);a++)i[n(o-1)+a]=i[a]+n(u);for(var g=0;g<r;g++)if(!(i[g]<=g)){var w=t[i[g]],T=e[i[g]];t[i[g]]=t[g],e[i[g]]=e[g],t[g]=w,e[g]=T}},e.ifft=function(t,e,r){for(var n=function(t){return Math.pow(2,t)},i=new Float32Array(r),s=Math.log2(r),o=1;o<=s;o++)for(var a=0;a<n(o-1);a++)for(var u=s-o,c=0;c<n(u);c++){var l=a*n(u+1)+c,h=n(u)+l,p=c*n(o-1),f=t[l],d=e[l],v=t[h],y=e[h],m=Math.cos(2*Math.PI*p/r),b=Math.sin(2*Math.PI*p/r);o<s?(t[l]=f+v,e[l]=d+y,t[h]=m*(f-v)-b*(d-y),e[h]=m*(d-y)+b*(f-v)):(t[l]=f+v,e[l]=d+y,t[h]=f-v,e[h]=d-y)}for(o=1;o<=s;o++)for(u=s-o,a=0;a<n(o-1);a++)i[n(o-1)+a]=i[a]+n(u);for(var g=0;g<r;g++)if(!(i[g]<=g)){var w=t[i[g]],T=e[i[g]];t[i[g]]=t[g],e[i[g]]=e[g],t[g]=w,e[g]=T}for(g=0;g<r;g++)t[g]/=r,e[g]/=r},e.ajax=function(t){var e=t.url,r=t.type,n=t.timeout,i=t.successCallback,s=t.errorCallback,o=t.progressCallback,a=new XMLHttpRequest;a.timeout=null!=n?n:6e4,a.ontimeout=function(t){s&&s(t,"timeout")},a.onprogress=function(t){o&&o(t)},a.onerror=function(t){s&&s(t,"error")},a.onload=function(t){i&&200===a.status&&i(t,a.response)},a.open("GET",e,!0),a.responseType=null!=r?r:"arraybuffer",a.send(null)},e.convertTime=function(t){return t<0?{minutes:-1,seconds:-1,milliseconds:-1}:{minutes:Math.trunc(t/60),seconds:Math.trunc(t%60),milliseconds:t-Math.trunc(t)}},e.decode=function(t,e,r,n){r||(r=function(){}),n||(n=function(){}),t.decodeAudioData(e,r,n)},e.requestFullscreen=function(t){return t.requestFullscreen()},e.exitFullscreen=function(){return document.exitFullscreen()},e.read=n,e.drop=function(t){var e,r,i=t.event,s=t.type,o=t.successCallback,a=t.errorCallback,u=t.progressCallback;i.preventDefault();var c=null!==(r=null===(e=i.dataTransfer)||void 0===e?void 0:e.files.item(0))&&void 0!==r?r:null;return null===c?new Error("Please drop file."):"text"!==s||c.type.includes("text")?"json"!==s||c.type.includes("application/json")?"arraybuffer"!==s&&"dataURL"!==s||/audio|video/.test(c.type)?"objectURL"===s?window.URL.createObjectURL(c):(n({file:c,type:s,successCallback:o,errorCallback:a,progressCallback:u}),c):new Error("Please drop audio or video file."):new Error("Please drop JSON file."):new Error("Please drop text file.")},e.file=function(t){var e,r,i=t.event,s=t.type,o=t.successCallback,a=t.errorCallback,u=t.progressCallback,c=null!==(r=null===(e=i.target.files)||void 0===e?void 0:e.item(0))&&void 0!==r?r:null;return null===c?new Error("Please upload file."):"text"!==s||c.type.includes("text")?"json"!==s||c.type.includes("application/json")?"arraybuffer"!==s&&"dataURL"!==s||/audio|video/.test(c.type)?"objectURL"===s?window.URL.createObjectURL(c):(n({file:c,type:s,successCallback:o,errorCallback:a,progressCallback:u}),c):new Error("Please upload audio or video file."):new Error("Please upload JSON file."):new Error("Please upload text file.")},e.toFrequencies=function(t){return t.map((function(t){return r(t)}))},e.toTextFile=function(t){var e=window.btoa(function(t){for(var e="",r=0,n=t.length;r<n;r++){var i=t.charCodeAt(r);e+=i>255?"&#".concat(i,";"):t.charAt(r)}return e}(String(t)));return"data:text/plain;base64,".concat(e)}},2309:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0})}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,r),s.exports}var n={};return(()=>{var t=n;Object.defineProperty(t,"__esModule",{value:!0}),t.X=t.XSound=void 0,r(2309);r(2188);var e=r(6667),i=r(5146),s=r(4903),o=r(1114),a=r(7878),u=r(3594),c=r(6954),l=r(6567),h=r(9206),p=r(7087),f=r(8397),d=r(7806),v=r(173),y=r(1643),m=r(8044),b=r(8649),g=r(346),w=r(4535),T=r(1605),k=(r(8137),r(111)),_=r(7369),A=r(6548),x=r(4226),O=r(3751),S=r(2393),M=r(4833),E=r(1063),P=r(7223),C=r(8976),R=r(4979),j=(r(3449),r(6813)),N=r(999);window.AudioContext=window.AudioContext||window.webkitAudioContext,window.URL=window.URL||window.webkitURL;var I=new AudioContext,q={oscillator:new e.OscillatorModule(I,0),oneshot:new i.OneshotModule(I,0),noise:new s.NoiseModule(I,0),audio:new o.AudioModule(I,0),media:new a.MediaModule(I,0),stream:new u.StreamModule(I,0),processor:new c.ProcessorModule(I,0),mixer:new l.MixerModule(I,0),midi:new h.MIDI,mml:new p.MML};function D(t){switch(t){case"oscillator":return q.oscillator;case"oneshot":return q.oneshot;case"noise":return q.noise;case"audio":return q.audio;case"media":return q.media;case"stream":return q.stream;case"processor":return q.processor;case"mixer":return q.mixer;case"midi":return q.midi;case"mml":return q.mml;default:return null}}t.XSound=D,t.X=D,D.SAMPLE_RATE=I.sampleRate,D.EQUAL_TEMPERAMENT=N.EQUAL_TEMPERAMENT,D.FREQUENCY_RATIO=N.FREQUENCY_RATIO,D.MIN_A=N.MIN_A,D.QUARTER_NOT=N.QUARTER_NOTE,D.HALF_UP=N.HALF_UP,D.HALF_DOWN=N.HALF_DOWN,D.DOT=N.DOT,D.isPitchChar=N.isPitchChar,D.computeIndex=N.computeIndex,D.computeFrequency=N.computeFrequency,D.fft=N.fft,D.ifft=N.ifft,D.ajax=N.ajax,D.convertTime=N.convertTime,D.decode=N.decode,D.requestFullscreen=N.requestFullscreen,D.exitFullscreen=N.exitFullscreen,D.read=N.read,D.drop=N.drop,D.file=N.file,D.toFrequencies=N.toFrequencies,D.toTextFile=N.toTextFile,D.Analyser=f.Analyser,D.Recorder=d.Recorder,D.Session=v.Session,D.Effector=y.Effector,D.Autopanner=m.Autopanner,D.Chorus=b.Chorus,D.Compressor=g.Compressor,D.Delay=w.Delay,D.Distortion=T.Distortion,D.Equalizer=k.Equalizer,D.Filter=_.Filter,D.Flanger=A.Flanger,D.Listener=x.Listener,D.Panner=O.Panner,D.Phaser=S.Phaser,D.PitchShifter=M.PitchShifter,D.Reverb=E.Reverb,D.Ringmodulator=P.Ringmodulator,D.Stereo=C.Stereo,D.Tremolo=R.Tremolo,D.Wah=j.Wah,D.setup=function(){return"running"!==I.state?I.resume():Promise.reject()},D.clone=function(){var t={oscillator:new e.OscillatorModule(I,0),oneshot:new i.OneshotModule(I,0),noise:new s.NoiseModule(I,0),audio:new o.AudioModule(I,0),media:new a.MediaModule(I,0),stream:new u.StreamModule(I,0),mixer:new l.MixerModule(I,0),processor:new c.ProcessorModule(I,0),midi:new h.MIDI,mml:new p.MML};function r(e){switch(e){case"oscillator":return t.oscillator;case"oneshot":return t.oneshot;case"noise":return t.noise;case"audio":return t.audio;case"media":return t.media;case"stream":return t.stream;case"processor":return t.processor;case"mixer":return t.mixer;case"midi":return t.midi;case"mml":return t.mml;default:return null}}return r.free=function(e){for(var r=function(e){if(null===e)return"continue";Object.entries(t).forEach((function(r){var n=r[0],i=r[1];e===i&&(t[n]=null)}))},n=0,i=e;n<i.length;n++){r(i[n])}},r},D.free=function(t){for(var e=function(t){if(null===t)return"continue";Object.entries(q).forEach((function(e){var r=e[0],n=e[1];t===n&&(q[r]=null)}))},r=0,n=t;r<n.length;r++){e(n[r])}},D.noConflict=function(t){return window.X===D&&(window.X=void 0),t&&window.XSound===D&&(window.XSound=void 0),D},D.get=function(){return I},D.getCurrentTime=function(){return I.currentTime};var F=function(){D.setup().then((function(){})).catch((function(){})),document.removeEventListener("click",F,!1),document.removeEventListener("mousedown",F,!1),document.removeEventListener("mouseup",F,!1),document.removeEventListener("touchstart",F,!1),document.removeEventListener("touchend",F,!1)};document.addEventListener("click",F,!1),document.addEventListener("mousedown",F,!1),document.addEventListener("mouseup",F,!1),document.addEventListener("touchstart",F,!1),document.addEventListener("touchend",F,!1)})(),n})()}));
//# sourceMappingURL=xsound.js.map
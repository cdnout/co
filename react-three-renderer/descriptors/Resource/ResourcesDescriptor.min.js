"use strict";var _createClass=function(){function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,r,t){return r&&n(e.prototype,r),t&&n(e,t),e}}(),_get=function e(r,t,n){null===r&&(r=Function.prototype);var o=Object.getOwnPropertyDescriptor(r,t);if(void 0===o){var u=Object.getPrototypeOf(r);return null===u?void 0:e(u,t,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0},_three=require("three"),THREE=_interopRequireWildcard(_three),_invariant=require("fbjs/lib/invariant"),_invariant2=_interopRequireDefault(_invariant),_THREEElementDescriptor=require("../THREEElementDescriptor"),_THREEElementDescriptor2=_interopRequireDefault(_THREEElementDescriptor),_ResourceContainer=require("../../Resources/ResourceContainer"),_ResourceContainer2=_interopRequireDefault(_ResourceContainer);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function _inherits(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}var ResourcesDescriptor=function(){function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return _inherits(n,_THREEElementDescriptor2.default),_createClass(n,[{key:"construct",value:function(){return new _ResourceContainer2.default}},{key:"unmount",value:function(r){var t=r.userData.markup.parentMarkup.threeObject.userData.events;r.resourceIds.forEach(function(e){t.emit("resource.removed",{id:e,distance:0,resource:r.resourceMap[e]})}),_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"unmount",this).call(this,r)}},{key:"addChildren",value:function(n,o){o.forEach(function(e){var r=e.userData._resourceId;"production"!==process.env.NODE_ENV?(0,_invariant2.default)(!!r,"Resource container can only hold resources. Found children without `resourceId` properties: "+o.filter(function(e){return!e.userData._resourceId}).map(function(e){return"<"+e.userData.react3internalComponent._elementType+"/>"}).join(", ")+"."):(0,_invariant2.default)(!!r),n.resourceIds.push(r),n.resourceMap[r]=e;var t=n.userData.markup.parentMarkup;t&&t.threeObject.userData.events.emit("resource.added",{id:r,distance:0,resource:e})})}},{key:"addChild",value:function(e,r){this.addChildren(e,[r])}},{key:"removeChild",value:function(e,r){var t=r.userData._resourceId;delete e.resourceIds[t];var n=e.userData.markup.parentMarkup;n&&n.threeObject.userData.events.emit("resource.removed",{id:t,distance:0,resource:r})}},{key:"setParent",value:function(r,e){_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setParent",this).call(this,r,e);var t=e.userData.events;(e.userData._resources=r).resourceIds.forEach(function(e){t.emit("resource.added",{id:e,distance:0,resource:r.resourceMap[e]})})}},{key:"highlight",value:function(e){var r=e.userData.markup.parentMarkup.threeObject;r.updateMatrixWorld&&r.traverse&&e.userData.events.emit("highlight",{uuid:e.uuid,boundingBoxFunc:function(){var e=new THREE.Box3;return e.setFromObject(r),[e]}})}},{key:"hideHighlight",value:function(e){e.userData.events.emit("hideHighlight")}},{key:"moveChild",value:function(){}}]),n}();module.exports=ResourcesDescriptor;
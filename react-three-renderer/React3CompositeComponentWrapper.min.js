"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_get=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,o)}if("value"in r)return r.value;var i=r.get;return void 0!==i?i.call(o):void 0},_createClass=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}(),_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},_ReactElement=require("react/lib/ReactElement"),_ReactElement2=_interopRequireDefault(_ReactElement),_ReactCurrentOwner=require("react/lib/ReactCurrentOwner"),_ReactCurrentOwner2=_interopRequireDefault(_ReactCurrentOwner),_invariant=require("fbjs/lib/invariant"),_invariant2=_interopRequireDefault(_invariant),_emptyObject=require("fbjs/lib/emptyObject"),_emptyObject2=_interopRequireDefault(_emptyObject),_warning=require("fbjs/lib/warning"),_warning2=_interopRequireDefault(_warning),_ReactCompositeComponent=require("react-dom/lib/ReactCompositeComponent"),_ReactCompositeComponent2=_interopRequireDefault(_ReactCompositeComponent),_ReactInstanceMap=require("react-dom/lib/ReactInstanceMap"),_ReactInstanceMap2=_interopRequireDefault(_ReactInstanceMap),_ReactInstrumentation=require("react-dom/lib/ReactInstrumentation"),_ReactInstrumentation2=_interopRequireDefault(_ReactInstrumentation),_removeDevTool=require("./utils/removeDevTool"),_removeDevTool2=_interopRequireDefault(_removeDevTool);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ReactCompositeComponentMixinImpl=function e(){_classCallCheck(this,e)};function warnIfInvalidElement(e,t){"production"!==process.env.NODE_ENV&&(0,_warning2.default)(null===t||!1===t||_ReactElement2.default.isValidElement(t),"%s(...): A valid React element (or null) must be returned. You may have returned undefined, an array or some other invalid object.",e.displayName||e.name||"Component")}ReactCompositeComponentMixinImpl.prototype=_extends({},ReactCompositeComponentMixinImpl.prototype,_ReactCompositeComponent2.default);var CompositeTypes={ImpureClass:0,PureClass:1,StatelessFunctional:2};function shouldConstruct(e){return!(!e.prototype||!e.prototype.isReactComponent)}function isPureComponent(e){return!(!e.prototype||!e.prototype.isPureReactComponent)}function measureLifeCyclePerf(e,t,n){if(0===t)return e();_ReactInstrumentation2.default.debugTool.onBeginLifeCycleTimer(t,n);try{return e()}finally{_ReactInstrumentation2.default.debugTool.onEndLifeCycleTimer(t,n)}}var invokeComponentDidMountWithTimer=void 0;"production"!==process.env.NODE_ENV&&(invokeComponentDidMountWithTimer=function(){var e=this._instance;0!==this._debugID&&_ReactInstrumentation2.default.debugTool.onBeginLifeCycleTimer(this._debugID,"componentDidMount"),e.componentDidMount(),0!==this._debugID&&_ReactInstrumentation2.default.debugTool.onEndLifeCycleTimer(this._debugID,"componentDidMount")});var StatelessComponent=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"render",value:function(){var e=_ReactInstanceMap2.default.get(this)._currentElement.type,t=e(this.props,this.context,this.updater);return warnIfInvalidElement(e,t),t}}]),e}(),React3CompositeComponentWrapper=function(){function o(e,t){_classCallCheck(this,o);var n=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return n._react3RendererInstance=t,n.construct(e),n}return _inherits(o,ReactCompositeComponentMixinImpl),_createClass(o,[{key:"getHostMarkup",value:function(){return _get(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"getHostNode",this).call(this)}},{key:"construct",value:function(e){_get(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"construct",this).call(this,e),this._threeObject=null}},{key:"_updateRenderedComponent",value:function(e,t){var n=void 0;"production"!==process.env.NODE_ENV&&(n=(0,_removeDevTool2.default)()),_get(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"_updateRenderedComponent",this).call(this,e,t),"production"!==process.env.NODE_ENV&&n&&_removeDevTool2.default.restore(),this._threeObject=this._renderedComponent._threeObject}},{key:"_instantiateReactComponent",value:function(e,t){return this._react3RendererInstance.instantiateReactComponent(e,t)}},{key:"_replaceNodeWithMarkup",value:function(e,t){var n=e.parentMarkup,o=n.childrenMarkup.indexOf(e);"production"!==process.env.NODE_ENV?(0,_invariant2.default)(-1!==o,"The node has no parent"):(0,_invariant2.default)(-1!==o);var r=n.threeObject.userData.react3internalComponent,a=e.threeObject.userData.react3internalComponent;r.removeChild(a,e);var i=t.threeObject.userData.react3internalComponent;i._mountIndex=o,r.createChild(i,null,t)}},{key:"mountComponent",value:function(e,t,n,o){this._context=o,this._mountOrder=this._react3RendererInstance.nextMountID++,this._hostParent=t,this._hostContainerInfo=n;var r,a,i=this._currentElement.props,s=this._processContext(o),u=this._currentElement.type,c=e.getUpdateQueue(),p=shouldConstruct(u),l=this._constructComponent(p,i,s,c),m=void 0;p||l&&l.render?isPureComponent(u)?this._compositeType=CompositeTypes.PureClass:this._compositeType=CompositeTypes.ImpureClass:(warnIfInvalidElement(u,m=l),(0,_invariant2.default)(null===l||!1===l||_ReactElement2.default.isValidElement(l),"%s(...): A valid React element (or null) must be returned. You may have returned undefined, an array or some other invalid object.",u.displayName||u.name||"Component"),l=new StatelessComponent(u),this._compositeType=CompositeTypes.StatelessFunctional),"production"!==process.env.NODE_ENV&&(l.render||(0,_warning2.default)(!1,"%s(...): No `render` method found on the returned component instance: you may have forgotten to define `render`.",u.displayName||u.name||"Component"),r=l.props!==i,a=u.displayName||u.name||"Component",(0,_warning2.default)(void 0===l.props||!r,"%s(...): When calling super() in `%s`, make sure to pass up the same props that your component's constructor was passed.",a,a)),l.props=i,l.context=s,l.refs=_emptyObject2.default,l.updater=c,this._instance=l,_ReactInstanceMap2.default.set(l,this),"production"!==process.env.NODE_ENV&&((0,_warning2.default)(!l.getInitialState||l.getInitialState.isReactClassApproved,"getInitialState was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Did you mean to define a state property instead?",this.getName()||"a component"),(0,_warning2.default)(!l.getDefaultProps||l.getDefaultProps.isReactClassApproved,"getDefaultProps was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Use a static property to define defaultProps instead.",this.getName()||"a component"),(0,_warning2.default)(!l.propTypes,"propTypes was defined as an instance property on %s. Use a static property to define propTypes instead.",this.getName()||"a component"),(0,_warning2.default)(!l.contextTypes,"contextTypes was defined as an instance property on %s. Use a static property to define contextTypes instead.",this.getName()||"a component"),(0,_warning2.default)("function"!=typeof l.componentShouldUpdate,"%s has a method called componentShouldUpdate(). Did you mean shouldComponentUpdate()? The name is phrased as a question because the function is expected to return a value.",this.getName()||"A component"),(0,_warning2.default)("function"!=typeof l.componentDidUnmount,"%s has a method called componentDidUnmount(). But there is no such lifecycle method. Did you mean componentWillUnmount()?",this.getName()||"A component"),(0,_warning2.default)("function"!=typeof l.componentWillRecieveProps,"%s has a method called componentWillRecieveProps(). Did you mean componentWillReceiveProps()?",this.getName()||"A component"));var d=l.state;void 0===d&&(d=null,l.state=d),"object"===(void 0===d?"undefined":_typeof(d))&&!Array.isArray(d)||("production"!==process.env.NODE_ENV?(0,_invariant2.default)(!1,"%s.state: must be set to an object or null",this.getName()||"ReactCompositeComponent"):(0,_invariant2.default)(!1)),this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1;var f=this.performInitialMount(m,t,n,e,o);return l.componentDidMount&&("production"!==process.env.NODE_ENV?e.getReactMountReady().enqueue(invokeComponentDidMountWithTimer,this):e.getReactMountReady().enqueue(l.componentDidMount,l)),f}},{key:"_constructComponent",value:function(e,t,n,o){if("production"===process.env.NODE_ENV)return this._constructComponentWithoutOwner(e,t,n,o);_ReactCurrentOwner2.default.current=this;try{return this._constructComponentWithoutOwner(e,t,n,o)}finally{_ReactCurrentOwner2.default.current=null}}},{key:"_constructComponentWithoutOwner",value:function(e,t,n,o){var r=this._currentElement.type;return e?"production"!==process.env.NODE_ENV?measureLifeCyclePerf(function(){return new r(t,n,o)},this._debugID,"ctor"):new r(t,n,o):"production"!==process.env.NODE_ENV?measureLifeCyclePerf(function(){return r(t,n,o)},this._debugID,"render"):r(t,n,o)}},{key:"attachRef",value:function(e,t){var n=this.getPublicInstance();(n.refs===_emptyObject2.default?n.refs={}:n.refs)[e]=t.getPublicInstance()}}]),o}();module.exports=React3CompositeComponentWrapper;
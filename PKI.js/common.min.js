!function(e){if("undefined"==typeof e.org)e.org={};else if("object"!=typeof e.org)throw new Error("Name org already exists and it's not an object");if("undefined"==typeof e.org.pkijs)e.org.pkijs={};else if("object"!=typeof e.org.pkijs)throw new Error("Name org.pkijs already exists and it's not an object but "+typeof e.org.pkijs);e.org.pkijs.emptyObject=function(){this.toJSON=function(){return{}},this.toSchema=function(){return{}}},e.org.pkijs.getNames=function(e){var a={};return e instanceof Object&&(a=e.names||{}),a},e.org.pkijs.getValue=function(e,a,r){return a in e?e[a]:r},e.org.pkijs.isEqual_view=function(e,a){if(e.length!==a.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!=a[r])return!1;return!0},e.org.pkijs.isEqual_buffer=function(a,r){if(a.byteLength!=r.byteLength)return!1;var s=new Uint8Array(a),t=new Uint8Array(r);return e.org.pkijs.isEqual_view(s,t)},e.org.pkijs.concat_buffers=function(e,a){for(var r=new Uint8Array(e),s=new Uint8Array(a),t=new ArrayBuffer(e.byteLength+a.byteLength),n=new Uint8Array(t),c=0;c<e.byteLength;c++)n[c]=r[c];for(var i=0;i<a.byteLength;i++)n[e.byteLength+i]=s[i];return t},e.org.pkijs.copyBuffer=function(e){for(var a=new ArrayBuffer(e.byteLength),r=new Uint8Array(a),s=new Uint8Array(e),t=0;t<s.length;t++)r[t]=s[t];return a},e.org.pkijs.getCrypto=function(){var a;return"crypto"in e&&("webkitSubtle"in e.crypto&&(a=e.crypto.webkitSubtle),"subtle"in e.crypto&&(a=e.crypto.subtle)),a},e.org.pkijs.stringPrep=function(e){var a=e.replace(/^\s+|\s+$/g,"");return a=a.replace(/\s+/g," "),a=a.toLowerCase()},e.org.pkijs.bufferToHexCodes=function(e,a,r){for(var s="",t=new Uint8Array(e,a,r),n=0;n<t.length;n++){var c=t[n].toString(16).toUpperCase();s=s+(1===c.length?"0":"")+c}return s},e.org.pkijs.getRandomValues=function(a){if("crypto"in e)return e.crypto.getRandomValues(a);throw new Error("No support for Web Cryptography API")},e.org.pkijs.getAlgorithmParameters=function(a,r){var s={algorithm:{},usages:[]};switch(a.toUpperCase()){case"RSASSA-PKCS1-V1_5":switch(r.toLowerCase()){case"generatekey":s={algorithm:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["sign","verify"]};break;case"verify":case"sign":case"importkey":s={algorithm:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSASSA-PKCS1-v1_5"},usages:[]}}break;case"RSA-PSS":switch(r.toLowerCase()){case"sign":case"verify":s={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"},saltLength:20},usages:["sign","verify"]};break;case"generatekey":s={algorithm:{name:"RSA-PSS",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},usages:["sign","verify"]};break;case"importkey":s={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSA-PSS"},usages:[]}}break;case"RSA-OAEP":switch(r.toLowerCase()){case"encrypt":case"decrypt":s={algorithm:{name:"RSA-OAEP"},usages:["encrypt","decrypt"]};break;case"generatekey":s={algorithm:{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"importkey":s={algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]};break;case"exportkey":default:return{algorithm:{name:"RSA-OAEP"},usages:[]}}break;case"ECDSA":switch(r.toLowerCase()){case"generatekey":s={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["sign","verify"]};break;case"importkey":s={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["verify"]};break;case"verify":case"sign":s={algorithm:{name:"ECDSA",hash:{name:"SHA-256"}},usages:["sign"]};break;default:return{algorithm:{name:"ECDSA"},usages:[]}}break;case"ECDH":switch(r.toLowerCase()){case"exportkey":case"importkey":case"generatekey":s={algorithm:{name:"ECDH",namedCurve:"P-256"},usages:["deriveKey","deriveBits"]};break;case"derivekey":case"derivebits":s={algorithm:{name:"ECDH",namedCurve:"P-256","public":[]},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"ECDH"},usages:[]}}break;case"AES-CTR":switch(r.toLowerCase()){case"importkey":case"exportkey":case"generatekey":s={algorithm:{name:"AES-CTR",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":s={algorithm:{name:"AES-CTR",counter:new Uint8Array(16),length:10},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};default:return{algorithm:{name:"AES-CTR"},usages:[]}}break;case"AES-CBC":switch(r.toLowerCase()){case"importkey":case"exportkey":case"generatekey":s={algorithm:{name:"AES-CBC",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":s={algorithm:{name:"AES-CBC",iv:e.org.pkijs.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};default:return{algorithm:{name:"AES-CBC"},usages:[]}}break;case"AES-GCM":switch(r.toLowerCase()){case"importkey":case"exportkey":case"generatekey":s={algorithm:{name:"AES-GCM",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":s={algorithm:{name:"AES-GCM",iv:e.org.pkijs.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};default:return{algorithm:{name:"AES-GCM"},usages:[]}}break;case"AES-KW":switch(r.toLowerCase()){case"importkey":case"exportkey":case"generatekey":case"wrapkey":case"unwrapkey":s={algorithm:{name:"AES-KW",length:256},usages:["wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-KW"},usages:[]}}break;case"HMAC":switch(r.toLowerCase()){case"sign":case"verify":s={algorithm:{name:"HMAC"},usages:["sign","verify"]};break;case"importkey":case"exportkey":case"generatekey":s={algorithm:{name:"HMAC",length:10,hash:{name:"SHA-256"}},usages:["sign","verify"]};break;default:return{algorithm:{name:"HMAC"},usages:[]}}break;case"HKDF":switch(r.toLowerCase()){case"derivekey":s={algorithm:{name:"HKDF",hash:"SHA-256",salt:new Uint8Array,info:new Uint8Array},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"HKDF"},usages:[]}}break;case"PBKDF2":switch(r.toLowerCase()){case"derivekey":s={algorithm:{name:"PBKDF2",hash:{name:"SHA-256"},salt:new Uint8Array,iterations:1e3},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"PBKDF2"},usages:[]}}}return s},e.org.pkijs.getOIDByAlgorithm=function(e){var a="";switch(e.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":switch(e.hash.name.toUpperCase()){case"SHA-1":a="1.2.840.113549.1.1.5";break;case"SHA-256":a="1.2.840.113549.1.1.11";break;case"SHA-384":a="1.2.840.113549.1.1.12";break;case"SHA-512":a="1.2.840.113549.1.1.13"}break;case"RSA-PSS":a="1.2.840.113549.1.1.10";break;case"RSA-OAEP":a="1.2.840.113549.1.1.7";break;case"ECDSA":switch(e.hash.name.toUpperCase()){case"SHA-1":a="1.2.840.10045.4.1";break;case"SHA-256":a="1.2.840.10045.4.3.2";break;case"SHA-384":a="1.2.840.10045.4.3.3";break;case"SHA-512":a="1.2.840.10045.4.3.4"}break;case"ECDH":switch(e.kdf.toUpperCase()){case"SHA-1":a="1.3.133.16.840.63.0.2";break;case"SHA-256":a="1.3.132.1.11.1";break;case"SHA-384":a="1.3.132.1.11.2";break;case"SHA-512":a="1.3.132.1.11.3"}break;case"AES-CTR":break;case"AES-CBC":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.2";break;case 192:a="2.16.840.1.101.3.4.1.22";break;case 256:a="2.16.840.1.101.3.4.1.42"}break;case"AES-CMAC":break;case"AES-GCM":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.6";break;case 192:a="2.16.840.1.101.3.4.1.26";break;case 256:a="2.16.840.1.101.3.4.1.46"}break;case"AES-CFB":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.4";break;case 192:a="2.16.840.1.101.3.4.1.24";break;case 256:a="2.16.840.1.101.3.4.1.44"}break;case"AES-KW":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.5";break;case 192:a="2.16.840.1.101.3.4.1.25";break;case 256:a="2.16.840.1.101.3.4.1.45"}break;case"HMAC":switch(e.hash.name.toUpperCase()){case"SHA-1":a="1.2.840.113549.2.7";break;case"SHA-256":a="1.2.840.113549.2.9";break;case"SHA-384":a="1.2.840.113549.2.10";break;case"SHA-512":a="1.2.840.113549.2.11"}break;case"DH":a="1.2.840.113549.1.9.16.3.5";break;case"SHA-1":a="1.3.14.3.2.26";break;case"SHA-256":a="2.16.840.1.101.3.4.2.1";break;case"SHA-384":a="2.16.840.1.101.3.4.2.2";break;case"SHA-512":a="2.16.840.1.101.3.4.2.3";break;case"CONCAT":break;case"HKDF":break;case"PBKDF2":a="1.2.840.113549.1.5.12";break;case"P-256":a="1.2.840.10045.3.1.7";break;case"P-384":a="1.3.132.0.34";break;case"P-521":a="1.3.132.0.35"}return a},e.org.pkijs.getAlgorithmByOID=function(e){var a={};switch(e){case"1.2.840.113549.1.1.5":a={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};break;case"1.2.840.113549.1.1.11":a={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};break;case"1.2.840.113549.1.1.12":a={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};break;case"1.2.840.113549.1.1.13":a={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};break;case"1.2.840.113549.1.1.10":a={name:"RSA-PSS"};break;case"1.2.840.113549.1.1.7":a={name:"RSA-OAEP"};break;case"1.2.840.10045.4.1":a={name:"ECDSA",hash:{name:"SHA-1"}};break;case"1.2.840.10045.4.3.2":a={name:"ECDSA",hash:{name:"SHA-256"}};break;case"1.2.840.10045.4.3.3":a={name:"ECDSA",hash:{name:"SHA-384"}};break;case"1.2.840.10045.4.3.4":a={name:"ECDSA",hash:{name:"SHA-512"}};break;case"1.3.133.16.840.63.0.2":a={name:"ECDH",kdf:"SHA-1"};break;case"1.3.132.1.11.1":a={name:"ECDH",kdf:"SHA-256"};break;case"1.3.132.1.11.2":a={name:"ECDH",kdf:"SHA-384"};break;case"1.3.132.1.11.3":a={name:"ECDH",kdf:"SHA-512"};break;case"2.16.840.1.101.3.4.1.2":a={name:"AES-CBC",length:128};break;case"2.16.840.1.101.3.4.1.22":a={name:"AES-CBC",length:192};break;case"2.16.840.1.101.3.4.1.42":a={name:"AES-CBC",length:256};break;case"2.16.840.1.101.3.4.1.6":a={name:"AES-GCM",length:128};break;case"2.16.840.1.101.3.4.1.26":a={name:"AES-GCM",length:192};break;case"2.16.840.1.101.3.4.1.46":a={name:"AES-GCM",length:256};break;case"2.16.840.1.101.3.4.1.4":a={name:"AES-CFB",length:128};break;case"2.16.840.1.101.3.4.1.24":a={name:"AES-CFB",length:192};break;case"2.16.840.1.101.3.4.1.44":a={name:"AES-CFB",length:256};break;case"2.16.840.1.101.3.4.1.5":a={name:"AES-KW",length:128};break;case"2.16.840.1.101.3.4.1.25":a={name:"AES-KW",length:192};break;case"2.16.840.1.101.3.4.1.45":a={name:"AES-KW",length:256};break;case"1.2.840.113549.2.7":a={name:"HMAC",hash:{name:"SHA-1"}};break;case"1.2.840.113549.2.9":a={name:"HMAC",hash:{name:"SHA-256"}};break;case"1.2.840.113549.2.10":a={name:"HMAC",hash:{name:"SHA-384"}};break;case"1.2.840.113549.2.11":a={name:"HMAC",hash:{name:"SHA-512"}};break;case"1.2.840.113549.1.9.16.3.5":a={name:"DH"};break;case"1.3.14.3.2.26":a={name:"SHA-1"};break;case"2.16.840.1.101.3.4.2.1":a={name:"SHA-256"};break;case"2.16.840.1.101.3.4.2.2":a={name:"SHA-384"};break;case"2.16.840.1.101.3.4.2.3":a={name:"SHA-512"};break;case"1.2.840.113549.1.5.12":a={name:"PBKDF2"};break;case"1.2.840.10045.3.1.7":a={name:"P-256"};break;case"1.3.132.0.34":a={name:"P-384"};break;case"1.3.132.0.35":a={name:"P-521"}}return a},e.org.pkijs.getHashAlgorithm=function(a){var r="";switch(a.algorithm_id){case"1.2.840.10045.4.1":case"1.2.840.113549.1.1.5":r="SHA-1";break;case"1.2.840.10045.4.3.2":case"1.2.840.113549.1.1.11":r="SHA-256";break;case"1.2.840.10045.4.3.3":case"1.2.840.113549.1.1.12":r="SHA-384";break;case"1.2.840.10045.4.3.4":case"1.2.840.113549.1.1.13":r="SHA-512";break;case"1.2.840.113549.1.1.10":var s;try{if(s=new e.org.pkijs.simpl.x509.RSASSA_PSS_params({schema:a.algorithm_params}),"hashAlgorithm"in s){var t=e.org.pkijs.getAlgorithmByOID(s.hashAlgorithm.algorithm_id);if("name"in t==!1)return"";r=t.name}else r="SHA-1"}catch(n){}}return r},e.org.pkijs.createCMSECDSASignature=function(a){if(a.byteLength%2!=0)return new ArrayBuffer(0);for(var r,s,t,n,c=0,i=a.byteLength/2,o=new Uint8Array(a),g=new ArrayBuffer(i),k=new Uint8Array(g),A=new ArrayBuffer(i),h=new Uint8Array(A);i>c;c++)k[c]=o[c];if(128&k[0]){r=new ArrayBuffer(i+1),s=new Uint8Array(r),s[0]=0;for(var u=0;i>u;u++)s[u+1]=k[u]}else r=g,s=k;for(;c<a.byteLength;c++)h[c-i]=o[c];if(128&h[0]){t=new ArrayBuffer(i+1),n=new Uint8Array(t),n[0]=0;for(var u=0;i>u;u++)n[u+1]=h[u]}else t=A,n=h;var m=new e.org.pkijs.asn1.INTEGER;m.value_block.is_hex_only=!0,m.value_block.value_hex=e.org.pkijs.copyBuffer(r);var S=new e.org.pkijs.asn1.INTEGER;S.value_block.is_hex_only=!0,S.value_block.value_hex=e.org.pkijs.copyBuffer(t);var y=new e.org.pkijs.asn1.SEQUENCE({value:[m,S]});return y.toBER(!1)},e.org.pkijs.createECDSASignatureFromCMS=function(e){var a=0,r=0,s=0,t=e.value_block.value[0].value_block.value_hex.byteLength,n=e.value_block.value[1].value_block.value_hex.byteLength,c=new Uint8Array(e.value_block.value[0].value_block.value_hex);0===c[0]&&128&c[1]?(a=t-1,r=1):a=t;var i=new Uint8Array(e.value_block.value[1].value_block.value_hex);0===i[0]&&128&i[1]?(a+=n-1,s=1):a+=n;for(var o=new ArrayBuffer(a),g=new Uint8Array(o),k=r;t>k;k++)g[k-r]=c[k];for(var k=s;n>k;k++)g[k-s+t-r]=i[k];return o},e.org.pkijs.getEncryptionAlgorithm=function(e){var a="";switch(e.name.toUpperCase()){case"AES-CBC":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.2";break;case 192:a="2.16.840.1.101.3.4.1.22";break;case 256:a="2.16.840.1.101.3.4.1.42"}break;case"AES-GCM":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.6";break;case 192:a="2.16.840.1.101.3.4.1.26";break;case 256:a="2.16.840.1.101.3.4.1.46"}}return a},e.org.pkijs.getAlgorithmByEncryptionOID=function(e){var a="";switch(e){case"2.16.840.1.101.3.4.1.2":case"2.16.840.1.101.3.4.1.22":case"2.16.840.1.101.3.4.1.42":a="AES-CBC";break;case"2.16.840.1.101.3.4.1.6":case"2.16.840.1.101.3.4.1.26":case"2.16.840.1.101.3.4.1.46":a="AES-GCM"}return a}}("undefined"!=typeof exports?exports:window);
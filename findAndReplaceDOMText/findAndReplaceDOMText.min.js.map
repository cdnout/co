{"version":3,"sources":["findAndReplaceDOMText.js"],"names":["root","factory","module","exports","define","amd","findAndReplaceDOMText","this","exposed","regex","node","replacement","captureGroup","elFilter","nodeType","arguments","length","isReplacementFunction","original","portion","match","text","startIndex","instance","find","wrap","replace","prepMatch","m","mi","cg","index","indexOf","endIndex","filterElements","revert","apply","options","Finder","preset","PRESETS","portionMode","PORTION_MODE_RETAIN","i","hasOwn","call","reverts","matches","search","processMatches","doc","document","hasOwnProperty","NON_PROSE_ELEMENTS","br","hr","script","style","img","video","audio","canvas","svg","map","object","input","textarea","select","option","optgroup","button","NON_CONTIGUOUS_PROSE_ELEMENTS","address","article","aside","blockquote","dd","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","main","nav","noscript","ol","output","p","pre","section","ul","li","summary","dt","details","rp","rt","rtc","table","tbody","thead","th","tr","td","caption","col","tfoot","colgroup","NON_INLINE_PROSE","el","nodeName","toLowerCase","prose","forceContext","prototype","matchAggregation","textAggregation","l","global","exec","push","self","matchIndex","offset","getAggregateText","RegExp","s","String","escapeRegExp","characterOffset","Error","getText","Node","TEXT_NODE","data","elementFilter","txt","firstChild","innerText","ELEMENT_NODE","shift","nextSibling","startPortion","endPortion","doAvoidNode","innerPortions","curNode","atIndex","portionIndex","nodeStack","out","substring","indexInMatch","indexInNode","endIndexInNode","isEnd","replaceMatch","pop","prepareReplacementString","string","$0","t","getPortionReplacementNode","wrapper","wrapperClass","wrapClass","clone","createElement","innerHTML","outerHTML","XMLSerializer","serializeToString","createTextNode","className","appendChild","precedingTextNode","followingTextNode","matchStartNode","matchEndNode","parentNode","insertBefore","newNode","removeChild","previousSibling","replaceChild","firstNode","innerNodes","innerNode","lastNode"],"mappings":"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"}
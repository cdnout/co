export class Bilderrahmen{constructor(e){this.store={current:{galleryId:null,index:null},galleries:[],closeOnOutsideClick:!1},null!=e&&void 0!==e.closeOnOutsideClick&&null!==e.closeOnOutsideClick&&!0===e.closeOnOutsideClick&&(this.store.closeOnOutsideClick=!0),this.init()}__stopDefaultEvent(e){e&&e.preventDefault?e.preventDefault():window.event&&window.event.returnValue&&(window.event.returnValue=!1)}_setCurrentOpenImage(e,t){this.store.current.galleryId=e,this.store.current.index=t}_getCurrentOpenImage(){return this.store.current}_clearCurrentOpenImage(){this.store.current.galleryId=null,this.store.current.index=null}_isCurrentOpenImage(){return null!==this.store.current.galleryId}_getGallery(e){return void 0!==this.store[e]&&null!==this.store[e]||(this.store[e]=[]),this.store[e]}_getImage(e,t){const r=this._getGallery(e);return void 0!==r[t]&&null!==r[t]||(r[t]={}),r[t]}_isImage(e,t){const r=this._getImage(e,t);return!(void 0===r.src||null===r.src)}_renderNextOrPreviousButton(e,t,r){var n=this;const i=document.createElement("div");return i.setAttribute("class","bilderrahmen--"+r),n._isImage(e,t)&&(i.setAttribute("class","left"===r?"bilderrahmen--left bilderrahmen--left--has-previous":"bilderrahmen--right bilderrahmen--right--has-next"),i.onclick=(()=>n.open(e,t))),i}_generateId(e,t){return"bilderrahmen--"+e+"--"+t}closeIfOpen(){const e=document.getElementsByClassName("bilderrahmen-wrapper");void 0!==e[0]&&null!==e[0]&&e[0].parentNode.removeChild(e[0]),this._clearCurrentOpenImage()}open(e,t){this.closeIfOpen(),this._setCurrentOpenImage(e,t),this.create(e,t)}create(e,t){const r=this,n=parseInt(t,10),i=document.createElement("div");i.setAttribute("class","bilderrahmen-wrapper"),i.setAttribute("data-bilderrahmen-gallery-id",e),document.body.appendChild(i);const l=document.createElement("div");l.setAttribute("class","bilderrahmen--top"),i.appendChild(l);const s=document.createElement("div");s.setAttribute("class","bilderrahmen--top-title"),s.innerHTML=r._getImage(e,t).title,l.appendChild(s);const a=document.createElement("div");a.setAttribute("class","bilderrahmen--top-close"),a.onclick=(()=>r.closeIfOpen()),l.appendChild(a),i.appendChild(r._renderNextOrPreviousButton(e,n-1,"left"));const d=r._getImage(e,t);if(!1===d.isVideo){const n=document.createElement("div");n.setAttribute("class","bilderrahmen--image"),i.appendChild(n);const l=document.createElement("div");l.setAttribute("class","bilderrahmen--image-inner"),n.appendChild(l);const s=document.createElement("div");s.setAttribute("class","bilderrahmen--image-inner-wrap"),l.appendChild(s);const a=document.createElement("img");a.onload=function(){n.setAttribute("class","bilderrahmen--image bilderrahmen--image-loaded")},a.setAttribute("src",r._getImage(e,t).src),a.setAttribute("class","bilderrahmen--image-img"),a.setAttribute("id",r._generateId(e,t)),s.appendChild(a),!0===r.store.closeOnOutsideClick&&(s.onclick=(()=>r.closeIfOpen()),a.addEventListener("click",e=>r.__stopDefaultEvent(e)))}if(!0===d.isVideo){const n=document.createElement("div");n.setAttribute("class","bilderrahmen--image"),i.appendChild(n);const l=document.createElement("div");l.setAttribute("class","bilderrahmen--image-inner"),n.appendChild(l);const s=document.createElement("div");s.setAttribute("class","bilderrahmen--image-inner-wrap"),l.appendChild(s);const a=document.createElement("video");a.onload=function(){n.setAttribute("class","bilderrahmen--image bilderrahmen--image-loaded")},a.setAttribute("poster",d.poster),a.setAttribute("autoplay",""),a.setAttribute("controls","");const o=document.createElement("source");o.setAttribute("src",d.src),o.setAttribute("type","video/mp4"),a.appendChild(o),a.setAttribute("class","bilderrahmen--image-img"),a.setAttribute("id",r._generateId(e,t)),s.appendChild(a),!0===r.store.closeOnOutsideClick&&(s.onclick=(()=>r.closeIfOpen()),a.addEventListener("click",e=>r.__stopDefaultEvent(e)))}return i.appendChild(r._renderNextOrPreviousButton(e,n+1,"right")),!1}init(){console.log("Bilderrahmen init()");const e=this,t=document.querySelectorAll("[data-bilderrahmen]");for(let r=0;r<t.length;r++){const n=t[r],i=n.getAttribute("data-bilderrahmen"),l=e._getGallery(i).length,s=e._getImage(i,l);s.title=n.getAttribute("data-bilderrahmen-title");const a=n.parentNode;n.getAttribute("data-bilderrahmen-video")?(s.src=n.getAttribute("data-bilderrahmen-video"),s.poster=n.getAttribute("src"),s.isVideo=!0):(s.src=a.getAttribute("href"),s.poster=null,s.isVideo=!1),a.addEventListener("click",t=>(e.open(i,l),e.__stopDefaultEvent(t)))}document.addEventListener("keydown",function(t){if(27===t.keyCode&&e.closeIfOpen(),37===t.keyCode&&e._isCurrentOpenImage()){const t=e._getCurrentOpenImage();e._isImage(t.galleryId,t.index-1)&&e.open(t.galleryId,t.index-1)}if(39===t.keyCode&&e._isCurrentOpenImage()){const t=e._getCurrentOpenImage();e._isImage(t.galleryId,t.index+1)&&e.open(t.galleryId,t.index+1)}},!1)}};
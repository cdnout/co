function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"function"==typeof define&&define.amd?define(["exports","../../globals/js/settings","../../globals/js/misc/mixin","../../globals/js/mixins/create-component","../../globals/js/mixins/init-component-by-search","../../globals/js/mixins/evented-state","../../globals/js/mixins/handles","../../globals/js/misc/event-matches","../../globals/js/misc/on"],t):"undefined"!=typeof exports?t(exports,require("../../globals/js/settings"),require("../../globals/js/misc/mixin"),require("../../globals/js/mixins/create-component"),require("../../globals/js/mixins/init-component-by-search"),require("../../globals/js/mixins/evented-state"),require("../../globals/js/mixins/handles"),require("../../globals/js/misc/event-matches"),require("../../globals/js/misc/on")):(t(t={},e.settings,e.mixin,e.createComponent,e.initComponentBySearch,e.eventedState,e.handles,e.eventMatches,e.on),e.dataTable=t)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e,l,r,c,s,i,u,d,p){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function b(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,a=new Array(t);o<t;o++)a[o]=e[o];return a}function f(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(o){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=n(o);return e=a?(e=n(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==_typeof(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,l=t(l),r=t(r),c=t(c),s=t(s),i=t(i),u=t(u),d=t(d),p=t(p);var v=function(e){return Array.prototype.slice.call(e)},o=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(n,(0,r.default)(c.default,s.default,i.default,u.default));var e,t,o,a=g(n);function n(e,t){var l;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(l=a.call(this,e,t))._sortToggle=function(e){var t=e.element,e=e.previousValue;v(l.tableHeaders).forEach(function(e){e=e.querySelector(l.options.selectorTableSort);null!==e&&e!==t&&(e.classList.remove(l.options.classTableSortActive),e.classList.remove(l.options.classTableSortAscending))}),e?"ascending"===e?(t.dataset.previousValue="descending",t.classList.add(l.options.classTableSortActive),t.classList.remove(l.options.classTableSortAscending)):"descending"===e&&(t.removeAttribute("data-previous-value"),t.classList.remove(l.options.classTableSortActive),t.classList.remove(l.options.classTableSortAscending)):(t.dataset.previousValue="ascending",t.classList.add(l.options.classTableSortActive),t.classList.add(l.options.classTableSortAscending))},l._selectToggle=function(e){var t=e.element,e=t.checked;l.state.checkboxCount+=e?1:-1,l.countEl.textContent=l.state.checkboxCount,t.parentNode.parentNode.classList.toggle(l.options.classTableSelected),l._actionBarToggle(0<l.state.checkboxCount)},l._selectAllToggle=function(e){var t=e.element.checked,e=v(l.element.querySelectorAll(l.options.selectorCheckbox));l.state.checkboxCount=t?e.length-1:0,e.forEach(function(e){e.checked=t;e=e.parentNode.parentNode;t&&e?e.classList.add(l.options.classTableSelected):e.classList.remove(l.options.classTableSelected)}),l._actionBarToggle(0<l.state.checkboxCount),l.batchActionEl&&(l.countEl.textContent=l.state.checkboxCount)},l._actionBarCancel=function(){var e=v(l.element.querySelectorAll(l.options.selectorCheckbox));v(l.element.querySelectorAll(l.options.selectorTableSelected)).forEach(function(e){e.classList.remove(l.options.classTableSelected)}),e.forEach(function(e){e.checked=!1}),l.state.checkboxCount=0,l._actionBarToggle(!1),l.batchActionEl&&(l.countEl.textContent=l.state.checkboxCount)},l._actionBarToggle=function(e){var t;e?(l.batchActionEl.dataset.active=!0,l.batchActionEl.classList.add(l.options.classActionBarActive)):l.batchActionEl&&(l.batchActionEl.dataset.active=!1,l.batchActionEl.classList.remove(l.options.classActionBarActive)),l.batchActionEl&&(t=l.manage((0,p.default)(l.batchActionEl,"transitionend",function(e){t=t&&l.unmanage(t).release(),e.target.matches(l.options.selectorActions)&&("false"===l.batchActionEl.dataset.active?l.batchActionEl.setAttribute("tabIndex",-1):l.batchActionEl.setAttribute("tabIndex",0))})))},l._rowExpandToggle=function(e){var t=e.element,o=e.forceExpand,e=t.closest(l.options.eventParentContainer);(null!=o?o:void 0===t.dataset.previousValue||"expanded"===t.dataset.previousValue)?(t.dataset.previousValue="collapsed",e.classList.add(l.options.classExpandableRow)):(e.classList.remove(l.options.classExpandableRow),t.dataset.previousValue="expanded",(t=l.element.querySelector(l.options.selectorExpandHeader))&&(t.dataset.previousValue="expanded"))},l._rowExpandToggleAll=function(e){var e=e.element,t=void 0===e.dataset.previousValue||"expanded"===e.dataset.previousValue;e.dataset.previousValue=t?"collapsed":"expanded";e=l.element.querySelectorAll(l.options.selectorExpandCells);Array.prototype.forEach.call(e,function(e){l._rowExpandToggle({element:e,forceExpand:t})})},l._expandableHoverToggle=function(e){var t=(0,d.default)(e,l.options.selectorChildRow);t&&t.previousElementSibling.classList.toggle(l.options.classExpandableRowHover,"mouseover"===e.type)},l._toggleState=function(e,t){var o=e.dataset,a=o.label||"",n=o.previousValue||"";l.changeState({group:o.event,element:e,label:a,previousValue:n,initialEvt:t})},l._keydownHandler=function(e){var t=l.element.querySelector(l.options.selectorToolbarSearchContainer),o=(0,d.default)(e,l.options.selectorSearchMagnifier),a=t.classList.contains(l.options.classToolbarSearchActive);27===e.which&&l._actionBarCancel(),t&&o&&13===e.which&&l.activateSearch(t),a&&27===e.which&&l.deactivateSearch(t,e)},l.refreshRows=function(){var e,t=v(l.element.querySelectorAll(l.options.selectorExpandCells)),o=v(l.element.querySelectorAll(l.options.selectorExpandableRows)),a=v(l.element.querySelectorAll(l.options.selectorParentRows));0<l.parentRows.length?(e=a.filter(function(t){return!l.parentRows.some(function(e){return e===t})}),0<o.length&&(e=e.map(function(e){return e.nextElementSibling}),e=[].concat(b(v(l.expandableRows)),b(v(e))),l.expandableRows=e)):0<o.length&&(l.expandableRows=o),l.expandCells=t,l.parentRows=a},l.container=e.parentNode,l.toolbarEl=l.element.querySelector(l.options.selectorToolbar),l.batchActionEl=l.element.querySelector(l.options.selectorActions),l.countEl=l.element.querySelector(l.options.selectorCount),l.cancelEl=l.element.querySelector(l.options.selectorActionCancel),l.tableHeaders=l.element.querySelectorAll("th"),l.tableBody=l.element.querySelector(l.options.selectorTableBody),l.expandCells=[],l.expandableRows=[],l.parentRows=[],l.refreshRows(),l.manage((0,p.default)(l.element,"mouseover",l._expandableHoverToggle)),l.manage((0,p.default)(l.element,"mouseout",l._expandableHoverToggle)),l.manage((0,p.default)(l.element,"click",function(e){var t=(0,d.default)(e,l.options.eventTrigger),o=l.element.querySelector(l.options.selectorToolbarSearchContainer);t&&l._toggleState(t,e),o&&l._handleDocumentClick(e)})),l.manage((0,p.default)(l.element,"keydown",l._keydownHandler)),l.state={checkboxCount:0},l}return e=n,o=[{key:"options",get:function(){var e=l.default.prefix;return{selectorInit:"[data-table]",selectorToolbar:".".concat(e,"--table--toolbar"),selectorActions:".".concat(e,"--batch-actions"),selectorCount:"[data-items-selected]",selectorActionCancel:".".concat(e,"--batch-summary__cancel"),selectorCheckbox:".".concat(e,"--checkbox"),selectorExpandHeader:"th.".concat(e,"--table-expand"),selectorExpandCells:"td.".concat(e,"--table-expand"),selectorExpandableRows:".".concat(e,"--expandable-row"),selectorParentRows:".".concat(e,"--parent-row"),selectorChildRow:"[data-child-row]",selectorTableBody:"tbody",selectorTableSort:".".concat(e,"--table-sort"),selectorTableSelected:".".concat(e,"--data-table--selected"),selectorToolbarSearchContainer:".".concat(e,"--toolbar-search-container-expandable"),selectorSearchMagnifier:".".concat(e,"--search-magnifier"),selectorSearchInput:".".concat(e,"--search-input"),classExpandableRow:"".concat(e,"--expandable-row"),classExpandableRowHidden:"".concat(e,"--expandable-row--hidden"),classExpandableRowHover:"".concat(e,"--expandable-row--hover"),classTableSortAscending:"".concat(e,"--table-sort--ascending"),classTableSortActive:"".concat(e,"--table-sort--active"),classToolbarSearchActive:"".concat(e,"--toolbar-search-container-active"),classActionBarActive:"".concat(e,"--batch-actions--active"),classTableSelected:"".concat(e,"--data-table--selected"),eventBeforeExpand:"data-table-beforetoggleexpand",eventAfterExpand:"data-table-aftertoggleexpand",eventBeforeExpandAll:"data-table-beforetoggleexpandall",eventAfterExpandAll:"data-table-aftertoggleexpandall",eventBeforeSort:"data-table-beforetogglesort",eventAfterSort:"data-table-aftertogglesort",eventTrigger:"[data-event]",eventParentContainer:"[data-parent-row]"}}}],(t=[{key:"_handleDocumentClick",value:function(e){var t=this.element.querySelector(this.options.selectorToolbarSearchContainer),o=(0,d.default)(e,this.options.selectorSearchMagnifier),a=t.classList.contains(this.options.classToolbarSearchActive);t&&o&&this.activateSearch(t),a&&this.deactivateSearch(t,e)}},{key:"activateSearch",value:function(e){var t=e.querySelector(this.options.selectorSearchInput);e.classList.add(this.options.classToolbarSearchActive),t.focus()}},{key:"deactivateSearch",value:function(e,t){var o=e.querySelector(this.options.selectorSearchMagnifier),a=e.querySelector(this.options.selectorSearchInput),n=o.querySelector("svg");0===a.value.length&&t.target!==a&&t.target!==o&&t.target!==n&&(e.classList.remove(this.options.classToolbarSearchActive),o.focus()),27===t.which&&t.target===a&&(e.classList.remove(this.options.classToolbarSearchActive),o.focus())}},{key:"_changeState",value:function(e,t){this[this.constructor.eventHandlers[e.group]](e),t()}}])&&f(e.prototype,t),o&&f(e,o),n.components=new WeakMap,n.eventHandlers={expand:"_rowExpandToggle",expandAll:"_rowExpandToggleAll",sort:"_sortToggle",select:"_selectToggle","select-all":"_selectAllToggle","action-bar-cancel":"_actionBarCancel"},n}();e.default=o});
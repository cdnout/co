function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"function"==typeof define&&define.amd?define(["exports","../../globals/js/settings","../../globals/js/misc/mixin","../../globals/js/mixins/create-component","../../globals/js/mixins/init-component-by-search","../../globals/js/mixins/evented-state","../../globals/js/mixins/handles","../../globals/js/misc/event-matches","../../globals/js/misc/on"],t):"undefined"!=typeof exports?t(exports,require("../../globals/js/settings"),require("../../globals/js/misc/mixin"),require("../../globals/js/mixins/create-component"),require("../../globals/js/mixins/init-component-by-search"),require("../../globals/js/mixins/evented-state"),require("../../globals/js/mixins/handles"),require("../../globals/js/misc/event-matches"),require("../../globals/js/misc/on")):(t(t={},e.settings,e.mixin,e.createComponent,e.initComponentBySearch,e.eventedState,e.handles,e.eventMatches,e.on),e.fileUploader=t)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e,o,r,l,s,c,f,u,d){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=a(n);return e=o?(e=a(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==_typeof(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,o=t(o),r=t(r),l=t(l),s=t(s),c=t(c),f=t(f),u=t(u),d=t(d);function m(e){return Array.prototype.slice.call(e)}var n=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(i,(0,r.default)(l.default,s.default,c.default,f.default));var e,t,n,a=g(i);function i(e){var o,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(o=a.call(this,e,t))._changeState=function(e,t,n){"delete-filename-fileuploader"===e&&o.container.removeChild(t.filenameElement),"function"==typeof n&&n()},o._handleDeleteButton=function(e){var t=(0,u.default)(e,o.options.selectorCloseButton);t&&o.changeState("delete-filename-fileuploader",{initialEvt:e,filenameElement:t.closest(o.options.selectorSelectedFile)})},o._handleDragDrop=function(e){var t,n=o.element.contains(e.target);0<=Array.prototype.indexOf.call(e.dataTransfer.types,"Files")&&!(0,u.default)(e,o.options.selectorOtherDropContainers)&&(t=n&&(0,u.default)(e,o.options.selectorDropContainer),"dragover"===e.type&&(e.preventDefault(),n=t?"copy":"none",Array.isArray(e.dataTransfer.types)&&(e.dataTransfer.effectAllowed=n),e.dataTransfer.dropEffect=n,o.dropContainer.classList.toggle(o.options.classDragOver,Boolean(t))),"dragleave"===e.type&&o.dropContainer.classList.toggle(o.options.classDragOver,!1),t&&"drop"===e.type&&(e.preventDefault(),o._displayFilenames(e.dataTransfer.files),o.dropContainer.classList.remove(o.options.classDragOver)))},o.input=o.element.querySelector(o.options.selectorInput),o.container=o.element.querySelector(o.options.selectorContainer),o.dropContainer=o.element.querySelector(o.options.selectorDropContainer),!o.input)throw new TypeError("Cannot find the file input box.");if(!o.container)throw new TypeError("Cannot find the file names container.");return o.inputId=o.input.getAttribute("id"),o.manage((0,d.default)(o.input,"change",function(){return o._displayFilenames()})),o.manage((0,d.default)(o.container,"click",o._handleDeleteButton)),o.manage((0,d.default)(o.element.ownerDocument,"dragleave",o._handleDragDrop)),o.manage((0,d.default)(o.dropContainer,"dragover",o._handleDragDrop)),o.manage((0,d.default)(o.dropContainer,"drop",o._handleDragDrop)),o}return e=i,n=[{key:"options",get:function(){var e=o.default.prefix;return{selectorInit:"[data-file]",selectorInput:'input[type="file"].'.concat(e,"--file-input"),selectorContainer:"[data-file-container]",selectorCloseButton:".".concat(e,"--file-close"),selectorSelectedFile:".".concat(e,"--file__selected-file"),selectorDropContainer:"[data-file-drop-container]",selectorOtherDropContainers:"[data-drop-container]",classLoading:"".concat(e,"--loading ").concat(e,"--loading--small"),classLoadingAnimation:"".concat(e,"--inline-loading__animation"),classLoadingSvg:"".concat(e,"--loading__svg"),classLoadingBackground:"".concat(e,"--loading__background"),classLoadingStroke:"".concat(e,"--loading__stroke"),classFileName:"".concat(e,"--file-filename"),classFileClose:"".concat(e,"--file-close"),classFileComplete:"".concat(e,"--file-complete"),classSelectedFile:"".concat(e,"--file__selected-file"),classStateContainer:"".concat(e,"--file__state-container"),classDragOver:"".concat(e,"--file__drop-container--drag-over"),eventBeforeDeleteFilenameFileuploader:"fileuploader-before-delete-filename",eventAfterDeleteFilenameFileuploader:"fileuploader-after-delete-filename"}}}],(t=[{key:"_filenamesHTML",value:function(e,t){return'<span class="'.concat(this.options.classSelectedFile,'">\n      <p class="').concat(this.options.classFileName,'">').concat(e,'</p>\n      <span data-for="').concat(t,'" class="').concat(this.options.classStateContainer,'"></span>\n    </span>')}},{key:"_uploadHTML",value:function(){return'\n      <div class="'.concat(this.options.classLoadingAnimation,'">\n        <div data-inline-loading-spinner class="').concat(this.options.classLoading,'">\n          <svg class="').concat(this.options.classLoadingSvg,'" viewBox="-75 -75 150 150">\n            <circle class="').concat(this.options.classLoadingBackground,'" cx="0" cy="0" r="37.5" />\n            <circle class="').concat(this.options.classLoadingStroke,'" cx="0" cy="0" r="37.5" />\n          </svg>\n        </div>\n      </div>')}},{key:"_closeButtonHTML",value:function(){return'\n      <button class="'.concat(this.options.classFileClose,'" type="button" aria-label="close">\n      <svg aria-hidden="true" viewBox="0 0 16 16" width="16" height="16">\n      <path fill="#231F20" d="M12 4.7l-.7-.7L8 7.3 4.7 4l-.7.7L7.3 8 4 11.3l.7.7L8 8.7l3.3 3.3.7-.7L8.7 8z"/>\n      </svg>\n      </button>')}},{key:"_checkmarkHTML",value:function(){return'\n      <svg focusable="false"\n        preserveAspectRatio="xMidYMid meet"\n        style="will-change: transform;"\n        xmlns="http://www.w3.org/2000/svg"\n        class="'.concat(this.options.classFileComplete,'"\n        width="16" height="16" viewBox="0 0 16 16"\n        aria-hidden="true">\n        <path d="M8 1C4.1 1 1 4.1 1 8s3.1 7 7 7 7-3.1 7-7-3.1-7-7-7zM7 11L4.3 8.3l.9-.8L7 9.3l4-3.9.9.8L7 11z"></path>\n        <path d="M7 11L4.3 8.3l.9-.8L7 9.3l4-3.9.9.8L7 11z" data-icon-path="inner-path" opacity="0"></path>\n      </svg>\n    ')}},{key:"_getStateContainers",value:function(){var e=m(this.element.querySelectorAll("[data-for=".concat(this.inputId,"]")));if(0===e.length)throw new TypeError("State container elements not found; invoke _displayFilenames() first");if(e[0].dataset.for!==this.inputId)throw new TypeError("File input id must equal [data-for] attribute");return e}},{key:"_displayFilenames",value:function(e){var t=this,n=0<arguments.length&&void 0!==e?e:this.input.files,e=this.element.querySelector(this.options.selectorContainer),n=m(n).map(function(e){return t._filenamesHTML(e.name,t.inputId)}).join("");e.insertAdjacentHTML("afterbegin",n)}},{key:"_removeState",value:function(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)throw new TypeError("DOM element should be given to initialize this widget.");for(;e.firstChild;)e.removeChild(e.firstChild)}},{key:"_handleStateChange",value:function(e,n,o){var a=this;void 0===n?e.forEach(function(e){a._removeState(e),e.insertAdjacentHTML("beforeend",o)}):e.forEach(function(e,t){t===n&&(a._removeState(e),e.insertAdjacentHTML("beforeend",o))})}},{key:"setState",value:function(e,t){var n=this._getStateContainers();"edit"===e&&this._handleStateChange(n,t,this._closeButtonHTML()),"upload"===e&&this._handleStateChange(n,t,this._uploadHTML()),"complete"===e&&this._handleStateChange(n,t,this._checkmarkHTML())}}])&&p(e.prototype,t),n&&p(e,n),i.components=new WeakMap,i}();e.default=n});
function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"function"==typeof define&&define.amd?define(["exports","../../globals/js/misc/mixin","../../globals/js/mixins/create-component","../../globals/js/mixins/init-component-by-search","../../globals/js/mixins/handles","../../globals/js/misc/on","../../globals/js/settings","../../globals/js/misc/event-matches"],t):"undefined"!=typeof exports?t(exports,require("../../globals/js/misc/mixin"),require("../../globals/js/mixins/create-component"),require("../../globals/js/mixins/init-component-by-search"),require("../../globals/js/mixins/handles"),require("../../globals/js/misc/on"),require("../../globals/js/settings"),require("../../globals/js/misc/event-matches")):(t(t={},e.mixin,e.createComponent,e.initComponentBySearch,e.handles,e.on,e.settings,e.eventMatches),e.headerSubmenu=t)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e,c,a,i,s,u,l,f){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,c=void 0;try{for(var a,i=e[Symbol.iterator]();!(r=(a=i.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,c=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(n);return e=r?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==_typeof(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,c=t(c),a=t(a),i=t(i),s=t(s),u=t(u),l=t(l),f=t(f);var _=function(){return Array.prototype.forEach}(),E=function(e){return Array.prototype.slice.call(e)},n=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(o,(0,c.default)(a.default,i.default,s.default));var e,t,n,r=y(o);function o(e,t){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(i=r.call(this,e,t))._getAction=function(e){if((0,f.default)(e,i.options.selectorFlyoutMenu))return i.constructor.actions.DELEGATE_TO_FLYOUT_MENU;switch(e.type){case"keydown":return{32:i.constructor.actions.TOGGLE_SUBMENU_WITH_FOCUS,13:i.constructor.actions.TOGGLE_SUBMENU_WITH_FOCUS,27:i.constructor.actions.CLOSE_SUBMENU}[e.which];case"click":return(0,f.default)(e,i.options.selectorItem)?i.constructor.actions.CLOSE_SUBMENU:null;case"blur":case"focusout":return i.element.contains(e.relatedTarget)?null:i.constructor.actions.CLOSE_SUBMENU;case"mouseenter":return i.constructor.actions.OPEN_SUBMENU;case"mouseleave":return i.constructor.actions.CLOSE_SUBMENU;default:return null}},i._getNewState=function(e){var t="true"===i.element.querySelector(i.options.selectorTrigger).getAttribute(i.options.attribExpanded);switch(e){case i.constructor.actions.CLOSE_SUBMENU:return!1;case i.constructor.actions.OPEN_SUBMENU:return!0;case i.constructor.actions.TOGGLE_SUBMENU_WITH_FOCUS:return!t;default:return t}},i._setState=function(e){var t=e.shouldBeExpanded,e=e.shouldFocusOnOpen;i.element.querySelector(i.options.selectorTrigger).setAttribute(i.options.attribExpanded,t),_.call(i.element.querySelectorAll(i.options.selectorItem),function(e){e.tabIndex=t?0:-1}),t&&e&&i.element.querySelector(i.options.selectorItem).focus()},i.getCurrentNavigation=function(){var e=i.element.ownerDocument.activeElement;return e.nodeType===Node.ELEMENT_NODE&&e.matches(i.options.selectorItem)?e:null},i.navigate=function(c){for(var a=E(i.element.querySelectorAll(i.options.selectorItem)),e=i.getCurrentNavigation()||i.element.querySelector(i.options.selectorItemSelected),t=function(e){var t,n,r,o,e=Math.max(a.indexOf(e)+c,-1);return a[r=e,o=a.length,t=r-(r<o?0:o),n=a.length,t+(0<=t?0:n)]},n=t(e);n&&n!==e;n=t(n))if(!n.matches(i.options.selectorItemHidden)&&!n.parentNode.matches(i.options.selectorItemHidden)&&!n.matches(i.options.selectorItemSelected)){n.focus();break}},i._handleEvent=function(e){!i.element.querySelector(i.options.selectorTrigger)||(e=i._getAction(e))&&(e=i._getNewState(e),i._setState({shouldBeExpanded:e}))},i._handleKeyDown=function(e){var t=i.element.querySelector(i.options.selectorTrigger);if(t){var n=i._getAction(e);switch(32===e.which&&e.preventDefault(),n){case i.constructor.actions.DELEGATE_TO_FLYOUT_MENU:break;case i.constructor.actions.CLOSE_SUBMENU:var r=i._getNewState(n);i._setState({shouldBeExpanded:r});break;case i.constructor.actions.TOGGLE_SUBMENU_WITH_FOCUS:n=i._getNewState(n);i._setState({shouldBeExpanded:n,shouldFocusOnOpen:!0});break;default:if("true"===t.getAttribute(i.options.attribExpanded)){t={38:i.constructor.NAVIGATE.BACKWARD,40:i.constructor.NAVIGATE.FORWARD}[e.which];switch(e.which){case 35:e.preventDefault();var o=i.element.querySelectorAll(i.options.selectorItem),o=o[o.length-1];o&&o.focus();break;case 36:e.preventDefault();o=p(i.element.querySelectorAll(i.options.selectorItem),1)[0];o&&o.focus();break;case 38:case 40:i.navigate(t),e.preventDefault()}}}}};t="onfocusout"in window;return i.manage((0,u.default)(i.element,t?"focusout":"blur",i._handleEvent,!t)),i.manage((0,u.default)(i.element,"mouseenter",i._handleEvent)),i.manage((0,u.default)(i.element,"mouseleave",i._handleEvent)),i.manage((0,u.default)(i.element,"click",i._handleEvent)),i.manage((0,u.default)(i.element,"keydown",i._handleKeyDown)),i}return e=o,n=[{key:"options",get:function(){var e=l.default.prefix;return{selectorInit:"[data-header-submenu]",selectorTrigger:".".concat(e,"--header__menu-title"),selectorItem:".".concat(e,"--header__menu .").concat(e,"--header__menu-item"),attribExpanded:"aria-expanded"}}}],(t=null)&&d(e.prototype,t),n&&d(e,n),o.components=new WeakMap,o.actions={CLOSE_SUBMENU:"CLOSE_SUBMENU",OPEN_SUBMENU:"OPEN_SUBMENU",TOGGLE_SUBMENU_WITH_FOCUS:"TOGGLE_SUBMENU_WITH_FOCUS",DELEGATE_TO_FLYOUT_MENU:"DELEGATE_TO_FLYOUT_MENU"},o.NAVIGATE={BACKWARD:-1,FORWARD:1},o}();e.default=n});
/*! CAF: shared.js
	v12.0.1 (c) 2021 Kyle Simpson
	MIT License: http://getify.mit-license.org
*/
!function UMD(n,i,e,s){"function"==typeof define&&define.amd?(e=Object.values(e),define(n,e,s)):"undefined"!=typeof module&&module.exports?(e=Object.keys(e).map((n=>require(n))),module.exports=s(...e)):(e=Object.values(e).map((n=>i[n])),i[n]=s(...e))}("CAFShared","undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:new Function("return this")(),{},(function DEF(){"use strict";const n=Symbol("Cleanup Function"),i=Symbol("Timeout Token");class e{constructor(i=new AbortController){var e;this.controller=i,this.signal=i.signal;var handleReject=(i,s)=>{var doRej=()=>{if(s){var n=this.signal&&this.signal.reason?this.signal.reason:void 0;s(n),s=null}};this.signal.addEventListener("abort",doRej,!1),e=()=>{this.signal&&(this.signal.removeEventListener("abort",doRej,!1),this.signal.pr&&(this.signal.pr[n]=null)),doRej=null}};this.signal.pr=new Promise(handleReject),this.signal.pr[n]=e,this.signal.pr.catch(e),handleReject=e=null}abort(n){this.signal&&!("reason"in this.signal)&&(this.signal.reason=n),this.controller&&this.controller.abort()}discard(){this.signal&&(this.signal.pr&&(this.signal.pr[n]&&this.signal.pr[n](),this.signal.pr=null),this.signal=this.signal.reason=null),this.controller=null}}let s={};function signalPromise(i){if(i.pr)return i.pr;var e,s=new Promise((function c(n,s){e=()=>s(),i.addEventListener("abort",e,!1)}));return s[n]=function cleanup(){i&&(i.removeEventListener("abort",e,!1),i=null),s&&(s=s[n]=e=null)},s.catch(s[n]),s}function processTokenOrSignal(n){n instanceof AbortController&&(n=new e(n));var i=n&&n instanceof e?n.signal:n;return{tokenOrSignal:n,signal:i,signalPr:signalPromise(i)}}return s={CLEANUP_FN:n,TIMEOUT_TOKEN:i,cancelToken:e,signalPromise:signalPromise,processTokenOrSignal:processTokenOrSignal},s.CLEANUP_FN=n,s.TIMEOUT_TOKEN=i,s.cancelToken=e,s.signalPromise=signalPromise,s.processTokenOrSignal=processTokenOrSignal,s}));
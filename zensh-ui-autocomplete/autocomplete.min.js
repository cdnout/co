"use strict";angular.module("ui.autocomplete",[]).directive("uiAutocomplete",["$timeout","$exceptionHandler",function(e,t){function n(e,t){var n=new RegExp($.ui.autocomplete.escapeRegex(t),"i");return $.grep(e,function(e){return n.test($("<div>").html(e.label||e.value||e).text())})}var o=$.ui.autocomplete.prototype,i=o._initSource,u=Array.prototype.slice;return $.extend(o,{_initSource:function(){this.options.html&&$.isArray(this.options.source)?this.source=function(e,t){t(n(this.options.source,e.term))}:i.call(this)},_normalize:function(e){return $.map(e,function(e){return e&&"object"==typeof e?$.extend({label:e.label||e.value,value:e.value||e.label},e):{label:e+"",value:e}})},_renderItemData:function(e,t){var n=t.groupLabel||t.label;return t.groupLabel?n=$("<div>").append(n).addClass("ui-menu-group"):this.options.html?("object"==typeof n&&(n=$(n)),("object"!=typeof n||n.length>1||!n.is("a"))&&(n=$("<a>").append(n))):n=$("<a>").text(n),$("<li>").append(n).appendTo(e).data("ui-autocomplete-item",t)},_resizeMenu:function(){var e=this;setTimeout(function(){var t=e.menu.element,n=t.css("max-height")||0,o=Math.max(t.width("").outerWidth()+1,e.element.outerWidth()),i=(e.element.height(),$(window).height()-e.options.outHeight-t.offset().top);i=n&&i>n?n:i,t.css({width:o,maxHeight:i})},10)}}),{require:"ngModel",link:function(o,i,a,l){function r(e){h(d)&&(l.$viewValue||0===l.$viewValue?e&&e.item&&(e.item.label=h(e.item.label)?$("<div>").append(e.item.label).html():e.item.label,v(d,e.item)):c(d),m(l.$viewChangeListeners,function(e){try{e()}catch(e){t(e)}}))}function c(e){if(h(e)){var t=/^\$/;m(e,function(n,o){var i=typeof n;t.test(o)||("number"===i?e[o]=0:"string"===i?e[o]="":"boolean"===i?e[o]=!1:h(n)&&c(n))})}}var s=!1,p=null,f={},d=null,m=angular.forEach,h=angular.isObject,v=angular.extend,g=o.$eval(a.uiAutocomplete),b=angular.bind(i,i.val),w=o.$watch(a.ngModel,function(e){h(d=e)&&(l.$formatters.push(function(e){return e.value}),l.$parsers.push(function(e){return d.value=e,d}),o.$watch(a.ngModel,function(e){b()!==e.value&&(l.$viewValue=e.value,l.$render())},!0),l.$pristine=!1,l.$setViewValue(d.value),l.$pristine=!0),e&&w()}),y={open:function(e,t){s=!0,p=null},close:function(e,t){s=!1},select:function(t,n){p=n,e(function(){i.blur()},0)},change:function(e,t){var n=b(),i=!1;p&&p.item&&-1!==n.indexOf(p.item.value)&&(n=p.item.value,i=!0),o.$apply(function(){g.options.onlySelectValid&&l.$setValidity("onlyselect",i),null===n?l.$render():""===n?r():l.$viewValue!==n&&(l.$setViewValue(n),l.$render(),r(p))})}};h(g)&&(g.methods={},g.options=function(e){return e=h(e)?e:{},e.disabled=!e.source||e.disabled,e.appendTo=e.appendTo||i.parents(".ng-view")[0]||i.parents("[ng-view]")[0]||null,e.minLength=e.focusOpen?0:e.minLength,e.outHeight=e.outHeight||0,e.position=e.position||{my:"left top",at:"left bottom",collision:"flipfit"},e}(g.options),m(["change","close","create","focus","open","response","search","select"],function(e){var t=g.options[e];t="function"==typeof t?t:angular.noop,f[e]=function(n,o){y[e]&&y[e](n,o),t(n,o),g.events&&"function"==typeof g.events[e]&&g.events[e](n,o)}}),m(["close","destroy","disable","enable","instance","option","search","widget"],function(e){g.methods[e]=function(){var t=u.call(arguments);return t.unshift(e),i.autocomplete.apply(i,t)}}),g.methods.filter=n,g.methods.clean=function(){l.$setViewValue(""),l.$render(),r()},i.on("focus",function(){g.options.focusOpen&&!s&&i.autocomplete("search","")}),i.autocomplete(v({},g.options,f)),g.widget=i.autocomplete("widget"))}}}]);
!function(e,t,o){"use strict";function i(e,t){var o=!1;return function(){o||(e.call(),o=!0,setTimeout(function(){o=!1},t))}}function n(o){document.contains(re[0])&&!o||(G&&re.hide(),Q.on("touchstart.testMouse",function(){Q.off("touchstart.testMouse"),V=!0,re.addClass("mobile")}),Y.off().on("click",z.toggle),j.off().on("click","a",O.click),K&&re.addClass("msie"),re.off().on("click","img",function(e){e.stopPropagation()}),e(t.body).append(re),H=t.documentElement)}function s(e,t,o){1==t?(S.css({transform:"translateX(25%)",transition:".2s",opacity:0}),setTimeout(function(){E(L)},200)):-1==t&&(S.css({transform:"translateX(-25%)",transition:".2s",opacity:0}),setTimeout(function(){E(D)},200)),1==o?R.prop("checked",!0):-1==o&&R.prop("checked",!1)}function a(e){var o,i=t.createElement("p").style,n=["ms","O","Moz","Webkit"];if(""==i[e])return e;for(e=e.charAt(0).toUpperCase()+e.slice(1),o=n.length;o--;)if(""==i[n[o]+e])return n[o]+e}function r(t){var o=t.keyCode,i=x.keys;return e.inArray(o,i.close)>=0&&w()||e.inArray(o,i.next)>=0&&!x.single&&h(D)||e.inArray(o,i.prev)>=0&&!x.single&&h(L)||!0}function l(e,t,o){1==o?h(D):-1==o&&h(L)}function c(){var e="pbPrevBtn"==this.id?L:D;return h(e),!1}function u(e){T=U,U=e,k=_[e][0],L=(U||(x.loop?_.length:0))-1,D=(U+1)%_.length||(x.loop?0:-1)}function h(e){if(!x.loop){var t=U==_.length-1&&e==D,o=0==U&&e==L;if(t||o)return}E(e)}function d(){var t=_[U][0],o=e("<a>").prop("href",_[U][0])[0].search?"&":"?";return t+=o+"vq=hd720&wmode=opaque",e("<iframe>").prop({scrolling:"no",frameborder:0,allowTransparency:!0,src:t}).attr({webkitAllowFullScreen:!0,mozallowfullscreen:!0,allowFullScreen:!0})}function p(){var e;N.off(te).removeClass("change"),x.captionTmpl&&(e=x.captionTmpl.replace(/{title}/g,_[U][1]).replace(/{currentImageIdx}/g,U+1).replace(/{totalImagesCount}/g,_.length),N.html(e))}function f(){re.addClass("error"),S[0].src=$,ie.onerror=null}function m(t){function o(){q.removeAttr("style"),clearTimeout(n),re.removeClass("video"),"video"==M?(S.attr("src",$),i.off(te).css({transition:"none"}),B.addClass("prepare"),re.addClass("video")):S.replaceWith(S=e('<img src="'+k+'" class="prepare">')),setTimeout(function(){re.removeClass("pbHide next prev"),S.add(B).removeAttr("style").removeClass("prepare").on(te,v),K&&v()},50)}var i,n;n=setTimeout(o,2e3),W.fadeOut(300,function(){re.removeClass("pbLoading"),W.removeAttr("style")}),re.addClass("pbHide"),S.add(B).removeClass("zoomable"),t||"video"!=A[T].rel?i=S:(i=B,S.addClass("prepare")),t||K?o():i.on(te,o)}function v(){S.add(B).off(te).addClass("zoomable"),"video"==M?B.removeClass("pbHide"):Y&&x.autoplay&&z.play(),C&&"function"==typeof C.callback&&C.callback(A[U])}function g(e,t){e.preventDefault(),e.stopPropagation();var o,i=C.thumbsList;i.css("height",i[0].clientHeight+10*t),o=X[0].clientHeight/2,q[0].style.cssText="margin-top: -"+o+"px; padding: "+o+"px 0;",j.hide().show(0)}function b(){clearTimeout(z.autoPlayTimer),Q.off("mousemove.photobox"),ie.onload=function(){},ie.src=ne.src=se.src=k}function w(){function t(){""!=re[0].className&&(re.removeClass("show pbHide error pbLoading"),S.removeAttr("class").removeAttr("style").off().data("zoom",1),S[0].src=$,X.find(".title").empty(),G&&setTimeout(function(){re.hide()},200),x.hideFlash&&e("iframe, object, embed").css("visibility","visible"))}return re.hasClass("show")?(b(),B.find("iframe").prop("src","").empty(),y.prototype.setup(),le.clear(),re.removeClass("on video").addClass("pbHide"),U=-1,S.on(te,t),K&&t(),setTimeout(function(){C=null},1e3),setTimeout(t,500),void("function"==typeof x.afterClose&&x.afterClose(re))):!1}var y,C,x,A,k,T,M,L,D,O,H,z,E,P,S,B,I,F,R,X,N,W,Y,j,q,_=[],U=-1,Q=e(t),Z=e(o),K=!("placeholder"in t.createElement("input")),G=function(){var t=e("<p>")[0];return t.style.cssText="pointer-events:auto",!t.style.pointerEvents}(),V=!1,J=e(),$="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",ee=(a("transformOrigin"),a("transition")),te="transitionend webkitTransitionEnd oTransitionEnd otransitionend",oe=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},ie={},ne=new Image,se=new Image,ae={single:!1,beforeShow:null,afterClose:null,loop:!0,thumb:null,thumbs:!0,thumbAttr:"data-src",captionTmpl:'<div class="title">{title}</div><div class="counter">({currentImageIdx}/{totalImagesCount})</div>',autoplay:!1,time:3e3,history:!1,hideFlash:!0,zoomable:!0,rotatable:!0,wheelNextPrev:!0,keys:{close:[27,88,67],prev:[37,80],next:[39,78]}},re=e('<div id="pbOverlay">').append(R=e('<input type="checkbox" id="pbThumbsToggler" checked hidden>'),W=e('<div class="pbLoader"><b></b><b></b><b></b></div>'),I=e('<div id="pbPrevBtn" class="prevNext"><b></b></div>').on("click",c),F=e('<div id="pbNextBtn" class="prevNext"><b></b></div>').on("click",c),q=e('<div class="pbWrapper">').append(S=e("<img>"),B=e('<div class="pbVideo">')),P=e('<div id="pbCloseBtn">').on("click",w)[0],Y=e('<div id="pbAutoplayBtn">').append(e('<div class="pbProgress">')),X=e('<div id="pbCaption">').append('<label for="pbThumbsToggler" title="Show/hide thumbnails"></label>','<button title="Rotate right" class="rotateBtn">&#10227;</button>',N=e('<div class="pbCaptionText">'),j=e("<div>").addClass("pbThumbs")));e.fn.photobox=function(t,o,i){return n(),this.each(function(){var s=e(this).data("_photobox");return s?("destroy"===t&&s.destroy(),this):("string"!=typeof t&&(t="a"),"prepareDOM"===t?(n(!0),this):(o=e.extend({},ae,o||{}),C=new y(o,this,t),e(this).data("_photobox",C),void(C.callback=i)))})},y=function(o,i,n){this.options=e.extend({},o),this.target=n,this.selector=e(i||t),this.thumbsList=null;var s=this.imageLinksFilter(this.selector.find(n));this.imageLinks=s[0],this.images=s[1],this.init()},y.prototype={init:function(){this.DOM=this.DOM(),this.DOM.rotateBtn.toggleClass("show",this.options.rotatable),this.observerTimeout=null,this.events.binding.call(this)},DOM:function(){var e={};return e.scope=re,e.rotateBtn=e.scope.find(".rotateBtn"),e},observeDOM:function(){var t=o.MutationObserver||o.WebKitMutationObserver,i=o.addEventListener;return function(o,n){if(t){var s=this,a=new t(function(e,t){(e[0].addedNodes.length||e[0].removedNodes.length)&&n(s)});a.observe(o,{childList:!0,subtree:!0})}else i&&(o.addEventListener("DOMNodeInserted",e.proxy(n,s),!1),o.addEventListener("DOMNodeRemoved",e.proxy(n,s),!1))}}(),open:function(t){var o=e.inArray(t,this.imageLinks);return-1==o?!1:(x=this.options,_=this.images,A=this.imageLinks,C=this,this.setup(1),re.on(te,function(){re.off(te).addClass("on"),E(o,!0)}).addClass("show"),K&&re.trigger("MSTransitionEnd"),!1)},imageLinksFilter:function(t){function o(t){var o,r=e(this),l="";return a.content=r[0].getAttribute("title")||"",n.options.thumb&&(o=r.find(n.options.thumb)[0]),n.options.thumb&&o||(o=r.find("img")[0]),o&&(i=o.getAttribute("data-pb-captionlink"),l=o.getAttribute(n.options.thumbAttr)||o.getAttribute("src"),a.content=o.getAttribute("alt")||o.getAttribute("title")||""),i&&(i=i.split("["),2==i.length?(a.linkText=i[0],a.linkHref=i[1].slice(0,-1)):(a.linkText=i,a.linkHref=i),a.content+=' <a href="'+a.linkHref+'">'+a.linkText+"</a>"),s.push([r[0].href,a.content,l]),!0}var i,n=this,s=[],a={};return[t.filter(o),s]},setup:function(t){var o=t?"on":"off";x.thumbs&&(V||j[o]("mouseenter.photobox",O.calc)[o]("mousemove.photobox",O.move)),t?(S.css({transition:"0s"}).removeAttr("style"),re.show(),j.html(this.thumbsList).trigger("mouseenter.photobox"),x.thumbs?re.addClass("thumbs"):(R.prop("checked",!1),re.removeClass("thumbs")),this.images.length<2||x.single?re.removeClass("thumbs hasArrows hasCounter hasAutoplay"):(re.addClass("hasArrows hasCounter"),x.time>1e3?(re.addClass("hasAutoplay"),x.autoplay?z.progress.start():z.pause()):re.removeClass("hasAutoplay")),x.hideFlash&&e("iframe, object, embed").css("visibility","hidden")):Z.off("resize.photobox"),Q.off("keydown.photobox")[o]({"keydown.photobox":r}),V&&(re.removeClass("hasArrows"),q[o]("swipe",s)),x.zoomable&&(re[o]({"mousewheel.photobox":e.proxy(this.events.callbacks.onScrollZoom,this)}),K||j[o]({"mousewheel.photobox":g})),!x.single&&x.wheelNextPrev&&re[o]({"mousewheel.photobox":i(l,1e3)})},destroy:function(){x=this.options,this.selector.off("click.photobox",this.target).removeData("_photobox"),w()},events:{binding:function(){var t=this;this.selector.one("mouseenter.photobox",this.target,function(e){t.thumbsList=O.generate.apply(t)}),this.selector.on("click.photobox",this.target,function(e){e.preventDefault(),t.open(this)}),K||1!=this.selector[0].nodeType||this.observeDOM(this.selector[0],e.proxy(this.events.callbacks.onDOMchanges,this)),this.DOM.rotateBtn.on("click",this.events.callbacks.onRotateBtnClick)},callbacks:{onDOMchanges:function(){var e=this;clearTimeout(this.observerTimeout),e.observerTimeout=setTimeout(function(){var t,o=e.imageLinksFilter(e.selector.find(e.target)),i=0,n=!1;if(e.imageLinks.length!=o[0].length){if(e.imageLinks=o[0],e.images=o[1],C&&e.selector==C.selector)for(_=e.images,A=e.imageLinks,t=_.length;t--;)_[t][0]==k&&(n=!0);e.thumbsList=O.generate.apply(e),j.html(e.thumbsList),e.images.length&&k&&e.options.thumbs&&(i=e.thumbsList.find('a[href="'+k+'"]').eq(0).parent().index(),-1==i&&(i=0),O.changeActive(i,0))}},50)},onRotateBtnClick:function(){var e=S.data("rotation")||0,t=S.data("zoom")||1;e+=90,S.removeClass("zoomable").addClass("rotating"),S.css("transform","rotate("+e+"deg) scale("+t+")").data("rotation",e).on(te,function(){S.addClass("zoomable").removeClass("rotating")})},onScrollZoom:function(e,t,o){if(o)return!1;var i=this;if("video"==M){var n=B.data("zoom")||1;if(n+=t/10,.5>n)return!1;B.data("zoom",n).css({width:624*n,height:351*n})}else oe(function(){var e,o=S.data("zoom")||1,n=S.data("rotation")||0,s=S.data("position")||"50% 50%",a=S[0].getBoundingClientRect();o+=t/10,.1>o&&(o=.1),S.data("zoom",o),e="scale("+o+") rotate("+n+"deg)",a.height>H.clientHeight||a.width>H.clientWidth?(Q.on("mousemove.photobox",i.events.callbacks.onMouseMoveimageReposition),e+=" translate("+s+")"):Q.off("mousemove.photobox"),S.css({transform:e})});return!1},onMouseMoveimageReposition:function(e){oe(function(){var t,o=1.5,i=(e.clientY/H.clientHeight*100-50)/o,n=(e.clientX/H.clientWidth*100-50)/o,s=S.data("rotation")||0,a=s/90%4||0,r=S.data("zoom")||1;t=1==a||3==a?i.toFixed(2)+"%, "+-n.toFixed(2)+"%":n.toFixed(2)+"%, "+i.toFixed(2)+"%",S.data("position",t),S[0].style.transform="rotate("+s+"deg) scale("+r+") translate("+t+")"})}}}},O=function(){var t,o,i,n,s=0,a=0,r=0,l=0,c=null;return{generate:function(){var t,o,i,n,s,a=e("<ul>"),r=[],l=this.imageLinks.length;for(s=0;l>s;s++)i=this.imageLinks[s],o=this.images[s][2],o&&(t=this.images[s][1],n=i.rel?" class='"+i.rel+"'":"",r.push("<li"+n+'><a href="'+i.href+'"><img src="'+o+'" alt="" title="'+t+'" /></a></li>'));return a.html(r.join("")),a},click:function(t){t.preventDefault(),J.removeClass("active"),J=e(this).parent().addClass("active");var o=e(this.parentNode).index();return E(o,0,1)},changeActiveTimeout:null,changeActive:function(e,t,o){if(x.thumbs){J.index();J.removeClass("active"),J=j.find("li").eq(e).addClass("active"),!o&&J[0]&&(clearTimeout(this.changeActiveTimeout),this.changeActiveTimeout=setTimeout(function(){var e=J[0].offsetLeft+J[0].clientWidth/2-H.clientWidth/2;t?j.delay(800):j.stop(),j.animate({scrollLeft:e},500,"swing")},200))}},calc:function(e){return o=j[0],s=o.clientWidth,a=o.scrollWidth,t=.15*s,r=j.offset().left,l=e.pageX-t-r,n=l/(s-2*t),i=(a-s)*n,j.animate({scrollLeft:i},200),clearTimeout(c),c=setTimeout(function(){c=null},200),this},move:function(e){if(!c){var i,n,l=e.pageX-t-r;0>l&&(l=0),i=l/(s-2*t),n=(a-s)*i,oe(function(){o.scrollLeft=n})}}}}(),z={autoPlayTimer:!1,play:function(){z.autoPlayTimer=setTimeout(function(){E(D)},x.time),z.progress.start(),Y.removeClass("play"),z.setTitle("Click to stop autoplay"),x.autoplay=!0},pause:function(){clearTimeout(z.autoPlayTimer),z.progress.reset(),Y.addClass("play"),z.setTitle("Click to resume autoplay"),x.autoplay=!1},progress:{reset:function(){Y.find("div").removeAttr("style"),setTimeout(function(){Y.removeClass("playing")},200)},start:function(){K||Y.find("div").css(ee,x.time+"ms"),Y.addClass("playing")}},setTitle:function(e){e&&Y.prop("title",e+" (every "+x.time/1e3+" seconds)")},toggle:function(e){e.stopPropagation(),z[x.autoplay?"pause":"play"]()}},E=function(){var e;return function(t,o,i){if(!e){if(e=setTimeout(function(){e=null},150),Q.off("mousemove.photobox"),(!t||0>t)&&(t=0),x.loop||(F.toggleClass("pbHide",t==_.length-1),I.toggleClass("pbHide",0==t)),"function"==typeof x.beforeShow&&x.beforeShow(A[t]),re.removeClass("error"),U>=0&&re.addClass(t>U?"next":"prev"),u(t),b(),B.empty(),ie.onerror=null,S.add(B).data("zoom",1),M="video"==A[t].rel?"video":"image","video"==M)B.html(d()).addClass("pbHide"),m(o);else{var n=setTimeout(function(){re.addClass("pbLoading")},50);K&&re.addClass("pbHide"),x.autoplay&&z.progress.reset(),ie=new Image,ie.onload=function(){ie.onload=null,L>=0&&(ne.src=_[L][0]),D>=0&&(se.src=_[D][0]),clearTimeout(n),m(o)},ie.onerror=f,ie.src=k}N.on(te,p).addClass("change"),(o||K)&&p(),O.changeActive(t,o,i),le.save()}}}();var le={save:function(){"pushState"in window.history&&decodeURIComponent(window.location.hash.slice(1))!=k&&x.history&&window.history.pushState("photobox",t.title+"-"+_[U][1],window.location.pathname+window.location.search+"#"+encodeURIComponent(k))},load:function(){if(x&&!x.history)return!1;var t=decodeURIComponent(window.location.hash.slice(1));!t&&re.hasClass("show")&&w(),e('a[href="'+t+'"]').trigger("click.photobox")},clear:function(){x.history&&"pushState"in window.history&&window.history.pushState("photobox",t.title,window.location.pathname+window.location.search)}};window.onpopstate=function(){var e=window.onpopstate;return function(t){e&&e.apply(this,arguments),"photobox"==t.state&&le.load()}}(),e.event.special.swipe={setup:function(){e(this).bind("touchstart",e.event.special.swipe.handler)},teardown:function(){e(this).unbind("touchstart",e.event.special.swipe.handler)},handler:function(t){function o(){u.removeEventListener("touchmove",i),n=s=null}function i(i){i.preventDefault();var r=n-i.touches[0].pageX,h=s-i.touches[0].pageY;return Math.abs(r)>=20?(o(),l=r>0?-1:1):Math.abs(h)>=20&&(o(),c=h>0?1:-1),t.type="swipe",a.unshift(t,l,c),(e.event.dispatch||e.event.handle).apply(u,a)}var n,s,a=[].slice.call(arguments,1),r=t.originalEvent.touches,l=0,c=0,u=this;t=e.event.fix(t),1==r.length&&(n=r[0].pageX,s=r[0].pageY,this.addEventListener("touchmove",i,!1))}},!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var a=t||window.event,r=l.call(arguments,1),c=0,h=0,d=0,p=0,f=0,m=0;if(t=e.event.fix(a),t.type="mousewheel","detail"in a&&(d=-1*a.detail),"wheelDelta"in a&&(d=a.wheelDelta),"wheelDeltaY"in a&&(d=a.wheelDeltaY),"wheelDeltaX"in a&&(h=-1*a.wheelDeltaX),"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(h=-1*d,d=0),c=0===d?h:d,"deltaY"in a&&(d=-1*a.deltaY,c=d),"deltaX"in a&&(h=a.deltaX,0===d&&(c=-1*h)),0!==d||0!==h){if(1===a.deltaMode){var v=e.data(this,"mousewheel-line-height");c*=v,d*=v,h*=v}else if(2===a.deltaMode){var g=e.data(this,"mousewheel-page-height");c*=g,d*=g,h*=g}if(p=Math.max(Math.abs(d),Math.abs(h)),(!s||s>p)&&(s=p,i(a,p)&&(s/=40)),i(a,p)&&(c/=40,h/=40,d/=40),c=Math[c>=1?"floor":"ceil"](c/s),h=Math[h>=1?"floor":"ceil"](h/s),d=Math[d>=1?"floor":"ceil"](d/s),u.settings.normalizeOffset&&this.getBoundingClientRect){var b=this.getBoundingClientRect();f=t.clientX-b.left,m=t.clientY-b.top}return t.deltaX=h,t.deltaY=d,t.deltaFactor=s,t.offsetX=f,t.offsetY=m,t.deltaMode=0,r.unshift(t,c,h,d),n&&clearTimeout(n),n=setTimeout(o,200),(e.event.dispatch||e.event.handle).apply(this,r)}}function o(){s=null}function i(e,t){return u.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var n,s,a=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var c=a.length;c;)e.event.fixHooks[a[--c]]=e.event.mouseHooks;var u=e.event.special.mousewheel={version:"3.1.11",setup:function(){if(this.addEventListener)for(var o=r.length;o;)this.addEventListener(r[--o],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",u.getLineHeight(this)),e.data(this,"mousewheel-page-height",u.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var o=r.length;o;)this.removeEventListener(r[--o],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var o=e(t)["offsetParent"in e.fn?"offsetParent":"parent"]();return o.length||(o=e("body")),parseInt(o.css("fontSize"),10)},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),window._photobox={DOM:{overlay:re},close:w,history:le,defaults:ae}}(jQuery,document,window);
//# sourceMappingURL=jquery.photobox.min.js.map
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(u){"use strict";var g=/^(\s*)(>[> ]*|[*+-] \[[x ]\]\s|[*+-]\s|(\d+)([.)]))(\s*)/,p=/^(\s*)(>[> ]*|[*+-] \[[x ]\]|[*+-]|(\d+)[.)])(\s*)$/,h=/[*+-]\s/;u.commands.newlineAndIndentContinueMarkdownList=function(e){if(e.getOption("disableInput"))return u.Pass;for(var n=e.listSelections(),t=[],i=0;i<n.length;i++){var r=n[i].head,o=e.getStateAfter(r.line),l=u.innerMode(e.getMode(),o);if("markdown"!==l.mode.name)return void e.execCommand("newlineAndIndent");var s,a,c=!1!==(o=l.state).list,d=0!==o.quote,f=e.getLine(r.line),l=g.exec(f),o=/^\s*$/.test(f.slice(0,r.ch));if(!n[i].empty()||!c&&!d||!l||o)return void e.execCommand("newlineAndIndent");p.test(f)?(s=d&&/>\s*$/.test(f),a=!/>\s*$/.test(f),(s||a)&&e.replaceRange("",{line:r.line,ch:0},{line:r.line,ch:r.ch+1}),t[i]="\n"):(f=l[1],s=l[5],l=(a=!(h.test(l[2])||0<=l[2].indexOf(">")))?parseInt(l[3],10)+1+l[4]:l[2].replace("x"," "),t[i]="\n"+f+l+s,a&&function(e,n){var t=n.line,i=0,r=0,o=g.exec(e.getLine(t)),l=o[1];do{var s=t+(i+=1),a=e.getLine(s),c=g.exec(a);if(c){var d=c[1],f=parseInt(o[3],10)+i-r,u=parseInt(c[3],10),p=u;if(l!==d||isNaN(u)){if(l.length>d.length)return;if(l.length<d.length&&1===i)return;r+=1}else f===u&&(p=u+1),u<f&&(p=1+f),e.replaceRange(a.replace(g,d+p+c[4]+c[5]),{line:s,ch:0},{line:s,ch:a.length})}}while(c)}(e,r))}e.replaceSelections(t)}});
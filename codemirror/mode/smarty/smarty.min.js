!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(i){"use strict";i.defineMode("smarty",function(e,t){var p,c=t.rightDelimiter||"}",h=t.leftDelimiter||"{",b=t.version||2,k=i.getMode(e,t.baseMode||"null"),l=["debug","extends","function","include","literal"],u={operatorChars:/[+\-*&%=<>!?]/,validIdentifier:/[a-zA-Z0-9_]/,stringChar:/['"]/};function m(e,t){for(var r,i,n,a,o,f,l,u=e.string,s=e.pos;;){var d=u.indexOf(h,s),s=d+h.length;if(-1==d||(r=e,null==(i=d+h.length)&&(i=r.pos),3!==b||"{"!=h||i!=r.string.length&&!/\s/.test(r.string.charAt(i))))break}if(d==e.pos)return e.match(h),e.eat("*")?(n=e,f="comment",l="*"+c,o=function(e,t){for(;!e.eol();){if(e.match(l)){t.tokenize=m;break}e.next()}return f},((a=t).tokenize=o)(n,a)):(t.depth++,t.tokenize=g,p="startTag","tag");-1<d&&(e.string=u.slice(0,d));t=k.token(e,t.base);return-1<d&&(e.string=u),t}function g(e,t){if(e.match(c,!0))return 3===b?(t.depth--,t.depth<=0&&(t.tokenize=m)):t.tokenize=m,p=null,"tag";if(e.match(h,!0))return t.depth++,p="startTag","tag";var r=e.next();if("$"==r)return e.eatWhile(u.validIdentifier),p="variable","variable-2";if("|"==r)return p="pipe","operator";if("."==r)return p="property","operator";if(u.stringChar.test(r))return t.tokenize=(a=r,function(e,t){for(var r,i=null;!e.eol();){if(r=e.peek(),e.next()==a&&"\\"!==i){t.tokenize=g;break}i=r}return"string"}),p="string";if(u.operatorChars.test(r))return e.eatWhile(u.operatorChars),p="operator";if("["==r||"]"==r)return p="bracket";if("("==r||")"==r)return p="operator","bracket";if(/\d/.test(r))return e.eatWhile(/\d/),p="number";if("variable"==t.last){if("@"==r)return e.eatWhile(u.validIdentifier),p="property";if("|"==r)return e.eatWhile(u.validIdentifier),p="modifier","qualifier"}else{if("pipe"==t.last)return e.eatWhile(u.validIdentifier),p="modifier","qualifier";if("whitespace"==t.last)return e.eatWhile(u.validIdentifier),p="modifier","attribute"}if("property"==t.last)return e.eatWhile(u.validIdentifier),p=null,"property";if(/\s/.test(r))return p="whitespace",null;var i="";"/"!=r&&(i+=r);for(var n;n=e.eat(u.validIdentifier);)i+=n;for(var a,o=0,f=l.length;o<f;o++)if(l[o]==i)return p="keyword";return/\s/.test(r)?null:p="tag"}return{startState:function(){return{base:i.startState(k),tokenize:m,last:null,depth:0}},copyState:function(e){return{base:i.copyState(k,e.base),tokenize:e.tokenize,last:e.last,depth:e.depth}},innerMode:function(e){if(e.tokenize==m)return{mode:k,state:e.base}},token:function(e,t){e=t.tokenize(e,t);return t.last=p,e},indent:function(e,t,r){return e.tokenize==m&&k.indent?k.indent(e.base,t,r):i.Pass},blockCommentStart:h+"*",blockCommentEnd:"*"+c}}),i.defineMIME("text/x-smarty","smarty")});
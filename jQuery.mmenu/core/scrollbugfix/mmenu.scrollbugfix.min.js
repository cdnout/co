import Mmenu from"./../oncanvas/mmenu.oncanvas";import options from"./_options";import{extendShorthandOptions}from"./_options";import*as DOM from"../../_modules/dom";import*as support from"../../_modules/support";import{extend,touchDirection}from"../../_modules/helpers";Mmenu.options.scrollBugFix=options;export default function(){var o=this;if(support.touch&&this.opts.offCanvas&&this.opts.offCanvas.blockUI){var t=extendShorthandOptions(this.opts.scrollBugFix);if(this.opts.scrollBugFix=extend(t,Mmenu.options.scrollBugFix),t.fix){var e=touchDirection(this.node.menu);this.node.menu.addEventListener("scroll",n,{passive:!1}),this.node.menu.addEventListener("touchmove",function(o){var t=o.target.closest(".mm-panel, .mm-iconbar__top, .mm-iconbar__bottom");t&&t.closest(".mm-listitem_vertical")&&(t=DOM.parents(t,".mm-panel").pop()),t?t.scrollHeight===t.offsetHeight?n(o):(0==t.scrollTop&&"down"==e.get()||t.scrollHeight==t.scrollTop+t.offsetHeight&&"up"==e.get())&&n(o):n(o)},{passive:!1}),this.bind("open:start",function(){var t=DOM.children(o.node.pnls,".mm-panel_opened")[0];t&&(t.scrollTop=0)}),window.addEventListener("orientationchange",function(t){var e=DOM.children(o.node.pnls,".mm-panel_opened")[0];e&&(e.scrollTop=0,e.style["-webkit-overflow-scrolling"]="auto",e.style["-webkit-overflow-scrolling"]="touch")})}}function n(o){o.preventDefault(),o.stopPropagation()}};
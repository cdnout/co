import Mmenu from"./../../core/oncanvas/mmenu.oncanvas";import options from"./_options";import{extendShorthandOptions}from"./_options";import*as DOM from"../../_modules/dom";import{extend}from"../../_modules/helpers";Mmenu.options.autoHeight=options;export default function(){var t=this,e=extendShorthandOptions(this.opts.autoHeight);if(this.opts.autoHeight=extend(e,Mmenu.options.autoHeight),"auto"==e.height||"highest"==e.height){var n,i=(n=function(t){return t.parentElement.matches(".mm-listitem_vertical")&&(t=DOM.parents(t,".mm-panel").filter(function(t){return!t.parentElement.matches(".mm-listitem_vertical")})[0]),t},function(){if(!t.opts.offCanvas||t.vars.opened){var i,o,s=0,h=t.node.menu.offsetHeight-t.node.pnls.offsetHeight;t.node.menu.classList.add("mm-menu_autoheight-measuring"),"auto"==e.height?((o=DOM.children(t.node.pnls,".mm-panel_opened")[0])&&(o=n(o)),o||(o=DOM.children(t.node.pnls,".mm-panel")[0]),s=o.scrollHeight):"highest"==e.height&&(i=0,DOM.children(t.node.pnls,".mm-panel").forEach(function(t){t=n(t),i=Math.max(i,t.scrollHeight)}),s=i),t.node.menu.style.height=s+h+"px",t.node.menu.classList.remove("mm-menu_autoheight-measuring")}});this.bind("initMenu:after",function(){t.node.menu.classList.add("mm-menu_autoheight")}),this.opts.offCanvas&&this.bind("open:start",i),"highest"==e.height&&this.bind("initPanels:after",i),"auto"==e.height&&(this.bind("updateListview",i),this.bind("openPanel:start",i))}};
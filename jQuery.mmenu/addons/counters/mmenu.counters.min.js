import Mmenu from"../../core/oncanvas/mmenu.oncanvas";import options from"./_options";import{extendShorthandOptions}from"./_options";import*as DOM from"../../_modules/dom";import{extend}from"../../_modules/helpers";Mmenu.options.counters=options,Mmenu.configs.classNames.counters={counter:"Counter"};export default function(){var n=this,t=extendShorthandOptions(this.opts.counters);if(this.opts.counters=extend(t,Mmenu.options.counters),this.bind("initListview:after",function(t){var e=n.conf.classNames.counters.counter;DOM.find(t,"."+e).forEach(function(n){DOM.reClass(n,e,"mm-counter")})}),t.add&&this.bind("initListview:after",function(n){if(n.matches(t.addTo)){var e=n.closest(".mm-panel").mmParent;if(e&&!DOM.find(e,".mm-counter").length){var o=DOM.children(e,".mm-btn")[0];o&&o.prepend(DOM.create("span.mm-counter"))}}}),t.count){var e=function(t){(t?[t.closest(".mm-panel")]:DOM.children(n.node.pnls,".mm-panel")).forEach(function(n){var t=n.mmParent;if(t){var e=DOM.find(t,".mm-counter")[0];if(e){var o=[];DOM.children(n,".mm-listview").forEach(function(n){o.push.apply(o,DOM.children(n))}),e.innerHTML=DOM.filterLI(o).length.toString()}}})};this.bind("initListview:after",e),this.bind("updateListview",e)}};
var bind,unbind,schedule,activeElement,opts=window.syn?window.syn:{},extend=function(e,t){var n;for(n in t)e[n]=t[n];return e},browser={msie:!(!window.attachEvent||window.opera)||-1<navigator.userAgent.indexOf("Trident/"),opera:!!window.opera,webkit:-1<navigator.userAgent.indexOf("AppleWebKit/"),safari:-1<navigator.userAgent.indexOf("AppleWebKit/")&&-1===navigator.userAgent.indexOf("Chrome/"),gecko:-1<navigator.userAgent.indexOf("Gecko"),mobilesafari:!!navigator.userAgent.match(/Apple.*Mobile.*Safari/),rhino:navigator.userAgent.match(/Rhino/)&&!0,chrome:!!window.chrome&&!!window.chrome.webstore},createEventObject=function(e,t,n){var i=n.ownerDocument.createEventObject();return extend(i,t)},data={},id=1,expando="_synthetic"+(new Date).getTime(),key=/keypress|keyup|keydown/,page=/load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll/,syn=function(e,t,n,i){return new syn.init(e,t,n,i)};syn.config=opts,syn.__tryFocus=function(e){try{e.focus()}catch(e){}},bind=function(e,t,n){return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},unbind=function(e,t,n){return e.addEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)},schedule=syn.config.schedule||function(e,t){setTimeout(e,t)},extend(syn,{init:function(e,t,n,i){var o=syn.args(n,t,i),r=this;this.queue=[],this.element=o.element,"function"==typeof this[e]?this[e](o.element,o.options,function(e,t){o.callback&&o.callback.apply(r,arguments),r.done.apply(r,arguments)}):(this.result=syn.trigger(o.element,e,o.options),o.callback&&o.callback.call(this,o.element,this.result))},jquery:function(e,t){return window.FuncUnit&&window.FuncUnit.jQuery?window.FuncUnit.jQuery:e&&syn.helpers.getWindow(e).jQuery||window.jQuery},args:function(){for(var e={},t=0;t<arguments.length;t++)"function"==typeof arguments[t]?e.callback=arguments[t]:arguments[t]&&arguments[t].jquery?e.element=arguments[t][0]:arguments[t]&&arguments[t].nodeName?e.element=arguments[t]:e.options&&"string"==typeof arguments[t]?e.element=document.getElementById(arguments[t]):arguments[t]&&(e.options=arguments[t]);return e},click:function(e,t,n){syn("click!",e,t,n)},defaults:{focus:function(){var t,e;syn.support.focusChanges||(e=(t=this).nodeName.toLowerCase(),syn.data(t,"syntheticvalue",t.value),"input"!==e&&"textarea"!==e||bind(t,"blur",function e(){syn.data(t,"syntheticvalue")!==t.value&&syn.trigger(t,"change",{}),unbind(t,"blur",e)}))},submit:function(){syn.onParents(this,function(e){if("form"===e.nodeName.toLowerCase())return e.submit(),!1})}},changeOnBlur:function(t,n,i){bind(t,"blur",function e(){i!==t[n]&&syn.trigger(t,"change",{}),unbind(t,"blur",e)})},closest:function(e,t){for(;e&&e.nodeName.toLowerCase()!==t.toLowerCase();)e=e.parentNode;return e},data:function(e,t,n){if(e[expando]||(e[expando]=id++),data[e[expando]]||(data[e[expando]]={}),data[e[expando]],!n)return data[e[expando]][t];data[e[expando]][t]=n},onParents:function(e,t){for(var n;e&&!1!==n;)n=t(e),e=e.parentNode;return e},focusable:/^(a|area|frame|iframe|label|input|select|textarea|button|html|object)$/i,isFocusable:function(e){var t;return e.getAttributeNode&&(t=e.getAttributeNode("tabIndex")),this.focusable.test(e.nodeName)||t&&t.specified&&syn.isVisible(e)},isVisible:function(e){return e.offsetWidth&&e.offsetHeight||e.clientWidth&&e.clientHeight},tabIndex:function(e){var t=e.getAttributeNode("tabIndex");return t&&t.specified&&(parseInt(e.getAttribute("tabIndex"))||0)},bind:bind,unbind:unbind,schedule:schedule,browser:browser,helpers:{createEventObject:createEventObject,createBasicStandardEvent:function(e,t,n){var i;try{i=n.createEvent("Events")}catch(e){i=n.createEvent("UIEvents")}finally{i.initEvent(e,!0,!0),extend(i,t)}return i},inArray:function(e,t){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},getWindow:function(e){if(e.ownerDocument)return e.ownerDocument.defaultView||e.ownerDocument.parentWindow},extend:extend,scrollOffset:function(e,t){var n=e.document.documentElement,i=e.document.body;if(!t)return{left:(n&&n.scrollLeft||i&&i.scrollLeft||0)+(n.clientLeft||0),top:(n&&n.scrollTop||i&&i.scrollTop||0)+(n.clientTop||0)};window.scrollTo(t.left,t.top)},scrollDimensions:function(e){var t=e.document.documentElement,n=e.document.body,i=t.clientWidth,o=t.clientHeight,r="CSS1Compat"===e.document.compatMode;return{height:r&&o||n.clientHeight||o,width:r&&i||n.clientWidth||i}},addOffset:function(e,t){var n,i=syn.jquery(t);"object"==typeof e&&void 0===e.clientX&&void 0===e.clientY&&void 0===e.pageX&&void 0===e.pageY&&i&&(n=(t=i(t)).offset(),e.pageX=n.left+t.width()/2,e.pageY=n.top+t.height()/2)}},key:{ctrlKey:null,altKey:null,shiftKey:null,metaKey:null},dispatch:function(e,t,n,i){if(t.dispatchEvent&&e){var o=e.preventDefault,r=i?-1:0;return i&&bind(t,n,function e(t){t.preventDefault(),unbind(this,n,e)}),e.preventDefault=function(){r++,0<++r&&o.apply(this,[])},t.dispatchEvent(e),r<=0}try{window.event=e}catch(e){}return t.sourceIndex<=0||t.fireEvent&&t.fireEvent("on"+n,e)},create:{page:{event:function(e,t,n){var i,o=syn.helpers.getWindow(n).document||document;if(o.createEvent)return(i=o.createEvent("Events")).initEvent(e,!0,!0),i;try{i=createEventObject(e,t,n)}catch(e){}return i}},focus:{event:function(e,t,n){return syn.onParents(n,function(e){if(syn.isFocusable(e)){if("html"!==e.nodeName.toLowerCase())syn.__tryFocus(e),activeElement=e;else if(activeElement){var t=syn.helpers.getWindow(n).document;if(t!==window.document)return!1;activeElement=(t.activeElement?t.activeElement.blur():activeElement.blur(),null)}return!1}}),!0}}},support:{clickChanges:!1,clickSubmits:!1,keypressSubmits:!1,mouseupSubmits:!1,radioClickChanges:!1,focusChanges:!1,linkHrefJS:!1,keyCharacters:!1,backspaceWorks:!1,mouseDownUpClicks:!1,tabKeyTabs:!1,keypressOnAnchorClicks:!1,optionClickBubbles:!1,pointerEvents:!1,touchEvents:!1,ready:0},trigger:function(e,t,n){n=n||{};var i,o,r,s=syn.create,c=s[t]&&s[t].setup,u=key.test(t)?"key":page.test(t)?"page":"mouse",a=s[t]||{},l=s[u],d=e;return 2===syn.support.ready&&c&&c(t,n,e),r=n._autoPrevent,delete n._autoPrevent,(o=a.event?a.event(t,n,e):(n=l.options?l.options(t,n,e):n,!syn.support.changeBubbles&&/option/i.test(e.nodeName)&&(d=e.parentNode),i=l.event(t,n,d),syn.dispatch(i,d,t,r)))&&2===syn.support.ready&&syn.defaults[t]&&syn.defaults[t].call(e,n,r),o},eventSupported:function(e){var t=document.createElement("div"),n=(e="on"+e)in t;return n||(t.setAttribute(e,"return;"),n="function"==typeof t[e]),t=null,n}}),extend(syn.init.prototype,{then:function(n,e,t,i){syn.autoDelay&&this.delay();var o=syn.args(t,e,i),r=this;return this.queue.unshift(function(e,t){if("function"!=typeof this[n])return this.result=syn.trigger(o.element,n,o.options),o.callback&&o.callback.call(this,o.element,this.result),this;this.element=o.element||e,this[n](this.element,o.options,function(e,t){o.callback&&o.callback.apply(r,arguments),r.done.apply(r,arguments)})}),this},delay:function(e,t){"function"==typeof e&&(t=e,e=null),e=e||600;var n=this;return this.queue.unshift(function(){schedule(function(){t&&t.apply(n,[]),n.done.apply(n,arguments)},e)}),this},done:function(e,t){t&&(this.element=t),this.queue.length&&this.queue.pop().call(this,this.element,e)},_click:function(e,t,n,i){syn.helpers.addOffset(t,e),syn.support.pointerEvents&&syn.trigger(e,"pointerdown",t),syn.support.touchEvents&&syn.trigger(e,"touchstart",t),syn.trigger(e,"mousedown",t),schedule(function(){syn.support.pointerEvents&&syn.trigger(e,"pointerup",t),syn.support.touchEvents&&syn.trigger(e,"touchend",t),syn.trigger(e,"mouseup",t),!syn.support.mouseDownUpClicks||i?(syn.trigger(e,"click",t),n(!0)):(syn.create.click.setup("click",t,e),syn.defaults.click.call(e),schedule(function(){n(!0)},1))},1)},_rightClick:function(e,t,n){syn.helpers.addOffset(t,e);var i=extend(extend({},syn.mouse.browser.right.mouseup),t);syn.support.pointerEvents&&syn.trigger(e,"pointerdown",i),syn.trigger(e,"mousedown",i),schedule(function(){syn.support.pointerEvents&&syn.trigger(e,"pointerup",i),syn.trigger(e,"mouseup",i),syn.mouse.browser.right.contextmenu&&syn.trigger(e,"contextmenu",extend(extend({},syn.mouse.browser.right.contextmenu),t)),n(!0)},1)},_dblclick:function(e,t,n){syn.helpers.addOffset(t,e);var i=this;this._click(e,t,function(){schedule(function(){i._click(e,t,function(){syn.trigger(e,"dblclick",t),n(!0)},!0)},2)})}});for(var actions=["click","dblclick","move","drag","key","type","rightClick"],makeAction=function(i){syn[i]=function(e,t,n){return syn("_"+i,e,t,n)},syn.init.prototype[i]=function(e,t,n){return this.then("_"+i,e,t,n)}},i=0;i<actions.length;i++)makeAction(actions[i]);module.exports=syn;
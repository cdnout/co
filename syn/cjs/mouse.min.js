var syn=require("./synthetic.js"),h=syn.helpers,getWin=h.getWindow;syn.mouse={},h.extend(syn.defaults,{mousedown:function(e){syn.trigger(this,"focus",{})},click:function(){var element=this,href,type,createChange,radioChanged,nodeName,scope,code,form;try{href=element.href,type=element.type,createChange=syn.data(element,"createChange"),radioChanged=syn.data(element,"radioChanged"),scope=getWin(element),nodeName=element.nodeName.toLowerCase()}catch(e){return}!syn.support.linkHrefJS&&/^\s*javascript:/.test(href)&&(code=href.replace(/^\s*javascript:/,""),"//"!==code&&-1===code.indexOf("void(0)")&&(window.selenium?eval("with(selenium.browserbot.getCurrentWindow()){"+code+"}"):eval("with(scope){"+code+"}"))),syn.support.clickSubmits||"input"!==nodeName&&"button"!==nodeName||"submit"!==type||(form=syn.closest(element,"form"),form&&syn.trigger(form,"submit",{})),"a"===nodeName&&element.href&&!/^\s*javascript:/.test(href)&&(scope.location.href=href),"input"===nodeName&&"checkbox"===type&&(syn.support.clickChanges||syn.trigger(element,"change",{})),"input"===nodeName&&"radio"===type&&radioChanged&&!syn.support.radioClickChanges&&syn.trigger(element,"change",{}),"option"===nodeName&&createChange&&(syn.trigger(element.parentNode,"change",{}),syn.data(element,"createChange",!1))}}),h.extend(syn.create,{mouse:{options:function(e,t,n){var r=document.documentElement,o=document.body,a=[t.pageX||0,t.pageY||0],s=syn.mouse.browser&&syn.mouse.browser.left[e],c=syn.mouse.browser&&syn.mouse.browser.right[e];return h.extend({bubbles:!0,cancelable:!0,view:window,detail:1,screenX:1,screenY:1,clientX:t.clientX||a[0]-(r&&r.scrollLeft||o&&o.scrollLeft||0)-(r.clientLeft||0),clientY:t.clientY||a[1]-(r&&r.scrollTop||o&&o.scrollTop||0)-(r.clientTop||0),ctrlKey:!!syn.key.ctrlKey,altKey:!!syn.key.altKey,shiftKey:!!syn.key.shiftKey,metaKey:!!syn.key.metaKey,button:s&&null!==s.button?s.button:c&&c.button||("contextmenu"===e?2:0),relatedTarget:document.documentElement},t)},event:function(t,n,e){var r,o=getWin(e).document||document;if(o.createEvent){try{n.view=o.defaultView,(r=o.createEvent("MouseEvents")).initMouseEvent(t,n.bubbles,n.cancelable,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget)}catch(e){r=h.createBasicStandardEvent(t,n,o)}return r.synthetic=!0,r}try{r=h.createEventObject(t,n,e)}catch(e){}return r}},click:{setup:function(e,t,n){var r=n.nodeName.toLowerCase();if(!syn.support.clickChecks&&!syn.support.changeChecks&&"input"===r&&("checkbox"===(e=n.type.toLowerCase())&&(n.checked=!n.checked),"radio"===e&&!n.checked)){try{syn.data(n,"radioChanged",!0)}catch(e){}n.checked=!0}if("a"===r&&n.href&&!/^\s*javascript:/.test(n.href)&&syn.data(n,"href",n.href),/option/i.test(n.nodeName)){for(var o=n.parentNode.firstChild,a=-1;o&&(1!==o.nodeType||(a++,o!==n));)o=o.nextSibling;a!==n.parentNode.selectedIndex&&(n.parentNode.selectedIndex=a,syn.data(n,"createChange",!0))}}},mousedown:{setup:function(e,t,n){var r=n.nodeName.toLowerCase();!syn.browser.safari||"select"!==r&&"option"!==r||(t._autoPrevent=!0)}}});
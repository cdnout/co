var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports={dispatch:b.dispatch,getState:b.getState,setState:b.setState,setActions:b.setActions,subscribe:b.subscribe,middleware:b.middleware,emit:b.emit,unsubscribe:b.unsubscribe}:a.Mockstate=b}(this,function(a){var b=this,c={localState:{recoveryStateWhenOffline:function(){void 0!==b.addEventListener&&(b.addEventListener("load",function(){null!==localStorage.getItem("mockstate:StateToRecovery")&&(c.mockStoreState=JSON.parse(localStorage.getItem("mockstate:StateToRecovery")),localStorage.removeItem("mockstate:StateToRecovery"))}),b.addEventListener("online",function(a){var b=JSON.parse(localStorage.getItem("mockstate:StateToRecovery"));c.mockStoreState=b,localStorage.removeItem("mockstate:StateToRecovery")}),b.addEventListener("offline",function(a){localStorage.setItem("mockstate:StateToRecovery",JSON.stringify(c.mockStoreState))}))}},mockStoreState:{},_store:{state:{},actions:{},components:[],middleware:{}},store:{subscribe:function(a,b){c._store.components.push({component:a,handler:b})},unsubscribe:function(a){var b=c._store.components;b.forEach(el,function(c){el===a&&b.splice(c,1)})},middleware:function(a){c._store.middleware=a},emit:function(){return new Promise(function(a,b){var d={action:null,value:null},e=c._store.components;e.forEach(function(b,c){void 0!==b.component&&"function"==typeof b.handler&&a(b.handler(d))})})},dispatch:function(a){for(var b=arguments.length,d=Array(b>1?b-1:0),e=1;e<b;e++)d[e-1]=arguments[e];var f=c._store.components,g=function(){var b=Promise.resolve(c._store.actions[a].apply(null,[].concat(c.mockStoreState,d))).then(function(b){var d=c._store.middleware,e={action:a,value:b};return"function"==typeof d&&d.call(null,e,c.mockStoreState),e}).then(function(a){return f.forEach(function(b,c){void 0!==b.component&&"function"==typeof b.handler&&b.handler(a)}),a});return b};return g()},setState:function(a){Object.assign(c._store.state,a),Object.assign(c.mockStoreState,a),c.localState.recoveryStateWhenOffline()},getState:function(a){return"*"===a?c.mockStoreState:c.mockStoreState[a]},setActions:function(a){Object.assign(c._store.actions,a)}}};return c.store}(this));
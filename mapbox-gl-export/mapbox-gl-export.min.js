!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("mapboxgl")):"function"==typeof define&&define.amd?define(["mapboxgl"],e):"object"==typeof exports?exports.watergis=e(require("mapboxgl")):t.watergis=e(t.mapboxgl)}(self,function(e){return(()=>{var o,s,l,u,i={2702:function(t,e,D){t.exports=function(){"use strict";function h(t){return"function"==typeof t}var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},n=0,e=void 0,r=void 0,a=function(t,e){u[n]=t,u[n+1]=e,2===(n+=2)&&(r?r(f):m())},t="undefined"!=typeof window?window:void 0,o=t||{},s=o.MutationObserver||o.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),o="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function l(){var t=setTimeout;return function(){return t(f,1)}}var u=new Array(1e3);function f(){for(var t=0;t<n;t+=2)(0,u[t])(u[t+1]),u[t]=void 0,u[t+1]=void 0;n=0}var d,p,g,m=void 0;function v(t,e){var i=this,n=new this.constructor(w);void 0===n[b]&&N(n);var r,o=i._state;return o?(r=arguments[o-1],a(function(){return k(o,n,r,i._result)})):T(i,n,t,e),n}function y(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(w);return S(e,t),e}var m=c?function(){return process.nextTick(f)}:s?(p=0,s=new s(f),g=document.createTextNode(""),s.observe(g,{characterData:!0}),function(){g.data=p=++p%2}):o?((d=new MessageChannel).port1.onmessage=f,function(){return d.port2.postMessage(0)}):(void 0===t?function(){try{var t=Function("return this")().require("vertx");return void 0!==(e=t.runOnLoop||t.runOnContext)?function(){e(f)}:l()}catch(t){return l()}}:l)(),b=Math.random().toString(36).substring(2);function w(){}var x=void 0;function _(t,e,i){var r,o,n,s;e.constructor===t.constructor&&i===v&&e.constructor.resolve===y?(n=t,1===(s=e)._state?A(n,s._result):2===s._state?L(n,s._result):T(s,void 0,function(t){return S(n,t)},function(t){return L(n,t)})):void 0!==i&&h(i)?(r=e,o=i,a(function(i){var n=!1,t=function(t,e){try{t.call(e,function(t){n||(n=!0,r!==t?S(i,t):A(i,t))},function(t){n||(n=!0,L(i,t))})}catch(t){return t}}(o,r,i._label);!n&&t&&(n=!0,L(i,t))},t)):A(t,e)}function S(t,e){if(t===e)L(t,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof e,null===e||"object"!=i&&"function"!=i)A(t,e);else{i=void 0;try{i=e.then}catch(e){return void L(t,e)}_(t,e,i)}var i}function C(t){t._onerror&&t._onerror(t._result),P(t)}function A(t,e){t._state===x&&(t._result=e,t._state=1,0!==t._subscribers.length&&a(P,t))}function L(t,e){t._state===x&&(t._state=2,t._result=e,a(C,t))}function T(t,e,i,n){var r=t._subscribers,o=r.length;t._onerror=null,r[o]=e,r[o+1]=i,r[o+2]=n,0===o&&t._state&&a(P,t)}function P(t){var e=t._subscribers,i=t._state;if(0!==e.length){for(var n,r=void 0,o=t._result,s=0;s<e.length;s+=3)n=e[s],r=e[s+i],n?k(i,n,r,o):r(o);t._subscribers.length=0}}function k(t,e,i,n){var r=h(i),o=void 0,s=void 0,a=!0;if(r){try{o=i(n)}catch(t){a=!1,s=t}if(e===o)return void L(e,new TypeError("A promises callback cannot return that same promise."))}else o=n;e._state!==x||(r&&a?S(e,o):!1===a?L(e,s):1===t?A(e,o):2===t&&L(e,o))}var O=0;function N(t){t[b]=O++,t._state=void 0,t._result=void 0,t._subscribers=[]}var j=(F.prototype._enumerate=function(t){for(var e=0;this._state===x&&e<t.length;e++)this._eachEntry(t[e],e)},F.prototype._eachEntry=function(e,t){var i=this._instanceConstructor,n=i.resolve;if(n===y){var r,o=void 0,s=void 0,a=!1;try{o=e.then}catch(e){a=!0,s=e}o===v&&e._state!==x?this._settledAt(e._state,t,e._result):"function"!=typeof o?(this._remaining--,this._result[t]=e):i===E?(r=new i(w),a?L(r,s):_(r,e,o),this._willSettleAt(r,t)):this._willSettleAt(new i(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},F.prototype._settledAt=function(t,e,i){var n=this.promise;n._state===x&&(this._remaining--,2===t?L(n,i):this._result[e]=i),0===this._remaining&&A(n,this._result)},F.prototype._willSettleAt=function(t,e){var i=this;T(t,void 0,function(t){return i._settledAt(1,e,t)},function(t){return i._settledAt(2,e,t)})},F);function F(t,e){this._instanceConstructor=t,this.promise=new t(w),this.promise[b]||N(this.promise),i(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?A(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&A(this.promise,this._result))):L(this.promise,new Error("Array Methods must be provided an Array"))}var E=(I.prototype.catch=function(t){return this.then(null,t)},I.prototype.finally=function(e){var i=this.constructor;return h(e)?this.then(function(t){return i.resolve(e()).then(function(){return t})},function(t){return i.resolve(e()).then(function(){throw t})}):this.then(e,e)},I);function I(t){this[b]=O++,this._result=this._state=void 0,this._subscribers=[],w!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof I?function(e,t){try{t(function(t){S(e,t)},function(t){L(e,t)})}catch(t){L(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return E.prototype.then=v,E.all=function(t){return new j(this,t).promise},E.race=function(r){var o=this;return i(r)?new o(function(t,e){for(var i=r.length,n=0;n<i;n++)o.resolve(r[n]).then(t,e)}):new o(function(t,e){return e(new TypeError("You must pass an array to race."))})},E.resolve=y,E.reject=function(t){var e=new this(w);return L(e,t),e},E._setScheduler=function(t){r=t},E._setAsap=function(t){a=t},E._asap=a,E.polyfill=function(){var t=void 0;if(void 0!==D.g)t=D.g;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var i=null;try{i=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===i&&!e.cast)return}t.Promise=E},E.Promise=E}()},2777:(t,i,e)=>{var o,l,u,s,a,n,r,h,c,f,d,p,g,m,v,y,b,w,x,_,S,C,A,L,T,P,k,O,N,j,F,E,I,D,M,B,R,z,q,U,W,H,V,X,G,Y=Y||{version:"4.3.1"};function K(t,e){var i=t.canvas,n=e.targetCanvas,t=n.getContext("2d");t.translate(0,n.height),t.scale(1,-1);e=i.height-n.height;t.drawImage(i,0,e,n.width,n.height,0,0,n.width,n.height)}function J(t,e){var i=e.targetCanvas.getContext("2d"),n=e.destinationWidth,r=e.destinationHeight,o=n*r*4,e=new Uint8Array(this.imageBuffer,0,o),o=new Uint8ClampedArray(this.imageBuffer,0,o);t.readPixels(0,0,n,r,t.RGBA,t.UNSIGNED_BYTE,e);r=new ImageData(o,n,r);i.putImageData(r,0,0)}function $(t){t.textDecoration&&(-1<t.textDecoration.indexOf("underline")&&(t.underline=!0),-1<t.textDecoration.indexOf("line-through")&&(t.linethrough=!0),-1<t.textDecoration.indexOf("overline")&&(t.overline=!0),delete t.textDecoration)}function Z(e,t,i){var n={};i.forEach(function(t){n[t]=e[t]}),k(e[t],n,!0)}function Q(t,e){if(e){if(e.toLive)return t+": url(#SVGID_"+e.id+"); ";var i=new Y.Color(e),e=t+": "+i.toRgb()+"; ",i=i.getAlpha();return 1!==i&&(e+=t+"-opacity: "+i.toString()+"; "),e}return t+": none; "}function tt(t,e){return t.button&&t.button===e-1}function et(t,e,i,n){return n=t<Math.abs(e)?(t=e,i/4):0===e&&0===t?i/(2*Math.PI)*Math.asin(1):i/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:i,s:n}}function it(t,e,i){return t.a*Math.pow(2,10*--e)*Math.sin((e*i-t.s)*(2*Math.PI)/t.p)}function nt(t,e,i,n){return i-rt(n-t,0,i,n)+e}function rt(t,e,i,n){return(t/=n)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}function ot(t,e,i){return"rgba("+parseInt(t[0]+i*(e[0]-t[0]),10)+","+parseInt(t[1]+i*(e[1]-t[1]),10)+","+parseInt(t[2]+i*(e[2]-t[2]),10)+(","+(t&&e?parseFloat(t[3]+i*(e[3]-t[3])):1))+")"}function st(){return!1}function at(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e}function ht(){return z.apply(Y.window,arguments)}function ct(){}function lt(){}function ut(){}function ft(t){for(var e=null,i=this;i.constructor.superclass;){var n=i.constructor.superclass.prototype[t];if(i[t]!==n){e=n;break}i=i.constructor.superclass.prototype}return e?1<arguments.length?e.apply(this,U.call(arguments,1)):e.call(this):console.log("tried to callSuper "+t+", method not found in prototype chain",this)}function dt(t,e,i){if(i)if(!Y.isLikelyNode&&e instanceof Element)t=e;else if(e instanceof Array){t=[];for(var n=0,r=e.length;n<r;n++)t[n]=dt({},e[n],i)}else if(e&&"object"==typeof e)for(var o in e)"canvas"===o||"group"===o?t[o]=null:e.hasOwnProperty(o)&&(t[o]=dt({},e[o],i));else t=e;else for(var o in e)t[o]=e[o];return t}function pt(t,e,i){if(t&&0!==t.length){var n=t.length-1,r=e?t[n][e]:t[n];if(e)for(;n--;)i(t[n][e],r)&&(r=t[n][e]);else for(;n--;)i(t[n],r)&&(r=t[n]);return r}}function gt(t,e,i,n,r,o,s){var a=Math.PI,h=s*a/180,c=Y.util.sin(h),l=Y.util.cos(h),u=0,f=0,d=-l*t*.5-c*e*.5,p=-l*e*.5+c*t*.5,g=(i=Math.abs(i))*i,m=(n=Math.abs(n))*n,v=p*p,y=d*d,b=g*m-g*v-m*y,s=0;b<0?(i*=h=Math.sqrt(1-b/(g*m)),n*=h):s=(r===o?-1:1)*Math.sqrt(b/(g*v+m*y));var y=s*i*p/n,s=-s*n*d/i,w=l*y-c*s+.5*t,x=c*y+l*s+.5*e,_=mt(1,0,(d-y)/i,(p-s)/n),s=mt((d-y)/i,(p-s)/n,(-d-y)/i,(-p-s)/n);0===o&&0<s?s-=2*a:1===o&&s<0&&(s+=2*a);for(var S,C,A,L,T,P,k,O,N,j,F,E,I,D=Math.ceil(Math.abs(s/a*2)),M=[],B=s/D,R=8/3*Math.sin(B/4)*Math.sin(B/4)/Math.sin(B/2),z=_+B,q=0;q<D;q++)M[q]=(S=_,C=z,A=l,L=c,T=i,P=n,k=w,O=x,N=R,j=u,F=f,I=E=void 0,E=Y.util.cos(S),I=Y.util.sin(S),S=Y.util.cos(C),C=Y.util.sin(C),["C",j+N*(-A*T*I-L*P*E),F+N*(-L*T*I+A*P*E),(k=A*T*S-L*P*C+k)+N*(A*T*C+L*P*S),(O=L*T*S+A*P*C+O)+N*(L*T*C-A*P*S),k,O]),u=M[q][5],f=M[q][6],_=z,z+=B;return M}function mt(t,e,i,n){t=Math.atan2(e,t),i=Math.atan2(n,i);return t<=i?i-t:2*Math.PI-(t-i)}function vt(t,e,i,n,r,o,s,a){var h;if(Y.cachesBoundsOfCurve&&(h=V.call(arguments),Y.boundsOfCurveCache[h]))return Y.boundsOfCurveCache[h];for(var c,l,u,f=Math.sqrt,d=Math.min,p=Math.max,g=Math.abs,m=[],v=[[],[]],y=6*t-12*i+6*r,b=-3*t+9*i-9*r+3*s,w=3*i-3*t,x=0;x<2;++x)if(0<x&&(y=6*e-12*n+6*o,b=-3*e+9*n-9*o+3*a,w=3*n-3*e),g(b)<1e-12){if(g(y)<1e-12)continue;0<(c=-w/y)&&c<1&&m.push(c)}else(l=y*y-4*w*b)<0||(0<(l=(-y+(u=f(l)))/(2*b))&&l<1&&m.push(l),0<(u=(-y-u)/(2*b))&&u<1&&m.push(u));for(var _,S,C=m.length,A=C;C--;)_=(S=1-(c=m[C]))*S*S*t+3*S*S*c*i+3*S*c*c*r+c*c*c*s,v[0][C]=_,v[1][C]=S*S*S*e+3*S*S*c*n+3*S*c*c*o+c*c*c*a;v[0][A]=t,v[1][A]=e,v[0][A+1]=s,v[1][A+1]=a;p=[{x:d.apply(null,v[0]),y:d.apply(null,v[1])},{x:p.apply(null,v[0]),y:p.apply(null,v[1])}];return Y.cachesBoundsOfCurve&&(Y.boundsOfCurveCache[h]=p),p}function yt(t,e,i){for(var n=i[1],r=i[2],o=i[3],s=i[4],a=i[5],h=gt(i[6]-t,i[7]-e,n,r,s,a,o),c=0,l=h.length;c<l;c++)h[c][1]+=t,h[c][2]+=e,h[c][3]+=t,h[c][4]+=e,h[c][5]+=t,h[c][6]+=e;return h}function bt(t,e,i,n){return Math.sqrt((i-t)*(i-t)+(n-e)*(n-e))}function wt(t,e,i){for(var n,r={x:e,y:i},o=0,s=.01;s<=1;s+=.01)n=t(s),o+=bt(r.x,r.y,n.x,n.y),r=n;return o}function xt(t){for(var e,i,n,r,o=0,s=t.length,a=0,h=0,c=0,l=0,u=[],f=0;f<s;f++){switch(n={x:a,y:h,command:(e=t[f])[0]},e[0]){case"M":n.length=0,c=a=e[1],l=h=e[2];break;case"L":n.length=bt(a,h,e[1],e[2]),a=e[1],h=e[2];break;case"C":i=function(r,o,s,a,h,c,l,u){return function(t){var e=t*t*t,i=3*t*t*(1-t),n=3*t*(1-t)*(1-t),t=(1-t)*(1-t)*(1-t);return{x:l*e+h*i+s*n+r*t,y:u*e+c*i+a*n+o*t}}}(a,h,e[1],e[2],e[3],e[4],e[5],e[6]),r=function(i,n,r,o,s,a,h,c){return function(t){var e=1-t;return Math.atan2(3*e*e*(o-n)+6*e*t*(a-o)+3*t*t*(c-a),3*e*e*(r-i)+6*e*t*(s-r)+3*t*t*(h-s))}}(a,h,e[1],e[2],e[3],e[4],e[5],e[6]),n.iterator=i,n.angleFinder=r,n.length=wt(i,a,h),a=e[5],h=e[6];break;case"Q":i=function(n,r,o,s,a,h){return function(t){var e=t*t,i=2*t*(1-t),t=(1-t)*(1-t);return{x:a*e+o*i+n*t,y:h*e+s*i+r*t}}}(a,h,e[1],e[2],e[3],e[4]),r=function(i,n,r,o,s,a){return function(t){var e=1-t;return Math.atan2(2*e*(o-n)+2*t*(a-o),2*e*(r-i)+2*t*(s-r))}}(a,h,e[1],e[2],e[3],e[4]),n.iterator=i,n.angleFinder=r,n.length=wt(i,a,h),a=e[3],h=e[4];break;case"Z":case"z":n.destX=c,n.destY=l,n.length=bt(a,h,c,l),a=c,h=l}o+=n.length,u.push(n)}return u.push({length:o,x:a,y:h}),u}function _t(t,e){this.__eventListeners[t]&&(t=this.__eventListeners[t],e?t[t.indexOf(e)]=!1:Y.util.array.fill(t,!1))}i.fabric=Y,"undefined"!=typeof document&&"undefined"!=typeof window?(document instanceof("undefined"!=typeof HTMLDocument?HTMLDocument:Document)?Y.document=document:Y.document=document.implementation.createHTMLDocument(""),Y.window=window):(S=new(e(4960).JSDOM)(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window,Y.document=S.document,Y.jsdomImplForWrapper=e(6759).implForWrapper,Y.nodeCanvas=e(6272).Canvas,Y.window=S,DOMParser=Y.window.DOMParser),Y.isTouchSupported="ontouchstart"in Y.window||"ontouchstart"in Y.document||Y.window&&Y.window.navigator&&0<Y.window.navigator.maxTouchPoints,Y.isLikelyNode="undefined"!=typeof Buffer&&"undefined"==typeof window,Y.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],Y.DPI=96,Y.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",Y.commaWsp="(?:\\s+,?\\s*|,\\s*)",Y.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,Y.reNonWord=/[ \n\.,;!\?\-]/,Y.fontPaths={},Y.iMatrix=[1,0,0,1,0,0],Y.svgNS="http://www.w3.org/2000/svg",Y.perfLimitSizeTotal=2097152,Y.maxCacheSideLimit=4096,Y.minCacheSideLimit=256,Y.charWidthsCache={},Y.textureSize=2048,Y.disableStyleCopyPaste=!1,Y.enableGLFiltering=!0,Y.devicePixelRatio=Y.window.devicePixelRatio||Y.window.webkitDevicePixelRatio||Y.window.mozDevicePixelRatio||1,Y.browserShadowBlurConstant=1,Y.arcToSegmentsCache={},Y.boundsOfCurveCache={},Y.cachesBoundsOfCurve=!0,Y.forceGLPutImageData=!1,Y.initFilterBackend=function(){return Y.enableGLFiltering&&Y.isWebglSupported&&Y.isWebglSupported(Y.textureSize)?(console.log("max texture size: "+Y.maxTextureSize),new Y.WebglFilterBackend({tileSize:Y.textureSize})):Y.Canvas2dFilterBackend?new Y.Canvas2dFilterBackend:void 0},"undefined"!=typeof document&&"undefined"!=typeof window&&(window.fabric=Y),Y.Observable={fire:function(t,e){if(!this.__eventListeners)return this;var i=this.__eventListeners[t];if(!i)return this;for(var n=0,r=i.length;n<r;n++)i[n]&&i[n].call(this,e||{});return this.__eventListeners[t]=i.filter(function(t){return!1!==t}),this},on:function(t,e){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var i in t)this.on(i,t[i]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(e);return this},off:function(t,e){if(!this.__eventListeners)return this;if(0===arguments.length)for(t in this.__eventListeners)_t.call(this,t);else if(1===arguments.length&&"object"==typeof arguments[0])for(var i in t)_t.call(this,i,t[i]);else _t.call(this,t,e);return this}},Y.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var t=0,e=arguments.length;t<e;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(t,e,i){var n=this._objects;return i?n[e]=t:n.splice(e,0,t),this._onObjectAdded&&this._onObjectAdded(t),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var t,e=this._objects,i=!1,n=0,r=arguments.length;n<r;n++)-1!==(t=e.indexOf(arguments[n]))&&(i=!0,e.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[n]));return this.renderOnAddRemove&&i&&this.requestRenderAll(),this},forEachObject:function(t,e){for(var i=this.getObjects(),n=0,r=i.length;n<r;n++)t.call(e,i[n],n,i);return this},getObjects:function(e){return void 0===e?this._objects.concat():this._objects.filter(function(t){return t.type===e})},item:function(t){return this._objects[t]},isEmpty:function(){return 0===this._objects.length},size:function(){return this._objects.length},contains:function(t){return-1<this._objects.indexOf(t)},complexity:function(){return this._objects.reduce(function(t,e){return t+(e.complexity?e.complexity():0)},0)}},Y.CommonMethods={_setOptions:function(t){for(var e in t)this.set(e,t[e])},_initGradient:function(t,e){!t||!t.colorStops||t instanceof Y.Gradient||this.set(e,new Y.Gradient(t))},_initPattern:function(t,e,i){!t||!t.source||t instanceof Y.Pattern?i&&i():this.set(e,new Y.Pattern(t,i))},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"==typeof t?this._setObject(t):this._set(t,e),this},_set:function(t,e){this[t]=e},toggle:function(t){var e=this.get(t);return"boolean"==typeof e&&this.set(t,!e),this},get:function(t){return this[t]}},o=i,l=Math.sqrt,u=Math.atan2,s=Math.pow,a=Math.PI/180,n=Math.PI/2,Y.util={cos:function(t){if(0===t)return 1;switch((t=t<0?-t:t)/n){case 1:case 3:return 0;case 2:return-1}return Math.cos(t)},sin:function(t){if(0===t)return 0;var e=t<0?-1:1;switch(t/n){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(t)},removeFromArray:function(t,e){e=t.indexOf(e);return-1!==e&&t.splice(e,1),t},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},degreesToRadians:function(t){return t*a},radiansToDegrees:function(t){return t/a},rotatePoint:function(t,e,i){t.subtractEquals(e);i=Y.util.rotateVector(t,i);return new Y.Point(i.x,i.y).addEquals(e)},rotateVector:function(t,e){var i=Y.util.sin(e),e=Y.util.cos(e);return{x:t.x*e-t.y*i,y:t.x*i+t.y*e}},transformPoint:function(t,e,i){return i?new Y.Point(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y):new Y.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},makeBoundingBoxFromPoints:function(t,e){if(e)for(var i=0;i<t.length;i++)t[i]=Y.util.transformPoint(t[i],e);var n=[t[0].x,t[1].x,t[2].x,t[3].x],r=Y.util.array.min(n),o=Y.util.array.max(n)-r,s=[t[0].y,t[1].y,t[2].y,t[3].y],n=Y.util.array.min(s);return{left:r,top:n,width:o,height:Y.util.array.max(s)-n}},invertTransform:function(t){var e=1/(t[0]*t[3]-t[1]*t[2]),e=[e*t[3],-e*t[1],-e*t[2],e*t[0]],t=Y.util.transformPoint({x:t[4],y:t[5]},e,!0);return e[4]=-t.x,e[5]=-t.y,e},toFixed:function(t,e){return parseFloat(Number(t).toFixed(e))},parseUnit:function(t,e){var i=/\D{0,2}$/.exec(t),n=parseFloat(t);switch(e=e||Y.Text.DEFAULT_SVG_FONT_SIZE,i[0]){case"mm":return n*Y.DPI/25.4;case"cm":return n*Y.DPI/2.54;case"in":return n*Y.DPI;case"pt":return n*Y.DPI/72;case"pc":return n*Y.DPI/72*12;case"em":return n*e;default:return n}},falseFunction:function(){return!1},getKlass:function(t,e){return t=Y.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),Y.util.resolveNamespace(e)[t]},getSvgAttributes:function(t){var e=["instantiated_by_use","style","id","class"];switch(t){case"linearGradient":e=e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":e=e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":e=e.concat(["offset","stop-color","stop-opacity"])}return e},resolveNamespace:function(t){if(!t)return Y;for(var e=t.split("."),i=e.length,n=o||Y.window,r=0;r<i;++r)n=n[e[r]];return n},loadImage:function(t,e,i,n){var r,o;t?(o=function(){e&&e.call(i,r,!1),r=r.onload=r.onerror=null},(r=Y.util.createImage()).onload=o,r.onerror=function(){Y.log("Error loading "+r.src),e&&e.call(i,null,!0),r=r.onload=r.onerror=null},0!==t.indexOf("data")&&null!=n&&(r.crossOrigin=n),"data:image/svg"===t.substring(0,14)&&(r.onload=null,Y.util.loadImageInDom(r,o)),r.src=t):e&&e.call(i,t)},loadImageInDom:function(t,e){var i=Y.document.createElement("div");i.style.width=i.style.height="1px",i.style.left=i.style.top="-100%",i.style.position="absolute",i.appendChild(t),Y.document.querySelector("body").appendChild(i),t.onload=function(){e(),i.parentNode.removeChild(i),i=null}},enlivenObjects:function(t,e,r,o){var s=[],i=0,n=(t=t||[]).length;function a(){++i===n&&e&&e(s.filter(function(t){return t}))}n?t.forEach(function(i,n){i&&i.type?Y.util.getKlass(i.type,r).fromObject(i,function(t,e){e||(s[n]=t),o&&o(i,t,e),a()}):a()}):e&&e(s)},enlivenPatterns:function(t,e){function i(){++r===o&&e&&e(n)}var n=[],r=0,o=(t=t||[]).length;o?t.forEach(function(t,e){t&&t.source?new Y.Pattern(t,function(t){n[e]=t,i()}):(n[e]=t,i())}):e&&e(n)},groupSVGElements:function(t,e,i){return t&&1===t.length?t[0]:(e&&(e.width&&e.height?e.centerPoint={x:e.width/2,y:e.height/2}:(delete e.width,delete e.height)),e=new Y.Group(t,e),void 0!==i&&(e.sourcePath=i),e)},populateWithProperties:function(t,e,i){if(i&&"[object Array]"===Object.prototype.toString.call(i))for(var n=0,r=i.length;n<r;n++)i[n]in t&&(e[i[n]]=t[i[n]])},drawDashedLine:function(t,e,i,n,r,o){var n=n-e,r=r-i,s=l(n*n+r*r),n=u(r,n),a=o.length,h=0,c=!0;for(t.save(),t.translate(e,i),t.moveTo(0,0),t.rotate(n),e=0;e<s;)(e+=o[h++%a])>s&&(e=s),t[c?"lineTo":"moveTo"](e,0),c=!c;t.restore()},createCanvasElement:function(){return Y.document.createElement("canvas")},copyCanvasElement:function(t){var e=Y.util.createCanvasElement();return e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e},toDataURL:function(t,e,i){return t.toDataURL("image/"+e,i)},createImage:function(){return Y.document.createElement("img")},multiplyTransformMatrices:function(t,e,i){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],i?0:t[0]*e[4]+t[2]*e[5]+t[4],i?0:t[1]*e[4]+t[3]*e[5]+t[5]]},qrDecompose:function(t){var e=u(t[1],t[0]),i=s(t[0],2)+s(t[1],2),n=l(i),r=(t[0]*t[3]-t[2]*t[1])/n,i=u(t[0]*t[2]+t[1]*t[3],i);return{angle:e/a,scaleX:n,scaleY:r,skewX:i/a,skewY:0,translateX:t[4],translateY:t[5]}},calcRotateMatrix:function(t){if(!t.angle)return Y.iMatrix.concat();var e=Y.util.degreesToRadians(t.angle),t=Y.util.cos(e),e=Y.util.sin(e);return[t,e,-e,t,0,0]},calcDimensionsMatrix:function(t){var e=void 0===t.scaleX?1:t.scaleX,i=void 0===t.scaleY?1:t.scaleY,n=[t.flipX?-e:e,0,0,t.flipY?-i:i,0,0],e=Y.util.multiplyTransformMatrices,i=Y.util.degreesToRadians;return t.skewX&&(n=e(n,[1,0,Math.tan(i(t.skewX)),1],!0)),n=t.skewY?e(n,[1,Math.tan(i(t.skewY)),0,1],!0):n},composeMatrix:function(t){var e=[1,0,0,1,t.translateX||0,t.translateY||0],i=Y.util.multiplyTransformMatrices;return t.angle&&(e=i(e,Y.util.calcRotateMatrix(t))),e=1!==t.scaleX||1!==t.scaleY||t.skewX||t.skewY||t.flipX||t.flipY?i(e,Y.util.calcDimensionsMatrix(t)):e},resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.flipX=!1,t.flipY=!1,t.rotate(0)},saveObjectTransform:function(t){return{scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,angle:t.angle,left:t.left,flipX:t.flipX,flipY:t.flipY,top:t.top}},isTransparent:function(t,e,i,n){0<n&&(n<e?e-=n:e=0,n<i?i-=n:i=0);for(var r=!0,o=t.getImageData(e,i,2*n||1,2*n||1),s=o.data.length,a=3;a<s&&0!=(r=o.data[a]<=0);a+=4);return o=null,r},parsePreserveAspectRatioAttribute:function(t){var e,i="meet",t=t.split(" ");return t&&t.length&&("meet"!==(i=t.pop())&&"slice"!==i?(e=i,i="meet"):t.length&&(e=t.pop())),{meetOrSlice:i,alignX:"none"!==e?e.slice(1,4):"none",alignY:"none"!==e?e.slice(5,8):"none"}},clearFabricFontCache:function(t){(t=(t||"").toLowerCase())?Y.charWidthsCache[t]&&delete Y.charWidthsCache[t]:Y.charWidthsCache={}},limitDimsByArea:function(t,e){t=Math.sqrt(e*t),e=Math.floor(e/t);return{x:Math.floor(t),y:e}},capValue:function(t,e,i){return Math.max(t,Math.min(e,i))},findScaleToFit:function(t,e){return Math.min(e.width/t.width,e.height/t.height)},findScaleToCover:function(t,e){return Math.max(e.width/t.width,e.height/t.height)},matrixToSVG:function(t){return"matrix("+t.map(function(t){return Y.util.toFixed(t,Y.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},sizeAfterTransform:function(t,e,i){t/=2,e/=2,e=[{x:-t,y:-e},{x:t,y:-e},{x:-t,y:e},{x:t,y:e}],i=Y.util.calcDimensionsMatrix(i),i=Y.util.makeBoundingBoxFromPoints(e,i);return{x:i.width,y:i.height}}},V=Array.prototype.join,X={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},G={m:"l",M:"L"},Y.util.parsePath=function(t){var e,i,n,r,o,s=[],a=[],h=Y.rePathCommand,c="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",l="("+c+")"+Y.commaWsp,u="([01])"+Y.commaWsp+"?",f=new RegExp(l+"?"+l+"?"+l+u+u+l+"?("+c+")","g");if(!t||!t.match)return s;for(var d=0,p=(o=t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;d<p;d++){r=(e=o[d]).slice(1).trim(),a.length=0;var g,m=e.charAt(0),v=[m];if("a"===m.toLowerCase())for(;g=f.exec(r);)for(var y=1;y<g.length;y++)a.push(g[y]);else for(;n=h.exec(r);)a.push(n[0]);for(var y=0,b=a.length;y<b;y++)i=parseFloat(a[y]),isNaN(i)||v.push(i);var w=X[m.toLowerCase()],x=G[m]||m;if(v.length-1>w)for(var _=1,S=v.length;_<S;_+=w)s.push([m].concat(v.slice(_,_+w))),m=x;else s.push(v)}return s},Y.util.makePathSimpler=function(t){for(var e,i,n,r,o,s=0,a=0,h=t.length,c=0,l=0,u=[],f=0;f<h;++f){switch(i=!1,(e=t[f].slice(0))[0]){case"l":e[0]="L",e[1]+=s,e[2]+=a;case"L":s=e[1],a=e[2];break;case"h":e[1]+=s;case"H":e[0]="L",e[2]=a,s=e[1];break;case"v":e[1]+=a;case"V":e[0]="L",a=e[1],e[1]=s,e[2]=a;break;case"m":e[0]="M",e[1]+=s,e[2]+=a;case"M":s=e[1],a=e[2],c=e[1],l=e[2];break;case"c":e[0]="C",e[1]+=s,e[2]+=a,e[3]+=s,e[4]+=a,e[5]+=s,e[6]+=a;case"C":r=e[3],o=e[4],s=e[5],a=e[6];break;case"s":e[0]="S",e[1]+=s,e[2]+=a,e[3]+=s,e[4]+=a;case"S":o="C"===n?(r=2*s-r,2*a-o):(r=s,a),s=e[3],a=e[4],e[0]="C",e[5]=e[3],e[6]=e[4],e[3]=e[1],e[4]=e[2],e[1]=r,e[2]=o,r=e[3],o=e[4];break;case"q":e[0]="Q",e[1]+=s,e[2]+=a,e[3]+=s,e[4]+=a;case"Q":r=e[1],o=e[2],s=e[3],a=e[4];break;case"t":e[0]="T",e[1]+=s,e[2]+=a;case"T":o="Q"===n?(r=2*s-r,2*a-o):(r=s,a),e[0]="Q",s=e[1],a=e[2],e[1]=r,e[2]=o,e[3]=s,e[4]=a;break;case"a":e[0]="A",e[6]+=s,e[7]+=a;case"A":i=!0,u=u.concat(yt(s,a,e)),s=e[6],a=e[7];break;case"z":case"Z":s=c,a=l}i||u.push(e),n=e[0]}return u},Y.util.getPathSegmentsInfo=xt,Y.util.fromArcToBeziers=yt,Y.util.fromArcToBeizers=yt,Y.util.getBoundsOfCurve=vt,Y.util.getPointOnPath=function(t,e,i){i=i||xt(t);for(var n=0;0<e-i[n].length&&n<i.length-2;)e-=i[n].length,n++;var r,l=i[n],o=e/l.length,s=l.command,a=t[n];switch(s){case"M":return{x:l.x,y:l.y,angle:0};case"Z":case"z":return(r=new Y.Point(l.x,l.y).lerp(new Y.Point(l.destX,l.destY),o)).angle=Math.atan2(l.destY-l.y,l.destX-l.x),r;case"L":return(r=new Y.Point(l.x,l.y).lerp(new Y.Point(a[1],a[2]),o)).angle=Math.atan2(a[2]-l.y,a[1]-l.x),r;case"C":case"Q":return function(t){for(var e,i,n,r=0,o=0,s=l.iterator,a={x:l.x,y:l.y},h=.01,c=l.angleFinder;o<t&&r<=1&&1e-4<h;)e=s(r),n=r,(i=bt(a.x,a.y,e.x,e.y))+o>t?r-=h/=2:(a=e,r+=h,o+=i);return e.angle=c(n),e}(e)}},Y.util.getBoundsOfArc=function(t,e,i,n,r,o,s,a,h){for(var c,l=0,u=0,f=[],d=gt(a-t,h-e,i,n,o,s,r),p=0,g=d.length;p<g;p++)c=vt(l,u,d[p][1],d[p][2],d[p][3],d[p][4],d[p][5],d[p][6]),f.push({x:c[0].x+t,y:c[0].y+e}),f.push({x:c[1].x+t,y:c[1].y+e}),l=d[p][5],u=d[p][6];return f},Y.util.drawArc=function(e,t,i,n){yt(t,i,n=n.slice(0).unshift("X")).forEach(function(t){e.bezierCurveTo.apply(e,t.slice(1))})},H=Array.prototype.slice,Y.util.array={fill:function(t,e){for(var i=t.length;i--;)t[i]=e;return t},invoke:function(t,e){for(var i=H.call(arguments,2),n=[],r=0,o=t.length;r<o;r++)n[r]=i.length?t[r][e].apply(t[r],i):t[r][e].call(t[r]);return n},min:function(t,e){return pt(t,e,function(t,e){return t<e})},max:function(t,e){return pt(t,e,function(t,e){return e<=t})}},Y.util.object={extend:dt,clone:function(t,e){return dt({},t,e)}},Y.util.object.extend(Y.util,Y.Observable),Y.util.string={camelize:function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},capitalize:function(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())},escapeXml:function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(t){for(var e,i=0,n=[],i=0;i<t.length;i++)!1!==(e=function(t,e){var i=t.charCodeAt(e);if(isNaN(i))return"";if(i<55296||57343<i)return t.charAt(e);if(55296<=i&&i<=56319){if(t.length<=e+1)throw"High surrogate without following low surrogate";i=t.charCodeAt(e+1);if(i<56320||57343<i)throw"High surrogate without following low surrogate";return t.charAt(e)+t.charAt(e+1)}if(0===e)throw"Low surrogate without preceding high surrogate";if((e=t.charCodeAt(e-1))<55296||56319<e)throw"Low surrogate without preceding high surrogate";return!1}(t,i))&&n.push(e);return n}},U=Array.prototype.slice,W=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),Y.util.createClass=function(){var t=null,e=U.call(arguments,0);function i(){this.initialize.apply(this,arguments)}"function"==typeof e[0]&&(t=e.shift()),i.superclass=t,i.subclasses=[],t&&(ut.prototype=t.prototype,i.prototype=new ut,t.subclasses.push(i));for(var n=0,r=e.length;n<r;n++)!function(t,n,r){for(var e in n)e in t.prototype&&"function"==typeof t.prototype[e]&&-1<(n[e]+"").indexOf("callSuper")?t.prototype[e]=function(i){return function(){var t=this.constructor.superclass;this.constructor.superclass=r;var e=n[i].apply(this,arguments);if(this.constructor.superclass=t,"initialize"!==i)return e}}(e):t.prototype[e]=n[e],W&&(n.toString!==Object.prototype.toString&&(t.prototype.toString=n.toString),n.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=n.valueOf))}(i,e[n],t);return i.prototype.initialize||(i.prototype.initialize=lt),(i.prototype.constructor=i).prototype.callSuper=ft,i},r=!!Y.document.createElement("div").attachEvent,h=["touchstart","touchmove","touchend"],Y.util.addListener=function(t,e,i,n){t&&t.addEventListener(e,i,!r&&n)},Y.util.removeListener=function(t,e,i,n){t&&t.removeEventListener(e,i,!r&&n)},Y.util.getPointer=function(t){var e=t.target,i=Y.util.getScrollLeftTop(e),t=(e=t.changedTouches)&&e[0]?e[0]:t;return{x:t.clientX+i.left,y:t.clientY+i.top}},Y.util.isTouchEvent=function(t){return-1<h.indexOf(t.type)||"touch"===t.pointerType},A="string"==typeof(C=Y.document.createElement("div")).style.opacity,L="string"==typeof C.style.filter,c=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,f=function(t){return t},A?f=function(t,e){return t.style.opacity=e,t}:L&&(f=function(t,e){var i=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(i.zoom=1),c.test(i.filter)?i.filter=i.filter.replace(c,e=.9999<=e?"":"alpha(opacity="+100*e+")"):i.filter+=" alpha(opacity="+100*e+")",t}),Y.util.setStyle=function(t,e){var i,n=t.style;if(!n)return t;if("string"==typeof e)return t.style.cssText+=";"+e,-1<e.indexOf("opacity")?f(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(i in e)"opacity"===i?f(t,e[i]):n["float"===i||"cssFloat"===i?void 0===n.styleFloat?"cssFloat":"styleFloat":i]=e[i];return t},function(){var t,a,e,i,n=Array.prototype.slice,r=function(t){return n.call(t,0)};try{t=r(Y.document.childNodes)instanceof Array}catch(t){}function o(t,e){var i,n=Y.document.createElement(t);for(i in e)"class"===i?n.className=e[i]:"for"===i?n.htmlFor=e[i]:n.setAttribute(i,e[i]);return n}function h(t){for(var e=0,i=0,n=Y.document.documentElement,r=Y.document.body||{scrollLeft:0,scrollTop:0};t&&(t.parentNode||t.host)&&((t=t.parentNode||t.host)===Y.document?(e=r.scrollLeft||n.scrollLeft||0,i=r.scrollTop||n.scrollTop||0):(e+=t.scrollLeft||0,i+=t.scrollTop||0),1!==t.nodeType||"fixed"!==t.style.position););return{left:e,top:i}}t||(r=function(t){for(var e=new Array(t.length),i=t.length;i--;)e[i]=t[i];return e}),a=Y.document.defaultView&&Y.document.defaultView.getComputedStyle?function(t,e){t=Y.document.defaultView.getComputedStyle(t,null);return t?t[e]:void 0}:function(t,e){var i=t.style[e];return i=!i&&t.currentStyle?t.currentStyle[e]:i},e=Y.document.documentElement.style,i="userSelect"in e?"userSelect":"MozUserSelect"in e?"MozUserSelect":"WebkitUserSelect"in e?"WebkitUserSelect":"KhtmlUserSelect"in e?"KhtmlUserSelect":"",Y.util.makeElementUnselectable=function(t){return void 0!==t.onselectstart&&(t.onselectstart=Y.util.falseFunction),i?t.style[i]="none":"string"==typeof t.unselectable&&(t.unselectable="on"),t},Y.util.makeElementSelectable=function(t){return void 0!==t.onselectstart&&(t.onselectstart=null),i?t.style[i]="":"string"==typeof t.unselectable&&(t.unselectable=""),t},Y.util.setImageSmoothing=function(t,e){t.imageSmoothingEnabled=t.imageSmoothingEnabled||t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled||t.oImageSmoothingEnabled,t.imageSmoothingEnabled=e},Y.util.getById=function(t){return"string"==typeof t?Y.document.getElementById(t):t},Y.util.toArray=r,Y.util.addClass=function(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)},Y.util.makeElement=o,Y.util.wrapElement=function(t,e,i){return"string"==typeof e&&(e=o(e,i)),t.parentNode&&t.parentNode.replaceChild(e,t),e.appendChild(t),e},Y.util.getScrollLeftTop=h,Y.util.getElementOffset=function(t){var e,i,n=t&&t.ownerDocument,r={left:0,top:0},o={left:0,top:0},s={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!n)return o;for(i in s)o[s[i]]+=parseInt(a(t,i),10)||0;return e=n.documentElement,void 0!==t.getBoundingClientRect&&(r=t.getBoundingClientRect()),n=h(t),{left:r.left+n.left-(e.clientLeft||0)+o.left,top:r.top+n.top-(e.clientTop||0)+o.top}},Y.util.getNodeCanvas=function(t){t=Y.jsdomImplForWrapper(t);return t._canvas||t._image},Y.util.cleanUpJsdomNode=function(t){!Y.isLikelyNode||(t=Y.jsdomImplForWrapper(t))&&(t._image=null,t._canvas=null,t._currentSrc=null,t._attributes=null,t._classList=null)}}(),Y.util.request=function(t,e){var i,n=(e=e||{}).method?e.method.toUpperCase():"GET",r=e.onComplete||function(){},o=new Y.window.XMLHttpRequest,s=e.body||e.parameters;return o.onreadystatechange=function(){4===o.readyState&&(r(o),o.onreadystatechange=ct)},"GET"===n&&(s=null,"string"==typeof e.parameters&&(i=t,e=e.parameters,t=i+(/\?/.test(i)?"&":"?")+e)),o.open(n,t,!0),"POST"!==n&&"PUT"!==n||o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(s),o},Y.log=console.log,Y.warn=console.warn,z=Y.window.requestAnimationFrame||Y.window.webkitRequestAnimationFrame||Y.window.mozRequestAnimationFrame||Y.window.oRequestAnimationFrame||Y.window.msRequestAnimationFrame||function(t){return Y.window.setTimeout(t,1e3/60)},q=Y.window.cancelAnimationFrame||Y.window.clearTimeout,Y.util.animate=function(e){ht(function(t){e=e||{};var r,o=t||+new Date,s=e.duration||500,a=o+s,h=e.onChange||st,c=e.abort||st,l=e.onComplete||st,u=e.easing||at,f="startValue"in e?e.startValue:0,d="endValue"in e?e.endValue:100,p=e.byValue||d-f;e.onStart&&e.onStart(),function t(e){var i=(r=e||+new Date)>a?s:r-o,n=i/s,e=u(i,f,p,s),i=Math.abs((e-f)/p);if(!c())return a<r?(h(d,1,1),void l(d,1,1)):(h(e,i,n),void ht(t));l(d,1,1)}(o)})},Y.util.requestAnimFrame=ht,Y.util.cancelAnimFrame=function(){return q.apply(Y.window,arguments)},Y.util.animateColor=function(t,e,i,r){var t=new Y.Color(t).getSource(),n=new Y.Color(e).getSource(),o=r.onComplete,s=r.onChange;r=r||{},Y.util.animate(Y.util.object.extend(r,{duration:i||500,startValue:t,endValue:n,byValue:n,easing:function(t,e,i,n){return ot(e,i,r.colorEasing?r.colorEasing(t,n):1-Math.cos(t/n*(Math.PI/2)))},onComplete:function(t,e,i){if(o)return o(ot(n,n,0),e,i)},onChange:function(t,e,i){if(s){if(Array.isArray(t))return s(ot(t,t,0),e,i);s(t,e,i)}}}))},Y.util.ease={easeInQuad:function(t,e,i,n){return i*(t/=n)*t+e},easeOutQuad:function(t,e,i,n){return-i*(t/=n)*(t-2)+e},easeInOutQuad:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,i,n){return i*(t/=n)*t*t+e},easeOutCubic:function(t,e,i,n){return i*((t=t/n-1)*t*t+1)+e},easeInOutCubic:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,i,n){return i*(t/=n)*t*t*t+e},easeOutQuart:function(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,i,n){return i*(t/=n)*t*t*t*t+e},easeOutQuint:function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e},easeOutSine:function(t,e,i,n){return i*Math.sin(t/n*(Math.PI/2))+e},easeInOutSine:function(t,e,i,n){return-i/2*(Math.cos(Math.PI*t/n)-1)+e},easeInExpo:function(t,e,i,n){return 0===t?e:i*Math.pow(2,10*(t/n-1))+e},easeOutExpo:function(t,e,i,n){return t===n?e+i:i*(1-Math.pow(2,-10*t/n))+e},easeInOutExpo:function(t,e,i,n){return 0===t?e:t===n?e+i:(t/=n/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,i,n){return-i*(Math.sqrt(1-(t/=n)*t)-1)+e},easeOutCirc:function(t,e,i,n){return i*Math.sqrt(1-(t=t/n-1)*t)+e},easeInOutCirc:function(t,e,i,n){return(t/=n/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,i,n){var r=0;return 0===t?e:1==(t/=n)?e+i:-it(et(i,i,r=r||.3*n,1.70158),t,n)+e},easeOutElastic:function(t,e,i,n){if(0===t)return e;if(1==(t/=n))return e+i;i=et(i,i,0||.3*n,1.70158);return i.a*Math.pow(2,-10*t)*Math.sin((t*n-i.s)*(2*Math.PI)/i.p)+i.c+e},easeInOutElastic:function(t,e,i,n){if(0===t)return e;if(2==(t/=n/2))return e+i;i=et(i,i,0||n*(.3*1.5),1.70158);return t<1?-.5*it(i,t,n)+e:i.a*Math.pow(2,-10*--t)*Math.sin((t*n-i.s)*(2*Math.PI)/i.p)*.5+i.c+e},easeInBack:function(t,e,i,n,r){return i*(t/=n)*t*(((r=void 0===r?1.70158:r)+1)*t-r)+e},easeOutBack:function(t,e,i,n,r){return i*((t=t/n-1)*t*(((r=void 0===r?1.70158:r)+1)*t+r)+1)+e},easeInOutBack:function(t,e,i,n,r){return void 0===r&&(r=1.70158),(t/=n/2)<1?i/2*(t*t*((1+(r*=1.525))*t-r))+e:i/2*((t-=2)*t*((1+(r*=1.525))*t+r)+2)+e},easeInBounce:nt,easeOutBounce:rt,easeInOutBounce:function(t,e,i,n){return t<n/2?.5*nt(2*t,0,i,n)+e:.5*rt(2*t-n,0,i,n)+.5*i+e}},function(t){"use strict";var u,e,f,i,n,b=t.fabric||(t.fabric={}),d=b.util.object.extend,p=b.util.object.clone,g=b.util.toFixed,w=b.util.parseUnit,m=b.util.multiplyTransformMatrices,v={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},y={stroke:"strokeOpacity",fill:"fillOpacity"},x="font-size",_="clip-path";function r(t){return new RegExp("^("+t.join("|")+")\\b","i")}function S(t,e){for(var i,n=[],r=0,o=e.length;r<o;r++)i=e[r],i=t.getElementsByTagName(i),n=n.concat(Array.prototype.slice.call(i));return n}function C(t,e){var i,n=t.nodeName,r=t.getAttribute("class"),t=t.getAttribute("id"),o=new RegExp("^"+n,"i");if(e=e.replace(o,""),t&&e.length&&(o=new RegExp("#"+t+"(?![a-zA-Z\\-]+)","i"),e=e.replace(o,"")),r&&e.length)for(i=(r=r.split(" ")).length;i--;)o=new RegExp("\\."+r[i]+"(?![a-zA-Z\\-]+)","i"),e=e.replace(o,"");return 0===e.length}function A(t,e){var i;if(i=t.getElementById?t.getElementById(e):i)return i;for(var n,r=t.getElementsByTagName("*"),o=0,s=r.length;o<s;o++)if(e===(n=r[o]).getAttribute("id"))return n}function L(t,e,i){t[i]=Math.tan(b.util.degreesToRadians(e[0]))}b.svgValidTagNamesRegEx=r(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),b.svgViewBoxElementsRegEx=r(["symbol","image","marker","pattern","view","svg"]),b.svgInvalidAncestorsRegEx=r(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),b.svgValidParentsRegEx=r(["symbol","g","a","svg","clipPath","defs"]),b.cssRules={},b.gradientDefs={},b.clipPaths={},b.parseTransformAttribute=(u=b.iMatrix,e=b.reNum,t=b.commaWsp,f="(?:(?:(matrix)\\s*\\(\\s*("+e+")"+t+"("+e+")"+t+"("+e+")"+t+"("+e+")"+t+"("+e+")"+t+"("+e+")\\s*\\))|(?:(translate)\\s*\\(\\s*("+e+")(?:"+t+"("+e+"))?\\s*\\))|(?:(scale)\\s*\\(\\s*("+e+")(?:"+t+"("+e+"))?\\s*\\))|(?:(rotate)\\s*\\(\\s*("+e+")(?:"+t+"("+e+")"+t+"("+e+"))?\\s*\\))|(?:(skewX)\\s*\\(\\s*("+e+")\\s*\\))|(?:(skewY)\\s*\\(\\s*("+e+")\\s*\\)))",i=new RegExp("^\\s*(?:(?:"+f+"(?:"+t+"*"+f+")*)?)\\s*$"),n=new RegExp(f,"g"),function(t){var c=u.concat(),l=[];if(!t||!i.test(t))return c;t.replace(n,function(t){var e,i,n,r,o,s,a=new RegExp(f).exec(t).filter(function(t){return!!t}),t=a[1],h=a.slice(2).map(parseFloat);switch(t){case"translate":s=h,(o=c)[4]=s[0],2===s.length&&(o[5]=s[1]);break;case"rotate":h[0]=b.util.degreesToRadians(h[0]),e=c,o=h,i=b.util.cos(o[0]),s=b.util.sin(o[0]),r=n=0,3===o.length&&(n=o[1],r=o[2]),e[0]=i,e[1]=s,e[2]=-s,e[3]=i,e[4]=n-(i*n-s*r),e[5]=r-(s*n+i*r);break;case"scale":n=c,i=h[0],r=2===h.length?h[1]:h[0],n[0]=i,n[3]=r;break;case"skewX":L(c,h,2);break;case"skewY":L(c,h,1);break;case"matrix":c=h}l.push(c.concat()),c=u.concat()});for(var e=l[0];1<l.length;)l.shift(),e=b.util.multiplyTransformMatrices(e,l[0]);return e});var T=new RegExp("^\\s*("+b.reNum+"+)\\s*,?\\s*("+b.reNum+"+)\\s*,?\\s*("+b.reNum+"+)\\s*,?\\s*("+b.reNum+"+)\\s*$");function P(t){if(b.svgViewBoxElementsRegEx.test(t.nodeName)){var e,i,n,r=t.getAttribute("viewBox"),o=1,s=1,a=t.getAttribute("width"),h=t.getAttribute("height"),c=t.getAttribute("x")||0,l=t.getAttribute("y")||0,u=t.getAttribute("preserveAspectRatio")||"",f=!r||!(r=r.match(T)),d=!a||!h||"100%"===a||"100%"===h,p=f&&d,g={},m="",v=0,y=0;if(g.width=0,g.height=0,g.toBeParsed=p,f&&(c||l)&&"#document"!==t.parentNode.nodeName&&(m=" translate("+w(c)+" "+w(l)+") ",i=(t.getAttribute("transform")||"")+m,t.setAttribute("transform",i),t.removeAttribute("x"),t.removeAttribute("y")),p)return g;if(f)return g.width=w(a),g.height=w(h),g;if(e=-parseFloat(r[1]),p=-parseFloat(r[2]),f=parseFloat(r[3]),r=parseFloat(r[4]),g.minX=e,g.minY=p,g.viewBoxWidth=f,g.viewBoxHeight=r,d?(g.width=f,g.height=r):(g.width=w(a),g.height=w(h),o=g.width/f,s=g.height/r),"none"!==(u=b.util.parsePreserveAspectRatioAttribute(u)).alignX&&("meet"===u.meetOrSlice&&(s=o=s<o?s:o),"slice"===u.meetOrSlice&&(s=o=s<o?o:s),v=g.width-f*o,y=g.height-r*o,"Mid"===u.alignX&&(v/=2),"Mid"===u.alignY&&(y/=2),"Min"===u.alignX&&(v=0),"Min"===u.alignY&&(y=0)),1===o&&1===s&&0==e&&0==p&&0===c&&0===l)return g;if(i=(m=(c||l)&&"#document"!==t.parentNode.nodeName?" translate("+w(c)+" "+w(l)+") ":m)+" matrix("+o+" 0 0 "+s+" "+(e*o+v)+" "+(p*s+y)+") ","svg"===t.nodeName){for(n=t.ownerDocument.createElementNS(b.svgNS,"g");t.firstChild;)n.appendChild(t.firstChild);t.appendChild(n)}else(n=t).removeAttribute("x"),n.removeAttribute("y"),i=n.getAttribute("transform")+i;return n.setAttribute("transform",i),g}}b.parseSVGDocument=function(t,i,e,n){if(t){!function(t){for(var e=S(t,["use","svg:use"]),i=0;e.length&&i<e.length;){var n,r,o=e[i],s=(o.getAttribute("xlink:href")||o.getAttribute("href")).substr(1),a=o.getAttribute("x")||0,h=o.getAttribute("y")||0,c=A(t,s).cloneNode(!0),l=(c.getAttribute("transform")||"")+" translate("+a+", "+h+")",h=e.length,u=b.svgNS;if(P(c),/^svg$/i.test(c.nodeName)){for(var f=c.ownerDocument.createElementNS(u,"g"),d=0,p=(r=c.attributes).length;d<p;d++)n=r.item(d),f.setAttributeNS(u,n.nodeName,n.nodeValue);for(;c.firstChild;)f.appendChild(c.firstChild);c=f}for(d=0,p=(r=o.attributes).length;d<p;d++)"x"!==(n=r.item(d)).nodeName&&"y"!==n.nodeName&&"xlink:href"!==n.nodeName&&"href"!==n.nodeName&&("transform"===n.nodeName?l=n.nodeValue+" "+l:c.setAttribute(n.nodeName,n.nodeValue));c.setAttribute("transform",l),c.setAttribute("instantiated_by_use","1"),c.removeAttribute("id"),o.parentNode.replaceChild(c,o),e.length===h&&i++}}(t);var r=b.Object.__uid++,o=P(t),s=b.util.toArray(t.getElementsByTagName("*"));if(o.crossOrigin=n&&n.crossOrigin,o.svgUid=r,0===s.length&&b.isLikelyNode){for(var a=[],h=0,c=(s=t.selectNodes('//*[name(.)!="svg"]')).length;h<c;h++)a[h]=s[h];s=a}var l,u=s.filter(function(t){return P(t),b.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))&&!function(t,e){for(;t=t&&t.parentNode;)if(t.nodeName&&e.test(t.nodeName.replace("svg:",""))&&!t.getAttribute("instantiated_by_use"))return 1}(t,b.svgInvalidAncestorsRegEx)});u&&u.length?(l={},s.filter(function(t){return"clipPath"===t.nodeName.replace("svg:","")}).forEach(function(t){var e=t.getAttribute("id");l[e]=b.util.toArray(t.getElementsByTagName("*")).filter(function(t){return b.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))})}),b.gradientDefs[r]=b.getGradientDefs(t),b.cssRules[r]=b.getCSSRules(t),b.clipPaths[r]=l,b.parseElements(u,function(t,e){i&&(i(t,o,e,s),delete b.gradientDefs[r],delete b.cssRules[r],delete b.clipPaths[r])},p(o),e,n)):i&&i([],{})}};var s=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+b.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+b.reNum+"))?\\s+(.*)");d(b,{parseFontDeclaration:function(t,e){var i,n,r,o=t.match(s);o&&(i=o[1],n=o[3],r=o[4],t=o[5],o=o[6],i&&(e.fontStyle=i),n&&(e.fontWeight=isNaN(parseFloat(n))?n:parseFloat(n)),r&&(e.fontSize=w(r)),o&&(e.fontFamily=o),t&&(e.lineHeight="normal"===t?1:t))},getGradientDefs:function(t){for(var e,i=S(t,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),n=0,r={},n=i.length;n--;)(e=i[n]).getAttribute("xlink:href")&&function t(e,i){var n="xlink:href",r=A(e,i.getAttribute(n).substr(1));if(r&&r.getAttribute(n)&&t(e,r),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach(function(t){r&&!i.hasAttribute(t)&&r.hasAttribute(t)&&i.setAttribute(t,r.getAttribute(t))}),!i.children.length)for(var o=r.cloneNode(!0);o.firstChild;)i.appendChild(o.firstChild);i.removeAttribute(n)}(t,e),r[e.getAttribute("id")]=e;return r},parseAttributes:function(i,t,e){if(i){var n,r,o={};void 0===e&&(e=i.getAttribute("svgUid")),i.parentNode&&b.svgValidParentsRegEx.test(i.parentNode.nodeName)&&(o=b.parseAttributes(i.parentNode,t,e));var s=t.reduce(function(t,e){return(n=i.getAttribute(e))&&(t[e]=n),t},{}),e=d(function(t,e){var i,n,r,o,s,a={};for(i in b.cssRules[e])if(n=t,r=i.split(" "),o=void 0,void 0,s=!0,(o=C(n,r.pop()))&&r.length&&(s=function(t,e){for(var i,n=!0;t.parentNode&&1===t.parentNode.nodeType&&e.length;)n&&(i=e.pop()),n=C(t=t.parentNode,i);return 0===e.length}(n,r)),o&&s&&0===r.length)for(var h in b.cssRules[e][i])a[h]=b.cssRules[e][i][h];return a}(i,e),b.parseStyleAttribute(i)),s=d(s,e);e[_]&&i.setAttribute(_,e[_]),r=e=o.fontSize||b.Text.DEFAULT_SVG_FONT_SIZE,s[x]&&(s[x]=r=w(s[x],e));var a,h,c={};for(h in s)l=function(t,e,i,n){var r,o="[object Array]"===Object.prototype.toString.call(e);if("fill"!==t&&"stroke"!==t||"none"!==e){if("strokeUniform"===t)return"non-scaling-stroke"===e;if("strokeDashArray"===t)e="none"===e?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if("transformMatrix"===t)e=i&&i.transformMatrix?m(i.transformMatrix,b.parseTransformAttribute(e)):b.parseTransformAttribute(e);else if("visible"===t)e="none"!==e&&"hidden"!==e,i&&!1===i.visible&&(e=!1);else if("opacity"===t)e=parseFloat(e),i&&void 0!==i.opacity&&(e*=i.opacity);else if("textAnchor"===t)e="start"===e?"left":"end"===e?"right":"center";else if("charSpacing"===t)r=w(e,n)/n*1e3;else if("paintFirst"===t){var s=e.indexOf("fill"),i=e.indexOf("stroke");e=-1<s&&-1<i&&i<s||-1===s&&-1<i?"stroke":"fill"}else{if("href"===t||"xlink:href"===t||"font"===t)return e;if("imageSmoothing"===t)return"optimizeQuality"===e;r=o?e.map(w):w(e,n)}}else e="";return!o&&isNaN(r)?e:r}((l=h,a=l in v?v[l]:l),s[h],o,r),c[a]=l;c&&c.font&&b.parseFontDeclaration(c.font,c);e=d(o,c);return b.svgValidParentsRegEx.test(i.nodeName)?e:function(t){for(var e in y)if(void 0!==t[y[e]]&&""!==t[e]){if(void 0===t[e]){if(!b.Object.prototype[e])continue;t[e]=b.Object.prototype[e]}var i;0!==t[e].indexOf("url(")&&(i=new b.Color(t[e]),t[e]=i.setAlpha(g(i.getAlpha()*t[y[e]],2)).toRgba())}return t}(e)}var l},parseElements:function(t,e,i,n,r){new b.ElementsParser(t,e,i,n,r).parse()},parseStyleAttribute:function(t){var e,i,n,r={},t=t.getAttribute("style");return t&&("string"==typeof t?(e=r,t.replace(/;\s*$/,"").split(";").forEach(function(t){t=t.split(":");i=t[0].trim().toLowerCase(),n=t[1].trim(),e[i]=n})):function(t,e){var i,n,r;for(r in t)void 0!==t[r]&&(i=r.toLowerCase(),n=t[r],e[i]=n)}(t,r)),r},parsePointsAttribute:function(t){if(!t)return null;for(var e=[],i=0,n=(t=(t=t.replace(/,/g," ").trim()).split(/\s+/)).length;i<n;i+=2)e.push({x:parseFloat(t[i]),y:parseFloat(t[i+1])});return e},getCSSRules:function(t){for(var e=t.getElementsByTagName("style"),s={},a=0,h=e.length;a<h;a++){var i=e[a].textContent;""!==(i=i.replace(/\/\*[\s\S]*?\*\//g,"")).trim()&&i.match(/[^{]*\{[\s\S]*?\}/g).map(function(t){return t.trim()}).forEach(function(t){var e=t.match(/([\s\S]*?)\s*\{([^}]*)\}/),i={},n=e[2].trim().replace(/;$/,"").split(/\s*;\s*/);for(a=0,h=n.length;a<h;a++){var r=n[a].split(/\s*:\s*/),o=r[0],r=r[1];i[o]=r}(t=e[1]).split(",").forEach(function(t){""!==(t=t.replace(/^svg/i,"").trim())&&(s[t]?b.util.object.extend(s[t],i):s[t]=b.util.object.clone(i))})})}return s},loadSVGFromURL:function(t,r,e,i){t=t.replace(/^\n\s*/,"").trim(),new b.util.request(t,{method:"get",onComplete:function(t){t=t.responseXML;if(!t||!t.documentElement)return r&&r(null),!1;b.parseSVGDocument(t.documentElement,function(t,e,i,n){r&&r(t,e,i,n)},e,i)}})},loadSVGFromString:function(t,r,e,i){t=(new b.window.DOMParser).parseFromString(t.trim(),"text/xml");b.parseSVGDocument(t.documentElement,function(t,e,i,n){r(t,e,i,n)},e,i)}})}(i),Y.ElementsParser=function(t,e,i,n,r,o){this.elements=t,this.callback=e,this.options=i,this.reviver=n,this.svgUid=i&&i.svgUid||0,this.parsingOptions=r,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=o},(T=Y.ElementsParser.prototype).parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},T.createObjects=function(){var i=this;this.elements.forEach(function(t,e){t.setAttribute("svgUid",i.svgUid),i.createObject(t,e)})},T.findTag=function(t){return Y[Y.util.string.capitalize(t.tagName.replace("svg:",""))]},T.createObject=function(t,e){var i=this.findTag(t);if(i&&i.fromElement)try{i.fromElement(t,this.createCallback(e,t),this.options)}catch(t){Y.log(t)}else this.checkIfDone()},T.createCallback=function(i,n){var r=this;return function(t){var e;r.resolveGradient(t,n,"fill"),r.resolveGradient(t,n,"stroke"),t instanceof Y.Image&&t._originalElement&&(e=t.parsePreserveAspectRatioAttribute(n)),t._removeTransformMatrix(e),r.resolveClipPath(t,n),r.reviver&&r.reviver(n,t),r.instances[i]=t,r.checkIfDone()}},T.extractPropertyDefinition=function(t,e,i){t=t[e],e=this.regexUrl;if(e.test(t)){e.lastIndex=0;t=e.exec(t)[1];return e.lastIndex=0,Y[i][this.svgUid][t]}},T.resolveGradient=function(t,e,i){var n=this.extractPropertyDefinition(t,i,"gradientDefs");n&&(e=e.getAttribute(i+"-opacity"),e=Y.Gradient.fromElement(n,t,e,this.options),t.set(i,e))},T.createClipPathCallback=function(t,e){return function(t){t._removeTransformMatrix(),t.fillRule=t.clipRule,e.push(t)}},T.resolveClipPath=function(t,e){var i,n=this.extractPropertyDefinition(t,"clipPath","clipPaths");if(n){for(var r=[],o=Y.util.invertTransform(t.calcTransformMatrix()),s=n[0].parentNode,a=e;a.parentNode&&a.getAttribute("clip-path")!==t.clipPath;)a=a.parentNode;a.parentNode.appendChild(s);for(var h=0;h<n.length;h++)i=n[h],this.findTag(i).fromElement(i,this.createClipPathCallback(t,r),this.options);n=1===r.length?r[0]:new Y.Group(r),o=Y.util.multiplyTransformMatrices(o,n.calcTransformMatrix()),n.clipPath&&this.resolveClipPath(n,a);o=Y.util.qrDecompose(o);n.flipX=!1,n.flipY=!1,n.set("scaleX",o.scaleX),n.set("scaleY",o.scaleY),n.angle=o.angle,n.skewX=o.skewX,n.skewY=0,n.setPositionByOrigin({x:o.translateX,y:o.translateY},"center","center"),t.clipPath=n}else delete t.clipPath},T.checkIfDone=function(){0==--this.numElements&&(this.instances=this.instances.filter(function(t){return null!=t}),this.callback(this.instances,this.elements))},function(t){"use strict";t=t.fabric||(t.fabric={});function i(t,e){this.x=t,this.y=e}t.Point?t.warn("fabric.Point is already defined"):(t.Point=i).prototype={type:"point",constructor:i,add:function(t){return new i(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new i(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new i(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new i(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new i(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new i(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,e){return void 0===e&&(e=.5),e=Math.max(Math.min(1,e),0),new i(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)},distanceFrom:function(t){var e=this.x-t.x,t=this.y-t.y;return Math.sqrt(e*e+t*t)},midPointFrom:function(t){return this.lerp(t)},min:function(t){return new i(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new i(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setFromPoint:function(t){return this.x=t.x,this.y=t.y,this},swap:function(t){var e=this.x,i=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=i},clone:function(){return new i(this.x,this.y)}}}(i),function(t){"use strict";var a=t.fabric||(t.fabric={});function h(t){this.status=t,this.points=[]}a.Intersection?a.warn("fabric.Intersection is already defined"):(a.Intersection=h,a.Intersection.prototype={constructor:h,appendPoint:function(t){return this.points.push(t),this},appendPoints:function(t){return this.points=this.points.concat(t),this}},a.Intersection.intersectLineLine=function(t,e,i,n){var r,o=(n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x),s=(e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x),n=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y);return 0!=n?(i=s/n,0<=(n=o/n)&&n<=1&&0<=i&&i<=1?(r=new h("Intersection")).appendPoint(new a.Point(t.x+n*(e.x-t.x),t.y+n*(e.y-t.y))):r=new h):r=new h(0==o||0==s?"Coincident":"Parallel"),r},a.Intersection.intersectLinePolygon=function(t,e,i){for(var n,r,o=new h,s=i.length,a=0;a<s;a++)n=i[a],r=i[(a+1)%s],r=h.intersectLineLine(t,e,n,r),o.appendPoints(r.points);return 0<o.points.length&&(o.status="Intersection"),o},a.Intersection.intersectPolygonPolygon=function(t,e){for(var i=new h,n=t.length,r=0;r<n;r++){var o=t[r],s=t[(r+1)%n],s=h.intersectLinePolygon(o,s,e);i.appendPoints(s.points)}return 0<i.points.length&&(i.status="Intersection"),i},a.Intersection.intersectPolygonRectangle=function(t,e,i){var n=e.min(i),r=e.max(i),o=new a.Point(r.x,n.y),e=new a.Point(n.x,r.y),i=h.intersectLinePolygon(n,o,t),o=h.intersectLinePolygon(o,r,t),r=h.intersectLinePolygon(r,e,t),n=h.intersectLinePolygon(e,n,t),t=new h;return t.appendPoints(i.points),t.appendPoints(o.points),t.appendPoints(r.points),t.appendPoints(n.points),0<t.points.length&&(t.status="Intersection"),t})}(i),function(t){"use strict";var c=t.fabric||(t.fabric={});function a(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function h(t,e,i){return i<0&&(i+=1),1<i&&--i,i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}c.Color?c.warn("fabric.Color is already defined."):(c.Color=a,c.Color.prototype={_tryParsingColor:function(t){var e;(e=(e=(e=(e=(e="transparent"===(t=t in a.colorNameMap?a.colorNameMap[t]:t)?[255,255,255,0]:e)||a.sourceFromHex(t))||a.sourceFromRgb(t))||a.sourceFromHsl(t))||[0,0,0,1])&&this.setSource(e)},_rgbToHsl:function(t,e,i){var n,r=c.util.array.max([t/=255,e/=255,i/=255]),o=c.util.array.min([t,e,i]),s=(r+o)/2;if(r===o)n=h=0;else{var a=r-o,h=.5<s?a/(2-r-o):a/(r+o);switch(r){case t:n=(e-i)/a+(e<i?6:0);break;case e:n=(i-t)/a+2;break;case i:n=(t-e)/a+4}n/=6}return[Math.round(360*n),Math.round(100*h),Math.round(100*s)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),t=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+t[0]+","+t[1]+"%,"+t[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t=this.getSource(),e=1===(e=t[0].toString(16)).length?"0"+e:e,i=1===(i=t[1].toString(16)).length?"0"+i:i,t=1===(t=t[2].toString(16)).length?"0"+t:t;return e.toUpperCase()+i.toUpperCase()+t.toUpperCase()},toHexa:function(){var t=this.getSource(),t=1===(t=(t=Math.round(255*t[3])).toString(16)).length?"0"+t:t;return this.toHex()+t.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),t=t[3];return this.setSource([e,e,e,t]),this},toBlackWhite:function(t){var e=this.getSource(),i=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),e=e[3];return t=t||127,i=Number(i)<Number(t)?0:255,this.setSource([i,i,i,e]),this},overlayWith:function(t){t instanceof a||(t=new a(t));for(var e=[],i=this.getAlpha(),n=this.getSource(),r=t.getSource(),o=0;o<3;o++)e.push(Math.round(.5*n[o]+.5*r[o]));return e[3]=i,this.setSource(e),this}},c.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,c.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,c.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,c.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},c.Color.fromRgb=function(t){return a.fromSource(a.sourceFromRgb(t))},c.Color.sourceFromRgb=function(t){var e=t.match(a.reRGBa);if(e){var i=parseInt(e[1],10)/(/%$/.test(e[1])?100:1)*(/%$/.test(e[1])?255:1),n=parseInt(e[2],10)/(/%$/.test(e[2])?100:1)*(/%$/.test(e[2])?255:1),t=parseInt(e[3],10)/(/%$/.test(e[3])?100:1)*(/%$/.test(e[3])?255:1);return[parseInt(i,10),parseInt(n,10),parseInt(t,10),e[4]?parseFloat(e[4]):1]}},c.Color.fromRgba=a.fromRgb,c.Color.fromHsl=function(t){return a.fromSource(a.sourceFromHsl(t))},c.Color.sourceFromHsl=function(t){var e=t.match(a.reHSLa);if(e){var i,n,r,o=(parseFloat(e[1])%360+360)%360/360,s=parseFloat(e[2])/(/%$/.test(e[2])?100:1),t=parseFloat(e[3])/(/%$/.test(e[3])?100:1);return 0==s?i=n=r=t:(i=h(s=2*t-(t=t<=.5?t*(1+s):t+s-t*s),t,o+1/3),n=h(s,t,o),r=h(s,t,o-1/3)),[Math.round(255*i),Math.round(255*n),Math.round(255*r),e[4]?parseFloat(e[4]):1]}},c.Color.fromHsla=a.fromHsl,c.Color.fromHex=function(t){return a.fromSource(a.sourceFromHex(t))},c.Color.sourceFromHex=function(t){if(t.match(a.reHex)){var e=t.slice(t.indexOf("#")+1),i=3===e.length||4===e.length,n=8===e.length||4===e.length,r=i?e.charAt(0)+e.charAt(0):e.substring(0,2),o=i?e.charAt(1)+e.charAt(1):e.substring(2,4),t=i?e.charAt(2)+e.charAt(2):e.substring(4,6),e=n?i?e.charAt(3)+e.charAt(3):e.substring(6,8):"FF";return[parseInt(r,16),parseInt(o,16),parseInt(t,16),parseFloat((parseInt(e,16)/255).toFixed(2))]}},c.Color.fromSource=function(t){var e=new a;return e.setSource(t),e})}(i),function(t){"use strict";var a=t.fabric||(t.fabric={}),r=["e","se","s","sw","w","nw","n","ne","e"],o=["ns","nesw","ew","nwse"],s={},c="left",l="top",u="right",f="bottom",h="center",m={top:f,bottom:l,left:u,right:c,center:h},d=a.util.radiansToDegrees,v=Math.sign||function(t){return(0<t)-(t<0)||+t};function p(t,e){e=t.angle+d(Math.atan2(e.y,e.x))+360;return Math.round(e%360/45)}function y(t,e){var i=e.transform.target,n=i.canvas,r=a.util.object.clone(e);r.target=i,n&&n.fire("object:"+t,r),i.fire(t,e)}function b(t,e){e=e.canvas,t=t[e.uniScaleKey];return e.uniformScaling&&!t||!e.uniformScaling&&t}function w(t){return t.originX===h&&t.originY===h}function x(t,e,i){var n=t.lockScalingX,t=t.lockScalingY;return!((!n||!t)&&(e||!n&&!t||!i)&&(!n||"x"!==e)&&(!t||"y"!==e))}function _(t,e,i,n){return{e:t,transform:e,pointer:{x:i,y:n}}}function g(s){return function(t,e,i,n){var r=e.target,o=r.getCenterPoint(),o=r.translateToOriginPoint(o,e.originX,e.originY),n=s(t,e,i,n);return r.setPositionByOrigin(o,e.originX,e.originY),n}}function S(t,e,i,n,r){var o=t.target,s=o.controls[t.corner],t=o.canvas.getZoom(),t=o.padding/t,i=o.toLocalPoint(new a.Point(n,r),e,i);return i.x>=t&&(i.x-=t),i.x<=-t&&(i.x+=t),i.y>=t&&(i.y-=t),i.y<=t&&(i.y+=t),i.x-=s.offsetX,i.y-=s.offsetY,i}function C(t){return t.flipX!==t.flipY}function A(t,e,i,n,r){0!==t[e]&&(n=r/t._getTransformedDimensions()[n]*t[i],t.set(i,n))}function L(t,e,i,n){var r,o=e.target,s=o._getTransformedDimensions(0,o.skewY),a=S(e,e.originX,e.originY,i,n),h=Math.abs(2*a.x)-s.x,a=o.skewX;h<2?r=0:(r=d(Math.atan2(h/o.scaleX,s.y/o.scaleY)),e.originX===c&&e.originY===f&&(r=-r),e.originX===u&&e.originY===l&&(r=-r),C(o)&&(r=-r));s=a!==r;return s&&(a=o._getTransformedDimensions().y,o.set("skewX",r),A(o,"skewY","scaleY","y",a),y("skewing",_(t,e,i,n))),s}function T(t,e,i,n){var r,o=e.target,s=o._getTransformedDimensions(o.skewX,0),a=S(e,e.originX,e.originY,i,n),h=Math.abs(2*a.y)-s.y,a=o.skewY;h<2?r=0:(r=d(Math.atan2(h/o.scaleY,s.x/o.scaleX)),e.originX===c&&e.originY===f&&(r=-r),e.originX===u&&e.originY===l&&(r=-r),C(o)&&(r=-r));s=a!==r;return s&&(a=o._getTransformedDimensions().x,o.set("skewY",r),A(o,"skewX","scaleX","x",a),y("skewing",_(t,e,i,n))),s}function P(t,e,i,n,r){var o=e.target,s=o.lockScalingX,a=o.lockScalingY,h=(r=r||{}).by,c=b(t,o),l=x(o,h,c),u=e.gestureScale;if(l)return!1;if(u)f=e.scaleX*u,d=e.scaleY*u;else{if(r=S(e,e.originX,e.originY,i,n),p="y"!==h?v(r.x):1,g="x"!==h?v(r.y):1,e.signX||(e.signX=p),e.signY||(e.signY=g),o.lockScalingFlip&&(e.signX!==p||e.signY!==g))return!1;var f,d,l=o._getTransformedDimensions();d=c&&!h?(u=Math.abs(r.x)+Math.abs(r.y),c=e.original,u=u/(Math.abs(l.x*c.scaleX/o.scaleX)+Math.abs(l.y*c.scaleY/o.scaleY)),f=c.scaleX*u,c.scaleY*u):(f=Math.abs(r.x*o.scaleX/l.x),Math.abs(r.y*o.scaleY/l.y)),w(e)&&(f*=2,d*=2),e.signX!==p&&"y"!==h&&(e.originX=m[e.originX],f*=-1,e.signX=p),e.signY!==g&&"x"!==h&&(e.originY=m[e.originY],d*=-1,e.signY=g)}var p=o.scaleX,g=o.scaleY;return h?("x"===h&&o.set("scaleX",f),"y"===h&&o.set("scaleY",d)):(s||o.set("scaleX",f),a||o.set("scaleY",d)),(o=p!==o.scaleX||g!==o.scaleY)&&y("scaling",_(t,e,i,n)),o}s.scaleCursorStyleHandler=function(t,e,i){var n=b(t,i),t="";if(0!==e.x&&0===e.y?t="x":0===e.x&&0!==e.y&&(t="y"),x(i,t,n))return"not-allowed";e=p(i,e);return r[e]+"-resize"},s.skewCursorStyleHandler=function(t,e,i){var n="not-allowed";if(0!==e.x&&i.lockSkewingY)return n;if(0!==e.y&&i.lockSkewingX)return n;e=p(i,e)%4;return o[e]+"-resize"},s.scaleSkewCursorStyleHandler=function(t,e,i){return t[i.canvas.altActionKey]?s.skewCursorStyleHandler(t,e,i):s.scaleCursorStyleHandler(t,e,i)},s.rotationWithSnapping=g(function(t,e,i,n){var r=e,o=r.target,s=o.translateToOriginPoint(o.getCenterPoint(),r.originX,r.originY);if(o.lockRotation)return!1;var a,h=Math.atan2(r.ey-s.y,r.ex-s.x),s=Math.atan2(n-s.y,i-s.x),s=d(s-h+r.theta);return 0<o.snapAngle&&(h=o.snapAngle,r=o.snapThreshold||h,a=Math.ceil(s/h)*h,h=Math.floor(s/h)*h,Math.abs(s-h)<r?s=h:Math.abs(s-a)<r&&(s=a)),s<0&&(s=360+s),a=o.angle!==(s%=360),o.angle=s,a&&y("rotating",_(t,e,i,n)),a}),s.scalingEqually=g(function(t,e,i,n){return P(t,e,i,n)}),s.scalingX=g(function(t,e,i,n){return P(t,e,i,n,{by:"x"})}),s.scalingY=g(function(t,e,i,n){return P(t,e,i,n,{by:"y"})}),s.scalingYOrSkewingX=function(t,e,i,n){return t[e.target.canvas.altActionKey]?s.skewHandlerX(t,e,i,n):s.scalingY(t,e,i,n)},s.scalingXOrSkewingY=function(t,e,i,n){return t[e.target.canvas.altActionKey]?s.skewHandlerY(t,e,i,n):s.scalingX(t,e,i,n)},s.changeWidth=g(function(t,e,i,n){var r=e.target,o=S(e,e.originX,e.originY,i,n),s=r.strokeWidth/(r.strokeUniform?r.scaleX:1),a=w(e)?2:1,h=r.width,s=Math.abs(o.x*a/r.scaleX)-s;return r.set("width",Math.max(s,0)),(s=h!==s)&&y("resizing",_(t,e,i,n)),s}),s.skewHandlerX=function(t,e,i,n){var r,o=e.target,s=o.skewX,a=e.originY;return!o.lockSkewingX&&(0===s?r=0<S(e,h,h,i,n).x?c:u:(0<s&&(r=a===l?c:u),s<0&&(r=a===l?u:c),C(o)&&(r=r===c?u:c)),e.originX=r,g(L)(t,e,i,n))},s.skewHandlerY=function(t,e,i,n){var r,o=e.target,s=o.skewY,a=e.originX;return!o.lockSkewingY&&(0===s?r=0<S(e,h,h,i,n).y?l:f:(0<s&&(r=a===c?l:f),s<0&&(r=a===c?f:l),C(o)&&(r=r===l?f:l)),e.originY=r,g(T)(t,e,i,n))},s.dragHandler=function(t,e,i,n){var r=e.target,o=i-e.offsetX,s=n-e.offsetY,a=!r.get("lockMovementX")&&r.left!==o,h=!r.get("lockMovementY")&&r.top!==s;return a&&r.set("left",o),h&&r.set("top",s),(a||h)&&y("moving",_(t,e,i,n)),a||h},s.scaleOrSkewActionName=function(t,e,i){i=t[i.canvas.altActionKey];return 0===e.x?i?"skewX":"scaleY":0===e.y?i?"skewY":"scaleX":void 0},s.rotationStyleHandler=function(t,e,i){return i.lockRotation?"not-allowed":e.cursorStyle},s.fireEvent=y,s.wrapWithFixedAnchor=g,s.getLocalPoint=S,a.controlsUtils=s}(i),function(t){"use strict";var t=t.fabric||(t.fabric={}),u=t.util.degreesToRadians,t=t.controlsUtils;t.renderCircleControl=function(t,e,i,n,r){n=n||{};var o,s=this.sizeX||n.cornerSize||r.cornerSize,a=this.sizeY||n.cornerSize||r.cornerSize,h=(void 0!==n.transparentCorners?n:this).transparentCorners,c=h?"stroke":"fill",l=!h&&(n.cornerStrokeColor||r.cornerStrokeColor),u=e,h=i;t.save(),t.fillStyle=n.cornerColor||r.cornerColor,t.strokeStyle=n.cornerStrokeColor||r.cornerStrokeColor,a<s?(t.scale(1,a/(o=s)),h=i*s/a):s<a?(t.scale(s/(o=a),1),u=e*a/s):o=s,t.lineWidth=1,t.beginPath(),t.arc(u,h,o/2,0,2*Math.PI,!1),t[c](),l&&t.stroke(),t.restore()},t.renderSquareControl=function(t,e,i,n,r){n=n||{};var o=this.sizeX||n.cornerSize||r.cornerSize,s=this.sizeY||n.cornerSize||r.cornerSize,a=(void 0!==n.transparentCorners?n:r).transparentCorners,h=a?"stroke":"fill",c=!a&&(n.cornerStrokeColor||r.cornerStrokeColor),l=o/2,a=s/2;t.save(),t.fillStyle=n.cornerColor||r.cornerColor,t.strokeStyle=n.strokeCornerColor||r.strokeCornerColor,t.lineWidth=1,t.translate(e,i),t.rotate(u(r.angle)),t[h+"Rect"](-l,-a,o,s),c&&t.strokeRect(-l,-a,o,s),t.restore()}}(i),function(t){"use strict";var f=t.fabric||(t.fabric={});f.Control=function(t){for(var e in t)this[e]=t[e]},f.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(t,e){return e.cursorStyle},getActionName:function(t,e){return e.actionName},getVisibility:function(t,e){t=t._controlsVisibility;return t&&void 0!==t[e]?t[e]:this.visible},setVisibility:function(t){this.visible=t},positionHandler:function(t,e){return f.util.transformPoint({x:this.x*t.x+this.offsetX,y:this.y*t.y+this.offsetY},e)},calcCornerCoords:function(t,e,i,n,r){var o,s,a,h,c,l,u=r?this.touchSizeX:this.sizeX,r=r?this.touchSizeY:this.sizeY;return u&&r&&u!==r?(c=Math.atan2(r,u),o=Math.sqrt(u*u+r*r)/2,s=c-f.util.degreesToRadians(t),l=Math.PI/2-c-f.util.degreesToRadians(t),a=o*f.util.cos(s),h=o*f.util.sin(s),c=o*f.util.cos(l),l=o*f.util.sin(l)):(o=.7071067812*(u&&r?u:e),s=f.util.degreesToRadians(45-t),a=c=o*f.util.cos(s),h=l=o*f.util.sin(s)),{tl:{x:i-l,y:n-c},tr:{x:i+a,y:n-h},bl:{x:i-a,y:n+h},br:{x:i+l,y:n+c}}},render:function(t,e,i,n,r){("circle"===((n=n||{}).cornerStyle||r.cornerStyle)?f.controlsUtils.renderCircleControl:f.controlsUtils.renderSquareControl).call(this,t,e,i,n,r)}}}(i),R=Y.util.object.clone,Y.Gradient=Y.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(e){(e=e||{}).coords||(e.coords={});var t,i=this;Object.keys(e).forEach(function(t){i[t]=e[t]}),this.id?this.id+="_"+Y.Object.__uid++:this.id=Y.Object.__uid++,t={x1:e.coords.x1||0,y1:e.coords.y1||0,x2:e.coords.x2||0,y2:e.coords.y2||0},"radial"===this.type&&(t.r1=e.coords.r1||0,t.r2=e.coords.r2||0),this.coords=t,this.colorStops=e.colorStops.slice()},addColorStop:function(t){for(var e in t){var i=new Y.Color(t[e]);this.colorStops.push({offset:parseFloat(e),color:i.toRgb(),opacity:i.getAlpha()})}return this},toObject:function(t){var e={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform&&this.gradientTransform.concat()};return Y.util.populateWithProperties(this,e,t),e},toSVG:function(t,e){var i,n=R(this.coords,!0),r=(e=e||{},R(this.colorStops,!0)),o=n.r1>n.r2,s=(this.gradientTransform||Y.iMatrix).concat(),a=-this.offsetX,h=-this.offsetY,c=!!e.additionalTransform,l="pixels"===this.gradientUnits?"userSpaceOnUse":"objectBoundingBox";if(r.sort(function(t,e){return t.offset-e.offset}),"objectBoundingBox"==l?(a/=t.width,h/=t.height):(a+=t.width/2,h+=t.height/2),"path"===t.type&&"percentage"!==this.gradientUnits&&(a-=t.pathOffset.x,h-=t.pathOffset.y),s[4]-=a,s[5]-=h,l='id="SVGID_'+this.id+'" gradientUnits="'+l+'"',l+=' gradientTransform="'+(c?e.additionalTransform+" ":"")+Y.util.matrixToSVG(s)+'" ',"linear"===this.type?i=["<linearGradient ",l,' x1="',n.x1,'" y1="',n.y1,'" x2="',n.x2,'" y2="',n.y2,'">\n']:"radial"===this.type&&(i=["<radialGradient ",l,' cx="',o?n.x1:n.x2,'" cy="',o?n.y1:n.y2,'" r="',o?n.r1:n.r2,'" fx="',o?n.x2:n.x1,'" fy="',o?n.y2:n.y1,'">\n']),"radial"===this.type){if(o)for((r=r.concat()).reverse(),f=0,d=r.length;f<d;f++)r[f].offset=1-r[f].offset;o=Math.min(n.r1,n.r2);if(0<o)for(var u=o/Math.max(n.r1,n.r2),f=0,d=r.length;f<d;f++)r[f].offset+=u*(1-r[f].offset)}for(f=0,d=r.length;f<d;f++){var p=r[f];i.push("<stop ",'offset="',100*p.offset+"%",'" style="stop-color:',p.color,void 0!==p.opacity?";stop-opacity: "+p.opacity:";",'"/>\n')}return i.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),i.join("")},toLive:function(t){var e,i,n,r=Y.util.object.clone(this.coords);if(this.type){for("linear"===this.type?e=t.createLinearGradient(r.x1,r.y1,r.x2,r.y2):"radial"===this.type&&(e=t.createRadialGradient(r.x1,r.y1,r.r1,r.x2,r.y2,r.r2)),i=0,n=this.colorStops.length;i<n;i++){var o=this.colorStops[i].color,s=this.colorStops[i].opacity,a=this.colorStops[i].offset;void 0!==s&&(o=new Y.Color(o).setAlpha(s).toRgba()),e.addColorStop(a,o)}return e}}}),Y.util.object.extend(Y.Gradient,{fromElement:function(t,e,i,n){var r=(r=parseFloat(i)/(/%$/.test(i)?100:1))<0?0:1<r?1:r;isNaN(r)&&(r=1);for(var o,s,a,h,c,l,u,f=t.getElementsByTagName("stop"),d="userSpaceOnUse"===t.getAttribute("gradientUnits")?"pixels":"percentage",p=t.getAttribute("gradientTransform")||"",g=[],m=0,v=0,s="linearGradient"===t.nodeName||"LINEARGRADIENT"===t.nodeName?(o="linear",{x1:(i=t).getAttribute("x1")||0,y1:i.getAttribute("y1")||0,x2:i.getAttribute("x2")||"100%",y2:i.getAttribute("y2")||0}):(o="radial",{x1:(s=t).getAttribute("fx")||s.getAttribute("cx")||"50%",y1:s.getAttribute("fy")||s.getAttribute("cy")||"50%",r1:0,x2:s.getAttribute("cx")||"50%",y2:s.getAttribute("cy")||"50%",r2:s.getAttribute("r")||"50%"}),y=f.length;y--;)g.push(function(t,e){var i,n,r,o=t.getAttribute("style"),s=t.getAttribute("offset")||0,s=(s=parseFloat(s)/(/%$/.test(s)?100:1))<0?0:1<s?1:s;if(o){var a=o.split(/\s*;\s*/);for(""===a[a.length-1]&&a.pop(),r=a.length;r--;){var h=a[r].split(/\s*:\s*/),c=h[0].trim(),h=h[1].trim();"stop-color"===c?i=h:"stop-opacity"===c&&(n=h)}}return i=i||(t.getAttribute("stop-color")||"rgb(0,0,0)"),n=n||t.getAttribute("stop-opacity"),t=(i=new Y.Color(i)).getAlpha(),n=isNaN(parseFloat(n))?1:parseFloat(n),n*=t*e,{offset:s,color:i.toRgb(),opacity:n}}(f[y],r));return p=Y.parseTransformAttribute(p),a=s,h=n,c=d,Object.keys(a).forEach(function(t){"Infinity"===(l=a[t])?u=1:"-Infinity"===l?u=0:(u=parseFloat(a[t],10),"string"==typeof l&&/^(\d+\.\d+)%|(\d+)%$/.test(l)&&(u*=.01,"pixels"==c&&("x1"!==t&&"x2"!==t&&"r2"!==t||(u*=h.viewBoxWidth||h.width),"y1"!==t&&"y2"!==t||(u*=h.viewBoxHeight||h.height)))),a[t]=u}),"pixels"==d&&(m=-e.left,v=-e.top),new Y.Gradient({id:t.getAttribute("id"),type:o,coords:s,colorStops:g,gradientUnits:d,gradientTransform:p,offsetX:m,offsetY:v})}}),function(){"use strict";var n=Y.util.toFixed;Y.Pattern=Y.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(t,i){var n;t=t||{},this.id=Y.Object.__uid++,this.setOptions(t),!t.source||t.source&&"string"!=typeof t.source?i&&i(this):((n=this).source=Y.util.createImage(),Y.util.loadImage(t.source,function(t,e){n.source=t,i&&i(n,e)},null,this.crossOrigin))},toObject:function(t){var e,i=Y.Object.NUM_FRACTION_DIGITS;return"string"==typeof this.source.src?e=this.source.src:"object"==typeof this.source&&this.source.toDataURL&&(e=this.source.toDataURL()),i={type:"pattern",source:e,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:n(this.offsetX,i),offsetY:n(this.offsetY,i),patternTransform:this.patternTransform?this.patternTransform.concat():null},Y.util.populateWithProperties(this,i,t),i},toSVG:function(t){var e="function"==typeof this.source?this.source():this.source,i=e.width/t.width,n=e.height/t.height,r=this.offsetX/t.width,o=this.offsetY/t.height,t="";return"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat||(n=1,o&&(n+=Math.abs(o))),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat||(i=1,r&&(i+=Math.abs(r))),e.src?t=e.src:e.toDataURL&&(t=e.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+r+'" y="'+o+'" width="'+i+'" height="'+n+'">\n<image x="0" y="0" width="'+e.width+'" height="'+e.height+'" xlink:href="'+t+'"></image>\n</pattern>\n'},setOptions:function(t){for(var e in t)this[e]=t[e]},toLive:function(t){var e=this.source;if(!e)return"";if(void 0!==e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}})}(),function(t){"use strict";var s=t.fabric||(t.fabric={}),a=s.util.toFixed;s.Shadow?s.warn("fabric.Shadow is already defined."):(s.Shadow=s.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(t){for(var e in t="string"==typeof t?this._parseShadow(t):t)this[e]=t[e];this.id=s.Object.__uid++},_parseShadow:function(t){var e=t.trim(),t=s.Shadow.reOffsetsAndBlur.exec(e)||[];return{color:(e.replace(s.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseInt(t[1],10)||0,offsetY:parseInt(t[2],10)||0,blur:parseInt(t[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(t){var e=40,i=40,n=s.Object.NUM_FRACTION_DIGITS,r=s.util.rotateVector({x:this.offsetX,y:this.offsetY},s.util.degreesToRadians(-t.angle)),o=new s.Color(this.color);return t.width&&t.height&&(e=100*a((Math.abs(r.x)+this.blur)/t.width,n)+20,i=100*a((Math.abs(r.y)+this.blur)/t.height,n)+20),t.flipX&&(r.x*=-1),t.flipY&&(r.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+i+'%" height="'+(100+2*i)+'%" x="-'+e+'%" width="'+(100+2*e)+'%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="'+a(this.blur?this.blur/2:0,n)+'"></feGaussianBlur>\n\t<feOffset dx="'+a(r.x,n)+'" dy="'+a(r.y,n)+'" result="oBlur" ></feOffset>\n\t<feFlood flood-color="'+o.toRgb()+'" flood-opacity="'+o.getAlpha()+'"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var e={},i=s.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(t){this[t]!==i[t]&&(e[t]=this[t])},this),e}}),s.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/)}(i),function(){"use strict";var r,t,c,a,o,s,i,n,e;Y.StaticCanvas?Y.warn("fabric.StaticCanvas is already defined."):(r=Y.util.object.extend,t=Y.util.getElementOffset,c=Y.util.removeFromArray,a=Y.util.toFixed,o=Y.util.transformPoint,s=Y.util.invertTransform,i=Y.util.getNodeCanvas,n=Y.util.createCanvasElement,e=new Error("Could not initialize `canvas` element"),Y.StaticCanvas=Y.util.createClass(Y.CommonMethods,{initialize:function(t,e){e=e||{},this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:Y.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(t,e){var i=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this.interactive||this._initRetinaScaling(),e.overlayImage&&this.setOverlayImage(e.overlayImage,i),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,i),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,i),e.overlayColor&&this.setOverlayColor(e.overlayColor,i),this.calcOffset()},_isRetinaScaling:function(){return 1!==Y.devicePixelRatio&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Y.devicePixelRatio:1},_initRetinaScaling:function(){var t;this._isRetinaScaling()&&(t=Y.devicePixelRatio,this.__initRetinaScaling(t,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(t,this.upperCanvasEl,this.contextTop))},__initRetinaScaling:function(t,e,i){e.setAttribute("width",this.width*t),e.setAttribute("height",this.height*t),i.scale(t,t)},calcOffset:function(){return this._offset=t(this.lowerCanvasEl),this},setOverlayImage:function(t,e,i){return this.__setBgOverlayImage("overlayImage",t,e,i)},setBackgroundImage:function(t,e,i){return this.__setBgOverlayImage("backgroundImage",t,e,i)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},__setBgOverlayImage:function(n,t,r,o){return"string"==typeof t?Y.util.loadImage(t,function(t,e){var i;t&&(i=new Y.Image(t,o),(this[n]=i).canvas=this),r&&r(t,e)},this,o&&o.crossOrigin):(o&&t.setOptions(o),(this[n]=t)&&(t.canvas=this),r&&r(t,!1)),this},__setBgOverlayColor:function(t,e,i){return this[t]=e,this._initGradient(e,t),this._initPattern(e,t,i),this},_createCanvasElement:function(){var t=n();if(!t)throw e;if(t.style||(t.style={}),void 0===t.getContext)throw e;return t},_initOptions:function(t){var e=this.lowerCanvasEl;this._setOptions(t),this.width=this.width||parseInt(e.width,10)||0,this.height=this.height||parseInt(e.height,10)||0,this.lowerCanvasEl.style&&(e.width=this.width,e.height=this.height,e.style.width=this.width+"px",e.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){t&&t.getContext?this.lowerCanvasEl=t:this.lowerCanvasEl=Y.util.getById(t)||this._createCanvasElement(),Y.util.addClass(this.lowerCanvasEl,"lower-canvas"),this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var i,n;for(n in e=e||{},t)i=t[n],e.cssOnly||(this._setBackstoreDimension(n,t[n]),i+="px",this.hasLostContext=!0),e.backstoreOnly||this._setCssDimension(n,i);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(),this._initRetinaScaling(),this.calcOffset(),e.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(t){var e,i,n,r=this._activeObject,o=this.backgroundImage,s=this.overlayImage;for(this.viewportTransform=t,i=0,n=this._objects.length;i<n;i++)(e=this._objects[i]).group||e.setCoords(!0);return r&&r.setCoords(),o&&o.setCoords(!0),s&&s.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(t,e){var i=t,n=this.viewportTransform.slice(0);t=o(t,s(this.viewportTransform)),n[0]=e,n[3]=e;t=o(t,n);return n[4]+=i.x-t.x,n[5]+=i.y-t.y,this.setViewportTransform(n)},setZoom:function(t){return this.zoomToPoint(new Y.Point(0,0),t),this},absolutePan:function(t){var e=this.viewportTransform.slice(0);return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)},relativePan:function(t){return this.absolutePan(new Y.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(t){this.stateful&&t.setupState(),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.fire("object:removed",{target:t}),t.fire("removed"),delete t.canvas},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var t=this.contextContainer;return this.renderCanvas(t,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=Y.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var t={},e=this.width,i=this.height,n=s(this.viewportTransform);return t.tl=o({x:0,y:0},n),t.br=o({x:e,y:i},n),t.tr=new Y.Point(t.br.x,t.tl.y),t.bl=new Y.Point(t.tl.x,t.br.y),this.vptCoords=t},cancelRequestedRender:function(){this.isRendering&&(Y.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(t,e){var i=this.viewportTransform,n=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(t),Y.util.setImageSmoothing(t,this.imageSmoothingEnabled),this.fire("before:render",{ctx:t}),this._renderBackground(t),t.save(),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._renderObjects(t,e),t.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),n&&(n.canvas=this,n.shouldCache(),n._transformDone=!0,n.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t)),this._renderOverlay(t),this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.fire("after:render",{ctx:t})},drawClipPathOnCanvas:function(t){var e=this.viewportTransform,i=this.clipPath;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.globalCompositeOperation="destination-in",i.transform(t),t.scale(1/i.zoomX,1/i.zoomY),t.drawImage(i._cacheCanvas,-i.cacheTranslationX,-i.cacheTranslationY),t.restore()},_renderObjects:function(t,e){for(var i=0,n=e.length;i<n;++i)e[i]&&e[i].render(t)},_renderBackgroundOrOverlay:function(t,e){var i=this[e+"Color"],n=this[e+"Image"],r=this.viewportTransform,e=this[e+"Vpt"];(i||n)&&(i&&(t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=i.toLive?i.toLive(t,this):i,e&&t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),t.transform(1,0,0,1,i.offsetX||0,i.offsetY||0),(i=i.gradientTransform||i.patternTransform)&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),t.fill(),t.restore()),n&&(t.save(),e&&t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),n.render(t),t.restore()))},_renderBackground:function(t){this._renderBackgroundOrOverlay(t,"background")},_renderOverlay:function(t){this._renderBackgroundOrOverlay(t,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},centerObjectH:function(t){return this._centerObject(t,new Y.Point(this.getCenter().left,t.getCenterPoint().y))},centerObjectV:function(t){return this._centerObject(t,new Y.Point(t.getCenterPoint().x,this.getCenter().top))},centerObject:function(t){var e=this.getCenter();return this._centerObject(t,new Y.Point(e.left,e.top))},viewportCenterObject:function(t){var e=this.getVpCenter();return this._centerObject(t,e)},viewportCenterObjectH:function(t){var e=this.getVpCenter();return this._centerObject(t,new Y.Point(e.x,t.getCenterPoint().y)),this},viewportCenterObjectV:function(t){var e=this.getVpCenter();return this._centerObject(t,new Y.Point(t.getCenterPoint().x,e.y))},getVpCenter:function(){var t=this.getCenter(),e=s(this.viewportTransform);return o({x:t.left,y:t.top},e)},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(t,e){var i=this.clipPath,n={version:Y.version,objects:this._toObjects(t,e)};return i&&(n.clipPath=this._toObject(this.clipPath,t,e)),r(n,this.__serializeBgOverlay(t,e)),Y.util.populateWithProperties(this,n,e),n},_toObjects:function(e,i){return this._objects.filter(function(t){return!t.excludeFromExport}).map(function(t){return this._toObject(t,e,i)},this)},_toObject:function(t,e,i){var n;this.includeDefaultValues||(n=t.includeDefaultValues,t.includeDefaultValues=!1);i=t[e](i);return this.includeDefaultValues||(t.includeDefaultValues=n),i},__serializeBgOverlay:function(t,e){var i={},n=this.backgroundImage,r=this.overlayImage;return this.backgroundColor&&(i.background=this.backgroundColor.toObject?this.backgroundColor.toObject(e):this.backgroundColor),this.overlayColor&&(i.overlay=this.overlayColor.toObject?this.overlayColor.toObject(e):this.overlayColor),n&&!n.excludeFromExport&&(i.backgroundImage=this._toObject(n,t,e)),r&&!r.excludeFromExport&&(i.overlayImage=this._toObject(r,t,e)),i},svgViewportTransformation:!0,toSVG:function(t,e){(t=t||{}).reviver=e;var i=[];return this._setSVGPreamble(i,t),this._setSVGHeader(i,t),this.clipPath&&i.push('<g clip-path="url(#'+this.clipPath.clipPathId+')" >\n'),this._setSVGBgOverlayColor(i,"background"),this._setSVGBgOverlayImage(i,"backgroundImage",e),this._setSVGObjects(i,e),this.clipPath&&i.push("</g>\n"),this._setSVGBgOverlayColor(i,"overlay"),this._setSVGBgOverlayImage(i,"overlayImage",e),i.push("</svg>"),i.join("")},_setSVGPreamble:function(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(t,e){var i,n=e.width||this.width,r=e.height||this.height,o='viewBox="0 0 '+this.width+" "+this.height+'" ',s=Y.Object.NUM_FRACTION_DIGITS;e.viewBox?o='viewBox="'+e.viewBox.x+" "+e.viewBox.y+" "+e.viewBox.width+" "+e.viewBox.height+'" ':this.svgViewportTransformation&&(i=this.viewportTransform,o='viewBox="'+a(-i[4]/i[0],s)+" "+a(-i[5]/i[3],s)+" "+a(this.width/i[0],s)+" "+a(this.height/i[3],s)+'" '),t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',r,'" ',o,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",Y.version,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(e),"</defs>\n")},createSVGClipPathMarkup:function(t){var e=this.clipPath;return e?(e.clipPathId="CLIPPATH_"+Y.Object.__uid++,'<clipPath id="'+e.clipPathId+'" >\n'+this.clipPath.toClipPathSVG(t.reviver)+"</clipPath>\n"):""},createSVGRefElementsMarkup:function(){var r=this;return["background","overlay"].map(function(t){var e=r[t+"Color"];if(e&&e.toLive){var i=r[t+"Vpt"],n=r.viewportTransform,t={width:r.width/(i?n[0]:1),height:r.height/(i?n[3]:1)};return e.toSVG(t,{additionalTransform:i?Y.util.matrixToSVG(n):""})}}).join("")},createSVGFontFacesMarkup:function(){var t,e,i,n,r,o,s,a,h,c="",l={},u=Y.fontPaths,f=[];for(this._objects.forEach(function t(e){f.push(e),e._objects&&e._objects.forEach(t)}),s=0,a=f.length;s<a;s++)if(e=(t=f[s]).fontFamily,-1!==t.type.indexOf("text")&&!l[e]&&u[e]&&(l[e]=!0,t.styles))for(r in i=t.styles)for(o in n=i[r])!l[e=n[o].fontFamily]&&u[e]&&(l[e]=!0);for(h in l)c+=["\t\t@font-face {\n","\t\t\tfont-family: '",h,"';\n","\t\t\tsrc: url('",u[h],"');\n","\t\t}\n"].join("");return c=c&&['\t<style type="text/css">',"<![CDATA[\n",c,"]]>","</style>\n"].join("")},_setSVGObjects:function(t,e){for(var i,n=this._objects,r=0,o=n.length;r<o;r++)(i=n[r]).excludeFromExport||this._setSVGObject(t,i,e)},_setSVGObject:function(t,e,i){t.push(e.toSVG(i))},_setSVGBgOverlayImage:function(t,e,i){this[e]&&!this[e].excludeFromExport&&this[e].toSVG&&t.push(this[e].toSVG(i))},_setSVGBgOverlayColor:function(t,e){var i,n=this[e+"Color"],r=this.viewportTransform,o=this.width,s=this.height;n&&(n.toLive?(i=n.repeat,r=Y.util.invertTransform(r),r=this[e+"Vpt"]?Y.util.matrixToSVG(r):"",t.push('<rect transform="'+r+" translate(",o/2,",",s/2,')"',' x="',n.offsetX-o/2,'" y="',n.offsetY-s/2,'" ','width="',"repeat-y"===i||"no-repeat"===i?n.source.width:o,'" height="',"repeat-x"===i||"no-repeat"===i?n.source.height:s,'" fill="url(#SVGID_'+n.id+')"',"></rect>\n")):t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',"></rect>\n"))},sendToBack:function(t){if(!t)return this;var e,i,n,r=this._activeObject;if(t===r&&"activeSelection"===t.type)for(e=(n=r._objects).length;e--;)i=n[e],c(this._objects,i),this._objects.unshift(i);else c(this._objects,t),this._objects.unshift(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(t){if(!t)return this;var e,i,n,r=this._activeObject;if(t===r&&"activeSelection"===t.type)for(n=r._objects,e=0;e<n.length;e++)i=n[e],c(this._objects,i),this._objects.push(i);else c(this._objects,t),this._objects.push(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(t,e){if(!t)return this;var i,n,r,o,s,a=this._activeObject,h=0;if(t===a&&"activeSelection"===t.type)for(s=a._objects,i=0;i<s.length;i++)n=s[i],(r=this._objects.indexOf(n))>0+h&&(o=r-1,c(this._objects,n),this._objects.splice(o,0,n)),h++;else 0!==(r=this._objects.indexOf(t))&&(o=this._findNewLowerIndex(t,r,e),c(this._objects,t),this._objects.splice(o,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(t,e,i){var n,r;if(i){for(r=(n=e)-1;0<=r;--r)if(t.intersectsWithObject(this._objects[r])||t.isContainedWithinObject(this._objects[r])||this._objects[r].isContainedWithinObject(t)){n=r;break}}else n=e-1;return n},bringForward:function(t,e){if(!t)return this;var i,n,r,o,s,a=this._activeObject,h=0;if(t===a&&"activeSelection"===t.type)for(i=(s=a._objects).length;i--;)n=s[i],(r=this._objects.indexOf(n))<this._objects.length-1-h&&(o=r+1,c(this._objects,n),this._objects.splice(o,0,n)),h++;else(r=this._objects.indexOf(t))!==this._objects.length-1&&(o=this._findNewUpperIndex(t,r,e),c(this._objects,t),this._objects.splice(o,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(t,e,i){var n,r,o;if(i){for(r=(n=e)+1,o=this._objects.length;r<o;++r)if(t.intersectsWithObject(this._objects[r])||t.isContainedWithinObject(this._objects[r])||this._objects[r].isContainedWithinObject(t)){n=r;break}}else n=e+1;return n},moveTo:function(t,e){return c(this._objects,t),this._objects.splice(e,0,t),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(Y.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(t){t.dispose&&t.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,Y.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),r(Y.StaticCanvas.prototype,Y.Observable),r(Y.StaticCanvas.prototype,Y.Collection),r(Y.StaticCanvas.prototype,Y.DataURLExporter),r(Y.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=n();if(!e||!e.getContext)return null;e=e.getContext("2d");return!e||"setLineDash"!==t?null:void 0!==e.setLineDash}}),Y.StaticCanvas.prototype.toJSON=Y.StaticCanvas.prototype.toObject,Y.isLikelyNode&&(Y.StaticCanvas.prototype.createPNGStream=function(){var t=i(this.lowerCanvasEl);return t&&t.createPNGStream()},Y.StaticCanvas.prototype.createJPEGStream=function(t){var e=i(this.lowerCanvasEl);return e&&e.createJPEGStream(t)}))}(),Y.BaseBrush=Y.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,_setBrushStyles:function(){var t=this.canvas.contextTop;t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,Y.StaticCanvas.supports("setLineDash")&&t.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(t){var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},_setShadow:function(){var t,e,i,n;this.shadow&&(t=this.canvas,e=this.shadow,i=t.contextTop,n=t.getZoom(),t&&t._isRetinaScaling()&&(n*=Y.devicePixelRatio),i.shadowColor=e.color,i.shadowBlur=e.blur*n,i.shadowOffsetX=e.offsetX*n,i.shadowOffsetY=e.offsetY*n)},needsFullRender:function(){return new Y.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}}),Y.PencilBrush=Y.util.createClass(Y.BaseBrush,{decimate:.4,initialize:function(t){this.canvas=t,this._points=[]},_drawSegment:function(t,e,i){i=e.midPointFrom(i);return t.quadraticCurveTo(e.x,e.y,i.x,i.y),i},onMouseDown:function(t,e){this.canvas._isMainEvent(e.e)&&(this._prepareForDrawing(t),this._captureDrawingPath(t),this._render())},onMouseMove:function(t,e){var i;this.canvas._isMainEvent(e.e)&&this._captureDrawingPath(t)&&1<this._points.length&&(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this._render()):(e=(i=this._points).length,t=this.canvas.contextTop,this._saveAndTransform(t),this.oldEnd&&(t.beginPath(),t.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(t,i[e-2],i[e-1],!0),t.stroke(),t.restore()))},onMouseUp:function(t){return!this.canvas._isMainEvent(t.e)||(this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(t){t=new Y.Point(t.x,t.y);this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)},_addPoint:function(t){return!(1<this._points.length&&t.eq(this._points[this._points.length-1])||(this._points.push(t),0))},_reset:function(){this._points=[],this._setBrushStyles(),this._setShadow()},_captureDrawingPath:function(t){t=new Y.Point(t.x,t.y);return this._addPoint(t)},_render:function(){var t,e,i,n=this.canvas.contextTop,r=this._points[0],o=this._points[1];for(this._saveAndTransform(n),n.beginPath(),2===this._points.length&&r.x===o.x&&r.y===o.y&&(i=this.width/1e3,r=new Y.Point(r.x,r.y),o=new Y.Point(o.x,o.y),r.x-=i,o.x+=i),n.moveTo(r.x,r.y),t=1,e=this._points.length;t<e;t++)this._drawSegment(n,r,o),r=this._points[t],o=this._points[t+1];n.lineTo(r.x,r.y),n.stroke(),n.restore()},convertPointsToSVGPath:function(t){var e,i,n=[],r=this.width/1e3,o=new Y.Point(t[0].x,t[0].y),s=new Y.Point(t[1].x,t[1].y),a=t.length,h=1,c=0,l=2<a;for(l&&(h=t[2].x<s.x?-1:t[2].x===s.x?0:1,c=t[2].y<s.y?-1:t[2].y===s.y?0:1),n.push("M ",o.x-h*r," ",o.y-c*r," "),e=1;e<a;e++)o.eq(s)||(i=o.midPointFrom(s),n.push("Q ",o.x," ",o.y," ",i.x," ",i.y," ")),o=t[e],e+1<t.length&&(s=t[e+1]);return l&&(h=o.x>t[e-2].x?1:o.x===t[e-2].x?0:-1,c=o.y>t[e-2].y?1:o.y===t[e-2].y?0:-1),n.push("L ",o.x+h*r," ",o.y+c*r),n},createPath:function(t){t=new Y.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,t.shadow=new Y.Shadow(this.shadow)),t},decimatePoints:function(t,e){if(t.length<=2)return t;for(var i=this.canvas.getZoom(),n=Math.pow(e/i,2),r=t.length-1,o=t[0],s=[o],a=1;a<r;a++)Math.pow(o.x-t[a].x,2)+Math.pow(o.y-t[a].y,2)>=n&&(o=t[a],s.push(o));return 1===s.length&&s.push(new Y.Point(s[0].x,s[0].y)),s},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var t=this.convertPointsToSVGPath(this._points).join("");"M 0 0 Q 0 0 0 0 L 0 0"!==t?(t=this.createPath(t),this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:t}),this.canvas.add(t),this.canvas.requestRenderAll(),t.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:t})):this.canvas.requestRenderAll()}}),Y.CircleBrush=Y.util.createClass(Y.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),t=this.canvas.contextTop;this._saveAndTransform(t),this.dot(t,e),t.restore()},dot:function(t,e){t.fillStyle=e.fill,t.beginPath(),t.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),t.closePath(),t.fill()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},_render:function(){var t,e,i=this.canvas.contextTop,n=this.points;for(this._saveAndTransform(i),t=0,e=n.length;t<e;t++)this.dot(i,n[t]);i.restore()},onMouseMove:function(t){this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(t),this._render()):this.drawDot(t)},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,n=this.points.length;i<n;i++){var r=this.points[i],r=new Y.Circle({radius:r.radius,left:r.x,top:r.y,originX:"center",originY:"center",fill:r.fill});this.shadow&&(r.shadow=new Y.Shadow(this.shadow)),e.push(r)}var o=new Y.Group(e);o.canvas=this.canvas,this.canvas.fire("before:path:created",{path:o}),this.canvas.add(o),this.canvas.fire("path:created",{path:o}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},addPoint:function(t){var e=new Y.Point(t.x,t.y),i=Y.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,t=new Y.Color(this.color).setAlpha(Y.util.getRandomInt(0,100)/100).toRgba();return e.radius=i,e.fill=t,this.points.push(e),e}}),Y.SprayBrush=Y.util.createClass(Y.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render(this.sprayChunkPoints)},onMouseMove:function(t){this.addSprayChunk(t),this.render(this.sprayChunkPoints)},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,n=this.sprayChunks.length;i<n;i++)for(var r=this.sprayChunks[i],o=0,s=r.length;o<s;o++){var a=new Y.Rect({width:r[o].width,height:r[o].width,left:r[o].x+1,top:r[o].y+1,originX:"center",originY:"center",fill:this.color});e.push(a)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var h=new Y.Group(e);this.shadow&&h.set("shadow",new Y.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:h}),this.canvas.add(h),this.canvas.fire("path:created",{path:h}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},_getOptimizedRects:function(t){for(var e,i={},n=0,r=t.length;n<r;n++)i[e=t[n].left+""+t[n].top]||(i[e]=t[n]);var o=[];for(e in i)o.push(i[e]);return o},render:function(t){var e,i,n=this.canvas.contextTop;for(n.fillStyle=this.color,this._saveAndTransform(n),e=0,i=t.length;e<i;e++){var r=t[e];void 0!==r.opacity&&(n.globalAlpha=r.opacity),n.fillRect(r.x,r.y,r.width,r.width)}n.restore()},_render:function(){var t,e,i=this.canvas.contextTop;for(i.fillStyle=this.color,this._saveAndTransform(i),t=0,e=this.sprayChunks.length;t<e;t++)this.render(this.sprayChunks[t]);i.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];for(var e=this.width/2,i=0;i<this.density;i++){var n=Y.util.getRandomInt(t.x-e,t.x+e),r=Y.util.getRandomInt(t.y-e,t.y+e),o=this.dotWidthVariance?Y.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth,r=new Y.Point(n,r);r.width=o,this.randomOpacity&&(r.opacity=Y.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(r)}this.sprayChunks.push(this.sprayChunkPoints)}}),Y.PatternBrush=Y.util.createClass(Y.PencilBrush,{getPatternSrc:function(){var t=Y.util.createCanvasElement(),e=t.getContext("2d");return t.width=t.height=25,e.fillStyle=this.color,e.beginPath(),e.arc(10,10,10,0,2*Math.PI,!1),e.closePath(),e.fill(),t},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(t){var e=this.callSuper("createPath",t),t=e._getLeftTopCoords().scalarAdd(e.strokeWidth/2);return e.stroke=new Y.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-t.x,offsetY:-t.y}),e}}),function(){var t,s=Y.util.getPointer,h=Y.util.degreesToRadians,c=Math.abs,l=Y.StaticCanvas.supports("setLineDash"),u=Y.util.isTouchEvent;for(t in Y.Canvas=Y.util.createClass(Y.StaticCanvas,{initialize:function(t,e){e=e||{},this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=Y.PencilBrush&&new Y.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var t,e=this.getActiveObjects();if(0<e.length&&!this.preserveObjectStacking){for(var i=[],n=[],r=0,o=this._objects.length;r<o;r++)t=this._objects[r],(-1===e.indexOf(t)?i:n).push(t);1<e.length&&(this._activeObject._objects=n),i.push.apply(i,n)}else i=this._objects;return i},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&this.renderTopLayer(this.contextTop);var t=this.contextContainer;return this.renderCanvas(t,this._chooseObjectsToRender()),this},renderTopLayer:function(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()},renderTop:function(){var t=this.contextTop;return this.clearContext(t),this.renderTopLayer(t),this.fire("after:render"),this},_normalizePointer:function(t,e){t=t.calcTransformMatrix(),t=Y.util.invertTransform(t),e=this.restorePointerVpt(e);return Y.util.transformPoint(e,t)},isTargetTransparent:function(t,e,i){if(t.shouldCache()&&t._cacheCanvas&&t!==this._activeObject){var n=this._normalizePointer(t,{x:e,y:i}),r=Math.max(t.cacheTranslationX+n.x*t.zoomX,0),o=Math.max(t.cacheTranslationY+n.y*t.zoomY,0);return Y.util.isTransparent(t._cacheContext,Math.round(r),Math.round(o),this.targetFindTolerance)}n=this.contextCache,r=t.selectionBackgroundColor,o=this.viewportTransform;return t.selectionBackgroundColor="",this.clearContext(n),n.save(),n.transform(o[0],o[1],o[2],o[3],o[4],o[5]),t.render(n),n.restore(),t===this._activeObject&&t._renderControls(n,{hasBorders:!1,transparentCorners:!1},{hasBorders:!1}),t.selectionBackgroundColor=r,Y.util.isTransparent(n,e,i,this.targetFindTolerance)},_isSelectionKeyPressed:function(e){return"[object Array]"===Object.prototype.toString.call(this.selectionKey)?!!this.selectionKey.find(function(t){return!0===e[t]}):e[this.selectionKey]},_shouldClearSelection:function(t,e){var i=this.getActiveObjects(),n=this._activeObject;return!e||n&&1<i.length&&-1===i.indexOf(e)&&n!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&n&&n!==e},_shouldCenterTransform:function(t,e,i){var n;if(t)return"scale"===e||"scaleX"===e||"scaleY"===e||"resizing"===e?n=this.centeredScaling||t.centeredScaling:"rotate"===e&&(n=this.centeredRotation||t.centeredRotation),n?!i:i},_getOriginFromCorner:function(t,e){t={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?t.x="right":"mr"!==e&&"tr"!==e&&"br"!==e||(t.x="left"),"tl"===e||"mt"===e||"tr"===e?t.y="bottom":"bl"!==e&&"mb"!==e&&"br"!==e||(t.y="top"),t},_getActionFromCorner:function(t,e,i,n){if(!e||!t)return"drag";e=n.controls[e];return e.getActionName(i,e,n)},_setupCurrentTransform:function(t,e,i){var n,r,o,s,a;e&&(a=this.getPointer(t),n=e.__corner,s=e.controls[n],r=i&&n?s.getActionHandler(t,e,s):Y.controlsUtils.dragHandler,o=this._getActionFromCorner(i,n,t,e),s=this._getOriginFromCorner(e,n),i=t[this.centeredKey],a={target:e,action:o,actionHandler:r,corner:n,scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,offsetX:a.x-e.left,offsetY:a.y-e.top,originX:s.x,originY:s.y,ex:a.x,ey:a.y,lastX:a.x,lastY:a.y,theta:h(e.angle),width:e.width*e.scaleX,shiftKey:t.shiftKey,altKey:i,original:Y.util.saveObjectTransform(e)},this._shouldCenterTransform(e,o,i)&&(a.originX="center",a.originY="center"),a.original.originX=s.x,a.original.originY=s.y,this._currentTransform=a,this._beforeTransform(t))},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_drawSelection:function(t){var e,i,n=this._groupSelector,r=n.left,o=n.top,s=c(r),a=c(o);this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(n.ex-(0<r?0:-r),n.ey-(0<o?0:-o),s,a)),this.selectionLineWidth&&this.selectionBorderColor&&(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,1<this.selectionDashArray.length&&!l?(e=n.ex+.5-(0<r?0:s),i=n.ey+.5-(0<o?0:a),t.beginPath(),Y.util.drawDashedLine(t,e,i,e+s,i,this.selectionDashArray),Y.util.drawDashedLine(t,e,i+a-1,e+s,i+a-1,this.selectionDashArray),Y.util.drawDashedLine(t,e,i,e,i+a,this.selectionDashArray),Y.util.drawDashedLine(t,e+s-1,i,e+s-1,i+a,this.selectionDashArray),t.closePath(),t.stroke()):(Y.Object.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(n.ex+.5-(0<r?0:s),n.ey+.5-(0<o?0:a),s,a)))},findTarget:function(t,e){if(!this.skipTargetFind){var i,n,r=this.getPointer(t,!0),o=this._activeObject,s=this.getActiveObjects(),a=u(t);if(this.targets=[],1<s.length&&!e&&o===this._searchPossibleTargets([o],r))return o;if(1===s.length&&o._findTargetCorner(r,a))return o;if(1===s.length&&o===this._searchPossibleTargets([o],r)){if(!this.preserveObjectStacking)return o;i=o,n=this.targets,this.targets=[]}r=this._searchPossibleTargets(this._objects,r);return t[this.altSelectionKey]&&r&&i&&r!==i&&(r=i,this.targets=n),r}},_checkTarget:function(t,e,i){if(e&&e.visible&&e.evented&&(e.containsPoint(t)||e._findTargetCorner(t)))return!((this.perPixelTargetFind||e.perPixelTargetFind)&&!e.isEditing)||(!this.isTargetTransparent(e,i.x,i.y)||void 0)},_searchPossibleTargets:function(t,e){for(var i,n,r=t.length;r--;){var o=t[r],s=o.group?this._normalizePointer(o.group,e):e;if(this._checkTarget(s,o,e)){(i=t[r]).subTargetCheck&&i instanceof Y.Group&&(n=this._searchPossibleTargets(i._objects,e))&&this.targets.push(n);break}}return i},restorePointerVpt:function(t){return Y.util.transformPoint(t,Y.util.invertTransform(this.viewportTransform))},getPointer:function(t,e){if(this._absolutePointer&&!e)return this._absolutePointer;if(this._pointer&&e)return this._pointer;var i=s(t),n=this.upperCanvasEl,r=n.getBoundingClientRect(),o=r.width||0,t=r.height||0;o&&t||("top"in r&&"bottom"in r&&(t=Math.abs(r.top-r.bottom)),"right"in r&&"left"in r&&(o=Math.abs(r.right-r.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,e||(i=this.restorePointerVpt(i));e=this.getRetinaScaling();return 1!==e&&(i.x/=e,i.y/=e),t=0===o||0===t?{width:1,height:1}:{width:n.width/o,height:n.height/t},{x:i.x*t.width,y:i.y*t.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),e=this.lowerCanvasEl,i=this.upperCanvasEl;i?i.className="":(i=this._createCanvasElement(),this.upperCanvasEl=i),Y.util.addClass(i,"upper-canvas "+t),this.wrapperEl.appendChild(i),this._copyCanvasStyle(e,i),this._applyCanvasStyle(i),this.contextTop=i.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=Y.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),Y.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),Y.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.width||t.width,i=this.height||t.height;Y.util.setStyle(t,{position:"absolute",width:e+"px",height:i+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),t.width=e,t.height=i,Y.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var t=this._activeObject;return t?"activeSelection"===t.type&&t._objects?t._objects.slice(0):[t]:[]},_onObjectRemoved:function(t){t===this._activeObject&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared",{target:t}),t.fire("deselected")),t===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",t)},_fireSelectionEvents:function(e,t){var i=!1,n=this.getActiveObjects(),r=[],o=[],s={e:t};e.forEach(function(t){-1===n.indexOf(t)&&(i=!0,t.fire("deselected",s),o.push(t))}),n.forEach(function(t){-1===e.indexOf(t)&&(i=!0,t.fire("selected",s),r.push(t))}),0<e.length&&0<n.length?(s.selected=r,s.deselected=o,s.updated=r[0]||o[0],s.target=this._activeObject,i&&this.fire("selection:updated",s)):0<n.length?(s.selected=r,s.target=this._activeObject,this.fire("selection:created",s)):0<e.length&&(s.deselected=o,this.fire("selection:cleared",s))},setActiveObject:function(t,e){var i=this.getActiveObjects();return this._setActiveObject(t,e),this._fireSelectionEvents(i,e),this},_setActiveObject:function(t,e){return this._activeObject!==t&&!!this._discardActiveObject(e,t)&&!t.onSelect({e:e})&&(this._activeObject=t,!0)},_discardActiveObject:function(t,e){var i=this._activeObject;if(i){if(i.onDeselect({e:t,object:e}))return!1;this._activeObject=null}return!0},discardActiveObject:function(t){var e=this.getActiveObjects(),i=this.getActiveObject();return e.length&&this.fire("before:selection:cleared",{target:i,e:t}),this._discardActiveObject(t),this._fireSelectionEvents(e,t),this},dispose:function(){var t=this.wrapperEl;return this.removeListeners(),t.removeChild(this.upperCanvasEl),t.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(t){Y.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this)),t.parentNode&&t.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,Y.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(t){var e=this._activeObject;e&&e._renderControls(t)},_toObject:function(t,e,i){var n=this._realizeGroupTransformOnObject(t),i=this.callSuper("_toObject",t,e,i);return this._unwindGroupTransformOnObject(t,n),i},_realizeGroupTransformOnObject:function(e){if(e.group&&"activeSelection"===e.group.type&&this._activeObject===e.group){var i={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach(function(t){i[t]=e[t]}),this._activeObject.realizeTransform(e),i}return null},_unwindGroupTransformOnObject:function(t,e){e&&t.set(e)},_setSVGObject:function(t,e,i){var n=this._realizeGroupTransformOnObject(e);this.callSuper("_setSVGObject",t,e,i),this._unwindGroupTransformOnObject(e,n)},setViewportTransform:function(t){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),Y.StaticCanvas.prototype.setViewportTransform.call(this,t)}}),Y.StaticCanvas)"prototype"!==t&&(Y.Canvas[t]=Y.StaticCanvas[t])}(),D=Y.util.addListener,M=Y.util.removeListener,B={passive:!1},Y.util.object.extend(Y.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(D,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(t,e){var i=this.upperCanvasEl,n=this._getEventPrefix();t(Y.window,"resize",this._onResize),t(i,n+"down",this._onMouseDown),t(i,n+"move",this._onMouseMove,B),t(i,n+"out",this._onMouseOut),t(i,n+"enter",this._onMouseEnter),t(i,"wheel",this._onMouseWheel),t(i,"contextmenu",this._onContextMenu),t(i,"dblclick",this._onDoubleClick),t(i,"dragover",this._onDragOver),t(i,"dragenter",this._onDragEnter),t(i,"dragleave",this._onDragLeave),t(i,"drop",this._onDrop),this.enablePointerEvents||t(i,"touchstart",this._onTouchStart,B),"undefined"!=typeof eventjs&&e in eventjs&&(eventjs[e](i,"gesture",this._onGesture),eventjs[e](i,"drag",this._onDrag),eventjs[e](i,"orientation",this._onOrientationChange),eventjs[e](i,"shake",this._onShake),eventjs[e](i,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(M,"remove");var t=this._getEventPrefix();M(Y.document,t+"up",this._onMouseUp),M(Y.document,"touchend",this._onTouchEnd,B),M(Y.document,t+"move",this._onMouseMove,B),M(Y.document,"touchmove",this._onMouseMove,B)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._simpleEventHandler.bind(this,"drop"),this.eventsBound=!0)},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t){this.__onMouseWheel(t)},_onMouseOut:function(e){var i=this._hoveredTarget;this.fire("mouse:out",{target:i,e:e}),this._hoveredTarget=null,i&&i.fire("mouseout",{e:e});var n=this;this._hoveredTargets.forEach(function(t){n.fire("mouse:out",{target:i,e:e}),t&&i.fire("mouseout",{e:e})}),this._hoveredTargets=[],this._iTextInstances&&this._iTextInstances.forEach(function(t){t.isEditing&&t.hiddenTextarea.focus()})},_onMouseEnter:function(t){this._currentTransform||this.findTarget(t)||(this.fire("mouse:over",{target:null,e:t}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onLongPress:function(t,e){this.__onLongPress&&this.__onLongPress(t,e)},_onDragOver:function(t){t.preventDefault();var e=this._simpleEventHandler("dragover",t);this._fireEnterLeaveEvents(e,t)},_onContextMenu:function(t){return this.stopContextMenu&&(t.stopPropagation(),t.preventDefault()),!1},_onDoubleClick:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"dblclick"),this._resetTransformEventData(t)},getPointerId:function(t){var e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1},_isMainEvent:function(t){return!0===t.isPrimary||!1!==t.isPrimary&&("touchend"===t.type&&0===t.touches.length||!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId)},_onTouchStart:function(t){t.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(t)),this.__onMouseDown(t),this._resetTransformEventData();var e=this.upperCanvasEl,t=this._getEventPrefix();D(Y.document,"touchend",this._onTouchEnd,B),D(Y.document,"touchmove",this._onMouseMove,B),M(e,t+"down",this._onMouseDown)},_onMouseDown:function(t){this.__onMouseDown(t),this._resetTransformEventData();var e=this.upperCanvasEl,t=this._getEventPrefix();M(e,t+"move",this._onMouseMove,B),D(Y.document,t+"up",this._onMouseUp),D(Y.document,t+"move",this._onMouseMove,B)},_onTouchEnd:function(t){var e,i;0<t.touches.length||(this.__onMouseUp(t),this._resetTransformEventData(),this.mainTouchId=null,e=this._getEventPrefix(),M(Y.document,"touchend",this._onTouchEnd,B),M(Y.document,"touchmove",this._onMouseMove,B),(i=this)._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){D(i.upperCanvasEl,e+"down",i._onMouseDown),i._willAddMouseDown=0},400))},_onMouseUp:function(t){this.__onMouseUp(t),this._resetTransformEventData();var e=this.upperCanvasEl,i=this._getEventPrefix();this._isMainEvent(t)&&(M(Y.document,i+"up",this._onMouseUp),M(Y.document,i+"move",this._onMouseMove,B),D(e,i+"move",this._onMouseMove,B))},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t){var e=this._activeObject;return!!(!!e!=!!t||e&&t&&e!==t)||(e&&e.isEditing,!1)},__onMouseUp:function(t){var e,i=this._currentTransform,n=this._groupSelector,r=!1,o=!n||0===n.left&&0===n.top;if(this._cacheTransformEventData(t),n=this._target,this._handleEvent(t,"up:before"),tt(t,3))this.fireRightClick&&this._handleEvent(t,"up",3,o);else{if(tt(t,2))return this.fireMiddleClick&&this._handleEvent(t,"up",2,o),void this._resetTransformEventData();this.isDrawingMode&&this._isCurrentlyDrawing?this._onMouseUpInDrawingMode(t):this._isMainEvent(t)&&(i&&(this._finalizeCurrentTransform(t),r=i.actionPerformed),o||(e=n===this._activeObject,this._maybeGroupObjects(t),r=r||(this._shouldRender(n)||!e&&n===this._activeObject)),n&&(e=n._findTargetCorner(this.getPointer(t,!0),Y.util.isTouchEvent(t)),(e=(e=n.controls[e])&&e.getMouseUpHandler(t,n,e))&&e(t,i,(i=this.getPointer(t)).x,i.y),n.isMoving=!1),this._setCursorFromEvent(t,n),this._handleEvent(t,"up",1,o),this._groupSelector=null,this._currentTransform=null,n&&(n.__corner=0),r?this.requestRenderAll():o||this.renderTop())}},_simpleEventHandler:function(t,e){var i=this.findTarget(e),n=this.targets,r={e:e,target:i,subTargets:n};if(this.fire(t,r),i&&i.fire(t,r),!n)return i;for(var o=0;o<n.length;o++)n[o].fire(t,r);return i},_handleEvent:function(t,e,i,n){var r=this._target,o=this.targets||[],s={e:t,target:r,subTargets:o,button:i||1,isClick:n||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};"up"===e&&(s.currentTarget=this.findTarget(t),s.currentSubTargets=this.targets),this.fire("mouse:"+e,s),r&&r.fire("mouse"+e,s);for(var a=0;a<o.length;a++)o[a].fire("mouse"+e,s)},_finalizeCurrentTransform:function(t){var e=this._currentTransform,i=e.target,t={e:t,target:i,transform:e,action:e.action};i._scaling&&(i._scaling=!1),i.setCoords(),(e.actionPerformed||this.stateful&&i.hasStateChanged())&&(e.actionPerformed&&(e=this._addEventOptions(t,e),this._fire(e,t)),this._fire("modified",t))},_addEventOptions:function(t,e){var i,n;switch(e.action){case"scaleX":i="scaled",n="x";break;case"scaleY":i="scaled",n="y";break;case"skewX":i="skewed",n="x";break;case"skewY":i="skewed",n="y";break;case"scale":i="scaled",n="equally";break;case"rotate":i="rotated";break;case"drag":i="moved"}return t.by=n,i},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(t).requestRenderAll();var e=this.getPointer(t);this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down")},_onMouseMoveInDrawingMode:function(t){var e;this._isCurrentlyDrawing&&(e=this.getPointer(t),this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})),this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")},_onMouseUpInDrawingMode:function(t){var e=this.getPointer(t);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:t,pointer:e}),this._handleEvent(t,"up")},__onMouseDown:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"down:before");var e,i,n,r,o,s=this._target;tt(t,3)?this.fireRightClick&&this._handleEvent(t,"down",3):tt(t,2)?this.fireMiddleClick&&this._handleEvent(t,"down",2):this.isDrawingMode?this._onMouseDownInDrawingMode(t):this._isMainEvent(t)&&!this._currentTransform&&(e=this._pointer,this._previousPointer=e,i=this._shouldRender(s),n=this._shouldGroup(t,s),this._shouldClearSelection(t,s)?this.discardActiveObject(t):n&&(this._handleGrouping(t,s),s=this._activeObject),!this.selection||s&&(s.selectable||s.isEditing||s===this._activeObject)||(this._groupSelector={ex:e.x,ey:e.y,top:0,left:0}),s&&(r=s===this._activeObject,s.selectable&&this.setActiveObject(s,t),o=s._findTargetCorner(this.getPointer(t,!0),Y.util.isTouchEvent(t)),s.__corner=o,s!==this._activeObject||!o&&n||(this._setupCurrentTransform(t,s,r),o=s.controls[o],e=this.getPointer(t),(o=o&&o.getMouseDownHandler(t,s,o))&&o(t,this._currentTransform,e.x,e.y))),this._handleEvent(t,"down"),(i||n)&&this.requestRenderAll())},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(t){this._resetTransformEventData(),this._pointer=this.getPointer(t,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(t)||null},_beforeTransform:function(t){var e=this._currentTransform;this.stateful&&e.target.saveState(),this.fire("before:transform",{e:t,transform:e})},__onMouseMove:function(t){var e,i;this._handleEvent(t,"move:before"),this._cacheTransformEventData(t),this.isDrawingMode?this._onMouseMoveInDrawingMode(t):this._isMainEvent(t)&&((i=this._groupSelector)?(e=this._pointer,i.left=e.x-i.ex,i.top=e.y-i.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(i=this.findTarget(t)||null,this._setCursorFromEvent(t,i),this._fireOverOutEvents(i,t)),this._handleEvent(t,"move"),this._resetTransformEventData())},_fireOverOutEvents:function(t,e){var i=this._hoveredTarget,n=this._hoveredTargets,r=this.targets,o=Math.max(n.length,r.length);this.fireSyntheticInOutEvents(t,e,{oldTarget:i,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var s=0;s<o;s++)this.fireSyntheticInOutEvents(r[s],e,{oldTarget:n[s],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(t,e){var i=this._draggedoverTarget,n=this._hoveredTargets,r=this.targets,o=Math.max(n.length,r.length);this.fireSyntheticInOutEvents(t,e,{oldTarget:i,evtOut:"dragleave",evtIn:"dragenter"});for(var s=0;s<o;s++)this.fireSyntheticInOutEvents(r[s],e,{oldTarget:n[s],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=t},fireSyntheticInOutEvents:function(t,e,i){var n,r,o=i.oldTarget,s=o!==t,a=i.canvasEvtIn,h=i.canvasEvtOut;s&&(n={e:e,target:t,previousTarget:o},r={e:e,target:o,nextTarget:t}),e=t&&s,o&&s&&(h&&this.fire(h,r),o.fire(i.evtOut,r)),e&&(a&&this.fire(a,n),t.fire(i.evtIn,n))},__onMouseWheel:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()},_transformObject:function(t){var e=this.getPointer(t),i=this._currentTransform;i.reset=!1,i.target.isMoving=!0,i.shiftKey=t.shiftKey,i.altKey=t[this.centeredKey],this._performTransformAction(t,i,e),i.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(t,e,i){var n=i.x,r=i.y,o=e.action,s=!1,i=e.actionHandler;i&&(s=i(t,e,n,r)),"drag"===o&&s&&this.setCursor(e.target.moveCursor||this.moveCursor),e.actionPerformed=e.actionPerformed||s},_fire:Y.controlsUtils.fireEvent,_setCursorFromEvent:function(t,e){if(!e)return this.setCursor(this.defaultCursor),!1;var i=e.hoverCursor||this.hoverCursor,n=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,n=(!n||!n.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));n?this.setCursor(this.getCornerCursor(n,e,t)):(e.subTargetCheck&&this.targets.concat().reverse().map(function(t){i=t.hoverCursor||i}),this.setCursor(i))},getCornerCursor:function(t,e,i){t=e.controls[t];return t.cursorStyleHandler(i,t,e)}}),d=Math.min,p=Math.max,Y.util.object.extend(Y.Canvas.prototype,{_shouldGroup:function(t,e){var i=this._activeObject;return i&&this._isSelectionKeyPressed(t)&&e&&e.selectable&&this.selection&&(i!==e||"activeSelection"===i.type)&&!e.onSelect({e:t})},_handleGrouping:function(t,e){var i=this._activeObject;i.__corner||(e!==i||(e=this.findTarget(t,!0))&&e.selectable)&&(i&&"activeSelection"===i.type?this._updateActiveSelection(e,t):this._createActiveSelection(e,t))},_updateActiveSelection:function(t,e){var i=this._activeObject,n=i._objects.slice(0);i.contains(t)?(i.removeWithUpdate(t),this._hoveredTarget=t,this._hoveredTargets=this.targets.concat(),1===i.size()&&this._setActiveObject(i.item(0),e)):(i.addWithUpdate(t),this._hoveredTarget=i,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(n,e)},_createActiveSelection:function(t,e){var i=this.getActiveObjects(),t=this._createGroup(t);this._hoveredTarget=t,this._setActiveObject(t,e),this._fireSelectionEvents(i,e)},_createGroup:function(t){var e=this._objects,t=e.indexOf(this._activeObject)<e.indexOf(t)?[this._activeObject,t]:[t,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new Y.ActiveSelection(t,{canvas:this})},_groupSelectedObjects:function(t){var e=this._collectObjects(t);1===e.length?this.setActiveObject(e[0],t):1<e.length&&(e=new Y.ActiveSelection(e.reverse(),{canvas:this}),this.setActiveObject(e,t))},_collectObjects:function(e){for(var t,i=[],n=this._groupSelector.ex,r=this._groupSelector.ey,o=n+this._groupSelector.left,s=r+this._groupSelector.top,a=new Y.Point(d(n,o),d(r,s)),h=new Y.Point(p(n,o),p(r,s)),c=!this.selectionFullyContained,l=n===o&&r===s,u=this._objects.length;u--&&!((t=this._objects[u])&&t.selectable&&t.visible&&(c&&t.intersectsWithRect(a,h)||t.isContainedWithinRect(a,h)||c&&t.containsPoint(a)||c&&t.containsPoint(h))&&(i.push(t),l)););return i=1<i.length?i.filter(function(t){return!t.onSelect({e:e})}):i},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t),this.setCursor(this.defaultCursor),this._groupSelector=null}}),Y.util.object.extend(Y.StaticCanvas.prototype,{toDataURL:function(t){var e=(t=t||{}).format||"png",i=t.quality||1,n=(t.multiplier||1)*(t.enableRetinaScaling?this.getRetinaScaling():1),t=this.toCanvasElement(n,t);return Y.util.toDataURL(t,e,i)},toCanvasElement:function(t,e){var i=((e=e||{}).width||this.width)*(t=t||1),n=(e.height||this.height)*t,r=this.getZoom(),o=this.width,s=this.height,a=r*t,h=this.viewportTransform,c=(h[4]-(e.left||0))*t,r=(h[5]-(e.top||0))*t,e=this.interactive,t=[a,0,0,a,c,r],a=this.enableRetinaScaling,c=Y.util.createCanvasElement(),r=this.contextTop;return c.width=i,c.height=n,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=t,this.width=i,this.height=n,this.calcViewportBoundaries(),this.renderCanvas(c.getContext("2d"),this._objects),this.viewportTransform=h,this.width=o,this.height=s,this.calcViewportBoundaries(),this.interactive=e,this.enableRetinaScaling=a,this.contextTop=r,c}}),Y.util.object.extend(Y.StaticCanvas.prototype,{loadFromJSON:function(t,i,e){if(t){var n="string"==typeof t?JSON.parse(t):Y.util.object.clone(t),r=this,o=n.clipPath,s=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete n.clipPath,this._enlivenObjects(n.objects,function(e){r.clear(),r._setBgOverlay(n,function(){o?r._enlivenObjects([o],function(t){r.clipPath=t[0],r.__setupCanvas.call(r,n,e,s,i)}):r.__setupCanvas.call(r,n,e,s,i)})},e),this}},__setupCanvas:function(t,e,i,n){var r=this;e.forEach(function(t,e){r.insertAt(t,e)}),this.renderOnAddRemove=i,delete t.objects,delete t.backgroundImage,delete t.overlayImage,delete t.background,delete t.overlay,this._setOptions(t),this.renderAll(),n&&n()},_setBgOverlay:function(t,e){var i,n={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};t.backgroundImage||t.overlayImage||t.background||t.overlay?(this.__setBgOverlay("backgroundImage",t.backgroundImage,n,i=function(){n.backgroundImage&&n.overlayImage&&n.backgroundColor&&n.overlayColor&&e&&e()}),this.__setBgOverlay("overlayImage",t.overlayImage,n,i),this.__setBgOverlay("backgroundColor",t.background,n,i),this.__setBgOverlay("overlayColor",t.overlay,n,i)):e&&e()},__setBgOverlay:function(e,t,i,n){var r=this;if(!t)return i[e]=!0,void(n&&n());"backgroundImage"===e||"overlayImage"===e?Y.util.enlivenObjects([t],function(t){r[e]=t[0],i[e]=!0,n&&n()}):this["set"+Y.util.string.capitalize(e,!0)](t,function(){i[e]=!0,n&&n()})},_enlivenObjects:function(t,e,i){t&&0!==t.length?Y.util.enlivenObjects(t,function(t){e&&e(t)},null,i):e&&e([])},_toDataURL:function(e,i){this.clone(function(t){i(t.toDataURL(e))})},_toDataURLWithMultiplier:function(e,i,n){this.clone(function(t){n(t.toDataURLWithMultiplier(e,i))})},clone:function(e,t){var i=JSON.stringify(this.toJSON(t));this.cloneWithoutData(function(t){t.loadFromJSON(i,function(){e&&e(t)})})},cloneWithoutData:function(t){var e=Y.util.createCanvasElement();e.width=this.width,e.height=this.height;var i=new Y.Canvas(e);this.backgroundImage?(i.setBackgroundImage(this.backgroundImage.src,function(){i.renderAll(),t&&t(i)}),i.backgroundImageOpacity=this.backgroundImageOpacity,i.backgroundImageStretch=this.backgroundImageStretch):t&&t(i)}}),function(t){"use strict";var g=t.fabric||(t.fabric={}),e=g.util.object.extend,o=g.util.object.clone,i=g.util.toFixed,n=g.util.string.capitalize,s=g.util.degreesToRadians,r=g.StaticCanvas.supports("setLineDash"),t=!g.isLikelyNode;g.Object||(g.Object=g.util.createClass(g.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:t,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(t){t&&this.setOptions(t)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=g.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(t){var e=g.perfLimitSizeTotal,i=t.width,n=t.height,r=g.maxCacheSideLimit,o=g.minCacheSideLimit;if(i<=r&&n<=r&&i*n<=e)return i<o&&(t.width=o),n<o&&(t.height=o),t;var s=g.util.limitDimsByArea(i/n,e),a=g.util.capValue,e=a(o,s.x,r),r=a(o,s.y,r);return e<i&&(t.zoomX/=i/e,t.width=e,t.capped=!0),r<n&&(t.zoomY/=n/r,t.height=r,t.capped=!0),t},_getCacheCanvasDimensions:function(){var t=this.getTotalObjectScaling(),e=this._getTransformedDimensions(0,0),i=e.x*t.scaleX/this.scaleX,e=e.y*t.scaleY/this.scaleY;return{width:2+i,height:2+e,zoomX:t.scaleX,zoomY:t.scaleY,x:i,y:e}},_updateCacheCanvas:function(){var t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){var e=t._currentTransform.target,i=t._currentTransform.action;if(this===e&&i.slice&&"scale"===i.slice(0,5))return!1}var n=this._cacheCanvas,r=this._limitCacheSize(this._getCacheCanvasDimensions()),o=g.minCacheSideLimit,s=r.width,a=r.height,h=r.zoomX,c=r.zoomY,l=s!==this.cacheWidth||a!==this.cacheHeight,u=this.zoomX!==h||this.zoomY!==c,f=0,d=0,p=!1;return l&&(t=this._cacheCanvas.width,e=this._cacheCanvas.height,p=(i=t<s||e<a)||(s<.9*t||a<.9*e)&&o<t&&o<e,i&&!r.capped&&(o<s||o<a)&&(f=.1*s,d=.1*a)),!!(l||u)&&(p?(n.width=Math.ceil(s+f),n.height=Math.ceil(a+d)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,n.width,n.height)),d=r.x/2,r=r.y/2,this.cacheTranslationX=Math.round(n.width/2-d)+d,this.cacheTranslationY=Math.round(n.height/2-r)+r,this.cacheWidth=s,this.cacheHeight=a,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(h,c),this.zoomX=h,this.zoomY=c,!0)},setOptions:function(t){this._setOptions(t),this._initGradient(t.fill,"fill"),this._initGradient(t.stroke,"stroke"),this._initPattern(t.fill,"fill"),this._initPattern(t.stroke,"stroke")},transform:function(t){var e=this.group&&!this.group._transformDone||this.group&&this.canvas&&t===this.canvas.contextTop,e=this.calcTransformMatrix(!e);t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},toObject:function(t){var e=g.Object.NUM_FRACTION_DIGITS,e={type:this.type,version:g.version,originX:this.originX,originY:this.originY,left:i(this.left,e),top:i(this.top,e),width:i(this.width,e),height:i(this.height,e),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:i(this.strokeWidth,e),strokeDashArray:this.strokeDashArray&&this.strokeDashArray.concat(),strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:i(this.strokeMiterLimit,e),scaleX:i(this.scaleX,e),scaleY:i(this.scaleY,e),angle:i(this.angle,e),flipX:this.flipX,flipY:this.flipY,opacity:i(this.opacity,e),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:i(this.skewX,e),skewY:i(this.skewY,e)};return this.clipPath&&(e.clipPath=this.clipPath.toObject(t),e.clipPath.inverted=this.clipPath.inverted,e.clipPath.absolutePositioned=this.clipPath.absolutePositioned),g.util.populateWithProperties(this,e,t),e=!this.includeDefaultValues?this._removeDefaultValues(e):e},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(e){var i=g.util.getKlass(e.type).prototype;return i.stateProperties.forEach(function(t){"left"!==t&&"top"!==t&&(e[t]===i[t]&&delete e[t],"[object Array]"===Object.prototype.toString.call(e[t])&&"[object Array]"===Object.prototype.toString.call(i[t])&&0===e[t].length&&0===i[t].length&&delete e[t])}),e},toString:function(){return"#<fabric."+n(this.type)+">"},getObjectScaling:function(){var t=g.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(t.scaleX),scaleY:Math.abs(t.scaleY)}},getTotalObjectScaling:function(){var t,e=this.getObjectScaling(),i=e.scaleX,n=e.scaleY;return this.canvas&&(i*=(t=this.canvas.getZoom())*(e=this.canvas.getRetinaScaling()),n*=t*e),{scaleX:i,scaleY:n}},getObjectOpacity:function(){var t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t},_set:function(t,e){var i,n=this[t]!==e;return("scaleX"===t||"scaleY"===t)&&(e=this._constrainScale(e)),"scaleX"===t&&e<0?(this.flipX=!this.flipX,e*=-1):"scaleY"===t&&e<0?(this.flipY=!this.flipY,e*=-1):"shadow"!==t||!e||e instanceof g.Shadow?"dirty"===t&&this.group&&this.group.set("dirty",e):e=new g.Shadow(e),this[t]=e,n&&(i=this.group&&this.group.isOnACache(),-1<this.cacheProperties.indexOf(t)?(this.dirty=!0,i&&this.group.set("dirty",!0)):i&&-1<this.stateProperties.indexOf(t)&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:g.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||!this.width&&!this.height&&0===this.strokeWidth||!this.visible},render:function(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(t),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),t.restore())},renderCache:function(t){t=t||{},this._cacheCanvas||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,t.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth},hasFill:function(){return this.fill&&"transparent"!==this.fill},needsItsOwnCache:function(){return!("stroke"!==this.paintFirst||!this.hasFill()||!this.hasStroke()||"object"!=typeof this.shadow)||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawClipPathOnCache:function(t){var e,i=this.clipPath;t.save(),i.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",i.absolutePositioned&&(e=g.util.invertTransform(this.calcTransformMatrix()),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])),i.transform(t),t.scale(1/i.zoomX,1/i.zoomY),t.drawImage(i._cacheCanvas,-i.cacheTranslationX,-i.cacheTranslationY),t.restore()},drawObject:function(t,e){var i=this.fill,n=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):this._renderBackground(t),this._render(t),this._drawClipPath(t),this.fill=i,this.stroke=n},_drawClipPath:function(t){var e=this.clipPath;e&&(e.canvas=this.canvas,e.shouldCache(),e._transformDone=!0,e.renderCache({forClipping:!0}),this.drawClipPathOnCache(t))},drawCacheOnCanvas:function(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(t){return!this.isNotVisible()&&(!(!this._cacheCanvas||t||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties"))&&(this._cacheCanvas&&!t&&(e=this.cacheWidth/this.zoomX,t=this.cacheHeight/this.zoomY,this._cacheContext.clearRect(-e/2,-t/2,e,t)),!0));var e},_renderBackground:function(t){var e;this.backgroundColor&&(e=this._getNonTransformedDimensions(),t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t))},_setOpacity:function(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity},_setStrokeStyles:function(t,e){var i=e.stroke;i&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,i.toLive?"percentage"===i.gradientUnits||i.gradientTrasnform||i.patternTransform?this._applyPatternForTransformedGradient(t,i):(t.strokeStyle=i.toLive(t,this),this._applyPatternGradientTransform(t,i)):t.strokeStyle=e.stroke)},_setFillStyles:function(t,e){var i=e.fill;i&&(i.toLive?(t.fillStyle=i.toLive(t,this),this._applyPatternGradientTransform(t,e.fill)):t.fillStyle=i)},_setClippingProperties:function(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"},_setLineDash:function(t,e,i){e&&0!==e.length&&(1&e.length&&e.push.apply(e,e),r?t.setLineDash(e):i&&i(t))},_renderControls:function(t,e){var i=this.getViewportTransform(),n=this.calcTransformMatrix(),r=(void 0!==(e=e||{}).hasBorders?e:this).hasBorders,o=(void 0!==e.hasControls?e:this).hasControls,n=g.util.multiplyTransformMatrices(i,n),n=g.util.qrDecompose(n);t.save(),t.translate(n.translateX,n.translateY),t.lineWidth=+this.borderScaleFactor,this.group||(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),e.forActiveSelection?(t.rotate(s(n.angle)),r&&this.drawBordersInGroup(t,n,e)):(t.rotate(s(this.angle)),r&&this.drawBorders(t,e)),o&&this.drawControls(t,e),t.restore()},_setShadow:function(t){var e,i,n,r,o;this.shadow&&(e=this.shadow,n=(i=this.canvas)&&i.viewportTransform[0]||1,r=i&&i.viewportTransform[3]||1,o=e.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),i&&i._isRetinaScaling()&&(n*=g.devicePixelRatio,r*=g.devicePixelRatio),t.shadowColor=e.color,t.shadowBlur=e.blur*g.browserShadowBlurConstant*(n+r)*(o.scaleX+o.scaleY)/4,t.shadowOffsetX=e.offsetX*n*o.scaleX,t.shadowOffsetY=e.offsetY*r*o.scaleY)},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_applyPatternGradientTransform:function(t,e){if(!e||!e.toLive)return{offsetX:0,offsetY:0};var i=e.gradientTransform||e.patternTransform,n=-this.width/2+e.offsetX||0,r=-this.height/2+e.offsetY||0;return"percentage"===e.gradientUnits?t.transform(this.width,0,0,this.height,n,r):t.transform(1,0,0,1,n,r),i&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),{offsetX:n,offsetY:r}},_renderPaintInOrder:function(t){"stroke"===this.paintFirst?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))},_render:function(){},_renderFill:function(t){this.fill&&(t.save(),this._setFillStyles(t,this),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore())},_renderStroke:function(t){var e;this.stroke&&0!==this.strokeWidth&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform&&this.group?(e=this.getObjectScaling(),t.scale(1/e.scaleX,1/e.scaleY)):this.strokeUniform&&t.scale(1/this.scaleX,1/this.scaleY),this._setLineDash(t,this.strokeDashArray,this._renderDashedStroke),this._setStrokeStyles(t,this),t.stroke(),t.restore())},_applyPatternForTransformedGradient:function(t,e){var i,n=this._limitCacheSize(this._getCacheCanvasDimensions()),r=g.util.createCanvasElement(),o=this.canvas.getRetinaScaling(),s=n.x/this.scaleX/o,a=n.y/this.scaleY/o;r.width=s,r.height=a,(i=r.getContext("2d")).beginPath(),i.moveTo(0,0),i.lineTo(s,0),i.lineTo(s,a),i.lineTo(0,a),i.closePath(),i.translate(s/2,a/2),i.scale(n.zoomX/this.scaleX/o,n.zoomY/this.scaleY/o),this._applyPatternGradientTransform(i,e),i.fillStyle=e.toLive(t),i.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(o*this.scaleX/n.zoomX,o*this.scaleY/n.zoomY),t.strokeStyle=i.createPattern(r,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){var t;this.transformMatrix&&(t=g.util.qrDecompose(this.transformMatrix),this.flipX=!1,this.flipY=!1,this.set("scaleX",t.scaleX),this.set("scaleY",t.scaleY),this.angle=t.angle,this.skewX=t.skewX,this.skewY=0)},_removeTransformMatrix:function(t){var e=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),e=g.util.transformPoint(e,this.transformMatrix)),this.transformMatrix=null,t&&(this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this.cropX=t.cropX,this.cropY=t.cropY,e.x+=t.offsetLeft,e.y+=t.offsetTop,this.width=t.width,this.height=t.height),this.setPositionByOrigin(e,"center","center")},clone:function(t,e){e=this.toObject(e);this.constructor.fromObject?this.constructor.fromObject(e,t):g.Object._fromObject("Object",e,t)},cloneAsImage:function(t,e){e=this.toCanvasElement(e);return t&&t(new g.Image(e)),this},toCanvasElement:function(t){t=t||{};var e=g.util,i=e.saveObjectTransform(this),n=this.group,r=this.shadow,o=Math.abs,s=(t.multiplier||1)*(t.enableRetinaScaling?g.devicePixelRatio:1);delete this.group,t.withoutTransform&&e.resetObjectTransform(this),t.withoutShadow&&(this.shadow=null);var a,h=g.util.createCanvasElement(),c=this.getBoundingRect(!0,!0),l=this.shadow,u={x:0,y:0};l&&(e=l.blur,a=l.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),u.x=2*Math.round(o(l.offsetX)+e)*o(a.scaleX),u.y=2*Math.round(o(l.offsetY)+e)*o(a.scaleY)),a=c.width+u.x,u=c.height+u.y,h.width=Math.ceil(a),h.height=Math.ceil(u);u=new g.StaticCanvas(h,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});"jpeg"===t.format&&(u.backgroundColor="#fff"),this.setPositionByOrigin(new g.Point(u.width/2,u.height/2),"center","center");h=this.canvas;u.add(this);t=u.toCanvasElement(s||1,t);return this.shadow=r,this.set("canvas",h),n&&(this.group=n),this.set(i).setCoords(),u._objects=[],u.dispose(),u=null,t},toDataURL:function(t){return g.util.toDataURL(this.toCanvasElement(t=t||{}),t.format||"png",t.quality||1)},isType:function(t){return this.type===t},complexity:function(){return 1},toJSON:function(t){return this.toObject(t)},rotate:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(t,e){e=e||this.canvas.getPointer(t);t=new g.Point(e.x,e.y),e=this._getLeftTopCoords();return{x:(t=this.angle?g.util.rotatePoint(t,e,s(-this.angle)):t).x-e.x,y:t.y-e.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}}),g.util.createAccessors&&g.util.createAccessors(g.Object),e(g.Object.prototype,g.Observable),g.Object.NUM_FRACTION_DIGITS=2,g.Object._fromObject=function(t,e,i,n){var r=g[t];e=o(e,!0),g.util.enlivenPatterns([e.fill,e.stroke],function(t){void 0!==t[0]&&(e.fill=t[0]),void 0!==t[1]&&(e.stroke=t[1]),g.util.enlivenObjects([e.clipPath],function(t){e.clipPath=t[0];t=n?new r(e[n],e):new r(e);i&&i(t)})})},g.Object.__uid=0)}(i),g=Y.util.degreesToRadians,m={left:-.5,center:0,right:.5},v={top:-.5,center:0,bottom:.5},Y.util.object.extend(Y.Object.prototype,{translateToGivenOrigin:function(t,e,i,n,r){var o=t.x,s=t.y;return"string"==typeof e?e=m[e]:e-=.5,"string"==typeof n?n=m[n]:n-=.5,"string"==typeof i?i=v[i]:i-=.5,"string"==typeof r?r=v[r]:r-=.5,i=r-i,((n=n-e)||i)&&(e=this._getTransformedDimensions(),o=t.x+n*e.x,s=t.y+i*e.y),new Y.Point(o,s)},translateToCenterPoint:function(t,e,i){i=this.translateToGivenOrigin(t,e,i,"center","center");return this.angle?Y.util.rotatePoint(i,t,g(this.angle)):i},translateToOriginPoint:function(t,e,i){i=this.translateToGivenOrigin(t,"center","center",e,i);return this.angle?Y.util.rotatePoint(i,t,g(this.angle)):i},getCenterPoint:function(){var t=new Y.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var i=this.getCenterPoint();return this.translateToOriginPoint(i,t,e)},toLocalPoint:function(t,e,i){var n=this.getCenterPoint(),i=void 0!==e&&void 0!==i?this.translateToGivenOrigin(n,"center","center",e,i):new Y.Point(this.left,this.top),t=new Y.Point(t.x,t.y);return(t=this.angle?Y.util.rotatePoint(t,n,-g(this.angle)):t).subtractEquals(i)},setPositionByOrigin:function(t,e,i){i=this.translateToCenterPoint(t,e,i),i=this.translateToOriginPoint(i,this.originX,this.originY);this.set("left",i.x),this.set("top",i.y)},adjustPosition:function(t){var e=g(this.angle),i=this.getScaledWidth(),n=Y.util.cos(e)*i,r=Y.util.sin(e)*i,e="string"==typeof this.originX?m[this.originX]:this.originX-.5,i="string"==typeof t?m[t]:t-.5;this.left+=n*(i-e),this.top+=r*(i-e),this.setCoords(),this.originX=t},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}}),j=Y.util,F=j.degreesToRadians,E=j.multiplyTransformMatrices,I=j.transformPoint,j.object.extend(Y.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(t,e){return e?t?this.calcACoords():this.calcLineCoords():(this.aCoords&&this.lineCoords||this.setCoords(!0),t?this.aCoords:this.lineCoords)},getCoords:function(t,e){return e=this._getCoords(t,e),[new Y.Point(e.tl.x,e.tl.y),new Y.Point(e.tr.x,e.tr.y),new Y.Point(e.br.x,e.br.y),new Y.Point(e.bl.x,e.bl.y)]},intersectsWithRect:function(t,e,i,n){n=this.getCoords(i,n);return"Intersection"===Y.Intersection.intersectPolygonRectangle(n,t,e).status},intersectsWithObject:function(t,e,i){return"Intersection"===Y.Intersection.intersectPolygonPolygon(this.getCoords(e,i),t.getCoords(e,i)).status||t.isContainedWithinObject(this,e,i)||this.isContainedWithinObject(t,e,i)},isContainedWithinObject:function(t,e,i){for(var n=this.getCoords(e,i),e=e?t.aCoords:t.lineCoords,r=0,o=t._getImageLines(e);r<4;r++)if(!t.containsPoint(n[r],o))return!1;return!0},isContainedWithinRect:function(t,e,i,n){n=this.getBoundingRect(i,n);return n.left>=t.x&&n.left+n.width<=e.x&&n.top>=t.y&&n.top+n.height<=e.y},containsPoint:function(t,e,i,n){n=this._getCoords(i,n),e=e||this._getImageLines(n),e=this._findCrossPoints(t,e);return 0!==e&&e%2==1},isOnScreen:function(t){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,i=this.canvas.vptCoords.br;return!!this.getCoords(!0,t).some(function(t){return t.x<=i.x&&t.x>=e.x&&t.y<=i.y&&t.y>=e.y})||!!this.intersectsWithRect(e,i,!0,t)||this._containsCenterOfCanvas(e,i,t)},_containsCenterOfCanvas:function(t,e,i){e={x:(t.x+e.x)/2,y:(t.y+e.y)/2};return!!this.containsPoint(e,null,!0,i)},isPartiallyOnScreen:function(t){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,i=this.canvas.vptCoords.br;return!!this.intersectsWithRect(e,i,!0,t)||this.getCoords(!0,t).every(function(t){return(t.x>=i.x||t.x<=e.x)&&(t.y>=i.y||t.y<=e.y)})&&this._containsCenterOfCanvas(e,i,t)},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var i,n,r,o=0;for(r in e)if(!((n=e[r]).o.y<t.y&&n.d.y<t.y||n.o.y>=t.y&&n.d.y>=t.y||(i=n.o.x===n.d.x&&n.o.x>=t.x?n.o.x:(i=(n.d.y-n.o.y)/(n.d.x-n.o.x),-(t.y-0*t.x-(n.o.y-i*n.o.x))/(0-i)),i>=t.x&&(o+=1),2!==o)))break;return o},getBoundingRect:function(t,e){e=this.getCoords(t,e);return j.makeBoundingBoxFromPoints(e)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:0===t?1e-4:t},scale:function(t){return this._set("scaleX",t),this._set("scaleY",t),this.setCoords()},scaleToWidth:function(t,e){e=this.getBoundingRect(e).width/this.getScaledWidth();return this.scale(t/this.width/e)},scaleToHeight:function(t,e){e=this.getBoundingRect(e).height/this.getScaledHeight();return this.scale(t/this.height/e)},calcCoords:function(t){return t?this.calcACoords():this.calcOCoords()},calcLineCoords:function(){var t=this.getViewportTransform(),e=this.padding,i=F(this.angle),n=j.cos(i)*e,r=j.sin(i)*e,i=n+r,n=n-r,r=this.calcACoords(),t={tl:I(r.tl,t),tr:I(r.tr,t),bl:I(r.bl,t),br:I(r.br,t)};return e&&(t.tl.x-=n,t.tl.y-=i,t.tr.x+=i,t.tr.y-=n,t.bl.x-=i,t.bl.y+=n,t.br.x+=n,t.br.y+=i),t},calcOCoords:function(){var t=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),i=this.getViewportTransform(),e=E(i,e),n=E(e,t),r=(n=E(n,[1/i[0],0,0,1/i[3],0,0]),this._calculateCurrentDimensions()),o={};return this.forEachControl(function(t,e,i){o[e]=t.positionHandler(r,n,i)}),o},calcACoords:function(){var t=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),i=E(e,t),e=this._getTransformedDimensions(),t=e.x/2,e=e.y/2;return{tl:I({x:-t,y:-e},i),tr:I({x:t,y:-e},i),bl:I({x:-t,y:e},i),br:I({x:t,y:e},i)}},setCoords:function(t){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),t||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return j.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var t=this.getCenterPoint();return[1,0,0,1,t.x,t.y]},transformMatrixKey:function(t){var e="_",i="";return(i=!t&&this.group?this.group.transformMatrixKey(t)+e:i)+this.top+e+this.left+e+this.scaleX+e+this.scaleY+e+this.skewX+e+this.skewY+e+this.angle+e+this.originX+e+this.originY+e+this.width+e+this.height+e+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(t){var e=this.calcOwnMatrix();if(t||!this.group)return e;var i=this.transformMatrixKey(t),t=this.matrixCache||(this.matrixCache={});return t.key===i?t.value:(this.group&&(e=E(this.group.calcTransformMatrix(!1),e)),t.key=i,t.value=e)},calcOwnMatrix:function(){var t=this.transformMatrixKey(!0),e=this.ownMatrixCache||(this.ownMatrixCache={});if(e.key===t)return e.value;var i=this._calcTranslateMatrix(),i={angle:this.angle,translateX:i[4],translateY:i[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return e.key=t,e.value=j.composeMatrix(i),e.value},_calcDimensionsTransformMatrix:function(t,e,i){return j.calcDimensionsMatrix({skewX:t,skewY:e,scaleX:this.scaleX*(i&&this.flipX?-1:1),scaleY:this.scaleY*(i&&this.flipY?-1:1)})},_getNonTransformedDimensions:function(){var t=this.strokeWidth;return{x:this.width+t,y:this.height+t}},_getTransformedDimensions:function(t,e){void 0===t&&(t=this.skewX),void 0===e&&(e=this.skewY);var i,n=this._getNonTransformedDimensions(),n=this.strokeUniform?(i=this.width,this.height):(i=n.x,n.y);if(0===t&&0===e)return this._finalizeDimensions(i*this.scaleX,n*this.scaleY);e=j.sizeAfterTransform(i,n,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:t,skewY:e});return this._finalizeDimensions(e.x,e.y)},_finalizeDimensions:function(t,e){return this.strokeUniform?{x:t+this.strokeWidth,y:e+this.strokeWidth}:{x:t,y:e}},_calculateCurrentDimensions:function(){var t=this.getViewportTransform(),e=this._getTransformedDimensions();return I(e,t,!0).scalarAdd(2*this.padding)}}),Y.util.object.extend(Y.Object.prototype,{sendToBack:function(){return this.group?Y.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?Y.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?Y.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas&&this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?Y.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas&&this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group&&"activeSelection"!==this.group.type?Y.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas&&this.canvas.moveTo(this,t),this}}),N=Y.util.toFixed,Y.util.object.extend(Y.Object.prototype,{getSvgStyles:function(t){var e=this.fillRule||"nonzero",i=this.strokeWidth||"0",n=this.strokeDashArray?this.strokeDashArray.join(" "):"none",r=this.strokeDashOffset||"0",o=this.strokeLineCap||"butt",s=this.strokeLineJoin||"miter",a=this.strokeMiterLimit||"4",h=void 0!==this.opacity?this.opacity:"1",c=this.visible?"":" visibility: hidden;",l=t?"":this.getSvgFilter(),t=Q("fill",this.fill);return[Q("stroke",this.stroke),"stroke-width: ",i,"; ","stroke-dasharray: ",n,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",r,"; ","stroke-linejoin: ",s,"; ","stroke-miterlimit: ",a,"; ",t,"fill-rule: ",e,"; ","opacity: ",h,";",l,c].join("")},getSvgSpanStyles:function(t,e){var i="; ",n=t.fontFamily?"font-family: "+(-1===t.fontFamily.indexOf("'")&&-1===t.fontFamily.indexOf('"')?"'"+t.fontFamily+"'":t.fontFamily)+i:"",r=t.strokeWidth?"stroke-width: "+t.strokeWidth+i:"",o=t.fontSize?"font-size: "+t.fontSize+"px"+i:"",s=t.fontStyle?"font-style: "+t.fontStyle+i:"",a=t.fontWeight?"font-weight: "+t.fontWeight+i:"",h=t.fill?Q("fill",t.fill):"",c=t.stroke?Q("stroke",t.stroke):"",l=this.getSvgTextDecoration(t);return[c,r,n,o,s,a,l=l&&"text-decoration: "+l+i,h,t.deltaY?"baseline-shift: "+-t.deltaY+"; ":"",e?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(e){return["overline","underline","line-through"].filter(function(t){return e[t.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(t,e){t=t?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+Y.util.matrixToSVG(t)+(e||"")+'" '},_setSVGBg:function(t){var e;this.backgroundColor&&(e=Y.Object.NUM_FRACTION_DIGITS,t.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',N(-this.width/2,e),'" y="',N(-this.height/2,e),'" width="',N(this.width,e),'" height="',N(this.height,e),'"></rect>\n'))},toSVG:function(t){return this._createBaseSVGMarkup(this._toSVG(t),{reviver:t})},toClipPathSVG:function(t){return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(t),{reviver:t})},_createBaseClipPathSVGMarkup:function(t,e){var i=(e=e||{}).reviver,n=e.additionalTransform||"",e=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),n=t.indexOf("COMMON_PARTS");return t[n]=e,i?i(t.join("")):t.join("")},_createBaseSVGMarkup:function(t,e){var i,n=(e=e||{}).noStyle,r=e.reviver,o=n?"":'style="'+this.getSvgStyles()+'" ',s=e.withShadow?'style="'+this.getSvgFilter()+'" ':"",a=this.clipPath,h=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",c=a&&a.absolutePositioned,l=this.stroke,u=this.fill,f=this.shadow,d=[],p=t.indexOf("COMMON_PARTS"),e=e.additionalTransform;return a&&(a.clipPathId="CLIPPATH_"+Y.Object.__uid++,i='<clipPath id="'+a.clipPathId+'" >\n'+a.toClipPathSVG(r)+"</clipPath>\n"),c&&d.push("<g ",s,this.getSvgCommons()," >\n"),d.push("<g ",this.getSvgTransform(!1),c?"":s+this.getSvgCommons()," >\n"),e=[o,h,n?"":this.addPaintOrder()," ",e?'transform="'+e+'" ':""].join(""),t[p]=e,u&&u.toLive&&d.push(u.toSVG(this)),l&&l.toLive&&d.push(l.toSVG(this)),f&&d.push(f.toSVG(this)),a&&d.push(i),d.push(t.join("")),d.push("</g>\n"),c&&d.push("</g>\n"),r?r(d.join("")):d.join("")},addPaintOrder:function(){return"fill"!==this.paintFirst?' paint-order="'+this.paintFirst+'" ':""}}),k=Y.util.object.extend,O="stateProperties",Y.util.object.extend(Y.Object.prototype,{hasStateChanged:function(t){var e="_"+(t=t||O);return Object.keys(this[e]).length<this[t].length||!function t(e,i,n){if(e===i)return 1;if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return;for(var r=0,o=e.length;r<o;r++)if(!t(e[r],i[r]))return;return 1}if(e&&"object"==typeof e){var s,a=Object.keys(e);if(i&&"object"==typeof i&&(n||a.length===Object.keys(i).length)){for(r=0,o=a.length;r<o;r++)if("canvas"!==(s=a[r])&&"group"!==s&&!t(e[s],i[s]))return;return 1}}}(this[e],this,!0)},saveState:function(t){var e=t&&t.propertySet||O,i="_"+e;return this[i]?(Z(this,i,this[e]),t&&t.stateProperties&&Z(this,i,t.stateProperties),this):this.setupState(t)},setupState:function(t){var e=(t=t||{}).propertySet||O;return this["_"+(t.propertySet=e)]={},this.saveState(t),this}}),P=Y.util.degreesToRadians,Y.util.object.extend(Y.Object.prototype,{_findTargetCorner:function(t,e){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var i,n,r=t.x,o=t.y,s=Object.keys(this.oCoords),a=s.length-1;for(this.__corner=0;0<=a;a--)if(n=s[a],this.isControlVisible(n)&&(i=this._getImageLines(e?this.oCoords[n].touchCorner:this.oCoords[n].corner),0!==(i=this._findCrossPoints({x:r,y:o},i))&&i%2==1))return this.__corner=n;return!1},forEachControl:function(t){for(var e in this.controls)t(this.controls[e],e,this)},_setCornerCoords:function(){var t,e=this.oCoords;for(t in e){var i=this.controls[t];e[t].corner=i.calcCornerCoords(this.angle,this.cornerSize,e[t].x,e[t].y,!1),e[t].touchCorner=i.calcCornerCoords(this.angle,this.touchCornerSize,e[t].x,e[t].y,!0)}},drawSelectionBackground:function(t){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;t.save();var e=this.getCenterPoint(),i=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return t.translate(e.x,e.y),t.scale(1/n[0],1/n[3]),t.rotate(P(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-i.x/2,-i.y/2,i.x,i.y),t.restore(),this},drawBorders:function(n,t){t=t||{};var e=this._calculateCurrentDimensions(),i=this.borderScaleFactor,r=e.x+i,o=e.y+i,i=(void 0!==t.hasControls?t:this).hasControls,s=!1;return n.save(),n.strokeStyle=t.borderColor||this.borderColor,this._setLineDash(n,t.borderDashArray||this.borderDashArray,null),n.strokeRect(-r/2,-o/2,r,o),i&&(n.beginPath(),this.forEachControl(function(t,e,i){t.withConnection&&t.getVisibility(i,e)&&(s=!0,n.moveTo(t.x*r,t.y*o),n.lineTo(t.x*r+t.offsetX,t.y*o+t.offsetY))}),s&&n.stroke()),n.restore(),this},drawBordersInGroup:function(t,e,i){i=i||{};var n=Y.util.sizeAfterTransform(this.width,this.height,e),r=this.strokeWidth,o=this.strokeUniform,s=this.borderScaleFactor,a=n.x+r*(o?this.canvas.getZoom():e.scaleX)+s,s=n.y+r*(o?this.canvas.getZoom():e.scaleY)+s;return t.save(),this._setLineDash(t,i.borderDashArray||this.borderDashArray,null),t.strokeStyle=i.borderColor||this.borderColor,t.strokeRect(-a/2,-s/2,a,s),t.restore(),this},drawControls:function(n,r){return r=r||{},n.save(),n.setTransform(this.canvas.getRetinaScaling(),0,0,this.canvas.getRetinaScaling(),0,0),n.strokeStyle=n.fillStyle=r.cornerColor||this.cornerColor,this.transparentCorners||(n.strokeStyle=r.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(n,r.cornerDashArray||this.cornerDashArray,null),this.setCoords(),this.forEachControl(function(t,e,i){t.getVisibility(i,e)&&t.render(n,i.oCoords[e].x,i.oCoords[e].y,r,i)}),n.restore(),this},isControlVisible:function(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)},setControlVisible:function(t,e){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=e,this},setControlsVisibility:function(t){for(var e in t=t||{})this.setControlVisible(e,t[e]);return this},onDeselect:function(){},onSelect:function(){}}),Y.util.object.extend(Y.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(e,t){function i(){}var n=(t=t||{}).onComplete||i,r=t.onChange||i,o=this;return Y.util.animate({startValue:e.left,endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(t){e.set("left",t),o.requestRenderAll(),r()},onComplete:function(){e.setCoords(),n()}}),this},fxCenterObjectV:function(e,t){function i(){}var n=(t=t||{}).onComplete||i,r=t.onChange||i,o=this;return Y.util.animate({startValue:e.top,endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(t){e.set("top",t),o.requestRenderAll(),r()},onComplete:function(){e.setCoords(),n()}}),this},fxRemove:function(e,t){function i(){}var n=(t=t||{}).onComplete||i,r=t.onChange||i,o=this;return Y.util.animate({startValue:e.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(t){e.set("opacity",t),o.requestRenderAll(),r()},onComplete:function(){o.remove(e),n()}}),this}}),Y.util.object.extend(Y.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var t,e,i=[];for(t in arguments[0])i.push(t);for(var n=0,r=i.length;n<r;n++)t=i[n],e=n!==r-1,this._animate(t,arguments[0][t],arguments[1],e)}else this._animate.apply(this,arguments);return this},_animate:function(n,t,r,o){var s,a=this;t=t.toString(),r=r?Y.util.object.clone(r):{},~n.indexOf(".")&&(s=n.split("."));var e=-1<a.colorProperties.indexOf(n)||s&&-1<a.colorProperties.indexOf(s[1]),i=s?this.get(s[0])[s[1]]:this.get(n);"from"in r||(r.from=i),e||(t=~t.indexOf("=")?i+parseFloat(t.replace("=","")):parseFloat(t));t={startValue:r.from,endValue:t,byValue:r.by,easing:r.easing,duration:r.duration,abort:r.abort&&function(){return r.abort.call(a)},onChange:function(t,e,i){s?a[s[0]][s[1]]=t:a.set(n,t),o||r.onChange&&r.onChange(t,e,i)},onComplete:function(t,e,i){o||(a.setCoords(),r.onComplete&&r.onComplete(t,e,i))}};e?Y.util.animateColor(t.startValue,t.endValue,t.duration,t):Y.util.animate(t)}}),function(t){"use strict";var r=t.fabric||(t.fabric={}),o=r.util.object.extend,n=r.util.object.clone,i={x1:1,x2:1,y1:1,y2:1},s=r.StaticCanvas.supports("setLineDash");function e(t,e){var i=t.origin,n=t.axis1,r=t.axis2,o=t.dimension,s=e.nearest,a=e.center,h=e.farthest;return function(){switch(this.get(i)){case s:return Math.min(this.get(n),this.get(r));case a:return Math.min(this.get(n),this.get(r))+.5*this.get(o);case h:return Math.max(this.get(n),this.get(r))}}}r.Line?r.warn("fabric.Line is already defined"):(r.Line=r.util.createClass(r.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:r.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(t,e){t=t||[0,0,0,0],this.callSuper("initialize",e),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(e)},_setWidthHeight:function(t){t=t||{},this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,e){return this.callSuper("_set",t,e),void 0!==i[t]&&this._setWidthHeight(),this},_getLeftToOriginX:e({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:e({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t){t.beginPath(),(!this.strokeDashArray||this.strokeDashArray&&s)&&(e=this.calcLinePoints(),t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2)),t.lineWidth=this.strokeWidth;var e=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=e},_renderDashedStroke:function(t){var e=this.calcLinePoints();t.beginPath(),r.util.drawDashedLine(t,e.x1,e.y1,e.x2,e.y2,this.strokeDashArray),t.closePath()},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(t){return o(this.callSuper("toObject",t),this.calcLinePoints())},_getNonTransformedDimensions:function(){var t=this.callSuper("_getNonTransformedDimensions");return"butt"===this.strokeLineCap&&(0===this.width&&(t.y-=this.strokeWidth),0===this.height&&(t.x-=this.strokeWidth)),t},calcLinePoints:function(){var t=this.x1<=this.x2?-1:1,e=this.y1<=this.y2?-1:1,i=t*this.width*.5,n=e*this.height*.5;return{x1:i,x2:t*this.width*-.5,y1:n,y2:e*this.height*-.5}},_toSVG:function(){var t=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',t.x1,'" y1="',t.y1,'" x2="',t.x2,'" y2="',t.y2,'" />\n']}}),r.Line.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),r.Line.fromElement=function(t,e,i){i=i||{};var n=r.parseAttributes(t,r.Line.ATTRIBUTE_NAMES),t=[n.x1||0,n.y1||0,n.x2||0,n.y2||0];e(new r.Line(t,o(n,i)))},r.Line.fromObject=function(t,e){var i=n(t,!0);i.points=[t.x1,t.y1,t.x2,t.y2],r.Object._fromObject("Line",i,function(t){delete t.points,e&&e(t)},"points")})}(i),function(t){"use strict";var o=t.fabric||(t.fabric={}),s=Math.PI;o.Circle?o.warn("fabric.Circle is already defined."):(o.Circle=o.util.createClass(o.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*s,cacheProperties:o.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(t,e){return this.callSuper("_set",t,e),"radius"===t&&this.setRadius(e),this},toObject:function(t){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(t))},_toSVG:function(){var t,e,i,n,r=(this.endAngle-this.startAngle)%(2*s);return 0==r?["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,'" />\n']:(t=o.util.cos(this.startAngle)*this.radius,e=o.util.sin(this.startAngle)*this.radius,i=o.util.cos(this.endAngle)*this.radius,n=o.util.sin(this.endAngle)*this.radius,['<path d="M '+t+" "+e," A "+this.radius+" "+this.radius," 0 ",+(s<r?"1":"0")+" 1"," "+i+" "+n,'" ',"COMMON_PARTS"," />\n"])},_render:function(t){t.beginPath(),t.arc(0,0,this.radius,this.startAngle,this.endAngle,!1),this._renderPaintInOrder(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){return this.radius=t,this.set("width",2*t).set("height",2*t)}}),o.Circle.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),o.Circle.fromElement=function(t,e){t=o.parseAttributes(t,o.Circle.ATTRIBUTE_NAMES);if(!("radius"in t&&0<=t.radius))throw new Error("value of `r` attribute is required and can not be negative");t.left=(t.left||0)-t.radius,t.top=(t.top||0)-t.radius,e(new o.Circle(t))},o.Circle.fromObject=function(t,e){return o.Object._fromObject("Circle",t,e)})}(i),function(t){"use strict";var n=t.fabric||(t.fabric={});n.Triangle?n.warn("fabric.Triangle is already defined"):(n.Triangle=n.util.createClass(n.Object,{type:"triangle",width:100,height:100,_render:function(t){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,i),t.lineTo(0,-i),t.lineTo(e,i),t.closePath(),this._renderPaintInOrder(t)},_renderDashedStroke:function(t){var e=this.width/2,i=this.height/2;t.beginPath(),n.util.drawDashedLine(t,-e,i,0,-i,this.strokeDashArray),n.util.drawDashedLine(t,0,-i,e,i,this.strokeDashArray),n.util.drawDashedLine(t,e,i,-e,i,this.strokeDashArray),t.closePath()},_toSVG:function(){var t=this.width/2,e=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-t+" "+e,"0 "+-e,t+" "+e].join(","),'" />']}}),n.Triangle.fromObject=function(t,e){return n.Object._fromObject("Triangle",t,e)})}(i),function(t){"use strict";var i=t.fabric||(t.fabric={}),e=2*Math.PI;i.Ellipse?i.warn("fabric.Ellipse is already defined."):(i.Ellipse=i.util.createClass(i.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:i.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this.set("rx",t&&t.rx||0),this.set("ry",t&&t.ry||0)},_set:function(t,e){switch(this.callSuper("_set",t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,'" />\n']},_render:function(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,e,!1),t.restore(),this._renderPaintInOrder(t)}}),i.Ellipse.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),i.Ellipse.fromElement=function(t,e){t=i.parseAttributes(t,i.Ellipse.ATTRIBUTE_NAMES);t.left=(t.left||0)-t.rx,t.top=(t.top||0)-t.ry,e(new i.Ellipse(t))},i.Ellipse.fromObject=function(t,e){return i.Object._fromObject("Ellipse",t,e)})}(i),function(t){"use strict";var o=t.fabric||(t.fabric={}),n=o.util.object.extend;o.Rect?o.warn("fabric.Rect is already defined"):(o.Rect=o.util.createClass(o.Object,{stateProperties:o.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:o.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t){var e=this.rx?Math.min(this.rx,this.width/2):0,i=this.ry?Math.min(this.ry,this.height/2):0,n=this.width,r=this.height,o=-this.width/2,s=-this.height/2,a=0!==e||0!==i,h=.4477152502;t.beginPath(),t.moveTo(o+e,s),t.lineTo(o+n-e,s),a&&t.bezierCurveTo(o+n-h*e,s,o+n,s+h*i,o+n,s+i),t.lineTo(o+n,s+r-i),a&&t.bezierCurveTo(o+n,s+r-h*i,o+n-h*e,s+r,o+n-e,s+r),t.lineTo(o+e,s+r),a&&t.bezierCurveTo(o+h*e,s+r,o,s+r-h*i,o,s+r-i),t.lineTo(o,s+i),a&&t.bezierCurveTo(o,s+h*i,o+h*e,s,o+e,s),t.closePath(),this._renderPaintInOrder(t)},_renderDashedStroke:function(t){var e=-this.width/2,i=-this.height/2,n=this.width,r=this.height;t.beginPath(),o.util.drawDashedLine(t,e,i,e+n,i,this.strokeDashArray),o.util.drawDashedLine(t,e+n,i,e+n,i+r,this.strokeDashArray),o.util.drawDashedLine(t,e+n,i+r,e,i+r,this.strokeDashArray),o.util.drawDashedLine(t,e,i+r,e,i,this.strokeDashArray),t.closePath()},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,'" />\n']}}),o.Rect.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),o.Rect.fromElement=function(t,e,i){if(!t)return e(null);i=i||{};t=o.parseAttributes(t,o.Rect.ATTRIBUTE_NAMES);t.left=t.left||0,t.top=t.top||0,t.height=t.height||0,t.width=t.width||0;t=new o.Rect(n(i?o.util.object.clone(i):{},t));t.visible=t.visible&&0<t.width&&0<t.height,e(t)},o.Rect.fromObject=function(t,e){return o.Object._fromObject("Rect",t,e)})}(i),function(t){"use strict";var s=t.fabric||(t.fabric={}),o=s.util.object.extend,n=s.util.array.min,r=s.util.array.max,a=s.util.toFixed;s.Polyline?s.warn("fabric.Polyline is already defined"):(s.Polyline=s.util.createClass(s.Object,{type:"polyline",points:null,cacheProperties:s.Object.prototype.cacheProperties.concat("points"),initialize:function(t,e){e=e||{},this.points=t||[],this.callSuper("initialize",e),this._setPositionDimensions(e)},_setPositionDimensions:function(t){var e,i=this._calcDimensions(t);this.width=i.width,this.height=i.height,t.fromSVG||(e=this.translateToGivenOrigin({x:i.left-this.strokeWidth/2,y:i.top-this.strokeWidth/2},"left","top",this.originX,this.originY)),void 0===t.left&&(this.left=t.fromSVG?i.left:e.x),void 0===t.top&&(this.top=t.fromSVG?i.top:e.y),this.pathOffset={x:i.left+this.width/2,y:i.top+this.height/2}},_calcDimensions:function(){var t=this.points,e=n(t,"x")||0,i=n(t,"y")||0;return{left:e,top:i,width:(r(t,"x")||0)-e,height:(r(t,"y")||0)-i}},toObject:function(t){return o(this.callSuper("toObject",t),{points:this.points.concat()})},_toSVG:function(){for(var t=[],e=this.pathOffset.x,i=this.pathOffset.y,n=s.Object.NUM_FRACTION_DIGITS,r=0,o=this.points.length;r<o;r++)t.push(a(this.points[r].x-e,n),",",a(this.points[r].y-i,n)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',t.join(""),'" />\n']},commonRender:function(t){var e,i=this.points.length,n=this.pathOffset.x,r=this.pathOffset.y;if(!i||isNaN(this.points[i-1].y))return!1;t.beginPath(),t.moveTo(this.points[0].x-n,this.points[0].y-r);for(var o=0;o<i;o++)e=this.points[o],t.lineTo(e.x-n,e.y-r);return!0},_render:function(t){this.commonRender(t)&&this._renderPaintInOrder(t)},_renderDashedStroke:function(t){var e,i;t.beginPath();for(var n=0,r=this.points.length;n<r;n++)e=this.points[n],i=this.points[n+1]||e,s.util.drawDashedLine(t,e.x,e.y,i.x,i.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),s.Polyline.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat(),s.Polyline.fromElementGenerator=function(r){return function(t,e,i){if(!t)return e(null);i=i||{};var n=s.parsePointsAttribute(t.getAttribute("points")),t=s.parseAttributes(t,s[r].ATTRIBUTE_NAMES);t.fromSVG=!0,e(new s[r](n,o(t,i)))}},s.Polyline.fromElement=s.Polyline.fromElementGenerator("Polyline"),s.Polyline.fromObject=function(t,e){return s.Object._fromObject("Polyline",t,e,"points")})}(i),function(t){"use strict";var i=t.fabric||(t.fabric={});i.Polygon?i.warn("fabric.Polygon is already defined"):(i.Polygon=i.util.createClass(i.Polyline,{type:"polygon",_render:function(t){this.commonRender(t)&&(t.closePath(),this._renderPaintInOrder(t))},_renderDashedStroke:function(t){this.callSuper("_renderDashedStroke",t),t.closePath()}}),i.Polygon.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat(),i.Polygon.fromElement=i.Polyline.fromElementGenerator("Polygon"),i.Polygon.fromObject=function(t,e){return i.Object._fromObject("Polygon",t,e,"points")})}(i),function(t){"use strict";var f=t.fabric||(t.fabric={}),d=f.util.array.min,p=f.util.array.max,n=f.util.object.extend,r=Object.prototype.toString,e=f.util.toFixed;f.Path?f.warn("fabric.Path is already defined"):(f.Path=f.util.createClass(f.Object,{type:"path",path:null,cacheProperties:f.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:f.Object.prototype.stateProperties.concat("path"),initialize:function(t,e){this.callSuper("initialize",e=e||{});var i="[object Array]"===r.call(t=t||[]);this.path=i?f.util.makePathSimpler(t):f.util.makePathSimpler(f.util.parsePath(t)),this.path&&f.Polyline.prototype._setPositionDimensions.call(this,e)},_renderPathCommands:function(t){var e,i=0,n=0,r=0,o=0,s=0,a=0,h=-this.pathOffset.x,c=-this.pathOffset.y;t.beginPath();for(var l=0,u=this.path.length;l<u;++l)switch((e=this.path[l])[0]){case"L":r=e[1],o=e[2],t.lineTo(r+h,o+c);break;case"M":i=r=e[1],n=o=e[2],t.moveTo(r+h,o+c);break;case"C":r=e[5],o=e[6],s=e[3],a=e[4],t.bezierCurveTo(e[1]+h,e[2]+c,s+h,a+c,r+h,o+c);break;case"Q":t.quadraticCurveTo(e[1]+h,e[2]+c,e[3]+h,e[4]+c),r=e[3],o=e[4],s=e[1],a=e[2];break;case"z":case"Z":r=i,o=n,t.closePath()}},_render:function(t){this._renderPathCommands(t),this._renderPaintInOrder(t)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){return n(this.callSuper("toObject",t),{path:this.path.map(function(t){return t.slice()})})},toDatalessObject:function(t){t=this.toObject(["sourcePath"].concat(t));return t.sourcePath&&delete t.path,t},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',this.path.map(function(t){return t.join(" ")}).join(" "),'" stroke-linecap="round" ',"/>\n"]},_getOffsetTransform:function(){var t=f.Object.NUM_FRACTION_DIGITS;return" translate("+e(-this.pathOffset.x,t)+", "+e(-this.pathOffset.y,t)+")"},toClipPathSVG:function(t){var e=this._getOffsetTransform();return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})},toSVG:function(t){var e=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var t,e,i=[],n=[],r=0,o=0,s=0,a=0,h=0,c=this.path.length;h<c;++h){switch((t=this.path[h])[0]){case"L":s=t[1],a=t[2],e=[];break;case"M":r=s=t[1],o=a=t[2],e=[];break;case"C":e=f.util.getBoundsOfCurve(s,a,t[1],t[2],t[3],t[4],t[5],t[6]),s=t[5],a=t[6];break;case"Q":e=f.util.getBoundsOfCurve(s,a,t[1],t[2],t[1],t[2],t[3],t[4]),s=t[3],a=t[4];break;case"z":case"Z":s=r,a=o}e.forEach(function(t){i.push(t.x),n.push(t.y)}),i.push(s),n.push(a)}var l=d(i)||0,u=d(n)||0;return{left:l,top:u,width:(p(i)||0)-l,height:(p(n)||0)-u}}}),f.Path.fromObject=function(e,i){var t;"string"==typeof e.sourcePath?(t=e.sourcePath,f.loadSVGFromURL(t,function(t){t=t[0];t.setOptions(e),i&&i(t)})):f.Object._fromObject("Path",e,i,"path")},f.Path.ATTRIBUTE_NAMES=f.SHARED_ATTRIBUTES.concat(["d"]),f.Path.fromElement=function(t,e,i){t=f.parseAttributes(t,f.Path.ATTRIBUTE_NAMES);t.fromSVG=!0,e(new f.Path(t.d,n(t,i)))})}(i),function(t){"use strict";var s=t.fabric||(t.fabric={}),a=s.util.array.min,h=s.util.array.max;s.Group||(s.Group=s.util.createClass(s.Object,s.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(t,e,i){e=e||{},this._objects=[],i&&this.callSuper("initialize",e),this._objects=t||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;i?this._updateObjectsACoords():(i=e&&e.centerPoint,void 0!==e.originX&&(this.originX=e.originX),void 0!==e.originY&&(this.originY=e.originY),i||this._calcBounds(),this._updateObjectsCoords(i),delete e.centerPoint,this.callSuper("initialize",e)),this.setCoords()},_updateObjectsACoords:function(){for(var t=this._objects.length;t--;)this._objects[t].setCoords(!0)},_updateObjectsCoords:function(t){t=t||this.getCenterPoint();for(var e=this._objects.length;e--;)this._updateObjectCoords(this._objects[e],t)},_updateObjectCoords:function(t,e){var i=t.left,n=t.top;t.set({left:i-e.x,top:n-e.y}),t.group=this,t.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){return this._restoreObjectsState(),s.util.resetObjectTransform(this),t&&(this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},removeWithUpdate:function(t){return this._restoreObjectsState(),s.util.resetObjectTransform(this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(t){this.dirty=!0,t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){this.dirty=!0,delete t.group},_set:function(t,e){var i=this._objects.length;if(this.useSetOnGroup)for(;i--;)this._objects[i].setOnGroup(t,e);if("canvas"===t)for(;i--;)this._objects[i]._set(t,e);s.Object.prototype._set.call(this,t,e)},toObject:function(n){var r=this.includeDefaultValues,t=this._objects.map(function(t){var e=t.includeDefaultValues;t.includeDefaultValues=r;var i=t.toObject(n);return t.includeDefaultValues=e,i}),e=s.Object.prototype.toObject.call(this,n);return e.objects=t,e},toDatalessObject:function(n){var r,t,e=this.sourcePath;t=e||(r=this.includeDefaultValues,this._objects.map(function(t){var e=t.includeDefaultValues;t.includeDefaultValues=r;var i=t.toDatalessObject(n);return t.includeDefaultValues=e,i}));e=s.Object.prototype.toDatalessObject.call(this,n);return e.objects=t,e},render:function(t){this._transformDone=!0,this.callSuper("render",t),this._transformDone=!1},shouldCache:function(){var t=s.Object.prototype.shouldCache.call(this);if(t)for(var e=0,i=this._objects.length;e<i;e++)if(this._objects[e].willDrawShadow())return this.ownCaching=!1;return t},willDrawShadow:function(){if(s.Object.prototype.willDrawShadow.call(this))return!0;for(var t=0,e=this._objects.length;t<e;t++)if(this._objects[t].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(t){for(var e=0,i=this._objects.length;e<i;e++)this._objects[e].render(t);this._drawClipPath(t)},isCacheDirty:function(t){if(this.callSuper("isCacheDirty",t))return!0;if(!this.statefullCache)return!1;for(var e,i,n=0,r=this._objects.length;n<r;n++)if(this._objects[n].isCacheDirty(!0))return this._cacheCanvas&&(e=this.cacheWidth/this.zoomX,i=this.cacheHeight/this.zoomY,this._cacheContext.clearRect(-e/2,-i/2,e,i)),!0;return!1},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},realizeTransform:function(t){var e=t.calcTransformMatrix(),i=s.util.qrDecompose(e),e=new s.Point(i.translateX,i.translateY);return t.flipX=!1,t.flipY=!1,t.set("scaleX",i.scaleX),t.set("scaleY",i.scaleY),t.skewX=i.skewX,t.skewY=i.skewY,t.angle=i.angle,t.setPositionByOrigin(e,"center","center"),t},_restoreObjectState:function(t){return this.realizeTransform(t),delete t.group,t.setCoords(),this},destroy:function(){return this._objects.forEach(function(t){t.set("dirty",!0)}),this._restoreObjectsState()},toActiveSelection:function(){if(this.canvas){var t=this._objects,e=this.canvas;this._objects=[];var i=this.toObject();delete i.objects;var n=new s.ActiveSelection([]);return n.set(i),n.type="activeSelection",e.remove(this),t.forEach(function(t){t.group=n,t.dirty=!0,e.add(t)}),n.canvas=e,n._objects=t,(e._activeObject=n).setCoords(),n}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject(function(t){t.setCoords(!0)}),this},_calcBounds:function(t){for(var e,i,n,r=[],o=[],s=["tr","br","bl","tl"],a=0,h=this._objects.length,c=s.length;a<h;++a)for((e=this._objects[a]).aCoords=e.calcACoords(),n=0;n<c;n++)r.push(e.aCoords[i=s[n]].x),o.push(e.aCoords[i].y);this._getBounds(r,o,t)},_getBounds:function(t,e,i){var n=new s.Point(a(t),a(e)),r=new s.Point(h(t),h(e)),o=n.y||0,t=n.x||0,e=r.x-n.x||0,n=r.y-n.y||0;this.width=e,this.height=n,i||this.setPositionByOrigin({x:t,y:o},"left","top")},_toSVG:function(t){for(var e=["<g ","COMMON_PARTS"," >\n"],i=0,n=this._objects.length;i<n;i++)e.push("\t\t",this._objects[i].toSVG(t));return e.push("</g>\n"),e},getSvgStyles:function(){var t=void 0!==this.opacity&&1!==this.opacity?"opacity: "+this.opacity+";":"",e=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),e].join("")},toClipPathSVG:function(t){for(var e=[],i=0,n=this._objects.length;i<n;i++)e.push("\t",this._objects[i].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(e,{reviver:t})}}),s.Group.fromObject=function(n,r){var e=n.objects,i=s.util.object.clone(n,!0);delete i.objects,"string"!=typeof e?s.util.enlivenObjects(e,function(i){s.util.enlivenObjects([n.clipPath],function(t){var e=s.util.object.clone(n,!0);e.clipPath=t[0],delete e.objects,r&&r(new s.Group(i,e,!0))})}):s.loadSVGFromURL(e,function(t){t=s.util.groupSVGElements(t,n,e);t.set(i),r&&r(t)})})}(i),function(t){"use strict";var n=t.fabric||(t.fabric={});n.ActiveSelection||(n.ActiveSelection=n.util.createClass(n.Group,{type:"activeSelection",initialize:function(t,e){e=e||{},this._objects=t||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;e.originX&&(this.originX=e.originX),e.originY&&(this.originY=e.originY),this._calcBounds(),this._updateObjectsCoords(),n.Object.prototype.initialize.call(this,e),this.setCoords()},toGroup:function(){var t=this._objects.concat();this._objects=[];var e=n.Object.prototype.toObject.call(this),i=new n.Group([]);if(delete e.type,i.set(e),t.forEach(function(t){t.canvas.remove(t),t.group=i}),i._objects=t,!this.canvas)return i;t=this.canvas;return t.add(i),(t._activeObject=i).setCoords(),i},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(t,e,i){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",t,e),void 0===(i=i||{}).hasControls&&(i.hasControls=!1),i.forActiveSelection=!0;for(var n=0,r=this._objects.length;n<r;n++)this._objects[n]._renderControls(t,i);t.restore()}}),n.ActiveSelection.fromObject=function(e,i){n.util.enlivenObjects(e.objects,function(t){delete e.objects,i&&i(new n.ActiveSelection(t,e,!0))})})}(i),function(t){"use strict";var n=Y.util.object.extend;t.fabric||(t.fabric={}),t.fabric.Image?Y.warn("fabric.Image is already defined."):(Y.Image=Y.util.createClass(Y.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:Y.Object.prototype.stateProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(t,e){e=e||{},this.filters=[],this.cacheKey="texture"+Y.Object.__uid++,this.callSuper("initialize",e),this._initElement(t,e)},getElement:function(){return this._element||{}},setElement:function(t,e){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=t,this._originalElement=t,this._initConfig(e),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(t){var e=Y.filterBackend;e&&e.evictCachesForKey&&e.evictCachesForKey(t)},dispose:function(){this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(t){Y.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var t=this.getElement();return{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}},_stroke:function(t){var e,i;this.stroke&&0!==this.strokeWidth&&(e=this.width/2,i=this.height/2,t.beginPath(),t.moveTo(-e,-i),t.lineTo(e,-i),t.lineTo(e,i),t.lineTo(-e,i),t.lineTo(-e,-i),t.closePath())},_renderDashedStroke:function(t){var e=-this.width/2,i=-this.height/2,n=this.width,r=this.height;t.save(),this._setStrokeStyles(t,this),t.beginPath(),Y.util.drawDashedLine(t,e,i,e+n,i,this.strokeDashArray),Y.util.drawDashedLine(t,e+n,i,e+n,i+r,this.strokeDashArray),Y.util.drawDashedLine(t,e+n,i+r,e,i+r,this.strokeDashArray),Y.util.drawDashedLine(t,e,i+r,e,i,this.strokeDashArray),t.closePath(),t.restore()},toObject:function(t){var e=[];this.filters.forEach(function(t){t&&e.push(t.toObject())});t=n(this.callSuper("toObject",["cropX","cropY"].concat(t)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:e});return this.resizeFilter&&(t.resizeFilter=this.resizeFilter.toObject()),t},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var t,e,i=[],n=[],r=this._element,o=-this.width/2,s=-this.height/2,a="",h="";return r?(this.hasCrop()&&(e=Y.Object.__uid++,i.push('<clipPath id="imageCrop_'+e+'">\n','\t<rect x="'+o+'" y="'+s+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),a=' clip-path="url(#imageCrop_'+e+')" '),this.imageSmoothing||(h='" image-rendering="optimizeSpeed'),n.push("\t<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',o-this.cropX,'" y="',s-this.cropY,'" width="',r.width||r.naturalWidth,'" height="',r.height||r.height,h,'"',a,"></image>\n"),(this.stroke||this.strokeDashArray)&&(a=this.fill,this.fill=null,t=["\t<rect ",'x="',o,'" y="',s,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'],this.fill=a),"fill"!==this.paintFirst?i.concat(t,n):i.concat(n,t)):[]},getSrc:function(t){t=t?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src"):t.src:this.src||""},setSrc:function(t,i,n){return Y.util.loadImage(t,function(t,e){this.setElement(t,n),this._setWidthHeight(),i&&i(this,e)},this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var t=this.resizeFilter,e=this.minimumScaleTrigger,i=this.getTotalObjectScaling(),n=i.scaleX,r=i.scaleY,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||e<n&&e<r)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=n,void(this._lastScaleY=r);Y.filterBackend||(Y.filterBackend=Y.initFilterBackend());var s=Y.util.createCanvasElement(),a=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,i=o.width,e=o.height;s.width=i,s.height=e,this._element=s,this._lastScaleX=t.scaleX=n,this._lastScaleY=t.scaleY=r,Y.filterBackend.applyFilters([t],o,i,e,this._element,a),this._filterScalingX=s.width/this._originalElement.width,this._filterScalingY=s.height/this._originalElement.height},applyFilters:function(t){if(t=(t=t||this.filters||[]).filter(function(t){return t&&!t.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),0===t.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var e=this._originalElement,i=e.naturalWidth||e.width,n=e.naturalHeight||e.height;return this._element===this._originalElement?((e=Y.util.createCanvasElement()).width=i,e.height=n,this._element=e,this._filteredEl=e):(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,i,n),this._lastScaleX=1,this._lastScaleY=1),Y.filterBackend||(Y.filterBackend=Y.initFilterBackend()),Y.filterBackend.applyFilters(t,this._originalElement,i,n,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(t){Y.util.setImageSmoothing(t,this.imageSmoothing),!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)},drawCacheOnCanvas:function(t){Y.util.setImageSmoothing(t,this.imageSmoothing),Y.Object.prototype.drawCacheOnCanvas.call(this,t)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(t){var e,i,n,r,o,s,a,h,c,l,u,f,d,p,g=this._element;g&&(e=this._filterScalingX,f=this._filterScalingY,i=this.width,n=this.height,r=Math.min,d=(u=Math.max)(this.cropX,0),p=u(this.cropY,0),o=g.naturalWidth||g.width,s=g.naturalHeight||g.height,h=p*f,c=r(i*e,o-(a=d*e)),l=r(n*f,s-h),u=-i/2,f=-n/2,d=r(i,o/e-d),p=r(n,s/e-p),g&&t.drawImage(g,a,h,c,l,u,f,d,p))},_needsResize:function(){var t=this.getTotalObjectScaling();return t.scaleX!==this._lastScaleX||t.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(t,e){this.setElement(Y.util.getById(t),e),Y.util.addClass(this.getElement(),Y.Image.CSS_CANVAS)},_initConfig:function(t){this.setOptions(t=t||{}),this._setWidthHeight(t)},_initFilters:function(t,e){t&&t.length?Y.util.enlivenObjects(t,function(t){e&&e(t)},"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){t=t||{};var e=this.getElement();this.width=t.width||e.naturalWidth||e.width||0,this.height=t.height||e.naturalHeight||e.height||0},parsePreserveAspectRatioAttribute:function(){var t,e=Y.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),i=this._element.width,n=this._element.height,r=1,o=1,s=0,a=0,h=0,c=0,l=this.width,u=this.height,f={width:l,height:u};return!e||"none"===e.alignX&&"none"===e.alignY?(r=l/i,o=u/n):("meet"===e.meetOrSlice&&(t=(l-i*(r=o=Y.util.findScaleToFit(this._element,f)))/2,"Min"===e.alignX&&(s=-t),"Max"===e.alignX&&(s=t),t=(u-n*o)/2,"Min"===e.alignY&&(a=-t),"Max"===e.alignY&&(a=t)),"slice"===e.meetOrSlice&&(t=i-l/(r=o=Y.util.findScaleToCover(this._element,f)),"Mid"===e.alignX&&(h=t/2),"Max"===e.alignX&&(h=t),t=n-u/o,"Mid"===e.alignY&&(c=t/2),"Max"===e.alignY&&(c=t),i=l/r,n=u/o)),{width:i,height:n,scaleX:r,scaleY:o,offsetLeft:s,offsetTop:a,cropX:h,cropY:c}}}),Y.Image.CSS_CANVAS="canvas-img",Y.Image.prototype.getSvgSrc=Y.Image.prototype.getSrc,Y.Image.fromObject=function(t,i){var n=Y.util.object.clone(t);Y.util.loadImage(n.src,function(e,t){t?i&&i(null,!0):Y.Image.prototype._initFilters.call(n,n.filters,function(t){n.filters=t||[],Y.Image.prototype._initFilters.call(n,[n.resizeFilter],function(t){n.resizeFilter=t[0],Y.util.enlivenObjects([n.clipPath],function(t){n.clipPath=t[0];t=new Y.Image(e,n);i(t,!1)})})})},null,n.crossOrigin)},Y.Image.fromURL=function(t,i,n){Y.util.loadImage(t,function(t,e){i&&i(new Y.Image(t,n),e)},null,n&&n.crossOrigin)},Y.Image.ATTRIBUTE_NAMES=Y.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),Y.Image.fromElement=function(t,e,i){t=Y.parseAttributes(t,Y.Image.ATTRIBUTE_NAMES);Y.Image.fromURL(t["xlink:href"],e,n(i?Y.util.object.clone(i):{},t))})}(i),Y.util.object.extend(Y.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.angle%360;return 0<t?90*Math.round((t-1)/90):90*Math.round(t/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten()),this},fxStraighten:function(t){function e(){}var i=(t=t||{}).onComplete||e,n=t.onChange||e,r=this;return Y.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(t){r.rotate(t),n()},onComplete:function(){r.setCoords(),i()}}),this}}),Y.util.object.extend(Y.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.requestRenderAllBound}),this}}),function(){"use strict";function t(t){t&&t.tileSize&&(this.tileSize=t.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}Y.isWebglSupported=function(t){if(Y.isLikelyNode)return!1;t=t||Y.WebglFilterBackend.prototype.tileSize;var e,i,n,r=document.createElement("canvas"),o=r.getContext("webgl")||r.getContext("experimental-webgl"),r=!1;if(o){Y.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE);for(var r=Y.maxTextureSize>=t,s=["highp","mediump","lowp"],a=0;a<3;a++)if(n=void 0,n="precision "+(i=s[a])+" float;\nvoid main(){}",i=(e=o).createShader(e.FRAGMENT_SHADER),e.shaderSource(i,n),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)){Y.webGlPrecision=s[a];break}}return this.isSupported=r},(Y.WebglFilterBackend=t).prototype={tileSize:2048,resources:{},setupGLContext:function(t,e){this.dispose(),this.createWebGLCanvas(t,e),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(t,e)},chooseFastestCopyGLTo2DMethod:function(t,e){var i=void 0!==window.performance;try{new ImageData(1,1),o=!0}catch(t){o=!1}var n="undefined"!=typeof ArrayBuffer,r="undefined"!=typeof Uint8ClampedArray;if(i&&o&&n&&r){var o=Y.util.createCanvasElement(),n=new ArrayBuffer(t*e*4);if(Y.forceGLPutImageData)return this.imageBuffer=n,void(this.copyGLTo2D=J);r={imageBuffer:n,destinationWidth:t,destinationHeight:e,targetCanvas:o};o.width=t,o.height=e,o=window.performance.now(),K.call(r,this.gl,r),e=window.performance.now()-o,o=window.performance.now(),J.call(r,this.gl,r),e>window.performance.now()-o?(this.imageBuffer=n,this.copyGLTo2D=J):this.copyGLTo2D=K}},createWebGLCanvas:function(t,e){var i=Y.util.createCanvasElement();i.width=t,i.height=e;t={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},e=i.getContext("webgl",t);(e=e||i.getContext("experimental-webgl",t))&&(e.clearColor(0,0,0,0),this.canvas=i,this.gl=e)},applyFilters:function(t,e,i,n,r,o){var s=this.gl;o&&(a=this.getCachedTexture(o,e));var a,h={originalWidth:e.width||e.originalWidth,originalHeight:e.height||e.originalHeight,sourceWidth:i,sourceHeight:n,destinationWidth:i,destinationHeight:n,context:s,sourceTexture:this.createTexture(s,i,n,!a&&e),targetTexture:this.createTexture(s,i,n),originalTexture:a||this.createTexture(s,i,n,!a&&e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:r},i=s.createFramebuffer();return s.bindFramebuffer(s.FRAMEBUFFER,i),t.forEach(function(t){t&&t.applyTo(h)}),a=(n=h.targetCanvas).width,e=n.height,t=h.destinationHeight,a===(a=h.destinationWidth)&&e===t||(n.width=a,n.height=t),this.copyGLTo2D(s,h),s.bindTexture(s.TEXTURE_2D,null),s.deleteTexture(h.sourceTexture),s.deleteTexture(h.targetTexture),s.deleteFramebuffer(i),r.getContext("2d").setTransform(1,0,0,1,0,0),h},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(t,e,i,n){var r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),n?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,i,0,t.RGBA,t.UNSIGNED_BYTE,null),r},getCachedTexture:function(t,e){if(this.textureCache[t])return this.textureCache[t];e=this.createTexture(this.gl,e.width,e.height,e);return this.textureCache[t]=e},evictCachesForKey:function(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])},copyGLTo2D:K,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var t=this.gl,e={renderer:"",vendor:""};if(!t)return e;var i,n=t.getExtension("WEBGL_debug_renderer_info");return n&&(i=t.getParameter(n.UNMASKED_RENDERER_WEBGL),n=t.getParameter(n.UNMASKED_VENDOR_WEBGL),i&&(e.renderer=i.toLowerCase()),n&&(e.vendor=n.toLowerCase())),this.gpuInfo=e}}}(),function(){"use strict";function t(){}function e(){}(Y.Canvas2dFilterBackend=e).prototype={evictCachesForKey:t,dispose:t,clearWebGLCaches:t,resources:{},applyFilters:function(t,e,i,n,r){var o=r.getContext("2d");o.drawImage(e,0,0,i,n);var s={sourceWidth:i,sourceHeight:n,imageData:o.getImageData(0,0,i,n),originalEl:e,originalImageData:o.getImageData(0,0,i,n),canvasEl:r,ctx:o,filterBackend:this};return t.forEach(function(t){t.applyTo(s)}),s.imageData.width===i&&s.imageData.height===n||(r.width=s.imageData.width,r.height=s.imageData.height),o.putImageData(s.imageData,0,0),s}}}(),Y.Image=Y.Image||{},Y.Image.filters=Y.Image.filters||{},Y.Image.filters.BaseFilter=Y.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},createProgram:function(t,e,i){e=e||this.fragmentSource,i=i||this.vertexSource,"highp"!==Y.webGlPrecision&&(e=e.replace(/precision highp float/g,"precision "+Y.webGlPrecision+" float"));var n=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(n,i),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+t.getShaderInfoLog(n));i=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+t.getShaderInfoLog(i));e=t.createProgram();if(t.attachShader(e,n),t.attachShader(e,i),t.linkProgram(e),!t.getProgramParameter(e,t.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+t.getProgramInfoLog(e));n=this.getAttributeLocations(t,e),i=this.getUniformLocations(t,e)||{};return i.uStepW=t.getUniformLocation(e,"uStepW"),i.uStepH=t.getUniformLocation(e,"uStepH"),{program:e,attributeLocations:n,uniformLocations:i}},getAttributeLocations:function(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(t,e,i){var n=e.aPosition,e=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,e),t.enableVertexAttribArray(n),t.vertexAttribPointer(n,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW)},_setupFrameBuffer:function(t){var e,i,n=t.context;1<t.passes?(e=t.destinationWidth,i=t.destinationHeight,t.sourceWidth===e&&t.sourceHeight===i||(n.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(n,e,i)),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t.targetTexture,0)):(n.bindFramebuffer(n.FRAMEBUFFER,null),n.finish())},_swapTextures:function(t){t.passes--,t.pass++;var e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e},isNeutralState:function(){var t=this.mainParameter,e=Y.Image.filters[this.type].prototype;if(t){if(Array.isArray(e[t])){for(var i=e[t].length;i--;)if(this[t][i]!==e[t][i])return!1;return!0}return e[t]===this[t]}return!1},applyTo:function(t){t.webgl?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},retrieveShader:function(t){return t.programCache.hasOwnProperty(this.type)||(t.programCache[this.type]=this.createProgram(t.context)),t.programCache[this.type]},applyToWebGL:function(t){var e=t.context,i=this.retrieveShader(t);0===t.pass&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(i.program),this.sendAttributeData(e,i.attributeLocations,t.aPosition),e.uniform1f(i.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(i.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,i.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(t,e,i){t.activeTexture(i),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)},unbindAdditionalTexture:function(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(t){this[this.mainParameter]=t},sendUniformData:function(){},createHelpLayer:function(t){var e;t.helpLayer||((e=document.createElement("canvas")).width=t.sourceWidth,e.height=t.sourceHeight,t.helpLayer=e)},toObject:function(){var t={type:this.type},e=this.mainParameter;return e&&(t[e]=this[e]),t},toJSON:function(){return this.toObject()}}),Y.Image.filters.BaseFilter.fromObject=function(t,e){t=new Y.Image.filters[t.type](t);return e&&e(t),t},function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,t=e.util.createClass;i.ColorMatrix=t(i.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(t){this.callSuper("initialize",t),this.matrix=this.matrix.slice(0)},applyTo2d:function(t){for(var e,i,n,r,o=t.imageData.data,s=o.length,a=this.matrix,h=this.colorsOnly,c=0;c<s;c+=4)e=o[c],i=o[c+1],n=o[c+2],h?(o[c]=e*a[0]+i*a[1]+n*a[2]+255*a[4],o[c+1]=e*a[5]+i*a[6]+n*a[7]+255*a[9],o[c+2]=e*a[10]+i*a[11]+n*a[12]+255*a[14]):(r=o[c+3],o[c]=e*a[0]+i*a[1]+n*a[2]+r*a[3]+255*a[4],o[c+1]=e*a[5]+i*a[6]+n*a[7]+r*a[8]+255*a[9],o[c+2]=e*a[10]+i*a[11]+n*a[12]+r*a[13]+255*a[14],o[c+3]=e*a[15]+i*a[16]+n*a[17]+r*a[18]+255*a[19])},getUniformLocations:function(t,e){return{uColorMatrix:t.getUniformLocation(e,"uColorMatrix"),uConstants:t.getUniformLocation(e,"uConstants")}},sendUniformData:function(t,e){var i=this.matrix,n=[i[0],i[1],i[2],i[3],i[5],i[6],i[7],i[8],i[10],i[11],i[12],i[13],i[15],i[16],i[17],i[18]],i=[i[4],i[9],i[14],i[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,n),t.uniform4fv(e.uConstants,i)}}),e.Image.filters.ColorMatrix.fromObject=e.Image.filters.BaseFilter.fromObject}(i),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,t=e.util.createClass;i.Brightness=t(i.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(t){if(0!==this.brightness)for(var e=t.imageData.data,i=e.length,n=Math.round(255*this.brightness),r=0;r<i;r+=4)e[r]=e[r]+n,e[r+1]=e[r+1]+n,e[r+2]=e[r+2]+n},getUniformLocations:function(t,e){return{uBrightness:t.getUniformLocation(e,"uBrightness")}},sendUniformData:function(t,e){t.uniform1f(e.uBrightness,this.brightness)}}),e.Image.filters.Brightness.fromObject=e.Image.filters.BaseFilter.fromObject}(i),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.Image.filters,t=e.util.createClass;n.Convolute=t(n.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(t){var e=Math.sqrt(this.matrix.length),i=this.type+"_"+e+"_"+(this.opaque?1:0),e=this.fragmentSource[i];return t.programCache.hasOwnProperty(i)||(t.programCache[i]=this.createProgram(t.context,e)),t.programCache[i]},applyTo2d:function(t){for(var e,i,n,r,o,s,a,h,c,l,u,f=t.imageData,d=f.data,p=this.matrix,g=Math.round(Math.sqrt(p.length)),m=Math.floor(g/2),v=f.width,y=f.height,f=t.ctx.createImageData(v,y),b=f.data,w=this.opaque?1:0,x=0;x<y;x++)for(c=0;c<v;c++){for(o=4*(x*v+c),u=r=n=i=e=0;u<g;u++)for(l=0;l<g;l++)a=c+l-m,(s=x+u-m)<0||y<=s||a<0||v<=a||(h=p[u*g+l],e+=d[a=4*(s*v+a)]*h,i+=d[1+a]*h,n+=d[2+a]*h,w||(r+=d[3+a]*h));b[o]=e,b[1+o]=i,b[2+o]=n,b[3+o]=w?d[3+o]:r}t.imageData=f},getUniformLocations:function(t,e){return{uMatrix:t.getUniformLocation(e,"uMatrix"),uOpaque:t.getUniformLocation(e,"uOpaque"),uHalfSize:t.getUniformLocation(e,"uHalfSize"),uSize:t.getUniformLocation(e,"uSize")}},sendUniformData:function(t,e){t.uniform1fv(e.uMatrix,this.matrix)},toObject:function(){return i(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=e.Image.filters.BaseFilter.fromObject}(i),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,t=e.util.createClass;i.Grayscale=t(i.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(t){for(var e,i=t.imageData.data,n=i.length,r=this.mode,o=0;o<n;o+=4)"average"===r?e=(i[o]+i[o+1]+i[o+2])/3:"lightness"===r?e=(Math.min(i[o],i[o+1],i[o+2])+Math.max(i[o],i[o+1],i[o+2]))/2:"luminosity"===r&&(e=.21*i[o]+.72*i[o+1]+.07*i[o+2]),i[o]=e,i[o+1]=e,i[o+2]=e},retrieveShader:function(t){var e,i=this.type+"_"+this.mode;return t.programCache.hasOwnProperty(i)||(e=this.fragmentSource[this.mode],t.programCache[i]=this.createProgram(t.context,e)),t.programCache[i]},getUniformLocations:function(t,e){return{uMode:t.getUniformLocation(e,"uMode")}},sendUniformData:function(t,e){t.uniform1i(e.uMode,1)},isNeutralState:function(){return!1}}),e.Image.filters.Grayscale.fromObject=e.Image.filters.BaseFilter.fromObject}(i),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,t=e.util.createClass;i.Invert=t(i.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(t){for(var e=t.imageData.data,i=e.length,n=0;n<i;n+=4)e[n]=255-e[n],e[n+1]=255-e[n+1],e[n+2]=255-e[n+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(t,e){return{uInvert:t.getUniformLocation(e,"uInvert")}},sendUniformData:function(t,e){t.uniform1i(e.uInvert,this.invert)}}),e.Image.filters.Invert.fromObject=e.Image.filters.BaseFilter.fromObject}(i),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.Image.filters,t=e.util.createClass;n.Noise=t(n.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(t){if(0!==this.noise)for(var e,i=t.imageData.data,n=(i.length,this.noise),r=0,o=i.length;r<o;r+=4)e=(.5-Math.random())*n,i[r]+=e,i[r+1]+=e,i[r+2]+=e},getUniformLocations:function(t,e){return{uNoise:t.getUniformLocation(e,"uNoise"),uSeed:t.getUniformLocation(e,"uSeed")}},sendUniformData:function(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())},toObject:function(){return i(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=e.Image.filters.BaseFilter.fromObject}(i),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,t=e.util.createClass;i.Pixelate=t(i.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(t){for(var e,i,n,r,o,s,a,h,c,l,t=t.imageData,u=t.data,f=t.height,d=t.width,p=0;p<f;p+=this.blocksize)for(i=0;i<d;i+=this.blocksize)for(n=u[e=4*p*d+4*i],r=u[1+e],o=u[2+e],s=u[3+e],c=Math.min(p+this.blocksize,f),l=Math.min(i+this.blocksize,d),a=p;a<c;a++)for(h=i;h<l;h++)u[e=4*a*d+4*h]=n,u[1+e]=r,u[2+e]=o,u[3+e]=s},isNeutralState:function(){return 1===this.blocksize},getUniformLocations:function(t,e){return{uBlocksize:t.getUniformLocation(e,"uBlocksize"),uStepW:t.getUniformLocation(e,"uStepW"),uStepH:t.getUniformLocation(e,"uStepH")}},sendUniformData:function(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}),e.Image.filters.Pixelate.fromObject=e.Image.filters.BaseFilter.fromObject}(i),function(t){"use strict";var c=t.fabric||(t.fabric={}),e=c.util.object.extend,i=c.Image.filters,t=c.util.createClass;i.RemoveColor=t(i.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(t){for(var e,i,n,r=t.imageData.data,o=255*this.distance,t=new c.Color(this.color).getSource(),s=[t[0]-o,t[1]-o,t[2]-o],a=[t[0]+o,t[1]+o,t[2]+o],h=0;h<r.length;h+=4)e=r[h],i=r[h+1],n=r[h+2],s[0]<e&&s[1]<i&&s[2]<n&&e<a[0]&&i<a[1]&&n<a[2]&&(r[h+3]=0)},getUniformLocations:function(t,e){return{uLow:t.getUniformLocation(e,"uLow"),uHigh:t.getUniformLocation(e,"uHigh")}},sendUniformData:function(t,e){var i=new c.Color(this.color).getSource(),n=parseFloat(this.distance),r=[0+i[0]/255-n,0+i[1]/255-n,0+i[2]/255-n,1],n=[i[0]/255+n,i[1]/255+n,i[2]/255+n,1];t.uniform4fv(e.uLow,r),t.uniform4fv(e.uHigh,n)},toObject:function(){return e(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),c.Image.filters.RemoveColor.fromObject=c.Image.filters.BaseFilter.fromObject}(i),function(t){"use strict";var e,i=t.fabric||(t.fabric={}),n=i.Image.filters,r=i.util.createClass,o={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(e in o)n[e]=r(n.ColorMatrix,{type:e,matrix:o[e],mainParameter:!1,colorsOnly:!0}),i.Image.filters[e].fromObject=i.Image.filters.BaseFilter.fromObject}(i),function(){"use strict";var u=i.fabric,t=u.Image.filters,e=u.util.createClass;t.BlendColor=e(t.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",diff:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"if (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n",tint:"gl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n"},buildSource:function(t){return"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ngl_FragColor = color;\nif (color.a > 0.0) {\n"+this.fragmentSource[t]+"}\n}"},retrieveShader:function(t){var e,i=this.type+"_"+this.mode;return t.programCache.hasOwnProperty(i)||(e=this.buildSource(this.mode),t.programCache[i]=this.createProgram(t.context,e)),t.programCache[i]},applyTo2d:function(t){for(var e,i,n,r=t.imageData.data,o=r.length,s=1-this.alpha,a=(t=new u.Color(this.color).getSource())[0]*this.alpha,h=t[1]*this.alpha,c=t[2]*this.alpha,l=0;l<o;l+=4)switch(e=r[l],i=r[l+1],n=r[l+2],this.mode){case"multiply":r[l]=e*a/255,r[l+1]=i*h/255,r[l+2]=n*c/255;break;case"screen":r[l]=255-(255-e)*(255-a)/255,r[l+1]=255-(255-i)*(255-h)/255,r[l+2]=255-(255-n)*(255-c)/255;break;case"add":r[l]=e+a,r[l+1]=i+h,r[l+2]=n+c;break;case"diff":case"difference":r[l]=Math.abs(e-a),r[l+1]=Math.abs(i-h),r[l+2]=Math.abs(n-c);break;case"subtract":r[l]=e-a,r[l+1]=i-h,r[l+2]=n-c;break;case"darken":r[l]=Math.min(e,a),r[l+1]=Math.min(i,h),r[l+2]=Math.min(n,c);break;case"lighten":r[l]=Math.max(e,a),r[l+1]=Math.max(i,h),r[l+2]=Math.max(n,c);break;case"overlay":r[l]=a<128?2*e*a/255:255-2*(255-e)*(255-a)/255,r[l+1]=h<128?2*i*h/255:255-2*(255-i)*(255-h)/255,r[l+2]=c<128?2*n*c/255:255-2*(255-n)*(255-c)/255;break;case"exclusion":r[l]=a+e-2*a*e/255,r[l+1]=h+i-2*h*i/255,r[l+2]=c+n-2*c*n/255;break;case"tint":r[l]=a+e*s,r[l+1]=h+i*s,r[l+2]=c+n*s}},getUniformLocations:function(t,e){return{uColor:t.getUniformLocation(e,"uColor")}},sendUniformData:function(t,e){var i=new u.Color(this.color).getSource();i[0]=this.alpha*i[0]/255,i[1]=this.alpha*i[1]/255,i[2]=this.alpha*i[2]/255,i[3]=this.alpha,t.uniform4fv(e.uColor,i)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),u.Image.filters.BlendColor.fromObject=u.Image.filters.BaseFilter.fromObject}(),function(){"use strict";var v=i.fabric,t=v.Image.filters,e=v.util.createClass;t.BlendImage=e(t.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nuniform mat3 uTransformMatrix;\nvoid main() {\nvTexCoord = aPosition;\nvTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.rgba *= color2.rgba;\ngl_FragColor = color;\n}",mask:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.a = color2.a;\ngl_FragColor = color;\n}"},retrieveShader:function(t){var e=this.type+"_"+this.mode,i=this.fragmentSource[this.mode];return t.programCache.hasOwnProperty(e)||(t.programCache[e]=this.createProgram(t.context,i)),t.programCache[e]},applyToWebGL:function(t){var e=t.context,i=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,i,e.TEXTURE1),this.callSuper("applyToWebGL",t),this.unbindAdditionalTexture(e,e.TEXTURE1)},createTexture:function(t,e){return t.getCachedTexture(e.cacheKey,e._element)},calculateMatrix:function(){var t=this.image,e=t._element.width,i=t._element.height;return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/i,1]},applyTo2d:function(t){var e,i,n,r,o,s,a,h,c=t.imageData,l=t.filterBackend.resources,u=c.data,f=u.length,d=c.width,p=c.height,t=this.image;l.blendImage||(l.blendImage=v.util.createCanvasElement()),l=(c=l.blendImage).getContext("2d"),c.width!==d||c.height!==p?(c.width=d,c.height=p):l.clearRect(0,0,d,p),l.setTransform(t.scaleX,0,0,t.scaleY,t.left,t.top),l.drawImage(t._element,0,0,d,p);for(var g=l.getImageData(0,0,d,p).data,m=0;m<f;m+=4)switch(o=u[m],s=u[m+1],a=u[m+2],h=u[m+3],e=g[m],i=g[m+1],n=g[m+2],r=g[m+3],this.mode){case"multiply":u[m]=o*e/255,u[m+1]=s*i/255,u[m+2]=a*n/255,u[m+3]=h*r/255;break;case"mask":u[m+3]=r}},getUniformLocations:function(t,e){return{uTransformMatrix:t.getUniformLocation(e,"uTransformMatrix"),uImage:t.getUniformLocation(e,"uImage")}},sendUniformData:function(t,e){var i=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,i)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),v.Image.filters.BlendImage.fromObject=function(i,n){v.Image.fromObject(i.image,function(t){var e=v.util.object.clone(i);e.image=t,n(new v.Image.filters.BlendImage(e))})}}(),function(t){"use strict";var m=t.fabric||(t.fabric={}),O=Math.pow,N=Math.floor,j=Math.sqrt,F=Math.abs,s=Math.round,n=Math.sin,E=Math.ceil,e=m.Image.filters,t=m.util.createClass;e.Resize=t(e.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(t,e){return{uDelta:t.getUniformLocation(e,"uDelta"),uTaps:t.getUniformLocation(e,"uTaps")}},sendUniformData:function(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)},retrieveShader:function(t){var e=this.getFilterWindow(),i=this.type+"_"+e;return t.programCache.hasOwnProperty(i)||(e=this.generateShader(e),t.programCache[i]=this.createProgram(t.context,e)),t.programCache[i]},getFilterWindow:function(){var t=this.tempScale;return Math.ceil(this.lanczosLobes/t)},getTaps:function(){for(var t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,i=this.getFilterWindow(),n=new Array(i),r=1;r<=i;r++)n[r-1]=t(r*e);return n},generateShader:function(t){for(var e=new Array(t),i=this.fragmentSourceTOP,n=1;n<=t;n++)e[n-1]=n+".0 * uDelta";return i+="uniform float uTaps["+t+"];\n",i+="void main() {\n",i+="  vec4 color = texture2D(uTexture, vTexCoord);\n",i+="  float sum = 1.0;\n",e.forEach(function(t,e){i+="  color += texture2D(uTexture, vTexCoord + "+t+") * uTaps["+e+"];\n",i+="  color += texture2D(uTexture, vTexCoord - "+t+") * uTaps["+e+"];\n",i+="  sum += 2.0 * uTaps["+e+"];\n"}),i+="  gl_FragColor = color / sum;\n",i+="}"},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(t){t.webgl?(t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceHeight=t.destinationHeight):this.applyTo2d(t)},isNeutralState:function(){return 1===this.scaleX&&1===this.scaleY},lanczosCreate:function(i){return function(t){if(i<=t||t<=-i)return 0;if(t<1.1920929e-7&&-1.1920929e-7<t)return 1;var e=(t*=Math.PI)/i;return n(t)/t*n(e)/e}},applyTo2d:function(t){var e=t.imageData,i=this.scaleX,n=this.scaleY;this.rcpScaleX=1/i,this.rcpScaleY=1/n;var r,o=e.width,e=e.height,i=s(o*i),n=s(e*n);"sliceHack"===this.resizeType?r=this.sliceByTwo(t,o,e,i,n):"hermite"===this.resizeType?r=this.hermiteFastResize(t,o,e,i,n):"bilinear"===this.resizeType?r=this.bilinearFiltering(t,o,e,i,n):"lanczos"===this.resizeType&&(r=this.lanczosResize(t,o,e,i,n)),t.imageData=r},sliceByTwo:function(t,e,i,n,r){var o,s,a=t.imageData,h=!1,c=!1,l=.5*e,u=.5*i,t=m.filterBackend.resources,f=0,d=0,p=e,g=0;for(t.sliceByTwo||(t.sliceByTwo=document.createElement("canvas")),((o=t.sliceByTwo).width<1.5*e||o.height<i)&&(o.width=1.5*e,o.height=i),(s=o.getContext("2d")).clearRect(0,0,1.5*e,i),s.putImageData(a,0,0),n=N(n),r=N(r);!h||!c;)i=u,n<N(.5*(e=l))?l=N(.5*l):(l=n,h=!0),r<N(.5*u)?u=N(.5*u):(u=r,c=!0),s.drawImage(o,f,d,e,i,p,g,l,u),f=p,d=g,g+=u;return s.getImageData(f,d,n,r)},lanczosResize:function(t,d,p,g,m){var v=t.imageData.data,y=t.ctx.createImageData(g,m),b=y.data,w=this.lanczosCreate(this.lanczosLobes),x=this.rcpScaleX,_=this.rcpScaleY,S=2/this.rcpScaleX,C=2/this.rcpScaleY,A=E(x*this.lanczosLobes/2),L=E(_*this.lanczosLobes/2),T={},P={},k={};return function t(e){var i,n,r,o,s,a,h,c,l,u;for(P.x=(e+.5)*x,k.x=N(P.x),i=0;i<m;i++){for(P.y=(i+.5)*_,k.y=N(P.y),c=h=a=s=o=0,n=k.x-A;n<=k.x+A;n++)if(!(n<0||d<=n)){l=N(1e3*F(n-P.x)),T[l]||(T[l]={});for(var f=k.y-L;f<=k.y+L;f++)f<0||p<=f||(u=N(1e3*F(f-P.y)),T[l][u]||(T[l][u]=w(j(O(l*S,2)+O(u*C,2))/1e3)),0<(u=T[l][u])&&(o+=u,s+=u*v[r=4*(f*d+n)],a+=u*v[r+1],h+=u*v[r+2],c+=u*v[r+3]))}b[r=4*(i*g+e)]=s/o,b[r+1]=a/o,b[r+2]=h/o,b[r+3]=c/o}return++e<g?t(e):y}(0)},bilinearFiltering:function(t,e,i,n,r){for(var o,s,a,h,c,l,u,f,d=0,p=this.rcpScaleX,g=this.rcpScaleY,m=4*(e-1),v=t.imageData.data,t=t.ctx.createImageData(n,r),y=t.data,b=0;b<r;b++)for(a=0;a<n;a++)for(h=p*a-(o=N(p*a)),c=g*b-(s=N(g*b)),f=4*(s*e+o),l=0;l<4;l++)u=v[f+l]*(1-h)*(1-c)+v[4+f+l]*h*(1-c)+v[f+m+l]*c*(1-h)+v[f+m+4+l]*h*c,y[d++]=u;return t},hermiteFastResize:function(t,e,i,n,r){for(var o=this.rcpScaleX,s=this.rcpScaleY,a=E(o/2),h=E(s/2),c=t.imageData.data,t=t.ctx.createImageData(n,r),l=t.data,u=0;u<r;u++)for(var f=0;f<n;f++){for(var d=4*(f+u*n),p=0,g=0,m=0,v=0,y=0,b=0,w=0,x=(u+.5)*s,_=N(u*s);_<(u+1)*s;_++)for(var S=F(x-(_+.5))/h,C=(f+.5)*o,A=S*S,L=N(f*o);L<(f+1)*o;L++){var T=F(C-(L+.5))/a,P=j(A+T*T);1<P&&P<-1||0<(p=2*P*P*P-3*P*P+1)&&(w+=p*c[3+(T=4*(L+_*e))],m+=p,v+=(p=c[3+T]<255?p*c[3+T]/250:p)*c[T],y+=p*c[1+T],b+=p*c[2+T],g+=p)}l[d]=v/g,l[1+d]=y/g,l[2+d]=b/g,l[3+d]=w/m}return t},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),m.Image.filters.Resize.fromObject=m.Image.filters.BaseFilter.fromObject}(i),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,t=e.util.createClass;i.Contrast=t(i.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(t){if(0!==this.contrast)for(var e=t.imageData.data,i=e.length,t=Math.floor(255*this.contrast),n=259*(t+255)/(255*(259-t)),r=0;r<i;r+=4)e[r]=n*(e[r]-128)+128,e[r+1]=n*(e[r+1]-128)+128,e[r+2]=n*(e[r+2]-128)+128},getUniformLocations:function(t,e){return{uContrast:t.getUniformLocation(e,"uContrast")}},sendUniformData:function(t,e){t.uniform1f(e.uContrast,this.contrast)}}),e.Image.filters.Contrast.fromObject=e.Image.filters.BaseFilter.fromObject}(i),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,t=e.util.createClass;i.Saturation=t(i.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(t){if(0!==this.saturation)for(var e,i=t.imageData.data,n=i.length,r=-this.saturation,o=0;o<n;o+=4)e=Math.max(i[o],i[o+1],i[o+2]),i[o]+=e!==i[o]?(e-i[o])*r:0,i[o+1]+=e!==i[o+1]?(e-i[o+1])*r:0,i[o+2]+=e!==i[o+2]?(e-i[o+2])*r:0},getUniformLocations:function(t,e){return{uSaturation:t.getUniformLocation(e,"uSaturation")}},sendUniformData:function(t,e){t.uniform1f(e.uSaturation,-this.saturation)}}),e.Image.filters.Saturation.fromObject=e.Image.filters.BaseFilter.fromObject}(i),function(t){"use strict";var d=t.fabric||(t.fabric={}),e=d.Image.filters,t=d.util.createClass;e.Blur=t(e.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(t){t.webgl?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},applyTo2d:function(t){t.imageData=this.simpleBlur(t)},simpleBlur:function(t){var e,i,n=t.filterBackend.resources,r=t.imageData.width,o=t.imageData.height;n.blurLayer1||(n.blurLayer1=d.util.createCanvasElement(),n.blurLayer2=d.util.createCanvasElement()),e=n.blurLayer1,i=n.blurLayer2,e.width===r&&e.height===o||(i.width=e.width=r,i.height=e.height=o);var s,a,h,c,l=e.getContext("2d"),u=i.getContext("2d"),f=.06*this.blur*.5;for(l.putImageData(t.imageData,0,0),u.clearRect(0,0,r,o),c=-15;c<=15;c++)h=f*(a=c/15)*r+(s=(Math.random()-.5)/4),u.globalAlpha=1-Math.abs(a),u.drawImage(e,h,s),l.drawImage(i,0,0),u.globalAlpha=1,u.clearRect(0,0,i.width,i.height);for(c=-15;c<=15;c++)h=f*(a=c/15)*o+(s=(Math.random()-.5)/4),u.globalAlpha=1-Math.abs(a),u.drawImage(e,s,h),l.drawImage(i,0,0),u.globalAlpha=1,u.clearRect(0,0,i.width,i.height);t.ctx.drawImage(e,0,0);t=t.ctx.getImageData(0,0,e.width,e.height);return l.globalAlpha=1,l.clearRect(0,0,e.width,e.height),t},getUniformLocations:function(t,e){return{delta:t.getUniformLocation(e,"uDelta")}},sendUniformData:function(t,e){var i=this.chooseRightDelta();t.uniform2fv(e.delta,i)},chooseRightDelta:function(){var t=1,e=[0,0];return this.horizontal?1<this.aspectRatio&&(t=1/this.aspectRatio):this.aspectRatio<1&&(t=this.aspectRatio),t=t*this.blur*.12,this.horizontal?e[0]=t:e[1]=t,e}}),e.Blur.fromObject=d.Image.filters.BaseFilter.fromObject}(i),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,t=e.util.createClass;i.Gamma=t(i.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",initialize:function(t){this.gamma=[1,1,1],i.BaseFilter.prototype.initialize.call(this,t)},applyTo2d:function(t){var e,i=t.imageData.data,t=this.gamma,n=i.length,r=1/t[0],o=1/t[1],s=1/t[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),e=0,n=256;e<n;e++)this.rVals[e]=255*Math.pow(e/255,r),this.gVals[e]=255*Math.pow(e/255,o),this.bVals[e]=255*Math.pow(e/255,s);for(e=0,n=i.length;e<n;e+=4)i[e]=this.rVals[i[e]],i[e+1]=this.gVals[i[e+1]],i[e+2]=this.bVals[i[e+2]]},getUniformLocations:function(t,e){return{uGamma:t.getUniformLocation(e,"uGamma")}},sendUniformData:function(t,e){t.uniform3fv(e.uGamma,this.gamma)}}),e.Image.filters.Gamma.fromObject=e.Image.filters.BaseFilter.fromObject}(i),function(t){"use strict";var i=t.fabric||(t.fabric={}),e=i.Image.filters,t=i.util.createClass;e.Composed=t(e.BaseFilter,{type:"Composed",subFilters:[],initialize:function(t){this.callSuper("initialize",t),this.subFilters=this.subFilters.slice(0)},applyTo:function(e){e.passes+=this.subFilters.length-1,this.subFilters.forEach(function(t){t.applyTo(e)})},toObject:function(){return i.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(t){return t.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(t){return!t.isNeutralState()})}}),i.Image.filters.Composed.fromObject=function(t,e){t=(t.subFilters||[]).map(function(t){return new i.Image.filters[t.type](t)}),t=new i.Image.filters.Composed({subFilters:t});return e&&e(t),t}}(i),function(t){"use strict";var n=t.fabric||(t.fabric={}),e=n.Image.filters,t=n.util.createClass;e.HueRotation=t(e.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var t=this.rotation*Math.PI,e=n.util.cos(t),i=n.util.sin(t),t=Math.sqrt(1/3)*i,i=1-e;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=e+i/3,this.matrix[1]=1/3*i-t,this.matrix[2]=1/3*i+t,this.matrix[5]=1/3*i+t,this.matrix[6]=e+1/3*i,this.matrix[7]=1/3*i-t,this.matrix[10]=1/3*i-t,this.matrix[11]=1/3*i+t,this.matrix[12]=e+1/3*i},isNeutralState:function(t){return this.calculateMatrix(),e.BaseFilter.prototype.isNeutralState.call(this,t)},applyTo:function(t){this.calculateMatrix(),e.BaseFilter.prototype.applyTo.call(this,t)}}),n.Image.filters.HueRotation.fromObject=n.Image.filters.BaseFilter.fromObject}(i),function(t){"use strict";var f=t.fabric||(t.fabric={}),s=f.util.object.clone;f.Text?f.warn("fabric.Text is already defined"):(t="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles path".split(" "),f.Text=f.util.createClass(f.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:f.Object.prototype.stateProperties.concat(t),cacheProperties:f.Object.prototype.cacheProperties.concat(t),stroke:null,shadow:null,_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(t,e){this.styles=e&&e.styles||{},this.text=t,this.__skipDimension=!0,this.callSuper("initialize",e),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var t=this.path;t&&(t.segmentsInfo=f.util.getPathSegmentsInfo(t.path))},getMeasuringContext:function(){return f._measuringContext||(f._measuringContext=this.canvas&&this.canvas.contextCache||f.util.createCanvasElement().getContext("2d")),f._measuringContext},_splitText:function(){var t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var t,e,i,n,r,o=0,s=this._textLines.length;o<s;o++)if(("justify"===this.textAlign||o!==s-1&&!this.isEndOfWrapping(o))&&(e=0,i=this._textLines[o],(t=this.getLineWidth(o))<this.width&&(r=this.textLines[o].match(this._reSpacesAndTabs))))for(var a=r.length,h=(this.width-t)/a,c=0,l=i.length;c<=l;c++)n=this.__charBounds[o][c],this._reSpaceAndTab.test(i[c])?(n.width+=h,n.kernedWidth+=h,n.left+=e,e+=h):n.left+=e},isEndOfWrapping:function(t){return t===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var t=this.callSuper("_getCacheCanvasDimensions"),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t},_render:function(t){this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")},_renderText:function(t){"stroke"===this.paintFirst?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))},_setTextStyles:function(t,e,i){t.textBaseline="alphabetic",t.font=this._getFontDeclaration(e,i)},calcTextWidth:function(){for(var t=this.getLineWidth(0),e=1,i=this._textLines.length;e<i;e++){var n=this.getLineWidth(e);t<n&&(t=n)}return t},_renderTextLine:function(t,e,i,n,r,o){this._renderChars(t,e,i,n,r,o)},_renderTextLinesBackground:function(t){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var e,i,n,r=t.fillStyle,o=this._getLeftOffset(),s=this._getTopOffset(),a=0,h=0,c=this.path,l=0,u=this._textLines.length;l<u;l++)if(e=this.getHeightOfLine(l),this.textBackgroundColor||this.styleHas("textBackgroundColor",l)){for(var f=this._textLines[l],d=this._getLineLeftOffset(l),h=0,a=0,p=this.getValueOfPropertyAt(l,0,"textBackgroundColor"),g=0,m=f.length;g<m;g++)i=this.__charBounds[l][g],n=this.getValueOfPropertyAt(l,g,"textBackgroundColor"),c?(t.save(),t.translate(i.renderLeft,i.renderTop),t.rotate(i.angle),(t.fillStyle=n)&&t.fillRect(-i.width/2,-e/this.lineHeight*(1-this._fontSizeFraction),i.width,e/this.lineHeight),t.restore()):n!==p?((t.fillStyle=p)&&t.fillRect(o+d+a,s,h,e/this.lineHeight),a=i.left,h=i.width,p=n):h+=i.kernedWidth;n&&!c&&(t.fillStyle=n,t.fillRect(o+d+a,s,h,e/this.lineHeight)),s+=e}else s+=e;t.fillStyle=r,this._removeShadow(t)}},getFontCache:function(t){var e=t.fontFamily.toLowerCase();f.charWidthsCache[e]||(f.charWidthsCache[e]={});e=f.charWidthsCache[e],t=t.fontStyle.toLowerCase()+"_"+(t.fontWeight+"").toLowerCase();return e[t]||(e[t]={}),e[t]},_measureChar:function(t,e,i,n){var r,o,s,a,h,c=this.getFontCache(e),l=i+t,u=this._getFontDeclaration(e)===this._getFontDeclaration(n),n=e.fontSize/this.CACHE_FONT_SIZE;return i&&void 0!==c[i]&&(s=c[i]),void 0!==c[t]&&(a=r=c[t]),u&&void 0!==c[l]&&(a=(o=c[l])-s),void 0!==r&&void 0!==s&&void 0!==o||(h=this.getMeasuringContext(),this._setTextStyles(h,e,!0)),void 0===r&&(a=r=h.measureText(t).width,c[t]=r),void 0===s&&u&&i&&(s=h.measureText(i).width,c[i]=s),u&&void 0===o&&(o=h.measureText(l).width,a=(c[l]=o)-s),{width:r*n,kernedWidth:a*n}},getHeightOfChar:function(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")},measureLine:function(t){t=this._measureLine(t);return 0!==this.charSpacing&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t},_measureLine:function(t){var e,i,n,r,o,s,a=0,h=this._textLines[t],c=new Array(h.length),l=0,u=this.path;for(this.__charBounds[t]=c,u&&(o=f.util.getPointOnPath(u.path,0,u.segmentsInfo),s=u.segmentsInfo[u.segmentsInfo.length-1].length,o.x+=u.pathOffset.x,o.y+=u.pathOffset.y),e=0;e<h.length;e++)i=h[e],r=this._getGraphemeBox(i,t,e,n),u&&(s<l&&(l%=s),this._setGraphemeOnPath(l,r,o)),a+=(c[e]=r).kernedWidth,l+=r.kernedWidth,n=i;return c[e]={left:r?r.left+r.width:0,width:0,kernedWidth:0,height:this.fontSize},{width:a,numOfSpaces:0}},_setGraphemeOnPath:function(t,e,i){var n=t+e.kernedWidth/2,t=this.path,t=f.util.getPointOnPath(t.path,n,t.segmentsInfo);e.renderLeft=t.x-i.x,e.renderTop=t.y-i.y,e.angle=t.angle},_getGraphemeBox:function(t,e,i,n,r){var o=this.getCompleteStyleDeclaration(e,i),s=n?this.getCompleteStyleDeclaration(e,i-1):{},a=this._measureChar(t,o,n,s),t=a.kernedWidth,n=a.width;0!==this.charSpacing&&(n+=s=this._getWidthOfCharSpacing(),t+=s);o={width:n,left:0,height:o.fontSize,kernedWidth:t,deltaY:o.deltaY};return 0<i&&!r&&(i=this.__charBounds[e][i-1],o.left=i.left+i.width+a.kernedWidth-a.width),o},getHeightOfLine:function(t){if(this.__lineHeights[t])return this.__lineHeights[t];for(var e=this._textLines[t],i=this.getHeightOfChar(t,0),n=1,r=e.length;n<r;n++)i=Math.max(this.getHeightOfChar(t,n),i);return this.__lineHeights[t]=i*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var t,e=0,i=0,n=this._textLines.length;i<n;i++)t=this.getHeightOfLine(i),e+=i===n-1?t/this.lineHeight:t;return e},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(t,e){t.save();for(var i=0,n=this._getLeftOffset(),r=this._getTopOffset(),o=0,s=this._textLines.length;o<s;o++){var a=this.getHeightOfLine(o),h=a/this.lineHeight,c=this._getLineLeftOffset(o);this._renderTextLine(e,t,this._textLines[o],n+c,r+i+h,o),i+=a}t.restore()},_renderTextFill:function(t){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(t,"fillText")},_renderTextStroke:function(t){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())},_renderChars:function(t,e,i,n,r,o){var s,a,h,c,l=this.getHeightOfLine(o),u=-1!==this.textAlign.indexOf("justify"),f="",d=0,p=this.path,g=!u&&0===this.charSpacing&&this.isEmptyStyles(o)&&!p;if(e.save(),r-=l*this._fontSizeFraction/this.lineHeight,g)return this._renderChar(t,e,o,0,i.join(""),n,r,l),void e.restore();for(var m=0,v=i.length-1;m<=v;m++)c=m===v||this.charSpacing||p,f+=i[m],h=this.__charBounds[o][m],0===d?(n+=h.kernedWidth-h.width,d+=h.width):d+=h.kernedWidth,(c=u&&!c&&this._reSpaceAndTab.test(i[m])?!0:c)||(s=s||this.getCompleteStyleDeclaration(o,m),a=this.getCompleteStyleDeclaration(o,m+1),c=this._hasStyleChanged(s,a)),c&&(p?(e.save(),e.translate(h.renderLeft,h.renderTop),e.rotate(h.angle),this._renderChar(t,e,o,m,f,-d/2,0,l),e.restore()):this._renderChar(t,e,o,m,f,n,r,l),f="",s=a,n+=d,d=0);e.restore()},_applyPatternGradientTransformText:function(t){var e,i=f.util.createCanvasElement(),n=this.width+this.strokeWidth,r=this.height+this.strokeWidth;return i.width=n,i.height=r,(e=i.getContext("2d")).beginPath(),e.moveTo(0,0),e.lineTo(n,0),e.lineTo(n,r),e.lineTo(0,r),e.closePath(),e.translate(n/2,r/2),e.fillStyle=t.toLive(e),this._applyPatternGradientTransform(e,t),e.fill(),e.createPattern(i,"no-repeat")},handleFiller:function(t,e,i){var n,r;return i.toLive?"percentage"===i.gradientUnits||i.gradientTrasnform||i.patternTransform?(n=-this.width/2,r=-this.height/2,t.translate(n,r),t[e]=this._applyPatternGradientTransformText(i),{offsetX:n,offsetY:r}):(t[e]=i.toLive(t,this),this._applyPatternGradientTransform(t,i)):(t[e]=i,{offsetX:0,offsetY:0})},_setStrokeStyles:function(t,e){return t.lineWidth=e.strokeWidth,t.lineCap=this.strokeLineCap,t.lineDashOffset=this.strokeDashOffset,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,this.handleFiller(t,"strokeStyle",e.stroke)},_setFillStyles:function(t,e){return this.handleFiller(t,"fillStyle",e.fill)},_renderChar:function(t,e,i,n,r,o,s){var a,h,c=this._getStyleDeclaration(i,n),i=this.getCompleteStyleDeclaration(i,n),n="fillText"===t&&i.fill,t="strokeText"===t&&i.stroke&&i.strokeWidth;(t||n)&&(e.save(),n&&(a=this._setFillStyles(e,i)),t&&(h=this._setStrokeStyles(e,i)),e.font=this._getFontDeclaration(i),c&&c.textBackgroundColor&&this._removeShadow(e),c&&c.deltaY&&(s+=c.deltaY),n&&e.fillText(r,o-a.offsetX,s-a.offsetY),t&&e.strokeText(r,o-h.offsetX,s-h.offsetY),e.restore())},setSuperscript:function(t,e){return this._setScript(t,e,this.superscript)},setSubscript:function(t,e){return this._setScript(t,e,this.subscript)},_setScript:function(t,e,i){var n=this.get2DCursorLocation(t,!0),r=this.getValueOfPropertyAt(n.lineIndex,n.charIndex,"fontSize"),n=this.getValueOfPropertyAt(n.lineIndex,n.charIndex,"deltaY"),i={fontSize:r*i.size,deltaY:n+r*i.baseline};return this.setSelectionStyles(i,t,e),this},_hasStyleChanged:function(t,e){return t.fill!==e.fill||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth||t.fontSize!==e.fontSize||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.deltaY!==e.deltaY},_hasStyleChangedForSvg:function(t,e){return this._hasStyleChanged(t,e)||t.overline!==e.overline||t.underline!==e.underline||t.linethrough!==e.linethrough},_getLineLeftOffset:function(t){var e=this.getLineWidth(t);return"center"===this.textAlign?(this.width-e)/2:"right"===this.textAlign?this.width-e:"justify-center"===this.textAlign&&this.isEndOfWrapping(t)?(this.width-e)/2:"justify-right"===this.textAlign&&this.isEndOfWrapping(t)?this.width-e:0},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var t=this._forceClearCache;return(t=t||this.hasStateChanged("_dimensionAffectingProps"))&&(this.dirty=!0,this._forceClearCache=!1),t},getLineWidth:function(t){return this.__lineWidths[t]||(e=""===this._textLines[t]?0:this.measureLine(t).width,this.__lineWidths[t]=e);var e},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(t,e,i){e=this._getStyleDeclaration(t,e);return(e&&void 0!==e[i]?e:this)[i]},_renderTextDecoration:function(t,e){if(this[e]||this.styleHas(e)){for(var i,n,r,o,s,a,h=this._getLeftOffset(),c=this._getTopOffset(),l=this.path,u=this._getWidthOfCharSpacing(),f=0,d=this._textLines.length;f<d;f++)if(i=this.getHeightOfLine(f),this[e]||this.styleHas(e,f)){for(var p=this._textLines[f],g=i/this.lineHeight,m=this._getLineLeftOffset(f),v=0,y=0,b=this.getValueOfPropertyAt(f,0,e),w=this.getValueOfPropertyAt(f,0,"fill"),x=c+g*(1-this._fontSizeFraction),_=this.getHeightOfChar(f,0),S=this.getValueOfPropertyAt(f,0,"deltaY"),C=0,A=p.length;C<A;C++)o=this.__charBounds[f][C],s=this.getValueOfPropertyAt(f,C,e),a=this.getValueOfPropertyAt(f,C,"fill"),n=this.getHeightOfChar(f,C),r=this.getValueOfPropertyAt(f,C,"deltaY"),l&&s&&a?(t.save(),t.fillStyle=w,t.translate(o.renderLeft,o.renderTop),t.rotate(o.angle),t.fillRect(-o.kernedWidth/2,this.offsets[e]*n+r,o.kernedWidth,this.fontSize/15),t.restore()):(s!==b||a!==w||n!==_||r!==S)&&0<y?(b&&w&&t.fillRect(h+m+v,x+this.offsets[e]*_+S,y,this.fontSize/15),v=o.left,y=o.width,b=s,w=a,_=n,S=r):y+=o.kernedWidth;t.fillStyle=a,s&&a&&t.fillRect(h+m+v,x+this.offsets[e]*_+S,y-u,this.fontSize/15),c+=i}else c+=i;this._removeShadow(t)}},_getFontDeclaration:function(t,e){var i=t||this,n=this.fontFamily,t=-1<f.Text.genericFonts.indexOf(n.toLowerCase()),t=void 0===n||-1<n.indexOf("'")||-1<n.indexOf(",")||-1<n.indexOf('"')||t?i.fontFamily:'"'+i.fontFamily+'"';return[f.isLikelyNode?i.fontWeight:i.fontStyle,f.isLikelyNode?i.fontStyle:i.fontWeight,e?this.CACHE_FONT_SIZE+"px":i.fontSize+"px",t].join(" ")},render:function(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",t)))},_splitTextIntoLines:function(t){for(var e=t.split(this._reNewline),i=new Array(e.length),n=["\n"],r=[],o=0;o<e.length;o++)i[o]=f.util.string.graphemeSplit(e[o]),r=r.concat(i[o],n);return r.pop(),{_unwrappedLines:i,lines:e,graphemeText:r,graphemeLines:i}},toObject:function(t){t=["text","fontSize","fontWeight","fontFamily","fontStyle","lineHeight","underline","overline","linethrough","textAlign","textBackgroundColor","charSpacing"].concat(t),t=this.callSuper("toObject",t);return t.styles=s(this.styles,!0),t},set:function(t,e){this.callSuper("set",t,e);var i=!1,n=!1;if("object"==typeof t)for(var r in t)"path"===r&&this.setPathInfo(),i=i||-1!==this._dimensionAffectingProps.indexOf(r),n=n||"path"===r;else i=-1!==this._dimensionAffectingProps.indexOf(t),n="path"===t;return n&&this.setPathInfo(),i&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),f.Text.ATTRIBUTE_NAMES=f.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),f.Text.DEFAULT_SVG_FONT_SIZE=16,f.Text.fromElement=function(t,e,i){if(!t)return e(null);var n=f.parseAttributes(t,f.Text.ATTRIBUTE_NAMES),r=n.textAnchor||"left";(i=f.util.object.extend(i?s(i):{},n)).top=i.top||0,i.left=i.left||0,n.textDecoration&&(-1!==(o=n.textDecoration).indexOf("underline")&&(i.underline=!0),-1!==o.indexOf("overline")&&(i.overline=!0),-1!==o.indexOf("line-through")&&(i.linethrough=!0),delete i.textDecoration),"dx"in n&&(i.left+=n.dx),"dy"in n&&(i.top+=n.dy),"fontSize"in i||(i.fontSize=f.Text.DEFAULT_SVG_FONT_SIZE);var o="";"textContent"in t?o=t.textContent:"firstChild"in t&&null!==t.firstChild&&"data"in t.firstChild&&null!==t.firstChild.data&&(o=t.firstChild.data);o=o.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),n=i.strokeWidth;i.strokeWidth=0;t=new f.Text(o,i),o=t.getScaledHeight()/t.height,i=((t.height+t.strokeWidth)*t.lineHeight-t.height)*o,o=t.getScaledHeight()+i,i=0;"center"===r&&(i=t.getScaledWidth()/2),"right"===r&&(i=t.getScaledWidth()),t.set({left:t.left-i,top:t.top-(o-t.fontSize*(.07+t._fontSizeFraction))/t.lineHeight,strokeWidth:void 0!==n?n:1}),e(t)},f.Text.fromObject=function(t,e){return f.Object._fromObject("Text",t,e,"text")},f.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],f.util.createAccessors&&f.util.createAccessors(f.Text))}(i),Y.util.object.extend(Y.Text.prototype,{isEmptyStyles:function(t){if(!this.styles)return!0;if(void 0!==t&&!this.styles[t])return!0;var e,i=void 0===t?this.styles:{line:this.styles[t]};for(e in i)for(var n in i[e])for(var r in i[e][n])return!1;return!0},styleHas:function(t,e){if(!this.styles||!t||""===t)return!1;if(void 0!==e&&!this.styles[e])return!1;var i,n=void 0===e?this.styles:{0:this.styles[e]};for(i in n)for(var r in n[i])if(void 0!==n[i][r][t])return!0;return!1},cleanStyle:function(t){if(!this.styles||!t||""===t)return!1;var e,i,n,r,o=this.styles,s=0,a=!0,h=0;for(n in o){for(var c in e=0,o[n])s++,(r=o[n][c]).hasOwnProperty(t)?(i?r[t]!==i&&(a=!1):i=r[t],r[t]===this[t]&&delete r[t]):a=!1,0!==Object.keys(r).length?e++:delete o[n][c];0===e&&delete o[n]}for(var l=0;l<this._textLines.length;l++)h+=this._textLines[l].length;a&&s===h&&(this[t]=i,this.removeStyle(t))},removeStyle:function(t){if(this.styles&&t&&""!==t){var e,i,n,r=this.styles;for(i in r){for(n in e=r[i])delete e[n][t],0===Object.keys(e[n]).length&&delete e[n];0===Object.keys(e).length&&delete r[i]}}},_extendStyles:function(t,e){t=this.get2DCursorLocation(t);this._getLineStyle(t.lineIndex)||this._setLineStyle(t.lineIndex),this._getStyleDeclaration(t.lineIndex,t.charIndex)||this._setStyleDeclaration(t.lineIndex,t.charIndex,{}),Y.util.object.extend(this._getStyleDeclaration(t.lineIndex,t.charIndex),e)},get2DCursorLocation:function(t,e){void 0===t&&(t=this.selectionStart);for(var i=e?this._unwrappedTextLines:this._textLines,n=i.length,r=0;r<n;r++){if(t<=i[r].length)return{lineIndex:r,charIndex:t};t-=i[r].length+this.missingNewlineOffset(r)}return{lineIndex:r-1,charIndex:i[r-1].length<t?i[r-1].length:t}},getSelectionStyles:function(t,e,i){void 0===t&&(t=this.selectionStart||0),void 0===e&&(e=this.selectionEnd||t);for(var n=[],r=t;r<e;r++)n.push(this.getStyleAtPosition(r,i));return n},getStyleAtPosition:function(t,e){t=this.get2DCursorLocation(t);return(e?this.getCompleteStyleDeclaration(t.lineIndex,t.charIndex):this._getStyleDeclaration(t.lineIndex,t.charIndex))||{}},setSelectionStyles:function(t,e,i){void 0===e&&(e=this.selectionStart||0),void 0===i&&(i=this.selectionEnd||e);for(var n=e;n<i;n++)this._extendStyles(n,t);return this._forceClearCache=!0,this},_getStyleDeclaration:function(t,e){t=this.styles&&this.styles[t];return t?t[e]:null},getCompleteStyleDeclaration:function(t,e){for(var i,n=this._getStyleDeclaration(t,e)||{},r={},o=0;o<this._styleProperties.length;o++)r[i=this._styleProperties[o]]=(void 0===n[i]?this:n)[i];return r},_setStyleDeclaration:function(t,e,i){this.styles[t][e]=i},_deleteStyleDeclaration:function(t,e){delete this.styles[t][e]},_getLineStyle:function(t){return!!this.styles[t]},_setLineStyle:function(t){this.styles[t]={}},_deleteLineStyle:function(t){delete this.styles[t]}}),Y.IText=Y.util.createClass(Y.Text,Y.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(t,e){this.callSuper("initialize",t,e),this.initBehavior()},setSelectionStart:function(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)},_updateAndFire:function(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(t){this.clearContextTop(),this.callSuper("render",t),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(t){this.callSuper("_render",t)},clearContextTop:function(t){var e,i;this.isEditing&&this.canvas&&this.canvas.contextTop&&(e=this.canvas.contextTop,i=this.canvas.viewportTransform,e.save(),e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this.transform(e),this._clearTextArea(e),t||e.restore())},renderCursorOrSelection:function(){var t,e;this.isEditing&&this.canvas&&this.canvas.contextTop&&(t=this._getCursorBoundaries(),e=this.canvas.contextTop,this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(t,e):this.renderSelection(t,e),e.restore())},_clearTextArea:function(t){var e=this.width+4,i=this.height+4;t.clearRect(-e/2,-i/2,e,i)},_getCursorBoundaries:function(t){void 0===t&&(t=this.selectionStart);var e=this._getLeftOffset(),i=this._getTopOffset(),t=this._getCursorBoundariesOffsets(t);return{left:e,top:i,leftOffset:t.left,topOffset:t.top}},_getCursorBoundariesOffsets:function(t){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;for(var e=0,i=0,n=this.get2DCursorLocation(t),r=n.charIndex,o=n.lineIndex,s=0;s<o;s++)e+=this.getHeightOfLine(s);t=this._getLineLeftOffset(o),n=this.__charBounds[o][r];return n&&(i=n.left),0!==this.charSpacing&&r===this._textLines[o].length&&(i-=this._getWidthOfCharSpacing()),this.cursorOffsetCache={top:e,left:t+(0<i?i:0)},this.cursorOffsetCache},renderCursor:function(t,e){var i=this.get2DCursorLocation(),n=i.lineIndex,r=0<i.charIndex?i.charIndex-1:0,o=this.getValueOfPropertyAt(n,r,"fontSize"),s=this.scaleX*this.canvas.getZoom(),a=this.cursorWidth/s,i=t.topOffset,s=this.getValueOfPropertyAt(n,r,"deltaY");i+=(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-o*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(t,e),e.fillStyle=this.cursorColor||this.getValueOfPropertyAt(n,r,"fill"),e.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,e.fillRect(t.left+t.leftOffset-a/2,i+t.top+s,a,o)},renderSelection:function(t,e){for(var i=(this.inCompositionMode?this.hiddenTextarea:this).selectionStart,n=(this.inCompositionMode?this.hiddenTextarea:this).selectionEnd,r=-1!==this.textAlign.indexOf("justify"),i=this.get2DCursorLocation(i),n=this.get2DCursorLocation(n),o=i.lineIndex,s=n.lineIndex,a=i.charIndex<0?0:i.charIndex,h=n.charIndex<0?0:n.charIndex,c=o;c<=s;c++){var l,u=this._getLineLeftOffset(c)||0,f=this.getHeightOfLine(c),d=0,p=0;c===o&&(d=this.__charBounds[o][a].left),o<=c&&c<s?p=r&&!this.isEndOfWrapping(c)?this.width:this.getLineWidth(c)||5:c===s&&(p=0===h?this.__charBounds[s][h].left:(l=this._getWidthOfCharSpacing(),this.__charBounds[s][h-1].left+this.__charBounds[s][h-1].width-l)),l=f,(this.lineHeight<1||c===s&&1<this.lineHeight)&&(f/=this.lineHeight),this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",e.fillRect(t.left+u+d,t.top+t.topOffset+f,p-d,1)):(e.fillStyle=this.selectionColor,e.fillRect(t.left+u+d,t.top+t.topOffset,p-d,f)),t.topOffset+=l}},getCurrentCharFontSize:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")},getCurrentCharColor:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fill")},_getCurrentCharIndex:function(){var t=this.get2DCursorLocation(this.selectionStart,!0),e=0<t.charIndex?t.charIndex-1:0;return{l:t.lineIndex,c:e}}}),Y.IText.fromObject=function(t,e){if($(t),t.styles)for(var i in t.styles)for(var n in t.styles[i])$(t.styles[i][n]);Y.Object._fromObject("IText",t,e,"text")},y=Y.util.object.clone,Y.util.object.extend(Y.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var e=this;this.on("added",function(){var t=e.canvas;t&&(t._hasITextHandlers||(t._hasITextHandlers=!0,e._initCanvasHandlers(t)),t._iTextInstances=t._iTextInstances||[],t._iTextInstances.push(e))})},initRemovedHandler:function(){var e=this;this.on("removed",function(){var t=e.canvas;t&&(t._iTextInstances=t._iTextInstances||[],Y.util.removeFromArray(t._iTextInstances,e),0===t._iTextInstances.length&&(t._hasITextHandlers=!1,e._removeCanvasHandlers(t)))})},_initCanvasHandlers:function(t){t._mouseUpITextHandler=function(){t._iTextInstances&&t._iTextInstances.forEach(function(t){t.__isMousedown=!1})},t.on("mouse:up",t._mouseUpITextHandler)},_removeCanvasHandlers:function(t){t.off("mouse:up",t._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,e,i,n){var r={isAborted:!1,abort:function(){this.isAborted=!0}};return t.animate("_currentCursorOpacity",e,{duration:i,onComplete:function(){r.isAborted||t[n]()},onChange:function(){t.canvas&&t.selectionStart===t.selectionEnd&&t.renderCursorOrSelection()},abort:function(){return r.isAborted}}),r},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(t){var e=this,t=t?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){e._tick()},t)},abortCursorAnimation:function(){var t=this._currentTickState||this._currentTickCompleteState,e=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,t&&e&&e.clearContext(e.contextTop||e.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(t){var e=0,i=t-1;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i--;for(;/\S/.test(this._text[i])&&-1<i;)e++,i--;return t-e},findWordBoundaryRight:function(t){var e=0,i=t;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i++;for(;/\S/.test(this._text[i])&&i<this._text.length;)e++,i++;return t+e},findLineBoundaryLeft:function(t){for(var e=0,i=t-1;!/\n/.test(this._text[i])&&-1<i;)e++,i--;return t-e},findLineBoundaryRight:function(t){for(var e=0,i=t;!/\n/.test(this._text[i])&&i<this._text.length;)e++,i++;return t+e},searchWordBoundary:function(t,e){for(var i=this._text,n=this._reSpace.test(i[t])?t-1:t,r=i[n],o=Y.reNonWord;!o.test(r)&&0<n&&n<i.length;)r=i[n+=e];return o.test(r)&&(n+=1===e?0:1),n},selectWord:function(t){t=t||this.selectionStart;var e=this.searchWordBoundary(t,-1),t=this.searchWordBoundary(t,1);this.selectionStart=e,this.selectionEnd=t,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(t){t=t||this.selectionStart;var e=this.findLineBoundaryLeft(t),t=this.findLineBoundaryRight(t);return this.selectionStart=e,this.selectionEnd=t,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(t){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(t),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll()),this},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach(function(t){t.selected=!1,t.isEditing&&t.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(t){var e,i;this.__isMousedown&&this.isEditing&&(e=this.getSelectionStartFromPointer(t.e),i=this.selectionStart,t=this.selectionEnd,(e===this.__selectionStartOnMouseDown&&i!==t||i!==e&&t!==e)&&(e>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=e):(this.selectionStart=e,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===i&&this.selectionEnd===t||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection())))},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(t,e,i){var n=i.slice(0,t),n=Y.util.string.graphemeSplit(n).length;if(t===e)return{selectionStart:n,selectionEnd:n};e=i.slice(t,e);return{selectionStart:n,selectionEnd:n+Y.util.string.graphemeSplit(e).length}},fromGraphemeToStringSelection:function(t,e,i){var n=i.slice(0,t).join("").length;return t===e?{selectionStart:n,selectionEnd:n}:{selectionStart:n,selectionEnd:n+i.slice(t,e).join("").length}},_updateTextarea:function(){var t;this.cursorOffsetCache={},this.hiddenTextarea&&(this.inCompositionMode||(t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text),this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd),this.updateTextareaPosition())},updateFromTextArea:function(){var t;this.hiddenTextarea&&(this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),t=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition())},updateTextareaPosition:function(){var t;this.selectionStart===this.selectionEnd&&(t=this._calcTextareaPosition(),this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top)},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),i=this.get2DCursorLocation(t),n=i.lineIndex,r=i.charIndex,o=this.getValueOfPropertyAt(n,r,"fontSize")*this.lineHeight,s=e.leftOffset,a=this.calcTransformMatrix(),t={x:e.left+s,y:e.top+e.topOffset+o},i=this.canvas.getRetinaScaling(),n=this.canvas.upperCanvasEl,r=n.width/i,s=n.height/i,e=r-o,i=s-o,r=n.clientWidth/r,s=n.clientHeight/s,t=Y.util.transformPoint(t,a);return(t=Y.util.transformPoint(t,this.canvas.viewportTransform)).x*=r,t.y*=s,t.x<0&&(t.x=0),t.x>e&&(t.x=e),t.y<0&&(t.y=0),t.y>i&&(t.y=i),t.x+=this.canvas._offset.left,t.y+=this.canvas._offset.top,{left:t.x+"px",top:t.y+"px",fontSize:o+"px",charHeight:o}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var t=this._textBeforeEdit!==this.text,e=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),t&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},removeStyleFromTo:function(t,e){var t=this.get2DCursorLocation(t,!0),e=this.get2DCursorLocation(e,!0),i=t.lineIndex,n=t.charIndex,r=e.lineIndex,o=e.charIndex;if(i!==r){if(this.styles[i])for(l=n;l<this._unwrappedTextLines[i].length;l++)delete this.styles[i][l];if(this.styles[r])for(l=o;l<this._unwrappedTextLines[r].length;l++)(h=this.styles[r][l])&&(this.styles[i]||(this.styles[i]={}),this.styles[i][n+l-o]=h);for(l=i+1;l<=r;l++)delete this.styles[l];this.shiftLineStyles(r,i-r)}else if(this.styles[i]){for(var s,a,h=this.styles[i],c=o-n,l=n;l<o;l++)delete h[l];for(a in this.styles[i])(s=parseInt(a,10))>=o&&(h[s-c]=h[a],delete h[a])}},shiftLineStyles:function(t,e){var i,n=y(this.styles);for(i in this.styles){var r=parseInt(i,10);t<r&&(this.styles[r+e]=n[r],n[r-e]||delete this.styles[r])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(t,e,i,n){var r,o,s={},a=!1,h=this._unwrappedTextLines[t].length===e;for(o in this.shiftLineStyles(t,i=i||1),this.styles[t]&&(r=this.styles[t][0===e?e:e-1]),this.styles[t]){var c=parseInt(o,10);e<=c&&(a=!0,s[c-e]=this.styles[t][o],h&&0===e||delete this.styles[t][o])}var l=!1;for(a&&!h&&(this.styles[t+i]=s,l=!0),l&&i--;0<i;)n&&n[i-1]?this.styles[t+i]={0:y(n[i-1])}:r?this.styles[t+i]={0:y(r)}:delete this.styles[t+i],i--;this._forceClearCache=!0},insertCharStyleObject:function(t,e,i,n){this.styles||(this.styles={});var r,o=this.styles[t],s=o?y(o):{};for(r in i=i||1,s){var a=parseInt(r,10);e<=a&&(o[a+i]=s[a],s[a-i]||delete o[a])}if(this._forceClearCache=!0,n)for(;i--;)Object.keys(n[i]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][e+i]=y(n[i]));else if(o)for(var h=o[e?e-1:1];h&&i--;)this.styles[t][e+i]=y(h)},insertNewStyleBlock:function(t,e,i){for(var n=this.get2DCursorLocation(e,!0),r=[0],o=0,s=0;s<t.length;s++)"\n"===t[s]?r[++o]=0:r[o]++;for(0<r[0]&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,r[0],i),i=i&&i.slice(r[0]+1)),o&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+r[0],o),s=1;s<o;s++)0<r[s]?this.insertCharStyleObject(n.lineIndex+s,0,r[s],i):i&&(this.styles[n.lineIndex+s][0]=i[0]),i=i&&i.slice(r[s]+1);0<r[s]&&this.insertCharStyleObject(n.lineIndex+s,0,r[s],i)},setSelectionStartEndWithShift:function(t,e,i){i<=t?(e===t?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=t),this.selectionStart=i):t<i&&i<e?"right"===this._selectionDirection?this.selectionEnd=i:this.selectionStart=i:(e===t?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=e),this.selectionEnd=i)},setSelectionInBoundaries:function(){var t=this.text.length;this.selectionStart>t?this.selectionStart=t:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>t?this.selectionEnd=t:this.selectionEnd<0&&(this.selectionEnd=0)}}),Y.util.object.extend(Y.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(t){var e;this.canvas&&(this.__newClickTime=+new Date,e=t.pointer,this.isTripleClick(e)&&(this.fire("tripleclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected)},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(t){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(t.e))},tripleClickHandler:function(t){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(t.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(t){if(this.__isMousedown=!1,!(!this.editable||this.group||t.transform&&t.transform.actionPerformed||t.e.button&&1!==t.e.button)){if(this.canvas){var e=this.canvas._activeObject;if(e&&e!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t),i=this.selectionStart,n=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(i,n,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(t){for(var e=this.getLocalPointer(t),i=0,n=0,r=0,o=0,s=0,a=0,h=this._textLines.length;a<h&&r<=e.y;a++)r+=this.getHeightOfLine(a)*this.scaleY,0<(s=a)&&(o+=this._textLines[a-1].length+this.missingNewlineOffset(a-1));for(var n=this._getLineLeftOffset(s)*this.scaleX,c=0,l=this._textLines[s].length;c<l&&(i=n,(n+=this.__charBounds[s][c].kernedWidth*this.scaleX)<=e.x);c++)o++;return this._getNewSelectionStartFromOffset(e,i,n,o,l)},_getNewSelectionStartFromOffset:function(t,e,i,n,r){e=t.x-e,t=i-t.x,t=n+(e<t||t<0?0:1);return t=(t=this.flipX?r-t:t)>this._text.length?this._text.length:t}}),Y.util.object.extend(Y.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=Y.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var t=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+t.top+"; left: "+t.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; paddingｰtop: "+t.fontSize+";",Y.document.body.appendChild(this.hiddenTextarea),Y.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),Y.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),Y.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),Y.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),Y.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),Y.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),Y.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),Y.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),Y.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(Y.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing){if(t.keyCode in this.keysMap)this[this.keysMap[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown)||!t.ctrlKey&&!t.metaKey)return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),33<=t.keyCode&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(t){var e=this.fromPaste;if(this.fromPaste=!1,t&&t.stopPropagation(),this.isEditing){var i,n,r,o=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,s=this._text.length,a=o.length,h=a-s,c=this.selectionStart,l=this.selectionEnd,u=c!==l;if(""===this.hiddenTextarea.value)return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var f=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),t=c>f.selectionStart;u?(r=this._text.slice(c,l),h+=l-c):a<s&&(r=t?this._text.slice(l+h,l):this._text.slice(c,c-h)),f=o.slice(f.selectionEnd-h,f.selectionEnd),r&&r.length&&(f.length&&(i=this.getSelectionStyles(c,c+1,!1),i=f.map(function(){return i[0]})),r=u?(n=c,l):t?(n=l-r.length,l):(n=l)+r.length,this.removeStyleFromTo(n,r)),f.length&&(e&&f.join("")===Y.copiedText&&!Y.disableStyleCopyPaste&&(i=Y.copiedTextStyle),this.insertNewStyleBlock(f,c,i)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(t){this.compositionStart=t.target.selectionStart,this.compositionEnd=t.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(Y.copiedText=this.getSelectedText(),Y.disableStyleCopyPaste?Y.copiedTextStyle=null:Y.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(t){return t&&t.clipboardData||Y.window.clipboardData},_getWidthBeforeCursor:function(t,e){var i=this._getLineLeftOffset(t);return 0<e&&(i+=(e=this.__charBounds[t][e-1]).left+e.width),i},getDownCursorOffset:function(t,e){var i=this._getSelectionForOffset(t,e),n=this.get2DCursorLocation(i),e=n.lineIndex;if(e===this._textLines.length-1||t.metaKey||34===t.keyCode)return this._text.length-i;i=n.charIndex,n=this._getWidthBeforeCursor(e,i),n=this._getIndexOnLine(e+1,n);return this._textLines[e].slice(i).length+n+1+this.missingNewlineOffset(e)},_getSelectionForOffset:function(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(t,e){var i=this._getSelectionForOffset(t,e),n=this.get2DCursorLocation(i),e=n.lineIndex;if(0===e||t.metaKey||33===t.keyCode)return-i;t=n.charIndex,i=this._getWidthBeforeCursor(e,t),n=this._getIndexOnLine(e-1,i),i=this._textLines[e].slice(0,t),t=this.missingNewlineOffset(e-1);return-this._textLines[e-1].length+n-i.length+(1-t)},_getIndexOnLine:function(t,e){for(var i=this._textLines[t],n=this._getLineLeftOffset(t),r=0,o=0,s=i.length;o<s;o++)if((n+=c=this.__charBounds[t][o].width)>e){var a=!0,h=n,c=Math.abs(n-c-e),r=Math.abs(h-e)<c?o:o-1;break}return r=!a?i.length-1:r},moveCursorDown:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)},moveCursorUp:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",t)},_moveCursorUpOrDown:function(t,e){t=this["get"+t+"CursorOffset"](e,"right"===this._selectionDirection);e.shiftKey?this.moveCursorWithShift(t):this.moveCursorWithoutShift(t),0!==t&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(t){var e="left"===this._selectionDirection?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),0!==t},moveCursorWithoutShift:function(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),0!==t},moveCursorLeft:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",t)},_move:function(t,e,i){var n;if(t.altKey)n=this["findWordBoundary"+i](this[e]);else{if(!t.metaKey&&35!==t.keyCode&&36!==t.keyCode)return this[e]+="Left"===i?-1:1,!0;n=this["findLineBoundary"+i](this[e])}if(this[e]!==n)return this[e]=n,!0},_moveLeft:function(t,e){return this._move(t,e,"Left")},_moveRight:function(t,e){return this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(t){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(t,"selectionStart")):void 0},moveCursorRight:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)},_moveCursorLeftOrRight:function(t,e){t="moveCursor"+t+"With";this._currentCursorOpacity=1,e.shiftKey?t+="Shift":t+="outShift",this[t](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(t){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(t,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(t){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(t,e){this.removeStyleFromTo(t,e=void 0===e?t+1:e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(t,e,i,n){i<(n=void 0===n?i:n)&&this.removeStyleFromTo(i,n);t=Y.util.string.graphemeSplit(t);this.insertNewStyleBlock(t,i,e),this._text=[].concat(this._text.slice(0,i),t,this._text.slice(n)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),b=Y.util.toFixed,w=/  +/g,Y.util.object.extend(Y.Text.prototype,{_toSVG:function(){var t=this._getSVGLeftTopOffsets(),t=this._getSVGTextAndBg(t.textTop,t.textLeft);return this._wrapSVGTextAndBg(t)},toSVG:function(t){return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(t){var e=this.getSvgTextDecoration(this);return[t.textBgRects.join(""),'\t\t<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",e?'text-decoration="'+e+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.textSpans.join(""),"</text>\n"]},_getSVGTextAndBg:function(t,e){var i,n=[],r=[],o=t;this._setSVGBg(r);for(var s=0,a=this._textLines.length;s<a;s++)i=this._getLineLeftOffset(s),(this.textBackgroundColor||this.styleHas("textBackgroundColor",s))&&this._setSVGTextLineBg(r,s,e+i,o),this._setSVGTextLineText(n,s,e+i,o),o+=this.getHeightOfLine(s);return{textSpans:n,textBgRects:r}},_createTextCharSpan:function(t,e,i,n){var r=t!==t.trim()||t.match(w),o=this.getSvgSpanStyles(e,r),s=o?'style="'+o+'"':"",r=e.deltaY,o="",e=Y.Object.NUM_FRACTION_DIGITS;return r&&(o=' dy="'+b(r,e)+'" '),['<tspan x="',b(i,e),'" y="',b(n,e),'" ',o,s,">",Y.util.string.escapeXml(t),"</tspan>"].join("")},_setSVGTextLineText:function(t,e,i,n){var r,o,s,a,h=this.getHeightOfLine(e),c=-1!==this.textAlign.indexOf("justify"),l="",u=0,f=this._textLines[e];n+=h*(1-this._fontSizeFraction)/this.lineHeight;for(var d=0,p=f.length-1;d<=p;d++)a=d===p||this.charSpacing,l+=f[d],s=this.__charBounds[e][d],0===u?(i+=s.kernedWidth-s.width,u+=s.width):u+=s.kernedWidth,(a=c&&!a&&this._reSpaceAndTab.test(f[d])?!0:a)||(r=r||this.getCompleteStyleDeclaration(e,d),o=this.getCompleteStyleDeclaration(e,d+1),a=this._hasStyleChangedForSvg(r,o)),a&&(a=this._getStyleDeclaration(e,d)||{},t.push(this._createTextCharSpan(l,a,i,n)),l="",r=o,i+=u,u=0)},_pushTextBgRect:function(t,e,i,n,r,o){var s=Y.Object.NUM_FRACTION_DIGITS;t.push("\t\t<rect ",this._getFillAttributes(e),' x="',b(i,s),'" y="',b(n,s),'" width="',b(r,s),'" height="',b(o,s),'"></rect>\n')},_setSVGTextLineBg:function(t,e,i,n){for(var r,o,s=this._textLines[e],a=this.getHeightOfLine(e)/this.lineHeight,h=0,c=0,l=this.getValueOfPropertyAt(e,0,"textBackgroundColor"),u=0,f=s.length;u<f;u++)r=this.__charBounds[e][u],(o=this.getValueOfPropertyAt(e,u,"textBackgroundColor"))!==l?(l&&this._pushTextBgRect(t,l,i+c,n,h,a),c=r.left,h=r.width,l=o):h+=r.kernedWidth;o&&this._pushTextBgRect(t,o,i+c,n,h,a)},_getFillAttributes:function(t){var e=t&&"string"==typeof t?new Y.Color(t):"";return e&&e.getSource()&&1!==e.getAlpha()?'opacity="'+e.getAlpha()+'" fill="'+e.setAlpha(1).toRgb()+'"':'fill="'+t+'"'},_getSVGLineTopOffset:function(t){for(var e,i=0,n=0;n<t;n++)i+=this.getHeightOfLine(n);return e=this.getHeightOfLine(n),{lineTop:i,offset:(this._fontSizeMult-this._fontSizeFraction)*e/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(t){return Y.Object.prototype.getSvgStyles.call(this,t)+" white-space: pre;"}}),function(t){"use strict";var y=t.fabric||(t.fabric={});y.Textbox=y.util.createClass(y.IText,y.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:y.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(t){for(var e=0,i=0,n=0,r={},o=0;o<t.graphemeLines.length;o++)"\n"===t.graphemeText[n]&&0<o?(i=0,n++,e++):!this.splitByGrapheme&&this._reSpaceAndTab.test(t.graphemeText[n])&&0<o&&(i++,n++),r[o]={line:e,offset:i},n+=t.graphemeLines[o].length,i+=t.graphemeLines[o].length;return r},styleHas:function(t,e){var i;return!this._styleMap||this.isWrapping||(i=this._styleMap[e])&&(e=i.line),y.Text.prototype.styleHas.call(this,t,e)},isEmptyStyles:function(t){if(!this.styles)return!0;var e,i,n,r=0,o=!1,s=this._styleMap[t],a=this._styleMap[t+1];for(n in s&&(t=s.line,r=s.offset),a&&(o=a.line===t,e=a.offset),i=void 0===t?this.styles:{line:this.styles[t]})for(var h in i[n])if(r<=h&&(!o||h<e))for(var c in i[n][h])return!1;return!0},_getStyleDeclaration:function(t,e){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[t];if(!i)return null;t=i.line,e=i.offset+e}return this.callSuper("_getStyleDeclaration",t,e)},_setStyleDeclaration:function(t,e,i){var n=this._styleMap[t];t=n.line,e=n.offset+e,this.styles[t][e]=i},_deleteStyleDeclaration:function(t,e){var i=this._styleMap[t];t=i.line,e=i.offset+e,delete this.styles[t][e]},_getLineStyle:function(t){t=this._styleMap[t];return!!this.styles[t.line]},_setLineStyle:function(t){t=this._styleMap[t];this.styles[t.line]={}},_wrapText:function(t,e){var i,n=[];for(this.isWrapping=!0,i=0;i<t.length;i++)n=n.concat(this._wrapLine(t[i],i,e));return this.isWrapping=!1,n},_measureWord:function(t,e,i){var n,r=0;i=i||0;for(var o=0,s=t.length;o<s;o++)r+=this._getGraphemeBox(t[o],e,o+i,n,!0).kernedWidth,n=t[o];return r},_wrapLine:function(t,e,i,n){var r,o,s=0,a=this.splitByGrapheme,h=[],c=[],l=a?y.util.string.graphemeSplit(t):t.split(this._wordJoiners),u=0,f=a?"":" ",d=0,p=0,g=!0,m=this._getWidthOfCharSpacing();n=n||0,0===l.length&&l.push([]),i-=n;for(var v=0;v<l.length;v++)r=a?l[v]:y.util.string.graphemeSplit(l[v]),o=this._measureWord(r,e,u),u+=r.length,(s+=d+o-m)>i&&!g?(h.push(c),c=[],s=o,g=!0):s+=m,g||a||c.push(f),c=c.concat(r),d=a?0:this._measureWord([f],e,u),u++,g=!1,p<o&&(p=o);return v&&h.push(c),p+n>this.dynamicMinWidth&&(this.dynamicMinWidth=p-m+n),h},isEndOfWrapping:function(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line},missingNewlineOffset:function(t){return!this.splitByGrapheme||this.isEndOfWrapping(t)?1:0},_splitTextIntoLines:function(t){for(var t=y.Text.prototype._splitTextIntoLines.call(this,t),e=this._wrapText(t.lines,this.width),i=new Array(e.length),n=0;n<e.length;n++)i[n]=e[n].join("");return t.lines=i,t.graphemeLines=e,t},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var t,e={};for(t in this._styleMap)this._textLines[t]&&(e[this._styleMap[t].line]=1);for(t in this.styles)e[t]||delete this.styles[t]},toObject:function(t){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(t))}}),y.Textbox.fromObject=function(t,e){return y.Object._fromObject("Textbox",t,e,"text")}}(i),x=Y.controlsUtils,_=x.scaleSkewCursorStyleHandler,e=x.scaleCursorStyleHandler,S=x.scalingEqually,C=x.scalingYOrSkewingX,A=x.scalingXOrSkewingY,L=x.scaleOrSkewActionName,(T=Y.Object.prototype.controls).ml=new Y.Control({x:-.5,y:0,cursorStyleHandler:_,actionHandler:A,getActionName:L}),T.mr=new Y.Control({x:.5,y:0,cursorStyleHandler:_,actionHandler:A,getActionName:L}),T.mb=new Y.Control({x:0,y:.5,cursorStyleHandler:_,actionHandler:C,getActionName:L}),T.mt=new Y.Control({x:0,y:-.5,cursorStyleHandler:_,actionHandler:C,getActionName:L}),T.tl=new Y.Control({x:-.5,y:-.5,cursorStyleHandler:e,actionHandler:S}),T.tr=new Y.Control({x:.5,y:-.5,cursorStyleHandler:e,actionHandler:S}),T.bl=new Y.Control({x:-.5,y:.5,cursorStyleHandler:e,actionHandler:S}),T.br=new Y.Control({x:.5,y:.5,cursorStyleHandler:e,actionHandler:S}),T.mtr=new Y.Control({x:0,y:-.5,actionHandler:x.rotationWithSnapping,cursorStyleHandler:x.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),Y.Textbox&&((S=Y.Textbox.prototype.controls={}).mtr=T.mtr,S.tr=T.tr,S.br=T.br,S.tl=T.tl,S.bl=T.bl,S.mt=T.mt,S.mb=T.mb,S.mr=new Y.Control({x:.5,y:0,actionHandler:x.changeWidth,cursorStyleHandler:_,actionName:"resizing"}),S.ml=new Y.Control({x:-.5,y:0,actionHandler:x.changeWidth,cursorStyleHandler:_,actionName:"resizing"}))},3162:function(t,e,i){var n;void 0===(n="function"==typeof(n=function(){"use strict";function h(t,e,i){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){r(n.response,e,i)},n.onerror=function(){console.error("could not download file")},n.send()}function s(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&e.status<=299}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(t){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(i)}}var c="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof i.g&&i.g.global===i.g?i.g:void 0,l=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),r=c.saveAs||("object"!=typeof window||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(t,e,i){var n=c.URL||c.webkitURL,r=document.createElement("a");e=e||t.name||"download",r.download=e,r.rel="noopener","string"==typeof t?(r.href=t,r.origin===location.origin?a(r):s(r.href)?h(t,e,i):a(r,r.target="_blank")):(r.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(r.href)},4e4),setTimeout(function(){a(r)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,i){var n,r,o;e=e||t.name||"download","string"!=typeof t?navigator.msSaveOrOpenBlob((r=t,void 0===(o=i)?o={autoBom:!1}:"object"!=typeof o&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\ufeff",r],{type:r.type}):r),e):s(t)?h(t,e,i):((n=document.createElement("a")).href=t,n.target="_blank",setTimeout(function(){a(n)}))}:function(t,e,i,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof t)return h(t,e,i);var r,o,s,e="application/octet-stream"===t.type,i=/constructor/i.test(c.HTMLElement)||c.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);(a||e&&i||l)&&"undefined"!=typeof FileReader?((r=new FileReader).onloadend=function(){var t=r.result,t=a?t:t.replace(/^data:[^;]*;/,"data:attachment/file;");n?n.location.href=t:location=t,n=null},r.readAsDataURL(t)):(o=c.URL||c.webkitURL,s=o.createObjectURL(t),n?n.location=s:location.href=s,n=null,setTimeout(function(){o.revokeObjectURL(s)},4e4))});c.saveAs=r.saveAs=r,t.exports=r})?n.apply(e,[]):n)||(t.exports=n)},4245:()=>{function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}var i,n;i=[function(t,e,i){t.exports=i(1)},function(t,e){var i,i=(i=[{key:"show",value:function(t){this.setOptions(t),this.addSpinnerStylesheet(),this.generateSpinnerElement(),this.options.lockScroll&&(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"),this.generateAndAddOverlayElement()}},{key:"hide",value:function(){this.options.lockScroll&&(document.body.style.overflow="",document.documentElement.style.overflow="");var t=document.getElementById("loading-overlay-stylesheet");t&&(t.disabled=!0,t.parentNode.removeChild(t),document.getElementById(this.options.overlayIDName).remove(),document.getElementById(this.options.spinnerIDName).remove())}},{key:"setOptions",value:function(t){if(void 0!==t)for(var e in t)this.options[e]=t[e]}},{key:"generateAndAddOverlayElement",value:function(){var t="50%";0!==this.options.offsetX&&(t="calc(50% + "+this.options.offsetX+")");var e="50%";if(0!==this.options.offsetY&&(e="calc(50% + "+this.options.offsetY+")"),this.options.containerID&&document.body.contains(document.getElementById(this.options.containerID))){var i='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: absolute; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,'; z-index: 50; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: absolute; top: ').concat(e,"; left: ").concat(t,'; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: 9999;">').concat(this.spinner,"</div>"),n=document.getElementById(this.options.containerID);return n.style.position="relative",void n.insertAdjacentHTML("beforeend",i)}t='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: fixed; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,"; z-index: ").concat(this.options.overlayZIndex,'; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: fixed; top: ').concat(e,"; left: ").concat(t,"; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: ").concat(this.options.spinnerZIndex,';">').concat(this.spinner,"</div>");document.body.insertAdjacentHTML("beforeend",t)}},{key:"generateSpinnerElement",value:function(){var e=this,t=Object.keys(this.numberOfEmptyDivForSpinner).find(function(t){return t===e.options.spinnerIcon}),t=this.generateEmptyDivElement(this.numberOfEmptyDivForSpinner[t]);this.spinner='<div style="color: '.concat(this.options.spinnerColor,'" class="la-').concat(this.options.spinnerIcon," la-").concat(this.options.spinnerSize,'">').concat(t,"</div>")}},{key:"addSpinnerStylesheet",value:function(){this.setSpinnerStylesheetURL();var t=document.createElement("link");t.setAttribute("id","loading-overlay-stylesheet"),t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",this.spinnerStylesheetURL),document.getElementsByTagName("head")[0].appendChild(t)}},{key:"setSpinnerStylesheetURL",value:function(){this.spinnerStylesheetURL=this.stylesheetBaseURL+this.options.spinnerIcon+".min.css"}},{key:"generateEmptyDivElement",value:function(t){for(var e="",i=1;i<=t;i++)e+="<div></div>";return e}}],function(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(n.prototype,i),n);function n(){!function(t){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this),this.options={overlayBackgroundColor:"#666666",overlayOpacity:.6,spinnerIcon:"ball-circus",spinnerColor:"#000",spinnerSize:"3x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetY:0,offsetX:0,lockScroll:!1,containerID:null,spinnerZIndex:99999,overlayZIndex:99998},this.stylesheetBaseURL="https://cdn.jsdelivr.net/npm/load-awesome@1.1.0/css/",this.spinner=null,this.spinnerStylesheetURL=null,this.numberOfEmptyDivForSpinner={"ball-8bits":16,"ball-atom":4,"ball-beat":3,"ball-circus":5,"ball-climbing-dot":1,"ball-clip-rotate":1,"ball-clip-rotate-multiple":2,"ball-clip-rotate-pulse":2,"ball-elastic-dots":5,"ball-fall":3,"ball-fussion":4,"ball-grid-beat":9,"ball-grid-pulse":9,"ball-newton-cradle":4,"ball-pulse":3,"ball-pulse-rise":5,"ball-pulse-sync":3,"ball-rotate":1,"ball-running-dots":5,"ball-scale":1,"ball-scale-multiple":3,"ball-scale-pulse":2,"ball-scale-ripple":1,"ball-scale-ripple-multiple":3,"ball-spin":8,"ball-spin-clockwise":8,"ball-spin-clockwise-fade":8,"ball-spin-clockwise-fade-rotating":8,"ball-spin-fade":8,"ball-spin-fade-rotating":8,"ball-spin-rotate":2,"ball-square-clockwise-spin":8,"ball-square-spin":8,"ball-triangle-path":3,"ball-zig-zag":2,"ball-zig-zag-deflect":2,cog:1,"cube-transition":2,fire:3,"line-scale":5,"line-scale-party":5,"line-scale-pulse-out":5,"line-scale-pulse-out-rapid":5,"line-spin-clockwise-fade":8,"line-spin-clockwise-fade-rotating":8,"line-spin-fade":8,"line-spin-fade-rotating":8,pacman:6,"square-jelly-box":2,"square-loader":1,"square-spin":1,timer:1,"triangle-skew-spin":1}}window.JsLoadingOverlay=new i,t.exports=JsLoadingOverlay}],n={},r.m=i,r.c=n,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)},1168:(t,e,f)=>{"use strict";f.r(e),f.d(e,{AcroForm:()=>Ht,AcroFormAppearance:()=>qt,AcroFormButton:()=>Et,AcroFormCheckBox:()=>Bt,AcroFormChoiceField:()=>Ot,AcroFormComboBox:()=>jt,AcroFormEditBox:()=>Ft,AcroFormListBox:()=>Nt,AcroFormPasswordField:()=>zt,AcroFormPushButton:()=>It,AcroFormRadioButton:()=>Dt,AcroFormTextField:()=>Rt,GState:()=>vi,ShadingPattern:()=>yi,TilingPattern:()=>bi,default:()=>Vi,jsPDF:()=>wi});var V=Uint8Array,X=Uint16Array,G=Uint32Array,Y=new V([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),K=new V([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),B=new V([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),i=function(t,e){for(var i=new X(31),n=0;n<31;++n)i[n]=e+=1<<t[n-1];for(var r=new G(i[30]),n=1;n<30;++n)for(var o=i[n];o<i[n+1];++o)r[o]=o-i[n]<<5|n;return[i,r]},e=i(Y,2),R=e[0],J=e[1];R[28]=258,J[258]=28;for(var n,e=i(K,0),z=e[0],$=e[1],d=new X(32768),r=0;r<32768;++r)n=(61680&(n=(52428&(n=(43690&r)>>>1|(21845&r)<<1))>>>2|(13107&n)<<2))>>>4|(3855&n)<<4,d[r]=((65280&n)>>>8|(255&n)<<8)>>>1;for(var q=function(t,e,i){for(var n=t.length,r=0,o=new X(e);r<n;++r)++o[t[r]-1];var s=new X(e);for(r=0;r<e;++r)s[r]=s[r-1]+o[r-1]<<1;if(i){for(var a=new X(1<<e),h=15-e,r=0;r<n;++r)if(t[r])for(var c=r<<4|t[r],l=e-t[r],u=s[t[r]-1]++<<l,f=u|(1<<l)-1;u<=f;++u)a[d[u]>>>h]=c}else for(a=new X(n),r=0;r<n;++r)a[r]=d[s[t[r]-1]++]>>>15-t[r];return a},I=new V(288),r=0;r<144;++r)I[r]=8;for(r=144;r<256;++r)I[r]=9;for(r=256;r<280;++r)I[r]=7;for(r=280;r<288;++r)I[r]=8;var D=new V(32);for(r=0;r<32;++r)D[r]=5;function U(t){for(var e=t[0],i=1;i<t.length;++i)t[i]>e&&(e=t[i]);return e}function W(t,e,i){var n=e/8>>0;return(t[n]|t[1+n]<<8)>>>(7&e)&i}function H(t,e){var i=e/8>>0;return(t[i]|t[1+i]<<8|t[2+i]<<16)>>>(7&e)}function Z(t){return(t/8>>0)+(7&t&&1)}function Q(t,e,i){(null==i||i>t.length)&&(i=t.length);var n=new(t instanceof X?X:t instanceof G?G:V)(i-(e=null==e||e<0?0:e));return n.set(t.subarray(e,i)),n}function M(t,e,i){var n=e/8>>0;t[n]|=i<<=7&e,t[1+n]|=i>>>8}function tt(t,e,i){var n=e/8>>0;t[n]|=i<<=7&e,t[1+n]|=i>>>8,t[2+n]|=i>>>16}function et(t,e){for(var i=[],n=0;n<t.length;++n)t[n]&&i.push({s:n,f:t[n]});var r=i.length,o=i.slice();if(!r)return[new V(0),0];if(1==r){var s=new V(i[0].s+1);return s[i[0].s]=1,[s,1]}i.sort(function(t,e){return t.f-e.f}),i.push({s:-1,f:25001});var a=i[0],h=i[1],c=0,l=1,u=2;for(i[0]={s:-1,f:a.f+h.f,l:a,r:h};l!=r-1;)a=i[i[c].f<i[u].f?c++:u++],h=i[c!=l&&i[c].f<i[u].f?c++:u++],i[l++]={s:-1,f:a.f+h.f,l:a,r:h};var f=o[0].s;for(n=1;n<r;++n)o[n].s>f&&(f=o[n].s);var d=new X(f+1),p=w(i[l-1],d,0);if(e<p){var n=0,g=0,s=p-e,m=1<<s;for(o.sort(function(t,e){return d[e.s]-d[t.s]||t.f-e.f});n<r;++n){var v=o[n].s;if(!(d[v]>e))break;g+=m-(1<<p-d[v]),d[v]=e}for(g>>>=s;0<g;){var y=o[n].s;d[y]<e?g-=1<<e-d[y]++-1:++n}for(;0<=n&&g;--n){var b=o[n].s;d[b]==e&&(--d[b],++g)}p=e}return[new V(d),p]}function it(t){for(var e=t.length;e&&!t[--e];);for(var i=new X(++e),n=0,r=t[0],o=1,s=function(t){i[n++]=t},a=1;a<=e;++a)if(t[a]==r&&a!=e)++o;else{if(!r&&2<o){for(;138<o;o-=138)s(32754);2<o&&(s(10<o?o-11<<5|28690:o-3<<5|12305),o=0)}else if(3<o){for(s(r),--o;6<o;o-=6)s(8304);2<o&&(s(o-3<<5|8208),o=0)}for(;o--;)s(r);o=1,r=t[a]}return[i.subarray(0,n),e]}function nt(t,e){for(var i=0,n=0;n<e.length;++n)i+=t[n]*e[n];return i}function rt(t,e,i){var n=i.length,r=Z(e+2);t[r]=255&n,t[r+1]=n>>>8,t[r+2]=255^t[r],t[r+3]=255^t[r+1];for(var o=0;o<n;++o)t[r+o+4]=i[o];return 8*(r+4+n)}function ot(t,e,i,n,r,o,s,a,h,c,l){M(e,l++,i),++r[256];for(var u=(y=et(r,15))[0],f=y[1],d=(A=et(o,15))[0],p=A[1],g=(_=it(u))[0],m=_[1],v=(i=it(d))[0],y=i[1],b=new X(19),w=0;w<g.length;++w)b[31&g[w]]++;for(w=0;w<v.length;++w)b[31&v[w]]++;for(var x=(A=et(b,7))[0],_=A[1],S=19;4<S&&!x[B[S-1]];--S);var C,i=c+5<<3,A=nt(r,I)+nt(o,D)+s,s=nt(r,u)+nt(o,d)+s+14+3*S+nt(b,x)+(2*b[16]+3*b[17]+7*b[18]);if(i<=A&&i<=s)return rt(e,l,t.subarray(h,h+c));if(M(e,l,1+(s<A)),l+=2,s<A){var L=q(u,f,0),T=u,P=q(d,p,0),k=d,O=q(x,_,0);for(M(e,l,m-257),M(e,l+5,y-1),M(e,l+10,S-4),l+=14,w=0;w<S;++w)M(e,l+3*w,x[B[w]]);l+=3*S;for(var N=[g,v],j=0;j<2;++j)for(var F=N[j],w=0;w<F.length;++w){var E=31&F[w];M(e,l,O[E]),l+=x[E],15<E&&(M(e,l,F[w]>>>5&127),l+=F[w]>>>12)}}else L=st,T=I,P=ht,k=D;for(w=0;w<a;++w)255<n[w]?(E=n[w]>>>18&31,tt(e,l,L[E+257]),l+=T[E+257],7<E&&(M(e,l,n[w]>>>23&31),l+=Y[E]),C=31&n[w],tt(e,l,P[C]),l+=k[C],3<C&&(tt(e,l,n[w]>>>5&8191),l+=K[C])):(tt(e,l,L[n[w]]),l+=T[n[w]]);return tt(e,l,L[256]),l+T[256]}var st=q(I,9,0),at=q(I,9,1),ht=q(D,5,0),ct=q(D,5,1),w=function(t,e,i){return-1==t.s?Math.max(w(t.l,e,i+1),w(t.r,e,i+1)):e[t.s]=i},lt=new G([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ut=new V(0),o=function(t,e,i,n,r){return function(e,t,i,n,r,o){var s=e.length,a=new V(n+s+5*(1+Math.floor(s/7e3))+r),h=a.subarray(n,a.length-r),c=0;if(!t||s<8)for(var l=0;l<=s;l+=65535)var u=l+65535,c=u<s?rt(h,c,e.subarray(l,u)):(h[l]=o,rt(h,c,e.subarray(l,s)));else{for(var t=lt[t-1],f=t>>>13,d=8191&t,p=(1<<i)-1,g=new X(32768),m=new X(p+1),v=Math.ceil(i/3),y=2*v,b=function(t){return(e[t]^e[t+1]<<v^e[t+2]<<y)&p},w=new G(25e3),x=new X(288),_=new X(32),S=0,C=0,A=l=0,L=0,T=0;l<s;++l){var P=b(l),k=32767&l,O=m[P];if(g[k]=O,m[P]=k,L<=l){var N=s-l;if((7e3<S||24576<A)&&423<N){c=ot(e,h,0,w,x,_,C,A,T,l-T,c);for(var A=S=C=0,T=l,j=0;j<286;++j)x[j]=0;for(j=0;j<30;++j)_[j]=0}var F=2,E=0,I=d,D=k-O&32767;if(2<N&&P==b(l-D))for(var M=Math.min(f,N)-1,B=Math.min(32767,l),R=Math.min(258,N);D<=B&&--I&&k!=O;){if(e[l+F]==e[l+F-D]){for(var z=0;z<R&&e[l+z]==e[l+z-D];++z);if(F<z){if(E=D,M<(F=z))break;for(var q=Math.min(D,z-2),U=0,j=0;j<q;++j){var W=l-D+j+32768&32767,H=W-g[W]+32768&32767;U<H&&(U=H,O=W)}}}D+=(k=O)-(O=g[k])+32768&32767}E?(w[A++]=268435456|J[F]<<18|$[E],P=31&J[F],N=31&$[E],C+=Y[P]+K[N],++x[257+P],++_[N],L=l+F,++S):(w[A++]=e[l],++x[e[l]])}}c=ot(e,h,o,w,x,_,C,A,T,l-T,c),o||(c=rt(h,c,ut))}return Q(a,0,n+Z(c)+r)}(t,null==e.level?6:e.level,null==e.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,i,n,!r)};function s(t,e){void 0===e&&(e={});var s,a,i=(s=1,a=0,{p:function(t){for(var e=s,i=a,n=t.length,r=0;r!=n;){for(var o=Math.min(r+5552,n);r<o;++r)i+=e+=t[r];e%=65521,i%=65521}s=e,a=i},d:function(){return(s>>>8<<16|(255&a)<<8|a>>>8)+2*((255&s)<<23)}});i.p(t);var n=o(t,e,2,4);return t=n,e=0==(e=e.level)?0:e<6?1:9==e?3:2,t[0]=120,t[1]=e<<6|(e?32-2*e:1),function(t,e,i){for(;i;++e)t[e]=i,i>>>=8}(n,n.length-4,i.d()),n}function a(t,e){return function(t,i,e){var n=t.length,r=!i||e,o=!e||e.i;e=e||{},i=i||new V(3*n);function s(t){var e=i.length;e<t&&((t=new V(Math.max(2*e,t))).set(i),i=t)}var a=e.f||0,h=e.p||0,c=e.b||0,l=e.l,u=e.d,f=e.m,d=e.n,p=8*n;do{if(!l){e.f=a=W(t,h,1);var g=W(t,h+1,3);if(h+=3,!g){var m=t[(A=Z(h)+4)-4]|t[A-3]<<8,v=A+m;if(n<v){if(o)throw"unexpected EOF";break}r&&s(c+m),i.set(t.subarray(A,v),c),e.b=c+=m,e.p=h=8*v;continue}if(1==g)l=at,u=ct,f=9,d=5;else{if(2!=g)throw"invalid block type";var m=W(t,h,31)+257,y=W(t,h+10,15)+4,b=m+W(t,h+5,31)+1;h+=14;for(var w=new V(b),x=new V(19),_=0;_<y;++_)x[B[_]]=W(t,h+3*_,7);h+=3*y;var v=U(x),S=(1<<v)-1;if(!o&&p<h+b*(v+7))break;for(var C=q(x,v,1),_=0;_<b;){var A,L=C[W(t,h,S)];if(h+=15&L,(A=L>>>4)<16)w[_++]=A;else{var T=0,P=0;for(16==A?(P=3+W(t,h,3),h+=2,T=w[_-1]):17==A?(P=3+W(t,h,7),h+=3):18==A&&(P=11+W(t,h,127),h+=7);P--;)w[_++]=T}}var v=w.subarray(0,m),k=w.subarray(m),f=U(v),d=U(k),l=q(v,f,1),u=q(k,d,1)}if(p<h)throw"unexpected EOF"}r&&s(c+131072);for(var O=(1<<f)-1,N=(1<<d)-1,j=f+d+18;o||h+j<p;){var F=(T=l[H(t,h)&O])>>>4;if((h+=15&T)>p)throw"unexpected EOF";if(!T)throw"invalid length/literal";if(F<256)i[c++]=F;else{if(256==F){l=null;break}var E,I=F-254;264<F&&(E=Y[_=F-257],I=W(t,h,(1<<E)-1)+R[_],h+=E);var D=u[H(t,h)&N],F=D>>>4;if(!D)throw"invalid distance";if(h+=15&D,k=z[F],3<F&&(E=K[F],k+=H(t,h)&(1<<E)-1,h+=E),p<h)throw"unexpected EOF";r&&s(c+131072);for(var M=c+I;c<M;c+=4)i[c]=i[c-k],i[c+1]=i[c+1-k],i[c+2]=i[c+2-k],i[c+3]=i[c+3-k];c=M}}e.l=l,e.p=h,e.b=c,l&&(a=1,e.m=f,e.d=u,e.n=d)}while(!a);return c==i.length?i:Q(i,0,c)}((function(){if(8!=(15&t[0])||7<t[0]>>>4||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(32&t[1])throw"invalid zlib data: preset dictionaries not supported"}(),t.subarray(2,-4)),e)}var ci=f(2702),li=function(){return"undefined"!=typeof window?window:void 0!==f.g?f.g:"undefined"!=typeof self?self:this}();function h(){li.console&&"function"==typeof li.console.log&&li.console.log.apply(li.console,arguments)}var ui={log:h,warn:function(t){li.console&&("function"==typeof li.console.warn?li.console.warn.apply(li.console,arguments):h.call(null,arguments))},error:function(t){li.console&&("function"==typeof li.console.error?li.console.error.apply(li.console,arguments):h(t))}};function c(t,e,i){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){fi(n.response,e,i)},n.onerror=function(){ui.error("could not download file")},n.send()}function l(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&e.status<=299}function u(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(t){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(i)}}var fi=li.saveAs||("object"!=typeof window||window!==li?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(t,e,i){var n=li.URL||li.webkitURL,r=document.createElement("a");e=e||t.name||"download",r.download=e,r.rel="noopener","string"==typeof t?(r.href=t,r.origin!==location.origin?l(r.href)?c(t,e,i):u(r,r.target="_blank"):u(r)):(r.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(r.href)},4e4),setTimeout(function(){u(r)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,i){var n;e=e||t.name||"download","string"==typeof t?l(t)?c(t,e,i):((n=document.createElement("a")).href=t,n.target="_blank",setTimeout(function(){u(n)})):navigator.msSaveOrOpenBlob((t=t,void 0===(i=i)?i={autoBom:!1}:"object"!=typeof i&&(ui.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t),e)}:function(t,e,i,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof t)return c(t,e,i);var r,o,s,e="application/octet-stream"===t.type,i=/constructor/i.test(li.HTMLElement)||li.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);(a||e&&i)&&"object"==typeof FileReader?((r=new FileReader).onloadend=function(){var t=r.result,t=a?t:t.replace(/^data:[^;]*;/,"data:attachment/file;");n?n.location.href=t:location=t,n=null},r.readAsDataURL(t)):(o=li.URL||li.webkitURL,s=o.createObjectURL(t),n?n.location=s:location.href=s,n=null,setTimeout(function(){o.revokeObjectURL(s)},4e4))});function di(t){t=t||"",this.ok=!1,t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=(t="#"==t.charAt(0)?t.substr(1,6):t).replace(/ /g,"")).toLowerCase()]||t;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],i=0;i<e.length;i++){var n=e[i].re,r=e[i].process,n=n.exec(t);n&&(n=r(n),this.r=n[0],this.g=n[1],this.b=n[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:255<this.r?255:this.r,this.g=this.g<0||isNaN(this.g)?0:255<this.g?255:this.g,this.b=this.b<0||isNaN(this.b)?0:255<this.b?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),i=this.b.toString(16);return"#"+(t=1==t.length?"0"+t:t)+(e=1==e.length?"0"+e:e)+(i=1==i.length?"0"+i:i)}}function p(t,e){var i=m(i=t[0],o=t[1],r=t[2],n=t[3],e[0],7,-680876936),n=m(n,i,o,r,e[1],12,-389564586),r=m(r,n,i,o,e[2],17,606105819),o=m(o,r,n,i,e[3],22,-1044525330);i=m(i,o,r,n,e[4],7,-176418897),n=m(n,i,o,r,e[5],12,1200080426),r=m(r,n,i,o,e[6],17,-1473231341),o=m(o,r,n,i,e[7],22,-45705983),i=m(i,o,r,n,e[8],7,1770035416),n=m(n,i,o,r,e[9],12,-1958414417),r=m(r,n,i,o,e[10],17,-42063),o=m(o,r,n,i,e[11],22,-1990404162),i=m(i,o,r,n,e[12],7,1804603682),n=m(n,i,o,r,e[13],12,-40341101),r=m(r,n,i,o,e[14],17,-1502002290),i=v(i,o=m(o,r,n,i,e[15],22,1236535329),r,n,e[1],5,-165796510),n=v(n,i,o,r,e[6],9,-1069501632),r=v(r,n,i,o,e[11],14,643717713),o=v(o,r,n,i,e[0],20,-373897302),i=v(i,o,r,n,e[5],5,-701558691),n=v(n,i,o,r,e[10],9,38016083),r=v(r,n,i,o,e[15],14,-660478335),o=v(o,r,n,i,e[4],20,-405537848),i=v(i,o,r,n,e[9],5,568446438),n=v(n,i,o,r,e[14],9,-1019803690),r=v(r,n,i,o,e[3],14,-187363961),o=v(o,r,n,i,e[8],20,1163531501),i=v(i,o,r,n,e[13],5,-1444681467),n=v(n,i,o,r,e[2],9,-51403784),r=v(r,n,i,o,e[7],14,1735328473),i=y(i,o=v(o,r,n,i,e[12],20,-1926607734),r,n,e[5],4,-378558),n=y(n,i,o,r,e[8],11,-2022574463),r=y(r,n,i,o,e[11],16,1839030562),o=y(o,r,n,i,e[14],23,-35309556),i=y(i,o,r,n,e[1],4,-1530992060),n=y(n,i,o,r,e[4],11,1272893353),r=y(r,n,i,o,e[7],16,-155497632),o=y(o,r,n,i,e[10],23,-1094730640),i=y(i,o,r,n,e[13],4,681279174),n=y(n,i,o,r,e[0],11,-358537222),r=y(r,n,i,o,e[3],16,-722521979),o=y(o,r,n,i,e[6],23,76029189),i=y(i,o,r,n,e[9],4,-640364487),n=y(n,i,o,r,e[12],11,-421815835),r=y(r,n,i,o,e[15],16,530742520),i=b(i,o=y(o,r,n,i,e[2],23,-995338651),r,n,e[0],6,-198630844),n=b(n,i,o,r,e[7],10,1126891415),r=b(r,n,i,o,e[14],15,-1416354905),o=b(o,r,n,i,e[5],21,-57434055),i=b(i,o,r,n,e[12],6,1700485571),n=b(n,i,o,r,e[3],10,-1894986606),r=b(r,n,i,o,e[10],15,-1051523),o=b(o,r,n,i,e[1],21,-2054922799),i=b(i,o,r,n,e[8],6,1873313359),n=b(n,i,o,r,e[15],10,-30611744),r=b(r,n,i,o,e[6],15,-1560198380),o=b(o,r,n,i,e[13],21,1309151649),i=b(i,o,r,n,e[4],6,-145523070),n=b(n,i,o,r,e[11],10,-1120210379),r=b(r,n,i,o,e[2],15,718787259),o=b(o,r,n,i,e[9],21,-343485551),t[0]=A(i,t[0]),t[1]=A(o,t[1]),t[2]=A(r,t[2]),t[3]=A(n,t[3])}function g(t,e,i,n,r,o){return e=A(A(e,t),A(n,o)),A(e<<r|e>>>32-r,i)}function m(t,e,i,n,r,o,s){return g(e&i|~e&n,t,e,r,o,s)}function v(t,e,i,n,r,o,s){return g(e&n|i&~n,t,e,r,o,s)}function y(t,e,i,n,r,o,s){return g(e^i^n,t,e,r,o,s)}function b(t,e,i,n,r,o,s){return g(i^(e|~n),t,e,r,o,s)}function x(t){for(var e=t.length,i=[1732584193,-271733879,-1732584194,271733878],n=64;n<=t.length;n+=64)p(i,function(t){var e,i=[];for(e=0;e<64;e+=4)i[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return i}(t.substring(n-64,n)));t=t.substring(n-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<t.length;n++)r[n>>2]|=t.charCodeAt(n)<<(n%4<<3);if(r[n>>2]|=128<<(n%4<<3),55<n)for(p(i,r),n=0;n<16;n++)r[n]=0;return r[14]=8*e,p(i,r),i}var L=li.atob.bind(li),pi=li.btoa.bind(li),_="0123456789abcdef".split("");function S(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function C(t){return x(t).map(S).join("")}function A(t,e){return t+e&4294967295}{function n(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}!function(t){for(var e=0;e<t.length;e++)t[e]=function(t){for(var e="",i=0;i<4;i++)e+=_[t>>8*i+4&15]+_[t>>8*i&15];return e}(t[e]);t.join("")}(x("hello"))}function T(t,e){var i,n,r;if(t!==i){for(var o=(r=1+(256/(n=t).length>>0),new Array(1+r).join(n)),s=[],a=0;a<256;a++)s[a]=a;for(var h=0,a=0;a<256;a++){var c=s[a],h=(h+c+o.charCodeAt(a))%256;s[a]=s[h],s[h]=c}i=t,n=s}else s=n;var l=e.length,u=0,f=0,d="";for(a=0;a<l;a++)f=(f+(c=s[u=(u+1)%256]))%256,s[u]=s[f],s[f]=c,o=s[(s[u]+s[f])%256],d+=String.fromCharCode(e.charCodeAt(a)^o);return d}var P={print:4,modify:8,copy:16,"annot-forms":32};function gi(t,e,i,n){this.v=1,this.r=2;let r=192;t.forEach(function(t){if(void 0!==P.perm)throw new Error("Invalid permission: "+t);r+=P[t]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";e=(e+this.padding).substr(0,32),i=(i+this.padding).substr(0,32);this.O=this.processOwnerPassword(e,i),this.P=-(1+(255^r)),this.encryptionKey=C(e+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=T(this.encryptionKey,this.padding)}function mi(o){if("object"!=typeof o)throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var s={};this.subscribe=function(t,e,i){if(i=i||!1,"string"!=typeof t||"function"!=typeof e||"boolean"!=typeof i)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");s.hasOwnProperty(t)||(s[t]={});var n=Math.random().toString(35);return s[t][n]=[e,!!i],n},this.unsubscribe=function(t){for(var e in s)if(s[e][t])return delete s[e][t],0===Object.keys(s[e]).length&&delete s[e],!0;return!1},this.publish=function(t){if(s.hasOwnProperty(t)){var e,i=Array.prototype.slice.call(arguments,1),n=[];for(e in s[t]){var r=s[t][e];try{r[0].apply(o,i)}catch(t){li.console&&ui.error("jsPDF PubSub Error",t.message,t)}r[1]&&n.push(e)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return s}}function vi(t){if(!(this instanceof vi))return new vi(t);var e,i="opacity,stroke-opacity".split(",");for(e in t)t.hasOwnProperty(e)&&0<=i.indexOf(e)&&(this[e]=t[e]);this.id="",this.objectNumber=-1}function k(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function yi(t,e,i,n,r){if(!(this instanceof yi))return new yi(t,e,i,n,r);this.type="axial"===t?2:3,this.coords=e,this.colors=i,k.call(this,n,r)}function bi(t,e,i,n,r){if(!(this instanceof bi))return new bi(t,e,i,n,r);this.boundingBox=t,this.xStep=e,this.yStep=i,this.stream="",this.cloneIndex=0,k.call(this,n,r)}function wi(t){var i,r="string"==typeof arguments[0]?arguments[0]:"p",e=arguments[1],o=arguments[2],n=arguments[3],s=[],a=1,h=16,c="S",p=null;"object"==typeof(t=t||{})&&(r=t.orientation,e=t.unit||e,o=t.format||o,n=t.compress||t.compressPdf||n,null!==(p=t.encryption||null)&&(p.userPassword=p.userPassword||"",p.ownerPassword=p.ownerPassword||"",p.userPermissions=p.userPermissions||[]),a="number"==typeof t.userUnit?Math.abs(t.userUnit):1,void 0!==t.precision&&(i=t.precision),void 0!==t.floatPrecision&&(h=t.floatPrecision),c=t.defaultPathOperation||"S");var s=t.filters||(!0===n?["FlateEncode"]:s),e=e||"mm",r=(""+(r||"P")).toLowerCase(),l=t.putOnlyUsedFonts||!1,X={},u={internal:{},__private__:{}};u.__private__.PubSub=mi;var f="1.3",d=u.__private__.getPdfVersion=function(){return f};u.__private__.setPdfVersion=function(t){f=t};var g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};u.__private__.getPageFormats=function(){return g};var m=u.__private__.getPageFormat=function(t){return g[t]},o=o||"a4",G={COMPAT:"compat",ADVANCED:"advanced"},Y=G.COMPAT;function v(){this.saveGraphicsState(),Z(new Ot(ut,0,0,-ut,0,ai()*ut).toString()+" cm"),this.setFontSize(this.getFontSize()/ut),c="n",Y=G.ADVANCED}function y(){this.restoreGraphicsState(),c="S",Y=G.COMPAT}function b(t,e){if("bold"==t&&"normal"==e||"bold"==t&&400==e||"normal"==t&&"italic"==e||"bold"==t&&"italic"==e)throw new Error("Invalid Combination of fontweight and fontstyle");return t=e&&t!==e?400==e?"italic"==t?"italic":"normal":700==e&&"italic"!==t?"bold":t+""+e:t}u.advancedAPI=function(t){var e=Y===G.COMPAT;return e&&v.call(this),"function"!=typeof t||(t(this),e&&y.call(this)),this},u.compatAPI=function(t){var e=Y===G.ADVANCED;return e&&y.call(this),"function"!=typeof t||(t(this),e&&v.call(this)),this},u.isAdvancedAPI=function(){return Y===G.ADVANCED};function K(t){if(Y!==G.ADVANCED)throw new Error(t+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")}function w(t){return $((t=t,Y===G.COMPAT?ai()-t:Y===G.ADVANCED?t:void 0))}var x=u.roundToPrecision=u.__private__.roundToPrecision=function(t,e){e=i||e;if(isNaN(t)||isNaN(e))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return t.toFixed(e).replace(/0+$/,"")},J=u.hpf=u.__private__.hpf="number"==typeof h?function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.hpf");return x(t,h)}:"smart"===h?function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.hpf");return x(t,-1<t&&t<1?16:5)}:function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.hpf");return x(t,16)},_=u.f2=u.__private__.f2=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f2");return x(t,2)},S=u.__private__.f3=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f3");return x(t,3)},$=u.scale=u.__private__.scale=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.scale");return Y===G.COMPAT?t*ut:Y===G.ADVANCED?t:void 0};u.__private__.setPrecision=u.setPrecision=function(t){"number"==typeof parseInt(t,10)&&(i=parseInt(t,10))};var C,A="00000000000000000000000000000000",L=u.__private__.getFileId=function(){return A},T=u.__private__.setFileId=function(t){return A=void 0!==t&&/^[a-fA-F0-9]{32}$/.test(t)?t.toUpperCase():A.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),null!==p&&(_e=new gi(p.userPermissions,p.userPassword,p.ownerPassword,A)),A};u.setFileId=function(t){return T(t),this},u.getFileId=function(){return L()};var P=u.__private__.convertDateToPDFDate=function(t){var e=t.getTimezoneOffset(),i=e<0?"+":"-",n=Math.floor(Math.abs(e/60)),e=Math.abs(e%60),e=[i,F(n),"'",F(e),"'"].join("");return["D:",t.getFullYear(),F(t.getMonth()+1),F(t.getDate()),F(t.getHours()),F(t.getMinutes()),F(t.getSeconds()),e].join("")},k=u.__private__.convertPDFDateToDate=function(t){var e=parseInt(t.substr(2,4),10),i=parseInt(t.substr(6,2),10)-1,n=parseInt(t.substr(8,2),10),r=parseInt(t.substr(10,2),10),o=parseInt(t.substr(12,2),10),t=parseInt(t.substr(14,2),10);return new Date(e,i,n,r,o,t,0)},O=u.__private__.setCreationDate=function(t){var e;if((t=void 0===t?new Date:t)instanceof Date)e=P(t);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(t))throw new Error("Invalid argument passed to jsPDF.setCreationDate");e=t}return C=e},N=u.__private__.getCreationDate=function(t){var e=C;return e="jsDate"===t?k(C):e};u.setCreationDate=function(t){return O(t),this},u.getCreationDate=function(t){return N(t)};var j,F=u.__private__.padd2=function(t){return("0"+parseInt(t)).slice(-2)},E=u.__private__.padd2Hex=function(t){return("00"+(t=t.toString())).substr(t.length)},I=0,D=[],M=[],B=0,R=[],z=[],q=!1,U=M;u.__private__.setCustomOutputDestination=function(t){q=!0,U=t};function W(t){q||(U=t)}u.__private__.resetCustomOutputDestination=function(){q=!1,U=M};var Z=u.__private__.out=function(t){return t=t.toString(),B+=t.length+1,U.push(t),U},H=u.__private__.write=function(t){return Z(1===arguments.length?t.toString():Array.prototype.join.call(arguments," "))},V=u.__private__.getArrayBuffer=function(t){for(var e=t.length,i=new ArrayBuffer(e),n=new Uint8Array(i);e--;)n[e]=t.charCodeAt(e);return i},Q=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];u.__private__.getStandardFonts=function(){return Q};var tt=t.fontSize||16;u.__private__.setFontSize=u.setFontSize=function(t){return tt=Y===G.ADVANCED?t/ut:t,this};var et,it=u.__private__.getFontSize=u.getFontSize=function(){return Y===G.COMPAT?tt:tt*ut},nt=t.R2L||!1;u.__private__.setR2L=u.setR2L=function(t){return nt=t,this},u.__private__.getR2L=u.getR2L=function(){return nt};var rt,ot=u.__private__.setZoomMode=function(t){if(/^\d*\.?\d*%$/.test(t))et=t;else if(isNaN(t)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(t))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+t+'" is not recognized.');et=t}else et=parseInt(t,10)};u.__private__.getZoomMode=function(){return et};var st,at=u.__private__.setPageMode=function(t){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(t))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+t+'" is not recognized.');rt=t};u.__private__.getPageMode=function(){return rt};var ht=u.__private__.setLayoutMode=function(t){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(t))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+t+'" is not recognized.');st=t};u.__private__.getLayoutMode=function(){return st},u.__private__.setDisplayMode=u.setDisplayMode=function(t,e,i){return ot(t),ht(e),at(i),this};var ct={title:"",subject:"",author:"",keywords:"",creator:""};u.__private__.getDocumentProperty=function(t){if(-1===Object.keys(ct).indexOf(t))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ct[t]},u.__private__.getDocumentProperties=function(){return ct},u.__private__.setDocumentProperties=u.setProperties=u.setDocumentProperties=function(t){for(var e in ct)ct.hasOwnProperty(e)&&t[e]&&(ct[e]=t[e]);return this},u.__private__.setDocumentProperty=function(t,e){if(-1===Object.keys(ct).indexOf(t))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ct[t]=e};var lt,ut,ft,dt,pt,gt={},mt={},vt=[],yt={},bt={},wt={},xt={},_t=null,St=0,Ct=[],At=new mi(u),Lt=t.hotfixes||[],Tt={},Pt={},kt=[],Ot=function(t,e,i,n,r,o){if(!(this instanceof Ot))return new Ot(t,e,i,n,r,o);isNaN(t)&&(t=1),isNaN(e)&&(e=0),isNaN(i)&&(i=0),isNaN(n)&&(n=1),isNaN(r)&&(r=0),isNaN(o)&&(o=0),this._matrix=[t,e,i,n,r,o]};Object.defineProperty(Ot.prototype,"sx",{get:function(){return this._matrix[0]},set:function(t){this._matrix[0]=t}}),Object.defineProperty(Ot.prototype,"shy",{get:function(){return this._matrix[1]},set:function(t){this._matrix[1]=t}}),Object.defineProperty(Ot.prototype,"shx",{get:function(){return this._matrix[2]},set:function(t){this._matrix[2]=t}}),Object.defineProperty(Ot.prototype,"sy",{get:function(){return this._matrix[3]},set:function(t){this._matrix[3]=t}}),Object.defineProperty(Ot.prototype,"tx",{get:function(){return this._matrix[4]},set:function(t){this._matrix[4]=t}}),Object.defineProperty(Ot.prototype,"ty",{get:function(){return this._matrix[5]},set:function(t){this._matrix[5]=t}}),Object.defineProperty(Ot.prototype,"a",{get:function(){return this._matrix[0]},set:function(t){this._matrix[0]=t}}),Object.defineProperty(Ot.prototype,"b",{get:function(){return this._matrix[1]},set:function(t){this._matrix[1]=t}}),Object.defineProperty(Ot.prototype,"c",{get:function(){return this._matrix[2]},set:function(t){this._matrix[2]=t}}),Object.defineProperty(Ot.prototype,"d",{get:function(){return this._matrix[3]},set:function(t){this._matrix[3]=t}}),Object.defineProperty(Ot.prototype,"e",{get:function(){return this._matrix[4]},set:function(t){this._matrix[4]=t}}),Object.defineProperty(Ot.prototype,"f",{get:function(){return this._matrix[5]},set:function(t){this._matrix[5]=t}}),Object.defineProperty(Ot.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ot.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ot.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ot.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),Ot.prototype.join=function(t){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(J).join(t)},Ot.prototype.multiply=function(t){var e=t.sx*this.sx+t.shy*this.shx,i=t.sx*this.shy+t.shy*this.sy,n=t.shx*this.sx+t.sy*this.shx,r=t.shx*this.shy+t.sy*this.sy,o=t.tx*this.sx+t.ty*this.shx+this.tx,t=t.tx*this.shy+t.ty*this.sy+this.ty;return new Ot(e,i,n,r,o,t)},Ot.prototype.decompose=function(){var t=this.sx,e=this.shy,i=this.shx,n=this.sy,r=this.tx,o=this.ty,s=Math.sqrt(t*t+e*e),a=(t/=s)*i+(e/=s)*n;i-=t*a,n-=e*a;var h=Math.sqrt(i*i+n*n);return a/=h,t*(n/=h)<e*(i/=h)&&(t=-t,e=-e,a=-a,s=-s),{scale:new Ot(s,0,0,h,0,0),translate:new Ot(1,0,0,1,r,o),rotate:new Ot(t,e,-e,t,0,0),skew:new Ot(1,0,a,1,0,0)}},Ot.prototype.toString=function(t){return this.join(" ")},Ot.prototype.inversed=function(){var t=this.sx,e=this.shy,i=this.shx,n=this.sy,r=this.tx,o=this.ty,s=1/(t*n-e*i),n=n*s,e=-e*s,i=-i*s,s=t*s;return new Ot(n,e,i,s,-n*r-i*o,-e*r-s*o)},Ot.prototype.applyToPoint=function(t){var e=t.x*this.sx+t.y*this.shx+this.tx,t=t.x*this.shy+t.y*this.sy+this.ty;return new ei(e,t)},Ot.prototype.applyToRectangle=function(t){var e=this.applyToPoint(t),t=this.applyToPoint(new ei(t.x+t.w,t.y+t.h));return new ii(e.x,e.y,t.x-e.x,t.y-e.y)},Ot.prototype.clone=function(){var t=this.sx,e=this.shy,i=this.shx,n=this.sy,r=this.tx,o=this.ty;return new Ot(t,e,i,n,r,o)},u.Matrix=Ot;var Nt=u.matrixMult=function(t,e){return e.multiply(t)},jt=new Ot(1,0,0,1,0,0);u.unitMatrix=u.identityMatrix=jt;var Ft=function(t,e){var i;bt[t]||(i=(e instanceof yi?"Sh":"P")+(Object.keys(yt).length+1).toString(10),e.id=i,bt[t]=i,yt[i]=e,At.publish("addPattern",e))};u.ShadingPattern=yi,u.TilingPattern=bi,u.addShadingPattern=function(t,e){return K("addShadingPattern()"),Ft(t,e),this},u.beginTilingPattern=function(t){K("beginTilingPattern()"),ri(t.boundingBox[0],t.boundingBox[1],t.boundingBox[2]-t.boundingBox[0],t.boundingBox[3]-t.boundingBox[1],t.matrix)},u.endTilingPattern=function(t,e){K("endTilingPattern()"),e.stream=z[j].join("\n"),Ft(t,e),At.publish("endTilingPattern",e),kt.pop().restore()};function Et(t){Ht(t.resourcesOid,!0),Z("<<"),Z("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),se(),ae(),he(t.objectOid),ce(),oe(),Z(">>"),Z("endobj")}function It(){var t=[];(function(){for(var t in gt)gt.hasOwnProperty(t)&&(!1===l||!0===l&&X.hasOwnProperty(t))&&te(gt[t])})(),function(){for(var t in wt)wt.hasOwnProperty(t)&&re(wt[t])}(),function(){for(var t in Tt)Tt.hasOwnProperty(t)&&ee(Tt[t])}(),function(t){for(var e in yt)yt.hasOwnProperty(e)&&(yt[e]instanceof yi?ie(yt[e]):yt[e]instanceof bi&&ne(yt[e],t))}(t),At.publish("putResources"),t.forEach(Et),Et({resourcesOid:Gt,objectOid:Number.MAX_SAFE_INTEGER}),At.publish("postPutResources")}function Dt(t){mt[t.fontName]=mt[t.fontName]||{},mt[t.fontName][t.fontStyle]=t.id}function Mt(t,e,i,n,r){return r={id:"F"+(Object.keys(gt).length+1).toString(10),postScriptName:t,fontName:e,fontStyle:i,encoding:n,isStandardFont:r||!1,metadata:{}},At.publish("addFont",{font:r,instance:this}),gt[r.id]=r,Dt(r),r.id}function Bt(t,e){var i,n;switch(r=e||r,"string"==typeof t&&(e=m(t.toLowerCase()),Array.isArray(e)&&(i=e[0],n=e[1])),Array.isArray(t)&&(i=t[0]*ut,n=t[1]*ut),isNaN(i)&&(i=o[0],n=o[1]),(14400<i||14400<n)&&(ui.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),i=Math.min(14400,i),n=Math.min(14400,n)),o=[i,n],r.substr(0,1)){case"l":i<n&&(o=[n,i]);break;case"p":n<i&&(o=[n,i])}ue(o),ze(Re),Z(Ge),0!==$e&&Z($e+" J"),0!==Ze&&Z(Ze+" j"),At.publish("addPage",{pageNumber:St})}function Rt(t,e,i){var n,r=void 0;return i=i||{},t=void 0!==t?t:gt[lt].fontName,e=void 0!==e?e:gt[lt].fontStyle,n=t.toLowerCase(),void 0!==mt[n]&&void 0!==mt[n][e]?r=mt[n][e]:void 0!==mt[t]&&void 0!==mt[t][e]?r=mt[t][e]:!1===i.disableWarning&&ui.warn("Unable to look up font label for font '"+t+"', '"+e+"'. Refer to getFontList() for available fonts."),r||i.noFallback||null==(r=mt.times[e])&&(r=mt.times.normal),r}function zt(t){return!0===Array.isArray(Lt)&&-1<Lt.indexOf(t)}var qt,Ut=u.__private__.newObject=function(){var t=Wt();return Ht(t,!0),t},Wt=u.__private__.newObjectDeferred=function(){return D[++I]=function(){return B},I},Ht=function(t,e){return e="boolean"==typeof e&&e,D[t]=B,e&&Z(t+" 0 obj"),t},Vt=u.__private__.newAdditionalObject=function(){var t={objId:Wt(),content:""};return R.push(t),t},Xt=Wt(),Gt=Wt(),Yt=u.__private__.decodeColorString=function(t){var e=t.split(" ");2!==e.length||"g"!==e[1]&&"G"!==e[1]?5!==e.length||"k"!==e[4]&&"K"!==e[4]||(e=[(1-e[0])*(1-e[3]),(1-e[1])*(1-e[3]),(1-e[2])*(1-e[3]),"r"]):e=[t=parseFloat(e[0]),t,t,"r"];for(var i="#",n=0;n<3;n++)i+=("0"+Math.floor(255*parseFloat(e[n])).toString(16)).slice(-2);return i},Kt=u.__private__.encodeColorString=function(t){var e,i=(t="string"==typeof t?{ch1:t}:t).ch1,n=t.ch2,r=t.ch3,o=t.ch4,s="draw"===t.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof i&&"#"!==i.charAt(0)){var a=new di(i);if(a.ok)i=a.toHex();else if(!/^\d*\.?\d*$/.test(i))throw new Error('Invalid color "'+i+'" passed to jsPDF.encodeColorString.')}if("string"==typeof(i="string"==typeof i&&/^#[0-9A-Fa-f]{3}$/.test(i)?"#"+i[1]+i[1]+i[2]+i[2]+i[3]+i[3]:i)&&/^#[0-9A-Fa-f]{6}$/.test(i)&&(i=(a=parseInt(i.substr(1),16))>>16&255,n=a>>8&255,r=255&a),void 0===n||void 0===o&&i===n&&n===r)e="string"==typeof i?i+" "+s[0]:2===t.precision?_(i/255)+" "+s[0]:S(i/255)+" "+s[0];else if(void 0===o||"object"==typeof o){if(o&&!isNaN(o.a)&&0===o.a)return["1.","1.","1.",s[1]].join(" ");e=("string"==typeof i?[i,n,r,s[1]]:2===t.precision?[_(i/255),_(n/255),_(r/255),s[1]]:[S(i/255),S(n/255),S(r/255),s[1]]).join(" ")}else e=("string"==typeof i?[i,n,r,o,s[2]]:2===t.precision?[_(i),_(n),_(r),_(o),s[2]]:[S(i),S(n),S(r),S(o),s[2]]).join(" ");return e},Jt=u.__private__.getFilters=function(){return s},$t=u.__private__.putStream=function(t){var e=(t=t||{}).data||"",i=t.filters||Jt(),n=t.alreadyAppliedFilters||[],r=t.addLength1||!1,o=e.length,s=t.objectId,a=function(t){return t};if(null!==p&&void 0===s)throw new Error("ObjectId must be passed to putStream for file encryption");null!==p&&(a=_e.encryptor(s,0));var h={};!0===i&&(i=["FlateEncode"]);var c=t.additionalKeyValues||[],n=(h=void 0!==wi.API.processDataByFilters?wi.API.processDataByFilters(e,i):{data:e,reverseChain:[]}).reverseChain+(Array.isArray(n)?n.join(" "):n.toString());if(0!==h.data.length&&(c.push({key:"Length",value:h.data.length}),!0===r&&c.push({key:"Length1",value:o})),0!=n.length)if(n.split("/").length-1==1)c.push({key:"Filter",value:n});else{c.push({key:"Filter",value:"["+n+"]"});for(var l=0;l<c.length;l+=1)if("DecodeParms"===c[l].key){for(var u=[],f=0;f<h.reverseChain.split("/").length-1;f+=1)u.push("null");u.push(c[l].value),c[l].value="["+u.join(" ")+"]"}}Z("<<");for(var d=0;d<c.length;d++)Z("/"+c[d].key+" "+c[d].value);Z(">>"),0!==h.data.length&&(Z("stream"),Z(a(h.data)),Z("endstream"))},Zt=u.__private__.putPage=function(t){var e=t.number,i=t.data,n=t.objId,r=t.contentsObjId;Ht(n,!0),Z("<</Type /Page"),Z("/Parent "+t.rootDictionaryObjId+" 0 R"),Z("/Resources "+t.resourceDictionaryObjId+" 0 R"),Z("/MediaBox ["+parseFloat(J(t.mediaBox.bottomLeftX))+" "+parseFloat(J(t.mediaBox.bottomLeftY))+" "+J(t.mediaBox.topRightX)+" "+J(t.mediaBox.topRightY)+"]"),null!==t.cropBox&&Z("/CropBox ["+J(t.cropBox.bottomLeftX)+" "+J(t.cropBox.bottomLeftY)+" "+J(t.cropBox.topRightX)+" "+J(t.cropBox.topRightY)+"]"),null!==t.bleedBox&&Z("/BleedBox ["+J(t.bleedBox.bottomLeftX)+" "+J(t.bleedBox.bottomLeftY)+" "+J(t.bleedBox.topRightX)+" "+J(t.bleedBox.topRightY)+"]"),null!==t.trimBox&&Z("/TrimBox ["+J(t.trimBox.bottomLeftX)+" "+J(t.trimBox.bottomLeftY)+" "+J(t.trimBox.topRightX)+" "+J(t.trimBox.topRightY)+"]"),null!==t.artBox&&Z("/ArtBox ["+J(t.artBox.bottomLeftX)+" "+J(t.artBox.bottomLeftY)+" "+J(t.artBox.topRightX)+" "+J(t.artBox.topRightY)+"]"),"number"==typeof t.userUnit&&1!==t.userUnit&&Z("/UserUnit "+t.userUnit),At.publish("putPage",{objId:n,pageContext:Ct[e],pageNumber:e,page:i}),Z("/Contents "+r+" 0 R"),Z(">>"),Z("endobj");i=i.join("\n");return Y===G.ADVANCED&&(i+="\nQ"),Ht(r,!0),$t({data:i,filters:Jt(),objectId:r}),Z("endobj"),n},Qt=u.__private__.putPages=function(){for(var t=[],e=1;e<=St;e++)Ct[e].objId=Wt(),Ct[e].contentsObjId=Wt();for(e=1;e<=St;e++)t.push(Zt({number:e,data:z[e],objId:Ct[e].objId,contentsObjId:Ct[e].contentsObjId,mediaBox:Ct[e].mediaBox,cropBox:Ct[e].cropBox,bleedBox:Ct[e].bleedBox,trimBox:Ct[e].trimBox,artBox:Ct[e].artBox,userUnit:Ct[e].userUnit,rootDictionaryObjId:Xt,resourceDictionaryObjId:Gt}));Ht(Xt,!0),Z("<</Type /Pages");for(var i="/Kids [",n=0;n<St;n++)i+=t[n]+" 0 R ";Z(i+"]"),Z("/Count "+St),Z(">>"),Z("endobj"),At.publish("postPutPages")},te=function(t){function e(t,e){return-1!==t.indexOf(" ")?"("+le(t,e)+")":le(t,e)}At.publish("putFont",{font:t,out:Z,newObject:Ut,putStream:$t,pdfEscapeWithNeededParanthesis:e}),!0!==t.isAlreadyPutted&&(t.objectNumber=Ut(),Z("<<"),Z("/Type /Font"),Z("/BaseFont /"+e(t.postScriptName)),Z("/Subtype /Type1"),"string"==typeof t.encoding&&Z("/Encoding /"+t.encoding),Z("/FirstChar 32"),Z("/LastChar 255"),Z(">>"),Z("endobj"))},ee=function(t){t.objectNumber=Ut();var e=[];e.push({key:"Type",value:"/XObject"}),e.push({key:"Subtype",value:"/Form"}),e.push({key:"BBox",value:"["+[J(t.x),J(t.y),J(t.x+t.width),J(t.y+t.height)].join(" ")+"]"}),e.push({key:"Matrix",value:"["+t.matrix.toString()+"]"});var i=t.pages[1].join("\n");$t({data:i,additionalKeyValues:e,objectId:t.objectNumber}),Z("endobj")},ie=function(t,e){e=e||21;var i=Ut(),n=function(t,e){for(var i,n=[],r=1/(e-1),o=0;o<1;o+=r)n.push(o);n.push(1),0!=t[0].offset&&(i={offset:0,color:t[0].color},t.unshift(i)),1!=t[t.length-1].offset&&(i={offset:1,color:t[t.length-1].color},t.push(i));for(var s="",a=0,h=0;h<n.length;h++){for(o=n[h];o>t[a+1].offset;)a++;var c=t[a].offset,l=(o-c)/(t[a+1].offset-c),u=t[a].color,c=t[a+1].color;s+=E(Math.round((1-l)*u[0]+l*c[0]).toString(16))+E(Math.round((1-l)*u[1]+l*c[1]).toString(16))+E(Math.round((1-l)*u[2]+l*c[2]).toString(16))}return s.trim()}(t.colors,e),r=[];r.push({key:"FunctionType",value:"0"}),r.push({key:"Domain",value:"[0.0 1.0]"}),r.push({key:"Size",value:"["+e+"]"}),r.push({key:"BitsPerSample",value:"8"}),r.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),r.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),$t({data:n,additionalKeyValues:r,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:i}),Z("endobj"),t.objectNumber=Ut(),Z("<< /ShadingType "+t.type),Z("/ColorSpace /DeviceRGB");r="/Coords ["+J(parseFloat(t.coords[0]))+" "+J(parseFloat(t.coords[1]))+" ";2===t.type?r+=J(parseFloat(t.coords[2]))+" "+J(parseFloat(t.coords[3])):r+=J(parseFloat(t.coords[2]))+" "+J(parseFloat(t.coords[3]))+" "+J(parseFloat(t.coords[4]))+" "+J(parseFloat(t.coords[5])),Z(r+="]"),t.matrix&&Z("/Matrix ["+t.matrix.toString()+"]"),Z("/Function "+i+" 0 R"),Z("/Extend [true true]"),Z(">>"),Z("endobj")},ne=function(t,e){var i=Wt(),n=Ut();e.push({resourcesOid:i,objectOid:n}),t.objectNumber=n;n=[];n.push({key:"Type",value:"/Pattern"}),n.push({key:"PatternType",value:"1"}),n.push({key:"PaintType",value:"1"}),n.push({key:"TilingType",value:"1"}),n.push({key:"BBox",value:"["+t.boundingBox.map(J).join(" ")+"]"}),n.push({key:"XStep",value:J(t.xStep)}),n.push({key:"YStep",value:J(t.yStep)}),n.push({key:"Resources",value:i+" 0 R"}),t.matrix&&n.push({key:"Matrix",value:"["+t.matrix.toString()+"]"}),$t({data:t.stream,additionalKeyValues:n,objectId:t.objectNumber}),Z("endobj")},re=function(t){for(var e in t.objectNumber=Ut(),Z("<<"),t)switch(e){case"opacity":Z("/ca "+_(t[e]));break;case"stroke-opacity":Z("/CA "+_(t[e]))}Z(">>"),Z("endobj")},oe=function(){for(var t in Z("/XObject <<"),Tt)Tt.hasOwnProperty(t)&&0<=Tt[t].objectNumber&&Z("/"+t+" "+Tt[t].objectNumber+" 0 R");At.publish("putXobjectDict"),Z(">>")},se=function(){for(var t in Z("/Font <<"),gt)gt.hasOwnProperty(t)&&(!1===l||!0===l&&X.hasOwnProperty(t))&&Z("/"+t+" "+gt[t].objectNumber+" 0 R");Z(">>")},ae=function(){if(0<Object.keys(yt).length){for(var t in Z("/Shading <<"),yt)yt.hasOwnProperty(t)&&yt[t]instanceof yi&&0<=yt[t].objectNumber&&Z("/"+t+" "+yt[t].objectNumber+" 0 R");At.publish("putShadingPatternDict"),Z(">>")}},he=function(t){if(0<Object.keys(yt).length){for(var e in Z("/Pattern <<"),yt)yt.hasOwnProperty(e)&&yt[e]instanceof u.TilingPattern&&0<=yt[e].objectNumber&&yt[e].objectNumber<t&&Z("/"+e+" "+yt[e].objectNumber+" 0 R");At.publish("putTilingPatternDict"),Z(">>")}},ce=function(){if(0<Object.keys(wt).length){for(var t in Z("/ExtGState <<"),wt)wt.hasOwnProperty(t)&&0<=wt[t].objectNumber&&Z("/"+t+" "+wt[t].objectNumber+" 0 R");At.publish("putGStateDict"),Z(">>")}},le=u.__private__.pdfEscape=u.pdfEscape=function(t,e){return function(t,e){var i,n,r,o,s,a,h=(e=e||{}).sourceEncoding||"Unicode",c=e.outputEncoding;if((e.autoencode||c)&&gt[lt].metadata&&gt[lt].metadata[h]&&gt[lt].metadata[h].encoding&&(h=gt[lt].metadata[h].encoding,c="string"==typeof(c=!(c=!c&&gt[lt].encoding?gt[lt].encoding:c)&&h.codePages?h.codePages[0]:c)?h[c]:c)){for(o=!1,r=[],i=0,n=t.length;i<n;i++)(s=c[t.charCodeAt(i)])?r.push(String.fromCharCode(s)):r.push(t[i]),r[i].charCodeAt(0)>>8&&(o=!0);t=r.join("")}for(i=t.length;void 0===o&&0!==i;)t.charCodeAt(i-1)>>8&&(o=!0),i--;if(!o)return t;for(r=e.noBOM?[]:[254,255],i=0,n=t.length;i<n;i++){if((a=(s=t.charCodeAt(i))>>8)>>8)throw new Error("Character at position "+i+" of string '"+t+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");r.push(a),r.push(s-(a<<8))}return String.fromCharCode.apply(void 0,r)}(t,e).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ue=u.__private__.beginPage=function(t){z[++St]=[],Ct[St]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(t[0]),topRightY:Number(t[1])}},fe(St),W(z[j])},fe=function(t){0<t&&t<=St&&(j=t)},de=u.__private__.getNumberOfPages=u.getNumberOfPages=function(){return z.length-1},pe=u.__private__.putInfo=function(){var t,e=Ut(),i=function(t){return t};for(t in null!==p&&(i=_e.encryptor(e,0)),Z("<<"),Z("/Producer ("+le(i("jsPDF "+wi.version))+")"),ct)ct.hasOwnProperty(t)&&ct[t]&&Z("/"+t.substr(0,1).toUpperCase()+t.substr(1)+" ("+le(i(ct[t]))+")");Z("/CreationDate ("+le(i(C))+")"),Z(">>"),Z("endobj")},ge=u.__private__.putCatalog=function(t){t=(t=t||{}).rootDictionaryObjId||Xt;switch(Ut(),Z("<<"),Z("/Type /Catalog"),Z("/Pages "+t+" 0 R"),et=et||"fullwidth"){case"fullwidth":Z("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Z("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Z("/OpenAction [3 0 R /Fit]");break;case"original":Z("/OpenAction [3 0 R /XYZ null null 1]");break;default:var e=""+et;"number"==typeof(et="%"===e.substr(e.length-1)?parseInt(et)/100:et)&&Z("/OpenAction [3 0 R /XYZ null null "+_(et)+"]")}switch(st=st||"continuous"){case"continuous":Z("/PageLayout /OneColumn");break;case"single":Z("/PageLayout /SinglePage");break;case"two":case"twoleft":Z("/PageLayout /TwoColumnLeft");break;case"tworight":Z("/PageLayout /TwoColumnRight")}rt&&Z("/PageMode /"+rt),At.publish("putCatalog"),Z(">>"),Z("endobj")},me=u.__private__.putTrailer=function(){Z("trailer"),Z("<<"),Z("/Size "+(I+1)),Z("/Root "+I+" 0 R"),Z("/Info "+(I-1)+" 0 R"),null!==p&&Z("/Encrypt "+_e.oid+" 0 R"),Z("/ID [ <"+A+"> <"+A+"> ]"),Z(">>")},ve=u.__private__.putHeader=function(){Z("%PDF-"+f),Z("%ºß¬à")},ye=u.__private__.putXRef=function(){var t="0000000000";Z("xref"),Z("0 "+(I+1)),Z("0000000000 65535 f ");for(var e=1;e<=I;e++)"function"==typeof D[e]?Z((t+D[e]()).slice(-10)+" 00000 n "):void 0!==D[e]?Z((t+D[e]).slice(-10)+" 00000 n "):Z("0000000000 00000 n ")},be=u.__private__.buildDocument=function(){B=I=0,M=[],D=[],R=[],Xt=Wt(),Gt=Wt(),W(M),At.publish("buildDocument"),ve(),Qt(),function(){At.publish("putAdditionalObjects");for(var t=0;t<R.length;t++){var e=R[t];Ht(e.objId,!0),Z(e.content),Z("endobj")}At.publish("postPutAdditionalObjects")}(),It(),null!==p&&(_e.oid=Ut(),Z("<<"),Z("/Filter /Standard"),Z("/V "+_e.v),Z("/R "+_e.r),Z("/U <"+_e.toHexString(_e.U)+">"),Z("/O <"+_e.toHexString(_e.O)+">"),Z("/P "+_e.P),Z(">>"),Z("endobj")),pe(),ge();var t=B;return ye(),me(),Z("startxref"),Z(""+t),Z("%%EOF"),W(z[j]),M.join("\n")},we=u.__private__.getBlob=function(t){return new Blob([V(t)],{type:"application/pdf"})},xe=u.output=u.__private__.output=((qt=function(t,e){switch("string"==typeof(e=e||{})?e={filename:e}:e.filename=e.filename||"generated.pdf",t){case void 0:return be();case"save":u.save(e.filename);break;case"arraybuffer":return V(be());case"blob":return we(be());case"bloburi":case"bloburl":if(void 0!==li.URL&&"function"==typeof li.URL.createObjectURL)return li.URL&&li.URL.createObjectURL(we(be()))||void 0;ui.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var i="",n=be();try{i=pi(n)}catch(t){i=pi(unescape(encodeURIComponent(n)))}return"data:application/pdf;filename="+e.filename+";base64,"+i;case"pdfobjectnewwindow":if("[object Window]"!==Object.prototype.toString.call(li))throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");var i='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+(e.pdfObjectUrl||"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js")+'"><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(e)+");<\/script></body></html>",r=li.open();return null!==r&&r.document.write(i),r;case"pdfjsnewwindow":if("[object Window]"!==Object.prototype.toString.call(li))throw new Error("The option pdfjsnewwindow just works in a browser-environment.");var o,s='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(e.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+e.filename+'" width="500px" height="400px" /></body></html>',a=li.open();return null!==a&&(a.document.write(s),o=this,a.document.documentElement.querySelector("#pdfViewer").onload=function(){a.document.title=e.filename,a.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(o.output("bloburl"))}),a;case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(li))throw new Error("The option dataurlnewwindow just works in a browser-environment.");r='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",e)+'"></iframe></body></html>',s=li.open();if(null!==s&&(s.document.write(r),s.document.title=e.filename),s||"undefined"==typeof safari)return s;break;case"datauri":case"dataurl":return li.document.location.href=this.output("datauristring",e);default:return null}}).foo=function(){try{return qt.apply(this,arguments)}catch(t){var e=t.stack||"",e="Error in function "+(e=~e.indexOf(" at ")?e.split(" at ")[1]:e).split("\n")[0].split("<")[0]+": "+t.message;if(!li.console)throw new Error(e);li.console.error(e,t),li.alert&&alert(e)}},(qt.foo.bar=qt).foo);switch(e){case"pt":ut=1;break;case"mm":ut=72/25.4;break;case"cm":ut=72/2.54;break;case"in":ut=72;break;case"px":ut=1==zt("px_scaling")?.75:96/72;break;case"pc":case"em":ut=12;break;case"ex":ut=6;break;default:throw new Error("Invalid unit: "+e)}var _e=null;O(),T();var Se=u.__private__.getPageInfo=u.getPageInfo=function(t){if(isNaN(t)||t%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ct[t].objId,pageNumber:t,pageContext:Ct[t]}},Ce=u.__private__.getPageInfoByObjId=function(t){if(isNaN(t)||t%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var e in Ct)if(Ct[e].objId===t)break;return Se(e)},Ae=u.__private__.getCurrentPageInfo=u.getCurrentPageInfo=function(){return{objId:Ct[j].objId,pageNumber:j,pageContext:Ct[j]}};u.addPage=function(){return Bt.apply(this,arguments),this},u.setPage=function(){return fe.apply(this,arguments),W.call(this,z[j]),this},u.insertPage=function(t){return this.addPage(),this.movePage(j,t),this},u.movePage=function(t,e){if(e<t){for(var i=z[t],n=Ct[t],r=t;e<r;r--)z[r]=z[r-1],Ct[r]=Ct[r-1];z[e]=i,Ct[e]=n,this.setPage(e)}else if(t<e){i=z[t],n=Ct[t];for(var o=t;o<e;o++)z[o]=z[o+1],Ct[o]=Ct[o+1];z[e]=i,Ct[e]=n,this.setPage(e)}return this},u.deletePage=function(){return function(t){0<t&&t<=St&&(z.splice(t,1),Ct.splice(t,1),--St<j&&(j=St),this.setPage(j))}.apply(this,arguments),this},u.__private__.text=u.text=function(t,e,i,n,r){var o=(n=n||{}).scope||this;if("number"!=typeof t||"number"!=typeof e||"string"!=typeof i&&!Array.isArray(i)||(u=i,i=e,e=t,t=u),arguments[3]instanceof Ot==0?(_=r,C=arguments[5],"object"==typeof(k=arguments[3])&&null!==k||("string"==typeof _&&(C=_,_=null),"string"==typeof k&&(C=k,k=null),"number"==typeof k&&(_=k,k=null),n={flags:k,angle:_,align:C})):(K("The transform parameter of text() with a Matrix value"),v=r),isNaN(e)||isNaN(i)||null==t)throw new Error("Invalid arguments passed to jsPDF.text");if(0===t.length)return o;var s="",a="number"==typeof n.lineHeightFactor?n.lineHeightFactor:Be,h=o.internal.scaleFactor;function c(t){for(var e,i=t.concat(),n=[],r=i.length;r--;)"string"==typeof(e=i.shift())?n.push(e):Array.isArray(t)&&(1===e.length||void 0===e[1]&&void 0===e[2])?n.push(e[0]):n.push([e[0],e[1],e[2]]);return n}function l(t,e){var i;if("string"==typeof t)i=e(t)[0];else if(Array.isArray(t)){for(var n,r=t.concat(),o=[],s=r.length;s--;)"string"==typeof(n=r.shift())?o.push(e(n)[0]):Array.isArray(n)&&"string"==typeof n[0]&&(n=e(n[0],n[1],n[2]),o.push([n[0],n[1],n[2]]));i=o}return i}var u=!1,f=!0;if("string"==typeof t)u=!0;else if(Array.isArray(t)){for(var d,p=t.concat(),g=[],m=p.length;m--;)("string"!=typeof(d=p.shift())||Array.isArray(d)&&"string"!=typeof d[0])&&(f=!1);u=f}if(!1===u)throw new Error('Type of text must be string or Array. "'+t+'" is not recognized.');"string"==typeof t&&(t=t.match(/[\r?\n]/)?t.split(/\r\n|\r|\n/g):[t]);var v,y=tt/o.internal.scaleFactor,b=y*(Be-1);switch(n.baseline){case"bottom":i-=b;break;case"top":i+=y-b;break;case"hanging":i+=y-2*b;break;case"middle":i+=y/2-b}0<(D=n.maxWidth||0)&&("string"==typeof t?t=o.splitTextToSize(t,D):"[object Array]"===Object.prototype.toString.call(t)&&(t=t.reduce(function(t,e){return t.concat(o.splitTextToSize(e,D))},[]))),r={text:t,x:e,y:i,options:n,mutex:{pdfEscape:le,activeFontKey:lt,fonts:gt,activeFontSize:tt}},At.publish("preProcessText",r),t=r.text,_=(n=r.options).angle,v instanceof Ot==0&&_&&"number"==typeof _?(_*=Math.PI/180,0===n.rotationDirection&&(_=-_),Y===G.ADVANCED&&(_=-_),x=Math.cos(_),u=Math.sin(_),v=new Ot(x,u,-u,x,0,0)):_&&_ instanceof Ot&&(v=_),Y!==G.ADVANCED||v||(v=jt),void 0!==(T=n.charSpace||Je)&&(s+=J($(T))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),n.lang;var w=-1,x=void 0!==n.renderingMode?n.renderingMode:n.stroke,_=o.internal.getCurrentPageInfo().pageContext;switch(x){case 0:case!1:case"fill":w=0;break;case 1:case!0:case"stroke":w=1;break;case 2:case"fillThenStroke":w=2;break;case 3:case"invisible":w=3;break;case 4:case"fillAndAddForClipping":w=4;break;case 5:case"strokeAndAddPathForClipping":w=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":w=6;break;case 7:case"addToPathForClipping":w=7}x=void 0!==_.usedRenderingMode?_.usedRenderingMode:-1;-1!==w?s+=w+" Tr\n":-1!==x&&(s+="0 Tr\n"),-1!==w&&(_.usedRenderingMode=w);var S,C=n.align||"left",A=tt*a,_=o.internal.pageSize.getWidth(),L=gt[lt],T=n.charSpace||Je;D=n.maxWidth||0;var P,k=Object.assign({autoencode:!0,noBOM:!0},n.flags),O=[];if("[object Array]"===Object.prototype.toString.call(t)){g=c(t),"left"!==C&&(S=g.map(function(t){return o.getStringUnitWidth(t,{font:L,charSpace:T,fontSize:tt,doKerning:!1})*tt/h}));var N,j=0;if("right"===C){e-=S[0],t=[];for(var m=g.length,F=0;F<m;F++)P=0===F?(N=He(e),Ve(i)):(N=$(j-S[F]),-A),t.push([g[F],N,P]),j=S[F]}else if("center"===C){e-=S[0]/2,t=[],m=g.length;for(var E=0;E<m;E++)P=0===E?(N=He(e),Ve(i)):(N=$((j-S[E])/2),-A),t.push([g[E],N,P]),j=S[E]}else if("left"===C){t=[],m=g.length;for(var I=0;I<m;I++)t.push(g[I])}else{if("justify"!==C)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');t=[],m=g.length;for(var D=0!==D?D:_,M=0;M<m;M++)P=0===M?Ve(i):-A,N=0===M?He(e):0,M<m-1&&O.push(J($((D-S[M])/(g[M].split(" ").length-1)))),t.push([g[M],N,P])}}r={text:t=!0===("boolean"==typeof n.R2L?n.R2L:nt)?l(t,function(t,e,i){return[t.split("").reverse().join(""),e,i]}):t,x:e,y:i,options:n,mutex:{pdfEscape:le,activeFontKey:lt,fonts:gt,activeFontSize:tt}},At.publish("postProcessText",r),t=r.text;var B=r.mutex.isHex||!1,r=gt[lt].encoding;g=c(t="WinAnsiEncoding"===r||"StandardEncoding"===r?l(t,function(t,e,i){return[(t=(t=t).split("\t").join(Array(n.TabLen||9).join(" ")),le(t,k)),e,i]}):t),t=[];for(var R,z,q,U=Array.isArray(g[0])?1:0,W="",H=function(t,e,i){return i instanceof Ot?(i="number"==typeof n.angle?Nt(i,new Ot(1,0,0,1,t,e)):Nt(new Ot(1,0,0,1,t,e),i),(i=Y===G.ADVANCED?Nt(new Ot(1,0,0,-1,0,0),i):i).join(" ")+" Tm\n"):J(t)+" "+J(e)+" Td\n"},V=0;V<g.length;V++){switch(W="",U){case 1:q=(B?"<":"(")+g[V][0]+(B?">":")"),R=parseFloat(g[V][1]),z=parseFloat(g[V][2]);break;case 0:q=(B?"<":"(")+g[V]+(B?">":")"),R=He(e),z=Ve(i)}void 0!==O&&void 0!==O[V]&&(W=O[V]+" Tw\n"),0===V?t.push(W+H(R,z,v)+q):0==U?t.push(W+q):1==U&&t.push(W+H(R,z,v)+q)}t=0==U?t.join(" Tj\nT* "):t.join(" Tj\n"),t+=" Tj\n";r="BT\n/";return r+=lt+" "+tt+" Tf\n",r+=J(tt*a)+" TL\n",r+=Ke+"\n",r+=s,r+=t,Z(r+="ET"),X[lt]=!0,o};var Le=u.__private__.clip=u.clip=function(t){return Z("evenodd"===t?"W*":"W"),this};u.clipEvenOdd=function(){return Le("evenodd")},u.__private__.discardPath=u.discardPath=function(){return Z("n"),this};var Te=u.__private__.isValidStyle=function(t){var e=!1;return e=-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(t)?!0:e};u.__private__.setDefaultPathOperation=u.setDefaultPathOperation=function(t){return Te(t)&&(c=t),this};var Pe=u.__private__.getStyle=u.getStyle=function(t){var e=c;switch(t){case"D":case"S":e="S";break;case"F":e="f";break;case"FD":case"DF":e="B";break;case"f":case"f*":case"B":case"B*":e=t}return e},ke=u.close=function(){return Z("h"),this};u.stroke=function(){return Z("S"),this},u.fill=function(t){return Ne("f",t),this},u.fillEvenOdd=function(t){return Ne("f*",t),this},u.fillStroke=function(t){return Ne("B",t),this},u.fillStrokeEvenOdd=function(t){return Ne("B*",t),this};function Oe(t){null===t||Y===G.ADVANCED&&void 0===t||(t=Pe(t),Z(t))}var Ne=function(t,e){"object"==typeof e?je(e,t):Z(t)};var je=function(t,e){var i,n=bt[t.key],r=yt[n];r instanceof yi?(Z("q"),Z(Fe(e)),r.gState&&u.setGState(r.gState),Z(t.matrix.toString()+" cm"),Z("/"+n+" sh"),Z("Q")):r instanceof bi&&(i=new Ot(1,0,0,-1,0,ai()),t.matrix&&(i=i.multiply(t.matrix||jt),n=function(t,e,i,n,r){return(r=new bi(e||this.boundingBox,i||this.xStep,n||this.yStep,this.gState,r||this.matrix)).stream=this.stream,t=t+"$$"+this.cloneIndex+++"$$",Ft(t,r),r}.call(r,t.key,t.boundingBox,t.xStep,t.yStep,i).id),Z("q"),Z("/Pattern cs"),Z("/"+n+" scn"),r.gState&&u.setGState(r.gState),Z(e),Z("Q"))},Fe=function(t){switch(t){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Ee=u.moveTo=function(t,e){return Z(J($(t))+" "+J(w(e))+" m"),this},Ie=u.lineTo=function(t,e){return Z(J($(t))+" "+J(w(e))+" l"),this},De=u.curveTo=function(t,e,i,n,r,o){return Z([J($(t)),J(w(e)),J($(i)),J(w(n)),J($(r)),J(w(o)),"c"].join(" ")),this};u.__private__.line=u.line=function(t,e,i,n,r){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n)||!Te(r))throw new Error("Invalid arguments passed to jsPDF.line");return Y===G.COMPAT?this.lines([[i-t,n-e]],t,e,[1,1],r||"S"):this.lines([[i-t,n-e]],t,e,[1,1]).stroke()},u.__private__.lines=u.lines=function(t,e,i,n,r,o){var s,a,h,c,l,u,f,d,p,g,m,v;if("number"==typeof t&&(v=i,i=e,e=t,t=v),n=n||[1,1],o=o||!1,isNaN(e)||isNaN(i)||!Array.isArray(t)||!Array.isArray(n)||!Te(r)||"boolean"!=typeof o)throw new Error("Invalid arguments passed to jsPDF.lines");for(Ee(e,i),s=n[0],a=n[1],c=t.length,g=e,m=i,h=0;h<c;h++)2===(l=t[h]).length?(g=l[0]*s+g,m=l[1]*a+m,Ie(g,m)):(u=l[0]*s+g,f=l[1]*a+m,d=l[2]*s+g,p=l[3]*a+m,g=l[4]*s+g,m=l[5]*a+m,De(u,f,d,p,g,m));return o&&ke(),Oe(r),this},u.path=function(t){for(var e=0;e<t.length;e++){var i=t[e],n=i.c;switch(i.op){case"m":Ee(n[0],n[1]);break;case"l":Ie(n[0],n[1]);break;case"c":De.apply(this,n);break;case"h":ke()}}return this},u.__private__.rect=u.rect=function(t,e,i,n,r){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n)||!Te(r))throw new Error("Invalid arguments passed to jsPDF.rect");return Y===G.COMPAT&&(n=-n),Z([J($(t)),J(w(e)),J($(i)),J($(n)),"re"].join(" ")),Oe(r),this},u.__private__.triangle=u.triangle=function(t,e,i,n,r,o,s){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n)||isNaN(r)||isNaN(o)||!Te(s))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[i-t,n-e],[r-i,o-n],[t-r,e-o]],t,e,[1,1],s,!0),this},u.__private__.roundedRect=u.roundedRect=function(t,e,i,n,r,o,s){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n)||isNaN(r)||isNaN(o)||!Te(s))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var a=4/3*(Math.SQRT2-1);return r=Math.min(r,.5*i),o=Math.min(o,.5*n),this.lines([[i-2*r,0],[r*a,0,r,o-o*a,r,o],[0,n-2*o],[0,o*a,-r*a,o,-r,o],[2*r-i,0],[-r*a,0,-r,-o*a,-r,-o],[0,2*o-n],[0,-o*a,r*a,-o,r,-o]],t+r,e,[1,1],s,!0),this},u.__private__.ellipse=u.ellipse=function(t,e,i,n,r){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n)||!Te(r))throw new Error("Invalid arguments passed to jsPDF.ellipse");var o=4/3*(Math.SQRT2-1)*i,s=4/3*(Math.SQRT2-1)*n;return Ee(t+i,e),De(t+i,e-s,t+o,e-n,t,e-n),De(t-o,e-n,t-i,e-s,t-i,e),De(t-i,e+s,t-o,e+n,t,e+n),De(t+o,e+n,t+i,e+s,t+i,e),Oe(r),this},u.__private__.circle=u.circle=function(t,e,i,n){if(isNaN(t)||isNaN(e)||isNaN(i)||!Te(n))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(t,e,i,i,n)},u.setFont=function(t,e,i){return i&&(e=b(e,i)),lt=Rt(t,e,{disableWarning:!1}),this};var Me=u.__private__.getFont=u.getFont=function(){return gt[Rt.apply(u,arguments)]};u.__private__.getFontList=u.getFontList=function(){var t,e,i={};for(t in mt)if(mt.hasOwnProperty(t))for(e in i[t]=[],mt[t])mt[t].hasOwnProperty(e)&&i[t].push(e);return i},u.addFont=function(t,e,i,n,r){var o=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return n&&-1!==o.indexOf(n)?r=n:n&&-1==o.indexOf(n)&&(i=b(i,n)),Mt.call(this,t,e,i,r=r||"Identity-H")};var Be,Re=t.lineWidth||.200025,ze=u.__private__.setLineWidth=u.setLineWidth=function(t){return Z(J($(t))+" w"),this};u.__private__.setLineDash=wi.API.setLineDash=wi.API.setLineDashPattern=function(t,e){if(t=t||[],e=e||0,isNaN(e)||!Array.isArray(t))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return t=t.map(function(t){return J($(t))}).join(" "),e=J($(e)),Z("["+t+"] "+e+" d"),this};var qe=u.__private__.getLineHeight=u.getLineHeight=function(){return tt*Be};u.__private__.getLineHeight=u.getLineHeight=function(){return tt*Be};var Ue=u.__private__.setLineHeightFactor=u.setLineHeightFactor=function(t){return"number"==typeof(t=t||1.15)&&(Be=t),this},We=u.__private__.getLineHeightFactor=u.getLineHeightFactor=function(){return Be};Ue(t.lineHeight);var He=u.__private__.getHorizontalCoordinate=function(t){return $(t)},Ve=u.__private__.getVerticalCoordinate=function(t){return Y===G.ADVANCED?t:Ct[j].mediaBox.topRightY-Ct[j].mediaBox.bottomLeftY-$(t)},Xe=u.__private__.getHorizontalCoordinateString=u.getHorizontalCoordinateString=function(t){return J(He(t))},n=u.__private__.getVerticalCoordinateString=u.getVerticalCoordinateString=function(t){return J(Ve(t))},Ge=t.strokeColor||"0 G";u.__private__.getStrokeColor=u.getDrawColor=function(){return Yt(Ge)},u.__private__.setStrokeColor=u.setDrawColor=function(t,e,i,n){return Ge=Kt({ch1:t,ch2:e,ch3:i,ch4:n,pdfColorType:"draw",precision:2}),Z(Ge),this};var Ye=t.fillColor||"0 g";u.__private__.getFillColor=u.getFillColor=function(){return Yt(Ye)},u.__private__.setFillColor=u.setFillColor=function(t,e,i,n){return Ye=Kt({ch1:t,ch2:e,ch3:i,ch4:n,pdfColorType:"fill",precision:2}),Z(Ye),this};var Ke=t.textColor||"0 g",Ue=u.__private__.getTextColor=u.getTextColor=function(){return Yt(Ke)};u.__private__.setTextColor=u.setTextColor=function(t,e,i,n){return Ke=Kt({ch1:t,ch2:e,ch3:i,ch4:n,pdfColorType:"text",precision:3}),this};var Je=t.charSpace,t=u.__private__.getCharSpace=u.getCharSpace=function(){return parseFloat(Je||0)};u.__private__.setCharSpace=u.setCharSpace=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Je=t,this};var $e=0;u.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},u.__private__.setLineCap=u.setLineCap=function(t){var e=u.CapJoinStyles[t];if(void 0===e)throw new Error("Line cap style of '"+t+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Z(($e=e)+" J"),this};var Ze=0;u.__private__.setLineJoin=u.setLineJoin=function(t){var e=u.CapJoinStyles[t];if(void 0===e)throw new Error("Line join style of '"+t+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Z((Ze=e)+" j"),this},u.__private__.setLineMiterLimit=u.__private__.setMiterLimit=u.setLineMiterLimit=u.setMiterLimit=function(t){if(t=t||0,isNaN(t))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Z(J($(t))+" M"),this},u.GState=vi,u.setGState=function(t){(t="string"==typeof t?wt[xt[t]]:Qe(null,t)).equals(_t)||(Z("/"+t.id+" gs"),_t=t)};var Qe=function(t,e){if(!t||!xt[t]){var i,n,r=!1;for(i in wt)if(wt.hasOwnProperty(i)&&wt[i].equals(e)){r=!0;break}return r?e=wt[i]:(n="GS"+(Object.keys(wt).length+1).toString(10),(wt[n]=e).id=n),t&&(xt[t]=e.id),At.publish("addGState",e),e}};u.addGState=function(t,e){return Qe(t,e),this},u.saveGraphicsState=function(){return Z("q"),vt.push({key:lt,size:tt,color:Ke}),this},u.restoreGraphicsState=function(){Z("Q");var t=vt.pop();return lt=t.key,tt=t.size,Ke=t.color,_t=null,this},u.setCurrentTransformationMatrix=function(t){return Z(t.toString()+" cm"),this},u.comment=function(t){return Z("#"+t),this};function ti(){this.page=St,this.currentPage=j,this.pages=z.slice(0),this.pagesContext=Ct.slice(0),this.x=ft,this.y=dt,this.matrix=pt,this.width=oi(j),this.height=ai(j),this.outputDestination=U,this.id="",this.objectNumber=-1}var ei=function(t,e){var i=t||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return i},set:function(t){isNaN(t)||(i=parseFloat(t))}});var n=e||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return n},set:function(t){isNaN(t)||(n=parseFloat(t))}});var r="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return r},set:function(t){r=t.toString()}}),this},ii=function(t,e,i,n){ei.call(this,t,e),this.type="rect";var r=i||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return r},set:function(t){isNaN(t)||(r=parseFloat(t))}});var o=n||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return o},set:function(t){isNaN(t)||(o=parseFloat(t))}}),this};ti.prototype.restore=function(){St=this.page,j=this.currentPage,Ct=this.pagesContext,z=this.pages,ft=this.x,dt=this.y,pt=this.matrix,si(j,this.width),hi(j,this.height),U=this.outputDestination};var ni,ri=function(t,e,i,n,r){kt.push(new ti),St=j=0,z=[],ft=t,dt=e,pt=r,ue([i,n])};for(ni in u.beginFormObject=function(t,e,i,n,r){return ri(t,e,i,n,r),this},u.endFormObject=function(t){return Pt[e=t]||(i=new ti,t="Xo"+(Object.keys(Tt).length+1).toString(10),i.id=t,Pt[e]=t,Tt[t]=i,At.publish("addFormObject",i),kt.pop().restore()),this;var e,i},u.doFormObject=function(t,e){t=Tt[Pt[t]];return Z("q"),Z(e.toString()+" cm"),Z("/"+t.id+" Do"),Z("Q"),this},u.getFormObject=function(t){t=Tt[Pt[t]];return{x:t.x,y:t.y,width:t.width,height:t.height,matrix:t.matrix}},u.save=function(n,t){return n=n||"generated.pdf",(t=t||{}).returnPromise=t.returnPromise||!1,!1===t.returnPromise?(fi(we(be()),n),"function"==typeof fi.unload&&li.setTimeout&&setTimeout(fi.unload,911),this):new ci(function(t,e){try{var i=fi(we(be()),n);"function"==typeof fi.unload&&li.setTimeout&&setTimeout(fi.unload,911),t(i)}catch(t){e(t.message)}})},wi.API)wi.API.hasOwnProperty(ni)&&("events"===ni&&wi.API.events.length?function(t,e){for(var i,n,r=e.length-1;-1!==r;r--)i=e[r][0],n=e[r][1],t.subscribe.apply(t,[i].concat("function"==typeof n?[n]:n))}(At,wi.API.events):u[ni]=wi.API[ni]);var oi=u.getPageWidth=function(t){return(Ct[t=t||j].mediaBox.topRightX-Ct[t].mediaBox.bottomLeftX)/ut},si=u.setPageWidth=function(t,e){Ct[t].mediaBox.topRightX=e*ut+Ct[t].mediaBox.bottomLeftX},ai=u.getPageHeight=function(t){return(Ct[t=t||j].mediaBox.topRightY-Ct[t].mediaBox.bottomLeftY)/ut},hi=u.setPageHeight=function(t,e){Ct[t].mediaBox.topRightY=e*ut+Ct[t].mediaBox.bottomLeftY};return u.internal={pdfEscape:le,getStyle:Pe,getFont:Me,getFontSize:it,getCharSpace:t,getTextColor:Ue,getLineHeight:qe,getLineHeightFactor:We,write:H,getHorizontalCoordinate:He,getVerticalCoordinate:Ve,getCoordinateString:Xe,getVerticalCoordinateString:n,collections:{},newObject:Ut,newAdditionalObject:Vt,newObjectDeferred:Wt,newObjectDeferredBegin:Ht,getFilters:Jt,putStream:$t,events:At,scaleFactor:ut,pageSize:{getWidth:function(){return oi(j)},setWidth:function(t){si(j,t)},getHeight:function(){return ai(j)},setHeight:function(t){hi(j,t)}},encryptionOptions:p,encryption:_e,getEncryptor:function(t){return null!==p?_e.encryptor(t,0):function(t){return t}},output:xe,getNumberOfPages:de,pages:z,out:Z,f2:_,f3:S,getPageInfo:Se,getPageInfoByObjId:Ce,getCurrentPageInfo:Ae,getPDFVersion:d,Point:ei,Rectangle:ii,Matrix:Ot,hasHotfix:zt},Object.defineProperty(u.internal.pageSize,"width",{get:function(){return oi(j)},set:function(t){si(j,t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.internal.pageSize,"height",{get:function(){return ai(j)},set:function(t){hi(j,t)},enumerable:!0,configurable:!0}),function(t){for(var e=0,i=Q.length;e<i;e++){var n=Mt.call(this,t[e][0],t[e][1],t[e][2],Q[e][3],!0);!1===l&&(X[n]=!0);var r=t[e][0].split("-");Dt({id:n,fontName:r[0],fontStyle:r[1]||""})}At.publish("addFonts",{fonts:gt,dictionary:mt})}.call(u,Q),lt="F1",Bt(o,r),At.publish("initialized"),u}gi.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},gi.prototype.toHexString=function(t){return t.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},gi.prototype.hexToBytes=function(t){for(var e=[],i=0;i<t.length;i+=2)e.push(String.fromCharCode(parseInt(t.substr(i,2),16)));return e.join("")},gi.prototype.processOwnerPassword=function(t,e){return T(C(e).substr(0,5),t)},gi.prototype.encryptor=function(t,e){let i=C(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(t){return T(i,t)}},vi.prototype.equals=function(t){var e,i="id,objectNumber,equals";if(!t||typeof t!=typeof this)return!1;var n=0;for(e in this)if(!(0<=i.indexOf(e))){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e))return!1;if(this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&i.indexOf(e)<0&&n--;return 0===n},wi.API={events:[]},wi.version="2.3.1";function O(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")}function N(t){return t.toFixed(2)}function j(t){return t.toFixed(5)}var i=wi.API,F=1,E=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")};i.__acroform__={};function ft(t){return t*F}function dt(t){var e=new Tt,i=qt.internal.getHeight(t)||0,t=qt.internal.getWidth(t)||0;return e.BBox=[0,0,Number(N(t)),Number(N(i))],e}function pt(n,t){var e=0===n.fontSize?n.maxFontSize:n.fontSize,i={text:"",fontSize:""},r=(t=")"==(t="("==t.substr(0,1)?t.substr(1):t).substr(t.length-1)?t.substr(0,t.length-1):t).split(" "),o=e,s=(s=qt.internal.getHeight(n)||0)<0?-s:s,a=(a=qt.internal.getWidth(n)||0)<0?-a:a;o++;t:for(;0<o;){t="";var h,c,l=gt("3",n,--o).height,u=n.multiline?s-o:(s-l)/2,f=u+=2,d=0,p=0;if(o<=0){t="(...) Tj\n",t+="% Width of Text: "+gt(t,n,o=12).width+", FieldWidth:"+a+"\n";break}var g,m="",v=0;for(g in r)if(r.hasOwnProperty(g)){var m=" "==(m+=r[g]+" ").substr(m.length-1)?m.substr(0,m.length-1):m,y=parseInt(g),b=function(t,e,i){if(t+1<r.length){t=e+" "+r[t+1];return gt(t,n,i).width<=a-4}return!1}(y,m,o),w=g>=r.length-1;if(b&&!w){m+=" ";continue}if(b||w){if(w)p=y;else if(n.multiline&&s<(l+2)*(v+2)+2)continue t}else{if(!n.multiline)continue t;if(s<(l+2)*(v+2)+2)continue t;p=y}for(var x="",_=d;_<=p;_++)x+=r[_]+" ";switch(x=" "==x.substr(x.length-1)?x.substr(0,x.length-1):x,c=gt(x,n,o).width,n.textAlign){case"right":h=a-c-2;break;case"center":h=(a-c)/2;break;default:h=2}t+=N(h)+" "+N(f)+" Td\n",t+="("+E(x)+") Tj\n",t+=-N(h)+" 0 Td\n",f=-(o+2),c=0,d=p+1,v++,m=""}break}return i.text=t,i.fontSize=o,i}function gt(t,e,i){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),t=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(i),charSpace:0})*parseFloat(i);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(i),charSpace:0})*parseFloat(i)*1.5,width:t}}function mt(t,e,i){var n=function(t){return t};return void 0!==e&&i&&(n=i.internal.getEncryptor(e)),(t=t||"").toString(),"("+E(n(t))+")"}function vt(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})}var e=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},yt=i.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},bt=i.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},wt=i.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return 0==(t&1<<e)?0:1},xt=i.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return wt(t,e-1)},_t=i.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return yt(t,e-1)},St=i.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return bt(t,e-1)},Ct=i.__acroform__.calculateCoordinates=function(t,e){var i=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,r=t[0],o=t[1],s=t[2],e=t[3],t={};return t.lowerLeft_X=i(r)||0,t.lowerLeft_Y=n(o+e)||0,t.upperRight_X=i(r+s)||0,t.upperRight_Y=n(o)||0,[Number(N(t.lowerLeft_X)),Number(N(t.lowerLeft_Y)),Number(N(t.upperRight_X)),Number(N(t.upperRight_Y))]},At={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Lt=i.__acroform__.arrayToPdfArray=function(t,e,i){var n=function(t){return t};if(Array.isArray(t)){for(var r="[",o=0;o<t.length;o++)switch(0!==o&&(r+=" "),typeof t[o]){case"boolean":case"number":case"object":r+=t[o].toString();break;case"string":"/"!==t[o].substr(0,1)?(void 0!==e&&i&&(n=i.internal.getEncryptor(e)),r+="("+E(n(t[o].toString()))+")"):r+=t[o].toString()}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")};vt.prototype.toString=function(){return this.objId+" 0 R"},vt.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},vt.prototype.getKeyValueListForStream=function(){var t,e,i,n=[],r=Object.getOwnPropertyNames(this).filter(function(t){return"content"!=t&&"appearanceStreamContent"!=t&&"scope"!=t&&"objId"!=t&&"_"!=t.substring(0,1)});for(t in r)!1!==Object.getOwnPropertyDescriptor(this,r[t]).configurable||(i=this[e=r[t]])&&(Array.isArray(i)?n.push({key:e,value:Lt(i,this.objId,this.scope)}):i instanceof vt?(i.scope=this.scope,n.push({key:e,value:i.objId+" 0 R"})):"function"!=typeof i&&n.push({key:e,value:i}));return n};function Tt(){vt.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,i=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return i},set:function(t){i=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})}e(Tt,vt);function Pt(){vt.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return 0<t.length?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(t){return t};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+E(t(e))+")"}},set:function(t){e=t}})}e(Pt,vt);function kt(){vt.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){if(isNaN(t))throw new Error('Invalid value "'+t+'" for attribute F supplied.');e=t}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(e,3))},set:function(t){!0===Boolean(t)?this.F=_t(e,3):this.F=St(e,3)}});var i=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return i},set:function(t){if(isNaN(t))throw new Error('Invalid value "'+t+'" for attribute Ff supplied.');i=t}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==n.length)return n},set:function(t){n=void 0!==t?t:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(t){n[0]=t}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(t){n[1]=t}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(t){n[2]=t}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(t){n[3]=t}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){switch(t){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=t;break;default:throw new Error('Invalid value "'+t+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof Mt)return;o="FieldObject"+kt.FieldNum++}var t=function(t){return t};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+E(t(o))+")"},set:function(t){o=t.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(t){o=t}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(t){s=t}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(t){a=t}});var h=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return h},set:function(t){h=t}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===c?50/F:c},set:function(t){c=t}});var l="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return l},set:function(t){l=t}});var u="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!u||this instanceof Mt||this instanceof Rt))return mt(u,this.objId,this.scope)},set:function(t){t=t.toString(),u=t}});var f=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Et==0?mt(f,this.objId,this.scope):f},set:function(t){t=t.toString(),f=this instanceof Et==0?"("===t.substr(0,1)?O(t.substr(1,t.length-2)):O(t):t}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Et==1?O(f.substr(1,f.length-1)):f},set:function(t){t=t.toString(),f=this instanceof Et==1?"/"+t:t}});var d=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d)return d},set:function(t){this.V=t}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof Et==0?mt(d,this.objId,this.scope):d},set:function(t){t=t.toString(),d=this instanceof Et==0?"("===t.substr(0,1)?O(t.substr(1,t.length-2)):O(t):t}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Et==1?O(d.substr(1,d.length-1)):d},set:function(t){t=t.toString(),d=this instanceof Et==1?"/"+t:t}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var p,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(t){t=Boolean(t),g=t}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(p)return p},set:function(t){p=t}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,1))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,1):this.Ff=St(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,2))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,2):this.Ff=St(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,3))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,3):this.Ff=St(this.Ff,3)}});var m=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==m)return m},set:function(t){if(-1===[0,1,2].indexOf(t))throw new Error('Invalid value "'+t+'" for attribute Q supplied.');m=t}}),Object.defineProperty(this,"textAlign",{get:function(){var t;switch(m){case 0:default:t="left";break;case 1:t="center";break;case 2:t="right"}return t},configurable:!0,enumerable:!0,set:function(t){switch(t){case"right":case 2:m=2;break;case"center":case 1:m=1;break;default:m=0}}})}e(kt,vt);var Ot=function(){kt.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var i=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Lt(i,this.objId,this.scope)},set:function(t){var e=[];"string"==typeof t&&(e=function(t,e,i){i=i||1;for(var n,r=[];n=e.exec(t);)r.push(n[i]);return r}(t,/\((.*?)\)/g)),i=e}}),this.getOptions=function(){return i},this.setOptions=function(t){i=t,this.sort&&i.sort()},this.addOption=function(t){t=(t=t||"").toString(),i.push(t),this.sort&&i.sort()},this.removeOption=function(t,e){for(e=e||!1,t=(t=t||"").toString();-1!==i.indexOf(t)&&(i.splice(i.indexOf(t),1),!1!==e););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,18))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,18):this.Ff=St(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,19))},set:function(t){!0===this.combo&&(!0===Boolean(t)?this.Ff=_t(this.Ff,19):this.Ff=St(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,20))},set:function(t){!0===Boolean(t)?(this.Ff=_t(this.Ff,20),i.sort()):this.Ff=St(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,22))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,22):this.Ff=St(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,23))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,23):this.Ff=St(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,27))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,27):this.Ff=St(this.Ff,27)}}),this.hasAppearanceStream=!1};e(Ot,kt);var Nt=function(){Ot.call(this),this.fontName="helvetica",this.combo=!1};e(Nt,Ot);var jt=function(){Nt.call(this),this.combo=!0};e(jt,Nt);var Ft=function(){jt.call(this),this.edit=!0};e(Ft,jt);var Et=function(){kt.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,15))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,15):this.Ff=St(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,16))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,16):this.Ff=St(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,17))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,17):this.Ff=St(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,26))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,26):this.Ff=St(this.Ff,26)}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(t){return t};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(n).length){var e,i=[];for(e in i.push("<<"),n)i.push("/"+e+" ("+E(t(n[e]))+")");return i.push(">>"),i.join("\n")}},set:function(t){"object"==typeof t&&(n=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(t){"string"==typeof t&&(n.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};e(Et,kt);var It=function(){Et.call(this),this.pushButton=!0};e(It,Et);var Dt=function(){Et.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=void 0!==t?t:[]}})};e(Dt,Et);var Mt=function(){var e,i;kt.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return i},set:function(t){i=t}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(t){return t};this.scope&&(t=this.scope.internal.getEncryptor(this.objId));var e,i=[];for(e in i.push("<<"),r)i.push("/"+e+" ("+E(t(r[e]))+")");return i.push(">>"),i.join("\n")},set:function(t){"object"==typeof t&&(r=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(t){"string"==typeof t&&(r.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=qt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};e(Mt,kt),Dt.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t&&"getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)this.Kids.hasOwnProperty(e)&&((e=this.Kids[e]).appearanceStreamContent=t.createAppearanceStream(e.optionName),e.caption=t.getCA())},Dt.prototype.createOption=function(t){var e=new Mt;return e.Parent=this,e.optionName=t,this.Kids.push(e),Ut.call(this.scope,e),e};var Bt=function(){Et.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=qt.CheckBox.createAppearanceStream()};e(Bt,Et);var Rt=function(){kt.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,13))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,13):this.Ff=St(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,21))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,21):this.Ff=St(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,23))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,23):this.Ff=St(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,24))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,24):this.Ff=St(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,25))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,25):this.Ff=St(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,26))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,26):this.Ff=St(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};e(Rt,kt);var zt=function(){Rt.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(xt(this.Ff,14))},set:function(t){!0===Boolean(t)?this.Ff=_t(this.Ff,14):this.Ff=St(this.Ff,14)}}),this.password=!0};e(zt,Rt);var qt={CheckBox:{createAppearanceStream:function(){return{N:{On:qt.CheckBox.YesNormal},D:{On:qt.CheckBox.YesPushDown,Off:qt.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=dt(t);e.scope=t.scope;var i=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),o=pt(t,t.caption);return i.push("0.749023 g"),i.push("0 0 "+N(qt.internal.getWidth(t))+" "+N(qt.internal.getHeight(t))+" re"),i.push("f"),i.push("BMC"),i.push("q"),i.push("0 0 1 rg"),i.push("/"+n+" "+N(o.fontSize)+" Tf "+r),i.push("BT"),i.push(o.text),i.push("ET"),i.push("Q"),i.push("EMC"),e.stream=i.join("\n"),e},YesNormal:function(t){var e=dt(t);e.scope=t.scope;var i=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),r=[],o=qt.internal.getHeight(t),s=qt.internal.getWidth(t),t=pt(t,t.caption);return r.push("1 g"),r.push("0 0 "+N(s)+" "+N(o)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+N(s-1)+" "+N(o-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+i+" "+N(t.fontSize)+" Tf "+n),r.push(t.text),r.push("ET"),r.push("Q"),e.stream=r.join("\n"),e},OffPushDown:function(t){var e=dt(t);e.scope=t.scope;var i=[];return i.push("0.749023 g"),i.push("0 0 "+N(qt.internal.getWidth(t))+" "+N(qt.internal.getHeight(t))+" re"),i.push("f"),e.stream=i.join("\n"),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:qt.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=qt.RadioButton.Circle.YesNormal,e.D[t]=qt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=dt(t);e.scope=t.scope;var i=[],n=qt.internal.getWidth(t)<=qt.internal.getHeight(t)?qt.internal.getWidth(t)/4:qt.internal.getHeight(t)/4,n=Number((.9*n).toFixed(5)),r=qt.internal.Bezier_C,r=Number((n*r).toFixed(5));return i.push("q"),i.push("1 0 0 1 "+j(qt.internal.getWidth(t)/2)+" "+j(qt.internal.getHeight(t)/2)+" cm"),i.push(n+" 0 m"),i.push(n+" "+r+" "+r+" "+n+" 0 "+n+" c"),i.push("-"+r+" "+n+" -"+n+" "+r+" -"+n+" 0 c"),i.push("-"+n+" -"+r+" -"+r+" -"+n+" 0 -"+n+" c"),i.push(r+" -"+n+" "+n+" -"+r+" "+n+" 0 c"),i.push("f"),i.push("Q"),e.stream=i.join("\n"),e},YesPushDown:function(t){var e=dt(t);e.scope=t.scope;var i=[],n=qt.internal.getWidth(t)<=qt.internal.getHeight(t)?qt.internal.getWidth(t)/4:qt.internal.getHeight(t)/4,n=Number((.9*n).toFixed(5)),r=Number((2*n).toFixed(5)),o=Number((r*qt.internal.Bezier_C).toFixed(5)),s=Number((n*qt.internal.Bezier_C).toFixed(5));return i.push("0.749023 g"),i.push("q"),i.push("1 0 0 1 "+j(qt.internal.getWidth(t)/2)+" "+j(qt.internal.getHeight(t)/2)+" cm"),i.push(r+" 0 m"),i.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),i.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),i.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),i.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),i.push("f"),i.push("Q"),i.push("0 g"),i.push("q"),i.push("1 0 0 1 "+j(qt.internal.getWidth(t)/2)+" "+j(qt.internal.getHeight(t)/2)+" cm"),i.push(n+" 0 m"),i.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),i.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),i.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),i.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),i.push("f"),i.push("Q"),e.stream=i.join("\n"),e},OffPushDown:function(t){var e=dt(t);e.scope=t.scope;var i=[],n=qt.internal.getWidth(t)<=qt.internal.getHeight(t)?qt.internal.getWidth(t)/4:qt.internal.getHeight(t)/4,n=Number((.9*n).toFixed(5)),r=Number((2*n).toFixed(5)),n=Number((r*qt.internal.Bezier_C).toFixed(5));return i.push("0.749023 g"),i.push("q"),i.push("1 0 0 1 "+j(qt.internal.getWidth(t)/2)+" "+j(qt.internal.getHeight(t)/2)+" cm"),i.push(r+" 0 m"),i.push(r+" "+n+" "+n+" "+r+" 0 "+r+" c"),i.push("-"+n+" "+r+" -"+r+" "+n+" -"+r+" 0 c"),i.push("-"+r+" -"+n+" -"+n+" -"+r+" 0 -"+r+" c"),i.push(n+" -"+r+" "+r+" -"+n+" "+r+" 0 c"),i.push("f"),i.push("Q"),e.stream=i.join("\n"),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:qt.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=qt.RadioButton.Cross.YesNormal,e.D[t]=qt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=dt(t);e.scope=t.scope;var i=[],n=qt.internal.calculateCross(t);return i.push("q"),i.push("1 1 "+N(qt.internal.getWidth(t)-2)+" "+N(qt.internal.getHeight(t)-2)+" re"),i.push("W"),i.push("n"),i.push(N(n.x1.x)+" "+N(n.x1.y)+" m"),i.push(N(n.x2.x)+" "+N(n.x2.y)+" l"),i.push(N(n.x4.x)+" "+N(n.x4.y)+" m"),i.push(N(n.x3.x)+" "+N(n.x3.y)+" l"),i.push("s"),i.push("Q"),e.stream=i.join("\n"),e},YesPushDown:function(t){var e=dt(t);e.scope=t.scope;var i=qt.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+N(qt.internal.getWidth(t))+" "+N(qt.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+N(qt.internal.getWidth(t)-2)+" "+N(qt.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(N(i.x1.x)+" "+N(i.x1.y)+" m"),n.push(N(i.x2.x)+" "+N(i.x2.y)+" l"),n.push(N(i.x4.x)+" "+N(i.x4.y)+" m"),n.push(N(i.x3.x)+" "+N(i.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join("\n"),e},OffPushDown:function(t){var e=dt(t);e.scope=t.scope;var i=[];return i.push("0.749023 g"),i.push("0 0 "+N(qt.internal.getWidth(t))+" "+N(qt.internal.getHeight(t))+" re"),i.push("f"),e.stream=i.join("\n"),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+i},internal:{Bezier_C:.551915024494,calculateCross:function(t){var e=qt.internal.getWidth(t),i=qt.internal.getHeight(t),t=Math.min(e,i);return{x1:{x:(e-t)/2,y:(i-t)/2+t},x2:{x:(e-t)/2+t,y:(i-t)/2},x3:{x:(e-t)/2,y:(i-t)/2},x4:{x:(e-t)/2+t,y:(i-t)/2+t}}}}};qt.internal.getWidth=function(t){var e=0;return e="object"==typeof t?ft(t.Rect[2]):e},qt.internal.getHeight=function(t){var e=0;return e="object"==typeof t?ft(t.Rect[3]):e};var Ut=i.addField=function(t){if(function(e){if(void 0!==(t.scope=e).internal&&(void 0===e.internal.acroformPlugin||!1===e.internal.acroformPlugin.isInitialized)){if(kt.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(At)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");F=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Pt,(e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e).internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){var t;(t=e).internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0}),e.internal.events.subscribe("buildDocument",function(){!function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var e,i,n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(e in n)n.hasOwnProperty(e)&&((i=n[e]).objId=void 0,i.hasAnnotation&&function(t,e){var i={type:"reference",object:t};void 0===e.internal.getPageInfo(t.page).pageContext.annotations.find(function(t){return t.type===i.type&&t.object===i.object})&&e.internal.getPageInfo(t.page).pageContext.annotations.push(i)}(i,t))}(e)}),e.internal.events.subscribe("putCatalog",function(){!function(t){if(void 0===t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(e)}),e.internal.events.subscribe("postPutPages",function(t){!function(t,e){var i=!t;for(l in t||(e.internal.newObjectDeferredBegin(e.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),e.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),t=t||e.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(t.hasOwnProperty(l)){var n=t[l],r=[],o=n.Rect;if(n.Rect&&(n.Rect=Ct(n.Rect,e)),e.internal.newObjectDeferredBegin(n.objId,!0),n.DA=qt.createDefaultAppearanceStream(n),"object"==typeof n&&"function"==typeof n.getKeyValueListForStream&&(r=n.getKeyValueListForStream()),n.Rect=o,n.hasAppearanceStream&&!n.appearanceStreamContent&&(o=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],i=t._V||t.DV,n=pt(t,i),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+N(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");n=dt(t);return n.scope=t.scope,n.stream=e.join("\n"),n}}(n),r.push({key:"AP",value:"<</N "+o+">>"}),e.internal.acroformPlugin.xForms.push(o)),n.appearanceStreamContent){var s,a="";for(s in n.appearanceStreamContent)if(n.appearanceStreamContent.hasOwnProperty(s)){var h,c=n.appearanceStreamContent[s];if(a+="/"+s+" ",a+="<<",1<=Object.keys(c).length||Array.isArray(c))for(var l in c)c.hasOwnProperty(l)&&(a+="/"+l+" "+(h="function"==typeof(h=c[l])?h.call(e,n):h)+" ",0<=e.internal.acroformPlugin.xForms.indexOf(h)||e.internal.acroformPlugin.xForms.push(h));else a+="/"+l+" "+(h="function"==typeof(h=c)?h.call(e,n):h),0<=e.internal.acroformPlugin.xForms.indexOf(h)||e.internal.acroformPlugin.xForms.push(h);a+=">>"}r.push({key:"AP",value:"<<\n"+a+">>"})}e.internal.putStream({additionalKeyValues:r,objectId:n.objId}),e.internal.out("endobj")}i&&function(t,e){for(var i in t){var n;t.hasOwnProperty(i)&&(i=t[n=i],e.internal.newObjectDeferredBegin(i.objId,!0),"object"==typeof i&&"function"==typeof i.putStream&&i.putStream(),delete t[n])}}(e.internal.acroformPlugin.xForms,e)}(t,e)}),e.internal.acroformPlugin.isInitialized=!0}}(this),!(t instanceof kt))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};i.AcroFormChoiceField=Ot,i.AcroFormListBox=Nt,i.AcroFormComboBox=jt,i.AcroFormEditBox=Ft,i.AcroFormButton=Et,i.AcroFormPushButton=It,i.AcroFormRadioButton=Dt,i.AcroFormCheckBox=Bt,i.AcroFormTextField=Rt,i.AcroFormPasswordField=zt,i.AcroFormAppearance=qt,i.AcroForm={ChoiceField:Ot,ListBox:Nt,ComboBox:jt,EditBox:Ft,Button:Et,PushButton:It,RadioButton:Dt,CheckBox:Bt,TextField:Rt,PasswordField:zt,Appearance:qt},wi.AcroForm={ChoiceField:Ot,ListBox:Nt,ComboBox:jt,EditBox:Ft,Button:Et,PushButton:It,RadioButton:Dt,CheckBox:Bt,TextField:Rt,PasswordField:zt,Appearance:qt};var Wt,Ht=wi.AcroForm;function Vt(t){return t.reduce(function(t,e,i){return t[e]=i,t},{})}function Xt(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(t){e=t}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(t){i=isNaN(t)||!1===Number.isInteger(t)||t<0?150:t,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(t){n=isNaN(t)||!1===Number.isInteger(t)||t<0?300:t,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var r=[];Object.defineProperty(this,"childNodes",{get:function(){return r},set:function(t){r=t}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(t){o=t}}),Object.defineProperty(this,"parentNode",{})}!function(a){a.__addimage__={};function t(){var t,e=this.internal.collections.addImage_images;for(t in e)g.call(this,e[t])}function e(){var t,e,i=this.internal.collections.addImage_images,n=this.internal.write;for(e in i)n("/I"+(t=i[e]).index,t.objectId,"0","R")}function h(t){return"function"==typeof a["process"+t.toUpperCase()]}function l(t){return"object"==typeof t&&1===t.nodeType}function c(t,e){if("IMG"===t.nodeName&&t.hasAttribute("src")){var i=""+t.getAttribute("src");if(0===i.indexOf("data:image/"))return L(unescape(i).split("base64,").pop());i=a.loadFile(i,!0);if(void 0!==i)return i}if("CANVAS"===t.nodeName){var n;switch(e){case"PNG":n="image/png";break;case"WEBP":n="image/webp";break;default:n="image/jpeg"}return L(t.toDataURL(n,1).split("base64,").pop())}}function u(t,e,i,n,r,o){var s,a=function(t,e,i){return t||e||(e=t=-96),t<0&&(t=-1*i.width*72/t/this.internal.scaleFactor),e<0&&(e=-1*i.height*72/e/this.internal.scaleFactor),[t=0===t?e*i.width/i.height:t,e=0===e?t*i.height/i.width:e]}.call(this,i,n,r),h=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,l=function(){var t=this.internal.collections.addImage_images;return m.call(this),t}.call(this);i=a[0],n=a[1],l[r.index]=r,o&&(o*=Math.PI/180,s=Math.cos(o),a=Math.sin(o),s=[(l=function(t){return t.toFixed(4)})(s),l(a),l(-1*a),l(s),0,0,"cm"]),this.internal.write("q"),o?(this.internal.write([1,"0","0",1,h(t),c(e+n),"cm"].join(" ")),this.internal.write(s.join(" ")),this.internal.write([h(i),"0","0",h(n),"0","0","cm"].join(" "))):this.internal.write([h(i),"0","0",h(n),h(t),c(e+n),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+r.index+" Do"),this.internal.write("Q")}var f="UNKNOWN",d={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},p=a.__addimage__.getImageFileTypeByImageData=function(t,e){var i,n;e=e||f;var r,o,s,a=f;if(x(t))for(s in d)for(r=d[s],i=0;i<r.length;i+=1){for(o=!0,n=0;n<r[i].length;n+=1)if(void 0!==r[i][n]&&r[i][n]!==t[n]){o=!1;break}if(!0===o){a=s;break}}else for(s in d)for(r=d[s],i=0;i<r.length;i+=1){for(o=!0,n=0;n<r[i].length;n+=1)if(void 0!==r[i][n]&&r[i][n]!==t.charCodeAt(n)){o=!1;break}if(!0===o){a=s;break}}return a=a===f&&e!==f?e:a},g=function(t){for(var e=this.internal.write,i=this.internal.putStream,n=(0,this.internal.getFilters)();-1!==n.indexOf("FlateEncode");)n.splice(n.indexOf("FlateEncode"),1);t.objectId=this.internal.newObject();var r=[];if(r.push({key:"Type",value:"/XObject"}),r.push({key:"Subtype",value:"/Image"}),r.push({key:"Width",value:t.width}),r.push({key:"Height",value:t.height}),t.colorSpace===v.INDEXED?r.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(t.palette.length/3-1)+" "+("sMask"in t&&void 0!==t.sMask?t.objectId+2:t.objectId+1)+" 0 R]"}):(r.push({key:"ColorSpace",value:"/"+t.colorSpace}),t.colorSpace===v.DEVICE_CMYK&&r.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),r.push({key:"BitsPerComponent",value:t.bitsPerComponent}),"decodeParameters"in t&&void 0!==t.decodeParameters&&r.push({key:"DecodeParms",value:"<<"+t.decodeParameters+">>"}),"transparency"in t&&Array.isArray(t.transparency)){for(var o="",s=0,a=t.transparency.length;s<a;s++)o+=t.transparency[s]+" "+t.transparency[s]+" ";r.push({key:"Mask",value:"["+o+"]"})}void 0!==t.sMask&&r.push({key:"SMask",value:t.objectId+1+" 0 R"});var h,c=void 0!==t.filter?["/"+t.filter]:void 0;i({data:t.data,additionalKeyValues:r,alreadyAppliedFilters:c,objectId:t.objectId}),e("endobj"),"sMask"in t&&void 0!==t.sMask&&(h="/Predictor "+t.predictor+" /Colors 1 /BitsPerComponent "+t.bitsPerComponent+" /Columns "+t.width,h={width:t.width,height:t.height,colorSpace:"DeviceGray",bitsPerComponent:t.bitsPerComponent,decodeParameters:h,data:t.sMask},"filter"in t&&(h.filter=t.filter),g.call(this,h)),t.colorSpace===v.INDEXED&&(h=this.internal.newObject(),i({data:S(new Uint8Array(t.palette)),objectId:h}),e("endobj"))},m=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",t),this.internal.events.subscribe("putXobjectDict",e))},v=a.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};a.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=a.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=a.__addimage__.sHashCode=function(t){var e,i,n=0;if("string"==typeof t)for(i=t.length,e=0;e<i;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;else if(x(t))for(i=t.byteLength/2,e=0;e<i;e++)n=(n<<5)-n+t[e],n|=0;return n},r=a.__addimage__.validateStringAsBase64=function(t){(t=t||"").toString().trim();var e=!0;return 0===t.length&&(e=!1),t.length%4!=0&&(e=!1),!1===/^[A-Za-z0-9+/]+$/.test(t.substr(0,t.length-2))&&(e=!1),e=!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(t.substr(-2))?!1:e},o=a.__addimage__.extractImageFromDataUrl=function(t){var e=(t=t||"").split("base64,"),i=null;return 2===e.length&&(t=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(e[0]),Array.isArray(t)&&(i={mimeType:t[1],charset:t[2],data:e[1]})),i},w=a.__addimage__.supportsArrayBuffer=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array};a.__addimage__.isArrayBuffer=function(t){return w()&&t instanceof ArrayBuffer};var x=a.__addimage__.isArrayBufferView=function(t){return w()&&"undefined"!=typeof Uint32Array&&(t instanceof Int8Array||t instanceof Uint8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)},_=a.__addimage__.binaryStringToUint8Array=function(t){for(var e=t.length,i=new Uint8Array(e),n=0;n<e;n++)i[n]=t.charCodeAt(n);return i},S=a.__addimage__.arrayBufferToBinaryString=function(e){try{return L(pi(String.fromCharCode.apply(null,e)))}catch(t){if("undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.reduce)return new Uint8Array(e).reduce(function(t,e){return t.push(String.fromCharCode(e)),t},[]).join("")}};a.addImage=function(){var t,e,i,n,r,o,s,a;a="number"==typeof arguments[1]?(e=f,i=arguments[1],n=arguments[2],r=arguments[3],o=arguments[4],s=arguments[5],c=arguments[6],arguments[7]):(e=arguments[1],i=arguments[2],n=arguments[3],r=arguments[4],o=arguments[5],s=arguments[6],c=arguments[7],arguments[8]),"object"==typeof(t=arguments[0])&&!l(t)&&"imageData"in t&&(t=(h=t).imageData,e=h.format||e||f,i=h.x||i||0,n=h.y||n||0,r=h.w||h.width||r,o=h.h||h.height||o,s=h.alias||s,c=h.compression||c,a=h.rotation||h.angle||a);var h=this.internal.getFilters();if(void 0===c&&-1!==h.indexOf("FlateEncode")&&(c="SLOW"),isNaN(i)||isNaN(n))throw new Error("Invalid coordinates passed to jsPDF.addImage");m.call(this);var c=C.call(this,t,e,s,c);return u.call(this,i,n,r,o,c,a),this};var C=function(t,e,i,n){var r,o,s;if("string"==typeof t&&p(t)===f&&(t=unescape(t),""===(o=A(t,!1))&&void 0===(o=a.loadFile(t,!0))||(t=o)),l(t)&&(t=c(t,e)),e=p(t,e),!h(e))throw new Error("addImage does not support files of type '"+e+"', please ensure that a plugin for '"+e+"' support is added.");if(null!=i&&0!==i.length||(i="string"==typeof(s=t)||x(s)?b(s):null),(s=function(t){var e=this.internal.collections.addImage_images;if(e)for(var i in e)if(t===e[i].alias)return e[i]}.call(this,i))||(w()&&(t instanceof Uint8Array||(t=_(r=t))),s=this["process"+e.toUpperCase()](t,function(){return Object.keys(this.internal.collections.addImage_images).length}.call(this),i,(n=(n=n)&&"string"==typeof n?n.toUpperCase():n)in a.image_compression?n:y.NONE,r)),!s)throw new Error("An unknown error occurred whilst processing the image.");return s},A=a.__addimage__.convertBase64ToBinaryString=function(t,e){e="boolean"!=typeof e||e;var i,n="";if("string"==typeof t){i=null!==(i=o(t))?i.data:t;try{n=L(i)}catch(t){if(e)throw r(i)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+t.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return n};a.getImageProperties=function(t){var e="";if("string"==typeof(t=l(t)?c(t):t)&&p(t)===f&&(t=e=""===(e=A(t,!1))?a.loadFile(t)||"":e),e=p(t),!h(e))throw new Error("addImage does not support files of type '"+e+"', please ensure that a plugin for '"+e+"' support is added.");if(!w()||t instanceof Uint8Array||(t=_(t)),!(t=this["process"+e.toUpperCase()](t)))throw new Error("An unknown error occurred whilst processing the image");return t.fileType=e,t}}(wi.API),e=wi.API,Wt=function(t){if(void 0!==t&&""!=t)return!0},wi.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(t){for(var e=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,n=this.internal.getPageInfoByObjId(t.objId),r=t.pageContext.annotations,o=!1,s=0;s<r.length&&!o;s++)switch((h=r[s]).type){case"link":(Wt(h.options.url)||Wt(h.options.pageNumber))&&(o=!0);break;case"reference":case"text":case"freetext":o=!0}if(0!=o){this.internal.write("/Annots [");for(var a=0;a<r.length;a++){var h=r[a],c=this.internal.pdfEscape,l=this.internal.getEncryptor(t.objId);switch(h.type){case"reference":this.internal.write(" "+h.object.objId+" 0 R ");break;case"text":var u=this.internal.newAdditionalObject(),f=this.internal.newAdditionalObject(),d=this.internal.getEncryptor(u.objId),p=h.title||"Note",g="<</Type /Annot /Subtype /Text "+(m="/Rect ["+e(h.bounds.x)+" "+i(h.bounds.y+h.bounds.h)+" "+e(h.bounds.x+h.bounds.w)+" "+i(h.bounds.y)+"] ")+"/Contents ("+c(d(h.contents))+")";g+=" /Popup "+f.objId+" 0 R",g+=" /P "+n.objId+" 0 R",g+=" /T ("+c(d(p))+") >>",u.content=g;p=u.objId+" 0 R";g="<</Type /Annot /Subtype /Popup "+(m="/Rect ["+e(h.bounds.x+30)+" "+i(h.bounds.y+h.bounds.h)+" "+e(h.bounds.x+h.bounds.w+30)+" "+i(h.bounds.y)+"] ")+" /Parent "+p,h.open&&(g+=" /Open true"),g+=" >>",f.content=g,this.internal.write(u.objId,"0 R",f.objId,"0 R");break;case"freetext":var m="/Rect ["+e(h.bounds.x)+" "+i(h.bounds.y)+" "+e(h.bounds.x+h.bounds.w)+" "+i(h.bounds.y+h.bounds.h)+"] ",v=h.color||"#000000";g="<</Type /Annot /Subtype /FreeText "+m+"/Contents ("+c(l(h.contents))+")",g+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+v+")",g+=" /Border [0 0 0]",g+=" >>",this.internal.write(g);break;case"link":if(h.options.name?(v=this.annotations._nameMap[h.options.name],h.options.pageNumber=v.page,h.options.top=v.y):h.options.top||(h.options.top=0),m="/Rect ["+h.finalBounds.x+" "+h.finalBounds.y+" "+h.finalBounds.w+" "+h.finalBounds.h+"] ",g="",h.options.url)g="<</Type /Annot /Subtype /Link "+m+"/Border [0 0 0] /A <</S /URI /URI ("+c(l(h.options.url))+") >>";else if(h.options.pageNumber)switch(g="<</Type /Annot /Subtype /Link "+m+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(h.options.pageNumber).objId+" 0 R",h.options.magFactor=h.options.magFactor||"XYZ",h.options.magFactor){case"Fit":g+=" /Fit]";break;case"FitH":g+=" /FitH "+h.options.top+"]";break;case"FitV":h.options.left=h.options.left||0,g+=" /FitV "+h.options.left+"]";break;default:var y=i(h.options.top);h.options.left=h.options.left||0,void 0===h.options.zoom&&(h.options.zoom=0),g+=" /XYZ "+h.options.left+" "+y+" "+h.options.zoom+"]"}""!=g&&(g+=" >>",this.internal.write(g))}}this.internal.write("]")}}]),e.createAnnotation=function(t){var e=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":e.pageContext.annotations.push(t)}},e.link=function(t,e,i,n,r){var o=this.internal.getCurrentPageInfo(),s=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:s(t),y:a(e),w:s(t+i),h:a(e+n)},options:r,type:"link"})},e.textWithLink=function(t,e,i,n){var r=this.getTextWidth(t),o=this.internal.getLineHeight()/this.internal.scaleFactor;return this.text(t,e,i,n),"center"===n.align&&(e-=r/2),"right"===n.align&&(e-=r),this.link(e,(i+=.2*o)-o,r,o,n),r},e.getTextWidth=function(t){var e=this.internal.getFontSize();return this.getStringUnitWidth(t)*e/this.internal.scaleFactor},function(t){var h={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},o={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},e={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var n=t.__arabicParser__.isInArabicSubstitutionA=function(t){return void 0!==h[t.charCodeAt(0)]},c=t.__arabicParser__.isArabicLetter=function(t){return"string"==typeof t&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(t)},r=t.__arabicParser__.isArabicEndLetter=function(t){return c(t)&&n(t)&&h[t.charCodeAt(0)].length<=2},s=t.__arabicParser__.isArabicAlfLetter=function(t){return c(t)&&0<=i.indexOf(t.charCodeAt(0))};t.__arabicParser__.arabicLetterHasIsolatedForm=function(t){return c(t)&&n(t)&&1<=h[t.charCodeAt(0)].length};var a=t.__arabicParser__.arabicLetterHasFinalForm=function(t){return c(t)&&n(t)&&2<=h[t.charCodeAt(0)].length};t.__arabicParser__.arabicLetterHasInitialForm=function(t){return c(t)&&n(t)&&3<=h[t.charCodeAt(0)].length};var l=t.__arabicParser__.arabicLetterHasMedialForm=function(t){return c(t)&&n(t)&&4==h[t.charCodeAt(0)].length},u=t.__arabicParser__.resolveLigatures=function(t){for(var e=0,i=o,n="",r=0,e=0;e<t.length;e+=1)void 0!==i[t.charCodeAt(e)]?(r++,"number"==typeof(i=i[t.charCodeAt(e)])&&(n+=String.fromCharCode(i),i=o,r=0),e===t.length-1&&(i=o,n+=t.charAt(e-(r-1)),e-=r-1,r=0)):(i=o,n+=t.charAt(e-r),e-=r,r=0);return n};t.__arabicParser__.isArabicDiacritic=function(t){return void 0!==t&&void 0!==e[t.charCodeAt(0)]};function f(t){for(var e,i,n=0,r=0,o="",s=(t=t||"").split("\\s+"),a=[],n=0;n<s.length;n+=1){for(a.push(""),r=0;r<s[n].length;r+=1)o=s[n][r],e=s[n][r-1],i=s[n][r+1],c(o)?(i=d(o,e,i),a[n]+=-1!==i?String.fromCharCode(h[o.charCodeAt(0)][i]):o):a[n]+=o;a[n]=u(a[n])}return a.join(" ")}var d=t.__arabicParser__.getCorrectForm=function(t,e,i){return!c(t)||!1===n(t)?-1:!a(t)||!c(e)&&!c(i)||!c(i)&&r(e)||r(t)&&!c(e)||r(t)&&s(e)||r(t)&&r(e)?0:l(t)&&c(e)&&!r(e)&&c(i)&&a(i)?3:r(t)||!c(i)?1:2},p=t.__arabicParser__.processArabic=t.processArabic=function(){var t,e="string"==typeof arguments[0]?arguments[0]:arguments[0].text,i=[];if(Array.isArray(e)){for(var n=0,i=[],n=0;n<e.length;n+=1)Array.isArray(e[n])?i.push([f(e[n][0]),e[n][1],e[n][2]]):i.push([f(e[n])]);t=i}else t=f(e);return"string"==typeof arguments[0]?t:(arguments[0].text=t,arguments[0])};t.events.push(["preProcessText",p])}(wi.API),wi.API.autoPrint=function(t){var e;return"javascript"===((t=t||{}).variant=t.variant||"non-conform",t.variant)?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},i=wi.API,Xt.prototype.getContext=function(t,e){if("2d"!==(t=t||"2d"))return null;for(var i in e)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=e[i]);return(this.pdf.context2d._canvas=this).pdf.context2d},Xt.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},i.events.push(["initialized",function(){this.canvas=new Xt,this.canvas.pdf=this}]),function(t){function A(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},T),this.internal.__cell__.margins.width=this.getPageWidth(),L.call(this))}function L(){this.internal.__cell__.lastCell=new P,this.internal.__cell__.pages=1}var T={left:0,top:0,bottom:0,right:0},s=!1,P=function(){var e=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return e},set:function(t){e=t}});var i=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return i},set:function(t){i=t}});var n=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return n},set:function(t){n=t}});var r=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return r},set:function(t){r=t}});var o=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return o},set:function(t){o=t}});var s=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return s},set:function(t){s=t}});var a=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return a},set:function(t){a=t}}),this};P.prototype.clone=function(){return new P(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},P.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(t){return A.call(this),this.internal.__cell__.headerFunction="function"==typeof t?t:void 0,this},t.getTextDimensions=function(t,e){A.call(this);var i,n=(e=e||{}).fontSize||this.getFontSize(),r=e.font||this.getFont(),o=e.scaleFactor||this.internal.scaleFactor,s=0,a=0,h=this;if(!Array.isArray(t)&&"string"!=typeof t){if("number"!=typeof t)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");t=String(t)}const c=e.maxWidth;0<c?"string"==typeof t?t=this.splitTextToSize(t,c):"[object Array]"===Object.prototype.toString.call(t)&&(t=t.reduce(function(t,e){return t.concat(h.splitTextToSize(e,c))},[])):t=Array.isArray(t)?t:[t];for(var l=0;l<t.length;l++)s<(i=this.getStringUnitWidth(t[l],{font:r})*n)&&(s=i);return 0!==s&&(a=t.length),{w:s/=o,h:Math.max((a*n*this.getLineHeightFactor()-n*(this.getLineHeightFactor()-1))/o,0)}},t.cellAddPage=function(){A.call(this),this.addPage();var t=this.internal.__cell__.margins||T;return this.internal.__cell__.lastCell=new P(t.left,t.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var k=t.cell=function(){var t=arguments[0]instanceof P?arguments[0]:new P(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);A.call(this);var e=this.internal.__cell__.lastCell,i=this.internal.__cell__.padding,n=this.internal.__cell__.margins||T,r=this.internal.__cell__.tableHeaderRow,o=this.internal.__cell__.printHeaders;return void 0!==e.lineNumber&&(e.lineNumber===t.lineNumber?(t.x=(e.x||0)+(e.width||0),t.y=e.y||0):e.y+e.height+t.height+n.bottom>this.getPageHeight()?(this.cellAddPage(),t.y=n.top,o&&r&&(this.printHeaderRow(t.lineNumber,!0),t.y+=r[0].height)):t.y=e.y+e.height||t.y),void 0!==t.text[0]&&(this.rect(t.x,t.y,t.width,t.height,!0===s?"FD":void 0),"right"===t.align?this.text(t.text,t.x+t.width-i,t.y+i,{align:"right",baseline:"top"}):"center"===t.align?this.text(t.text,t.x+t.width/2,t.y+i,{align:"center",baseline:"top",maxWidth:t.width-i-i}):this.text(t.text,t.x+i,t.y+i,{align:"left",baseline:"top",maxWidth:t.width-i-i})),this.internal.__cell__.lastCell=t,this};t.table=function(e,i,t,n,r){if(A.call(this),!t)throw new Error("No data for PDF table.");var o,s,a=[],h=[],c=[],l={},u={},f=[],d=(r=r||{}).autoSize||!1,p=!1!==r.printHeaders,g=r.css&&void 0!==r.css["font-size"]?16*r.css["font-size"]:r.fontSize||12,m=r.margins||Object.assign({width:this.getPageWidth()},T),v="number"==typeof r.padding?r.padding:3,r=r.headerBackgroundColor||"#c8c8c8";if(L.call(this),this.internal.__cell__.printHeaders=p,this.internal.__cell__.margins=m,this.internal.__cell__.table_font_size=g,this.internal.__cell__.padding=v,this.internal.__cell__.headerBackgroundColor=r,this.setFontSize(g),null==n)h=a=Object.keys(t[0]),c=a.map(function(){return"left"});else if(Array.isArray(n)&&"object"==typeof n[0])for(a=n.map(function(t){return t.name}),h=n.map(function(t){return t.prompt||t.name||""}),c=n.map(function(t){return t.align||"left"}),b=0;b<n.length;b+=1)u[n[b].name]=n[b].width*(19.049976/25.4);else Array.isArray(n)&&"string"==typeof n[0]&&(h=a=n,c=a.map(function(){return"left"}));if(d||Array.isArray(n)&&"string"==typeof n[0])for(b=0;b<a.length;b+=1){for(l[s=a[b]]=t.map(function(t){return t[s]}),this.setFont(void 0,"bold"),f.push(this.getTextDimensions(h[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),o=l[s],this.setFont(void 0,"normal"),C=0;C<o.length;C+=1)f.push(this.getTextDimensions(o[C],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);u[s]=Math.max.apply(null,f)+v+v,f=[]}if(p){for(var y={},b=0;b<a.length;b+=1)y[a[b]]={},y[a[b]].text=h[b],y[a[b]].align=c[b];var w=O.call(this,y,u),x=a.map(function(t){return new P(e,i,u[t],w,y[t].text,void 0,y[t].align)});this.setTableHeaderRow(x),this.printHeaderRow(1,!1)}var _=n.reduce(function(t,e){return t[e.name]=e.align,t},{});for(b=0;b<t.length;b+=1)for(var S=O.call(this,t[b],u),C=0;C<a.length;C+=1)k.call(this,new P(e,i,u[a[C]],S,t[b][a[C]],b+2,_[a[C]]));return this.internal.__cell__.table_x=e,this.internal.__cell__.table_y=i,this};var O=function(i,n){var r=this.internal.__cell__.padding,e=this.internal.__cell__.table_font_size,o=this.internal.scaleFactor;return Object.keys(i).map(function(t){var e=i[t];return this.splitTextToSize(e.hasOwnProperty("text")?e.text:e,n[t]-r-r)},this).map(function(t){return this.getLineHeightFactor()*t.length*e/o+r+r},this).reduce(function(t,e){return Math.max(t,e)},0)};t.setTableHeaderRow=function(t){A.call(this),this.internal.__cell__.tableHeaderRow=t},t.printHeaderRow=function(t,e){if(A.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var i,n;s=!0,"function"==typeof this.internal.__cell__.headerFunction&&(n=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages),this.internal.__cell__.lastCell=new P(n[0],n[1],n[2],n[3],void 0,-1)),this.setFont(void 0,"bold");for(var r=[],o=0;o<this.internal.__cell__.tableHeaderRow.length;o+=1)i=this.internal.__cell__.tableHeaderRow[o].clone(),e&&(i.y=this.internal.__cell__.margins.top||0,r.push(i)),i.lineNumber=t,this.setFillColor(this.internal.__cell__.headerBackgroundColor),k.call(this,i);0<r.length&&this.setTableHeaderRow(r),this.setFont(void 0,"normal"),s=!1}}(wi.API);var Gt={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Yt=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Kt=Vt(Yt),Jt=[100,200,300,400,500,600,700,800,900],$t=Vt(Jt);function Zt(t){var e,i,n=t.family.replace(/"|'/g,"").toLowerCase(),r=(i=t.style,Gt[i=i||"normal"]?i:"normal"),i=(e=t.weight)?"number"==typeof e?100<=e&&e<=900&&e%100==0?e:400:/^\d00$/.test(e)?parseInt(e):"bold"!==e?400:700:400,e=(e=t.stretch,"number"==typeof Kt[e=e||"normal"]?e:"normal");return{family:n,style:r,weight:i,stretch:e,src:t.src||[],ref:t.ref||{name:n,style:[e,r,i].join(" ")}}}function Qt(t,e,i,n){for(var r=i;0<=r&&r<e.length;r+=n)if(t[e[r]])return t[e[r]];for(r=i;0<=r&&r<e.length;r-=n)if(t[e[r]])return t[e[r]]}var te={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},ee={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function ie(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function ne(t){return t.trimLeft()}var re,oe,se,ae,he,ce=["times"];function le(){return(li.html2canvas?ci.resolve(li.html2canvas):f.e(120).then(f.t.bind(f,1120,23))).catch(function(t){return ci.reject(new Error("Could not load html2canvas: "+t))}).then(function(t){return t.default||t})}function ue(){return(li.DOMPurify?ci.resolve(li.DOMPurify):f.e(856).then(f.t.bind(f,7856,23))).catch(function(t){return ci.reject(new Error("Could not load dompurify: "+t))}).then(function(t){return t.default||t})}function fe(t){var e=typeof t;return"undefined"==e?"undefined":"string"==e||t instanceof String?"string":"number"==e||t instanceof Number?"number":"function"==e||t instanceof Function?"function":t&&t.constructor===Array?"array":t&&1===t.nodeType?"element":"object"==e?"object":"unknown"}function de(t,e){var i,n=document.createElement(t);for(i in e.className&&(n.className=e.className),e.innerHTML&&e.dompurify&&(n.innerHTML=e.dompurify.sanitize(e.innerHTML)),e.style)n.style[i]=e.style[i];return n}function pe(t,e){for(var i=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),n=t.firstChild;n;n=n.nextSibling)!0!==e&&1===n.nodeType&&"SCRIPT"===n.nodeName||i.appendChild(pe(n,e));return 1===t.nodeType&&("CANVAS"===t.nodeName?(i.width=t.width,i.height=t.height,i.getContext("2d").drawImage(t,0,0)):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(i.value=t.value),i.addEventListener("load",function(){i.scrollTop=t.scrollTop,i.scrollLeft=t.scrollLeft},!0)),i}function ge(t){var e=Object.assign(ge.convert(ci.resolve()),JSON.parse(JSON.stringify(ge.template)));return ge.convert(ci.resolve(),e).setProgress(1,ge,1,[ge]).set(t)}function me(t){var i,e,n,r,o,s,a,h,c;for(/[^\x00-\xFF]/.test(t),e=[],n=0,r=(t+=i="\0\0\0\0".slice(t.length%4||4)).length;n<r;n+=4)0!==(o=(t.charCodeAt(n)<<24)+(t.charCodeAt(n+1)<<16)+(t.charCodeAt(n+2)<<8)+t.charCodeAt(n+3))?(o=((o=((o=((o=(o-(c=o%85))/85)-(h=o%85))/85)-(a=o%85))/85)-(s=o%85))/85%85,e.push(33+o,33+s,33+a,33+h,33+c)):e.push(122);return function(t){for(var e=i.length;0<e;e--)t.pop()}(e),String.fromCharCode.apply(String,e)+"~>"}function ve(t){var i,e,n,r,o,s=String,a="length",h="charCodeAt";for(t.slice(-2),t=t.slice(0,-2).replace(/\s/g,"").replace("z","!!!!!"),n=[],r=0,o=(t+=i="uuuuu".slice(t[a]%5||5))[a];r<o;r+=5)e=52200625*(t[h](r)-33)+614125*(t[h](r+1)-33)+7225*(t[h](r+2)-33)+85*(t[h](r+3)-33)+(t[h](r+4)-33),n.push(255&e>>24,255&e>>16,255&e>>8,255&e);return function(t){for(var e=i[a];0<e;e--)t.pop()}(n),s.fromCharCode.apply(s,n)}!function(t){function u(t){return this.isStrokeTransparent=(t=t||{}).isStrokeTransparent||!1,this.strokeOpacity=t.strokeOpacity||1,this.strokeStyle=t.strokeStyle||"#000000",this.fillStyle=t.fillStyle||"#000000",this.isFillTransparent=t.isFillTransparent||!1,this.fillOpacity=t.fillOpacity||1,this.font=t.font||"10px sans-serif",this.textBaseline=t.textBaseline||"alphabetic",this.textAlign=t.textAlign||"left",this.lineWidth=t.lineWidth||1,this.lineJoin=t.lineJoin||"miter",this.lineCap=t.lineCap||"butt",this.path=t.path||[],this.transform=void 0!==t.transform?t.transform.clone():new C,this.globalCompositeOperation=t.globalCompositeOperation||"normal",this.globalAlpha=t.globalAlpha||1,this.clip_path=t.clip_path||[],this.currentPoint=t.currentPoint||new g,this.miterLimit=t.miterLimit||10,this.lastPoint=t.lastPoint||new g,this.ignoreClearRect="boolean"!=typeof t.ignoreClearRect||t.ignoreClearRect,this}var h,r,o,c,l,g,S,C,f;t.events.push(["initialized",function(){this.context2d=new e(this),h=this.internal.f2,r=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,c=this.internal.getHorizontalCoordinate,l=this.internal.getVerticalCoordinate,g=this.internal.Point,S=this.internal.Rectangle,C=this.internal.Matrix,f=new u}]);var e=function(t){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var e=t;Object.defineProperty(this,"pdf",{get:function(){return e}});var i=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return i},set:function(t){i=Boolean(t)}});var n=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return n},set:function(t){n=Boolean(t)}});var r=0;Object.defineProperty(this,"posX",{get:function(){return r},set:function(t){isNaN(t)||(r=t)}});var o=0;Object.defineProperty(this,"posY",{get:function(){return o},set:function(t){isNaN(t)||(o=t)}});var s=!1;Object.defineProperty(this,"autoPaging",{get:function(){return s},set:function(t){s=Boolean(t)}});var a=0;Object.defineProperty(this,"lastBreak",{get:function(){return a},set:function(t){a=t}});var h=[];Object.defineProperty(this,"pageBreaks",{get:function(){return h},set:function(t){h=t}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(t){t instanceof u&&(f=t)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(t){f.path=t}});var c=[];Object.defineProperty(this,"ctxStack",{get:function(){return c},set:function(t){c=t}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(t){t=p(t);this.ctx.fillStyle=t.style,this.ctx.isFillTransparent=0===t.a,this.ctx.fillOpacity=t.a,this.pdf.setFillColor(t.r,t.g,t.b,{a:t.a}),this.pdf.setTextColor(t.r,t.g,t.b,{a:t.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(t){t=p(t);this.ctx.strokeStyle=t.style,this.ctx.isStrokeTransparent=0===t.a,this.ctx.strokeOpacity=t.a,0===t.a?this.pdf.setDrawColor(255,255,255):(t.a,this.pdf.setDrawColor(t.r,t.g,t.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(t){-1!==["butt","round","square"].indexOf(t)&&(this.ctx.lineCap=t,this.pdf.setLineCap(t))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(t){isNaN(t)||(this.ctx.lineWidth=t,this.pdf.setLineWidth(t))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(t){-1!==["bevel","round","miter"].indexOf(t)&&(this.ctx.lineJoin=t,this.pdf.setLineJoin(t))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(t){isNaN(t)||(this.ctx.miterLimit=t,this.pdf.setMiterLimit(t))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(t){this.ctx.textBaseline=t}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(t){-1!==["right","end","center","left","start"].indexOf(t)&&(this.ctx.textAlign=t)}});var d=null;var l=null;Object.defineProperty(this,"fontFaces",{get:function(){return l},set:function(t){d=null,l=t}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(t){var e,n;if(this.ctx.font=t,null!==(o=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(t))){var i=o[1],r=(o[2],o[3]),t=o[4],s=(o[5],o[6]),o=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(t)[2],t="px"!==o&&"em"===o?Math.floor(parseFloat(t)*this.pdf.getFontSize()):Math.floor(parseFloat(t)*this.pdf.internal.scaleFactor);this.pdf.setFontSize(t);var a=function(){var t,e,i,n,r=[],o=s.trim();if(""===o)return ce;if(o in ee)return[ee[o]];for(;""!==o;){switch(e=null,t=(o=ne(o)).charAt(0)){case'"':case"'":e=function(t,e){for(var i=0;i<t.length;){if(t.charAt(i)===e)return[t.substring(0,i),t.substring(i+1)];i+=1}return null}(o.substring(1),t);break;default:n=void 0,e=null===(n=(i=o).match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i))?null:[n[0],i.substring(n[0].length)]}if(null===e)return ce;if(r.push(e[0]),""!==(o=ne(e[1]))&&","!==o.charAt(0))return ce;o=o.replace(/^,/,"")}return r}();if(this.fontFaces){t=function(t,e,i){for(var n=(i={}).defaultFontFamily||"times",r=Object.assign({},te,i.genericFontFamilies||{}),o=null,s=null,a=0;a<e.length;++a)if(r[(o=Zt(e[a])).family]&&(o.family=r[o.family]),t.hasOwnProperty(o.family)){s=t[o.family];break}if(!(s=s||t[n]))throw new Error("Could not find a font-family for the rule '"+ie(o)+"' and default family '"+n+"'.");if(s=function(t,e){if(e[t])return e[t];var i=Kt[t],n=i<=Kt.normal?-1:1,n=Qt(e,Yt,i,n);if(!n)throw new Error("Could not find a matching font-stretch value for "+t);return n}(o.stretch,s),s=function(t,e){if(e[t])return e[t];for(var i=Gt[t],n=0;n<i.length;++n)if(e[i[n]])return e[i[n]];throw new Error("Could not find a matching font-style for "+t)}(o.style,s),!(s=function(t,e){if(e[t])return e[t];if(400===t&&e[500])return e[500];if(500===t&&e[400])return e[400];var i=$t[t],i=Qt(e,Jt,i,t<400?-1:1);if(!i)throw new Error("Could not find a matching font-weight for value "+t);return i}(o.weight,s)))throw new Error("Failed to resolve a font for the rule '"+ie(o)+"'.");return s}((o=this.pdf,t=this.fontFaces,null===d&&(e=o.getFontList(),n=[],Object.keys(e).forEach(function(i){e[i].forEach(function(t){var e=null;switch(t){case"bold":e={family:i,weight:"bold"};break;case"italic":e={family:i,style:"italic"};break;case"bolditalic":e={family:i,weight:"bold",style:"italic"};break;case"":case"normal":e={family:i}}null!==e&&(e.ref={name:i,style:t},n.push(e))})}),d=function(t){for(var e={},i=0;i<t.length;++i){var n=Zt(t[i]),r=n.family,o=n.stretch,s=n.style,a=n.weight;e[r]=e[r]||{},e[r][o]=e[r][o]||{},e[r][o][s]=e[r][o][s]||{},e[r][o][s][a]=n}return e}(n.concat(t))),d),a.map(function(t){return{family:t,stretch:"normal",weight:r,style:i}}));this.pdf.setFont(t.ref.name,t.ref.style)}else{var h="";("bold"===r||700<=parseInt(r,10)||"bold"===i)&&(h="bold"),"italic"===i&&(h+="italic"),0===h.length&&(h="normal");for(var c="",l={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},u=0;u<a.length;u++){if(void 0!==this.pdf.internal.getFont(a[u],h,{noFallback:!0,disableWarning:!0})){c=a[u];break}if("bolditalic"===h&&void 0!==this.pdf.internal.getFont(a[u],"bold",{noFallback:!0,disableWarning:!0}))c=a[u],h="bold";else if(void 0!==this.pdf.internal.getFont(a[u],"normal",{noFallback:!0,disableWarning:!0})){c=a[u],h="normal";break}}if(""===c)for(var f=0;f<a.length;f++)if(l[a[f]]){c=l[a[f]];break}this.pdf.setFont(c=""===c?"Times":c,h)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(t){this.ctx.globalCompositeOperation=t}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(t){this.ctx.globalAlpha=t}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(t){this.ctx.ignoreClearRect=Boolean(t)}})};e.prototype.fill=function(){i.call(this,"fill",!1)},e.prototype.stroke=function(){i.call(this,"stroke",!1)},e.prototype.beginPath=function(){this.path=[{type:"begin"}]},e.prototype.moveTo=function(t,e){if(isNaN(t)||isNaN(e))throw ui.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var i=this.ctx.transform.applyToPoint(new g(t,e));this.path.push({type:"mt",x:i.x,y:i.y}),this.ctx.lastPoint=new g(t,e)},e.prototype.closePath=function(){for(var t=new g(0,0),e=0,e=this.path.length-1;-1!==e;e--)if("begin"===this.path[e].type&&"object"==typeof this.path[e+1]&&"number"==typeof this.path[e+1].x){t=new g(this.path[e+1].x,this.path[e+1].y),this.path.push({type:"lt",x:t.x,y:t.y});break}"object"==typeof this.path[e+2]&&"number"==typeof this.path[e+2].x&&this.path.push(JSON.parse(JSON.stringify(this.path[e+2]))),this.path.push({type:"close"}),this.ctx.lastPoint=new g(t.x,t.y)},e.prototype.lineTo=function(t,e){if(isNaN(t)||isNaN(e))throw ui.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");e=this.ctx.transform.applyToPoint(new g(t,e));this.path.push({type:"lt",x:e.x,y:e.y}),this.ctx.lastPoint=new g(e.x,e.y)},e.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),i.call(this,null,!0)},e.prototype.quadraticCurveTo=function(t,e,i,n){if(isNaN(i)||isNaN(n)||isNaN(t)||isNaN(e))throw ui.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");n=this.ctx.transform.applyToPoint(new g(i,n)),e=this.ctx.transform.applyToPoint(new g(t,e));this.path.push({type:"qct",x1:e.x,y1:e.y,x:n.x,y:n.y}),this.ctx.lastPoint=new g(n.x,n.y)},e.prototype.bezierCurveTo=function(t,e,i,n,r,o){if(isNaN(r)||isNaN(o)||isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw ui.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");o=this.ctx.transform.applyToPoint(new g(r,o)),e=this.ctx.transform.applyToPoint(new g(t,e)),n=this.ctx.transform.applyToPoint(new g(i,n));this.path.push({type:"bct",x1:e.x,y1:e.y,x2:n.x,y2:n.y,x:o.x,y:o.y}),this.ctx.lastPoint=new g(o.x,o.y)},e.prototype.arc=function(t,e,i,n,r,o){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n)||isNaN(r))throw ui.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");var s,a;o=Boolean(o),this.ctx.transform.isIdentity||(t=(a=this.ctx.transform.applyToPoint(new g(t,e))).x,e=a.y,s=this.ctx.transform.applyToPoint(new g(0,i)),a=this.ctx.transform.applyToPoint(new g(0,0)),i=Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2))),Math.abs(r-n)>=2*Math.PI&&(n=0,r=2*Math.PI),this.path.push({type:"arc",x:t,y:e,radius:i,startAngle:n,endAngle:r,counterclockwise:o})},e.prototype.arcTo=function(t,e,i,n,r){throw new Error("arcTo not implemented.")},e.prototype.rect=function(t,e,i,n){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw ui.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.lineTo(t,e),this.lineTo(t+i,e),this.lineTo(t,e)},e.prototype.fillRect=function(t,e,i,n){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw ui.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");var r;x.call(this)||(r={},"butt"!==this.lineCap&&(r.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(r.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(t,e,i,n),this.fill(),r.hasOwnProperty("lineCap")&&(this.lineCap=r.lineCap),r.hasOwnProperty("lineJoin")&&(this.lineJoin=r.lineJoin))},e.prototype.strokeRect=function(t,e,i,n){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw ui.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");_.call(this)||(this.beginPath(),this.rect(t,e,i,n),this.stroke())},e.prototype.clearRect=function(t,e,i,n){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw ui.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(t,e,i,n))},e.prototype.save=function(t){t="boolean"!=typeof t||t;for(var e=this.pdf.internal.getCurrentPageInfo().pageNumber,i=0;i<this.pdf.internal.getNumberOfPages();i++)this.pdf.setPage(i+1),this.pdf.internal.out("q");this.pdf.setPage(e),t&&(this.ctx.fontSize=this.pdf.internal.getFontSize(),t=new u(this.ctx),this.ctxStack.push(this.ctx),this.ctx=t)},e.prototype.restore=function(t){t="boolean"!=typeof t||t;for(var e=this.pdf.internal.getCurrentPageInfo().pageNumber,i=0;i<this.pdf.internal.getNumberOfPages();i++)this.pdf.setPage(i+1),this.pdf.internal.out("Q");this.pdf.setPage(e),t&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin)},e.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(t){var e,i,n,r,o;return(t=!0===t.isCanvasGradient?t.getColor():t)?(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(t)?o=n=i=e=0:null!==(r=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(t))?(e=parseInt(r[1]),i=parseInt(r[2]),n=parseInt(r[3]),o=1):null!==(r=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(t))?(e=parseInt(r[1]),i=parseInt(r[2]),n=parseInt(r[3]),o=parseFloat(r[4])):(o=1,4===(t="string"==typeof t&&"#"!==t.charAt(0)?(r=new di(t)).ok?r.toHex():"#000000":t).length?(e=t.substring(1,2),e+=e,i=t.substring(2,3),i+=i,n=t.substring(3,4),n+=n):(e=t.substring(1,3),i=t.substring(3,5),n=t.substring(5,7)),e=parseInt(e,16),i=parseInt(i,16),n=parseInt(n,16)),{r:e,g:i,b:n,a:o,style:t}):{r:0,g:0,b:0,a:0,style:t}},x=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},_=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};e.prototype.fillText=function(t,e,i,n){if(isNaN(e)||isNaN(i)||"string"!=typeof t)throw ui.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");var r,o;n=isNaN(n)?void 0:n,x.call(this)||(i=s.call(this,i),r=E(this.ctx.transform.rotation),o=this.ctx.transform.scaleX,a.call(this,{text:t,x:e,y:i,scale:o,angle:r,align:this.textAlign,maxWidth:n}))},e.prototype.strokeText=function(t,e,i,n){if(isNaN(e)||isNaN(i)||"string"!=typeof t)throw ui.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");var r,o;_.call(this)||(n=isNaN(n)?void 0:n,i=s.call(this,i),r=E(this.ctx.transform.rotation),o=this.ctx.transform.scaleX,a.call(this,{text:t,x:e,y:i,scale:o,renderingMode:"stroke",angle:r,align:this.textAlign,maxWidth:n}))},e.prototype.measureText=function(t){if("string"!=typeof t)throw ui.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var e=this.pdf,i=this.pdf.internal.scaleFactor,n=e.internal.getFontSize(),e=e.getStringUnitWidth(t)*n/e.internal.scaleFactor;return new function(t){var e=(t=t||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return e}}),this}({width:e*=Math.round(96*i/72*1e4)/1e4})},e.prototype.scale=function(t,e){if(isNaN(t)||isNaN(e))throw ui.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");e=new C(t,0,0,e,0,0);this.ctx.transform=this.ctx.transform.multiply(e)},e.prototype.rotate=function(t){if(isNaN(t))throw ui.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");t=new C(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0);this.ctx.transform=this.ctx.transform.multiply(t)},e.prototype.translate=function(t,e){if(isNaN(t)||isNaN(e))throw ui.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");e=new C(1,0,0,1,t,e);this.ctx.transform=this.ctx.transform.multiply(e)},e.prototype.transform=function(t,e,i,n,r,o){if(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n)||isNaN(r)||isNaN(o))throw ui.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");o=new C(t,e,i,n,r,o);this.ctx.transform=this.ctx.transform.multiply(o)},e.prototype.setTransform=function(t,e,i,n,r,o){t=isNaN(t)?1:t,e=isNaN(e)?0:e,i=isNaN(i)?0:i,n=isNaN(n)?1:n,r=isNaN(r)?0:r,o=isNaN(o)?0:o,this.ctx.transform=new C(t,e,i,n,r,o)},e.prototype.drawImage=function(t,e,i,n,r,o,s,a,h){var c=this.pdf.getImageProperties(t),l=1,u=1,f=1,d=1;void 0!==n&&void 0!==a&&(f=a/n,d=h/r,l=c.width/n*a/n,u=c.height/r*h/r),void 0===o&&(o=e,s=i,i=e=0),void 0!==n&&void 0===a&&(a=n,h=r),void 0===n&&void 0===a&&(a=c.width,h=c.height);for(var p,h=this.ctx.transform.decompose(),g=E(h.rotate.shx),m=(new C).multiply(h.translate).multiply(h.skew).multiply(h.scale).applyToRectangle(new S(o-e*f,s-i*d,n*l,r*u)),v=A.call(this,m),y=[],b=0;b<v.length;b+=1)-1===y.indexOf(v[b])&&y.push(v[b]);if(T(y),this.autoPaging)for(var u=y[0],w=y[y.length-1],x=u;x<w+1;x++){this.pdf.setPage(x),0!==this.ctx.clip_path.length&&(_=this.path,p=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=L(p,this.posX,-1*this.pdf.internal.pageSize.height*(x-1)+this.posY),P.call(this,"fill",!0),this.path=_);var _=JSON.parse(JSON.stringify(m)),_=L([_],this.posX,-1*this.pdf.internal.pageSize.height*(x-1)+this.posY)[0];this.pdf.addImage(t,"JPEG",_.x,_.y,_.w,_.h,null,null,g)}else this.pdf.addImage(t,"JPEG",m.x,m.y,m.w,m.h,null,null,g)};var A=function(t,e,i){var n=[];switch(e=e||this.pdf.internal.pageSize.width,i=i||this.pdf.internal.pageSize.height,t.type){default:case"mt":case"lt":n.push(Math.floor((t.y+this.posY)/i)+1);break;case"arc":n.push(Math.floor((t.y+this.posY-t.radius)/i)+1),n.push(Math.floor((t.y+this.posY+t.radius)/i)+1);break;case"qct":var r=b(this.ctx.lastPoint.x,this.ctx.lastPoint.y,t.x1,t.y1,t.x,t.y);n.push(Math.floor(r.y/i)+1),n.push(Math.floor((r.y+r.h)/i)+1);break;case"bct":r=I(this.ctx.lastPoint.x,this.ctx.lastPoint.y,t.x1,t.y1,t.x2,t.y2,t.x,t.y);n.push(Math.floor(r.y/i)+1),n.push(Math.floor((r.y+r.h)/i)+1);break;case"rect":n.push(Math.floor((t.y+this.posY)/i)+1),n.push(Math.floor((t.y+t.h+this.posY)/i)+1)}for(var o=0;o<n.length;o+=1)for(;this.pdf.internal.getNumberOfPages()<n[o];)w.call(this);return n},w=function(){var t=this.fillStyle,e=this.strokeStyle,i=this.font,n=this.lineCap,r=this.lineWidth,o=this.lineJoin;this.pdf.addPage(),this.fillStyle=t,this.strokeStyle=e,this.font=i,this.lineCap=n,this.lineWidth=r,this.lineJoin=o},L=function(t,e,i){for(var n=0;n<t.length;n++)switch(t[n].type){case"bct":t[n].x2+=e,t[n].y2+=i;case"qct":t[n].x1+=e,t[n].y1+=i;default:t[n].x+=e,t[n].y+=i}return t},T=function(t){return t.sort(function(t,e){return t-e})},i=function(t,e){for(var i=this.fillStyle,n=this.strokeStyle,r=this.lineCap,o=this.lineWidth,s=o*this.ctx.transform.scaleX,a=this.lineJoin,h=JSON.parse(JSON.stringify(this.path)),c=JSON.parse(JSON.stringify(this.path)),l=[],u=0;u<c.length;u++)if(void 0!==c[u].x)for(var f=A.call(this,c[u]),d=0;d<f.length;d+=1)-1===l.indexOf(f[d])&&l.push(f[d]);for(var p,g,m=0;m<l.length;m++)for(;this.pdf.internal.getNumberOfPages()<l[m];)w.call(this);if(T(l),this.autoPaging)for(var v=l[0],y=l[l.length-1],b=v;b<y+1;b++)this.pdf.setPage(b),this.fillStyle=i,this.strokeStyle=n,this.lineCap=r,this.lineWidth=s,this.lineJoin=a,0!==this.ctx.clip_path.length&&(p=this.path,g=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=L(g,this.posX,-1*this.pdf.internal.pageSize.height*(b-1)+this.posY),P.call(this,t,!0),this.path=p),p=JSON.parse(JSON.stringify(h)),this.path=L(p,this.posX,-1*this.pdf.internal.pageSize.height*(b-1)+this.posY),!1!==e&&0!==b||P.call(this,t,e),this.lineWidth=o;else this.lineWidth=s,P.call(this,t,e),this.lineWidth=o;this.path=h},P=function(t,e){if(("stroke"!==t||e||!_.call(this))&&("stroke"===t||e||!x.call(this))){for(var i=[],n=this.path,r=0;r<n.length;r++){var o=n[r];switch(o.type){case"begin":i.push({begin:!0});break;case"close":i.push({close:!0});break;case"mt":i.push({start:o,deltas:[],abs:[]});break;case"lt":var s=i.length;if(!isNaN(n[r-1].x)&&(d=[o.x-n[r-1].x,o.y-n[r-1].y],0<s))for(;0<=s;s--)if(!0!==i[s-1].close&&!0!==i[s-1].begin){i[s-1].deltas.push(d),i[s-1].abs.push(o);break}break;case"bct":d=[o.x1-n[r-1].x,o.y1-n[r-1].y,o.x2-n[r-1].x,o.y2-n[r-1].y,o.x-n[r-1].x,o.y-n[r-1].y],i[i.length-1].deltas.push(d);break;case"qct":var a=n[r-1].x+2/3*(o.x1-n[r-1].x),h=n[r-1].y+2/3*(o.y1-n[r-1].y),c=o.x+2/3*(o.x1-o.x),l=o.y+2/3*(o.y1-o.y),u=o.x,f=o.y,d=[a-n[r-1].x,h-n[r-1].y,c-n[r-1].x,l-n[r-1].y,u-n[r-1].x,f-n[r-1].y];i[i.length-1].deltas.push(d);break;case"arc":i.push({deltas:[],abs:[],arc:!0}),Array.isArray(i[i.length-1].abs)&&i[i.length-1].abs.push(o)}}for(var p,g,m=e?null:"stroke"===t?"stroke":"fill",v=0;v<i.length;v++){if(i[v].arc){for(var y=i[v].abs,b=0;b<y.length;b++){var w=y[b];"arc"===w.type?k.call(this,w.x,w.y,w.radius,w.startAngle,w.endAngle,w.counterclockwise,void 0,e):j.call(this,w.x,w.y)}O.call(this,m),this.pdf.internal.out("h")}i[v].arc||!0===i[v].close||!0===i[v].begin||(p=i[v].start.x,g=i[v].start.y,F.call(this,i[v].deltas,p,g))}m&&O.call(this,m),e&&N.call(this)}},s=function(t){var e=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,i=e*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return t-i;case"top":return t+e-i;case"hanging":return t+e-2*i;case"middle":return t+e/2-i;case"ideographic":return t;default:return t}};e.prototype.createLinearGradient=function(){function t(){}return t.colorStops=[],t.addColorStop=function(t,e){this.colorStops.push([t,e])},t.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},t.isCanvasGradient=!0,t},e.prototype.createPattern=function(){return this.createLinearGradient()},e.prototype.createRadialGradient=function(){return this.createLinearGradient()};var k=function(t,e,i,n,r,o,s,a){for(var h=v.call(this,i,n,r,o),c=0;c<h.length;c++){var l=h[c];0===c&&d.call(this,l.x1+t,l.y1+e),m.call(this,t,e,l.x2,l.y2,l.x3,l.y3,l.x4,l.y4)}a?N.call(this):O.call(this,s)},O=function(t){switch(t){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},N=function(){this.pdf.clip(),this.pdf.discardPath()},d=function(t,e){this.pdf.internal.out(r(t)+" "+o(e)+" m")},a=function(t){var e;switch(t.align){case"right":case"end":e="right";break;case"center":e="center";break;default:e="left"}for(var i,n,r,o=this.ctx.transform.applyToPoint(new g(t.x,t.y)),s=this.ctx.transform.decompose(),a=(a=(a=(a=new C).multiply(s.translate)).multiply(s.skew)).multiply(s.scale),s=this.pdf.getTextDimensions(t.text),h=this.ctx.transform.applyToRectangle(new S(t.x,t.y,s.w,s.h)),s=a.applyToRectangle(new S(t.x,t.y-s.h,s.w,s.h)),c=A.call(this,s),l=[],u=0;u<c.length;u+=1)-1===l.indexOf(c[u])&&l.push(c[u]);if(T(l),!0===this.autoPaging)for(var s=l[0],f=l[l.length-1],d=s;d<f+1;d++){this.pdf.setPage(d),0!==this.ctx.clip_path.length&&(p=this.path,r=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=L(r,this.posX,-1*this.pdf.internal.pageSize.height*(d-1)+this.posY),P.call(this,"fill",!0),this.path=p);var p=JSON.parse(JSON.stringify(h)),p=L([p],this.posX,-1*this.pdf.internal.pageSize.height*(d-1)+this.posY)[0];.01<=t.scale&&(i=this.pdf.internal.getFontSize(),this.pdf.setFontSize(i*t.scale),n=this.lineWidth,this.lineWidth=n*t.scale),this.pdf.text(t.text,p.x,p.y,{angle:t.angle,align:e,renderingMode:t.renderingMode,maxWidth:t.maxWidth}),.01<=t.scale&&(this.pdf.setFontSize(i),this.lineWidth=n)}else.01<=t.scale&&(i=this.pdf.internal.getFontSize(),this.pdf.setFontSize(i*t.scale),n=this.lineWidth,this.lineWidth=n*t.scale),this.pdf.text(t.text,o.x+this.posX,o.y+this.posY,{angle:t.angle,align:e,renderingMode:t.renderingMode,maxWidth:t.maxWidth}),.01<=t.scale&&(this.pdf.setFontSize(i),this.lineWidth=n)},j=function(t,e,i,n){n=n||0,this.pdf.internal.out(r(t+(i=i||0))+" "+o(e+n)+" l")},F=function(t,e,i){return this.pdf.lines(t,e,i,null,null)},m=function(t,e,i,n,r,o,s,a){this.pdf.internal.out([h(c(i+t)),h(l(n+e)),h(c(r+t)),h(l(o+e)),h(c(s+t)),h(l(a+e)),"c"].join(" "))},v=function(t,e,i,n){for(var r=2*Math.PI,o=Math.PI/2;i<e;)e-=r;var s=Math.abs(i-e);s<r&&n&&(s=r-s);for(var a=[],h=n?-1:1,c=e;1e-5<s;){var l=c+h*Math.min(s,o);a.push(y.call(this,t,c,l)),s-=Math.abs(l-c),c=l}return a},y=function(t,e,i){var n=(i-e)/2,r=t*Math.cos(n),o=t*Math.sin(n),s=r,a=-o,h=s*s+a*a,c=h+s*r+a*o,c=4/3*(Math.sqrt(2*h*c)-c)/(s*o-a*r),o=s-c*a,r=a+c*s,a=o,c=-r,s=n+e,n=Math.cos(s),s=Math.sin(s);return{x1:t*Math.cos(e),y1:t*Math.sin(e),x2:o*n-r*s,y2:o*s+r*n,x3:a*n-c*s,y3:a*s+c*n,x4:t*Math.cos(i),y4:t*Math.sin(i)}},E=function(t){return 180*t/Math.PI},b=function(t,e,i,n,r,o){var s=t+.5*(i-t),a=e+.5*(n-e),h=r+.5*(i-r),i=o+.5*(n-o),n=Math.min(t,r,s,h),s=Math.max(t,r,s,h),h=Math.min(e,o,a,i),i=Math.max(e,o,a,i);return new S(n,h,s-n,i-h)},I=function(t,e,i,n,r,o,s,a){for(var h,c,l,u,f,d,p,g,m=i-t,v=n-e,y=r-i,b=o-n,w=s-r,x=a-o,_=0;_<41;_++)l=(c=(l=t+(h=_/40)*m)+h*((u=i+h*y)-l))+h*(u+h*(r+h*w-u)-c),u=(u=(u=e+h*v)+h*((c=n+h*b)-u))+h*(c+h*(o+h*x-c)-u),g=0==_?(p=f=l,d=u):(f=Math.min(f,l),d=Math.min(d,u),p=Math.max(p,l),Math.max(g,u));return new S(Math.round(f),Math.round(d),Math.round(p-f),Math.round(g-d))}}(wi.API),wi.API.processDataByFilters=function(t,e){var i=0,n=t||"",r=[];for("string"==typeof(e=e||[])&&(e=[e]),i=0;i<e.length;i+=1)switch(e[i]){case"ASCII85Decode":case"/ASCII85Decode":n=ve(n),r.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":n=me(n),r.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":n=function(t){var e=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((t=-1!==(t=t.replace(/\s/g,"")).indexOf(">")?t.substr(0,t.indexOf(">")):t).length%2&&(t+="0"),!1===e.test(t))return"";for(var i="",n=0;n<t.length;n+=2)i+=String.fromCharCode("0x"+(t[n]+t[n+1]));return i}(n),r.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":n=n.split("").map(function(t){return("0"+t.charCodeAt().toString(16)).slice(-2)}).join("")+">",r.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":n=function(t){for(var e=new Uint8Array(t.length),i=t.length;i--;)e[i]=t.charCodeAt(i);return(e=s(e)).reduce(function(t,e){return t+String.fromCharCode(e)},"")}(n),r.push("/FlateDecode");break;default:throw new Error('The filter: "'+e[i]+'" is not implemented')}return{data:n,reverseChain:r.reverse().join(" ")}},(e=wi.API).loadFile=function(t,r,o){return function(t,e,i){e=!1!==r,i="function"==typeof o?o:function(){};var n=void 0;try{n=function(t,e,i){function n(t){var e=t.length,i=[],n=String.fromCharCode;for(o=0;o<e;o+=1)i.push(n(255&t.charCodeAt(o)));return i.join("")}var r=new XMLHttpRequest,o=0;if(r.open("GET",t,!e),r.overrideMimeType("text/plain; charset=x-user-defined"),!1==e&&(r.onload=function(){200===r.status?i(n(this.responseText)):i(void 0)}),r.send(null),e&&200===r.status)return n(r.responseText)}(t,e,i)}catch(t){}return n}(t,0,o)},e.loadImageFile=e.loadFile,i=wi.API,((ge.prototype=Object.create(ci.prototype)).constructor=ge).convert=function(t,e){return t.__proto__=e||ge.prototype,t},ge.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},ge.prototype.from=function(e,t){return this.then(function(){switch(t=t||function(t){switch(fe(t)){case"string":return"string";case"element":return"canvas"===t.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(e)){case"string":return this.then(ue).then(function(t){return this.set({src:de("div",{innerHTML:e,dompurify:t})})});case"element":return this.set({src:e});case"canvas":return this.set({canvas:e});case"img":return this.set({img:e});default:return this.error("Unknown source type.")}})},ge.prototype.to=function(t){switch(t){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},ge.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var t={position:"relative",display:"inline-block",width:Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},e=pe(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===e.tagName&&(t.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=de("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=de("div",{className:"html2pdf__container",style:t}),this.prop.container.appendChild(e),this.prop.container.firstChild.appendChild(de("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},ge.prototype.toCanvas=function(){var t=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(t).then(le).then(function(t){var e=Object.assign({},this.opt.html2canvas);return delete e.onrendered,t(this.prop.container,e)}).then(function(t){(this.opt.html2canvas.onrendered||function(){})(t),this.prop.canvas=t,document.body.removeChild(this.prop.overlay)})},ge.prototype.toContext2d=function(){var t=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(t).then(le).then(function(t){var e=this.opt.jsPDF,i=this.opt.fontFaces,n=Object.assign({async:!0,allowTaint:!0,scale:1,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete n.onrendered,e.context2d.autoPaging=!0,e.context2d.posX=this.opt.x,e.context2d.posY=this.opt.y,e.context2d.fontFaces=i)for(var r=0;r<i.length;++r){var o=i[r],s=o.src.find(function(t){return"truetype"===t.format});s&&e.addFont(s.url,o.ref.name,o.ref.style)}return n.windowHeight=n.windowHeight||0,n.windowHeight=0==n.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):n.windowHeight,t(this.prop.container,n)}).then(function(t){(this.opt.html2canvas.onrendered||function(){})(t),this.prop.canvas=t,document.body.removeChild(this.prop.overlay)})},ge.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var t=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=t})},ge.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},ge.prototype.output=function(t,e,i){return"img"===(i=i||"pdf").toLowerCase()||"image"===i.toLowerCase()?this.outputImg(t,e):this.outputPdf(t,e)},ge.prototype.outputPdf=function(t,e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(t,e)})},ge.prototype.outputImg=function(t){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(t){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+t+'" is not supported.'}})},ge.prototype.save=function(t){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(t?{filename:t}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},ge.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},ge.prototype.set=function(e){if("object"!==fe(e))return this;var t=Object.keys(e||{}).map(function(t){if(t in ge.template.prop)return function(){this.prop[t]=e[t]};switch(t){case"margin":return this.setMargin.bind(this,e.margin);case"jsPDF":return function(){return this.opt.jsPDF=e.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,e.pageSize);default:return function(){this.opt[t]=e[t]}}},this);return this.then(function(){return this.thenList(t)})},ge.prototype.get=function(e,i){return this.then(function(){var t=(e in ge.template.prop?this.prop:this.opt)[e];return i?i(t):t})},ge.prototype.setMargin=function(t){return this.then(function(){switch(fe(t)){case"number":t=[t,t,t,t];case"array":if(4===(t=2===t.length?[t[0],t[1],t[0],t[1]]:t).length)break;default:return this.error("Invalid margin array.")}this.opt.margin=t}).then(this.setPageSize)},ge.prototype.setPageSize=function(t){function e(t,e){return Math.floor(t*e/72*96)}return this.then(function(){(t=t||wi.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(t.inner={width:t.width-this.opt.margin[1]-this.opt.margin[3],height:t.height-this.opt.margin[0]-this.opt.margin[2]},t.inner.px={width:e(t.inner.width,t.k),height:e(t.inner.height,t.k)},t.inner.ratio=t.inner.height/t.inner.width),this.prop.pageSize=t})},ge.prototype.setProgress=function(t,e,i,n){return null!=t&&(this.progress.val=t),null!=e&&(this.progress.state=e),null!=i&&(this.progress.n=i),null!=n&&(this.progress.stack=n),this.progress.ratio=this.progress.val/this.progress.state,this},ge.prototype.updateProgress=function(t,e,i,n){return this.setProgress(t?this.progress.val+t:null,e||null,i?this.progress.n+i:null,n?this.progress.stack.concat(n):null)},ge.prototype.then=function(t,e){var i=this;return this.thenCore(t,e,function(e,t){return i.updateProgress(null,null,1,[e]),ci.prototype.then.call(this,function(t){return i.updateProgress(null,e),t}).then(e,t).then(function(t){return i.updateProgress(1),t})})},ge.prototype.thenCore=function(t,e,i){i=i||ci.prototype.then,t=t&&t.bind(this),e=e&&e.bind(this);var n=-1!==ci.toString().indexOf("[native code]")&&"Promise"===ci.name?this:ge.convert(Object.assign({},this),ci.prototype),e=i.call(n,t,e);return ge.convert(e,this.__proto__)},ge.prototype.thenExternal=function(t,e){return ci.prototype.then.call(this,t,e)},ge.prototype.thenList=function(t){var e=this;return t.forEach(function(t){e=e.thenCore(t)}),e},ge.prototype.catch=function(t){t=t&&t.bind(this);t=ci.prototype.catch.call(this,t);return ge.convert(t,this)},ge.prototype.catchExternal=function(t){return ci.prototype.catch.call(this,t)},ge.prototype.error=function(t){return this.then(function(){throw new Error(t)})},ge.prototype.using=ge.prototype.set,ge.prototype.saveAs=ge.prototype.save,ge.prototype.export=ge.prototype.output,ge.prototype.run=ge.prototype.then,wi.getPageSize=function(t,e,i){"object"==typeof t&&(t=(h=t).orientation,e=h.unit||e,i=h.format||i),e=e||"mm",i=i||"a4",t=(""+(t||"P")).toLowerCase();var n,r=(""+i).toLowerCase(),o={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(e){case"pt":n=1;break;case"mm":n=72/25.4;break;case"cm":n=72/2.54;break;case"in":n=72;break;case"px":n=.75;break;case"pc":case"em":n=12;break;case"ex":n=6;break;default:throw"Invalid unit: "+e}var s,a=0,h=0;if(o.hasOwnProperty(r))a=o[r][1]/n,h=o[r][0]/n;else try{a=i[1],h=i[0]}catch(t){throw new Error("Invalid format: "+i)}if("p"===t||"portrait"===t)t="p",a<h&&(s=h,h=a,a=s);else{if("l"!==t&&"landscape"!==t)throw"Invalid orientation: "+t;t="l",h<a&&(s=h,h=a,a=s)}return{width:h,height:a,unit:e,k:n,orientation:t}},i.html=function(t,e){(e=e||{}).callback=e.callback||function(){},e.html2canvas=e.html2canvas||{},e.html2canvas.canvas=e.html2canvas.canvas||this.canvas,e.jsPDF=e.jsPDF||this,e.fontFaces=e.fontFaces?e.fontFaces.map(Zt):null;var i=new ge(e);return e.worker?i:i.from(t).doCallback()},wi.API.addJS=function(t){return se=t,this.internal.events.subscribe("postPutResources",function(){re=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(re+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),oe=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+se+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==re&&void 0!==oe&&this.internal.out("/Names <</JavaScript "+re+" 0 R>>")}),this},(e=wi.API).events.push(["postPutResources",function(){var t=this,e=/^(\d+) 0 obj$/;if(0<this.outline.root.children.length)for(var i=t.outline.render().split(/\r\n/),n=0;n<i.length;n++){var r=i[n],o=e.exec(r);null!=o&&(o=o[1],t.internal.newObjectDeferredBegin(o,!1)),t.internal.write(r)}if(this.outline.createNamedDestinations){for(var s=this.internal.pages.length,a=[],n=0;n<s;n++){var h=t.internal.newObject();a.push(h);h=t.internal.getPageInfo(n+1);t.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var c=t.internal.newObject();for(t.internal.write("<< /Names [ "),n=0;n<a.length;n++)t.internal.write("(page_"+(n+1)+")"+a[n]+" 0 R");t.internal.write(" ] >>","endobj"),he=t.internal.newObject(),t.internal.write("<< /Dests "+c+" 0 R"),t.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){0<this.outline.root.children.length&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+he+" 0 R"))}]),e.events.push(["initialized",function(){var s=this;s.outline={createNamedDestinations:!1,root:{children:[]}},s.outline.add=function(t,e,i){i={title:e,options:i,children:[]};return(t=null==t?this.root:t).children.push(i),i},s.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=s,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},s.outline.genIds_r=function(t){t.id=s.internal.newObjectDeferred();for(var e=0;e<t.children.length;e++)this.genIds_r(t.children[e])},s.outline.renderRoot=function(t){this.objStart(t),this.line("/Type /Outlines"),0<t.children.length&&(this.line("/First "+this.makeRef(t.children[0])),this.line("/Last "+this.makeRef(t.children[t.children.length-1]))),this.line("/Count "+this.count_r({count:0},t)),this.objEnd()},s.outline.renderItems=function(t){for(var e=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<t.children.length;i++){var n=t.children[i];this.objStart(n),this.line("/Title "+this.makeString(n.title)),this.line("/Parent "+this.makeRef(t)),0<i&&this.line("/Prev "+this.makeRef(t.children[i-1])),i<t.children.length-1&&this.line("/Next "+this.makeRef(t.children[i+1])),0<n.children.length&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1])));var r=this.count=this.count_r({count:0},n);0<r&&this.line("/Count "+r),n.options&&n.options.pageNumber&&(n=s.internal.getPageInfo(n.options.pageNumber),this.line("/Dest ["+n.objId+" 0 R /XYZ 0 "+e(0)+" 0]")),this.objEnd()}for(var o=0;o<t.children.length;o++)this.renderItems(t.children[o])},s.outline.line=function(t){this.ctx.val+=t+"\r\n"},s.outline.makeRef=function(t){return t.id+" 0 R"},s.outline.makeString=function(t){return"("+s.internal.pdfEscape(t)+")"},s.outline.objStart=function(t){this.ctx.val+="\r\n"+t.id+" 0 obj\r\n<<\r\n"},s.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},s.outline.count_r=function(t,e){for(var i=0;i<e.children.length;i++)t.count++,this.count_r(t,e.children[i]);return t.count}}]),i=wi.API,ae=[192,193,194,195,196,197,198,199],i.processJPEG=function(t,e,i,n,r,o){var s=this.decode.DCT_DECODE,a=null;if("string"==typeof t||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=this.__addimage__.isArrayBuffer(t=r||t)?new Uint8Array(t):t,(r=function(t){for(var e,i=256*t.charCodeAt(4)+t.charCodeAt(5),n=t.length,r={width:0,height:0,numcomponents:1},o=4;o<n;o+=2){if(o+=i,-1!==ae.indexOf(t.charCodeAt(o+1))){e=256*t.charCodeAt(o+5)+t.charCodeAt(o+6),r={width:256*t.charCodeAt(o+7)+t.charCodeAt(o+8),height:e,numcomponents:t.charCodeAt(o+9)};break}i=256*t.charCodeAt(o+2)+t.charCodeAt(o+3)}return r}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}a={data:t,width:r.width,height:r.height,colorSpace:o,bitsPerComponent:8,filter:s,index:e,alias:i}}return a};var ye,be,we,xe,_e,Se,Ce,Ae,Le,Te,Pe,ke,Oe,Ne=function(){var c,e,i;function t(t){var e,i,n,r,o,s,a,h,c,l;for(this.data=t,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},n=null;;){switch(e=this.readUInt32(),o=function(){for(var t=[],e=0;e<4;++e)t.push(String.fromCharCode(this.data[this.pos++]));return t}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(e);break;case"fcTL":n&&this.animation.frames.push(n),this.pos+=4,n={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},a=this.readUInt16(),r=this.readUInt16()||100,n.delay=1e3*a/r,n.disposeOp=this.data[this.pos++],n.blendOp=this.data[this.pos++],n.data=[];break;case"IDAT":case"fdAT":for("fdAT"===o&&(this.pos+=4,e-=4),t=(null!=n?n.data:void 0)||this.imgData,h=0;0<=e?h<e:e<h;0<=e?++h:--h)t.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(i=this.palette.length/3,this.transparency.indexed=this.read(e),this.transparency.indexed.length>i)throw new Error("More transparent colors than palette size");if(0<(s=i-this.transparency.indexed.length))for(c=0;0<=s?c<s:s<c;0<=s?++c:--c)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(e)[0];break;case 2:this.transparency.rgb=this.read(e)}break;case"tEXt":l=(a=this.read(e)).indexOf(0),r=String.fromCharCode.apply(String,a.slice(0,l)),this.text[r]=String.fromCharCode.apply(String,a.slice(l+1));break;case"IEND":return n&&this.animation.frames.push(n),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(l=this.colorType)||6===l,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=e}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}t.prototype.read=function(t){for(var e=[],i=0;0<=t?i<t:t<i;0<=t?++i:--i)e.push(this.data[this.pos++]);return e},t.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},t.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},t.prototype.decodePixels=function(k){var O=this.pixelBitlength/8,N=new Uint8Array(this.width*this.height*O),j=0,F=this;return 0===(k=null==k?this.imgData:k).length?new Uint8Array(0):(k=a(k),1==F.interlaceMethod?(t(0,0,8,8),t(4,0,8,8),t(0,4,4,8),t(2,0,4,4),t(0,2,2,4),t(1,0,2,2),t(0,1,1,2)):t(0,0,1,1),N);function t(t,e,i,n){for(var r,o,s,a,h,c,l,u,f,d,p,g,m,v=Math.ceil((F.width-t)/i),y=Math.ceil((F.height-e)/n),b=F.width==v&&F.height==y,w=O*v,x=b?N:new Uint8Array(w*y),_=k.length,S=0,C=0;S<y&&j<_;){switch(k[j++]){case 0:for(T=f=0;f<w;T=f+=1)x[C++]=k[j++];break;case 1:for(T=d=0;d<w;T=d+=1)r=k[j++],s=T<O?0:x[C-O],x[C++]=(r+s)%256;break;case 2:for(T=p=0;p<w;T=p+=1)r=k[j++],o=(T-T%O)/O,l=S&&x[(S-1)*w+o*O+T%O],x[C++]=(l+r)%256;break;case 3:for(T=g=0;g<w;T=g+=1)r=k[j++],o=(T-T%O)/O,s=T<O?0:x[C-O],l=S&&x[(S-1)*w+o*O+T%O],x[C++]=(r+Math.floor((s+l)/2))%256;break;case 4:for(T=m=0;m<w;T=m+=1)r=k[j++],o=(T-T%O)/O,s=T<O?0:x[C-O],0===S?l=u=0:(l=x[(S-1)*w+o*O+T%O],u=o&&x[(S-1)*w+(o-1)*O+T%O]),c=s+l-u,a=Math.abs(c-s),h=Math.abs(c-l),c=Math.abs(c-u),x[C++]=(r+(a<=h&&a<=c?s:h<=c?l:u))%256;break;default:throw new Error("Invalid filter algorithm: "+k[j-1])}if(!b)for(var A=((e+S*n)*F.width+t)*O,L=S*w,T=0;T<v;T+=1){for(var P=0;P<O;P+=1)N[A++]=x[L++];A+=(i-1)*O}S++}}},t.prototype.decodePalette=function(){for(var t,e,i=this.palette,n=this.transparency.indexed||[],r=new Uint8Array((n.length||0)+i.length),o=0,s=0,a=t=0,h=i.length;t<h;a=t+=3)r[o++]=i[a],r[o++]=i[a+1],r[o++]=i[a+2],r[o++]=null!=(e=n[s++])?e:255;return r},t.prototype.copyToImageData=function(t,e){var i,n,r,o,s,a,h,c,l=this.colors,u=null,f=this.hasAlphaChannel;if(this.palette.length&&(u=null!=(c=this._decodedPalette)?c:this._decodedPalette=this.decodePalette(),l=4,f=!0),a=(i=t.data||t).length,r=u||e,n=o=0,1===l)for(;n<a;)s=u?4*e[n/4]:o,h=r[s++],i[n++]=h,i[n++]=h,i[n++]=h,i[n++]=f?r[s++]:255,o=s;else for(;n<a;)s=u?4*e[n/4]:o,i[n++]=r[s++],i[n++]=r[s++],i[n++]=r[s++],i[n++]=f?r[s++]:255,o=s},t.prototype.decode=function(){var t=new Uint8Array(this.width*this.height*4);return this.copyToImageData(t,this.decodePixels()),t};function n(){if("[object Window]"!==Object.prototype.toString.call(li))return!1;try{e=li.document.createElement("canvas"),i=e.getContext("2d")}catch(t){return!1}return!0}return n(),c=function(t){if(!0===n())return i.width=t.width,i.height=t.height,i.clearRect(0,0,t.width,t.height),i.putImageData(t,0,0),(t=new Image).src=e.toDataURL(),t;throw new Error("This method requires a Browser with Canvas-capability.")},t.prototype.decodeFrames=function(t){var e,i,n,r,o,s,a,h;if(this.animation){for(h=[],i=o=0,s=(a=this.animation.frames).length;o<s;i=++o)e=a[i],n=t.createImageData(e.width,e.height),r=this.decodePixels(new Uint8Array(e.data)),this.copyToImageData(n,r),e.imageData=n,h.push(e.image=c(n));return h}},t.prototype.renderFrame=function(t,e){var i=(n=this.animation.frames)[e],n=n[e-1];return 0===e&&t.clearRect(0,0,this.width,this.height),1===(null!=n?n.disposeOp:void 0)?t.clearRect(n.xOffset,n.yOffset,n.width,n.height):2===(null!=n?n.disposeOp:void 0)&&t.putImageData(n.imageData,n.xOffset,n.yOffset),0===i.blendOp&&t.clearRect(i.xOffset,i.yOffset,i.width,i.height),t.drawImage(i.image,i.xOffset,i.yOffset)},t.prototype.animate=function(i){var n,r=this,o=0,t=this.animation,s=t.numFrames,a=t.frames,h=t.numPlays;return(n=function(){var t=o++%s,e=a[t];if(r.renderFrame(i,t),1<s&&o/s<h)return r.animation._timeout=setTimeout(n,e.delay)})()},t.prototype.stopAnimation=function(){var t;return clearTimeout(null!=(t=this.animation)?t._timeout:void 0)},t.prototype.render=function(t){var e;return t._png&&t._png.stopAnimation(),t._png=this,t.width=this.width,t.height=this.height,e=t.getContext("2d"),this.animation?(this.decodeFrames(e),this.animate(e)):(t=e.createImageData(this.width,this.height),this.copyToImageData(t,this.decodePixels()),e.putImageData(t,0,0))},t}();function je(b){var t=0;if(71!==b[t++]||73!==b[t++]||70!==b[t++]||56!==b[t++]||56!=(b[t++]+1&253)||97!==b[t++])throw new Error("Invalid GIF 87a/89a header.");var w=b[t++]|b[t++]<<8,e=b[t++]|b[t++]<<8,i=b[t++],n=1<<1+(7&i);b[t++],b[t++];var r=null,o=null;i>>7&&(r=t,t+=3*(o=n));var s=!0,a=[],h=0,c=null,l=0,u=null;for(this.width=w,this.height=e;s&&t<b.length;)switch(b[t++]){case 33:switch(b[t++]){case 255:if(11!==b[t]||78==b[t+1]&&69==b[t+2]&&84==b[t+3]&&83==b[t+4]&&67==b[t+5]&&65==b[t+6]&&80==b[t+7]&&69==b[t+8]&&50==b[t+9]&&46==b[t+10]&&48==b[t+11]&&3==b[t+12]&&1==b[t+13]&&0==b[t+16])t+=14,u=b[t++]|b[t++]<<8,t++;else for(t+=12;;){if(!(0<=(A=b[t++])))throw Error("Invalid block size");if(0===A)break;t+=A}break;case 249:if(4!==b[t++]||0!==b[t+4])throw new Error("Invalid graphics extension block.");var f=b[t++],h=b[t++]|b[t++]<<8,c=b[t++];0==(1&f)&&(c=null),l=f>>2&7,t++;break;case 254:for(;;){if(!(0<=(A=b[t++])))throw Error("Invalid block size");if(0===A)break;t+=A}break;default:throw new Error("Unknown graphic control label: 0x"+b[t-1].toString(16))}break;case 44:var d=b[t++]|b[t++]<<8,p=b[t++]|b[t++]<<8,g=b[t++]|b[t++]<<8,m=b[t++]|b[t++]<<8,v=b[t++],y=v>>6&1,x=1<<1+(7&v),_=r,S=o,C=!1;v>>7&&(C=!0,_=t,t+=3*(S=x));var A,x=t;for(t++;;){if(!(0<=(A=b[t++])))throw Error("Invalid block size");if(0===A)break;t+=A}a.push({x:d,y:p,width:g,height:m,has_local_palette:C,palette_offset:_,palette_size:S,data_offset:x,data_length:t-x,transparent_index:c,interlaced:!!y,delay:h,disposal:l});break;case 59:s=!1;break;default:throw new Error("Unknown gif block: 0x"+b[t-1].toString(16))}this.numFrames=function(){return a.length},this.loopCount=function(){return u},this.frameInfo=function(t){if(t<0||t>=a.length)throw new Error("Frame index out of range.");return a[t]},this.decodeAndBlitFrameBGRA=function(t,e){var i=this.frameInfo(t),t=i.width*i.height,n=new Uint8Array(t);Fe(b,i.data_offset,n,t);var r=i.palette_offset,o=i.transparent_index;null===o&&(o=256);var s=i.width,a=w-s,h=s,c=4*(i.y*w+i.x),l=4*((i.y+i.height)*w+i.x),u=c,f=4*a;!0===i.interlaced&&(f+=4*w*7);for(var d=8,p=0,g=n.length;p<g;++p){var m,v,y=n[p];0===h&&(h=s,(u+=f)>=l&&(f=4*a+4*w*(d-1),u=c+(s+a)*(d<<1),d>>=1)),y===o?u+=4:(m=b[r+3*y],v=b[r+3*y+1],y=b[r+3*y+2],e[u++]=y,e[u++]=v,e[u++]=m,e[u++]=255),--h}},this.decodeAndBlitFrameRGBA=function(t,e){var i=this.frameInfo(t),t=i.width*i.height,n=new Uint8Array(t);Fe(b,i.data_offset,n,t);var r=i.palette_offset,o=i.transparent_index;null===o&&(o=256);var s=i.width,a=w-s,h=s,c=4*(i.y*w+i.x),l=4*((i.y+i.height)*w+i.x),u=c,f=4*a;!0===i.interlaced&&(f+=4*w*7);for(var d=8,p=0,g=n.length;p<g;++p){var m,v,y=n[p];0===h&&(h=s,(u+=f)>=l&&(f=4*a+4*w*(d-1),u=c+(s+a)*(d<<1),d>>=1)),y===o?u+=4:(m=b[r+3*y],v=b[r+3*y+1],y=b[r+3*y+2],e[u++]=m,e[u++]=v,e[u++]=y,e[u++]=255),--h}}}function Fe(t,e,i,n){for(var r=t[e++],o=1<<r,s=1+o,a=1+s,h=r+1,c=(1<<h)-1,l=0,u=0,f=0,d=t[e++],p=new Int32Array(4096),g=null;;){for(;l<16&&0!==d;)u|=t[e++]<<l,l+=8,1===d?d=t[e++]:--d;if(l<h)break;var m=u&c;if(u>>=h,l-=h,m!=o){if(m==s)break;for(var v=m<a?m:g,y=0,b=v;o<b;)b=p[b]>>8,++y;var w=b;if(n<f+y+(v!==m?1:0))return ui.log("Warning, gif stream longer than expected."),0;i[f++]=w;var x=f+=y;for(v!==m&&(i[f++]=w),b=v;y--;)b=p[b],i[--x]=255&b,b>>=8;null!==g&&a<4096&&(p[a++]=g<<8|w,c+1<=a&&h<12&&(++h,c=c<<1|1)),g=m}else a=1+s,c=(1<<(h=r+1))-1,g=null}return f!==n&&ui.log("Warning, gif stream shorter than expected."),i}function Ee(t){var y,b,w,x,e,u=Math.floor,_=new Array(64),S=new Array(64),C=new Array(64),A=new Array(64),g=new Array(65535),m=new Array(65535),N=new Array(64),v=new Array(64),L=[],T=0,P=7,k=new Array(64),O=new Array(64),j=new Array(64),i=new Array(256),F=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],I=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],D=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],B=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],R=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],z=[0,1,2,3,4,5,6,7,8,9,10,11],q=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],U=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function n(t,e){for(var i=0,n=0,r=new Array,o=1;o<=16;o++){for(var s=1;s<=t[o];s++)r[e[n]]=[],r[e[n]][0]=i,r[e[n]][1]=o,n++,i++;i*=2}return r}function W(t){for(var e=t[0],i=t[1]-1;0<=i;)e&1<<i&&(T|=1<<P),i--,--P<0&&(255==T?(H(255),H(0)):H(T),P=7,T=0)}function H(t){L.push(t)}function V(t){H(t>>8&255),H(255&t)}function X(t,e,i,n,r){for(var o,s=r[0],a=r[240],h=function(t,e){for(var i,n,r=0,o=0;o<8;++o){var s=t[r],a=t[r+1],h=t[r+2],c=t[r+3],l=t[r+4],u=t[r+5],f=t[r+6],d=s+(i=t[r+7]),p=s-i,g=a+f,m=a-f,v=h+u,y=h-u,b=c+l,w=c-l,x=d+b,d=d-b,b=g+v,g=g-v;t[r]=x+b,t[r+4]=x-b;v=.707106781*(g+d);t[r+2]=d+v,t[r+6]=d-v;w=.382683433*((x=w+y)-(g=m+p)),x=.5411961*x+w,w=1.306562965*g+w,m=.707106781*(y+m),b=p+m,m=p-m;t[r+5]=m+x,t[r+3]=m-x,t[r+1]=b+w,t[r+7]=b-w,r+=8}for(o=r=0;o<8;++o){s=t[r],a=t[r+8],h=t[r+16],c=t[r+24],l=t[r+32],u=t[r+40],f=t[r+48];var _=s+(i=t[r+56]),S=s-i,C=a+f,A=a-f,L=h+u,T=h-u,P=c+l,k=c-l,O=_+P,_=_-P,P=C+L,C=C-L;t[r]=O+P,t[r+32]=O-P;L=.707106781*(C+_);t[r+16]=_+L,t[r+48]=_-L;k=.382683433*((O=k+T)-(C=A+S)),O=.5411961*O+k,k=1.306562965*C+k,A=.707106781*(T+A),P=S+A,A=S-A;t[r+40]=A+O,t[r+24]=A-O,t[r+8]=P+k,t[r+56]=P-k,r++}for(o=0;o<64;++o)n=t[o]*e[o],N[o]=0<n?.5+n|0:n-.5|0;return N}(t,e),c=0;c<64;++c)v[E[c]]=h[c];e=v[0]-i;i=v[0],0==e?W(n[0]):(W(n[m[o=32767+e]]),W(g[o]));for(var l=63;0<l&&0==v[l];)l--;if(0==l)return W(s),i;for(var u=1;u<=l;){for(var f=u;0==v[u]&&u<=l;)++u;f=u-f;if(16<=f){for(var d=f>>4,p=1;p<=d;++p)W(a);f&=15}o=32767+v[u],W(r[(f<<4)+m[o]]),W(g[o]),u++}return 63!=l&&W(s),i}function G(t){t=Math.min(Math.max(t,1),100),e!=t&&(function(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],i=0;i<64;i++){var n=u((e[i]*t+50)/100),n=Math.min(Math.max(n,1),255);_[E[i]]=n}for(var r=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],o=0;o<64;o++){var s=u((r[o]*t+50)/100),s=Math.min(Math.max(s,1),255);S[E[o]]=s}for(var a=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],h=0,c=0;c<8;c++)for(var l=0;l<8;l++)C[h]=1/(_[E[h]]*a[c]*a[l]*8),A[h]=1/(S[E[h]]*a[c]*a[l]*8),h++}(t<50?Math.floor(5e3/t):Math.floor(200-2*t)),e=t)}this.encode=function(t,e){e&&G(e),L=new Array,T=0,P=7,V(65496),V(65504),V(16),H(74),H(70),H(73),H(70),H(0),H(1),H(1),H(0),V(1),V(1),H(0),H(0),function(){V(65499),V(132),H(0);for(var t=0;t<64;t++)H(_[t]);H(1);for(var e=0;e<64;e++)H(S[e])}(),p=t.width,e=t.height,V(65472),V(17),H(8),V(e),V(p),H(3),H(1),H(17),H(0),H(2),H(17),H(1),H(3),H(17),H(1),function(){V(65476),V(418),H(0);for(var t=0;t<16;t++)H(I[t+1]);for(var e=0;e<=11;e++)H(D[e]);H(16);for(var i=0;i<16;i++)H(M[i+1]);for(var n=0;n<=161;n++)H(B[n]);H(1);for(var r=0;r<16;r++)H(R[r+1]);for(var o=0;o<=11;o++)H(z[o]);H(17);for(var s=0;s<16;s++)H(q[s+1]);for(var a=0;a<=161;a++)H(U[a])}(),V(65498),V(12),H(3),H(1),H(0),H(2),H(17),H(3),H(17),H(0),H(63),H(0);var i=0,n=0,r=0;T=0,P=7,this.encode.displayName="_encode_";for(var o,s,a,h,c,l,u,f,d=t.data,p=t.width,g=t.height,m=4*p,v=0;v<g;){for(o=0;o<m;){for(h=m*v+o,f=0;f<64;f++)c=h+(u=f>>3)*m+(l=4*(7&f)),g<=v+u&&(c-=m*(v+1+u-g)),m<=o+l&&(c-=o+l-m+4),s=d[c++],a=d[c++],c=d[c++],k[f]=(F[s]+F[a+256>>0]+F[c+512>>0]>>16)-128,O[f]=(F[s+768>>0]+F[a+1024>>0]+F[c+1280>>0]>>16)-128,j[f]=(F[s+1280>>0]+F[a+1536>>0]+F[c+1792>>0]>>16)-128;i=X(k,C,i,y,w),n=X(O,A,n,b,x),r=X(j,A,r,b,x),o+=32}v+=8}return 0<=P&&((p=[])[1]=P+1,p[0]=(1<<P+1)-1,W(p)),V(65497),new Uint8Array(L)},t=t||50,function(){for(var t=String.fromCharCode,e=0;e<256;e++)i[e]=t(e)}(),y=n(I,D),b=n(R,z),w=n(M,B),x=n(q,U),function(){for(var t=1,e=2,i=1;i<=15;i++){for(var n=t;n<e;n++)m[32767+n]=i,g[32767+n]=[],g[32767+n][1]=i,g[32767+n][0]=n;for(var r=-(e-1);r<=-t;r++)m[32767+r]=i,g[32767+r]=[],g[32767+r][1]=i,g[32767+r][0]=e-1+r;t<<=1,e<<=1}}(),function(){for(var t=0;t<256;t++)F[t]=19595*t,F[t+256>>0]=38470*t,F[t+512>>0]=7471*t+32768,F[t+768>>0]=-11059*t,F[t+1024>>0]=-21709*t,F[t+1280>>0]=32768*t+8421375,F[t+1536>>0]=-27439*t,F[t+1792>>0]=-5329*t}(),G(t)}function Ie(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function De(t){function Er(t){if(!t)throw Error("assert :P")}function Ir(t,e,i){for(var n=0;n<4;n++)if(t[e+n]!=i.charCodeAt(n))return 1}function Dr(t,e,i,n,r){for(var o=0;o<r;o++)t[e+o]=i[n+o]}function Mr(t,e,i,n){for(var r=0;r<n;r++)t[e+r]=i}function Br(t){return new Int32Array(t)}function Rr(t,e){for(var i=[],n=0;n<t;n++)i.push(new e);return i}function zr(t,s){var e=[];return function t(e,i,n){for(var r=n[i],o=0;o<r&&(e.push(n.length>i+1?[]:new s),!(n.length<i+1));o++)t(e[o],i+1,n)}(e,0,t),e}function d(t,e){return(t[e+0]<<0|t[e+1]<<8|t[e+2]<<16)>>>0}function p(t,e){return(t[e+0]<<0|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}new(De=function(){var m=this;function b(t,e){for(var i=1<<e-1>>>0;t&i;)i>>>=1;return i?(t&i-1)+i:t}function w(t,e,i,n,r){for(Er(!(n%i));t[e+(n-=i)]=r,0<n;);}function Ht(t,e,i,n,r){if(Er(r<=2328),r<=512)var o=Br(512);else if(null==(o=Br(r)))return 0;return function(t,e,i,n,r,o){var s=e,a=1<<i,h=Br(16),c=Br(16);for(Er(0!=r),Er(null!=n),Er(null!=t),Er(0<i),v=0;v<r;++v){if(15<n[v])return 0;++h[n[v]]}if(h[0]==r)return 0;for(c[1]=0,y=1;y<15;++y){if(h[y]>1<<y)return 0;c[y+1]=c[y]+h[y]}for(v=0;v<r;++v)y=n[v],0<n[v]&&(o[c[y]++]=v);if(1==c[15])return(n=new Vt).g=0,n.value=o[0],w(t,s,1,a,n),a;var l,u=-1,f=a-1,d=0,p=1,g=1,m=1<<i,v=0,y=1;for(r=2;y<=i;++y,r<<=1){if(p+=g<<=1,(g-=h[y])<0)return 0;for(;0<h[y];--h[y])(n=new Vt).g=y,n.value=o[v++],w(t,s+d,r,m,n),d=b(d,y)}for(y=i+1,r=2;y<=15;++y,r<<=1){if(p+=g<<=1,(g-=h[y])<0)return 0;for(;0<h[y];--h[y]){if(n=new Vt,(d&f)!=u){for(s+=m,l=1<<(u=y)-i;u<15&&!((l-=h[u])<=0);)++u,l<<=1;a+=m=1<<(l=u-i),t[e+(u=d&f)].g=l+i,t[e+u].value=s-e-u}n.g=y-i,n.value=o[v++],w(t,s+(d>>i),r,m,n),d=b(d,y)}}return p!=2*c[15]-1?0:a}(t,e,i,n,r,o)}function Vt(){this.value=this.g=0}function t(){this.value=this.g=0}function Xt(){this.G=Rr(5,Vt),this.H=Br(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=Rr(Oi,t)}function p(t,e,i,n){Er(null!=t),Er(null!=e),Er(n<2147483648),t.Ca=254,t.I=0,t.b=-8,t.Ka=0,t.oa=e,t.pa=i,t.Jd=e,t.Yc=i+n,t.Zc=4<=n?i+n-4+1:i,y(t)}function g(t,e){for(var i=0;0<e--;)i|=R(t,128)<<e;return i}function v(t,e){e=g(t,e);return x(t)?-e:e}function M(t,e,i,n){var r,o=0;for(Er(null!=t),Er(null!=e),Er(n<4294967288),t.Sb=n,t.Ra=0,t.u=0,4<n&&(n=4),r=t.h=0;r<n;++r)o+=e[i+r]<<8*r;t.Ra=o,t.bb=n,t.oa=e,t.pa=i}function n(t){for(;8<=t.u&&t.bb<t.Sb;)t.Ra>>>=8,t.Ra+=t.oa[t.pa+t.bb]<<Fi-8>>>0,++t.bb,t.u-=8;B(t)&&(t.h=1,t.u=0)}function Gt(t,e){if(Er(0<=e),!t.h&&e<=ji){var i=Yt(t)&Ni[e];return t.u+=e,n(t),i}return t.h=1,t.u=0}function e(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function P(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Yt(t){return t.Ra>>>(t.u&Fi-1)>>>0}function B(t){return Er(t.bb<=t.Sb),t.h||t.bb==t.Sb&&t.u>Fi}function Kt(t,e){t.u=e,t.h=B(t)}function Jt(t){t.u>=Ei&&(Er(t.u>=Ei),n(t))}function y(t){Er(null!=t&&null!=t.oa),t.pa<t.Zc?(t.I=(t.oa[t.pa++]|t.I<<8)>>>0,t.b+=8):(Er(null!=t&&null!=t.oa),t.pa<t.Yc?(t.b+=8,t.I=t.oa[t.pa++]|t.I<<8):t.Ka?t.b=0:(t.I<<=8,t.b+=8,t.Ka=1))}function x(t){return g(t,1)}function R(t,e){var i=t.Ca;t.b<0&&y(t);var n=t.b,r=i*e>>>8,e=+(t.I>>>n>r);for(e?(i-=r,t.I-=r+1<<n>>>0):i=r+1,n=i,r=0;256<=n;)r+=8,n>>=8;return n=7^r+Ii[n],t.b-=n,t.Ca=(i<<n)-1,e}function s(t,e,i){t[e+0]=i>>24&255,t[e+1]=i>>16&255,t[e+2]=i>>8&255,t[e+3]=i>>0&255}function i(t,e){return t[e+0]<<0|t[e+1]<<8}function k(t,e){return i(t,e)|t[e+2]<<16}function O(t,e){return i(t,e)|i(t,e+2)<<16}function $t(t,e){var i=1<<e;return Er(null!=t),Er(0<e),t.X=Br(i),null!=t.X&&(t.Mb=32-e,t.Xa=e,1)}function C(t,e){Er(null!=t),Er(null!=e),Er(t.Xa==e.Xa),Dr(e.X,0,t.X,0,1<<e.Xa)}function r(){this.X=[],this.Xa=this.Mb=0}function d(t,e,i,n){Er(null!=i),Er(null!=n);var r=i[0],o=n[0];return 0==r&&(r=(t*o+e/2)/e),0==o&&(o=(e*r+t/2)/t),!(r<=0||o<=0)&&(i[0]=r,n[0]=o,1)}function Zt(t,e){return t+(1<<e)-1>>>e}function Qt(t,e){return((4278255360&t)+(4278255360&e)>>>0&4278255360)+((16711935&t)+(16711935&e)>>>0&16711935)>>>0}function o(c,t){m[t]=function(t,e,i,n,r,o,s){for(var a=0;a<r;++a){var h=m[c](o[s+a-1],i,n+a);o[s+a]=Qt(t[e+a],h)}}}function N(){this.ud=this.hd=this.jd=0}function a(t,e){return((4278124286&(t^e))>>>1)+(t&e)>>>0}function h(t){return 0<=t&&t<256?t:t<0?0:255<t?255:void 0}function c(t,e){return h(t+(t-e+.5>>1))}function l(t,e,i){return Math.abs(e-i)-Math.abs(t-i)}function j(t,e,i,n,r,o,s){for(n=o[s-1],i=0;i<r;++i)o[s+i]=n=Qt(t[e+i],n)}function u(t,e,i,n,r){for(var o=0;o<i;++o){var s=t[e+o],a=s>>8&255,h=16711935&(h=16711935&s)+((a<<16)+a);n[r+o]=(4278255360&s)+h>>>0}}function F(t,e){e.jd=t>>0&255,e.hd=t>>8&255,e.ud=t>>16&255}function f(t,e,i,n,r,o){for(var s=0;s<n;++s){var a=e[i+s],h=a>>>8,c=a,l=255&(l=a>>>16)+((t.jd<<24>>24)*(h<<24>>24)>>>5),c=255&(c+=(t.hd<<24>>24)*(h<<24>>24)>>>5)+((t.ud<<24>>24)*(l<<24>>24)>>>5);r[o+s]=(4278255360&a)+(l<<16)+c}}function _(t,e,d,p,g){m[e]=function(t,e,i,n,r,o,s,a,h){for(n=s;n<a;++n)for(s=0;s<h;++s)r[o++]=g(i[p(t[e++])])},m[t]=function(t,e,i,n,r,o,s){var a=8>>t.b,h=t.Ea,c=t.K[0],l=t.w;if(a<8)for(t=(1<<t.b)-1,l=(1<<a)-1;e<i;++e)for(var u=0,f=0;f<h;++f)f&t||(u=p(n[r++])),o[s++]=g(c[u&l]),u>>=a;else m["VP8LMapColor"+d](n,r,c,l,o,s,e,i,h)}}function S(t,e,i,n,r){for(i=e+i;e<i;){var o=t[e++];n[r++]=o>>16&255,n[r++]=o>>8&255,n[r++]=o>>0&255}}function A(t,e,i,n,r){for(i=e+i;e<i;){var o=t[e++];n[r++]=o>>16&255,n[r++]=o>>8&255,n[r++]=o>>0&255,n[r++]=o>>24&255}}function L(t,e,i,n,r){for(i=e+i;e<i;){var o=(s=t[e++])>>16&240|s>>12&15,s=s>>0&240|s>>28&15;n[r++]=o,n[r++]=s}}function T(t,e,i,n,r){for(i=e+i;e<i;){var o=(s=t[e++])>>16&248|s>>13&7,s=s>>5&224|s>>3&31;n[r++]=o,n[r++]=s}}function E(t,e,i,n,r){for(i=e+i;e<i;){var o=t[e++];n[r++]=o>>0&255,n[r++]=o>>8&255,n[r++]=o>>16&255}}function I(t,e,i,n,r,o){if(0==o)for(i=e+i;e<i;)s(n,((o=t[e++])[0]>>24|o[1]>>8&65280|o[2]<<8&16711680|o[3]<<24)>>>0),r+=32;else Dr(n,r,t,e,i)}function D(t,e){m[e][0]=m[t+"0"],m[e][1]=m[t+"1"],m[e][2]=m[t+"2"],m[e][3]=m[t+"3"],m[e][4]=m[t+"4"],m[e][5]=m[t+"5"],m[e][6]=m[t+"6"],m[e][7]=m[t+"7"],m[e][8]=m[t+"8"],m[e][9]=m[t+"9"],m[e][10]=m[t+"10"],m[e][11]=m[t+"11"],m[e][12]=m[t+"12"],m[e][13]=m[t+"13"],m[e][14]=m[t+"0"],m[e][15]=m[t+"0"]}function z(t){return t==In||t==Dn||t==Mn||t==Bn}function q(){this.eb=[],this.size=this.A=this.fb=0}function U(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function W(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new q,this.f.kb=new U,this.sd=null}function H(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function V(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function X(t){return alert("todo:WebPSamplerProcessPlane"),t.T}function G(t,e){var i=t.T,n=e.ba.f.RGBA,r=n.eb,o=n.fb+t.ka*n.A,s=cr[e.ba.S],a=t.y,h=t.O,c=t.f,l=t.N,u=t.ea,f=t.W,d=e.cc,p=e.dc,g=e.Mc,m=e.Nc,v=t.ka,y=t.ka+t.T,b=t.U,w=b+1>>1;for(0==v?s(a,h,null,null,c,l,u,f,c,l,u,f,r,o,null,null,b):(s(e.ec,e.fc,a,h,d,p,g,m,c,l,u,f,r,o-n.A,r,o,b),++i);v+2<y;v+=2)p=l,m=f,l+=t.Rc,f+=t.Rc,o+=2*n.A,s(a,(h+=2*t.fa)-t.fa,a,h,d=c,p,g=u,m,c,l,u,f,r,o-n.A,r,o,b);return h+=t.fa,t.j+y<t.o?(Dr(e.ec,e.fc,a,h,b),Dr(e.cc,e.dc,c,l,w),Dr(e.Mc,e.Nc,u,f,w),i--):1&y||s(a,h,null,null,c,l,u,f,c,l,u,f,r,o+n.A,null,null,b),i}function Y(t,e,i){var n,r,o,s,a,h,c=t.F,l=[t.J];return null!=c&&(n=t.U,o=(r=e.ba.S)==jn||r==Mn,e=e.ba.f.RGBA,h=t.ka,(s=[0])[0]=t.T,t.Kb&&(0==h?--s[0]:(--h,l[0]-=t.width),t.j+t.ka+t.T==t.o&&(s[0]=t.o-t.j-h)),a=e.eb,h=e.fb+h*e.A,t=vn(c,l[0],t.width,n,s,a,h+(o?0:3),e.A),Er(i==s),t&&z(r)&&gn(a,h,o,n,s,e.A)),0}function K(t){var e=t.ma,i=e.ba.S,n=i<11,r=i==kn||i==Nn||i==jn||i==Fn||12==i||z(i);if(e.memory=null,e.Ib=null,e.Jb=null,e.Nd=null,!Ti(e.Oa,t,r?11:12))return 0;if(r&&z(i)&&li(),t.da)alert("todo:use_scaling");else{if(n){if(e.Ib=X,t.Kb){if(i=t.U+1>>1,e.memory=Br(t.U+2*i),null==e.memory)return 0;e.ec=e.memory,e.fc=0,e.cc=e.ec,e.dc=e.fc+t.U,e.Mc=e.cc,e.Nc=e.dc+i,e.Ib=G,li()}}else alert("todo:EmitYUV");r&&(e.Jb=Y,n&&hi())}if(n&&!Sr){for(t=0;t<256;++t)Cr[t]=89858*(t-128)+yr>>vr,Tr[t]=-22014*(t-128)+yr,Lr[t]=-45773*(t-128),Ar[t]=113618*(t-128)+yr>>vr;for(t=br;t<wr;++t)Pr[t-br]=Ct(e=76283*(t-16)+yr>>vr,255),kr[t-br]=Ct(e+8>>4,15);Sr=1}return 1}function J(t){var e=t.ma,i=t.U,n=t.T;return Er(!(1&t.ka)),i<=0||n<=0?0:(i=e.Ib(t,e),null!=e.Jb&&e.Jb(t,e,i),e.Dc+=i,1)}function $(t){t.ma.memory=null}function Z(t,e,i,n){return 47==Gt(t,8)&&(e[0]=Gt(t,14)+1,i[0]=Gt(t,14)+1,n[0]=Gt(t,1),0==Gt(t,3)&&!t.h)}function Q(t,e){if(t<4)return t+1;var i=t-2>>1;return(2+(1&t)<<i)+Gt(e,i)+1}function tt(t,e){return 120<e?e-120:1<=(e=((e=Hn[e-1])>>4)*t+(8-(15&e)))?e:1}function et(t,e,i){var n,r=t[e+=255&(n=Yt(i))].g-8;return 0<r&&(Kt(i,i.u+8),n=Yt(i),e+=t[e].value,e+=n&(1<<r)-1),Kt(i,i.u+t[e].g),t[e].value}function te(t,e,i){return i.g+=t.g,i.value+=t.value<<e>>>0,Er(i.g<=8),t.g}function it(t,e,i){var n=t.xc;return Er((e=0==n?0:t.vc[t.md*(i>>n)+(e>>n)])<t.Wb),t.Ya[e]}function nt(t,e,i,n){var r=t.ab,o=t.c*e,s=t.C;e=s+e;var a=i,h=n;for(n=t.Ta,i=t.Ua;0<r--;){var c=t.gc[r],l=s,u=e,f=a,d=h,p=(h=n,a=i,c.Ea);switch(Er(l<u),Er(u<=c.nc),c.hc){case 2:Bi(f,d,(u-l)*p,h,a);break;case 0:var g=l,m=u,v=h,y=a,b=(C=c).Ea;0==g&&(Di(f,d,null,null,1,v,y),j(f,d+1,0,0,b-1,v,y+1),d+=b,y+=b,++g);for(var w=1<<C.b,x=w-1,_=Zt(b,C.b),S=C.K,C=C.w+(g>>C.b)*_;g<m;){var A=S,L=C,T=1;for(Mi(f,d,v,y-b,1,v,y);T<b;){var P=(T&~x)+w;b<P&&(P=b),(0,Wi[A[L++]>>8&15])(f,d+ +T,v,y+T-b,P-T,v,y+T),T=P}d+=b,y+=b,++g&x||(C+=_)}u!=c.nc&&Dr(h,a-p,h,a+(u-l-1)*p,p);break;case 1:for(p=f,m=d,b=(f=c.Ea)-(y=f&~(v=(d=1<<c.b)-1)),g=Zt(f,c.b),w=c.K,c=c.w+(l>>c.b)*g;l<u;){for(x=w,_=c,S=new N,C=m+y,A=m+f;m<C;)F(x[_++],S),Hi(S,p,m,d,h,a),m+=d,a+=d;m<A&&(F(x[_++],S),Hi(S,p,m,b,h,a),m+=b,a+=b),++l&v||(c+=g)}break;case 3:if(f==h&&d==a&&0<c.b){for(m=h,f=p=a+(u-l)*p-(y=(u-l)*Zt(c.Ea,c.b)),d=h,v=a,g=[],y=(b=y)-1;0<=y;--y)g[y]=d[v+y];for(y=b-1;0<=y;--y)m[f+y]=g[y];Ri(c,l,u,h,p,h,a)}else Ri(c,l,u,f,d,h,a)}a=n,h=i}h!=i&&Dr(n,i,a,h,o)}function rt(t,e){var i=t.V,n=t.Ba+t.c*t.C,r=e-t.C;if(Er(e<=t.l.o),Er(r<=16),0<r){var o,s=t.l,a=t.Ta,h=t.Ua,c=s.width;if(nt(t,r,i,n),r=h=[h],Er((i=t.C)<(n=e)),Er(s.v<s.va),n>s.o&&(n=s.o),i<s.j&&(o=s.j-i,i=s.j,r[0]+=o*c),i=n<=i?0:(r[0]+=4*s.v,s.ka=i-s.j,s.U=s.va-s.v,s.T=n-i,1)){if(h=h[0],(i=t.ca).S<11){for(var l=i.f.RGBA,u=(n=i.S,r=s.U,s=s.T,o=l.eb,l.A),f=s,l=l.fb+t.Ma*l.A;0<f--;){var d=a,p=h,g=r,m=o,v=l;switch(n){case Pn:Vi(d,p,g,m,v);break;case kn:Xi(d,p,g,m,v);break;case In:Xi(d,p,g,m,v),gn(m,v,0,g,1,0);break;case On:Ki(d,p,g,m,v);break;case Nn:I(d,p,g,m,v,1);break;case Dn:I(d,p,g,m,v,1),gn(m,v,0,g,1,0);break;case jn:I(d,p,g,m,v,0);break;case Mn:I(d,p,g,m,v,0),gn(m,v,1,g,1,0);break;case Fn:Gi(d,p,g,m,v);break;case Bn:Gi(d,p,g,m,v),mn(m,v,g,1,0);break;case En:Yi(d,p,g,m,v);break;default:Er(0)}h+=c,l+=u}t.Ma+=s}else alert("todo:EmitRescaledRowsYUVA");Er(t.Ma<=i.height)}}t.C=e,Er(t.C<=t.i)}function ot(t){var e;if(0<t.ua)return 0;for(e=0;e<t.Wb;++e){var i=t.Ya[e].G,n=t.Ya[e].H;if(0<i[1][n[1]+0].g||0<i[2][n[2]+0].g||0<i[3][n[3]+0].g)return 0}return 1}function st(t,e,i,n,r,o){if(0!=t.Z){var s=t.qd,a=t.rd;for(Er(null!=hr[t.Z]);e<i;++e)hr[t.Z](s,a,n,r,n,r,o),s=n,a=r,r+=o;t.qd=s,t.rd=a}}function at(t,e){var i,n,r,o,s,a,h=t.l.ma,c=0==h.Z||1==h.Z?t.l.j:t.C,c=t.C<c?c:t.C;Er(e<=t.l.o),c<e&&(i=t.l.width,n=h.ca,r=h.tb+i*c,o=t.V,s=t.Ba+t.c*c,a=t.gc,Er(1==t.ab),Er(3==a[0].hc),qi(a[0],c,e,o,s,n,r),st(h,c,e,n,r,i)),t.C=t.Ma=e}function ee(t,e,i,n,r,o,s){var a=t.$/n,h=t.$%n,c=t.m,l=t.s,u=i+t.$,f=u;r=i+n*r;var d=i+n*o,p=280+l.ua,g=t.Pb?a:16777216,m=0<l.ua?l.Wa:null,v=l.wc,y=u<d?it(l,h,a):null;Er(t.C<o),Er(d<=r);var b=!1;t:for(;;){for(;b||u<d;){var w,x,_,S=0;if(g<=a&&(w=u-i,Er((g=t).Pb),g.wd=g.m,g.xd=w,0<g.s.ua&&C(g.s.Wa,g.s.vb),g=a+Xn),Er(null!=(y=!(h&v)?it(l,h,a):y)),y.Qb&&(e[u]=y.qb,b=!0),b||(Jt(c),y.jc?(w=e,x=u,_=y.pd[Yt(S=c)&Oi-1],Er(y.jc),0==(S=_.g<256?(Kt(S,S.u+_.g),w[x]=_.value,0):(Kt(S,S.u+_.g-256),Er(256<=_.value),_.value))&&(b=!0)):S=et(y.G[0],y.H[0],c)),c.h)break;if(b||S<256){if(!b)if(y.nd)e[u]=(y.qb|S<<8)>>>0;else{if(Jt(c),b=et(y.G[1],y.H[1],c),Jt(c),w=et(y.G[2],y.H[2],c),x=et(y.G[3],y.H[3],c),c.h)break;e[u]=(x<<24|b<<16|S<<8|w)>>>0}if(b=!1,++u,++h>=n&&(h=0,++a,null!=s&&a<=o&&!(a%16)&&s(t,a),null!=m))for(;f<u;)S=e[f++],m.X[(506832829*S&4294967295)>>>m.Mb]=S}else if(S<280){if(S=Q(S-256,c),w=et(y.G[4],y.H[4],c),Jt(c),w=tt(n,w=Q(w,c)),c.h)break;if(u-i<w||r-u<S)break t;for(x=0;x<S;++x)e[u+x]=e[u+x-w];for(u+=S,h+=S;n<=h;)h-=n,++a,null!=s&&a<=o&&!(a%16)&&s(t,a);if(Er(u<=r),h&v&&(y=it(l,h,a)),null!=m)for(;f<u;)S=e[f++],m.X[(506832829*S&4294967295)>>>m.Mb]=S}else{if(!(S<p))break t;for(b=S-280,Er(null!=m);f<u;)S=e[f++],m.X[(506832829*S&4294967295)>>>m.Mb]=S;S=u,Er(!(b>>>(w=m).Xa)),e[S]=w.X[b],b=!0}b||Er(c.h==B(c))}if(t.Pb&&c.h&&u<r)Er(t.m.h),t.a=5,t.m=t.wd,t.$=t.xd,0<t.s.ua&&C(t.s.vb,t.s.Wa);else{if(c.h)break t;null!=s&&s(t,o<a?o:a),t.a=0,t.$=u-i}return 1}return t.a=3,0}function ie(t){Er(null!=t),t.vc=null,t.yc=null,t.Ya=null;var e=t.Wa;null!=e&&(e.X=null),Er((t.vb=null)!=t)}function ht(){var t=new Qe;return null==t?null:(t.a=0,t.xb=ar,D("Predictor","VP8LPredictors"),D("Predictor","VP8LPredictors_C"),D("PredictorAdd","VP8LPredictorsAdd"),D("PredictorAdd","VP8LPredictorsAdd_C"),Bi=u,Hi=f,Vi=S,Xi=A,Gi=L,Yi=T,Ki=E,m.VP8LMapColor32b=zi,m.VP8LMapColor8b=Ui,t)}function ne(t,e,i,n,r){var o,s=1,a=[t],h=[e],c=n.m,l=n.s,u=null,f=0;t:for(;;){if(i)for(;s&&Gt(c,1);){var d=a,p=h,g=n,m=1,v=g.m,y=g.gc[g.ab],b=Gt(v,2);if(g.Oc&1<<b)s=0;else{switch(g.Oc|=1<<b,y.hc=b,y.Ea=d[0],y.nc=p[0],y.K=[null],++g.ab,Er(g.ab<=4),b){case 0:case 1:y.b=Gt(v,3)+2,m=ne(Zt(y.Ea,y.b),Zt(y.nc,y.b),0,g,y.K),y.K=y.K[0];break;case 3:var w=Gt(v,8)+1,x=16<w?0:4<w?1:2<w?2:3;if(d[0]=Zt(y.Ea,x),y.b=x,x=m=ne(w,1,0,g,y.K)){var _,S=w,w=y,C=1<<(8>>w.b),A=Br(C);if(null==A)x=0;else{var L=w.K[0],T=w.w;for(A[0]=w.K[0][0],_=1;_<+S;++_)A[_]=Qt(L[T+_],A[_-1]);for(;_<4*C;++_)A[_]=0;w.K[0]=null,w.K[0]=A,x=1}}m=x;break;case 2:break;default:Er(0)}s=m}}if(a=a[0],h=h[0],s&&Gt(c,1)&&!(s=1<=(f=Gt(c,4))&&f<=11)){n.a=3;break t}if(o=s)e:{var P,k=n,O=a,N=h,j=f,F=i,E=k.m,I=k.s,D=[null],M=1,B=0,R=Vn[j];i:for(;;){if(F&&Gt(E,1)){var z=Gt(E,3)+2,q=Zt(O,z),U=Zt(N,z),W=q*U;if(!ne(q,U,0,k,D))break i;for(D=D[0],I.xc=z,K=0;K<W;++K){var H=D[K]>>8&65535;M<=(D[K]=H)&&(M=1+H)}}if(E.h)break i;for(it=0;it<5;++it){var V=qn[it];!it&&0<j&&(V+=1<<j),B<V&&(B=V)}var q=Rr(M*R,Vt),U=M,z=Rr(U,Xt),X=null==z?null:(Er(U<=65536),z),G=Br(B);if(null==X||null==G||null==q){k.a=1;break i}for(var Y=q,K=P=0;K<M;++K){for(var J=X[K],$=J.G,Z=J.H,Q=0,tt=1,et=0,it=0;it<5;++it){V=qn[it],!it&&0<j&&(V+=1<<j);n:{var nt,rt=V,ot=k,st=G,at=$[it]=Y,ht=Z[it]=P,ct=0,lt=ot.m,ut=Gt(lt,1);if(Mr(st,0,0,rt),ut){var ft=Gt(lt,1)+1,dt=Gt(lt,1);st[Gt(lt,0==dt?1:8)]=1,2==ft&&(st[Gt(lt,8)]=1);dt=1}else{var pt=Br(19),gt=Gt(lt,4)+4;if(19<gt){ot.a=3;var mt=0;break n}for(nt=0;nt<gt;++nt)pt[Wn[nt]]=Gt(lt,3);var vt=void 0,yt=void 0,ft=ot,bt=pt,wt=rt,xt=st,_t=0,St=ft.m,Ct=8,At=Rr(128,Vt);r:for(;Ht(At,0,7,bt,19);){if(Gt(St,1)){var Lt=2+2*Gt(St,3);if((vt=2+Gt(St,Lt))>wt)break r}else vt=wt;for(yt=0;yt<wt&&vt--;){Jt(St);var Tt=At[127&Yt(St)];Kt(St,St.u+Tt.g);var Pt=Tt.value;if(Pt<16)0!=(xt[yt++]=Pt)&&(Ct=Pt);else{var kt=16==Pt,Tt=Pt-16,Pt=zn[Tt],Ot=Gt(St,Rn[Tt])+Pt;if(wt<yt+Ot)break r;for(var Nt=kt?Ct:0;0<Ot--;)xt[yt++]=Nt}}_t=1;break r}_t||(ft.a=3),dt=_t}(dt=dt&&!lt.h)&&(ct=Ht(at,ht,8,st,rt)),mt=dt&&0!=ct?ct:(ot.a=3,0)}if(0==mt)break i;if(tt&&1==Un[it]&&(tt=0==Y[P].g),Q+=Y[P].g,P+=mt,it<=3){for(var jt=G[0],Ft=1;Ft<V;++Ft)G[Ft]>jt&&(jt=G[Ft]);et+=jt}}if(J.nd=tt,J.Qb=0,tt&&(J.qb=($[3][Z[3]+0].value<<24|$[1][Z[1]+0].value<<16|$[2][Z[2]+0].value)>>>0,0==Q&&$[0][Z[0]+0].value<256&&(J.Qb=1,J.qb+=$[0][Z[0]+0].value<<8)),J.jc=!J.Qb&&et<6,J.jc)for(var Et=J,It=0;It<Oi;++It){var Dt=It,Mt=Et.pd[Dt],Bt=Et.G[0][Et.H[0]+Dt];256<=Bt.value?(Mt.g=Bt.g+256,Mt.value=Bt.value):(Mt.g=0,Mt.value=0,Dt>>=te(Bt,8,Mt),Dt>>=te(Et.G[1][Et.H[1]+Dt],16,Mt),Dt>>=te(Et.G[2][Et.H[2]+Dt],0,Mt),te(Et.G[3][Et.H[3]+Dt],24,Mt))}}I.vc=D,I.Wb=M,I.Ya=X,I.yc=q,o=1;break e}o=0}if(!(s=o)){n.a=3;break t}if(0<f){if(l.ua=1<<f,!$t(l.Wa,f)){n.a=1,s=0;break t}}else l.ua=0;var Rt=n,zt=a,qt=h,Ut=Rt.s,Wt=Ut.xc;if(Rt.c=zt,Rt.i=qt,Ut.md=Zt(zt,Wt),Ut.wc=0==Wt?-1:(1<<Wt)-1,i){n.xb=sr;break t}if(null==(u=Br(a*h))){n.a=1,s=0;break t}s=(s=ee(n,u,0,a,h,h,null))&&!c.h;break t}return s?(null!=r?r[0]=u:(Er(null==u),Er(i)),n.$=0,i||ie(l)):ie(l),s}function ct(t,e){var i=t.c*t.i,n=i+e+16*e;return Er(t.c<=e),t.V=Br(n),null==t.V?(t.Ta=null,t.Ua=0,t.a=1,0):(t.Ta=t.V,t.Ua=t.Ba+i+e,1)}function lt(t,e){var i=t.C,n=e-i,r=t.V,o=t.Ba+t.c*i;for(Er(e<=t.l.o);0<n;){var s=16<n?16:n,a=t.l.ma,h=t.l.width,c=h*s,l=a.ca,u=a.tb+h*i,f=t.Ta,d=t.Ua;nt(t,s,r,o),yn(f,d,l,u,c),st(a,i,i+s,l,u,h),n-=s,r+=s*t.c,i+=s}Er(i==e),t.C=t.Ma=e}function ut(){this.ub=this.yd=this.td=this.Rb=0}function ft(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function dt(){this.Fb=this.Bb=this.Cb=0,this.Zb=Br(4),this.Lb=Br(4)}function pt(){var t;this.Yb=(function t(e,i,n){for(var r=n[i],o=0;o<r&&(e.push(n.length>i+1?[]:0),!(n.length<i+1));o++)t(e[o],i+1,n)}(t=[],0,[3,11]),t)}function gt(){this.jb=Br(3),this.Wc=zr([4,8],pt),this.Xc=zr([4,17],pt)}function mt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new Br(4),this.od=new Br(4)}function vt(){this.ld=this.La=this.dd=this.tc=0}function yt(){this.Na=this.la=0}function bt(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function wt(){this.ad=Br(384),this.Za=0,this.Ob=Br(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function xt(){this.uc=this.M=this.Nb=0,this.wa=Array(new vt),this.Y=0,this.ya=Array(new wt),this.aa=0,this.l=new At}function _t(){this.y=Br(16),this.f=Br(8),this.ea=Br(8)}function St(){this.cb=this.a=0,this.sc="",this.m=new e,this.Od=new ut,this.Kc=new ft,this.ed=new mt,this.Qa=new dt,this.Ic=this.$c=this.Aa=0,this.D=new xt,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=Rr(8,e),this.ia=0,this.pb=Rr(4,bt),this.Pa=new gt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new _t),this.Hd=0,this.rb=Array(new yt),this.sb=0,this.wa=Array(new vt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new wt),this.L=this.aa=0,this.gd=zr([4,2],vt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ct(t,e){return t<0?0:e<t?e:t}function At(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Lt(){var t=new St;return null!=t&&(t.a=0,t.sc="OK",t.cb=0,t.Xb=0,Kn=Kn||Ot),t}function Tt(t,e,i){return 0==t.a&&(t.a=e,t.sc=i,t.cb=0),0}function Pt(t,e,i){return 3<=i&&157==t[e+0]&&1==t[e+1]&&42==t[e+2]}function kt(t,e){if(null!=t){if(t.a=0,t.sc="OK",null==e)return Tt(t,2,"null VP8Io passed to VP8GetHeaders()"),0;var i=e.data,n=e.w;if((l=e.ha)<4)return Tt(t,7,"Truncated header."),0;var r=i[n+0]|i[n+1]<<8|i[n+2]<<16,o=t.Od;if(o.Rb=!(1&r),o.td=r>>1&7,o.yd=r>>4&1,o.ub=r>>5,3<o.td)return Tt(t,3,"Incorrect keyframe parameters."),0;if(!o.yd)return Tt(t,4,"Frame not displayable."),0;n+=3,l-=3;var s=t.Kc;if(o.Rb){if(l<7)return Tt(t,7,"cannot parse picture header"),0;if(!Pt(i,n,l))return Tt(t,3,"Bad code word"),0;s.c=16383&(i[n+4]<<8|i[n+3]),s.Td=i[n+4]>>6,s.i=16383&(i[n+6]<<8|i[n+5]),s.Ud=i[n+6]>>6,n+=7,l-=7,t.za=s.c+15>>4,t.Ub=s.i+15>>4,e.width=s.c,e.height=s.i,e.Da=0,e.j=0,e.v=0,e.va=e.width,e.o=e.height,e.da=0,e.ib=e.width,e.hb=e.height,e.U=e.width,e.T=e.height,Mr((r=t.Pa).jb,0,255,r.jb.length),Er(null!=(r=t.Qa)),r.Cb=0,r.Bb=0,r.Fb=1,Mr(r.Zb,0,0,r.Zb.length),Mr(r.Lb,0,0,r.Lb)}if(o.ub>l)return Tt(t,7,"bad partition length"),0;p(r=t.m,i,n,o.ub),n+=o.ub,l-=o.ub,o.Rb&&(s.Ld=x(r),s.Kd=x(r));var a,s=t.Qa,h=t.Pa;if(Er(null!=r),Er(null!=s),s.Cb=x(r),s.Cb){if(s.Bb=x(r),x(r)){for(s.Fb=x(r),a=0;a<4;++a)s.Zb[a]=x(r)?v(r,7):0;for(a=0;a<4;++a)s.Lb[a]=x(r)?v(r,6):0}if(s.Bb)for(a=0;a<3;++a)h.jb[a]=x(r)?g(r,8):255}else s.Bb=0;if(r.Ka)return Tt(t,3,"cannot parse segment header"),0;if((s=t.ed).zd=x(r),s.Tb=g(r,6),s.wb=g(r,3),s.Pc=x(r),s.Pc&&x(r)){for(h=0;h<4;++h)x(r)&&(s.vd[h]=v(r,6));for(h=0;h<4;++h)x(r)&&(s.od[h]=v(r,6))}if(t.L=0==s.Tb?0:s.zd?1:2,r.Ka)return Tt(t,3,"cannot parse filter header"),0;var c=l,l=a=n,n=a+c;if(s=c,t.Xb=(1<<g(t.m,2))-1,c<3*(h=t.Xb))i=7;else{for(a+=3*h,s-=3*h,c=0;c<h;++c){var u=i[l+0]|i[l+1]<<8|i[l+2]<<16;s<u&&(u=s),p(t.Jc[+c],i,a,u),a+=u,s-=u,l+=3}p(t.Jc[+h],i,a,s),i=a<n?0:5}if(0!=i)return Tt(t,i,"cannot parse partitions"),0;for(i=g(a=t.m,7),l=x(a)?v(a,4):0,n=x(a)?v(a,4):0,s=x(a)?v(a,4):0,h=x(a)?v(a,4):0,a=x(a)?v(a,4):0,c=t.Qa,u=0;u<4;++u){if(c.Cb){var f=c.Zb[u];c.Fb||(f+=i)}else{if(0<u){t.pb[u]=t.pb[0];continue}f=i}var d=t.pb[u];d.Sc[0]=Gn[Ct(f+l,127)],d.Sc[1]=Yn[Ct(f+0,127)],d.Eb[0]=2*Gn[Ct(f+n,127)],d.Eb[1]=101581*Yn[Ct(f+s,127)]>>16,d.Eb[1]<8&&(d.Eb[1]=8),d.Qc[0]=Gn[Ct(f+h,117)],d.Qc[1]=Yn[Ct(f+a,127)],d.lc=f+a}if(!o.Rb)return Tt(t,4,"Not a key frame."),0;for(x(r),o=t.Pa,i=0;i<4;++i){for(l=0;l<8;++l)for(n=0;n<3;++n)for(s=0;s<11;++s)h=R(r,er[i][l][n][s])?g(r,8):Qn[i][l][n][s],o.Wc[i][l].Yb[n][s]=h;for(l=0;l<17;++l)o.Xc[i][l]=o.Wc[i][ir[l]]}return t.kc=x(r),t.kc&&(t.Bd=g(r,8)),t.cb=1}}function Ot(t,e,i,n,r,o,s){var a=e[r].Yb[i];for(i=0;r<16;++r){if(!R(t,a[i+0]))return r;for(;!R(t,a[i+1]);)if(a=e[++r].Yb[0],i=0,16==r)return 16;var h=e[r+1].Yb;if(R(t,a[i+2])){var c=t,l=0;if(R(c,(f=a)[(u=i)+3]))if(R(c,f[u+6])){for(a=0,u=2*(l=R(c,f[u+8]))+(f=R(c,f[u+9+l])),l=0,f=Jn[u];f[a];++a)l+=l+R(c,f[a]);l+=3+(8<<u)}else R(c,f[u+7])?(l=7+2*R(c,165),l+=R(c,145)):l=5+R(c,159);else l=R(c,f[u+4])?3+R(c,f[u+5]):2;a=h[2]}else a=h[l=1];h=s+$n[r],(c=t).b<0&&y(c);var u,f=c.b,d=(u=c.Ca>>1)-(c.I>>f)>>31;--c.b,c.Ca+=d,c.Ca|=1,c.I-=(u+1&d)<<f,o[h]=((l^d)-d)*n[+(0<r)]}return 16}function Nt(t){var e=t.rb[t.sb-1];e.la=0,e.Na=0,Mr(t.zc,0,0,t.zc.length),t.ja=0}function jt(t,e){if(null!=t){if(null==e)return Tt(t,2,"NULL VP8Io parameter in VP8Decode()."),0;if(t.cb||kt(t,e)){if(Er(t.cb),null==e.ac||e.ac(e)){e.ob&&(t.L=0);var i=Nr[t.L];if(2==t.L?(t.yb=0,t.zb=0):(t.yb=e.v-i>>4,t.zb=e.j-i>>4,t.yb<0&&(t.yb=0),t.zb<0&&(t.zb=0)),t.Va=e.o+15+i>>4,t.Hb=e.va+15+i>>4,t.Hb>t.za&&(t.Hb=t.za),t.Va>t.Ub&&(t.Va=t.Ub),0<t.L)for(var n,r,o=t.ed,i=0;i<4;++i)for(t.Qa.Cb?(r=t.Qa.Lb[i],t.Qa.Fb||(r+=o.Tb)):r=o.Tb,n=0;n<=1;++n){var s,a=t.gd[i][n],h=r;o.Pc&&(h+=o.vd[0],n&&(h+=o.od[0])),0<(h=h<0?0:63<h?63:h)?(s=h,(s=0<o.wb&&(s=4<o.wb?s>>2:s>>1)>9-o.wb?9-o.wb:s)<1&&(s=1),a.dd=s,a.tc=2*h+s,a.ld=40<=h?2:15<=h?1:0):a.tc=0,a.La=n}i=0}else Tt(t,6,"Frame setup failed"),i=t.a;if(i=0==i){if(i){(t.$c=0)<t.Aa||(t.Ic=1);t:{i=t.Ic;var o=4*(s=t.za),c=32*s,l=s+1,u=0<t.L?s*(0<t.Aa?2:1):0,f=(2==t.Aa?2:1)*s;if((a=o+832+(n=3*(16*i+Nr[t.L])/2*c)+(r=null!=t.Fa&&0<t.Fa.length?t.Kc.c*t.Kc.i:0))!=a)i=0;else{if(a>t.Vb){if(t.Vb=0,t.Ec=Br(a),t.Fc=0,null==t.Ec){i=Tt(t,1,"no memory during frame initialization.");break t}t.Vb=a}a=t.Ec,h=t.Fc,t.Ac=a,t.Bc=h,h+=o,t.Gd=Rr(c,_t),t.Hd=0,t.rb=Rr(l+1,yt),t.sb=1,t.wa=u?Rr(u,vt):null,t.Y=0,t.D.Nb=0,t.D.wa=t.wa,t.D.Y=t.Y,0<t.Aa&&(t.D.Y+=s),Er(!0),t.oc=a,t.pc=h,h+=832,t.ya=Rr(f,wt),t.aa=0,t.D.ya=t.ya,t.D.aa=t.aa,2==t.Aa&&(t.D.aa+=s),t.R=16*s,t.B=8*s,s=(c=Nr[t.L])*t.R,c=c/2*t.B,t.sa=a,t.ta=h+s,t.qa=t.sa,t.ra=t.ta+16*i*t.R+c,t.Ha=t.qa,t.Ia=t.ra+8*i*t.B+c,t.$c=0,h+=n,t.mb=r?a:null,t.nb=r?h:null,Er(h+r<=t.Fc+t.Vb),Nt(t),Mr(t.Ac,t.Bc,0,o),i=1}}if(i){if(e.ka=0,e.y=t.sa,e.O=t.ta,e.f=t.qa,e.N=t.ra,e.ea=t.Ha,e.Vd=t.Ia,e.fa=t.R,e.Rc=t.B,e.F=null,e.J=0,!Sn){for(i=-255;i<=255;++i)bn[255+i]=i<0?-i:i;for(i=-1020;i<=1020;++i)wn[1020+i]=i<-128?-128:127<i?127:i;for(i=-112;i<=112;++i)xn[112+i]=i<-16?-16:15<i?15:i;for(i=-255;i<=510;++i)_n[255+i]=i<0?0:255<i?255:i;Sn=1}Ji=Ut,$i=Bt,Qi=Rt,tn=zt,en=qt,Zi=Mt,nn=qe,rn=Ue,on=Ve,sn=Xe,an=We,hn=He,cn=Ge,ln=Ye,un=Ie,fn=De,dn=Me,pn=Be,rr[0]=ve,rr[1]=re,rr[2]=ge,rr[3]=me,rr[4]=ye,rr[5]=we,rr[6]=be,rr[7]=xe,rr[8]=Se,rr[9]=_e,nr[0]=le,nr[1]=se,nr[2]=ae,nr[3]=he,nr[4]=ue,nr[5]=fe,nr[6]=de,or[0]=Te,or[1]=oe,or[2]=Ce,or[3]=Ae,or[4]=ke,or[5]=Pe,or[6]=Oe,i=1}else i=0}i=i&&function(t,e){for(t.M=0;t.M<t.Va;++t.M){for(var i=t.Jc[t.M&t.Xb],n=t.m,r=t,o=0;o<r.za;++o){var s=n,a=(d=r).Ac,h=d.Bc+4*o,c=d.zc,l=d.ya[d.aa+o];if(d.Qa.Bb?l.$b=R(s,d.Pa.jb[0])?2+R(s,d.Pa.jb[2]):R(s,d.Pa.jb[1]):l.$b=0,d.kc&&(l.Ad=R(s,d.Bd)),l.Za=+!R(s,145),l.Za)for(var u=l.Ob,f=0,d=0;d<4;++d){for(var p=c[0+d],g=0;g<4;++g){for(var p=tr[a[h+g]][p],m=Zn[R(s,p[0])];0<m;)m=Zn[2*m+R(s,p[m])];a[h+g]=p=-m}Dr(u,f,a,h,4),f+=4,c[0+d]=p}else p=R(s,156)?R(s,128)?1:3:R(s,163)?2:0,Mr(a,h,l.Ob[0]=p,4),Mr(c,0,p,4);l.Dd=R(s,142)?R(s,114)?R(s,183)?1:3:2:0}if(r.m.Ka)return Tt(t,7,"Premature end-of-partition0 encountered.");for(;t.ja<t.za;++t.ja){if(r=i,s=(n=t).rb[n.sb-1],a=n.rb[n.sb+n.ja],o=n.ya[n.aa+n.ja],h=n.kc?o.Ad:0)s.la=a.la=0,o.Za||(s.Na=a.Na=0),o.Hc=0,o.Gc=0,o.ia=0;else{var v,s=a,a=r,h=n.Pa.Xc,c=n.ya[n.aa+n.ja],l=n.pb[c.$b];if(d=c.ad,f=n.rb[n.sb-1],Mr(d,u=0,p=g=0,384),c.Za)var y=0,b=h[3];else{m=Br(16);var w=s.Na+f.Na,w=Kn(a,h[1],w,l.Eb,0,m,0);if(s.Na=f.Na=+(0<w),1<w)Ji(m,0,d,u);else for(var x=m[0]+3>>3,m=0;m<256;m+=16)d[u+m]=x;y=1,b=h[0]}var _=15&s.la,S=15&f.la;for(m=0;m<4;++m){for(var C=1&S,x=v=0;x<4;++x)_=_>>1|(C=(w=Kn(a,b,w=C+(1&_),l.Sc,y,d,u))>y)<<7,v=v<<2|(3<w?3:1<w?2:0!=d[u+0]),u+=16;_>>=4,S=S>>1|C<<7,g=(g<<8|v)>>>0}for(b=_,y=S>>4,N=0;N<4;N+=2){for(_=s.la>>4+N,S=f.la>>4+N,m=v=0;m<2;++m){for(C=1&S,x=0;x<2;++x)_=_>>1|(C=0<(w=Kn(a,h[2],w=C+(1&_),l.Qc,0,d,u)))<<3,v=v<<2|(3<w?3:1<w?2:0!=d[u+0]),u+=16;_>>=2,S=S>>1|C<<5}p|=v<<4*N,b|=_<<4<<N,y|=(240&S)<<N}s.la=b,f.la=y,c.Hc=g,c.Gc=p,c.ia=43690&p?0:l.ia,h=!(g|p)}if(0<n.L&&(n.wa[n.Y+n.ja]=n.gd[o.$b][o.Za],n.wa[n.Y+n.ja].La|=!h),r.Ka)return Tt(t,7,"Premature end-of-file encountered.")}if(Nt(t),n=e,r=1,o=(i=t).D,s=0<i.L&&i.M>=i.zb&&i.M<=i.Va,0==i.Aa)t:{if(o.M=i.M,o.uc=s,Ai(i,o),o=(v=i.D).Nb,s=(p=Nr[i.L])*i.R,a=p/2*i.B,m=16*o*i.R,x=8*o*i.B,h=i.sa,c=i.ta-s+m,l=i.qa,d=i.ra-a+x,u=i.Ha,f=i.Ia-a+x,S=0==(_=v.M),g=_>=i.Va-(r=1),2==i.Aa&&Ai(i,v),v.uc)for(C=(w=i).D.M,Er(w.D.uc),v=w.yb;v<w.Hb;++v){var A,L,T,P,k,y=v,b=C,O=(j=(k=w).D).Nb,N=k.R,j=j.wa[j.Y+y],F=k.sa,E=k.ta+16*O*N+16*y,I=j.dd,D=j.tc;0!=D&&(Er(3<=D),1==k.L?(0<y&&fn(F,E,N,D+4),j.La&&pn(F,E,N,D),0<b&&un(F,E,N,D+4),j.La&&dn(F,E,N,D)):(A=k.B,L=k.qa,T=k.ra+8*O*A+8*y,P=k.Ha,k=k.Ia+8*O*A+8*y,O=j.ld,0<y&&(rn(F,E,N,D+4,I,O),sn(L,T,P,k,A,D+4,I,O)),j.La&&(hn(F,E,N,D,I,O),ln(L,T,P,k,A,D,I,O)),0<b&&(nn(F,E,N,D+4,I,O),on(L,T,P,k,A,D+4,I,O)),j.La&&(an(F,E,N,D,I,O),cn(L,T,P,k,A,D,I,O))))}if(i.ia&&alert("todo:DitherRow"),null!=n.put){if(v=16*_,_=16*(_+1),S?(n.y=i.sa,n.O=i.ta+m,n.f=i.qa,n.N=i.ra+x,n.ea=i.Ha,n.W=i.Ia+x):(v-=p,n.y=h,n.O=c,n.f=l,n.N=d,n.ea=u,n.W=f),g||(_-=p),_>n.o&&(_=n.o),n.F=null,(n.J=null)!=i.Fa&&0<i.Fa.length&&v<_&&(n.J=function(t,e,i,n){var r,o=e.width,s=e.o;if(Er(null!=t&&null!=e),i<0||n<=0||s<i+n)return null;if(!t.Cc){if(null==t.ga){if(t.ga=new ti,(r=null==t.ga)||(r=e.width*e.o,Er(0==t.Gb.length),t.Gb=Br(r),t.Uc=0,r=!(r=null==t.Gb?0:(t.mb=t.Gb,t.nb=t.Uc,t.rc=null,1))),!r){r=t.ga;var a=t.Fa,h=t.P,c=t.qc,l=t.mb,u=t.nb,f=h+1,d=c-1,p=r.l;if(Er(null!=a&&null!=l&&null!=e),hr[0]=null,hr[1]=ei,hr[2]=ii,hr[3]=ni,r.ca=l,r.tb=u,r.c=e.width,r.i=e.height,Er(0<r.c&&0<r.i),c<=1)e=0;else if(r.$a=a[h+0]>>0&3,r.Z=a[h+0]>>2&3,r.Lc=a[h+0]>>4&3,h=a[h+0]>>6&3,r.$a<0||1<r.$a||4<=r.Z||1<r.Lc||h)e=0;else if(p.put=J,p.ac=K,p.bc=$,p.ma=r,p.width=e.width,p.height=e.height,p.Da=e.Da,p.v=e.v,p.va=e.va,p.j=e.j,p.o=e.o,r.$a)e:{Er(1==r.$a),e=ht();i:for(;;){if(null==e){e=0;break e}if(Er(null!=r),(r.mc=e).c=r.c,e.i=r.i,e.l=r.l,e.l.ma=r,e.l.width=r.c,e.l.height=r.i,e.a=0,M(e.m,a,f,d),!ne(r.c,r.i,1,e,null))break i;if(!(e=1==e.ab&&3==e.gc[0].hc&&ot(e.s)?(r.ic=1,a=e.c*e.i,e.Ta=null,e.Ua=0,e.V=Br(a),e.Ba=0,null==e.V?(e.a=1,0):1):(r.ic=0,ct(e,r.c))))break i;e=1;break e}r.mc=null,e=0}else e=d>=r.c*r.i;r=!e}if(r)return null;1!=t.ga.Lc?t.Ga=0:n=s-i}Er(null!=t.ga),Er(i+n<=s);e:{if(e=(a=t.ga).c,s=a.l.o,0==a.$a){if(f=t.rc,d=t.Vc,p=t.Fa,h=t.P+1+i*e,c=t.mb,l=t.nb+i*e,Er(h<=t.P+t.qc),0!=a.Z)for(Er(null!=hr[a.Z]),r=0;r<n;++r)hr[a.Z](f,d,p,h,c,l,e),f=c,d=l,l+=e,h+=e;else for(r=0;r<n;++r)Dr(c,l,p,h,e),f=c,d=l,l+=e,h+=e;t.rc=f,t.Vc=d}else{if(Er(null!=a.mc),e=i+n,Er(null!=(r=a.mc)),Er(e<=r.i),r.C>=e)e=1;else if(a.ic||hi(),a.ic){a=r.V,f=r.Ba,d=r.c;var g=r.i,m=(p=1,h=r.$/d,c=r.$%d,l=r.m,u=r.s,r.$),v=d*g,y=d*e,b=u.wc,w=m<y?it(u,c,h):null;Er(m<=v),Er(e<=g),Er(ot(u));i:for(;;){for(;!l.h&&m<y;){if(Er(null!=(w=!(c&b)?it(u,c,h):w)),Jt(l),(g=et(w.G[0],w.H[0],l))<256)a[f+m]=g,++m,++c>=d&&(c=0,++h<=e&&!(h%16)&&at(r,h));else{if(!(g<280)){p=0;break i}g=Q(g-256,l);var x,_=et(w.G[4],w.H[4],l);if(Jt(l),!(m>=(_=tt(d,_=Q(_,l)))&&g<=v-m)){p=0;break i}for(x=0;x<g;++x)a[f+m+x]=a[f+m+x-_];for(m+=g,c+=g;d<=c;)c-=d,++h<=e&&!(h%16)&&at(r,h);m<y&&c&b&&(w=it(u,c,h))}Er(l.h==B(l))}at(r,e<h?e:h);break i}!p||l.h&&m<v?(p=0,r.a=l.h?5:3):r.$=m,e=p}else e=ee(r,r.V,r.Ba,r.c,r.i,e,lt);if(!e){n=0;break e}}s<=i+n&&(t.Cc=1),n=1}if(!n)return null;if(t.Cc&&(null!=(n=t.ga)&&(n.mc=null),t.ga=null,0<t.Ga))return alert("todo:WebPDequantizeLevels"),null}return t.nb+i*o}(i,n,v,_-v),n.F=i.mb,null==n.F&&0==n.F.length)){r=Tt(i,3,"Could not decode alpha data.");break t}v<n.j&&(p=n.j-v,v=n.j,Er(!(1&p)),n.O+=i.R*p,n.N+=i.B*(p>>1),n.W+=i.B*(p>>1),null!=n.F&&(n.J+=n.width*p)),v<_&&(n.O+=n.v,n.N+=n.v>>1,n.W+=n.v>>1,null!=n.F&&(n.J+=n.v),n.ka=v-n.j,n.U=n.va-n.v,n.T=_-v,r=n.put(n))}o+1!=i.Ic||g||(Dr(i.sa,i.ta-s,h,c+16*i.R,s),Dr(i.qa,i.ra-a,l,d+8*i.B,a),Dr(i.Ha,i.Ia-a,u,f+8*i.B,a))}if(!r)return Tt(t,6,"Output aborted.")}return 1}(t,e),null!=e.bc&&e.bc(e),i&=1}return i&&(t.cb=0,i)}}}function Ft(t,e,i,n,r){r=t[e+i+32*n]+(r>>3),t[e+i+32*n]=-256&r?r<0?0:255:r}function Et(t,e,i,n,r,o){Ft(t,e,0,i,n+r),Ft(t,e,1,i,n+o),Ft(t,e,2,i,n-o),Ft(t,e,3,i,n-r)}function It(t){return(20091*t>>16)+t}function Dt(t,e,i,n){for(var r=0,o=Br(16),s=0;s<4;++s){var a=t[e+0]+t[e+8],h=t[e+0]-t[e+8],c=(35468*t[e+4]>>16)-It(t[e+12]),l=It(t[e+4])+(35468*t[e+12]>>16);o[r+0]=a+l,o[r+1]=h+c,o[r+2]=h-c,o[r+3]=a-l,r+=4,e++}for(s=r=0;s<4;++s)a=(t=o[r+0]+4)+o[r+8],h=t-o[r+8],c=(35468*o[r+4]>>16)-It(o[r+12]),Ft(i,n,0,0,a+(l=It(o[r+4])+(35468*o[r+12]>>16))),Ft(i,n,1,0,h+c),Ft(i,n,2,0,h-c),Ft(i,n,3,0,a-l),r++,n+=32}function Mt(t,e,i,n){var r=t[e+0]+4,o=35468*t[e+4]>>16,s=It(t[e+4]),a=35468*t[e+1]>>16;Et(i,n,0,r+s,t=It(t[e+1]),a),Et(i,n,1,r+o,t,a),Et(i,n,2,r-o,t,a),Et(i,n,3,r-s,t,a)}function Bt(t,e,i,n,r){Dt(t,e,i,n),r&&Dt(t,e+16,i,n+4)}function Rt(t,e,i,n){$i(t,e+0,i,n,1),$i(t,e+32,i,n+128,1)}function zt(t,e,i,n){var r;for(t=t[e+0]+4,r=0;r<4;++r)for(e=0;e<4;++e)Ft(i,n,e,r,t)}function qt(t,e,i,n){t[e+0]&&tn(t,e+0,i,n),t[e+16]&&tn(t,e+16,i,n+4),t[e+32]&&tn(t,e+32,i,n+128),t[e+48]&&tn(t,e+48,i,n+128+4)}function Ut(t,e,i,n){for(var r=Br(16),o=0;o<4;++o){var s=t[e+0+o]+t[e+12+o],a=t[e+4+o]+t[e+8+o],h=t[e+4+o]-t[e+8+o],c=t[e+0+o]-t[e+12+o];r[0+o]=s+a,r[8+o]=s-a,r[4+o]=c+h,r[12+o]=c-h}for(o=0;o<4;++o)s=(t=r[0+4*o]+3)+r[3+4*o],a=r[1+4*o]+r[2+4*o],h=r[1+4*o]-r[2+4*o],c=t-r[3+4*o],i[n+0]=s+a>>3,i[n+16]=c+h>>3,i[n+32]=s-a>>3,i[n+48]=c-h>>3,n+=64}function Wt(t,e,i){for(var n=e-32,r=Ln,o=255-t[n-1],s=0;s<i;++s){for(var a=r,h=o+t[e-1],c=0;c<i;++c)t[e+c]=a[h+t[n+c]];e+=32}}function re(t,e){Wt(t,e,4)}function oe(t,e){Wt(t,e,8)}function se(t,e){Wt(t,e,16)}function ae(t,e){for(var i=0;i<16;++i)Dr(t,e+32*i,t,e-32,16)}function he(t,e){for(var i=16;0<i;--i)Mr(t,e,t[e-1],16),e+=32}function ce(t,e,i){for(var n=0;n<16;++n)Mr(e,i+32*n,t,16)}function le(t,e){for(var i=16,n=0;n<16;++n)i+=t[e-1+32*n]+t[e+n-32];ce(i>>5,t,e)}function ue(t,e){for(var i=8,n=0;n<16;++n)i+=t[e-1+32*n];ce(i>>4,t,e)}function fe(t,e){for(var i=8,n=0;n<16;++n)i+=t[e+n-32];ce(i>>4,t,e)}function de(t,e){ce(128,t,e)}function pe(t,e,i){return t+2*e+i+2>>2}function ge(t,e){for(var i=e-32,i=new Uint8Array([pe(t[i-1],t[i],t[1+i]),pe(t[i],t[1+i],t[2+i]),pe(t[1+i],t[2+i],t[3+i]),pe(t[2+i],t[3+i],t[4+i])]),n=0;n<4;++n)Dr(t,e+32*n,i,0,i.length)}function me(t,e){var i=t[e-1],n=t[e-1+32],r=t[e-1+64],o=t[e-1+96];s(t,e+0,16843009*pe(t[e-1-32],i,n)),s(t,e+32,16843009*pe(i,n,r)),s(t,e+64,16843009*pe(n,r,o)),s(t,e+96,16843009*pe(r,o,o))}function ve(t,e){for(var i=4,n=0;n<4;++n)i+=t[e+n-32]+t[e-1+32*n];for(i>>=3,n=0;n<4;++n)Mr(t,e+32*n,i,4)}function ye(t,e){var i=t[e-1],n=t[e-1+32],r=t[e-1+64],o=t[e-1-32],s=t[e+0-32],a=t[e+1-32],h=t[e+2-32],c=t[e+3-32];t[e+0+96]=pe(n,r,t[e-1+96]),t[e+1+96]=t[e+0+64]=pe(i,n,r),t[e+2+96]=t[e+1+64]=t[e+0+32]=pe(o,i,n),t[e+3+96]=t[e+2+64]=t[e+1+32]=t[e+0+0]=pe(s,o,i),t[e+3+64]=t[e+2+32]=t[e+1+0]=pe(a,s,o),t[e+3+32]=t[e+2+0]=pe(h,a,s),t[e+3+0]=pe(c,h,a)}function be(t,e){var i=t[e+1-32],n=t[e+2-32],r=t[e+3-32],o=t[e+4-32],s=t[e+5-32],a=t[e+6-32],h=t[e+7-32];t[e+0+0]=pe(t[e+0-32],i,n),t[e+1+0]=t[e+0+32]=pe(i,n,r),t[e+2+0]=t[e+1+32]=t[e+0+64]=pe(n,r,o),t[e+3+0]=t[e+2+32]=t[e+1+64]=t[e+0+96]=pe(r,o,s),t[e+3+32]=t[e+2+64]=t[e+1+96]=pe(o,s,a),t[e+3+64]=t[e+2+96]=pe(s,a,h),t[e+3+96]=pe(a,h,h)}function we(t,e){var i=t[e-1],n=t[e-1+32],r=t[e-1+64],o=t[e-1-32],s=t[e+0-32],a=t[e+1-32],h=t[e+2-32],c=t[e+3-32];t[e+0+0]=t[e+1+64]=o+s+1>>1,t[e+1+0]=t[e+2+64]=s+a+1>>1,t[e+2+0]=t[e+3+64]=a+h+1>>1,t[e+3+0]=h+c+1>>1,t[e+0+96]=pe(r,n,i),t[e+0+64]=pe(n,i,o),t[e+0+32]=t[e+1+96]=pe(i,o,s),t[e+1+32]=t[e+2+96]=pe(o,s,a),t[e+2+32]=t[e+3+96]=pe(s,a,h),t[e+3+32]=pe(a,h,c)}function xe(t,e){var i=t[e+0-32],n=t[e+1-32],r=t[e+2-32],o=t[e+3-32],s=t[e+4-32],a=t[e+5-32],h=t[e+6-32],c=t[e+7-32];t[e+0+0]=i+n+1>>1,t[e+1+0]=t[e+0+64]=n+r+1>>1,t[e+2+0]=t[e+1+64]=r+o+1>>1,t[e+3+0]=t[e+2+64]=o+s+1>>1,t[e+0+32]=pe(i,n,r),t[e+1+32]=t[e+0+96]=pe(n,r,o),t[e+2+32]=t[e+1+96]=pe(r,o,s),t[e+3+32]=t[e+2+96]=pe(o,s,a),t[e+3+64]=pe(s,a,h),t[e+3+96]=pe(a,h,c)}function _e(t,e){var i=t[e-1],n=t[e-1+32],r=t[e-1+64],o=t[e-1+96];t[e+0+0]=i+n+1>>1,t[e+2+0]=t[e+0+32]=n+r+1>>1,t[e+2+32]=t[e+0+64]=r+o+1>>1,t[e+1+0]=pe(i,n,r),t[e+3+0]=t[e+1+32]=pe(n,r,o),t[e+3+32]=t[e+1+64]=pe(r,o,o),t[e+3+64]=t[e+2+64]=t[e+0+96]=t[e+1+96]=t[e+2+96]=t[e+3+96]=o}function Se(t,e){var i=t[e-1],n=t[e-1+32],r=t[e-1+64],o=t[e-1+96],s=t[e-1-32],a=t[e+0-32],h=t[e+1-32],c=t[e+2-32];t[e+0+0]=t[e+2+32]=i+s+1>>1,t[e+0+32]=t[e+2+64]=n+i+1>>1,t[e+0+64]=t[e+2+96]=r+n+1>>1,t[e+0+96]=o+r+1>>1,t[e+3+0]=pe(a,h,c),t[e+2+0]=pe(s,a,h),t[e+1+0]=t[e+3+32]=pe(i,s,a),t[e+1+32]=t[e+3+64]=pe(n,i,s),t[e+1+64]=t[e+3+96]=pe(r,n,i),t[e+1+96]=pe(o,r,n)}function Ce(t,e){for(var i=0;i<8;++i)Dr(t,e+32*i,t,e-32,8)}function Ae(t,e){for(var i=0;i<8;++i)Mr(t,e,t[e-1],8),e+=32}function Le(t,e,i){for(var n=0;n<8;++n)Mr(e,i+32*n,t,8)}function Te(t,e){for(var i=8,n=0;n<8;++n)i+=t[e+n-32]+t[e-1+32*n];Le(i>>4,t,e)}function Pe(t,e){for(var i=4,n=0;n<8;++n)i+=t[e+n-32];Le(i>>3,t,e)}function ke(t,e){for(var i=4,n=0;n<8;++n)i+=t[e-1+32*n];Le(i>>3,t,e)}function Oe(t,e){Le(128,t,e)}function Ne(t,e,i){var n=t[e-i],r=t[e+0],o=3*(r-n)+Cn[1020+t[e-2*i]-t[e+i]],s=An[112+(o+4>>3)];t[e-i]=Ln[255+n+An[112+(o+3>>3)]],t[e+0]=Ln[255+r-s]}function je(t,e,i,n){var r=t[e+0],o=t[e+i];return Tn[255+t[e-2*i]-t[e-i]]>n||Tn[255+o-r]>n}function Fe(t,e,i,n){return 4*Tn[255+t[e-i]-t[e+0]]+Tn[255+t[e-2*i]-t[e+i]]<=n}function Ee(t,e,i,n,r){var o=t[e-3*i],s=t[e-2*i],a=t[e-i],h=t[e+0],c=t[e+i],l=t[e+2*i],u=t[e+3*i];return!(4*Tn[255+a-h]+Tn[255+s-c]>n)&&(Tn[255+t[e-4*i]-o]<=r&&Tn[255+o-s]<=r&&Tn[255+s-a]<=r&&Tn[255+u-l]<=r&&Tn[255+l-c]<=r&&Tn[255+c-h]<=r)}function Ie(t,e,i,n){var r=2*n+1;for(n=0;n<16;++n)Fe(t,e+n,i,r)&&Ne(t,e+n,i)}function De(t,e,i,n){var r=2*n+1;for(n=0;n<16;++n)Fe(t,e+n*i,1,r)&&Ne(t,e+n*i,1)}function Me(t,e,i,n){for(var r=3;0<r;--r)Ie(t,e+=4*i,i,n)}function Be(t,e,i,n){for(var r=3;0<r;--r)De(t,e+=4,i,n)}function Re(t,e,i,n,r,o,s,a){for(o=2*o+1;0<r--;){var h,c,l,u,f,d,p,g,m,v,y;Ee(t,e,i,o,s)&&(je(t,e,i,a)?Ne(t,e,i):(u=(h=t)[(c=e)-2*(l=i)],f=h[c-l],d=h[c+0],p=h[c+l],g=h[c+2*l],m=27*(y=Cn[1020+3*(d-f)+Cn[1020+u-p]])+63>>7,v=18*y+63>>7,h[c-3*l]=Ln[255+h[c-3*l]+(y=9*y+63>>7)],h[c-2*l]=Ln[255+u+v],h[c-l]=Ln[255+f+m],h[c+0]=Ln[255+d-m],h[c+l]=Ln[255+p-v],h[c+2*l]=Ln[255+g-y])),e+=n}}function ze(t,e,i,n,r,o,s,a){for(o=2*o+1;0<r--;){var h,c,l,u,f,d,p,g,m;Ee(t,e,i,o,s)&&(je(t,e,i,a)?Ne(t,e,i):(u=(h=t)[(c=e)-(l=i)],f=h[c+0],d=h[c+l],p=An[112+(4+(g=3*(f-u))>>3)],g=An[112+(3+g>>3)],h[c-2*l]=Ln[255+h[c-2*l]+(m=p+1>>1)],h[c-l]=Ln[255+u+g],h[c+0]=Ln[255+f-p],h[c+l]=Ln[255+d-m])),e+=n}}function qe(t,e,i,n,r,o){Re(t,e,i,1,16,n,r,o)}function Ue(t,e,i,n,r,o){Re(t,e,1,i,16,n,r,o)}function We(t,e,i,n,r,o){for(var s=3;0<s;--s)ze(t,e+=4*i,i,1,16,n,r,o)}function He(t,e,i,n,r,o){for(var s=3;0<s;--s)ze(t,e+=4,1,i,16,n,r,o)}function Ve(t,e,i,n,r,o,s,a){Re(t,e,r,1,8,o,s,a),Re(i,n,r,1,8,o,s,a)}function Xe(t,e,i,n,r,o,s,a){Re(t,e,1,r,8,o,s,a),Re(i,n,1,r,8,o,s,a)}function Ge(t,e,i,n,r,o,s,a){ze(t,e+4*r,r,1,8,o,s,a),ze(i,n+4*r,r,1,8,o,s,a)}function Ye(t,e,i,n,r,o,s,a){ze(t,e+4,1,r,8,o,s,a),ze(i,n+4,1,r,8,o,s,a)}function Ke(){this.ba=new W,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new V,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Je(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function $e(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ze(){this.ua=0,this.Wa=new r,this.vb=new r,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Xt,this.yc=new Vt}function Qe(){this.xb=this.a=0,this.l=new At,this.ca=new W,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new P,this.Pb=0,this.wd=new P,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ze,this.ab=0,this.gc=Rr(4,$e),this.Oc=0}function ti(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new At,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ei(t,e,i,n,r,o,s){for(t=null==t?0:t[e+0],e=0;e<s;++e)r[o+e]=t+i[n+e]&255,t=r[o+e]}function ii(t,e,i,n,r,o,s){var a;if(null==t)ei(null,null,i,n,r,o,s);else for(a=0;a<s;++a)r[o+a]=t[e+a]+i[n+a]&255}function ni(t,e,i,n,r,o,s){if(null==t)ei(null,null,i,n,r,o,s);else for(var a=t[e+0],h=a,c=a,l=0;l<s;++l)h=c+(a=t[e+l])-h,c=i[n+l]+(-256&h?h<0?0:255:h)&255,h=a,r[o+l]=c}function ri(t,e,i,n,r,o){for(;0<r--;){for(var s=t,a=e+(i?1:0),h=t,c=e+(i?0:3),l=0;l<n;++l){var u=h[c+4*l];255!=u&&(u*=32897,s[a+4*l+0]=s[a+4*l+0]*u>>23,s[a+4*l+1]=s[a+4*l+1]*u>>23,s[a+4*l+2]=s[a+4*l+2]*u>>23)}e+=o}}function oi(t,e,i,n,r){for(;0<n--;){for(var o=0;o<i;++o){var s=t[e+2*o+0],a=15&(c=t[e+2*o+1]),h=4369*a,c=(240&c|c>>4)*h>>16;t[e+2*o+0]=(240&s|s>>4)*h>>16&240|(15&s|s<<4)*h>>16>>4&15,t[e+2*o+1]=240&c|a}e+=r}}function si(t,e,i,n,r,o,s,a){for(var h,c=255,l=0;l<r;++l){for(h=0;h<n;++h){var u=t[e+h];c&=o[s+4*h]=u}e+=i,s+=a}return 255!=c}function ai(t,e,i,n,r){for(var o=0;o<r;++o)i[n+o]=t[e+o]>>8}function hi(){gn=ri,mn=oi,vn=si,yn=ai}function ci(t,L,T){m[t]=function(t,e,i,n,r,o,s,a,h,c,l,u,f,d,p,g,m){var v,y=m-1>>1,b=r[o+0]|s[a+0]<<16,w=h[c+0]|l[u+0]<<16;Er(null!=t);var x=3*b+w+131074>>2;for(L(t[e+0],255&x,x>>16,f,d),null!=i&&L(i[n+0],255&(x=3*w+b+131074>>2),x>>16,p,g),v=1;v<=y;++v){var _=r[o+v]|s[a+v]<<16,S=h[c+v]|l[u+v]<<16,C=b+_+w+S+524296,A=C+2*(_+w)>>3,x=A+b>>1,b=(C=C+2*(b+S)>>3)+_>>1;L(t[e+2*v-1],255&x,x>>16,f,d+(2*v-1)*T),L(t[+(e+2*v)],255&b,b>>16,f,d+2*v*T),null!=i&&(b=A+S>>1,L(i[n+2*v-1],255&(x=C+w>>1),x>>16,p,g+(2*v-1)*T),L(i[n+2*v+0],255&b,b>>16,p,g+(2*v+0)*T)),b=_,w=S}1&m||(L(t[e+m-1],255&(x=3*b+w+131074>>2),x>>16,f,d+(m-1)*T),null!=i&&L(i[n+m-1],255&(x=3*w+b+131074>>2),x>>16,p,g+(m-1)*T))}}function li(){cr[Pn]=lr,cr[kn]=fr,cr[On]=ur,cr[Nn]=dr,cr[jn]=pr,cr[Fn]=gr,cr[En]=mr,cr[In]=fr,cr[Dn]=dr,cr[Mn]=pr,cr[Bn]=gr}function ui(t){return t&~_r?t<0?0:255:t>>xr}function fi(t,e){return ui((19077*t>>8)+(26149*e>>8)-14234)}function di(t,e,i){return ui((19077*t>>8)-(6419*e>>8)-(13320*i>>8)+8708)}function pi(t,e){return ui((19077*t>>8)+(33050*e>>8)-17685)}function gi(t,e,i,n,r){n[r+0]=fi(t,i),n[r+1]=di(t,e,i),n[r+2]=pi(t,e)}function mi(t,e,i,n,r){n[r+0]=pi(t,e),n[r+1]=di(t,e,i),n[r+2]=fi(t,i)}function vi(t,e,i,n,r){var o=di(t,e,i);e=o<<3&224|pi(t,e)>>3,n[r+0]=248&fi(t,i)|o>>5,n[r+1]=e}function yi(t,e,i,n,r){var o=240&pi(t,e)|15;n[r+0]=240&fi(t,i)|di(t,e,i)>>4,n[r+1]=o}function bi(t,e,i,n,r){n[r+0]=255,gi(t,e,i,n,r+1)}function wi(t,e,i,n,r){mi(t,e,i,n,r),n[r+3]=255}function xi(t,e,i,n,r){gi(t,e,i,n,r),n[r+3]=255}function Ct(t,e){return t<0?0:e<t?e:t}function _i(t,l,u){m[t]=function(t,e,i,n,r,o,s,a,h){for(var c=a+(-2&h)*u;a!=c;)l(t[e+0],i[n+0],r[o+0],s,a),l(t[e+1],i[n+0],r[o+0],s,a+u),e+=2,++n,++o,a+=2*u;1&h&&l(t[e+0],i[n+0],r[o+0],s,a)}}function Si(t,e,i){return 0==i?0==t?0==e?6:5:0==e?4:0:i}function Ci(t,e,i,n,r){switch(t>>>30){case 3:$i(e,i,n,r,0);break;case 2:Zi(e,i,n,r);break;case 1:tn(e,i,n,r)}}function Ai(t,e){for(var i,n=e.M,r=e.Nb,o=t.oc,s=t.pc+40,a=t.oc,h=t.pc+584,c=t.oc,l=t.pc+600,u=0;u<16;++u)o[s+32*u-1]=129;for(u=0;u<8;++u)a[h+32*u-1]=129,c[l+32*u-1]=129;for(0<n?o[s-1-32]=a[h-1-32]=c[l-1-32]=129:(Mr(o,s-32-1,127,21),Mr(a,h-32-1,127,9),Mr(c,l-32-1,127,9)),i=0;i<t.za;++i){var f=e.ya[e.aa+i];if(0<i){for(u=-1;u<16;++u)Dr(o,s+32*u-4,o,s+32*u+12,4);for(u=-1;u<8;++u)Dr(a,h+32*u-4,a,h+32*u+4,4),Dr(c,l+32*u-4,c,l+32*u+4,4)}var d=t.Gd,p=t.Hd+i,g=f.ad,m=f.Hc;if(0<n&&(Dr(o,s-32,d[p].y,0,16),Dr(a,h-32,d[p].f,0,8),Dr(c,l-32,d[p].ea,0,8)),f.Za){var v=o,y=s-32+16;for(0<n&&(i>=t.za-1?Mr(v,y,d[p].y[15],4):Dr(v,y,d[p+1].y,0,4)),u=0;u<4;u++)v[y+128+u]=v[y+256+u]=v[y+384+u]=v[y+0+u];for(u=0;u<16;++u,m<<=2)y=s+Or[u],rr[f.Ob[u]](v=o,y),Ci(m,g,16*+u,v,y)}else if(v=Si(i,n,f.Ob[0]),nr[v](o,s),0!=m)for(u=0;u<16;++u,m<<=2)Ci(m,g,16*+u,o,s+Or[u]);for(u=f.Gc,v=Si(i,n,f.Dd),or[v](a,h),or[v](c,l),m=g,v=a,y=h,255&(f=u>>0)&&(170&f?Qi:en)(m,256,v,y),f=c,m=l,255&(u>>=8)&&(170&u?Qi:en)(g,320,f,m),n<t.Ub-1&&(Dr(d[p].y,0,o,s+480,16),Dr(d[p].f,0,a,h+224,8),Dr(d[p].ea,0,c,l+224,8)),u=8*r*t.B,d=t.sa,p=t.ta+16*i+16*r*t.R,g=t.qa,f=t.ra+8*i+u,m=t.Ha,v=t.Ia+8*i+u,u=0;u<16;++u)Dr(d,p+u*t.R,o,s+32*u,16);for(u=0;u<8;++u)Dr(g,f+u*t.B,a,h+32*u,8),Dr(m,v+u*t.B,c,l+32*u,8)}}function Li(t,e,i,n,r,o,s,a,h){var c=[0],l=[0],u=0,f=null!=h?h.kd:0,d=null!=h?h:new Je;if(null==t||i<12)return 7;d.data=t,e=[d.w=e],i=[d.ha=i],d.gb=[d.gb];t:{var p=e,g=i,m=d.gb;if(Er(null!=t),Er(null!=g),Er(null!=m),12<=g[m[0]=0]&&!Ir(t,p[0],"RIFF")){if(Ir(t,p[0]+8,"WEBP")){m=3;break t}var v=O(t,p[0]+4);if(v<12||4294967286<v){m=3;break t}if(f&&v>g[0]-8){m=7;break t}m[0]=v,p[0]+=12,g[0]-=12}m=0}if(0!=m)return m;for(v=0<d.gb[0],i=i[0];;){t:{var y=t,g=e,b=c,w=l,x=p=[0];if((m=i)[(C=u=[u])[0]=0]<8)m=7;else{if(!Ir(y,g[0],"VP8X")){if(10!=O(y,g[0]+4)){m=3;break t}if(m[0]<18){m=7;break t}var _=O(y,g[0]+8),S=1+k(y,g[0]+12);if(2147483648<=S*(y=1+k(y,g[0]+15))){m=3;break t}null!=x&&(x[0]=_),null!=b&&(b[0]=S),null!=w&&(w[0]=y),g[0]+=18,m[0]-=18,C[0]=1}m=0}}if(u=u[0],p=p[0],0!=m)return m;if(g=!!(2&p),!v&&u)return 3;if(null!=o&&(o[0]=!!(16&p)),null!=s&&(s[0]=g),null!=a&&(a[0]=0),s=c[0],p=l[0],u&&g&&null==h){m=0;break}if(i<4){m=7;break}if(v&&u||!v&&!u&&!Ir(t,e[0],"ALPH")){i=[i],d.na=[d.na],d.P=[d.P],d.Sa=[d.Sa];t:{_=t,m=e;var v=i,C=d.gb,b=d.na,w=d.P,x=d.Sa,S=22;Er(null!=_),Er(null!=v);var y=m[0],A=v[0];for(Er(null!=b),Er(null!=x),b[0]=null,w[0]=null,x[0]=0;;){if(m[0]=y,(v[0]=A)<8){m=7;break t}var L=O(_,y+4);if(4294967286<L){m=3;break t}var T=8+L+1&-2;if(S+=T,0<C&&C<S){m=3;break t}if(!Ir(_,y,"VP8 ")||!Ir(_,y,"VP8L")){m=0;break t}if(A[0]<T){m=7;break t}Ir(_,y,"ALPH")||(b[0]=_,w[0]=y+8,x[0]=L),y+=T,A-=T}}if(i=i[0],d.na=d.na[0],d.P=d.P[0],d.Sa=d.Sa[0],0!=m)break}i=[i],d.Ja=[d.Ja],d.xa=[d.xa];t:if(C=t,m=e,v=i,b=d.gb[0],w=d.Ja,x=d.xa,_=m[0],y=!Ir(C,_,"VP8 "),S=!Ir(C,_,"VP8L"),Er(null!=C),Er(null!=v),Er(null!=w),Er(null!=x),v[0]<8)m=7;else{if(y||S){if(C=O(C,_+4),12<=b&&b-12<C){m=3;break t}if(f&&C>v[0]-8){m=7;break t}w[0]=C,m[0]+=8,v[0]-=8,x[0]=S}else x[0]=5<=v[0]&&47==C[_+0]&&!(C[_+4]>>5),w[0]=v[0];m=0}if(i=i[0],d.Ja=d.Ja[0],d.xa=d.xa[0],e=e[0],0!=m)break;if(4294967286<d.Ja)return 3;if(null==a||g||(a[0]=d.xa?2:1),s=[s],p=[p],d.xa){if(i<5){m=7;break}a=s,f=p,g=o,t=!(null==t||i<5)&&5<=i&&47==t[e+0]&&!(t[e+4]>>5)?(v=[0],C=[0],b=[0],M(w=new P,t,e,i),Z(w,v,C,b)?(null!=a&&(a[0]=v[0]),null!=f&&(f[0]=C[0]),null!=g&&(g[0]=b[0]),1):0):0}else{if(i<10){m=7;break}a=p,t=null==t||i<10||!Pt(t,e+3,i-3)?0:(f=t[e+0]|t[e+1]<<8|t[e+2]<<16,g=16383&(t[e+7]<<8|t[e+6]),t=16383&(t[e+9]<<8|t[e+8]),1&f||3<(f>>1&7)||!(f>>4&1)||f>>5>=d.Ja||!g||!t?0:(s&&(s[0]=g),a&&(a[0]=t),1))}if(!t)return 3;if(s=s[0],p=p[0],u&&(c[0]!=s||l[0]!=p))return 3;null!=h&&(h[0]=d,h.offset=e-h.w,Er(e-h.w<4294967286),Er(h.offset==h.ha-i));break}return 0==m||7==m&&u&&null==h?(null!=o&&(o[0]|=null!=d.na&&0<d.na.length),null!=n&&(n[0]=s),null!=r&&(r[0]=p),0):m}function Ti(t,e,i){var n=e.width,r=e.height,o=0,s=0,a=n,h=r;if(e.Da=null!=t&&0<t.Da,!(e.Da&&(a=t.cd,h=t.bd,o=t.v,s=t.j,i<11||(o&=-2,s&=-2),o<0||s<0||a<=0||h<=0||n<o+a||r<s+h))){if(e.v=o,e.j=s,e.va=o+a,e.o=s+h,e.U=a,e.T=h,e.da=null!=t&&0<t.da,e.da){if(!d(a,h,i=[t.ib],o=[t.hb]))return;e.ib=i[0],e.hb=o[0]}return e.ob=null!=t&&t.ob,e.Kb=null==t||!t.Sd,e.da&&(e.ob=e.ib<3*n/4&&e.hb<3*r/4,e.Kb=0),1}}function Pi(t){return null==t?2:(t.S<11?((e=t.f.RGBA).fb+=(t.height-1)*e.A,e.A=-e.A):(e=t.f.kb,t=t.height,e.O+=(t-1)*e.fa,e.fa=-e.fa,e.N+=(t-1>>1)*e.Ab,e.Ab=-e.Ab,e.W+=(t-1>>1)*e.Db,e.Db=-e.Db,null!=e.F&&(e.J+=(t-1)*e.lb,e.lb=-e.lb)),0);var e}function ki(t,e,i,n){if(null==n||t<=0||e<=0)return 2;if(null!=i){if(i.Da){var r=i.cd,o=i.bd,s=-2&i.v,a=-2&i.j;if(s<0||a<0||r<=0||o<=0||t<s+r||e<a+o)return 2;t=r,e=o}if(i.da){if(!d(t,e,r=[i.ib],o=[i.hb]))return 2;t=r[0],e=o[0]}}n.width=t,n.height=e;t:{var h,c,l=n.width,u=n.height;if(t=n.S,l<=0||u<=0||!(Pn<=t&&t<13))t=2;else{if(n.Rd<=0&&null==n.sd){var s=o=r=e=0,f=(a=l*Fr[t])*u;if(t<11||(o=(u+1)/2*(e=(l+1)/2),12==t&&(s=(r=l)*u)),null==(u=Br(f+2*o+s))){t=1;break t}n.sd=u,t<11?((l=n.f.RGBA).eb=u,l.fb=0,l.A=a,l.size=f):((l=n.f.kb).y=u,l.O=0,l.fa=a,l.Fd=f,l.f=u,l.N=0+f,l.Ab=e,l.Cd=o,l.ea=u,l.W=0+f+o,l.Db=e,l.Ed=o,12==t&&(l.F=u,l.J=0+f+2*o),l.Tc=s,l.lb=r)}e=1,r=n.S,o=n.width,s=n.height,Pn<=r&&r<13?r<11?(t=n.f.RGBA,e&=(a=Math.abs(t.A))*(s-1)+o<=t.size,e&=a>=o*Fr[r],e&=null!=t.eb):(t=n.f.kb,a=(o+1)/2,f=(s+1)/2,l=Math.abs(t.fa),u=Math.abs(t.Ab),h=Math.abs(t.Db),c=Math.abs(t.lb),e&=l*(s-1)+o<=t.Fd,e&=u*(f-1)+a<=t.Cd,e=(e&=h*(f-1)+a<=t.Ed)&o<=l&a<=u&a<=h,e&=null!=t.y,e&=null!=t.f,e&=null!=t.ea,12==r&&(e&=o<=c,e&=c*(s-1)+o<=t.Tc,e&=null!=t.F)):e=0,t=e?0:2}}return 0!=t||null!=i&&i.fd&&(t=Pi(n)),t}var Oi=64,Ni=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ji=24,Fi=32,Ei=8,Ii=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];o("Predictor0","PredictorAdd0"),m.Predictor0=function(){return 4278190080},m.Predictor1=function(t){return t},m.Predictor2=function(t,e,i){return e[i+0]},m.Predictor3=function(t,e,i){return e[i+1]},m.Predictor4=function(t,e,i){return e[i-1]},m.Predictor5=function(t,e,i){return a(a(t,e[i+1]),e[i+0])},m.Predictor6=function(t,e,i){return a(t,e[i-1])},m.Predictor7=function(t,e,i){return a(t,e[i+0])},m.Predictor8=function(t,e,i){return a(e[i-1],e[i+0])},m.Predictor9=function(t,e,i){return a(e[i+0],e[i+1])},m.Predictor10=function(t,e,i){return a(a(t,e[i-1]),a(e[i+0],e[i+1]))},m.Predictor11=function(t,e,i){var n=e[i+0];return l(n>>24&255,t>>24&255,(e=e[i-1])>>24&255)+l(n>>16&255,t>>16&255,e>>16&255)+l(n>>8&255,t>>8&255,e>>8&255)+l(255&n,255&t,255&e)<=0?n:t},m.Predictor12=function(t,e,i){var n=e[i+0];return(h((t>>24&255)+(n>>24&255)-((e=e[i-1])>>24&255))<<24|h((t>>16&255)+(n>>16&255)-(e>>16&255))<<16|h((t>>8&255)+(n>>8&255)-(e>>8&255))<<8|h((255&t)+(255&n)-(255&e)))>>>0},m.Predictor13=function(t,e,i){var n=e[i-1];return(c((t=a(t,e[i+0]))>>24&255,n>>24&255)<<24|c(t>>16&255,n>>16&255)<<16|c(t>>8&255,n>>8&255)<<8|c(t>>0&255,n>>0&255))>>>0};var Di=m.PredictorAdd0;m.PredictorAdd1=j,o("Predictor2","PredictorAdd2"),o("Predictor3","PredictorAdd3"),o("Predictor4","PredictorAdd4"),o("Predictor5","PredictorAdd5"),o("Predictor6","PredictorAdd6"),o("Predictor7","PredictorAdd7"),o("Predictor8","PredictorAdd8"),o("Predictor9","PredictorAdd9"),o("Predictor10","PredictorAdd10"),o("Predictor11","PredictorAdd11"),o("Predictor12","PredictorAdd12"),o("Predictor13","PredictorAdd13");var Mi=m.PredictorAdd2;_("ColorIndexInverseTransform","MapARGB","32b",function(t){return t>>8&255},function(t){return t}),_("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(t){return t},function(t){return t>>8&255});var Bi,Ri=m.ColorIndexInverseTransform,zi=m.MapARGB,qi=m.VP8LColorIndexInverseTransformAlpha,Ui=m.MapAlpha,Wi=m.VP8LPredictorsAdd=[];Wi.length=16,(m.VP8LPredictors=[]).length=16,(m.VP8LPredictorsAdd_C=[]).length=16,(m.VP8LPredictors_C=[]).length=16;var Hi,Vi,Xi,Gi,Yi,Ki,Ji,$i,Zi,Qi,tn,en,nn,rn,on,sn,an,hn,cn,ln,un,fn,dn,pn,gn,mn,vn,yn,bn=Br(511),wn=Br(2041),xn=Br(225),_n=Br(767),Sn=0,Cn=wn,An=xn,Ln=_n,Tn=bn,Pn=0,kn=1,On=2,Nn=3,jn=4,Fn=5,En=6,In=7,Dn=8,Mn=9,Bn=10,Rn=[2,3,7],zn=[3,3,11],qn=[280,256,256,256,40],Un=[0,1,1,1,0],Wn=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Hn=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Vn=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Xn=8,Gn=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Yn=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Kn=null,Jn=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],$n=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Zn=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Qn=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],tr=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],er=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ir=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],nr=[],rr=[],or=[],sr=1,ar=2,hr=[],cr=[];ci("UpsampleRgbLinePair",gi,3),ci("UpsampleBgrLinePair",mi,3),ci("UpsampleRgbaLinePair",xi,4),ci("UpsampleBgraLinePair",wi,4),ci("UpsampleArgbLinePair",bi,4),ci("UpsampleRgba4444LinePair",yi,2),ci("UpsampleRgb565LinePair",vi,2);var lr=m.UpsampleRgbLinePair,ur=m.UpsampleBgrLinePair,fr=m.UpsampleRgbaLinePair,dr=m.UpsampleBgraLinePair,pr=m.UpsampleArgbLinePair,gr=m.UpsampleRgba4444LinePair,mr=m.UpsampleRgb565LinePair,vr=16,yr=1<<vr-1,br=-227,wr=482,xr=6,_r=(256<<xr)-1,Sr=0,Cr=Br(256),Ar=Br(256),Lr=Br(256),Tr=Br(256),Pr=Br(wr-br),kr=Br(wr-br);_i("YuvToRgbRow",gi,3),_i("YuvToBgrRow",mi,3),_i("YuvToRgbaRow",xi,4),_i("YuvToBgraRow",wi,4),_i("YuvToArgbRow",bi,4),_i("YuvToRgba4444Row",yi,2),_i("YuvToRgb565Row",vi,2);var Or=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Nr=[0,2,8],jr=[8,7,6,4,4,2,2,2,1,1,1,1];this.WebPDecodeRGBA=function(t,e,i,n,r){var o=kn,s=new Ke,a=new W;(s.ba=a).S=o,a.width=[a.width],a.height=[a.height];var h=a.width,c=a.height,l=new H,u=null==l||null==t?2:(Er(null!=l),Li(t,e,i,l.width,l.height,l.Pd,l.Qd,l.format,null));if(h=0!=u?0:(null!=h&&(h[0]=l.width[0]),null!=c&&(c[0]=l.height[0]),1)){a.width=a.width[0],a.height=a.height[0],null!=n&&(n[0]=a.width),null!=r&&(r[0]=a.height);t:{if(n=new At,(r=new Je).data=t,r.w=e,r.ha=i,r.kd=1,e=[0],Er(null!=r),0==(e=t=(0==(t=Li(r.data,r.w,r.ha,null,null,null,e,null,r))||7==t)&&e[0]?4:t)){if(Er(null!=s),n.data=r.data,n.w=r.w+r.offset,n.ha=r.ha-r.offset,n.put=J,n.ac=K,n.bc=$,n.ma=s,r.xa){if(null==(t=ht())){s=1;break t}if(function(t,e){var i=[0],n=[0],r=[0];e:for(;;){if(null==t)return;if(null==e)return t.a=2,0;if(t.l=e,t.a=0,M(t.m,e.data,e.w,e.ha),!Z(t.m,i,n,r)){t.a=3;break e}if(t.xb=ar,e.width=i[0],e.height=n[0],!ne(i[0],n[0],1,t,null))break e;return 1}return Er(0!=t.a),0}(t,n)){if(n=0==(e=ki(n.width,n.height,s.Oa,s.ba))){e:{n=t;i:for(;;){if(null==n){n=0;break e}if(Er(null!=n.s.yc),Er(null!=n.s.Ya),Er(0<n.s.Wb),Er(null!=(i=n.l)),Er(null!=(r=i.ma)),0!=n.xb){if(n.ca=r.ba,n.tb=r.tb,Er(null!=n.ca),!Ti(r.Oa,i,Nn)){n.a=2;break i}if(!ct(n,i.width))break i;if(i.da)break i;if((i.da||z(n.ca.S))&&hi(),n.ca.S<11||(alert("todo:WebPInitConvertARGBToYUV"),null!=n.ca.f.kb.F&&hi()),n.Pb&&0<n.s.ua&&null==n.s.vb.X&&!$t(n.s.vb,n.s.Wa.Xa)){n.a=1;break i}n.xb=0}if(!ee(n,n.V,n.Ba,n.c,n.i,i.o,rt))break i;r.Dc=n.Ma,n=1;break e}Er(0!=n.a),n=0}n=!n}n&&(e=t.a)}else e=t.a}else{if(null==(t=new Lt)){s=1;break t}if(t.Fa=r.na,t.P=r.P,t.qc=r.Sa,kt(t,n)){if(0==(e=ki(n.width,n.height,s.Oa,s.ba))){if(t.Aa=0,i=s.Oa,Er(null!=(r=t)),null!=i){if(0<(h=(h=i.Md)<0?0:100<h?255:255*h/100)){for(c=l=0;c<4;++c)(u=r.pb[c]).lc<12&&(u.ia=h*jr[u.lc<0?0:u.lc]>>3),l|=u.ia;l&&(alert("todo:VP8InitRandom"),r.ia=1)}r.Ga=i.Id,100<r.Ga?r.Ga=100:r.Ga<0&&(r.Ga=0)}jt(t,n)||(e=t.a)}}else e=t.a}0==e&&null!=s.Oa&&s.Oa.fd&&(e=Pi(s.ba))}s=e}o=0!=s?null:o<11?a.f.RGBA.eb:a.f.kb.y}else o=null;return o};var Fr=[3,4,3,4,4,2,2,4,4,4,2,1,1]});var e=[0],i=[0],n=[],r=new De,o=t,s=function(t,e){var i={},n=0,r=!1,o=0,s=0;if(i.frames=[],!function(t,e){for(var i=0;i<4;i++)if(t[e+i]!="RIFF".charCodeAt(i))return 1}(t,e)){for(p(t,e+=4),e+=8;e<t.length;){var a=function(t,e){for(var i="",n=0;n<4;n++)i+=String.fromCharCode(t[e++]);return i}(t,e),h=p(t,e+=4);e+=4;var c,l,u=h+(1&h);switch(a){case"VP8 ":case"VP8L":void 0===i.frames[n]&&(i.frames[n]={}),(l=i.frames[n]).src_off=r?s:e-8,l.src_size=o+h+8,n++,r&&(r=!1,s=o=0);break;case"VP8X":(l=i.header={}).feature_flags=t[e];var f=e+4;l.canvas_width=1+d(t,f),f+=3,l.canvas_height=1+d(t,f),f+=3;break;case"ALPH":r=!0,o=u+8,s=e-8;break;case"ANIM":(l=i.header).bgcolor=p(t,e),l.loop_count=t[(c=f=e+4)+0]<<0|t[c+1]<<8,f+=2;break;case"ANMF":(l=i.frames[n]={}).offset_x=2*d(t,e),e+=3,l.offset_y=2*d(t,e),e+=3,l.width=1+d(t,e),e+=3,l.height=1+d(t,e),e+=3,l.duration=d(t,e),e+=3,c=t[e++],l.dispose=1&c,l.blend=c>>1&1}"ANMF"!=a&&(e+=u)}return i}}(o,0);s.response=o,s.rgbaoutput=!0,s.dataurl=!1;var t=s.header||null,a=s.frames||null;if(t){t.loop_counter=t.loop_count;for(var e=[t.canvas_height],i=[t.canvas_width],h=0;h<a.length&&0!=a[h].blend;h++);}var t=a[0],c=r.WebPDecodeRGBA(o,t.src_off,t.src_size,i,e);t.rgba=c,t.imgwidth=i[0],t.imgheight=e[0];for(var l=0;l<i[0]*e[0]*4;l++)n[l]=c[l];return this.width=i,this.height=e,this.data=n,this}function Me(t){if(this.rawData=t,t=this.contents=new Ke(t),this.contents.pos=4,"ttcf"===t.readString(4))throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new ki(this),this.registerTTF()}function Be(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0}function Re(){var t='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',e=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(t)),n=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),r=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),o=unescape(encodeURIComponent("</x:xmpmeta>")),t=i.length+n.length+r.length+e.length+o.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+t+" >>"),this.internal.write("stream"),this.internal.write(e+i+n+r+o),this.internal.write("endstream"),this.internal.write("endobj")}function ze(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")}function qe(t){for(var e=t.length,i=new Uint8Array(e),n=0;n<e;n++)i[n]=t.charCodeAt(n);return i}function Ue(t,e,i,n){var r=4,o=Ve;switch(n){case Te.image_compression.FAST:r=1,o=He;break;case Te.image_compression.MEDIUM:r=6,o=Xe;break;case Te.image_compression.SLOW:r=9,o=Ge}return t=s(t=function(t,e,i,n){for(var r,o,s,a=t.length/e,h=new Uint8Array(t.length+a),c=ke(),l=0;l<a;l+=1){if(s=l*e,r=t.subarray(s,s+e),n)h.set(n(r,i,o),s+l);else{for(var u,f=c.length,d=[];u<f;u+=1)d[u]=c[u](r,i,o);var p=Oe(d.concat());h.set(d[p],s+l)}o=r}return h}(t,e,i,o),{level:r}),Te.__addimage__.arrayBufferToBinaryString(t)}function We(t){return(t=Array.apply([],t)).unshift(0),t}function He(t,e){var i,n=[],r=t.length;n[0]=1;for(var o=0;o<r;o+=1)i=t[o-e]||0,n[o+1]=t[o]-i+256&255;return n}function Ve(t,e,i){var n,r=[],o=t.length;r[0]=2;for(var s=0;s<o;s+=1)n=i&&i[s]||0,r[s+1]=t[s]-n+256&255;return r}function Xe(t,e,i){var n,r,o=[],s=t.length;o[0]=3;for(var a=0;a<s;a+=1)n=t[a-e]||0,r=i&&i[a]||0,o[a+1]=t[a]+256-(n+r>>>1)&255;return o}function Ge(t,e,i){var n,r,o,s=[],a=t.length;s[0]=4;for(var h=0;h<a;h+=1)n=t[h-e]||0,r=i&&i[h]||0,o=i&&i[h-e]||0,o=Pe(n,r,o),s[h+1]=t[h]-o+256&255;return s}Te=wi.API,Pe=function(t,e,i){if(t===e&&e===i)return t;var n=Math.abs(e-i),r=Math.abs(t-i),o=Math.abs(t+e-i-i);return n<=r&&n<=o?t:r<=o?e:i},ke=function(){return[We,He,Ve,Xe,Ge]},Oe=function(t){t=t.map(function(t){return t.reduce(function(t,e){return t+Math.abs(e)},0)});return t.indexOf(Math.min.apply(null,t))},Te.processPNG=function(t,e,i,n){var r,o,s,a,h,c,l,u,f,d=this.decode.FLATE_DECODE,p="";if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){if(t=(s=new Ne(t)).imgData,o=s.bits,r=s.colorSpace,h=s.colors,-1!==[4,6].indexOf(s.colorType)){if(8===s.bits)for(var g,m=(u=new(32==s.pixelBitlength?Uint32Array:16==s.pixelBitlength?Uint16Array:Uint8Array)(s.decodePixels().buffer)).length,v=new Uint8Array(m*s.colors),y=new Uint8Array(m),b=s.pixelBitlength-s.bits,w=0,x=0;w<m;w++){for(f=u[w],g=0;g<b;)v[x++]=f>>>g&255,g+=s.bits;y[w]=f>>>g&255}if(16===s.bits){m=(u=new Uint32Array(s.decodePixels().buffer)).length,v=new Uint8Array(m*(32/s.pixelBitlength)*s.colors),y=new Uint8Array(m*(32/s.pixelBitlength));for(var _=1<s.colors,S=x=w=0;w<m;)f=u[w++],v[x++]=f>>>0&255,_&&(v[x++]=f>>>16&255,f=u[w++],v[x++]=f>>>0&255),y[S++]=f>>>16&255;o=8}n!==Te.image_compression.NONE?(t=Ue(v,s.width*s.colors,s.colors,n),l=Ue(y,s.width,1,n)):(t=v,l=y,d=void 0)}if(3===s.colorType&&(r=this.color_spaces.INDEXED,c=s.palette,s.transparency.indexed)){var C=s.transparency.indexed,A=0;for(w=0,m=C.length;w<m;++w)A+=C[w];if((A/=255)==m-1&&-1!==C.indexOf(0))a=[C.indexOf(0)];else if(A!==m){for(u=s.decodePixels(),y=new Uint8Array(u.length),w=0,m=u.length;w<m;w++)y[w]=C[u[w]];l=Ue(y,s.width,1)}}var L=function(){var t;switch(n){case Te.image_compression.FAST:t=11;break;case Te.image_compression.MEDIUM:t=13;break;case Te.image_compression.SLOW:t=14;break;default:t=12}return t}();return d===this.decode.FLATE_DECODE&&(p="/Predictor "+L+" "),p+="/Colors "+h+" /BitsPerComponent "+o+" /Columns "+s.width,{alias:i,data:t=this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t,index:e,filter:d,decodeParameters:p,transparency:a,palette:c,sMask:l=l&&this.__addimage__.isArrayBuffer(l)||this.__addimage__.isArrayBufferView(l)?this.__addimage__.arrayBufferToBinaryString(l):l,predictor:L,width:s.width,height:s.height,bitsPerComponent:o,colorSpace:r}}},(Le=wi.API).processGIF89A=function(t,e,i,n){var r=new je(t),o=r.width,s=r.height,t=[];r.decodeAndBlitFrameRGBA(0,t);s={data:t,width:o,height:s},s=new Ee(100).encode(s,100);return Le.processJPEG.call(this,s,e,i,n)},Le.processGIF87A=Le.processGIF89A,Ie.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var i=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:r,green:n,blue:i,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ie.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(t){ui.log("bit decode error:"+t)}},Ie.prototype.bit1=function(){for(var t=Math.ceil(this.width/8),e=t%4,i=this.height-1;0<=i;i--){for(var n=this.bottom_up?i:this.height-1-i,r=0;r<t;r++)for(var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*r*4,a=0;a<8&&8*r+a<this.width;a++){var h=this.palette[o>>7-a&1];this.data[s+4*a]=h.blue,this.data[s+4*a+1]=h.green,this.data[s+4*a+2]=h.red,this.data[s+4*a+3]=255}0!=e&&(this.pos+=4-e)}},Ie.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,i=this.height-1;0<=i;i--){for(var n=this.bottom_up?i:this.height-1-i,r=0;r<t;r++){var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*r*4,a=15&o,o=this.palette[o>>4];if(this.data[s]=o.blue,this.data[1+s]=o.green,this.data[2+s]=o.red,this.data[3+s]=255,2*r+1>=this.width)break;o=this.palette[a],this.data[4+s]=o.blue,this.data[4+s+1]=o.green,this.data[4+s+2]=o.red,this.data[4+s+3]=255}0!=e&&(this.pos+=4-e)}},Ie.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;0<=e;e--){for(var i=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),o=i*this.width*4+4*n;r<this.palette.length?(r=this.palette[r],this.data[o]=r.red,this.data[1+o]=r.green,this.data[2+o]=r.blue):(this.data[o]=255,this.data[1+o]=255,this.data[2+o]=255),this.data[3+o]=255}0!=t&&(this.pos+=4-t)}},Ie.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),i=this.height-1;0<=i;i--){for(var n=this.bottom_up?i:this.height-1-i,r=0;r<this.width;r++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&e)/e*255|0,a=(o>>5&e)/e*255|0,h=o>>15?255:0,c=n*this.width*4+4*r;this.data[c]=(o>>10&e)/e*255|0,this.data[1+c]=a,this.data[2+c]=s,this.data[3+c]=h}this.pos+=t}},Ie.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),i=parseInt("111111",2),n=this.height-1;0<=n;n--){for(var r=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,h=(s>>5&i)/i*255|0,c=r*this.width*4+4*o;this.data[c]=(s>>11)/e*255|0,this.data[1+c]=h,this.data[2+c]=a,this.data[3+c]=255}this.pos+=t}},Ie.prototype.bit24=function(){for(var t=this.height-1;0<=t;t--){for(var e=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*i;this.data[s]=o,this.data[1+s]=r,this.data[2+s]=n,this.data[3+s]=255}this.pos+=this.width%4}},Ie.prototype.bit32=function(){for(var t=this.height-1;0<=t;t--)for(var e=this.bottom_up?t:this.height-1-t,i=0;i<this.width;i++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*i;this.data[a]=o,this.data[1+a]=r,this.data[2+a]=n,this.data[3+a]=s}},Ie.prototype.getData=function(){return this.data},(Ae=wi.API).processBMP=function(t,e,i,n){var r=new Ie(t,!1),o=r.width,t=r.height,t={data:r.getData(),width:o,height:t},t=new Ee(100).encode(t,100);return Ae.processJPEG.call(this,t,e,i,n)},De.prototype.getData=function(){return this.data},(Ce=wi.API).processWEBP=function(t,e,i,n){var r=new De(t,!1),o=r.width,t=r.height,t={data:r.getData(),width:o,height:t},t=new Ee(100).encode(t,100);return Ce.processJPEG.call(this,t,e,i,n)},wi.API.setLanguage=function(t){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"FYRO Macedonian",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]&&(this.internal.languageSettings.languageCode=t,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ye=wi.API,be=ye.getCharWidthsArray=function(t,e){for(var i,n,r=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),a=e.widths||r.metadata.Unicode.widths,h=a.fof||1,c=e.kerning||r.metadata.Unicode.kerning,l=c.fof||1,u=!1!==e.doKerning,f=t.length,d=0,p=a[0]||h,g=[],m=0;m<f;m++)i=t.charCodeAt(m),"function"==typeof r.metadata.widthOfString?g.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(i))+s*(1e3/o)||0)/1e3):(n=u&&"object"==typeof c[i]&&!isNaN(parseInt(c[i][d],10))?c[i][d]/l:0,g.push((a[i]||p)/h+n)),d=i;return g},we=ye.getStringUnitWidth=function(t,e){var i=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),e=e.charSpace||this.internal.getCharSpace();return ye.processArabic&&(t=ye.processArabic(t)),"function"==typeof n.metadata.widthOfString?n.metadata.widthOfString(t,i,e)/i:be.apply(this,arguments).reduce(function(t,e){return t+e},0)},xe=function(t,e,i,n){for(var r=[],o=0,s=t.length,a=0;o!==s&&a+e[o]<i;)a+=e[o],o++;r.push(t.slice(0,o));for(var h=o,a=0;o!==s;)a+e[o]>n&&(r.push(t.slice(h,o)),a=0,h=o),a+=e[o],o++;return h!==o&&r.push(t.slice(h,o)),r},_e=function(t,e,i){var n,r,o,s,a,h,c,l=[],u=[l],f=(i=i||{}).textIndent||0,d=0,p=0,g=t.split(" "),m=be.apply(this,[" ",i])[0];for((a=-1===i.lineIndent?g[0].length+2:i.lineIndent||0)&&(h=Array(a).join(" "),c=[],g.map(function(t){1<(t=t.split(/\s*\n/)).length?c=c.concat(t.map(function(t,e){return(e&&t.length?"\n":"")+t})):c.push(t[0])}),g=c,a=we.apply(this,[h,i])),r=0,o=g.length;r<o;r++){var v=0,y=g[r];if(a&&"\n"==y[0]&&(y=y.substr(1),v=1),f+d+(p=(n=be.apply(this,[y,i])).reduce(function(t,e){return t+e},0))>e||v){if(e<p){for(s=xe.apply(this,[y,n,e-(f+d),e]),l.push(s.shift()),l=[s.pop()];s.length;)u.push([s.shift()]);p=n.slice(y.length-(l[0]?l[0].length:0)).reduce(function(t,e){return t+e},0)}else l=[y];u.push(l),f=p+a,d=m}else l.push(y),f+=d+p,d=m}return u.map(a?function(t,e){return(e?h:"")+t.join(" ")}:function(t){return t.join(" ")})},ye.splitTextToSize=function(t,e,i){var n=(i=i||{}).fontSize||this.internal.getFontSize(),r=function(t){if(t.widths&&t.kerning)return{widths:t.widths,kerning:t.kerning};t=this.internal.getFont(t.fontName,t.fontStyle);return t.metadata.Unicode?{widths:t.metadata.Unicode.widths||{0:1},kerning:t.metadata.Unicode.kerning||{}}:{font:t.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,i),o=Array.isArray(t)?t:String(t).split(/\r?\n/),s=+this.internal.scaleFactor*e/n;r.textIndent=i.textIndent?+i.textIndent*this.internal.scaleFactor/n:0,r.lineIndent=i.lineIndent;for(var a=[],h=0,c=o.length;h<c;h++)a=a.concat(_e.apply(this,[o[h],s,r]));return a},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",d={},s={},i=0;i<e.length;i++)d[e[i]]="0123456789abcdef"[i],s["0123456789abcdef"[i]]=e[i];function a(t){return"0x"+parseInt(t,10).toString(16)}var h=t.__fontmetrics__.compress=function(t){var e,i,n,r,o=["{"];for(r in t){if(e=t[r],i=isNaN(parseInt(r,10))?"'"+r+"'":(r=parseInt(r,10),(i=a(r).slice(2)).slice(0,-1)+s[i.slice(-1)]),"number"==typeof e)n=(e<0?(n=a(e).slice(3),"-"):(n=a(e).slice(2),""))+n.slice(0,-1)+s[n.slice(-1)];else{if("object"!=typeof e)throw new Error("Don't know what to do with value type "+typeof e+".");n=h(e)}o.push(i+n)}return o.push("}"),o.join("")},n=t.__fontmetrics__.uncompress=function(t){if("string"!=typeof t)throw new Error("Invalid argument passed to uncompress.");for(var e,i,n,r,o={},s=1,a=o,h=[],c="",l="",u=t.length-1,f=1;f<u;f+=1)"'"==(r=t[f])?e=e?void(n=e.join("")):[]:e?e.push(r):"{"==r?(h.push([a,n]),a={},n=void 0):"}"==r?((i=h.pop())[0][i[1]]=a,n=void 0,a=i[0]):"-"==r?s=-1:void 0===n?d.hasOwnProperty(r)?(c+=d[r],n=parseInt(c,16)*s,s=1,c=""):c+=r:d.hasOwnProperty(r)?(l+=d[r],a[n]=parseInt(l,16)*s,s=1,n=void 0,l=""):l+=r;return o},r={codePages:["WinAnsiEncoding"],WinAnsiEncoding:n("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},o={Unicode:{Courier:r,"Courier-Bold":r,"Courier-BoldOblique":r,"Courier-Oblique":r,Helvetica:r,"Helvetica-Bold":r,"Helvetica-BoldOblique":r,"Helvetica-Oblique":r,"Times-Roman":r,"Times-Bold":r,"Times-BoldItalic":r,"Times-Italic":r}},c={Unicode:{"Courier-Oblique":n("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":n("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":n("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:n("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":n("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":n("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:n("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:n("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":n("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:n("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":n("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":n("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":n("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":n("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(t){var e=t.font,t=c.Unicode[e.postScriptName];t&&(e.metadata.Unicode={},e.metadata.Unicode.widths=t.widths,e.metadata.Unicode.kerning=t.kerning);t=o.Unicode[e.postScriptName];t&&(e.metadata.Unicode.encoding=t,e.encoding=t.codePages[0])}])}(wi.API),(Se=wi).API.events.push(["addFont",function(t){var e=void 0,i=t.font,t=t.instance;if(!i.isStandardFont){if(void 0===t)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if("string"!=typeof(e=!1===t.existsFileInVFS(i.postScriptName)?t.loadFile(i.postScriptName):t.getFileFromVFS(i.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");i=i,e=/^\x00\x01\x00\x00/.test(e=e)?qe(e):qe(L(e)),i.metadata=Se.API.TTFFont.open(e),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]}}]),wi.API.addSvgAsImage=function(e,t,i,n,r,o,s,a){if(isNaN(t)||isNaN(i))throw ui.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(r))throw ui.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=n,h.height=r;var c=h.getContext("2d");c.fillStyle="#fff",c.fillRect(0,0,h.width,h.height);var l={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},u=this;return(li.canvg?ci.resolve(li.canvg):f.e(513).then(f.bind(f,5513))).catch(function(t){return ci.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default||t}).then(function(t){return t.fromString(c,e,l)},function(){return ci.reject(new Error("Could not load canvg."))}).then(function(t){return t.render(l)}).then(function(){u.addImage(h.toDataURL("image/jpeg",1),t,i,n,r,s,a)})},wi.API.putTotalPages=function(t){for(var e,i=0,i=parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont())),n=1;n<=this.internal.getNumberOfPages();n++)for(var r=0;r<this.internal.pages[n].length;r++)this.internal.pages[n][r]=this.internal.pages[n][r].replace(e,i);return this},wi.API.viewerPreferences=function(t,e){var i;t=t||{},e=e||!1;var n,r,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(s),h=[],c=0,l=0,u=0;function f(t,e){for(var i=!1,n=0;n<t.length;n+=1)t[n]===e&&(i=!0);return i}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),i=this.internal.viewerpreferences.configuration,"reset"===t||!0===e)for(var d=a.length,u=0;u<d;u+=1)i[a[u]].value=i[a[u]].defaultValue,i[a[u]].explicitSet=!1;if("object"==typeof t)for(r in t)if(o=t[r],f(a,r)&&void 0!==o){if("boolean"===i[r].type&&"boolean"==typeof o)i[r].value=o;else if("name"===i[r].type&&f(i[r].valueSet,o))i[r].value=o;else if("integer"===i[r].type&&Number.isInteger(o))i[r].value=o;else if("array"===i[r].type){for(c=0;c<o.length;c+=1)if(n=!0,1===o[c].length&&"number"==typeof o[c][0])h.push(String(o[c]-1));else if(1<o[c].length){for(l=0;l<o[c].length;l+=1)"number"!=typeof o[c][l]&&(n=!1);!0===n&&h.push([o[c][0]-1,o[c][1]-1].join(" "))}i[r].value="["+h.join(" ")+"]"}else i[r].value=i[r].defaultValue;i[r].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var t,e=[];for(t in i)!0===i[t].explicitSet&&("name"===i[t].type?e.push("/"+t+" /"+i[t].value):e.push("/"+t+" "+i[t].value));0!==e.length&&this.internal.write("/ViewerPreferences\n<<\n"+e.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=i,this},wi.API.addMetadata=function(t,e){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:t,namespaceuri:e||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",ze),this.internal.events.subscribe("postPutResources",Re)),this},function(f){function d(t){for(var e,i,n,r="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",o=[],s=0,a=(i=Object.keys(t).sort(function(t,e){return t-e})).length;s<a;s++)e=i[s],100<=o.length&&(r+="\n"+o.length+" beginbfchar\n"+o.join("\n")+"\nendbfchar",o=[]),void 0!==t[e]&&null!==t[e]&&"function"==typeof t[e].toString&&(n=("0000"+t[e].toString(16)).slice(-4),e=("0000"+(+e).toString(16)).slice(-4),o.push("<"+e+"><"+n+">"));return o.length&&(r+="\n"+o.length+" beginbfchar\n"+o.join("\n")+"\nendbfchar\n"),r+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"}var t=f.API,p=t.pdfEscape16=function(t,e){for(var i,n=e.metadata.Unicode.widths,r=["","0","00","000","0000"],o=[""],s=0,a=t.length;s<a;++s){if(i=e.metadata.characterToGlyph(t.charCodeAt(s)),e.metadata.glyIdsUsed.push(i),e.metadata.toUnicode[i]=t.charCodeAt(s),-1==n.indexOf(i)&&(n.push(i),n.push([parseInt(e.metadata.widthOfGlyph(i),10)])),"0"==i)return o.join("");i=i.toString(16),o.push(r[4-i.length],i)}return o.join("")};t.events.push(["putFont",function(u){!function(){var t=u.font,e=u.out,i=u.newObject,n=u.putStream,r=u.pdfEscapeWithNeededParanthesis;if(t.metadata instanceof f.API.TTFFont&&"Identity-H"===t.encoding){for(var o=t.metadata.Unicode.widths,s=t.metadata.subset.encode(t.metadata.glyIdsUsed,1),a="",h=0;h<s.length;h++)a+=String.fromCharCode(s[h]);var c=i();n({data:a,addLength1:!0,objectId:c}),e("endobj");var l=i();n({data:d(t.metadata.toUnicode),addLength1:!0,objectId:l}),e("endobj");n=i();e("<<"),e("/Type /FontDescriptor"),e("/FontName /"+r(t.fontName)),e("/FontFile2 "+c+" 0 R"),e("/FontBBox "+f.API.PDFObject.convert(t.metadata.bbox)),e("/Flags "+t.metadata.flags),e("/StemV "+t.metadata.stemV),e("/ItalicAngle "+t.metadata.italicAngle),e("/Ascent "+t.metadata.ascender),e("/Descent "+t.metadata.decender),e("/CapHeight "+t.metadata.capHeight),e(">>"),e("endobj");c=i();e("<<"),e("/Type /Font"),e("/BaseFont /"+r(t.fontName)),e("/FontDescriptor "+n+" 0 R"),e("/W "+f.API.PDFObject.convert(o)),e("/CIDToGIDMap /Identity"),e("/DW 1000"),e("/Subtype /CIDFontType2"),e("/CIDSystemInfo"),e("<<"),e("/Supplement 0"),e("/Registry (Adobe)"),e("/Ordering ("+t.encoding+")"),e(">>"),e(">>"),e("endobj"),t.objectNumber=i(),e("<<"),e("/Type /Font"),e("/Subtype /Type0"),e("/ToUnicode "+l+" 0 R"),e("/BaseFont /"+r(t.fontName)),e("/Encoding /"+t.encoding),e("/DescendantFonts ["+c+" 0 R]"),e(">>"),e("endobj"),t.isAlreadyPutted=!0}}()}]),t.events.push(["putFont",function(u){!function(){var t=u.font,e=u.out,i=u.newObject,n=u.putStream,r=u.pdfEscapeWithNeededParanthesis;if(t.metadata instanceof f.API.TTFFont&&"WinAnsiEncoding"===t.encoding){for(var o=t.metadata.rawData,s="",a=0;a<o.length;a++)s+=String.fromCharCode(o[a]);var h=i();n({data:s,addLength1:!0,objectId:h}),e("endobj");var c=i();n({data:d(t.metadata.toUnicode),addLength1:!0,objectId:c}),e("endobj");n=i();e("<<"),e("/Descent "+t.metadata.decender),e("/CapHeight "+t.metadata.capHeight),e("/StemV "+t.metadata.stemV),e("/Type /FontDescriptor"),e("/FontFile2 "+h+" 0 R"),e("/Flags 96"),e("/FontBBox "+f.API.PDFObject.convert(t.metadata.bbox)),e("/FontName /"+r(t.fontName)),e("/ItalicAngle "+t.metadata.italicAngle),e("/Ascent "+t.metadata.ascender),e(">>"),e("endobj"),t.objectNumber=i();for(var l=0;l<t.metadata.hmtx.widths.length;l++)t.metadata.hmtx.widths[l]=parseInt(t.metadata.hmtx.widths[l]*(1e3/t.metadata.head.unitsPerEm));e("<</Subtype/TrueType/Type/Font/ToUnicode "+c+" 0 R/BaseFont/"+r(t.fontName)+"/FontDescriptor "+n+" 0 R/Encoding/"+t.encoding+" /FirstChar 29 /LastChar 255 /Widths "+f.API.PDFObject.convert(t.metadata.hmtx.widths)+">>"),e("endobj"),t.isAlreadyPutted=!0}}()}]);function o(t){var e,i=t.text||"",n=t.x,r=t.y,o=t.options||{},s=t.mutex||{},a=s.pdfEscape,h=s.activeFontKey,c=s.fonts,l=h,u="",f=0,d="",t=c[l].encoding;if("Identity-H"!==c[l].encoding)return{text:i,x:n,y:r,options:o,mutex:s};for(d=i,l=h,Array.isArray(i)&&(d=i[0]),f=0;f<d.length;f+=1)(e=c[l].metadata.hasOwnProperty("cmap")?c[l].metadata.cmap.unicode.codeMap[d[f].charCodeAt(0)]:e)||d[f].charCodeAt(0)<256&&c[l].metadata.hasOwnProperty("Unicode")?u+=d[f]:u+="";return i="",parseInt(l.slice(1))<14||"WinAnsiEncoding"===t?i=a(u,l).split("").map(function(t){return t.charCodeAt(0).toString(16)}).join(""):"Identity-H"===t&&(i=p(u,c[l])),s.isHex=!0,{text:i,x:n,y:r,options:o,mutex:s}}t.events.push(["postProcessText",function(t){var e=t.text||"",i=[],n={text:e,x:t.x,y:t.y,options:t.options,mutex:t.mutex};if(Array.isArray(e)){for(var r=0,r=0;r<e.length;r+=1)Array.isArray(e[r])&&3===e[r].length?i.push([o(Object.assign({},n,{text:e[r][0]})).text,e[r][1],e[r][2]]):i.push(o(Object.assign({},n,{text:e[r]})).text);t.text=i}else t.text=o(Object.assign({},n,{text:e})).text}])}(wi),(e=wi.API).existsFileInVFS=function(t){return Be.call(this),void 0!==this.internal.vFS[t]},e.addFileToVFS=function(t,e){return Be.call(this),this.internal.vFS[t]=e,this},e.getFileFromVFS=function(t){return Be.call(this),void 0!==this.internal.vFS[t]?this.internal.vFS[t]:null},function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(t){var d,p,c,l,r,o,s,n=e,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},a={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},h=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],u=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),y=!1,b=0;this.__bidiEngine__={};function f(t){for(var e,i=0;i<t.length;i++){if("L"===(e=_(t.charAt(i))))return!1;if("R"===e)return!0}return!1}function w(t,e,i){return t=t.split(""),i&&C(t,i,{hiLevel:b}),t.reverse(),e&&e.reverse(),t.join("")}function x(t,e,i){var t=t.split(""),r={hiLevel:b};return C(t,i=i||[],r),function(t,e){if(0!==r.hiLevel&&s)for(var i,n=0;n<t.length;n++)1===e[n]&&0<=(i=h.indexOf(t[n]))&&(t[n]=h[i+1])}(t,i),A(2,t,e,i,r),A(1,t,e,i,r),t.join("")}var _=function(t){var e=t.charCodeAt(),i=e>>8,t=a[i];return void 0!==t?n[256*t+(255&e)]:252==i||253==i?"AL":u.test(i)?"L":8==i?"R":"N"},S=function(t,e,i,n){var r,o,s=e[n];switch(s){case"L":case"R":y=!1;break;case"N":case"AN":break;case"EN":y&&(s="AN");break;case"AL":y=!0,s="R";break;case"WS":s="N";break;case"CS":n<1||n+1>=e.length||"EN"!==(h=i[n-1])&&"AN"!==h||"EN"!==(a=e[n+1])&&"AN"!==a?s="N":y&&(a="AN"),s=a===h?a:"N";break;case"ES":s="EN"===(h=0<n?i[n-1]:"B")&&n+1<e.length&&"EN"===e[n+1]?"EN":"N";break;case"ET":if(0<n&&"EN"===i[n-1]){s="EN";break}if(y){s="N";break}for(r=n+1,o=e.length;r<o&&"ET"===e[r];)r++;s=r<o&&"EN"===e[r]?"EN":"N";break;case"NSM":if(c&&!l){for(o=e.length,r=n+1;r<o&&"NSM"===e[r];)r++;if(r<o){var a=t[n],h=e[r];if((1425<=a&&a<=2303||64286===a)&&("R"===h||"AL"===h)){s="R";break}}}s=n<1||"B"===(h=e[n-1])?"N":i[n-1];break;case"B":d=!(y=!1),s=b;break;case"S":p=!0,s="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":y=!1;break;case"BN":s="N"}return s},C=function(t,e,i){var n,r,o,s,a=-1,h=t.length,c=0,l=[],u=b?m:g,f=[];for(p=d=y=!1,n=0;n<h;n++)f[n]=_(t[n]);for(r=0;r<h;r++){if(s=c,l[r]=S(t,f,l,r),s=240&(c=u[s][v[l[r]]]),c&=15,e[r]=o=u[c][5],0<s)if(16==s){for(n=a;n<r;n++)e[n]=1;a=-1}else a=-1;if(u[c][6])-1===a&&(a=r);else if(-1<a){for(n=a;n<r;n++)e[n]=o;a=-1}"B"===f[r]&&(e[r]=0),i.hiLevel|=o}p&&function(t,e,i){for(var n=0;n<i;n++)if("S"===t[n]){e[n]=b;for(var r=n-1;0<=r&&"WS"===t[r];r--)e[r]=b}}(f,e,h)},A=function(t,e,i,n,r){if(!(r.hiLevel<t)){if(1===t&&1===b&&!d)return e.reverse(),void(i&&i.reverse());for(var o,s,a,h,c=e.length,l=0;l<c;){if(n[l]>=t){for(a=l+1;a<c&&n[a]>=t;)a++;for(h=l,s=a-1;h<s;h++,s--)o=e[h],e[h]=e[s],e[s]=o,i&&(o=i[h],i[h]=i[s],i[s]=o);l=a}l++}}};return this.__bidiEngine__.doBidiReorder=function(t,e,i){var n;return function(t,e){if(e)for(var i=0;i<t.length;i++)e[i]=i;void 0===l&&(l=f(t)),void 0===o&&(o=f(t))}(t,e),c||!r||o?c&&r&&l^o?(b=l?1:0,t=w(t,e,i)):!c&&r&&o?(b=l?1:0,t=x(t,e,i),t=w(t,e)):!c||l||r||o?c&&!r&&l^o?(t=w(t,e),t=l?(b=0,x(t,e,i)):(b=1,t=x(t,e,i),w(t,e))):c&&l&&!r&&o?(b=1,t=x(t,e,i),t=w(t,e)):!c&&!r&&l^o&&(n=s,l?(b=1,t=x(t,e,i),b=0,s=!1,t=x(t,e,i),s=n):(b=0,t=x(t,e,i),t=w(t,e),s=!(b=1),t=x(t,e,i),s=n,t=w(t,e))):(b=0,t=x(t,e,i)):(b=l?1:0,t=x(t,e,i)),t},this.__bidiEngine__.setOptions=function(t){t&&(c=t.isInputVisual,r=t.isOutputVisual,l=t.isInputRtl,o=t.isOutputRtl,s=t.isSymmetricSwapping)},this.__bidiEngine__.setOptions(t),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],o=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(t){var e=t.text,i=(t.x,t.y,t.options||{}),n=(t.mutex,i.lang,[]);if(i.isInputVisual="boolean"!=typeof i.isInputVisual||i.isInputVisual,o.setOptions(i),"[object Array]"===Object.prototype.toString.call(e)){for(var r=0,n=[],r=0;r<e.length;r+=1)"[object Array]"===Object.prototype.toString.call(e[r])?n.push([o.doBidiReorder(e[r][0]),e[r][1],e[r][2]]):n.push([o.doBidiReorder(e[r])]);t.text=n}else t.text=o.doBidiReorder(e);o.setOptions({isInputVisual:!0})}])}(wi),wi.API.TTFFont=(Me.open=function(t){return new Me(t)},Me.prototype.parse=function(){return this.directory=new Je(this.contents),this.head=new ni(this),this.name=new xi(this),this.cmap=new oi(this),this.toUnicode={},this.hhea=new si(this),this.maxp=new _i(this),this.hmtx=new Si(this),this.post=new hi(this),this.os2=new ai(this),this.loca=new Pi(this),this.glyf=new Ai(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},Me.prototype.registerTTF=function(){var r,t,e;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){for(var t,e=[],i=0,n=(t=this.bbox).length;i<n;i++)r=t[i],e.push(Math.round(r*this.scaleFactor));return e}.call(this),this.stemV=0,this.post.exists?(e=255&(t=this.post.italic_angle),0!=(32768&(t=t>>16))&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+e)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(e=this.familyClass)||2===e||3===e||4===e||5===e||7===e,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},Me.prototype.characterToGlyph=function(t){var e;return(null!=(e=this.cmap.unicode)?e.codeMap[t]:void 0)||0},Me.prototype.widthOfGlyph=function(t){var e=1e3/this.head.unitsPerEm;return this.hmtx.forGlyph(t).advance*e},Me.prototype.widthOfString=function(t,e,i){for(var n,r=0,o=0,s=(t=""+t).length;0<=s?o<s:s<o;o=0<=s?++o:--o)n=t.charCodeAt(o),r+=this.widthOfGlyph(this.characterToGlyph(n))+i*(1e3/e)||0;return r*(e/1e3)},Me.prototype.lineHeight=function(t,e){e=(e=null==e?!1:e)?this.lineGap:0;return(this.ascender+e-this.decender)/1e3*t},Me);var Ye,Ke=(Qe.prototype.readByte=function(){return this.data[this.pos++]},Qe.prototype.writeByte=function(t){return this.data[this.pos++]=t},Qe.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},Qe.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},Qe.prototype.readInt32=function(){var t;return 2147483648<=(t=this.readUInt32())?t-4294967296:t},Qe.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},Qe.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},Qe.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},Qe.prototype.readInt16=function(){var t;return 32768<=(t=this.readUInt16())?t-65536:t},Qe.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},Qe.prototype.readString=function(t){for(var e=[],i=0;0<=t?i<t:t<i;i=0<=t?++i:--i)e[i]=String.fromCharCode(this.readByte());return e.join("")},Qe.prototype.writeString=function(t){for(var e=[],i=0,n=t.length;0<=n?i<n:n<i;i=0<=n?++i:--i)e.push(this.writeByte(t.charCodeAt(i)));return e},Qe.prototype.readShort=function(){return this.readInt16()},Qe.prototype.writeShort=function(t){return this.writeInt16(t)},Qe.prototype.readLongLong=function(){var t=this.readByte(),e=this.readByte(),i=this.readByte(),n=this.readByte(),r=this.readByte(),o=this.readByte(),s=this.readByte(),a=this.readByte();return 128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^i)+4294967296*(255^n)+16777216*(255^r)+65536*(255^o)+256*(255^s)+(255^a)+1):72057594037927940*t+281474976710656*e+1099511627776*i+4294967296*n+16777216*r+65536*o+256*s+a},Qe.prototype.writeLongLong=function(t){var e=Math.floor(t/4294967296),t=4294967295&t;return this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},Qe.prototype.readInt=function(){return this.readInt32()},Qe.prototype.writeInt=function(t){return this.writeInt32(t)},Qe.prototype.read=function(t){for(var e=[],i=0;0<=t?i<t:t<i;i=0<=t?++i:--i)e.push(this.readByte());return e},Qe.prototype.write=function(t){for(var e,i=[],n=0,r=t.length;n<r;n++)e=t[n],i.push(this.writeByte(e));return i},Qe),Je=(Ze.prototype.encode=function(t){var e,i,n,r,o,s,a=Object.keys(t).length,h=Math.log(2),c=16*Math.floor(Math.log(a)/h),l=Math.floor(c/h),h=16*a-c;for(s in(e=new Ke).writeInt(this.scalarType),e.writeShort(a),e.writeShort(c),e.writeShort(l),e.writeShort(h),n=e.pos+16*a,i=null,o=[],t)for(r=t[s],e.writeString(s),e.writeInt(Ye(r)),e.writeInt(n),e.writeInt(r.length),o=o.concat(r),"head"===s&&(i=n),n+=r.length;n%4;)o.push(0),n++;return e.write(o),a=2981146554-Ye(e.data),e.pos=i+8,e.writeUInt32(a),e.data},Ye=function(t){var e,i,n,r;for(t=Ci.call(t);t.length%4;)t.push(0);for(n=new Ke(t),e=i=0,r=t.length;e<r;e+=4)i+=n.readUInt32();return 4294967295&i},Ze),$e={}.hasOwnProperty,i=function(t,e){for(var i in e)$e.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};function Ze(t){var e,i,n;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},i=0,n=this.tableCount;0<=n?i<n:n<i;i=0<=n?++i:--i)e={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[e.tag]=e}function Qe(t){this.data=null!=t?t:[],this.pos=0,this.length=this.data.length}function ti(t){this.file=t,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}ti.prototype.parse=function(){},ti.prototype.encode=function(){},ti.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null};function ei(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID}var ii,ni=(i(Wi,e=ti),Wi.prototype.tag="head",Wi.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},Wi.prototype.encode=function(t){var e;return(e=new Ke).writeInt(this.version),e.writeInt(this.revision),e.writeInt(this.checkSumAdjustment),e.writeInt(this.magicNumber),e.writeShort(this.flags),e.writeShort(this.unitsPerEm),e.writeLongLong(this.created),e.writeLongLong(this.modified),e.writeShort(this.xMin),e.writeShort(this.yMin),e.writeShort(this.xMax),e.writeShort(this.yMax),e.writeShort(this.macStyle),e.writeShort(this.lowestRecPPEM),e.writeShort(this.fontDirectionHint),e.writeShort(t),e.writeShort(this.glyphDataFormat),e.data},Wi),ri=(Ui.encode=function(t,e){var i,n,r,o,s,a,h,c,l,u,f,d,p,g,m,v,y,b,w,x,_,S,C,A,L,T,P,k,O,N,j,F,E,I,D,M,B,R,z,q,U,W,H,V,X=new Ke,G=Object.keys(t).sort(function(t,e){return t-e});switch(e){case"macroman":for(d=0,p=function(){var t=[];for(f=0;f<256;++f)t.push(0);return t}(),m={0:0},r={},P=0,j=G.length;P<j;P++)null==m[U=t[n=G[P]]]&&(m[U]=++d),r[n]={old:t[n],new:m[t[n]]},p[n]=m[t[n]];return X.writeUInt16(1),X.writeUInt16(0),X.writeUInt32(12),X.writeUInt16(0),X.writeUInt16(262),X.writeUInt16(0),X.write(p),{charMap:r,subtable:X.data,maxGlyphID:d+1};case"unicode":for(L=[],c=[],m={},i={},g=a=null,k=v=0,F=G.length;k<F;k++)null==m[b=t[n=G[k]]]&&(m[b]=++v),i[n]={old:b,new:m[b]},o=m[b]-n,null!=g&&o===a||(g&&c.push(g),L.push(n),a=o),g=n;for(g&&c.push(g),c.push(65535),L.push(65535),C=2*(S=L.length),_=2*Math.pow(Math.log(S)/Math.LN2,2),l=Math.log(_/2)/Math.LN2,x=2*S-_,s=[],w=[],u=[],f=O=0,E=L.length;O<E;f=++O){if(A=L[f],h=c[f],65535===A){s.push(0),w.push(0);break}if(32768<=A-(T=i[A].new))for(s.push(0),w.push(2*(u.length+S-f)),n=N=A;A<=h?N<=h:h<=N;n=A<=h?++N:--N)u.push(i[n].new);else s.push(T-A),w.push(0)}for(X.writeUInt16(3),X.writeUInt16(1),X.writeUInt32(12),X.writeUInt16(4),X.writeUInt16(16+8*S+2*u.length),X.writeUInt16(0),X.writeUInt16(C),X.writeUInt16(_),X.writeUInt16(l),X.writeUInt16(x),z=0,I=c.length;z<I;z++)n=c[z],X.writeUInt16(n);for(X.writeUInt16(0),q=0,D=L.length;q<D;q++)n=L[q],X.writeUInt16(n);for(W=0,M=s.length;W<M;W++)o=s[W],X.writeUInt16(o);for(H=0,B=w.length;H<B;H++)y=w[H],X.writeUInt16(y);for(V=0,R=u.length;V<R;V++)d=u[V],X.writeUInt16(d);return{charMap:i,subtable:X.data,maxGlyphID:v+1}}},Ui),oi=(i(qi,e),qi.prototype.tag="cmap",qi.prototype.parse=function(t){var e,i,n;for(t.pos=this.offset,this.version=t.readUInt16(),n=t.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=n?i<n:n<i;i=0<=n?++i:--i)e=new ri(t,this.offset),this.tables.push(e),e.isUnicode&&null==this.unicode&&(this.unicode=e);return!0},qi.encode=function(t,e){t=ri.encode(t,e=null==e?"macroman":e);return(e=new Ke).writeUInt16(0),e.writeUInt16(1),t.table=e.data.concat(t.subtable),t},qi),si=(i(zi,e),zi.prototype.tag="hhea",zi.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},zi),ai=(i(Ri,e),Ri.prototype.tag="OS/2",Ri.prototype.parse=function(i){if(i.pos=this.offset,this.version=i.readUInt16(),this.averageCharWidth=i.readShort(),this.weightClass=i.readUInt16(),this.widthClass=i.readUInt16(),this.type=i.readShort(),this.ySubscriptXSize=i.readShort(),this.ySubscriptYSize=i.readShort(),this.ySubscriptXOffset=i.readShort(),this.ySubscriptYOffset=i.readShort(),this.ySuperscriptXSize=i.readShort(),this.ySuperscriptYSize=i.readShort(),this.ySuperscriptXOffset=i.readShort(),this.ySuperscriptYOffset=i.readShort(),this.yStrikeoutSize=i.readShort(),this.yStrikeoutPosition=i.readShort(),this.familyClass=i.readShort(),this.panose=function(){for(var t=[],e=0;e<10;++e)t.push(i.readByte());return t}(),this.charRange=function(){for(var t=[],e=0;e<4;++e)t.push(i.readInt());return t}(),this.vendorID=i.readString(4),this.selection=i.readShort(),this.firstCharIndex=i.readShort(),this.lastCharIndex=i.readShort(),0<this.version&&(this.ascent=i.readShort(),this.descent=i.readShort(),this.lineGap=i.readShort(),this.winAscent=i.readShort(),this.winDescent=i.readShort(),this.codePageRange=function(){for(var t=[],e=0;e<2;e=++e)t.push(i.readInt());return t}(),1<this.version))return this.xHeight=i.readShort(),this.capHeight=i.readShort(),this.defaultChar=i.readShort(),this.breakChar=i.readShort(),this.maxContext=i.readShort()},Ri),hi=(i(Bi,e),Bi.prototype.tag="post",Bi.prototype.parse=function(n){var t,e;switch(n.pos=this.offset,this.format=n.readInt(),this.italicAngle=n.readInt(),this.underlinePosition=n.readShort(),this.underlineThickness=n.readShort(),this.isFixedPitch=n.readInt(),this.minMemType42=n.readInt(),this.maxMemType42=n.readInt(),this.minMemType1=n.readInt(),this.maxMemType1=n.readInt(),this.format){case 65536:break;case 131072:var r,i=n.readUInt16();for(this.glyphNameIndex=[],r=0;0<=i?r<i:i<r;r=0<=i?++r:--r)this.glyphNameIndex.push(n.readUInt16());for(this.names=[],e=[];n.pos<this.offset+this.length;)t=n.readByte(),e.push(this.names.push(n.readString(t)));return e;case 151552:return i=n.readUInt16(),this.offsets=n.read(i);case 196608:break;case 262144:return this.map=function(){var t,e,i=[];for(r=t=0,e=this.file.maxp.numGlyphs;0<=e?t<e:e<t;r=0<=e?++t:--t)i.push(n.readUInt32());return i}.call(this)}},Bi),xi=(i(Mi,e),Mi.prototype.tag="name",Mi.prototype.parse=function(t){var e,i,n,r,o,s,a,h,c,l;for(t.pos=this.offset,t.readShort(),e=t.readShort(),s=t.readShort(),i=[],r=0;0<=e?r<e:e<r;r=0<=e?++r:--r)i.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+s+t.readShort()});for(a={},r=h=0,c=i.length;h<c;r=++h)n=i[r],t.pos=n.offset,l=t.readString(n.length),o=new ei(l,n),null==a[l=n.nameID]&&(a[l]=[]),a[n.nameID].push(o);this.strings=a,this.copyright=a[0],this.fontFamily=a[1],this.fontSubfamily=a[2],this.uniqueSubfamily=a[3],this.fontName=a[4],this.version=a[5];try{this.postscriptName=a[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(t){this.postscriptName=a[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=a[7],this.manufacturer=a[8],this.designer=a[9],this.description=a[10],this.vendorUrl=a[11],this.designerUrl=a[12],this.license=a[13],this.licenseUrl=a[14],this.preferredFamily=a[15],this.preferredSubfamily=a[17],this.compatibleFull=a[18],this.sampleText=a[19]},Mi),_i=(i(Di,e),Di.prototype.tag="maxp",Di.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},Di),Si=(i(Ii,e),Ii.prototype.tag="hmtx",Ii.prototype.parse=function(i){var n,t,r,o,e,s,a;for(i.pos=this.offset,this.metrics=[],n=0,s=this.file.hhea.numberOfMetrics;0<=s?n<s:s<n;n=0<=s?++n:--n)this.metrics.push({advance:i.readUInt16(),lsb:i.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var t,e=[];for(n=t=0;0<=r?t<r:r<t;n=0<=r?++t:--t)e.push(i.readInt16());return e}(),this.widths=function(){for(var t,e=[],i=0,n=(t=this.metrics).length;i<n;i++)o=t[i],e.push(o.advance);return e}.call(this),t=this.widths[this.widths.length-1],a=[],n=e=0;0<=r?e<r:r<e;n=0<=r?++e:--e)a.push(this.widths.push(t));return a},Ii.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},Ii),Ci=[].slice,Ai=(i(Ei,e),Ei.prototype.tag="glyf",Ei.prototype.parse=function(){return this.cache={}},Ei.prototype.glyphFor=function(t){var e,i,n,r,o,s;return t in this.cache?this.cache[t]:(r=this.file.loca,n=this.file.contents,s=r.indexOf(t),0===(o=r.lengthOf(t))?this.cache[t]=null:(n.pos=this.offset+s,e=(i=new Ke(n.read(o))).readShort(),r=i.readShort(),s=i.readShort(),n=i.readShort(),o=i.readShort(),this.cache[t]=-1===e?new Ti(i,r,s,n,o):new Li(i,e,r,s,n,o),this.cache[t]))},Ei.prototype.encode=function(t,e,i){for(var n,r=[],o=[],s=0,a=e.length;s<a;s++)n=t[e[s]],o.push(r.length),n&&(r=r.concat(n.encode(i)));return o.push(r.length),{table:r,offsets:o}},Ei),Li=(Fi.prototype.encode=function(){return this.raw.data},Fi),Ti=(ji.prototype.encode=function(){for(var t=new Ke(Ci.call(this.raw.data)),e=0,i=this.glyphIDs.length;e<i;++e)t.pos=this.glyphOffsets[e];return t.data},ji),Pi=(i(Ni,e),Ni.prototype.tag="loca",Ni.prototype.parse=function(i){var t,n;return i.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=(0===t?function(){var t,e=[];for(n=0,t=this.length;n<t;n+=2)e.push(2*i.readUInt16());return e}:function(){var t,e=[];for(n=0,t=this.length;n<t;n+=4)e.push(i.readUInt32());return e}).call(this)},Ni.prototype.indexOf=function(t){return this.offsets[t]},Ni.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},Ni.prototype.encode=function(t,e){for(var i,n=new Uint32Array(this.offsets.length),r=0,o=0,s=0;s<n.length;++s)n[s]=r,o<e.length&&e[o]==s&&(++o,n[s]=r,i=this.offsets[s],0<(i=this.offsets[s+1]-i)&&(r+=i));for(var a=new Array(4*n.length),h=0;h<n.length;++h)a[4*h+3]=255&n[h],a[4*h+2]=(65280&n[h])>>8,a[4*h+1]=(16711680&n[h])>>16,a[4*h]=(4278190080&n[h])>>24;return a},Ni),ki=(Oi.prototype.generateCmap=function(){var t,e,i,n=this.font.cmap.tables[0].codeMap,r={};for(t in i=this.subset)e=i[t],r[t]=n[e];return r},Oi.prototype.glyphsFor=function(t){for(var e,i,n,r,o={},s=0,a=t.length;s<a;s++)o[n=t[s]]=this.font.glyf.glyphFor(n);for(n in e=[],o)null!=(i=o[n])&&i.compound&&e.push.apply(e,i.glyphIDs);if(0<e.length)for(n in r=this.glyphsFor(e))i=r[n],o[n]=i;return o},Oi.prototype.encode=function(t,e){var i,n,r,o,s,a,h,c,l=oi.encode(this.generateCmap(),"unicode"),t=this.glyphsFor(t),u={0:0};for(i in c=l.charMap)u[(r=c[i]).old]=r.new;for(h in a=l.maxGlyphID,t)h in u||(u[h]=a++);return o=function(t){var e,i={};for(e in t)i[t[e]]=e;return i}(u),s=Object.keys(o).sort(function(t,e){return t-e}),l=function(){for(var t=[],e=0,i=s.length;e<i;e++)n=s[e],t.push(o[n]);return t}(),t=this.font.glyf.encode(t,l,u),l=this.font.loca.encode(t.offsets,l),e={cmap:this.font.cmap.raw(),glyf:t.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(e["OS/2"]=this.font.os2.raw()),this.font.directory.encode(e)},Oi);function Oi(t){this.font=t,this.subset={},this.unicodes={},this.next=33}function Ni(){return Ni.__super__.constructor.apply(this,arguments)}function ji(t,e,i,n,r){var o,s;for(this.raw=t,this.xMin=e,this.yMin=i,this.xMax=n,this.yMax=r,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;s=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&s;)o.pos+=1&s?4:2,128&s?o.pos+=8:64&s?o.pos+=4:8&s&&(o.pos+=2)}function Fi(t,e,i,n,r,o){this.raw=t,this.numberOfContours=e,this.xMin=i,this.yMin=n,this.xMax=r,this.yMax=o,this.compound=!1}function Ei(){return Ei.__super__.constructor.apply(this,arguments)}function Ii(){return Ii.__super__.constructor.apply(this,arguments)}function Di(){return Di.__super__.constructor.apply(this,arguments)}function Mi(){return Mi.__super__.constructor.apply(this,arguments)}function Bi(){return Bi.__super__.constructor.apply(this,arguments)}function Ri(){return Ri.__super__.constructor.apply(this,arguments)}function zi(){return zi.__super__.constructor.apply(this,arguments)}function qi(){return qi.__super__.constructor.apply(this,arguments)}function Ui(i,t){var e,n,r,o,s,a,h,c,l,u,f,d,p,g,m,v;switch(this.platformID=i.readUInt16(),this.encodingID=i.readShort(),this.offset=t+i.readInt(),t=i.pos,i.pos=this.offset,this.format=i.readUInt16(),this.length=i.readUInt16(),this.language=i.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(a=0;a<256;++a)this.codeMap[a]=i.readByte();break;case 4:for(u=i.readUInt16(),l=u/2,i.pos+=6,r=function(){var t,e=[];for(a=t=0;0<=l?t<l:l<t;a=0<=l?++t:--t)e.push(i.readUInt16());return e}(),i.pos+=2,d=function(){var t,e=[];for(a=t=0;0<=l?t<l:l<t;a=0<=l?++t:--t)e.push(i.readUInt16());return e}(),h=function(){var t,e=[];for(a=t=0;0<=l?t<l:l<t;a=0<=l?++t:--t)e.push(i.readUInt16());return e}(),c=function(){var t,e=[];for(a=t=0;0<=l?t<l:l<t;a=0<=l?++t:--t)e.push(i.readUInt16());return e}(),n=(this.length-i.pos+this.offset)/2,s=function(){var t,e=[];for(a=t=0;0<=n?t<n:n<t;a=0<=n?++t:--t)e.push(i.readUInt16());return e}(),a=g=0,v=r.length;g<v;a=++g)for(p=r[a],e=m=f=d[a];f<=p?m<=p:p<=m;e=f<=p?++m:--m)0===c[a]?o=e+h[a]:0!==(o=s[c[a]/2+(e-f)-(l-a)]||0)&&(o+=h[a]),this.codeMap[e]=65535&o}i.pos=t}function Wi(){return Wi.__super__.constructor.apply(this,arguments)}function Hi(){}wi.API.PDFObject=(ii=function(t,e){return(Array(e+1).join("0")+t).slice(-e)},Hi.convert=function(n){var r,t,e,i;if(Array.isArray(n))return"["+function(){for(var t=[],e=0,i=n.length;e<i;e++)r=n[e],t.push(Hi.convert(r));return t}().join(" ")+"]";if("string"==typeof n)return"/"+n;if(null!=n&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+ii(n.getUTCFullYear(),4)+ii(n.getUTCMonth(),2)+ii(n.getUTCDate(),2)+ii(n.getUTCHours(),2)+ii(n.getUTCMinutes(),2)+ii(n.getUTCSeconds(),2)+"Z)";if("[object Object]"!=={}.toString.call(n))return""+n;for(t in e=["<<"],n)i=n[t],e.push("/"+t+" "+Hi.convert(i));return e.push(">>"),e.join("\n")},Hi);const Vi=wi},722:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.color="#535353",this.map=t,this.mapResize=this.mapResize.bind(this)}create(){this.updateValues(),void 0!==this.map?(this.map.on("resize",this.mapResize),this.createCanvas(this.map.getCanvasContainer())):console.error("map object is null")}updateValues(){var t;this.width=null===(t=this.map)||void 0===t?void 0:t.getCanvas().clientWidth,this.height=null===(t=this.map)||void 0===t?void 0:t.getCanvas().clientHeight}mapResize(){this.updateValues(),this.updateCanvas()}updateCanvas(){var t,e;void 0!==this.svgCanvas&&void 0!==this.yLine&&void 0!==this.xLine&&void 0!==this.width&&void 0!==this.height?(this.svgCanvas.setAttribute("width",`${this.width}px`),this.svgCanvas.setAttribute("height",`${this.height}px`),t=this.width/2,e=this.height/2,this.yLine.setAttribute("x1",`${t}px`),this.yLine.setAttribute("y1","0px"),this.yLine.setAttribute("x2",`${t}px`),this.yLine.setAttribute("y2",`${this.height}px`),this.xLine.setAttribute("x1","0px"),this.xLine.setAttribute("y1",`${e}px`),this.xLine.setAttribute("x2",`${this.width}px`),this.xLine.setAttribute("y2",`${e}px`)):console.error("element value is null")}createCanvas(t){if(void 0!==this.width&&void 0!==this.height){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.style.position="relative",n.setAttribute("width",`${this.width}px`),n.setAttribute("height",`${this.height}px`);var e=this.width/2,i=this.height/2;this.yLine=n.appendChild(this.createLine(e,0,e,this.height,this.color,"2px")),this.xLine=n.appendChild(this.createLine(0,i,this.width,i,this.color,"2px")),null==t||t.appendChild(n),this.svgCanvas=n}}createLine(t,e,i,n,r,o){const s=document.createElementNS("http://www.w3.org/2000/svg","line");return s.setAttribute("x1",t),s.setAttribute("y1",e),s.setAttribute("x2",i),s.setAttribute("y2",n),s.setAttribute("stroke-dasharray","5,5"),s.setAttribute("stroke",r),s.setAttribute("stroke-width",o),s}destroy(){void 0!==this.xLine&&(this.xLine.remove(),this.xLine=void 0),void 0!==this.yLine&&(this.yLine.remove(),this.yLine=void 0),void 0!==this.svgCanvas&&(this.svgCanvas.remove(),this.svgCanvas=void 0),void 0!==this.map&&(this.map.off("resize",this.mapResize),this.map=void 0)}}},2337:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(722),r=i(8098),o=i(7476),s=i(3927);e.default=class{constructor(t){this.options={PageSize:s.Size.A4,PageOrientation:s.PageOrientation.Landscape,Format:s.Format.PDF,DPI:s.DPI[300],Crosshair:!1,PrintableArea:!1,accessToken:void 0},t&&(this.options=Object.assign(this.options,t)),this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}getTranslation(){switch(this.options.Local){case"en":return o.english;case"fr":return o.french;default:return o.english}}onAdd(o){this.map=o,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("mapboxgl-ctrl"),this.controlContainer.classList.add("mapboxgl-ctrl-group"),this.exportContainer=document.createElement("div"),this.exportContainer.classList.add("mapboxgl-export-list"),this.exportButton=document.createElement("button"),this.exportButton.classList.add("mapboxgl-ctrl-icon"),this.exportButton.classList.add("mapboxgl-export-control"),this.exportButton.type="button",this.exportButton.addEventListener("click",()=>{this.exportButton.style.display="none",this.exportContainer.style.display="block",this.toggleCrosshair(!0),this.togglePrintableArea(!0)}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.exportButton),this.controlContainer.appendChild(this.exportContainer);const t=document.createElement("TABLE");t.className="print-table";var e=this.createSelection(s.Size,this.getTranslation().PageSize,"page-size",this.options.PageSize,(t,e)=>JSON.stringify(t[e]));t.appendChild(e);e=this.createSelection(s.PageOrientation,this.getTranslation().PageOrientation,"page-orientaiton",this.options.PageOrientation,(t,e)=>t[e]);t.appendChild(e);e=this.createSelection(s.Format,this.getTranslation().Format,"format-type",this.options.Format,(t,e)=>t[e]);t.appendChild(e);e=this.createSelection(s.DPI,this.getTranslation().DPI,"dpi-type",this.options.DPI,(t,e)=>t[e]);t.appendChild(e),this.exportContainer.appendChild(t);const i=document.createElement("button");return i.type="button",i.textContent="Generate",i.classList.add("generate-button"),i.addEventListener("click",()=>{var t=document.getElementById("mapbox-gl-export-page-size"),e=document.getElementById("mapbox-gl-export-page-orientaiton"),i=document.getElementById("mapbox-gl-export-format-type"),n=document.getElementById("mapbox-gl-export-dpi-type"),e=e.value;let r=JSON.parse(t.value);e===s.PageOrientation.Portrait&&(r=r.reverse()),new s.default(o,r,Number(n.value),i.value,s.Unit.mm,this.options.accessToken).generate()}),this.exportContainer.appendChild(i),this.controlContainer}createSelection(i,t,n,r,o){const e=document.createElement("label");e.textContent=t;const s=document.createElement("select");s.setAttribute("id",`mapbox-gl-export-${n}`),s.style.width="100%",Object.keys(i).forEach(t=>{const e=document.createElement("option");e.setAttribute("value",o(i,t)),e.appendChild(document.createTextNode(t)),e.setAttribute("name",n),r===i[t]&&(e.selected=!0),s.appendChild(e)}),s.addEventListener("change",()=>{this.updatePrintableArea()});const a=document.createElement("TR"),h=document.createElement("TD"),c=document.createElement("TD");return h.appendChild(e),c.appendChild(s),a.appendChild(h),a.appendChild(c),a}onRemove(){this.controlContainer&&this.controlContainer.parentNode&&this.map&&this.exportButton&&(this.exportButton.removeEventListener("click",this.onDocumentClick),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),void 0!==this.crosshair&&(this.crosshair.destroy(),this.crosshair=void 0),this.map=void 0)}onDocumentClick(t){this.controlContainer&&!this.controlContainer.contains(t.target)&&this.exportContainer&&this.exportButton&&(this.exportContainer.style.display="none",this.exportButton.style.display="block",this.toggleCrosshair(!1),this.togglePrintableArea(!1))}toggleCrosshair(t){!0===this.options.Crosshair&&(!1===t?void 0!==this.crosshair&&(this.crosshair.destroy(),this.crosshair=void 0):(this.crosshair=new n.default(this.map),this.crosshair.create()))}togglePrintableArea(t){!0===this.options.PrintableArea&&(!1===t?void 0!==this.printableArea&&(this.printableArea.destroy(),this.printableArea=void 0):(this.printableArea=new r.default(this.map),this.updatePrintableArea()))}updatePrintableArea(){if(void 0!==this.printableArea){var e=document.getElementById("mapbox-gl-export-page-size"),i=document.getElementById("mapbox-gl-export-page-orientaiton").value;let t=JSON.parse(e.value);i===s.PageOrientation.Portrait&&(t=t.reverse()),this.printableArea.updateArea(t[0],t[1])}}}},8261:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={PageSize:"Page Size",PageOrientation:"Page Orientation",Format:"Format",DPI:"DPI",Generate:"Generate"}},3722:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={PageSize:"Taille de page",PageOrientation:"Orientation de la page",Format:"Format",DPI:"DPI",Generate:"Générer"}},7476:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.french=e.english=void 0;var n=i(8261);e.english=n.default;i=i(3722);e.french=i.default},3927:(t,a,e)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.DPI=a.PageOrientation=a.Size=a.Unit=a.Format=void 0;const s=e(1168),i=e(3162),h=e(9507);e(4245);const c=e(2777);a.Format={JPEG:"jpg",PNG:"png",PDF:"pdf",SVG:"svg"},a.Unit={in:"in",mm:"mm"},a.Size={A2:[594,420],A3:[420,297],A4:[297,210],A5:[210,148],A6:[148,105],B2:[707,500],B3:[500,353],B4:[353,250],B5:[250,176],B6:[176,125]},a.PageOrientation={Landscape:"landscape",Portrait:"portrait"},a.DPI={72:72,96:96,200:200,300:300,400:400},a.default=class{constructor(t,e=a.Size.A4,i=300,n=a.Format.PNG.toString(),r=a.Unit.mm,o){this.map=t,this.width=e[0],this.height=e[1],this.dpi=i,this.format=n,this.unit=r,this.accesstoken=o}generate(){const n=this;JsLoadingOverlay.show({overlayBackgroundColor:"#5D5959",overlayOpacity:"0.6",spinnerIcon:"ball-spin",spinnerColor:"#2400FD",spinnerSize:"2x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetX:0,offsetY:0,containerID:null,lockScroll:!1,overlayZIndex:9998,spinnerZIndex:9999});const r=window.devicePixelRatio;Object.defineProperty(window,"devicePixelRatio",{get:()=>n.dpi/96});const o=document.createElement("div");o.className="hidden-map",document.body.appendChild(o);const t=document.createElement("div");t.style.width=this.toPixels(this.width),t.style.height=this.toPixels(this.height),o.appendChild(t);const s=new h.Map({accessToken:this.accesstoken||h.accessToken,container:t,center:this.map.getCenter(),zoom:this.map.getZoom(),bearing:this.map.getBearing(),pitch:this.map.getPitch(),interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,attributionControl:!1,transformRequest:this.map._requestManager._transformRequestFn}),e=this.map.getStyle();if(e&&e.sources){const n=e.sources;Object.keys(n).forEach(t=>{const e=n[t];Object.keys(e).forEach(t=>{e[t]||delete e[t]})})}s.setStyle(e),s.once("idle",()=>{var t,e=s.getCanvas(),i=`map.${n.format}`;switch(n.format){case a.Format.PNG:n.toPNG(e,i);break;case a.Format.JPEG:n.toJPEG(e,i);break;case a.Format.PDF:n.toPDF(s,i);break;case a.Format.SVG:n.toSVG(e,i);break;default:console.error(`Invalid file format: ${n.format}`)}s.remove(),null===(t=o.parentNode)||void 0===t||t.removeChild(o),Object.defineProperty(window,"devicePixelRatio",{get:()=>r}),JsLoadingOverlay.hide()})}toPNG(t,e){t.toBlob(t=>{i.saveAs(t,e)})}toJPEG(t,e){const i=t.toDataURL("image/jpeg",.85),n=document.createElement("a");n.href=i,n.download=e,n.click(),n.remove()}toPDF(t,e){const i=t.getCanvas(),n=new s.jsPDF({orientation:this.width>this.height?"l":"p",unit:this.unit,compress:!0});n.addImage(i.toDataURL("image/png"),"png",0,0,this.width,this.height,void 0,"FAST");var{lng:r,lat:o}=t.getCenter();n.setProperties({title:t.getStyle().name,subject:`center: [${r}, ${o}], zoom: ${t.getZoom()}`,creator:"Mapbox GL Export Plugin",author:"(c)Mapbox, (c)OpenStreetMap"}),n.save(e)}toSVG(t,s){t=t.toDataURL("image/png");c.fabric.Image.fromURL(t,t=>{const e=new c.fabric.Canvas("canvas"),i=Number(this.toPixels(this.width,this.dpi).replace("px","")),n=Number(this.toPixels(this.height,this.dpi).replace("px",""));t.scaleToWidth(i),t.scaleToHeight(n),e.add(t);const r=e.toSVG({x:0,y:0,width:i,height:n,viewBox:{x:0,y:0,width:i,height:n}}),o=document.createElement("a");o.href=`data:application/xml,${encodeURIComponent(r)}`,o.download=s,o.click(),o.remove()})}toPixels(t,e=96){return this.unit===a.Unit.mm&&(e/=25.4),e*t+"px"}}},8098:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(3927);e.default=class{constructor(t){if(this.map=t,void 0!==this.map){this.mapResize=this.mapResize.bind(this),this.map.on("resize",this.mapResize);const e=null===(t=this.map)||void 0===t?void 0:t.getCanvas().clientWidth,i=null===(t=this.map)||void 0===t?void 0:t.getCanvas().clientHeight,n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.setAttribute("width",`${e}px`),n.setAttribute("height",`${i}px`);const r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("style","fill:#888888;stroke-width:0"),r.setAttribute("fill-opacity","0.5"),n.append(r),null===(t=this.map)||void 0===t||t.getCanvasContainer().appendChild(n),this.svgCanvas=n,this.svgPath=r}}mapResize(){this.generateCutOut()}updateArea(t,e){this.width=t,this.height=e,this.unit=n.Unit.mm,this.generateCutOut()}generateCutOut(){var t,e,i,n,r,o;void 0!==this.map&&void 0!==this.svgCanvas&&void 0!==this.svgPath&&(e=this.toPixels(this.width),o=this.toPixels(this.height),n=(i=(t=null===(r=this.map)||void 0===r?void 0:r.getCanvas().clientWidth)/2-e/2)+e,o=(r=(e=null===(r=this.map)||void 0===r?void 0:r.getCanvas().clientHeight)/2-o/2)+o,this.svgCanvas.setAttribute("width",`${t}px`),this.svgCanvas.setAttribute("height",`${e}px`),this.svgPath.setAttribute("d",`M 0 0 L ${t} 0 L ${t} ${e} L 0 ${e} M ${i} ${r} L ${i} ${o} L ${n} ${o} L ${n} ${r}`))}destroy(){void 0!==this.svgCanvas&&(this.svgCanvas.remove(),this.svgCanvas=void 0),void 0!==this.map&&(this.map=void 0)}toPixels(t,e=96){return this.unit===n.Unit.mm&&(e/=25.4),e*t}}},9507:t=>{"use strict";t.exports=e},4960:()=>{},6759:()=>{},6272:()=>{}},n={};function f(t){var e=n[t];if(void 0!==e)return e.exports;e=n[t]={exports:{}};return i[t].call(e.exports,e,e.exports,f),e.exports}f.m=i,f.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return f.d(e,{a:e}),e},s=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,f.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var i=Object.create(null);f.r(i);var n={};o=o||[null,s({}),s([]),s(s)];for(var r=2&t&&e;"object"==typeof r&&!~o.indexOf(r);r=s(r))Object.getOwnPropertyNames(r).forEach(t=>n[t]=()=>e[t]);return n.default=()=>e,f.d(i,n),i},f.d=(t,e)=>{for(var i in e)f.o(e,i)&&!f.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},f.f={},f.e=i=>Promise.all(Object.keys(f.f).reduce((t,e)=>(f.f[e](i,t),t),[])),f.u=t=>t+".mapbox-gl-export.js",f.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),f.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),l={},u="watergis:",f.l=(n,t,e,i)=>{if(l[n])l[n].push(t);else{var r,o;if(void 0!==e)for(var s=document.getElementsByTagName("script"),a=0;a<s.length;a++){var h=s[a];if(h.getAttribute("src")==n||h.getAttribute("data-webpack")==u+e){r=h;break}}r||(o=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,f.nc&&r.setAttribute("nonce",f.nc),r.setAttribute("data-webpack",u+e),r.src=n),l[n]=[t];var t=(t,e)=>{r.onerror=r.onload=null,clearTimeout(c);var i=l[n];if(delete l[n],r.parentNode&&r.parentNode.removeChild(r),i&&i.forEach(t=>t(e)),t)return t(e)},c=setTimeout(t.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=t.bind(null,r.onerror),r.onload=t.bind(null,r.onload),o&&document.head.appendChild(r)}},f.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;f.g.importScripts&&(t=f.g.location+"");var e=f.g.document;if(t||!e||(t=e.currentScript?e.currentScript.src:t)||(e=e.getElementsByTagName("script")).length&&(t=e[e.length-1].src),!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),f.p=t})(),(()=>{var h={179:0};f.f.j=(i,t)=>{var e,n,r=f.o(h,i)?h[i]:void 0;0!==r&&(r?t.push(r[2]):(e=new Promise((t,e)=>r=h[i]=[t,e]),t.push(r[2]=e),e=f.p+f.u(i),n=new Error,f.l(e,t=>{var e;f.o(h,i)&&(0!==(r=h[i])&&(h[i]=void 0),r)&&(e=t&&("load"===t.type?"missing":t.type),t=t&&t.target&&t.target.src,n.message="Loading chunk "+i+" failed.\n("+e+": "+t+")",n.name="ChunkLoadError",n.type=e,n.request=t,r[1](n))},"chunk-"+i,i)))};var t=(t,e)=>{var i,n,[r,o,s]=e,a=0;for(i in o)f.o(o,i)&&(f.m[i]=o[i]);for(s&&s(f),t&&t(e);a<r.length;a++)n=r[a],f.o(h,n)&&h[n]&&h[n][0](),h[r[a]]=0},e=self.webpackChunkwatergis=self.webpackChunkwatergis||[];e.forEach(t.bind(null,0)),e.push=t.bind(null,e.push.bind(e))})();var r={};return(()=>{"use strict";var t=r;Object.defineProperty(t,"__esModule",{value:!0}),t.DPI=t.Format=t.PageOrientation=t.Size=t.MapboxExportControl=void 0;var e=f(2337);Object.defineProperty(t,"MapboxExportControl",{enumerable:!0,get:function(){return e.default}});var i=f(3927);Object.defineProperty(t,"Size",{enumerable:!0,get:function(){return i.Size}}),Object.defineProperty(t,"PageOrientation",{enumerable:!0,get:function(){return i.PageOrientation}}),Object.defineProperty(t,"Format",{enumerable:!0,get:function(){return i.Format}}),Object.defineProperty(t,"DPI",{enumerable:!0,get:function(){return i.DPI}})})(),r})()});
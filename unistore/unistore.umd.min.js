!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.unistore=t()}(this,function(){function i(n,t){for(var e in t)n[e]=t[e];return n}return function(f){var o=[];function t(n){for(var t=[],e=0;e<o.length;e++)o[e]===n?n=null:t.push(o[e]);o=t}function e(n,t,e){f=t?n:i(i({},f),n);for(var u=o,r=0;r<u.length;r++)u[r](f,e)}return f=f||{},{action:function(r){function o(n){e(n,!1,r)}return function(){for(var n=arguments,t=[f],e=0;e<arguments.length;e++)t.push(n[e]);var u=r.apply(this,t);if(null!=u)return u.then?u.then(o):o(u)}},setState:e,subscribe:function(n){return o.push(n),function(){t(n)}},unsubscribe:t,getState:function(){return f}}}});
OpenLayers.Layer.HeatCanvas=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,heatmap:null,data:[],initialize:function(t,e,a,s){OpenLayers.Layer.prototype.initialize.apply(this,[t,a]),this.setMap(e),this.heatCanvasOptions=s,this.initHeatCanvas(this.map,this.heatCanvasOptions),e.events.register("moveend",this,this.redraw)},initHeatCanvas:function(t,e){e=e||{},this._step=e.step||1,this._degree=e.degree||HeatCanvas.LINEAR,this._opacity=e.opacity||.6,this._colorscheme=e.colorscheme||null;var a=document.createElement("div");a.style.cssText="position:absolute;top:0;left:0;border:0",a.style.width=this.map.size.w+"px",a.style.height=this.map.size.h+"px";var s=document.createElement("canvas");s.style.width=this.map.size.w+"px",s.style.height=this.map.size.h+"px",s.width=parseInt(s.style.width),s.height=parseInt(s.style.height),s.style.opacity=this._opacity,a.appendChild(s),this.heatmap=new HeatCanvas(s),this.div.appendChild(a),this._div=a},onMapResize:function(){var t=this.map.getSize();this.heatmap.resize(t.w,t.h)},pushData:function(t,e,a){this.data.push({lon:e,lat:t,v:a})},_resetCanvasPosition:function(){var t=this.map.getExtent(),e=new OpenLayers.LonLat(t.left,t.top),a=this.map.getLayerPxFromLonLat(e);this._div.style.top=a.y+"px",this._div.style.left=a.x+"px"},redraw:function(){if(this._resetCanvasPosition(),this.heatmap.clear(),this.data.length>0){for(var t=0,e=this.data.length;e>t;t++){var a=new OpenLayers.LonLat(this.data[t].lon,this.data[t].lat);a=a.transform(this.map.displayProjection,this.map.getProjectionObject());var s=this.map.getViewPortPxFromLonLat(a);this.heatmap.push(Math.floor(s.x),Math.floor(s.y),this.data[t].v)}this.heatmap.render(this._step,this._degree,this._colorscheme)}},afterAdd:function(){},CLASS_NAME:"OpenLayers.Layer.HeatCanvas"});
//# sourceMappingURL=heatcanvas-openlayers.min.js.map
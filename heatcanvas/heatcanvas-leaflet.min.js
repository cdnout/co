L.TileLayer.HeatCanvas=L.Class.extend({initialize:function(t,e){this.heatCanvasOptions=e,this.data=[],this._onRenderingStart=null,this._onRenderingEnd=null},onRenderingStart:function(t){this._onRenderingStart=t},onRenderingEnd:function(t){this._onRenderingEnd=t},onAdd:function(t){this.map=t,this._initHeatCanvas(this.map,this.heatCanvasOptions),t.on("viewreset",this._redraw,this),t.on("moveend",this._redraw,this),t.on("dragend",this._redraw,this),t.on("zoomend",this._redraw,this),this._redraw()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._div),t.off("viewreset",this._redraw,this),t.off("moveend",this._redraw,this),t.off("dragend",this._redraw,this),t.off("zoomend",this._redraw,this)},_initHeatCanvas:function(t,e){e=e||{},this._step=e.step||1,this._degree=e.degree||HeatCanvas.LINEAR,this._opacity=e.opacity||.6,this._colorscheme=e.colorscheme||null;var i=L.DomUtil.create("div","leaflet-heatmap-container");i.style.position="absolute",i.style.width=this.map.getSize().x+"px",i.style.height=this.map.getSize().y+"px";var a=document.createElement("canvas");a.style.width=this.map.getSize().x+"px",a.style.height=this.map.getSize().y+"px",a.width=parseInt(a.style.width),a.height=parseInt(a.style.height),a.style.opacity=this._opacity,i.appendChild(a),this.heatmap=new HeatCanvas(a),this.heatmap.onRenderingStart=this._onRenderingStart,this.heatmap.onRenderingEnd=this._onRenderingEnd,this._div=i,this.map.getPanes().overlayPane.appendChild(this._div)},pushData:function(t,e,i){this.data.push({lon:e,lat:t,v:i})},_resetCanvasPosition:function(){var t=this.map.getBounds(),e=this.map.latLngToLayerPoint(t.getNorthWest());L.DomUtil.setPosition(this._div,e)},_redraw:function(){if(this._resetCanvasPosition(),this.heatmap.clear(),this.data.length>0){for(var t=0,e=this.data.length;e>t;t++){var i=new L.LatLng(this.data[t].lat,this.data[t].lon),a=this.map.latLngToLayerPoint(i);a=this.map.layerPointToContainerPoint(a),this.heatmap.push(Math.floor(a.x),Math.floor(a.y),this.data[t].v)}this.heatmap.render(this._step,this._degree,this._colorscheme)}return this},clear:function(){this.heatmap.clear()},redraw:function(){this._redraw()}});
//# sourceMappingURL=heatcanvas-leaflet.min.js.map
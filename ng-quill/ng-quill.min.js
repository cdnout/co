!function(e,t){"function"==typeof define&&define.amd?define(["quill"],t):"undefined"!=typeof module&&"object"==typeof exports?module.exports=t(require("quill")):e.Requester=t(e.Quill)}(this,function(p){"use strict";var e;return(e=angular.module("ngQuill",["ngSanitize"])).provider("ngQuillConfig",function(){var t={modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]]},bounds:document.body,debug:"warn",theme:"snow",scrollingContainer:null,placeholder:"Insert text here ...",readOnly:!1,trackChanges:"user",preserveWhitespace:!1};this.set=function(e){(e=e||{}).modules&&(t.modules=e.modules),e.theme&&(t.theme=e.theme),null!==e.placeholder&&void 0!==e.placeholder&&(t.placeholder=e.placeholder.trim()),e.readOnly&&(t.readOnly=e.readOnly),e.formats&&(t.formats=e.formats),e.bounds&&(t.bounds=e.bounds),e.scrollingContainer&&(t.scrollingContainer=e.scrollingContainer),!e.debug&&!1!==e.debug||(t.debug=e.debug),e.trackChanges&&-1<["all","user"].indexOf(e.trackChanges)&&(t.trackChanges=e.trackChanges),e.preserveWhitespace&&(t.preserveWhitespace=!0)},this.$get=function(){return t}}),e.component("ngQuillEditor",{bindings:{modules:"<modules",theme:"@?",readOnly:"<?",format:"@?",debug:"@?",formats:"<?",placeholder:"<?",bounds:"<?",scrollingContainer:"<?",strict:"<?",onEditorCreated:"&?",onContentChanged:"&?",onBlur:"&?",onFocus:"&?",onSelectionChanged:"&?",ngModel:"<",maxLength:"<",minLength:"<",customOptions:"<?",styles:"<?",sanitize:"<?",customToolbarPosition:"@?",trackChanges:"@?",preserveWhitespace:"<?"},require:{ngModelCtrl:"ngModel"},transclude:{toolbar:"?ngQuillToolbar"},template:'<div class="ng-hide" ng-show="$ctrl.ready"><ng-transclude ng-transclude-slot="toolbar"></ng-transclude></div>',controller:["$scope","$element","$sanitize","$timeout","$transclude","ngQuillConfig",function(r,i,s,e,o,a){var l,d,h,u,c,g={},m="html",f=!1,t=a.placeholder;this.setter=function(t){if("html"===m)return h.clipboard.convert(this.sanitize?s(t):t);if("json"===this.format)try{return JSON.parse(t)}catch(e){return[{insert:t}]}return t},this.validate=function(e){var t=e.trim().length;this.maxLength&&(t>this.maxLength?this.ngModelCtrl.$setValidity("maxlength",!1):this.ngModelCtrl.$setValidity("maxlength",!0)),0<this.minLength&&(t<this.minLength&&t?this.ngModelCtrl.$setValidity("minlength",!1):this.ngModelCtrl.$setValidity("minlength",!0))},this.$onChanges=function(e){if(e.ngModel&&(l=e.ngModel.currentValue,h&&(f||(l?e.ngModel.currentValue!==e.ngModel.previousValue&&("text"===this.format?h.setText(l):h.setContents(this.setter(l))):h.setText("")),f=!1)),h&&e.readOnly&&h.enable(!e.readOnly.currentValue),h&&e.placeholder&&(h.root.dataset.placeholder=e.placeholder.currentValue),h&&d&&e.styles){var t=e.styles.currentValue,n=e.styles.previousValue;if(n)for(var i in n)d.style[i]="";if(t)for(var s in t)t.hasOwnProperty(s)&&(d.style[s]=t[s])}},this.$onInit=function(){null!==this.placeholder&&void 0!==this.placeholder&&(t=this.placeholder.trim()),this.format&&-1<["object","html","text","json"].indexOf(this.format)&&(m=this.format),g={theme:this.theme||a.theme,readOnly:this.readOnly||a.readOnly,modules:this.modules||a.modules,formats:this.formats||a.formats,placeholder:t,bounds:this.bounds||a.bounds,strict:this.strict,scrollingContainer:this.scrollingContainer||a.scrollingContainer,debug:this.debug||!1===this.debug?this.debug:a.debug}},this.$postLink=function(){e(function(){this._initEditor()}.bind(this),0)},this.$onDestroy=function(){h=null,u&&u.removeListener("text-change"),c&&c.removeListener("selection-change")},this._initEditor=function(){var e=this.preserveWhitespace?angular.element("<pre></pre>"):angular.element("<div></div>"),t=i.children();if(d=e[0],"self"===g.bounds&&(g.bounds=d),o.isSlotFilled("toolbar")&&(g.modules.toolbar=t.find("ng-quill-toolbar").children()[0]),this.styles)for(var n in this.styles)this.styles.hasOwnProperty(n)&&(d.style[n]=this.styles[n]);if(this.customToolbarPosition&&"top"!==this.customToolbarPosition?t.prepend(e):t.append(e),this.customOptions&&this.customOptions.forEach(function(e){var t=p.import(e.import);t.whitelist=e.whitelist,e.toRegister&&(t[e.toRegister.key]=e.toRegister.value),p.register(t,!0)}),h=new p(d,g),this.ready=!0,c=h.on("selection-change",function(e,t,n){null===e&&this.onBlur?this.onBlur({editor:h,source:n}):null===t&&this.onFocus&&this.onFocus({editor:h,source:n}),this.onSelectionChanged&&this.onSelectionChanged({editor:h,oldRange:t,range:e,source:n}),e||r.$applyAsync(function(){this.ngModelCtrl.$setTouched()}.bind(this))}.bind(this)),u=h.on("text-change",function(t,n,i){var s=d.querySelector(".ql-editor").innerHTML,o=h.getText(),l=h.getContents(),e=["<"+h.root.firstChild.localName+">","</"+h.root.firstChild.localName+">"];s===e[0]+"<br>"+e[1]&&(s=null),this.validate(o),r.$applyAsync(function(){var e=this.trackChanges||a.trackChanges;if("user"===i||e&&"all"===e)if(f=!0,"text"===m)o===this.ngModelCtrl.$viewValue?f=!1:this.ngModelCtrl.$setViewValue(o);else if("object"===m)this.ngModelCtrl.$setViewValue(l);else if("json"===this.format)try{this.ngModelCtrl.$setViewValue(JSON.stringify(l))}catch(e){this.ngModelCtrl.$setViewValue(o)}else this.ngModelCtrl.$setViewValue(s);this.onContentChanged&&this.onContentChanged({editor:h,html:s,text:o,content:l,delta:t,oldDelta:n,source:i})}.bind(this))}.bind(this)),l){if("text"===m)h.setText(l,"silent");else if("object"===m)h.setContents(l,"silent");else if("json"===m)try{h.setContents(JSON.parse(l),"silent")}catch(e){h.setText(l,"silent")}else h.setContents(h.clipboard.convert(this.sanitize?s(l):l,"silent"));h.history.clear()}this.validate(h.getText()),this.onEditorCreated&&this.onEditorCreated({editor:h})}}]}),e.name});
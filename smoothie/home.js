!function(e){var n,i={extend:function(){arguments[0]=arguments[0]||{};for(var e=1;e<arguments.length;e++)for(var t in arguments[e])arguments[e].hasOwnProperty(t)&&("object"!=typeof arguments[e][t]||arguments[e][t]instanceof Array?arguments[0][t]=arguments[e][t]:arguments[0][t]=i.extend(arguments[0][t],arguments[e][t]));return arguments[0]}};function t(e){this.options=i.extend({},t.defaultOptions,e),this.data=[],this.maxValue=Number.NaN,this.minValue=Number.NaN}function a(e){this.options=i.extend({},a.defaultChartOptions,e),this.seriesSet=[],this.currentValueRange=1,this.currentVisMinValue=0}t.defaultOptions={resetBoundsInterval:3e3,resetBounds:!0},t.prototype.resetBounds=function(){if(this.data.length){this.maxValue=this.data[0][1],this.minValue=this.data[0][1];for(var e=1;e<this.data.length;e++){var t=this.data[e][1];t>this.maxValue&&(this.maxValue=t),t<this.minValue&&(this.minValue=t)}}else this.maxValue=Number.NaN,this.minValue=Number.NaN},t.prototype.append=function(e,t,i){for(var a=this.data.length-1;0<a&&this.data[a][0]>e;)a--;0<this.data.length&&this.data[a][0]===e?i?(this.data[a][1]+=t,t=this.data[a][1]):this.data[a][1]=t:a<this.data.length-1?this.data.splice(a+1,0,[e,t]):this.data.push([e,t]),this.maxValue=isNaN(this.maxValue)?t:Math.max(this.maxValue,t),this.minValue=isNaN(this.minValue)?t:Math.min(this.minValue,t)},t.prototype.dropOldData=function(e,t){for(var i=0;this.data.length-i>=t&&this.data[i+1][0]<e;)i++;0!==i&&this.data.splice(0,i)},a.defaultChartOptions={millisPerPixel:20,maxValueScale:1,interpolation:"bezier",scaleSmoothing:.125,maxDataSetLength:2,grid:{fillStyle:"#000000",strokeStyle:"#777777",lineWidth:1,sharpLines:!1,millisPerLine:1e3,verticalSections:2,borderVisible:!0},labels:{fillStyle:"#ffffff",disabled:!1,fontSize:10,fontFamily:"monospace",precision:2},horizontalLines:[]},a.AnimateCompatibility=(n=0,{requestAnimationFrame:function(e,t){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){var t=(new Date).getTime(),i=Math.max(0,16-(t-n)),a=window.setTimeout(function(){e(t+i)},i);return n=t+i,a}).call(window,e,t)},cancelAnimationFrame:function(e){return(window.cancelAnimationFrame||function(e){clearTimeout(e)}).call(window,e)}}),a.defaultSeriesPresentationOptions={lineWidth:1,strokeStyle:"#ffffff"},a.prototype.addTimeSeries=function(e,t){this.seriesSet.push({timeSeries:e,options:i.extend({},a.defaultSeriesPresentationOptions,t)}),e.options.resetBounds&&0<e.options.resetBoundsInterval&&(e.resetBoundsTimerId=setInterval(function(){e.resetBounds()},e.options.resetBoundsInterval))},a.prototype.removeTimeSeries=function(e){for(var t=this.seriesSet.length,i=0;i<t;i++)if(this.seriesSet[i].timeSeries===e){this.seriesSet.splice(i,1);break}e.resetBoundsTimerId&&clearInterval(e.resetBoundsTimerId)},a.prototype.streamTo=function(e,t){this.canvas=e,this.delay=t,this.start()},a.prototype.start=function(){var e;this.frame||(e=function(){this.frame=a.AnimateCompatibility.requestAnimationFrame(function(){this.render(),e()}.bind(this))}.bind(this))()},a.prototype.stop=function(){this.frame&&(a.AnimateCompatibility.cancelAnimationFrame(this.frame),delete this.frame)},a.prototype.updateValueRange=function(){for(var e,t=this.options,i=Number.NaN,a=Number.NaN,n=0;n<this.seriesSet.length;n++){var s=this.seriesSet[n].timeSeries;isNaN(s.maxValue)||(i=isNaN(i)?s.maxValue:Math.max(i,s.maxValue)),isNaN(s.minValue)||(a=isNaN(a)?s.minValue:Math.min(a,s.minValue))}null!=t.maxValue?i=t.maxValue:i*=t.maxValueScale,null!=t.minValue&&(a=t.minValue),this.options.yRangeFunction&&(a=(e=this.options.yRangeFunction({min:a,max:i})).min,i=e.max),isNaN(i)||isNaN(a)||(this.currentValueRange+=t.scaleSmoothing*(i-a-this.currentValueRange),this.currentVisMinValue+=t.scaleSmoothing*(a-this.currentVisMinValue)),this.valueRange={min:a,max:i}},a.prototype.render=function(e,t){e=e||this.canvas,t=t||(new Date).getTime()-(this.delay||0),t-=t%this.options.millisPerPixel;function i(e){return Math.round(s.width-(t-e)/n.millisPerPixel)}var a=e.getContext("2d"),n=this.options,s={top:0,left:0,width:e.clientWidth,height:e.clientHeight},r=t-s.width*n.millisPerPixel,l=function(e){e-=this.currentVisMinValue;return 0===this.currentValueRange?s.height:s.height-Math.round(e/this.currentValueRange*s.height)}.bind(this);if(this.updateValueRange(),a.font=n.labels.fontSize+"px "+n.labels.fontFamily,a.save(),a.translate(s.left,s.top),a.beginPath(),a.rect(0,0,s.width,s.height),a.clip(),a.save(),a.fillStyle=n.grid.fillStyle,a.clearRect(0,0,s.width,s.height),a.fillRect(0,0,s.width,s.height),a.restore(),a.save(),a.lineWidth=n.grid.lineWidth,a.strokeStyle=n.grid.strokeStyle,0<n.grid.millisPerLine)for(var o=s.width-a.measureText(v).width+4,h=t-t%n.grid.millisPerLine;r<=h;h-=n.grid.millisPerLine){var u,d,m=i(h);n.grid.sharpLines&&(m-=.5),a.beginPath(),a.moveTo(m,0),a.lineTo(m,s.height),a.stroke(),a.closePath(),n.timestampFormatter&&m<o&&(d=new Date(h),u=n.timestampFormatter(d),o=m-(d=a.measureText(u).width)-2,a.fillStyle=n.labels.fillStyle,a.fillText(u,m-d,s.height-2))}for(var f=1;f<n.grid.verticalSections;f++){var c=Math.round(f*s.height/n.grid.verticalSections);n.grid.sharpLines&&(c-=.5),a.beginPath(),a.moveTo(0,c),a.lineTo(s.width,c),a.stroke(),a.closePath()}if(n.grid.borderVisible&&(a.beginPath(),a.strokeRect(0,0,s.width,s.height),a.closePath()),a.restore(),n.horizontalLines&&n.horizontalLines.length)for(var p=0;p<n.horizontalLines.length;p++){var g=n.horizontalLines[p],S=Math.round(l(g.value))-.5;a.strokeStyle=g.color||"#ffffff",a.lineWidth=g.lineWidth||1,a.beginPath(),a.moveTo(0,S),a.lineTo(s.width,S),a.stroke(),a.closePath()}for(var v,x=0;x<this.seriesSet.length;x++){a.save();var V=this.seriesSet[x].timeSeries,y=V.data,w=this.seriesSet[x].options;V.dropOldData(r,n.maxDataSetLength),a.lineWidth=w.lineWidth,a.strokeStyle=w.strokeStyle,a.beginPath();for(var b=0,N=0,T=0,P=0;P<y.length&&1!==y.length;P++){var F=i(y[P][0]),R=l(y[P][1]);if(0===P)a.moveTo(b=F,R);else switch(n.interpolation){case"linear":case"line":a.lineTo(F,R);break;default:a.bezierCurveTo(Math.round((N+F)/2),T,Math.round(N+F)/2,R,F,R)}N=F,T=R}1<y.length&&(w.fillStyle&&(a.lineTo(s.width+w.lineWidth+1,T),a.lineTo(s.width+w.lineWidth+1,s.height+w.lineWidth+1),a.lineTo(b,s.height+w.lineWidth),a.fillStyle=w.fillStyle,a.fill()),w.strokeStyle&&"none"!==w.strokeStyle&&a.stroke(),a.closePath()),a.restore()}n.labels.disabled||isNaN(this.valueRange.min)||isNaN(this.valueRange.max)||(e=parseFloat(this.valueRange.max).toFixed(n.labels.precision),v=parseFloat(this.valueRange.min).toFixed(n.labels.precision),a.fillStyle=n.labels.fillStyle,a.fillText(e,s.width-a.measureText(e).width-2,n.labels.fontSize),a.fillText(v,s.width-a.measureText(v).width-2,s.height-2)),a.restore()},a.timeFormatter=function(e){function t(e){return(e<10?"0":"")+e}return t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())},e.TimeSeries=t,e.SmoothieChart=a}("undefined"==typeof exports?this:exports);
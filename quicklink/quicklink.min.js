function e(r){return new Promise(function(e,n,t){(t=new XMLHttpRequest).open("GET",r,t.withCredentials=!0),t.onload=function(){(200===t.status?e:n)()},t.send()})}function n(n){return window.fetch?fetch(n,{credentials:"include"}):e(n)}var t,r=(t=document.createElement("link")).relList&&t.relList.supports&&t.relList.supports("prefetch")?function(r){return new Promise(function(e,n,t){(t=document.createElement("link")).rel="prefetch",t.href=r,t.onload=e,t.onerror=n,document.head.appendChild(t)})}:e,o=window.requestIdleCallback||function(e){var n=Date.now();return setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-n))}})},1)},i=new Set;function c(e,t,o){if(o=navigator.connection){if(o.saveData)return Promise.reject(new Error("Cannot prefetch, Save-Data is enabled"));if(/2g/.test(o.effectiveType))return Promise.reject(new Error("Cannot prefetch, network conditions are poor"))}return Promise.all([].concat(e).map(function(e){if(!i.has(e))return i.add(e),(t?n:r)(new URL(e,location.href).toString())}))}exports.listen=function(t){if(t=t||{},window.IntersectionObserver){var e=function(e){e=e||1;var n=[],t=0;function r(){t<e&&0<n.length&&(n.shift()(),t++)}return[function(e){1<n.push(e)||r()},function(){t--,r()}]}(t.throttle||1/0),r=e[0],u=e[1],f=t.limit||1/0,n=t.origins||[location.hostname],a=t.ignores||[],s=t.delay||0,l=[],e=t.timeoutFn||o,h="function"==typeof t.hrefFn&&t.hrefFn,d=new IntersectionObserver(function(e){e.forEach(function(e){var n;e.isIntersecting?(l.push((e=e.target).href),n=function(){-1!==l.indexOf(e.href)&&(d.unobserve(e),i.size<f&&r(function(){c(h?h(e):e.href,t.priority).then(u).catch(function(e){u(),t.onError&&t.onError(e)})}))},s?setTimeout(n,s):n()):-1<(n=l.indexOf((e=e.target).href))&&l.splice(n)})});return e(function(){(t.el||document).querySelectorAll("a").forEach(function(e){n.length&&!n.includes(e.hostname)||function n(t,e){return Array.isArray(e)?e.some(function(e){return n(t,e)}):(e.test||e).call(e,t.href,t)}(e,a)||d.observe(e)})},{timeout:t.timeout||2e3}),function(){i.clear(),d.disconnect()}}},exports.prefetch=c;
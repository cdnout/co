"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.withQuicklink=void 0;var _react=_interopRequireWildcard(require("react")),_routeManifest=_interopRequireDefault(require("route-manifest")),_quicklink=require("./quicklink");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!==_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache();if(r&&r.has(e))return r.get(e);var t,n,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&((n=i?Object.getOwnPropertyDescriptor(e,t):null)&&(n.get||n.set)?Object.defineProperty(o,t,n):o[t]=e[t]);return o.default=e,r&&r.set(e,o),o}function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function _iterableToArrayLimit(e,r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var t=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(t.push(u.value),!r||t.length!==r);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return t}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var useIntersect=function(e){var r=0<arguments.length&&void 0!==e?e:{},e=r.root,t=void 0===e?null:e,n=r.rootMargin,e=r.threshold,o=void 0===e?0:e,r=_slicedToArray((0,_react.useState)({}),2),e=r[0],i=r[1],r=_slicedToArray((0,_react.useState)(null),2),u=r[0],r=r[1],a=(0,_react.useRef)(null);return(0,_react.useEffect)(function(){a.current&&a.current.disconnect(),a.current=new window.IntersectionObserver(function(e){e=_slicedToArray(e,1)[0];return i(e)},{root:t,rootMargin:n,threshold:o});var e=a.current;return u&&e.observe(u),function(){return e.disconnect()}},[u,t,n,o]),[r,e]},__defaultAccessor=function(e){return e&&e.href||e||""},prefetchChunks=function(e,r,t){t=2<arguments.length&&void 0!==t?t:__defaultAccessor,t=(0,_routeManifest.default)(window.__rmanifest,e.pathname).files.map(t).filter(Boolean);t.length?r(t):r(e.href)},withQuicklink=function(o,e){var i=1<arguments.length&&void 0!==e?e:{};return function(e){var r=_slicedToArray(useIntersect({root:document.body.parentElement}),2),t=r[0],n=r[1].intersectionRatio;return(0,_react.useEffect)(function(){i.prefetchChunks=prefetchChunks,0<n&&(0,_quicklink.listen)(i)},[n]),_react.default.createElement("div",{ref:t},_react.default.createElement(o,e))}};exports.withQuicklink=withQuicklink;
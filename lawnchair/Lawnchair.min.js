var Lawnchair=function(a,r){if(!(this instanceof Lawnchair))return new Lawnchair(a,r);if(!JSON)throw"JSON unavailable! Include http://www.json.org/json2.js to fix.";if(!(arguments.length<=2))throw"Incorrect # of ctor args!";var t;if(r="function"==typeof a?a:r,a="function"!=typeof a&&a||{},this.record=a.record||"record",this.name=a.name||"records",a.adapter){"string"==typeof a.adapter&&(a.adapter=[a.adapter]);for(var n=0,i=a.adapter.length;n<i;n++){for(var e=Lawnchair.adapters.length-1;0<=e&&(Lawnchair.adapters[e].adapter!==a.adapter[n]||!(t=Lawnchair.adapters[e].valid()?Lawnchair.adapters[e]:void 0));e--);if(t)break}}else for(var e=0,o=Lawnchair.adapters.length;e<o&&!(t=Lawnchair.adapters[e].valid()?Lawnchair.adapters[e]:void 0);e++);if(!t)throw"No valid adapter.";for(var n in t)this[n]=t[n];for(e=0,o=Lawnchair.plugins.length;e<o;e++)Lawnchair.plugins[e].call(this);this.init(a,r)};Lawnchair.adapters=[],Lawnchair.adapter=function(a,r){r.adapter=a;var t="adapter valid init keys save batch get exists all remove nuke".split(" "),n=this.prototype.indexOf;for(var i in r)if(-1===n(t,i))throw"Invalid adapter! Nonstandard method: "+i;Lawnchair.adapters.splice(0,0,r)},Lawnchair.plugins=[],Lawnchair.plugin=function(a){for(var r in a)"init"===r?Lawnchair.plugins.push(a[r]):this.prototype[r]=a[r]},Lawnchair.prototype={isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},indexOf:function(a,r,t,n){if(a.indexOf)return a.indexOf(r);for(t=0,n=a.length;t<n;t++)if(a[t]===r)return t;return-1},lambda:function(a){return this.fn(this.record,a)},fn:function(a,r){return"string"==typeof r?new Function(a,r):r},uuid:function(){function a(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},each:function(a){var n=this.lambda(a);if(this.__results)for(var r=0,t=this.__results.length;r<t;r++)n.call(this,this.__results[r],r);else this.all(function(a){for(var r=0,t=a.length;r<t;r++)n.call(this,a[r],r)});return this}},"undefined"!=typeof module&&module.exports&&(module.exports=Lawnchair);
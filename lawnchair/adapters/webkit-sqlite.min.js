Lawnchair.adapter("webkit-sqlite",function(){function h(t,n){console.error("error in sqlite adaptor!",t,n)}return Function.prototype.bind||(Function.prototype.bind=function(t){function n(){}function i(){return a.apply(this instanceof n?this:t||{},e.concat(r.call(arguments)))}var r=[].slice,e=r.call(arguments,1),a=this;return n.prototype=a.prototype,i.prototype=new n,i}),{valid:function(){return!!window.openDatabase},init:function(t,n){var i=this,r=i.fn(i.name,n),e="CREATE TABLE IF NOT EXISTS "+this.record+" (id NVARCHAR(32) UNIQUE PRIMARY KEY, value TEXT, timestamp REAL)";if(r&&"function"!=typeof r)throw"callback not valid";this.db=openDatabase(this.name,"1.0.0",this.name,65536),this.db.transaction(function(t){t.executeSql(e,[])},h,function(){if(r)return r.call(i,i)})},keys:function(t){var a=this.lambda(t),o=this,n="SELECT id FROM "+this.record+" ORDER BY timestamp DESC";return this.db.readTransaction(function(t){t.executeSql(n,[],function(t,n){if(0==n.rows.length)a.call(o,[]);else{for(var i=[],r=0,e=n.rows.length;r<e;r++)i.push(n.rows.item(r).id);a.call(o,i)}},h)}),this},save:function(t,n,i){var r=this,e=(this.isArray(t)?t:[t]).map(function(t){return t.key||(t.key=r.uuid()),t}),a="INSERT OR REPLACE INTO "+this.record+" (value, timestamp, id) VALUES (?,?,?)",o=[],s=new Date;try{for(var c=0,u=e.length;c<u;c++)o[c]=[JSON.stringify(e[c]),s,e[c].key]}catch(t){throw h(t),t}return r.db.transaction(function(t){for(var n=0,i=e.length;n<i;n++)t.executeSql(a,o[n])},function(t,n){h(t,n)},function(){n&&r.lambda(n).call(r,r.isArray(t)?e:e[0])}),this},batch:function(t,n){return this.save(t,n)},get:function(s,c){function n(t,n){for(var i,r,e={},a=0,o=n.rows.length;a<o;a++)(i=JSON.parse(n.rows.item(a).value)).key=n.rows.item(a).id,e[i.key]=i;r=l.map(function(t){return e[t]}),u.isArray(s)||(r=r.length?r[0]:null),c&&u.lambda(c).call(u,r)}var u=this,l=this.isArray(s)?s:[s],i="SELECT id, value FROM "+this.record+" WHERE id IN ("+l.map(function(){return"?"}).join(",")+")";return this.db.readTransaction(function(t){t.executeSql(i,l,n,h)}),this},exists:function(n,i){function r(t,n){i&&a.fn("exists",i).call(a,0<n.rows.length)}var e="SELECT * FROM "+this.record+" WHERE id = ?",a=this;return this.db.readTransaction(function(t){t.executeSql(e,[n],r,h)}),this},all:function(t){function n(t,n){if(0!=n.rows.length)for(var i=0,r=n.rows.length;i<r;i++){var e=JSON.parse(n.rows.item(i).value);e.key=n.rows.item(i).id,o.push(e)}s&&s.call(a,o)}var a=this,i="SELECT * FROM "+this.record,o=[],s=this.fn(this.name,t)||void 0;return this.db.readTransaction(function(t){t.executeSql(i,[],n,h)}),this},remove:function(t,n){function i(){n&&e.lambda(n).call(e)}var r,e=this,a="DELETE FROM "+this.record+" WHERE id ";return this.isArray(t)?a+="IN ("+(r=t).map(function(){return"?"}).join(",")+")":(a+="= ?",r=[t]),r=r.map(function(t){return t.key?t.key:t}),this.db.transaction(function(t){t.executeSql(a,r,i,h)}),this},nuke:function(t){var n="DELETE FROM "+this.record,i=this,r=t?function(){i.lambda(t).call(i)}:function(){};return this.db.transaction(function(t){t.executeSql(n,[],r,h)}),this}}}());
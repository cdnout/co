Lawnchair.adapter("html5-filesystem",function(e){var t=e.StorageInfo||e.webkitStorageInfo||{},r=e.TEMPORARY||t.TEMPORARY,o=e.PERSISTENT||t.PERSISTENT,l=e.BlobBuilder||e.WebKitBlobBuilder;l?console.error("this browser has not depricated BlobBuilder. you probably want to update."):console.log("this modern browser has depricated BlobBuilder, use Blob instead");function c(e){var t;switch(e.code){case n.QUOTA_EXCEEDED_ERR:t="QUOTA_EXCEEDED_ERR";break;case n.NOT_FOUND_ERR:t="NOT_FOUND_ERR";break;case n.SECURITY_ERR:t="SECURITY_ERR";break;case n.INVALID_MODIFICATION_ERR:t="INVALID_MODIFICATION_ERR";break;case n.INVALID_STATE_ERR:t="INVALID_STATE_ERR";break;default:t="Unknown Error"}console&&console.error(e,t)}var s=e.requestFileSystem||e.webkitRequestFileSystem||e.moz_requestFileSystem,n=e.FileError,a=function(t,n,e){var i=e||[];t.readEntries(function(e){e.length?a(t,n,i.concat(Array.prototype.slice.call(e))):n&&n(i.map(function(e){return e.name}))},c)},u={},f=function(e,t){var n=u[e.name];n?t(n):setTimeout(function(){f(e,t)},10)};return{valid:function(){return!!s},init:function(t,n){function i(e){c(e),n&&a.fn(a.name,n).call(a,a)}var a=this;s("TEMPORARY"===t.storage?r:o,t.size||1073741824,function(e){e.root.getDirectory(t.name,{create:!0},function(e){u[t.name]=e,n&&a.fn(a.name,n).call(a,a)},i)},i)},keys:function(t){var n=this;return f(this,function(e){a(e.createReader(),function(e){t&&n.fn("keys",t).call(n,e)})}),this},save:function(n,i){var a=this,t=n.key||this.uuid();n.key=t;function r(e){c(e),i&&a.lambda(i).call(a)}return f(this,function(e){e.getFile(t,{create:!0},function(e){e.createWriter(function(e){var t;e.onerror=r,e.onwriteend=function(){i&&a.lambda(i).call(a,n)},l?((t=new l).append(JSON.stringify(n)),e.write(t.getBlob("application/json"))):e.write(new Blob([JSON.stringify(n)],{type:"application/json"}))},r)},r)}),this},batch:function(e,t){for(var n=this,i=[],a=0,r=e.length;a<r;a++)n.save(e[a],function(e){i.push(e),i.length===r&&t&&n.lambda(t).call(n,i)});return this},get:function(t,n){var i=this;if(this.isArray(t))for(var a=[],e=0,r=t.length;e<r;e++)i.get(t[e],function(e){e&&a.push(e),a.length===r&&n&&i.lambda(n).call(i,a)});else{function o(e){c(e),n&&i.lambda(n).call(i)}f(this,function(e){e.getFile(t,{create:!1},function(e){e.file(function(e){var t=new FileReader;t.onerror=o,t.onload=function(e){n&&i.lambda(n).call(i,JSON.parse(e.target.result))},t.readAsText(e)},o)},o)})}return this},exists:function(t,n){var i=this;return f(this,function(e){e.getFile(t,{create:!1},function(){n&&i.lambda(n).call(i,!0)},function(){n&&i.lambda(n).call(i,!1)})}),this},all:function(t){var n=this;return t&&this.keys(function(e){e.length?n.get(e,function(e){n.fn(n.name,t).call(n,e)}):n.fn(n.name,t).call(n,[])}),this},remove:function(t,n){function i(e){c(e),n&&a.lambda(n).call(a)}var a=this;return f(this,function(e){e.getFile("string"==typeof t?t:t.key,{create:!1},function(e){e.remove(function(){n&&a.lambda(n).call(a)},i)},i)}),this},nuke:function(i){var a=this,r=0;return this.keys(function(e){if(e.length)for(var t=0,n=e.length;t<n;t++)a.remove(e[t],function(){++r===n&&i&&a.lambda(i).call(a)});else i&&a.lambda(i).call(a)}),this}}}(this));
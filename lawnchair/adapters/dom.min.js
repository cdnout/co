Lawnchair.adapter("dom",function(){var h=window.localStorage;return{valid:function(){return!!h&&function(){var e=!0,t=Math.random();try{h.setItem(t,t)}catch(t){e=!1}return h.removeItem(t),e}()},init:function(t,e){this.indexer={key:this.name+"._index_",all:function(){var t=h.getItem(JSON.stringify(this.key));return null===(t=t&&JSON.parse(t))&&h.setItem(JSON.stringify(this.key),JSON.stringify([])),JSON.parse(h.getItem(JSON.stringify(this.key)))},add:function(t){var e=this.all();e.push(t),h.setItem(JSON.stringify(this.key),JSON.stringify(e))},del:function(t){for(var e=this.all(),i=[],n=0,r=e.length;n<r;n++)e[n]!=t&&i.push(e[n]);h.setItem(JSON.stringify(this.key),JSON.stringify(i))},find:function(t){for(var e=this.all(),i=0,n=e.length;i<n;i++)if(t===e[i])return i;return!1}},e&&this.fn(this.name,e).call(this,this)},save:function(t,e){var i=t.key?this.name+"."+t.key:this.name+"."+this.uuid();return delete t.key,h.setItem(i,JSON.stringify(t)),!1===this.indexer.find(i)&&this.indexer.add(i),t.key=i.slice(this.name.length+1),e&&this.lambda(e).call(this,t),this},batch:function(t,e){for(var i=[],n=0,r=t.length;n<r;n++)this.save(t[n],function(t){i.push(t)});return e&&this.lambda(e).call(this,i),this},keys:function(t){if(t){var e=this.name,i=this.indexer.all(),n=[];if(Array.prototype.map)n=i.map(function(t){return t.replace(e+".","")});else for(var r in i)n.push(r.replace(e+".",""));this.fn("keys",t).call(this,n)}return this},get:function(t,e){if(this.isArray(t)){for(var i=[],n=0,r=t.length;n<r;n++){var s=this.name+"."+t[n];(a=h.getItem(s))&&((a=JSON.parse(a)).key=t[n]),i.push(a)}e&&this.lambda(e).call(this,i)}else{var a,s=this.name+"."+t;(a=h.getItem(s))&&((a=JSON.parse(a)).key=t),e&&this.lambda(e).call(this,a)}return this},exists:function(t,e){var i=!1!==this.indexer.find(this.name+"."+t);return this.lambda(e).call(this,i),this},all:function(t){for(var e,i,n=this.indexer.all(),r=[],s=0,a=n.length;s<a;s++)i=n[s],(e=JSON.parse(h.getItem(i))).key=i.replace(this.name+".",""),r.push(e);return t&&this.fn(this.name,t).call(this,r),this},remove:function(t,e){var i,n=this;if(this.isArray(t)){for(var r=t.length,s=0;s<t.length;s++)i=s,n.remove(t[i],function(){0<--r||e&&n.lambda(e).call(n)});return this}var a=this.name+"."+(t.key?t.key:t);return this.indexer.del(a),h.removeItem(a),e&&this.lambda(e).call(this),this},nuke:function(n){return this.all(function(t){for(var e=0,i=t.length;e<i;e++)this.remove(t[e]);n&&this.lambda(n).call(this)}),this}}}());
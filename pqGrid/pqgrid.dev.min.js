!function(t){var e=t.paramquery=t.paramquery||{};t.paramquery.pqgrid=t.paramquery.pqgrid||{},e.xmlToArray=function(e,i){var r=i.itemParent,o=i.itemNames,n=[];return t(e).find(r).each(function(e,i){var r=t(i),a=[];t(o).each(function(t,e){a.push(r.find(e).text().replace(/\r|\n|\t/g,""))}),n.push(a)}),n},e.xmlToJson=function(e,i){var r=i.itemParent,o=i.itemNames,n=[];return t(e).find(r).each(function(e,i){for(var r=t(i),a={},l=0,s=o.length;l<s;l++){var d=o[l];a[d]=r.find(d).text().replace(/\r|\n|\t/g,"")}n.push(a)}),n},e.tableToArray=function(e){var i=[],r=[],o=t(e).children("tbody").children("tr"),n=o.length?t(o[0]):t(),a=o.length>1?t(o[1]):t();return n.children("th,td").each(function(e,r){var o=t(r),n=o.html(),l=o.width(),s="left";if(a.length){var d=a.find("td:eq("+e+")").attr("align");s=d||s}var h={title:n,width:l,dataType:"string",align:s,dataIndx:e};i.push(h)}),o.each(function(e,i){if(0!=e){var o=[];t(i).children("td").each(function(e,i){o.push(t.trim(t(i).html()))}),r.push(o)}}),{data:r,colModel:i}},e.formatCurrency=function(t){if(isNaN(t))return t;t=Math.round(100*t)/100,-1==(t+="").indexOf(".")?t+=".00":t.indexOf(".")+2==t.length&&(t+="0");for(var e=t.length,i=t.substring(0,e-3),r=t.substring(e-3,e),o=i.match(/\d/g).reverse(),n=[],a=0;a<o.length;a++)a>0&&a%3==0&&n.push(","),n.push(o[a]);return(i=(n=n.reverse()).join(""))+r},e.validation={is:function(t,e){return"string"==t||!t||this["is"+(t=t.substring(0,1).toUpperCase()+t.substring(1,t.length))](e)},isFloat:function(t){var e=parseFloat(t);return!isNaN(e)&&e==t},isInteger:function(t){var e=parseInt(t);return!isNaN(e)&&e==t},isDate:function(t){var e=Date.parse(t);return!isNaN(e)}}}(jQuery),function(t){var e={options:{curPage:0,totalPages:0,totalRecords:0,msg:"",rPPOptions:[10,20,30,40,50,100],rPP:20},_regional:{strDisplay:"Displaying {0} to {1} of {2} items.",strFirstPage:"First Page",strLastPage:"Last Page",strNextPage:"Next Page",strPage:"Page {0} of {1}",strPrevPage:"Previous Page",strRefresh:"Refresh",strRpp:"Records per page:{0}"}};t.extend(e.options,e._regional),e._create=function(){var e=this,i=this.options;this.element.addClass("pq-pager"),this.first=t("<button type='button' title='"+i.strFirstPage+"'></button>",{}).appendTo(this.element).button({icons:{primary:"ui-icon-seek-first"},text:!1}).bind("click.paramquery",function(t){e.options.curPage>1&&e._onChange(t,1)}),this.prev=t("<button type='button' title='"+i.strPrevPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-prev"},text:!1}).bind("click",function(t){if(e.options.curPage>1){var i=e.options.curPage-1;e._onChange(t,i)}}),t("<span class='pq-separator'></span>").appendTo(this.element),this.pageHolder=t("<span class='pq-page-placeholder'></span>").appendTo(this.element),t("<span class='pq-separator'></span>").appendTo(this.element),this.next=t("<button type='button' title='"+this.options.strNextPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-next"},text:!1}).bind("click",function(t){var i=e.options.curPage+1;e._onChange(t,i)}),this.last=t("<button type='button' title='"+this.options.strLastPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-end"},text:!1}).bind("click",function(t){var i=e.options.totalPages;e._onChange(t,i)}),t("<span class='pq-separator'></span>").appendTo(this.element),this.rPPHolder=t("<span class='pq-page-placeholder'></span>").appendTo(this.element),this.$refresh=t("<button type='button' title='"+this.options.strRefresh+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-refresh"},text:!1}).bind("click",function(t){if(!1===e._trigger("beforeRefresh",t))return!1;e._trigger("refresh",t)}),t("<span class='pq-separator'></span>").appendTo(this.element),this.$msg=t("<span class='pq-pager-msg'></span>").appendTo(this.element),this._refresh()},e._refreshPage=function(){var e=this;this.pageHolder.empty();for(var i=this.options,r=i.strPage.split(" "),o=[],n=0,a=r.length;n<a;n++){var l=r[n];"{0}"==l?o.push("<input type='text' tabindex='0' class='ui-corner-all' />"):"{1}"==l?o.push("<span class='total'></span>"):o.push("<span>",l,"</span>")}var s=o.join(""),d=t(s).appendTo(this.pageHolder);this.page=d.filter("input").bind("change",function(r){var o=t(this),n=o.val();return isNaN(n)||n<1?(o.val(i.curPage),!1):(n=parseInt(n))>i.totalPages?(o.val(i.curPage),!1):!1===e._onChange(r,n)?(o.val(i.curPage),!1):void 0}),this.$total=d.filter("span.total")},e._onChange=function(t,e){return!1!==this._trigger("beforeChange",t,{curPage:e})&&(!1!==this._trigger("change",t,{curPage:e})&&void this.option({curPage:e}))},e._refresh=function(){this._refreshPage();this.$rPP;var e=this,i=this.options;if(this.first.attr("title",i.strFirstPage),this.prev.attr("title",i.strPrevPage),this.next.attr("title",i.strNextPage),this.last.attr("title",i.strLastPage),this.$refresh.attr("title",i.strRefresh),this.rPPHolder.empty(),i.strRpp){var r=i.rPPOptions,o=i.strRpp;if(-1!=o.indexOf("{0}")){for(var n=["<select class='ui-corner-all'>"],a=0,l=r.length;a<l;a++){var s=r[a];n.push('<option value="',s,'">',s,"</option>")}n.push("</select>");var d=n.join("");o="<span>"+(o=o.replace("{0}","</span>"+d))+"<span class='pq-separator'></span>"}else o="<span>"+o+"</span><span class='pq-separator'></span>";this.$rPP=t(o).appendTo(this.rPPHolder).filter("select").val(i.rPP).change(function(i){var r=t(this),o=r.val();if(!1===e._trigger("beforeChange",i,{rPP:o}))return r.val(e.options.rPP),!1;!1!==e._trigger("change",i,{rPP:o})&&(e.options.rPP=o)})}if(i.curPage>=i.totalPages?(this.next.button({disabled:!0}),this.last.button({disabled:!0})):(this.next.button({disabled:!1}),this.last.button({disabled:!1})),i.curPage<=1?(this.first.button({disabled:!0}),this.prev.button({disabled:!0})):(this.first.button({disabled:!1}),this.prev.button({disabled:!1})),this.page.val(i.curPage),this.$total.text(i.totalPages),this.options.totalRecords>0){var h=i.rPP,c=i.curPage,u=i.totalRecords,f=(c-1)*h,p=c*h;p>u&&(p=u);var g=i.strDisplay;g=(g=(g=g.replace("{0}",f+1)).replace("{1}",p)).replace("{2}",u),this.$msg.html(g)}else this.$msg.html("")},e._destroy=function(){this.element.empty().removeClass("pq-pager").enableSelection()},e._setOption=function(t,e){"curPage"!=t&&"totalPages"!=t||(e=parseInt(e)),this._super.call(this,t,e)},e._setOptions=function(){this._super.apply(this,arguments),this._refresh()},t.widget("paramquery.pqPager",e),t.paramquery.pqPager.regional={},t.paramquery.pqPager.regional.en=e._regional}(jQuery),function(t){var e={options:{length:200,num_eles:3,cur_pos:0,ratio:0,timeout:350,pace:"optimum",direction:"vertical",theme:!1},_destroy:function(){t(document).off("."+this.eventNamespace),this.element.removeClass("pq-sb-vert pq-sb-vert-t pq-sb-vert-wt").enableSelection().removeClass("pq-sb-horiz pq-sb-horiz-t pq-sb-horiz-wt").unbind("click.pq-scrollbar").empty(),this.element.removeData()},_create:function(){this._createLayout()},_createLayout:function(){var e=this,i=this.options,r=i.direction,o=this.eventNamespace,n=i.theme,a=this.element.empty();"vertical"==r?(a.removeClass("pq-sb-vert-t pq-sb-vert-wt").addClass("pq-sb-vert"),n?(a.addClass("pq-sb-vert-t"),a.html(["<div class='top-btn pq-sb-btn ui-state-default ui-corner-top'>","<div class='ui-icon ui-icon-triangle-1-n'></div></div>","<div class='pq-sb-slider ui-corner-all ui-state-default'>","</div>","<div class='bottom-btn pq-sb-btn ui-state-default ui-corner-bottom'>","<div class='ui-icon ui-icon-triangle-1-s'></div></div>"].join(""))):(a.addClass("pq-sb-vert-wt"),a.html(["<div class='top-btn pq-sb-btn'></div>","<div class='pq-sb-slider'>","<div class='vert-slider-top'></div>","<div class='vert-slider-bg'></div>","<div class='vert-slider-center'></div>","<div class='vert-slider-bg'></div>","<div class='vert-slider-bottom'></div>","</div>","<div class='bottom-btn pq-sb-btn'></div>"].join("")))):(a.removeClass("pq-sb-horiz-t pq-sb-horiz-wt").addClass("pq-sb-horiz"),n?(a.addClass("pq-sb-horiz-t"),a.html(["<div class='left-btn pq-sb-btn ui-state-default ui-corner-left'>","<div class='ui-icon ui-icon-triangle-1-w'></div></div>","<div class='pq-sb-slider pq-sb-slider-h ui-state-default ui-corner-all'>","</div>","<div class='right-btn pq-sb-btn ui-state-default ui-corner-right'>","<div class='ui-icon ui-icon-triangle-1-e'></div></div>"].join(""))):(a.addClass("pq-sb-horiz-wt"),a.width(this.width),a.html(["<div class='left-btn pq-sb-btn'></div>","<div class='pq-sb-slider pq-sb-slider-h'>","<span class='horiz-slider-left'></span>","<span class='horiz-slider-bg'></span>","<span class='horiz-slider-center'></span>","<span class='horiz-slider-bg'></span>","<span class='horiz-slider-right'></span>","</div>","<div class='right-btn pq-sb-btn'></div>"].join("")))),a.disableSelection().unbind(".pq-scrollbar").on("mousedown.pq-scrollbar",function(n){if(!i.disabled&&!e.$slider.is(":hidden"))if(t(document).off("."+o).on("mouseup."+o,function(t){e._mouseup(t)}),"vertical"==r){var a=n.pageY,l=(u=e.element.offset().top)+i.length,s=e.$slider,d=s.offset().top,h=s.height(),c=d+h;a<d&&a>u+17?e.mousedownInterval=window.setInterval(function(){a>=s.offset().top?(window.clearInterval(e.mousedownInterval),e.mousedownInterval=null):e._pageUp(n)},0):a>c&&a<l-17&&(e.mousedownInterval=window.setInterval(function(){a<=s.offset().top+h?(window.clearInterval(e.mousedownInterval),e.mousedownInterval=null):e._pageDown(n)},0))}else{var u,f=n.pageX;l=(u=e.element.offset().left)+i.length,c=(d=e.$slider.offset().left)+e.$slider.width();f<d&&f>u+17?(e.$slider.css("left",f-e.element.offset().left),e._updateCurPosAndTrigger(n)):f>c&&f<l-17&&(e.$slider.css("left",f-e.element.offset().left-e.$slider.width()),e._updateCurPosAndTrigger(n))}});var l=this.$slider=t("div.pq-sb-slider",this.element);n&&l.attr("tabindex","0"),this._bindSliderEvents(l),this.$top_btn=t("div.top-btn,div.left-btn",this.element).click(function(t){if(!e.options.disabled)return e.decr_cur_pos(t),t.preventDefault(),!1}).mousedown(function(t){e.options.disabled||(e.mousedownTimeout=window.setTimeout(function(){e.mousedownInterval=window.setInterval(function(){e.decr_cur_pos(t)},0)},e.options.timeout))}).bind("mouseup mouseout",function(t){e._mouseup(t)}),this.$bottom_btn=t("div.bottom-btn,div.right-btn",this.element).click(function(t){if(!e.options.disabled)return e.incr_cur_pos(t),t.preventDefault(),!1}).mousedown(function(t){e.options.disabled||(e.mousedownTimeout=window.setTimeout(function(){e.mousedownInterval=window.setInterval(function(){e.incr_cur_pos(t)},0)},e.options.timeout))}).bind("mouseup mouseout",function(t){e._mouseup(t)}),this.refresh()},_bindSliderEvents:function(e){var i=this,r="x";"vertical"==this.options.direction&&(r="y"),e.draggable({axis:r,helper:function(t,e){return i._setDragLimits(),this},start:function(t){i.topWhileDrag=null,i.dragging=!0},drag:function(t){i.dragging=!0;var e=i.options.pace;"optimum"==e?i._setNormalPace(t):"fast"==e&&i._updateCurPosAndTrigger(t)},stop:function(t){"fast"!=i.options.pace&&i._updateCurPosAndTrigger(t),i.dragging=!1,i.refresh()}}).on("keydown.pq-scrollbar",function(e){var r=e.keyCode,o=i.options,n=o.cur_pos,a=o.ratio,l=o.num_eles,s=t.ui.keyCode;if(null==i.keydownTimeout&&(i.keydownTimeout=window.setTimeout(function(){r==s.DOWN||r==s.RIGHT?i.incr_cur_pos(e):r==s.UP||r==s.LEFT?i.decr_cur_pos(e):r==s.HOME?o.steps?n>0&&(o.cur_pos=0,i.updateSliderPos(),i.scroll(e)):a>0&&(o.ratio=0,i.updateSliderPos(),i.drag(e)):r==s.END?o.steps?n<l&&(o.cur_pos=l,i.updateSliderPos(),i.scroll(e)):a<1&&(o.ratio=1,i.updateSliderPos(),i.drag(e)):"vertical"==o.direction&&(r==s.PAGE_DOWN?i._pageDown(e):r==s.PAGE_UP&&i._pageUp(e)),i.keydownTimeout=null},0)),r==s.DOWN||r==s.RIGHT||r==s.UP||r==s.LEFT||r==s.PAGE_DOWN||r==s.PAGE_UP||r==s.HOME||r==s.END)return e.preventDefault(),!1})},decr_cur_pos:function(t){var e=this,i=e.options;if(i.steps)i.cur_pos>0&&(i.cur_pos--,e.updateSliderPos(),e.scroll(t));else if(i.ratio>0){var r=i.ratio-1/(i.num_eles-1);r<0&&(r=0),i.ratio=r,e.updateSliderPos(),e.drag(t)}},incr_cur_pos:function(t){var e=this,i=e.options;if(i.steps)i.cur_pos<i.num_eles-1&&i.cur_pos++,e.updateSliderPos(),e.scroll(t);else{if(i.ratio<1){var r=i.ratio+1/(i.num_eles-1);r>1&&(r=1),i.ratio=r}e.updateSliderPos(),e.drag(t)}},_mouseup:function(t){if(!this.options.disabled){window.clearTimeout(this.mousedownTimeout),this.mousedownTimeout=null,window.clearInterval(this.mousedownInterval),this.mousedownInterval=null}},_setDragLimits:function(){var t=this.options;if("vertical"==t.direction){var e=this.element.offset().top+17,i=e+t.length-34-this.slider_length;this.$slider.draggable("option","containment",[0,e,0,i])}else i=(e=this.element.offset().left+17)+t.length-34-this.slider_length,this.$slider.draggable("option","containment",[e,0,i,0])},refresh:function(){var t=this.options,e=this.element;t.num_eles<=1?e.css("display","none"):(e.css("display",""),this._validateCurPos(),this.dragging||(e["vertical"===t.direction?"height":"width"](t.length),this._setSliderBgLength(),this.scroll_space<4||t.num_eles<=1?this.$slider.css("display","none"):this.$slider.css("display","")),this.updateSliderPos())},_setSliderBgLength:function(){var e=this.options,i=e.theme,r=this.$slider,o=e.length,n=(o-34)*o/(40*e.num_eles+o),a=Math.round((n-14)/2);a<1&&(a=1);var l=14+2*a;if(this.scroll_space=e.length-34-l,l!==this.slider_length){this.slider_length=l;var s="vertical"===e.direction?{dim:"height",cls:".vert-slider-bg"}:{dim:"width",cls:".horiz-slider-bg"};i?r[s.dim](l-2):(t(s.cls,this.element)[s.dim](a),r[s.dim](l))}},_updateCurPosAndTrigger:function(t,e){var i=this.options,r=i.direction,o=this.$slider;null==e&&(e=parseInt(o[0].style["vertical"===r?"top":"left"]));var n=(e-17)/(i.length-34-this.slider_length);if(i.steps){var a=n*(i.num_eles-1);if(a=Math.round(a),i.cur_pos!=a){if(this.dragging){if(null!=this.topWhileDrag){if(this.topWhileDrag<e&&i.cur_pos>a)return;if(this.topWhileDrag>e&&i.cur_pos<a)return}this.topWhileDrag=e}this.options.cur_pos=a,this.scroll(t)}}else i.ratio=n,this.drag(t)},_setNormalPace:function(t){this.timer&&(window.clearInterval(this.timer),this.timer=null);var e=this,i=this.options.direction;e.timer=window.setInterval(function(){var r=e.$slider,o=parseInt(r[0].style["vertical"===i?"top":"left"]);e.prev_top===o&&(e._updateCurPosAndTrigger(t,o),window.clearInterval(e.timer),e.timer=null),e.prev_top=o},20)},_validateCurPos:function(){var t=this.options;t.cur_pos>=t.num_eles&&(t.cur_pos=t.num_eles-1),t.cur_pos<0&&(t.cur_pos=0)},_updateSliderPosRatio:function(){var t=this.options,e=t.direction,i=t.ratio,r=this.$slider,o=t.length-34-this.slider_length;if(null==i)throw"ration N/A";var n=i*o+17;"vertical"==e?r.css("top",n):r.css("left",n)},_updateSliderPosCurPos:function(){var t=this.options,e=this.scroll_space*t.cur_pos/(t.num_eles-1);"vertical"==t.direction?this.$slider.css("top",17+e):this.$slider.css("left",17+e)},updateSliderPos:function(){var t=this.options;if(void 0===t.steps)throw"assert failed. steps N/A";t.steps?this._updateSliderPosCurPos():this._updateSliderPosRatio()},scroll:function(t){var e=this.options;this._trigger("scroll",t,{cur_pos:e.cur_pos,num_eles:e.num_eles})},drag:function(t){var e=this.options;this._trigger("drag",t,{ratio:e.ratio})},_pageDown:function(t){this._trigger("pageDown",t,null)},_pageUp:function(t){this._trigger("pageUp",t,null)},_setOption:function(t,e){"disabled"==t?(this._super(t,e),1==e?this.$slider.draggable("disable"):this.$slider.draggable("enable")):"theme"==t?(this._super(t,e),this._createLayout()):"ratio"==t?e>=0&&e<=1&&this._super(t,e):this._super(t,e)},_setOptions:function(){this._super.apply(this,arguments),this.refresh()}};t.widget("paramquery.pqScrollBar",e)}(jQuery),function(t){t.paramquery=t.paramquery||{},t.paramquery.onResize=function(e,i){var r=t(e);"static"===r.css("position")&&r.css("position","relative");var o=t('<iframe type="text/html" src="about:blank" class="pq-resize-iframe" style="display:block;width:100%;height:100%;position:absolute;top:0;left:0;z-index:-1;overflow: hidden; pointer-events: none;" />').appendTo(r);o[0].data="about:blank",o.css("opacity","0");for(var n=0;n<r.length;n++){var a=o[n];t(a.contentWindow).on("resize",function(t){i()})}}}(jQuery),function(t){var e=function(){};e.prototype.belongs=function(t){if(t.target==this.that.element[0])return!0},t.paramquery.cClass=e;var i=function(t){this.that=t,this.hidearrHS1=[],this.options=t.options,this.offset=null};t.paramquery.cGenerateView=i;var r=i.prototype;r.generateView=function(e){var i,r,o=this.that,n=o.options,a=n.freezeCols,l="flex"===n.width,s="flex"===n.height,d=o.colModel,h=o.initH,c=o.finalH,f=n.groupModel,p=o.pqpanes;if(e){var g=this._generateTables(null,null,e);(P=e.$cont).empty(),p.v?P.append(["<div class='pq-grid-cont-inner'>",g,"</div>","<div class='pq-grid-cont-inner'>",g,"</div>"].join("")):P.append("<div class='pq-grid-cont-inner'>"+g+"</div>");var v=P.children("div"),w=v.children("table"),x=o.iRefresh,m=l?"":x.getEContWd(),I=w[0].scrollHeight-1;if(P.height(I),p.v){var _=t(v[0]),b=(w[0].scrollWidth,t(v[1])),y=t(w[1]),q=u.call(o,-1,a),C=u.call(o,a,h);_.css({width:q,zIndex:1}),b.css({left:q-1,width:m-q,height:I}),y.css({left:-1*(C+q)})}else v.css({width:m,height:I});o.tables||(o.tables=[]);for(var R=-1,M=0;M<o.tables.length;M++){o.tables[M].cont==e.$cont[0]&&(R=M)}-1==R?o.tables.push({$tbl:w,cont:e.$cont[0]}):o.tables[R].$tbl=w}else{i=o.initV,r=o.finalV;var D=f?o.dataGM:o.pdata,P=o.$cont;null!=n.editModel.indices&&o.blurEditor({force:!0});g=this._generateTables(i,r,e);if(P.empty(),0===o.totalVisibleRows)P.append("<div class='pq-grid-cont-inner pq-grid-norows' >"+n.strNoRows+"</div>");else{var S=s||l?"style='position:relative;'":"";p.h&&p.v?P[0].innerHTML=["<div class='pq-grid-cont-inner'>",g,"</div>","<div class='pq-grid-cont-inner'>",g,"</div>","<div class='pq-grid-cont-inner'>",g,"</div>","<div class='pq-grid-cont-inner'>",g,"</div>"].join(""):p.v?P[0].innerHTML=["<div class='pq-grid-cont-inner' ",S," >",g,"</div>","<div class='pq-grid-cont-inner' >",g,"</div>"].join(""):p.h?P[0].innerHTML=["<div class='pq-grid-cont-inner' style='position:static;' >",g,"</div>","<div class='pq-grid-cont-inner' style='position:static;' >",g,"</div>"].join(""):P[0].innerHTML=["<div class='pq-grid-cont-inner' ",S," >",g,"</div>"].join("")}o.$tbl=P.children("div").children("table"),n.scrollModel.flexContent&&o.$tbl[0]&&t.paramquery.onResize(o.$tbl[0],function(){var t=o.iRefresh;t.ignoreTResize||(t.refreshScrollbars(),o.iGenerateView.setPanes(),o._saveDims(),o.iMouseSelection.syncScrollBarVert(),"flex"==n.height&&t.setContAndGridHeightFromTable(),"flex"==n.width&&t.setContAndGridWidthFromTable(),t._refreshFrozenLine())}),this.setPanes(),this.setPaneEvents()}e||o._trigger("refresh",null,{dataModel:n.dataModel,colModel:d,pageData:D,initV:i,finalV:r,initH:h,finalH:c}),o._saveDims(),this.scrollView()},r.scrollView=function(){var t=this.that,e=this.options,i=e.virtualX,r=e.virtualXHeader,o=e.virtualY;if(i||"flex"===e.width||t.$hscroll.pqScrollBar("drag"),o||"flex"===e.height||t.$vscroll.pqScrollBar("drag"),!1===r&&t.$hscroll){var n=t.$hscroll.pqScrollBar("option"),a=parseInt(n.cur_pos);t.iMouseSelection.syncHeaderViewWithScrollBarHor(a)}},r.setPaneEvents=function(){var e=this.that,i=e.$cont,r=e.pqpanes,o=i.children("div"),n=e.iMouseSelection,a=e.$tbl;if(a&&a.length)if(r.h&&r.v){var l=t(o[0]),s=t(o[1]),d=t(o[2]),h=t(o[3]);l.on("scroll",function(t){this.scrollTop=0,this.scrollLeft=0}),s.on("scroll",function(t){this.scrollTop=0,this.scrollLeft=n.getScrollLeft()}),d.on("scroll",function(t){this.scrollTop=n.getScrollTop(),this.scrollLeft=0}),h.on("scroll",function(t){this.scrollTop=n.getScrollTop(),this.scrollLeft=n.getScrollLeft()})}else if(r.v){var c=t(o[0]),u=t(o[1]);c.on("scroll",function(t){this.scrollTop=n.getScrollTop(),this.scrollLeft=0}),u.on("scroll",function(t){this.scrollTop=n.getScrollTop(),this.scrollLeft=n.getScrollLeft()})}else if(r.h){var f=t(o[0]),p=t(o[1]);f.on("scroll",function(t){this.scrollTop=0,this.scrollLeft=n.getScrollLeft()}),p.on("scroll",function(t){this.scrollTop=n.getScrollTop(),this.scrollLeft=n.getScrollLeft()})}else o.on("scroll",function(t){this.scrollTop=n.getScrollTop(),this.scrollLeft=n.getScrollLeft()})},r.setPanes=function(){var e=this.that,i=e.$cont,r=e.pqpanes,o=i.children("div"),n=e.iRefresh,a=e.$tbl,l=e.options,s=parseInt(l.freezeCols),d=e.initH;if(a&&a.length){var h="flex"===l.height,c="flex"===l.width,f=h?"":n.getEContHt(),p=c?"":n.getEContWd();if(r.h&&r.v){var g=t(o[0]),v=t(o[1]),w=t(a[1]),x=t(o[2]),m=t(a[2]),I=t(o[3]),_=t(a[3]),b=u.call(e,-1,s),y=(D=e.calcHeightFrozenRows())-1;g.css({width:b,height:y}),v.css({left:b,width:p-b,height:y}),w.css({left:-1*b}),x.css({width:b,top:y,height:f-y}),m.css({marginTop:-D}),I.css({left:b,width:p-b,top:y,height:f-y}),_.css({marginTop:-D,left:-1*b})}else if(r.v){var q=t(o[0]),C=t(o[1]),R=t(a[1]),M=(b=u.call(e,-1,s),u.call(e,s,d));q.css({width:b,height:f}),C.css({left:b,width:p-b,height:f}),R.css({left:-1*(M+b)})}else if(r.h){var D,P=t(o[0]),S=t(o[1]),T=t(a[1]);y=(D=e.calcHeightFrozenRows())-1;P.css({height:y,width:p}),S.css({width:p,top:y,height:f-y}),T.css({marginTop:-D})}else o.css({width:p,height:f})}},r._generateTables=function(t,e,i){var r=this.that,o=r.colModel,n=(o.length,r.options),a=n.virtualX,l=r.initH,s=r.finalH,d=n.numberCell,h=n.columnBorders,c=n.rowBorders,u=n.wrap,f=(n.scrollModel,n.groupModel),p=(r.hidearrHS,n.freezeCols),g=parseInt(n.freezeRows),v=!1,w=0,x=i?i.data.length-1:e,m=!!f,I=(n.treeModel,i&&i.data?i.data:m?r.dataGM:r.pdata),_=r.rowIndxOffset;if(i||r._trigger("beforeTableView",null,{pageData:I,initV:t,finalV:e,initH:l,finalH:s,colModel:o}),i||null!=t&&null!=x){var b="pq-grid-table ";h&&(b+="pq-td-border-right "),c&&(b+="pq-td-border-bottom ");var y=["<table class='"+(b+=u?"pq-wrap ":"pq-no-wrap ")+"' cellpadding=0 cellspacing=0 >"];if(this.hidearrHS1=[],y.push("<tr class='pq-row-hidden'>"),d.show){var q=d.width+1;y.push("<td style='width:"+q+"px;' ></td>")}for(var C=0;C<=s;C++){if(C<l&&C>=p&&(a||i)&&(C=l)>s)throw"initH>finalH";var R=o[C];R.hidden||(q=R.outerWidth,y.push("<td style='width:",q,"px;' pq-col-indx='",C,"'></td>"))}y.push("</tr>"),this.offsetRow=null;for(w=0;w<=x;w++){w<t&&w>=g&&(w=t);var M=I[w],D=m?M.rowIndx-_:w;if(!(!!M&&M.pq_hidden)){v=r.lastFrozenRow===D;if(f&&M.groupTitle)this._generateTitleRow(f,M,y,v);else if(f&&M.groupSummary)this._generateSummaryRow(f,M,o,y,v);else{var P=M.pq_detail&&M.pq_detail.show;this._generateRow(M,D,o,y,i,v,P),P&&this._generateDetailRow(M,D,o,y,i,v)}}}return r.scrollMode=!1,y.push("</table>"),y.join("")}},r._renderCell=function(t,e){this.that;var i=this.options,r=t.rowData,o=t.column,n=o.type,a=o.dataIndx,l=r[a];if(r){var s;if(void 0!=e)s=e;else if("checkBoxSelection"==n)s="<input type='checkbox' "+(l?"checked='checked'":"")+" />";else if("detail"==n){var d=i.detailModel;s="<div class='ui-icon "+(l&&l.show?d.expandIcon:d.collapseIcon)+"'></div>"}else s=l;""!==s&&void 0!=s||(s="&nbsp;");var h,c="";if(t.tree&&(h=i.treeModel)&&h.labelIndx==a){var u=r.pq_leaf,f=r.pq_level,p=!r.pq_collapse,g=["<div class='pq-tree-icon-container' style='width:",(f+1)*h.indent,"px;'>","<div class='ui-icon ",u?h.leafIcon:p?h.expandIcon+" pq-tree-expand-icon":h.collapseIcon+" pq-tree-expand-icon"," pq-tree-icon' ></div></div>"].join("");c="<div class='"+cls+"'>"+g+s+"</div>"}else c=s;return c}},r.renderCell=function(t){var e=this.that,i=this.options,r=t.rowData,o=t.rowIndx,n=t.rowIndxPage,a=t.column,l=t.colIndx,s=a.dataIndx,d=i.freezeCols,h=i.columnBorders,c="pq-col-indx='"+l+"'",u=!1,f="pq-grid-cell ";"right"==a.align?f+=" pq-align-right":"center"==a.align&&(f+=" pq-align-center"),l==d-1&&h&&(f+=" pq-last-frozen-col");var p=a.cls;p&&(f=f+" "+p);var g,v=r.pq_cellselect;v&&(u=v[s]),u&&(f+=" pq-state-select ui-state-highlight"),a.render&&(g=a.render.call(e.element[0],{data:e.pdata,dataModel:i.dataModel,rowData:r,cellData:r[s],rowIndxPage:n,rowIndx:o,colIndx:l,column:a,dataIndx:s}));var w=r.pq_cellcls;if(w){var x=w[s];x&&(f+=" "+x)}var m=r.pq_cellattr;if(m){var I=m[s];if(I)for(var _ in I){var b=I[_];"title"==_&&(b=b.replace(/\"/g,"&quot;")),c+=" "+_+'="'+b+'"'}}return["<td class='",f,"' ",c," >",this._renderCell(t,g),"</td>"].join("")},r.refreshRow=function(t,e,i){var r=this.that,o=r.pdata[t],n=r.lastFrozenRow===t,a=o.pq_detail&&o.pq_detail.show;this._generateRow(o,t,e,i,null,n,a)},r._generateRow=function(t,e,i,r,o,n,a){var l="pq-grid-row";n&&(l+=" pq-last-frozen-row"),a&&(l+=" pq-detail-master");var s=this.that,d=this.options,h=d.freezeCols,c=d.numberCell,u=!!d.treeModel.labelIndx,f=d.virtualX,p=s.initH,g=s.finalH,v=this.offset;d.stripeRows&&e/2==parseInt(e/2)&&(l+=" pq-grid-oddRow"),t.pq_rowselect&&(l+=" pq-row-select ui-state-highlight");var w=t.pq_rowcls;null!=w&&(l+=" "+w);var x=t.pq_rowattr,m="";if(x)for(var I in x){var _=x[I];m+=I+'="'+(_=_.replace('"',"&quot;"))+'"'}r.push("<tr pq-row-indx='",e,"' class='",l,"' ",m," >"),c.show&&r.push(["<td class='pq-grid-number-cell ui-state-default'>",o?"&nbsp;":e+1,"</td>"].join(""));for(var b={rowIndx:e+v,rowIndxPage:e,rowData:t},y=0;y<=g;y++){if(y<p&&y>=h&&(f||o)&&(y=p)>g)throw"initH>finalH";var q=i[y];q.hidden||(b.column=q,b.colIndx=y,b.tree=u,r.push(this.renderCell(b)))}return r.push("</tr>"),r};var o,n,a={widgetEventPrefix:"pqgrid"};a.options={cancel:"input,textarea,button,select,option,.pq-no-capture,.ui-resizable-handle",distance:3,collapsible:{on:!0,toggle:!0,collapsed:!1,_collapsed:!1,refreshAfterExpand:!0,css:{zIndex:1e3}},colModel:null,columnBorders:!0,dataModel:{cache:!1,dataType:"JSON",location:"local",sorting:"local",sortDir:"up",method:"GET"},direction:"",draggable:!1,editable:!0,editModel:{cellBorderWidth:0,pressToEdit:!0,clicksToEdit:2,filterKeys:!0,keyUpDown:!0,reInt:/^([\-]?[1-9][0-9]*|[\-]?[0-9]?)$/,reFloat:/^[\-]?[0-9]*\.?[0-9]*$/,onBlur:"validate",saveKey:t.ui.keyCode.ENTER,onSave:"next",allowInvalid:!1,invalidClass:"pq-cell-red-tr pq-has-tooltip",warnClass:"pq-cell-blue-tr pq-has-tooltip",validate:!0},editor:{select:!1,type:"textbox"},validation:{icon:"ui-icon-alert",cls:"ui-state-error",style:"padding:3px 10px;"},warning:{icon:"ui-icon-info",cls:"",style:"padding:3px 10px;"},freezeCols:0,freezeRows:0,calcDataIndxFromColIndx:!0,height:400,hoverMode:"null",_maxColWidth:"100%",_minColWidth:50,minWidth:100,numberCell:{width:30,title:"",resizable:!0,minWidth:30,maxWidth:100,show:!0},pageModel:{curPage:1,totalPages:0,rPP:10,rPPOptions:[10,20,50,100]},resizable:!1,roundCorners:!0,rowBorders:!0,scrollModel:{pace:"fast",horizontal:!0,lastColumn:"auto",autoFit:!1,theme:!1},selectionModel:{fireSelectChange:!1,type:"cell",mode:"block"},swipeModel:{on:!0,speed:20,ratio:.15,repeat:20},showBottom:!0,showHeader:!0,showTitle:!0,showToolbar:!0,showTop:!0,sortable:!0,sql:!1,stripeRows:!0,title:"&nbsp;",treeModel:null,virtualX:!1,virtualY:!1,width:"auto",wrap:!0,hwrap:!0},a._regional={strAdd:"Add",strDelete:"Delete",strEdit:"Edit",strLoading:"Loading",strNextResult:"Next Result",strNoRows:"No rows to display.",strNothingFound:"Nothing found",strPrevResult:"Previous Result",strSearch:"Search",strSelectedmatches:"Selected {0} of {1} match(es)"},t.extend(a.options,a._regional),a._destroyResizable=function(){this.element.data("resizable")&&this.element.resizable("destroy")},a._disable=function(){null==this.$disable&&(this.$disable=t("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},a._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},a._destroy=function(){this.loading&&this.xhr.abort(),this._destroyResizable(),this._destroyDraggable(),this._mouseDestroy(),this.element.off(this.eventNamespace),t(window).unbind(this.eventNamespace),t(document).unbind(this.eventNamespace),this.element.empty().css("height","").css("width","").removeClass("pq-grid ui-widget ui-widget-content ui-corner-all").removeData()},a.destroy=function(){for(var e in this._trigger("destroy"),this._super(),window.clearInterval(this._refreshEditorPosTimer),this.autoResizeTimeout&&clearTimeout(this.autoResizeTimeout),this)delete this[e];t.fragments={}},a.collapse=function(t){var e=this,i=this.element,r=this.options.collapsible,o=r.$collapse.children("span"),n=function(){i.css("overflow","hidden"),o.addClass("ui-icon-circle-triangle-s").removeClass("ui-icon-circle-triangle-n"),i.hasClass("ui-resizable")&&i.resizable("destroy"),e.$toolbar.pqToolbar("disable"),r.collapsed=!0,r._collapsed=!0,r.animating=!1,e._trigger("collapse")};if(t=t||{},r._collapsed)return!1;r.htCapture=i.height(),!1===t.animate?(i.height(23),n()):(r.animating=!0,i.animate({height:"23px"},function(){n()}))},a.expand=function(t){var e=this,i=this.element,r=this.options.collapsible,o=r.htCapture,n=r.$collapse.children("span"),a=function(){i.css("overflow",""),r._collapsed=!1,r.collapsed=!1,e._refreshResizable(),r.refreshAfterExpand&&e.refresh(),n.addClass("ui-icon-circle-triangle-n").removeClass("ui-icon-circle-triangle-s"),e.$toolbar.pqToolbar("enable"),r.animating=!1,e._trigger("expand")};if(t=t||{},!1===r._collapsed)return!1;!1===t.animate?(i.height(o),a()):(r.animating=!0,i.animate({height:o},function(){a()}))},a._createCollapse=function(){var e=this,i=this.$top,r=this.options.collapsible;if(!r.$stripe){var o=t(["<div class='pq-slider-icon pq-no-capture'  >","</div>"].join("")).appendTo(i);r.$stripe=o}r.on?r.$collapse||(r.$collapse=t(["<div style='float:left;margin-left:5px;' class='pq-collapse'>","<span class='ui-icon ui-icon-circle-triangle-n' style='float:left;'></span>","</div>"].join("")).appendTo(r.$stripe).mouseover(function(e){t(this).addClass("ui-state-hover")}).mouseout(function(e){t(this).removeClass("ui-state-hover")}).click(function(t){r.collapsed?e.expand():e.collapse()})):r.$collapse&&(r.$collapse.remove(),delete r.$collapse),r.collapsed&&!r._collapsed?e.collapse({animate:!1}):!r.collapsed&&r._collapsed&&e.expand({animate:!1}),r.toggle?r.$toggle||(r.$toggle=t(["<div style='float:left;' class='pq-max'>","<span class='ui-icon ui-icon-arrow-4-diag' style='float:left;'></span>","</div>"].join("")).prependTo(r.$stripe).mouseover(function(e){t(this).addClass("ui-state-hover")}).mouseout(function(e){t(this).removeClass("ui-state-hover")}).click(function(t){e.toggle()})):r.$toggle&&(r.$toggle.remove(),delete r.$toggle)},a._create=function(){var e=this,r=this.options;r.collapsible||(r.collapsible={on:!1,collapsed:!1}),r.flexHeight&&(r.height="flex"),r.flexWidth&&(r.width="flex"),this.setEditorPosTimer(),this.iGenerateView=new i(this),this.iRefresh=new t.paramquery.cRefresh(this),this.iKeyNav=new h(this),this.iIsValid=new s(this),this.hidearr=[],this.hidearrHS=[],this.tables=[],this.$tbl=null,this._calcThisColModel(),this.iSort=new t.paramquery.cSort(this),this.iSort._refreshSorters(),this.iHeader=new t.paramquery.cHeader(this),this._initTypeColumns();var o=this.element;o.empty().addClass("pq-grid ui-widget ui-widget-content"+(r.roundCorners?" ui-corner-all":"")).html(["<div class='pq-grid-top ui-widget-header",r.roundCorners?" ui-corner-top":"","'>","<div class='pq-grid-title",r.roundCorners?" ui-corner-top":"","'>&nbsp;</div>","</div>","<div class='pq-grid-center' >","<div class='pq-header-outer ui-widget-header'>","</div>","<div class='pq-grid-cont-outer' >","<div class='pq-grid-cont' tabindex='0'></div>","</div>","</div>","<div class='pq-grid-bottom ui-widget-header",r.roundCorners?" ui-corner-bottom":"","'>","<div class='pq-grid-footer'>&nbsp;</div>","</div>"].join("")),this._trigger("render",null,{dataModel:this.options.dataModel,colModel:this.colModel}),this.$top=t("div.pq-grid-top",o),this.$title=t("div.pq-grid-title",o),r.showTitle||this.$title.css("display","none"),this.$toolbar=t("div.pq-grid-toolbar",o),this.$grid_inner=t("div.pq-grid-center",o),this.$header_o=t("div.pq-header-outer",this.$grid_inner),r.showTop||this.$top.css("display","none"),this.$bottom=t("div.pq-grid-bottom",o),r.showBottom||this.$bottom.css("display","none"),this.$footer=t("div.pq-grid-footer",o),this.$cont_o=t(".pq-grid-cont-outer",this.$grid_inner);var n=this.$cont=t("div.pq-grid-cont",this.$grid_inner);t(window).bind("resize"+e.eventNamespace+" orientationchange"+e.eventNamespace,function(t,i){e.onWindowResize(t,i)}),n.on("click","td.pq-grid-cell",function(i){if(!0!==t.data(i.target,e.widgetName+".preventClickEvent"))return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onClickCell(i):void 0}),n.on("click","tr.pq-grid-row",function(i){if(!0!==t.data(i.target,e.widgetName+".preventClickEvent"))return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onClickRow(i):void 0}),n.on("contextmenu","td.pq-grid-cell",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onRightClickCell(i)}),n.on("contextmenu","tr.pq-grid-row",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onRightClickRow(i)}),n.on("dblclick","td.pq-grid-cell",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onDblClickCell(i)}),n.on("dblclick","tr.pq-grid-row",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onDblClickRow(i)}),n.on("mousedown","td.pq-grid-cell",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onCellMouseDown(i)}),n.on("mousedown","tr.pq-grid-row",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onRowMouseDown(i)}),n.on("mousedown",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onContMouseDown(i)}),n.on("mouseenter","td.pq-grid-cell",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onCellMouseEnter(i,t(this))}),n.on("mouseenter","tr.pq-grid-row",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onRowMouseEnter(i,t(this))}),n.on("mouseleave","td.pq-grid-cell",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onCellMouseLeave(i,t(this))}),n.on("mouseleave","tr.pq-grid-row",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onRowMouseLeave(i,t(this))}),n.bind("mousewheel DOMMouseScroll",function(t){return e._onMouseWheel(t)});this.$hvscroll=t("<div class='pq-hvscroll-square ui-widget-content'></div>").appendTo(this.$grid_inner),this.$vscroll=t("<div class='pq-vscroll'></div>").appendTo(this.$grid_inner),this.prevVScroll=0;var a=r.scrollModel;void 0===a.lastColumn&&r.virtualX&&(a.lastColumn="auto"),this.$vscroll.pqScrollBar({pace:a.pace,theme:a.theme,steps:r.virtualY,direction:"vertical",cur_pos:0,pageDown:function(t,i){e.iKeyNav.pageDown()},pageUp:function(t,i){e.iKeyNav.pageUp()},drag:function(t,i){r.virtualY||e.iMouseSelection.syncViewWithScrollBarVert(i.ratio)},scroll:function(t,i){if(r.virtualY){e.scrollMode=!0;var o=e.iRefresh;o.calcInitFinal(),e.iGenerateView.generateView(),o._setScrollVNumEles()<=1&&o.refreshScrollbars()}}});var l=this.$hscroll=t("<div class='pq-hscroll'></div>").appendTo(this.$grid_inner);"flex"===r.height&&l.css("position","relative"),l.pqScrollBar({direction:"horizontal",pace:a.pace,theme:a.theme,steps:r.virtualX,cur_pos:0,drag:function(t,i){r.virtualX||e.iMouseSelection.syncViewWithScrollBarHor(i.ratio)},scroll:function(t,i){var o=r.virtualX,n=r.virtualXHeader,a=!1!==n;o&&e.refresh({header:a}),!1===n&&e.iMouseSelection.syncHeaderViewWithScrollBarHor(i.cur_pos)}}),r.selectionModel.native||this.disableSelection(),window.opera?this.$grid_inner.bind("keypress.pq-grid",{that:this},function(i){t(i.target).closest(".pq-grid")[0]==e.element[0]&&e._onKeyPressDown(i)}):this.$grid_inner.bind("keydown.pq-grid",{that:this},function(i){t(i.target).closest(".pq-grid")[0]==e.element[0]&&e._onKeyPressDown(i)}),this._refreshTitle(),this.iRows=new t.paramquery.cRows(this),this.iCells=new t.paramquery.cCells(this),this.generateLoading(),this._initPager(),this._refreshResizable(),this._refreshDraggable(),this.iResizeColumns=new t.paramquery.cResizeColumns(this),this._mouseInit()},a.toggle=function(){var e,i=this.options,r=i.collapsible,o=this.element,n=t(document.body);if("fixed"==o.css("position")){var a=this.maxim.eleObj,l=this.maxim.docObj;this.option({height:a.height,width:a.width}),o.css({position:a.position,left:a.left,top:a.top,margin:a.margin,zIndex:a.zIndex}),n.css({height:l.height,width:l.width,overflow:l.overflow}),t("html").css({overflow:"visible"}),window.scrollTo(l.scrollLeft,l.scrollTop),e="min"}else{a={height:i.height,width:i.width,position:o.css("position"),left:o.css("left"),top:o.css("top"),margin:o.css("margin"),zIndex:o.css("zIndex")};this.option({height:"100%-2",width:"100%-2"}),o.css(t.extend({position:"fixed",left:0,top:0,margin:0},r.css));l={height:n.height(),width:n.width(),overflow:n.css("overflow"),scrollLeft:t(window).scrollLeft(),scrollTop:t(window).scrollTop()};t(document.body).css({height:0,width:0,overflow:"hidden"}),t("html").css({overflow:"hidden"}),window.scrollTo(0,0),this.maxim={eleObj:a,docObj:l},e="max"}this._trigger("toggle",null,{state:e}),this._refreshResizable(),this.refresh(),t(window).trigger("resize",{$grid:o,state:e})},a._mouseCapture=function(e){var i=this.options;if(i.virtualX&&i.virtualY)return!1;if(!e.target)return!1;if(t(e.target).closest(".pq-grid")[0]==this.element[0]){if("flex"==i.height&&"flex"==i.width)return!1;var r=i.swipeModel;return!(0==r.on||"touch"==r.on&&!t.support.touch)}return!1},a._saveDims=function(){this.$cont;var e=this.$tbl;if(e)for(var i=0;i<e.length;i++){var r=e[i],o=t(r);o.data("offsetHeight",Math.round(r.offsetHeight)),o.data("scrollWidth",Math.round(r.scrollWidth))}var n=this.$tbl_header;if(n)for(i=0;i<n.length;i++){r=n[i];var a=t(r).parent();a.data("offsetHeight",Math.round(r.offsetHeight)),a.data("scrollWidth",Math.round(r.scrollWidth))}},a._mousePQUp=function(e){t(document).unbind("mouseup"+this.eventNamespace,this._mousePQUpDelegate),this._trigger("mousePQUp",e,null)},a._mouseDown=function(e){var i=this;return t(e.target).closest(".pq-editor-focus").length?(this._blurEditMode=!0,void window.setTimeout(function(){i._blurEditMode=!1},0)):(this._saveDims(),this._mousePQUpDelegate=function(t){return i._mousePQUp(t)},t(document).bind("mouseup"+this.eventNamespace,this._mousePQUpDelegate),this._super(e))},a._mouseStart=function(t){return this.blurEditor({force:!0}),!0},a._mouseDrag=function(t){return 0!=this._trigger("mouseDrag",t,null)},a._mouseStop=function(t){return 0!=this._trigger("mouseStop",t,null)},a.onWindowResize=function(e,i){var r,a,l=this.options,s=this.element,d=s.parent();if(i){var h=i.$grid;if(h&&(h==s||0==s.closest(h).length))return}if(d.length&&(d[0]==document.body||"fixed"==s.css("position")?(r=window.innerHeight?window.innerHeight:t(window).height(),a=t(window).width()):(r=d.height(),a=d.width()),!(null!=o&&r==o&&a==n||(o=r,n=a,t.support.touch&&l.editModel.indices&&t(document.activeElement).is(".pq-editor-focus"))))){var c=this,u=void 0===(u=l.autoSizeInterval)?0:u;this.autoResizeTimeout&&(clearTimeout(this.autoResizeTimeout),delete this.autoResizeTimeout),this.autoResizeTimeout=window.setTimeout(function(){c._refreshAfterResize(),delete c.autoResizeTimeout},u)}},a._onMouseWheel=function(t){this._saveDims();var e=this.options,i=0,r=!1,o=(t=t.originalEvent).wheelDeltaX,n=t.wheelDeltaY,a=t.wheelDelta;if(o&&Math.abs(o)>Math.abs(n)){if("flex"==e.width)return!0;r=!0,i=o/120}else if(a){if("flex"==e.height)return!0;i=a/120}else if(t.detail){if("flex"==e.height)return!0;i=-1*t.detail/3}var l=r?this.$hscroll:this.$vscroll,s=l.pqScrollBar("option"),d=parseInt(s.cur_pos),h=parseInt(s.num_eles);if(r&&e.virtualX||!r&&e.virtualY){d-(i=i>0?Math[i<1?"ceil":"floor"](i):Math[i<-1?"ceil":"floor"](i))>=0&&(l.pqScrollBar("option","cur_pos",d-i),l.pqScrollBar("scroll"))}else{var c=s.ratio-i/(h-1);c>1?c=1:c<0&&(c=0),l.pqScrollBar("option","ratio",c),l.pqScrollBar("drag")}return!1},a._onDblClickCell=function(e){var i=this,r=t(e.currentTarget),o=i.getCellIndices({$td:r}),n=o.rowIndxPage,a=n+i.rowIndxOffset,l=o.colIndx;if(null!=l)return 0!=i._trigger("cellDblClick",e,{$td:r,rowIndxPage:n,rowIndx:a,colIndx:l,column:i.colModel[l],rowData:i.pdata[n]})&&void(i.options.editModel.clicksToEdit>1&&this.isEditableRow({rowIndx:a})&&this.isEditableCell({colIndx:l,rowIndx:a})&&i.editCell({rowIndxPage:n,colIndx:l}))},a._onClickCont=function(t){},a._onClickRow=function(e){var i=t(e.currentTarget),r=parseInt(i.attr("pq-row-indx")),o=r+this.rowIndxOffset;if(!isNaN(r)){this.options;return 0!=this._trigger("rowClick",e,{$tr:i,rowIndxPage:r,rowIndx:o,rowData:this.pdata[r]})&&void 0}},a._onRightClickRow=function(e){var i=t(e.currentTarget),r=parseInt(i.attr("pq-row-indx")),o=r+this.rowIndxOffset;if(!isNaN(r)){this.options;return 0!=this._trigger("rowRightClick",e,{$tr:i,rowIndxPage:r,rowIndx:o,rowData:this.pdata[r]})&&void 0}},a._onDblClickRow=function(e){var i=t(e.currentTarget),r=parseInt(i.attr("pq-row-indx")),o=r+this.getRowIndxOffset();if(0==this._trigger("rowDblClick",e,{$tr:i,rowIndxPage:r,rowIndx:o,rowData:this.pdata[r]}))return!1},t.paramquery.getValueFromDataType=function(e,i,r){var o;if("date"==i)return o=Date.parse(e),isNaN(o)?"":r?o:e;if("integer"==i)o=parseInt(e);else{if("float"!=i)return"bool"==i?0==(o=t.trim(e).toLowerCase()).length?null:"true"==o||"yes"==o||"1"==o||"false"!=o&&"no"!=o&&"0"!=o&&Boolean(o):t.trim(e);o=parseFloat(e)}return isNaN(o)||null==o?null==e?e:null:o};var l,s=function(t){this.that=t},d=s.prototype;d._isValidCell=function(e){var i=this.that,r=e.column,o=r.validations;if(!o||!o.length)return{valid:!0};var n=e.value,a=r.dataType,l=function(e){return t.paramquery.getValueFromDataType(e,a,!0)},s=e.rowData;if(!s)throw"rowData required.";for(var d=0;d<o.length;d++){var h=o[d],c=h.on,u=h.type,f=!1,p=h.msg,g=h.value;if(!1!==c){if(null==n&&"function"!=typeof u)f=!1;else if("minLen"==u)n=l(n),g=l(g),n.length>=g&&(f=!0);else if("nonEmpty"==u)null!=n&&""!==n&&(f=!0);else if("maxLen"==u)n=l(n),g=l(g),n.length<=g&&(f=!0);else if("gt"==u)(n=l(n))>(g=l(g))&&(f=!0);else if("gte"==u)(n=l(n))>=(g=l(g))&&(f=!0);else if("lt"==u)(n=l(n))<(g=l(g))&&(f=!0);else if("lte"==u)(n=l(n))<=(g=l(g))&&(f=!0);else if("neq"==u)(n=l(n))!==(g=l(g))&&(f=!0);else if("regexp"==u)new RegExp(g).test(n)&&(f=!0);else if("function"==typeof u){var v={column:r,value:n,rowData:s,msg:p};0==u.call(i.element[0],v)?(f=!1,v.msg!=p&&(p=v.msg)):f=!0}else f=!0;if(!f)return{valid:!1,msg:p,column:r,warn:h.warn,dataIndx:r.dataIndx,validation:h}}}return{valid:!0}},d.isValidCell=function(e){var i=this.that,r=e.rowData,o=e.rowIndx,n=e.value,a=e.valueDef,l=e.column,s=i.options,d=e.allowInvalid,h=l.dataIndx,c=s.validation,u=s.warning,f=s.editModel,p=f.invalidClass,g=f.warnClass,v=document.activeElement;if(e.checkEditable&&0==i.isEditableCell({rowData:r,rowIndx:o,dataIndx:h}))return{valid:!0};var w=this._isValidCell({column:l,value:n,rowData:r}),x=w.valid,m=w.warn,I=w.msg;if(x)i.data({rowData:r,dataIndx:h,data:"pq_valid"})&&(i.removeClass({rowData:r,rowIndx:o,dataIndx:h,cls:g+" "+p}),i.removeData({rowData:r,dataIndx:h,data:"pq_valid"}));else var _=t.extend({},m?u:c,w.validation),b=_.css,y=_.cls,q=_.icon,C=_.style;if(d||m)return x?{valid:!0}:(i.addClass({rowData:r,rowIndx:o,dataIndx:h,cls:m?g:p}),i.data({rowData:r,dataIndx:h,data:{pq_valid:{css:b,icon:q,style:C,msg:I,cls:y}}}),w);if(!x){if(null==(o=null==o?i.getRowIndx({rowData:r}).rowIndx:o))return w;if(a){if(t(v).hasClass("pq-editor-focus")){var R=s.editModel.indices;if(R){var M=R.rowIndx,D=R.dataIndx;if(null!=o&&o!=M)throw"incorrect usage of isValid rowIndx: "+o;if(h!=D)throw"incorrect usage of isValid dataIndx: "+h;i.editCell({rowIndx:M,dataIndx:h})}}}else i.goToPage({rowIndx:o}),i.editCell({rowIndx:o,dataIndx:h});var P;if((P=i.getEditCell())&&P.$cell){(S=P.$cell).attr("title",I);try{S.tooltip("destroy")}catch(t){}S.tooltip({position:{my:"left center+5",at:"right center"},content:function(){return(""==q?"":"<span class='ui-icon "+q+" pq-tooltip-icon'></span>")+I},open:function(t,e){if(y&&e.tooltip.addClass(y),C){var i=e.tooltip.attr("style");e.tooltip.attr("style",i+";"+C).css("zIndex",S.zIndex()+5)}b&&e.tooltip.css(b)}}).tooltip("open")}return w}if(a&&(P=i.getEditCell())&&P.$cell){var S;(S=P.$cell).removeAttr("title");try{S.tooltip("destroy")}catch(t){}}return{valid:!0}},a.isValid=function(t){return this.iIsValid.isValid(t)},d.isValid=function(t){var e=this.that,i=(t=t||{}).allowInvalid,r=t.checkEditable;i=null!=i&&i;if(null!=(u=t.dataIndx)){var o=e.columns[u],n=t.rowData||e.getRowData(t),a=t.hasOwnProperty("value"),l=a?t.value:n[u];return(f=this.isValidCell({rowData:n,checkEditable:r,rowIndx:t.rowIndx,value:l,valueDef:a,column:o,allowInvalid:i})).valid||f.warn?{valid:!0}:f}if(null!=t.rowIndx||null!=t.rowIndxPage||null!=t.rowData){n=t.rowData||e.getRowData(t);for(var s=e.colModel,d=[],h=0,c=s.length;h<c;h++){if(!(o=s[h]).hidden){var u,f;l=n[u=o.dataIndx];if(!(f=this.isValidCell({rowData:n,value:l,column:o,rowIndx:t.rowIndx,checkEditable:r,allowInvalid:i})).valid&&!f.warn){if(!i)return f;d.push({rowData:n,dataIndx:u,column:o})}}}return i&&d.length?{cells:d,valid:!1}:{valid:!0}}var p=t.data?t.data:e.options.dataModel.data;d=[];if(!p)return null;for(h=0,c=p.length;h<c;h++){var g;n=p[h];if(!r||(g=this.getRowIndx({rowData:n}).rowIndx,0!=e.isEditableRow({rowData:n,rowIndx:g}))){var v=this.isValid({rowData:n,rowIndx:g,checkEditable:r,allowInvalid:i});if(!1===i){if(!v.valid)return v}else d=d.concat(v.cells)}}return i&&d.length?{cells:d,valid:!1}:{valid:!0}},a.isEditableRow=function(t){var e=this.options.editable;if(null!=e){if("function"==typeof e){var i=t.rowIndx,r=t.rowData||this.getRowData({rowIndx:i});return e.call(this.element[0],{rowData:r,rowIndx:i})}return e}return!0},a.isEditableCell=function(t){var e=t.colIndx,i=t.dataIndx,r=(e=null==e?this.getColIndx({dataIndx:i}):e,this.colModel[e]),o=(i=null==i?r.dataIndx:i,r.editable);if(t.checkVisible&&r.hidden)return!1;if(null!=o){if("function"==typeof o){var n=t.rowIndx,a=t.rowData||this.getRowData(t);return o.call(this.element[0],{rowIndx:n,rowData:a,column:r,dataIndx:i})}return o}return!0},a._getRowPQData=function(t,e,i){return(i=null==i?this.pdata[t]:i)?i[e]:null},a._setRowPQData=function(t,e,i){if(i=null==i?this.pdata[t]:i)for(var r in e)i[r]=e[r]},a._onContMouseDown=function(e){this.blurEditor({blurIfFocus:!0});var i={dataModel:this.options.dataModel};if(!1===this._trigger("contMouseDown",e,i))return!1;var r=t(e.target),o=r.closest(".pq-grid-cell"),n=r.closest(".pq-grid-row");return o.length||n.length||this.$cont.attr("tabindex",0).focus(),!0},a._onCellMouseDown=function(e){var i=t(e.currentTarget),r=this.getCellIndices({$td:i});return r.$td=i,r.dataModel=this.options.dataModel,0!=this._trigger("cellMouseDown",e,r)},a._onRowMouseDown=function(e){var i=t(e.currentTarget),r=this.getRowIndx({$tr:i});return r.$tr=i,r.dataModel=this.options.dataModel,0!=this._trigger("rowMouseDown",e,r)},a._onCellMouseEnter=function(t,e){var i=e,r=this.options,o=this.getCellIndices({$td:i});if(null!=o.rowIndx&&null!=o.colIndx)return!1!==this._trigger("cellMouseEnter",t,o)&&("cell"==r.hoverMode&&this.highlightCell(i),!0)},a._onRowMouseEnter=function(t,e){var i=e,r=this.options,o=this.getRowIndx({$tr:i}),n=o.rowIndxPage;return!1!==this._trigger("rowMouseEnter",t,o)&&("row"==r.hoverMode&&this.highlightRow(n),!0)},a._onCellMouseLeave=function(t,e){var i=e;return"cell"==this.options.hoverMode&&this.unHighlightCell(i),!0},a._onRowMouseLeave=function(t,e){var i=e,r=this.getRowIndx({$tr:i}).rowIndxPage;return"row"==this.options.hoverMode&&this.unHighlightRow(r),!0},a.enableSelection=function(){this.element.removeClass("pq-disable-select").off("selectstart"+this.eventNamespace)},a.disableSelection=function(){this.element.addClass("pq-disable-select").on("selectstart"+this.eventNamespace,function(e){if(e.target){var i=t(e.target);return!!i.is("input,textarea,select")||(!!i.closest(".pq-native-select").length||void e.preventDefault())}})},a._onCellMouseUp=function(e){var i=t(e.currentTarget),r=this.getCellIndices({$td:i});return r.$td=i,r.dataModel=this.options.dataModel,0!=this._trigger("cellMouseUp",e,r)},a._onRowMouseUp=function(e){var i=t(e.currentTarget),r=this.getRowIndx({$tr:i});return 0!=this._trigger("rowMouseUp",e,r)},a._onClickCell=function(e){var i=this,r=this.options,o=this.colModel,n=r.editModel,a=(r.selectionModel,t(e.currentTarget)),l=i.getCellIndices({$td:a}),s=l.rowIndxPage,d=s+i.rowIndxOffset,h=l.colIndx;if(l.rowIndx=d,null!=h){var c=o[h],u=c.dataIndx;if(l.dataIndx=u,l.evt=e,0==i._trigger("cellClick",e,{$td:a,rowIndxPage:s,rowIndx:d,colIndx:h,dataIndx:u,column:c,rowData:i.pdata[s]}))return!1;1==n.clicksToEdit&&this.isEditableRow({rowIndx:d})&&this.isEditableCell({colIndx:h,rowIndx:d})&&i.editCell(l)}},a._onRightClickCell=function(e){var i=t(e.currentTarget),r=this.getCellIndices({$td:i}),o=r.rowIndxPage,n=o+this.rowIndxOffset,a=r.colIndx,l=this.colModel;this.options.DM;if(null!=a){var s=l[a],d=s.dataIndx;return 0!=this._trigger("cellRightClick",e,{$td:i,rowIndxPage:o,rowIndx:n,colIndx:a,dataIndx:d,column:s,rowData:this.pdata[o]})&&void 0}},a.highlightCell=function(t){t.addClass("pq-grid-cell-hover ui-state-hover")},a.unHighlightCell=function(t){t.removeClass("pq-grid-cell-hover ui-state-hover")},a.highlightRow=function(t){if(isNaN(t));else{var e=this.getRow({rowIndxPage:t});e&&e.addClass("pq-grid-row-hover ui-state-hover")}},a.unHighlightRow=function(t){if(isNaN(t));else{var e=this.getRow({rowIndxPage:t});e&&e.removeClass("pq-grid-row-hover ui-state-hover")}},a._getCreateEventData=function(){return{dataModel:this.options.dataModel,data:this.pdata,colModel:this.options.colModel}},a._findCellFromEvt=function(e){var i=t(e.target).closest(".pq-grid-cell");if(null==i||0==i.length)return{rowIndxPage:null,colIndx:null,$td:null};var r=this.getCellIndices({$td:i});return r.$td=i,r},a._initPager=function(){var t=this,e={change:function(e,i){t.blurEditor({force:!0});var r=t.options.pageModel;void 0!=i.curPage&&(r.prevPage=r.curPage,r.curPage=i.curPage),void 0!=i.rPP&&(r.rPP=i.rPP),"remote"==r.type?t.remoteRequest({callback:function(){t._onDataAvailable({apply:!0,header:!1})}}):t.refreshView({header:!1})},refresh:function(e){t.refreshDataAndView()}};this.options.pageModel.type&&this.$footer.pqPager(e)},a.generateLoading=function(){this.$loading&&this.$loading.remove(),this.$loading=t("<div class='pq-loading'></div>").appendTo(this.element),t(["<div class='pq-loading-bg'></div><div class='pq-loading-mask ui-state-highlight'><div>",this.options.strLoading,"...</div></div>"].join("")).appendTo(this.$loading),this.$loading.find("div.pq-loading-bg").css("opacity",.2)},a._refreshLoadingString=function(){this.$loading.find("div.pq-loading-mask").children("div").html(this.options.strLoading)},a.showLoading=function(){null==this.showLoadingCounter&&(this.showLoadingCounter=0),this.showLoadingCounter++,this.$loading.show()},a.hideLoading=function(){this.showLoadingCounter>0&&this.showLoadingCounter--,this.showLoadingCounter||this.$loading.hide()},a.refreshDataFromDataModel=function(){this._trigger("beforeRefreshData",null,{});var t=this.options,e=t.dataModel,i=t.pageModel,r=e.data,o=i.type;if(this.rowIndxOffset=0,null==r||0==r.length)return o&&(i.curPage=0,i.totalPages=0,i.totalRecords=0),void(this.pdata=r);if(o&&"local"==o){i.totalRecords=r.length,i.totalPages=Math.ceil(r.length/i.rPP),i.curPage>i.totalPages&&(i.curPage=i.totalPages),i.curPage<1&&i.totalPages>0&&(i.curPage=1);var n=(i.curPage-1)*i.rPP;(a=i.curPage*i.rPP)>r.length&&(a=r.length),this.pdata=r.slice(n,a)}else if("remote"==o){var a,l=Math.ceil(i.totalRecords/i.rPP);i.totalPages=l,l&&!i.curPage&&(i.curPage=1),(a=i.rPP)>r.length&&(a=r.length),this.pdata=r.slice(0,a)}else t.backwardCompat?this.pdata=r.slice(0):this.pdata=r;"local"!=o&&"remote"!=o||(this.rowIndxOffset=i.rPP*(i.curPage-1))},t.paramquery.filter={conditions:l={begin:{text:"Begins With",TR:!0,string:!0},between:{text:"Between",TR:!0,string:!0,date:!0,number:!0},notbegin:{text:"Does not begin with",TR:!0,string:!0},contain:{text:"Contains",TR:!0,string:!0},notcontain:{text:"Does not contain",TR:!0,string:!0},equal:{text:"Equal To",TR:!0,string:!0,bool:!0},notequal:{text:"Not Equal To",TR:!0,string:!0},empty:{text:"Empty",TR:!1,string:!0,bool:!0},notempty:{text:"Not Empty",TR:!1,string:!0,bool:!0},end:{text:"Ends With",TR:!0,string:!0},notend:{text:"Does not end with",TR:!0,string:!0},less:{text:"Less Than",TR:!0,number:!0,date:!0},lte:{text:"Less than or equal",TR:!0,number:!0,date:!0},range:{TR:!0,string:!0,number:!0,date:!0},regexp:{TR:!0,string:!0,number:!0,date:!0},great:{text:"Great Than",TR:!0,number:!0,date:!0},gte:{text:"Greater than or equal",TR:!0,number:!0,date:!0}},getAllConditions:function(){var t=[];for(var e in l)t.push(e);return t}(),getConditions:function(t){var e=[];for(var i in l)l[i][t]&&e.push(i);return e},getTRConditions:function(){var t=[];for(var e in l)l[e].TR&&t.push(e);return t}(),getWTRConditions:function(){var t=[];for(var e in l)l[e].TR||t.push(e);return t}()},t.paramquery.filter.rules={},t.paramquery.filter.rules.en={begin:"Begins With",between:"Between",notbegin:"Does not begin with",contain:"Contains",notcontain:"Does not contain",equal:"Equal To",notequal:"Not Equal To",empty:"Empty",notempty:"Not Empty",end:"Ends With",notend:"Does not end with",less:"Less Than",lte:"Less than or equal",great:"Great Than",gte:"Greater than or equal"},a.getQueryStringSort=function(){var t=this.iSort.sorters,e="",i=this.options,r=i.sql,o=i.stringify;if(r){for(var n=0;n<t.length;n++){var a=t[n],l=a.dataIndx,s="up"==a.dir?"asc":"desc";e+=(n>0?", ":"")+l+" "+s}return e}return t.length?!1===o?t:JSON.stringify(t):""},a.getQueryStringCRUD=function(){return""},a.getQueryStringFilter=function(){var e=this.options,i=e.sql,r=e.stringify,o=e.filterModel,n=o.mode,a=this.colModel,l=this.getFilterData({CM:a,location:"remote"}),s="";if(o&&o.on&&l)if(i){s=[];for(var d=0;d<l.length;d++){var h=l[d],c=h.condition,u=h.dataIndx,f=t.trim(h.value);"contain"===c?s.push(u+" like '%"+f+"%'"):"notcontain"===c?s.push(u+" not like '%"+f+"%'"):"begin"===c?s.push(u+" like '"+f+"%'"):"end"===c?s.push(u+" like '%"+f+"'"):"equal"===c?s.push(u+"='"+f+"'"):"notequal"===c?s.push(u+"!='"+f+"'"):"empty"===c?s.push("isnull("+u+",'')=''"):"notempty"===c?s.push("isnull("+u+",'')!=''"):"less"===c?s.push(u+"<'"+f+"'"):"great"===c&&s.push(u+">'"+f+"'")}s=s.join(" "+n+" ")}else if(l.length){var p={mode:n,data:l};s=!1===r?p:JSON.stringify(p)}else s="";return s},a.remoteRequest=function(e){this.loading&&this.xhr.abort();var i=this,r="",o="",n=this.options,a=!1,l=this.colModel,s=n.dataModel,d=n.filterModel,h=n.pageModel;if("function"==typeof s.getUrl){var c={colModel:l,dataModel:s,groupModel:n.groupModel,pageModel:h,filterModel:d},u=s.getUrl.call(this.element[0],c);u&&u.url&&(r=u.url),u&&u.data&&(o=u.data)}else if("string"==typeof s.url){r=s.url;var f,p={},g={},v={};if("remote"==s.sorting){var w=this.getQueryStringSort();w&&(p={pq_sort:w})}"remote"==h.type&&(v={pq_curpage:h.curPage,pq_rpp:h.rPP}),"local"!=d.type&&(f=this.getQueryStringFilter())&&(a=!0,g={pq_filter:f});var x=s.postData,m=s.postDataOnce;x&&"function"==typeof x&&(x=x.call(this.element[0],{colModel:l,dataModel:s})),o=t.extend({pq_datatype:s.dataType},g,v,p,x,m)}r&&(this.loading=!0,this.showLoading(),this.xhr=t.ajax({url:r,dataType:s.dataType,async:null==s.async||s.async,cache:s.cache,contentType:s.contentType,type:s.method,data:o,beforeSend:function(t,e){if("function"==typeof s.beforeSend)return s.beforeSend.call(i.element[0],t,e)},success:function(t,r,o){if("function"==typeof s.getData){var n=s.getData.call(i.element[0],t,r,o);s.data=n.data,h.type&&"remote"==h.type&&(n.curPage&&(h.curPage=n.curPage),n.totalRecords&&(h.totalRecords=n.totalRecords))}else s.data=t.data,h.type&&"remote"==h.type&&(t.curPage&&(h.curPage=t.curPage),t.totalRecords&&(h.totalRecords=t.totalRecords));i.hideLoading(),i.loading=!1,e&&e.callback&&e.callback(),i._trigger("load",null,{dataModel:s,colModel:l}),a&&i._trigger("filter",null,{type:"remote",dataModel:s,colModel:l,filterModel:d})},error:function(t,e,r){if(i.hideLoading(),i.loading=!1,"function"==typeof s.error)s.error.call(i.element[0],t,e,r);else if("abort"!=r)throw"Error : "+r}}))},a._refreshTitle=function(){this.$title.html(this.options.title)},a._destroyDraggable=function(){var t=this.element,e=t.parent(".pq-wrapper");e.length&&e.data("draggable")&&(e.draggable("destroy"),this.$title.removeClass("pq-draggable pq-no-capture"),t.unwrap(".pq-wrapper"))},a._refreshDraggable=function(){var t=this.options,e=this.element,i=this.$title;t.draggable?(i.addClass("pq-draggable pq-no-capture"),e.parent(".pq-wrapper").length||e.wrap("<div class='pq-wrapper' />"),e.parent(".pq-wrapper").draggable({handle:i})):this._destroyDraggable()},a._refreshResizable=function(){var e=this,i=this.element,r=this.options,o=(r.width+"").indexOf("%")>-1,n=(r.height+"").indexOf("%")>-1,a="auto"==r.width,l="flex"==r.width,s="flex"==r.height;if(!r.resizable||(s||n)&&(l||o||a))this._destroyResizable();else{var d="e,s,se";s||n?d="e":(l||o||a)&&(d="s");var h=!0;if(i.hasClass("ui-resizable"))d==i.resizable("option","handles")?h=!1:this._destroyResizable();h&&i.resizable({helper:"ui-state-default",handles:d,minWidth:r.minWidth,minHeight:r.minHeight?r.minHeight:100,delay:0,start:function(e,i){t(i.helper).css({opacity:.5,background:"#ccc",border:"1px solid steelblue"})},resize:function(t,e){},stop:function(i,o){var n=e.element,a=r.width,l=r.height,s=(a+"").indexOf("%")>-1,d="auto"==a,h="flex"==a,c=!1;(l+"").indexOf("%")>-1||"flex"==l||(c=!0,r.height=n.height()),s||d||h||(c=!0,r.width=n.width()),e.refresh(),n.css("position","relative"),c&&t(window).trigger("resize")}})}},a._refreshAfterResize=function(){var t=this.options,e=t.width,i=t.height,r=-1!=(e+"").indexOf("%"),o="auto"===e,n=-1!=(i+"").indexOf("%");(r||o||n)&&this.refresh()},a.refresh=function(t){this.iRefresh._refresh(t)},a._refreshDataIndices=function(){for(var t="JSON"==this.getDataType(),e={},i={},r={},o=this.colModel,n=o.length,a=0;a<n;a++){var l=o[a],s=l.dataIndx;null==s&&(s=t?"dataIndx_"+a:a,l.dataIndx=s),e[s]=l,i[s]=a,l.validations&&(r[s]=r)}this.columns=e,this.colIndxs=i,this.validations=r},a.refreshView=function(t){null!=this.options.editModel.indices&&this.blurEditor({force:!0}),this.refreshDataFromDataModel(),this.refresh(t)},a._refreshPager=function(){var t=this.options,e=t.pageModel,i=this.$footer,r=!!e.type,o=e.rPP,n=e.totalRecords;if(r){var a=t.pageModel;0==i.hasClass("pq-pager")&&this._initPager(),i.pqPager("option",a),n>o&&this.$bottom.css("display","")}else i.hasClass("pq-pager")&&i.pqPager("destroy"),t.showBottom?this.$bottom.css("display",""):this.$bottom.css("display","none")},a.getInstance=function(){return{grid:this}},a._addRowsData=function(t){var e=t.data,i=this.options.dataModel.data,r=t.rowIndx;if(null==i&&(i=[]),null==r)for(var o=0,n=e.length;o<n;o++){var a=e[o];i.push(a)}else{if(!(r<i.length))return!1;for(o=0,n=e.length;o<n;o++){a=e[o];i.splice(r,0,a),r++}}return!0},a.addRows=function(t){return!!this._addRowsData(t)&&(this.refreshDataFromDataModel(),this.refresh(),!0)},a.refreshDataAndView=function(t){var e=this.options.dataModel;if(this.iSort._refreshSorters(),"remote"==e.location){var i=this;this.remoteRequest({callback:function(){i._onDataAvailable(t)}})}else this._onDataAvailable(t)},a.getColIndx=function(t){var e=t.dataIndx;if(void 0===e)throw"dataIndx NA";for(var i=this.colModel,r=0,o=i.length;r<o;r++)if(i[r].dataIndx==e)return r},a.getColumn=function(t){if(null==t.dataIndx)throw"dataIndx N/A";return this.columns[t.dataIndx]},a._onDataAvailable=function(){},a._setOption=function(t,e){var i=this.options;if("height"===t){if("flex"===e){var r=this.$vscroll;e&&r&&r.hasClass("pq-sb-vert")&&(i.virtualY?r.pqScrollBar("option","cur_pos",0):r.pqScrollBar("option","ratio",0)),this.$hscroll.css("position","relative")}else"flex"===i.height&&this.$hscroll.css("position","");this._super(t,e)}else if("width"===t&&"flex"==e){this._super(t,e);var o=this.$hscroll;e&&o&&o.hasClass("pq-sb-horiz")&&(i.virtualX?o.pqScrollBar("option","cur_pos",0):o.pqScrollBar("option","ratio",0))}else"title"==t?(this._super(t,e),this._refreshTitle()):"roundCorners"==t?(this._super(t,e),e?(this.element.addClass("ui-corner-all"),this.$top.addClass("ui-corner-top"),this.$bottom.addClass("ui-corner-bottom")):(this.element.removeClass("ui-corner-all"),this.$top.removeClass("ui-corner-top"),this.$bottom.removeClass("ui-corner-bottom"))):"freezeCols"==t?(e=parseInt(e),!isNaN(e)&&e>=0&&e<=this.colModel.length-2&&this._super(t,e)):"freezeRows"==t?(e=parseInt(e),!isNaN(e)&&e>=0&&this._super(t,e)):"resizable"==t?(this._super(t,e),this._refreshResizable()):"draggable"==t?(this._super(t,e),this._refreshDraggable()):"scrollModel"==t?this._super(t,e):"dataModel"==t?this._super(t,e):"pageModel"==t?this._super(t,e):"selectionModel"===t?this._super(t,e):"colModel"===t||"columnTemplate"==t?(this._super(t,e),this._calcThisColModel()):"disabled"===t?(this._super(t,e),!0===e?this._disable():this._enable()):"numberCell"===t?(this._super(t,e),this.iRefresh.decidePanes()):"strLoading"===t?(this._super(t,e),this._refreshLoadingString()):"showTop"===t?(this._super(t,e),!0===e?this.$top.css("display",""):this.$top.css("display","none")):"showTitle"===t?(this._super(t,e),!0===e?this.$title.css("display",""):this.$title.css("display","none")):"showToolbar"===t?(this._super(t,e),!0===e?this.$toolbar.css("display",""):this.$toolbar.css("display","none")):"toolbar"==t?(this._super(t,e),this.$toolbar.remove(),this._super(t,e),this._createToolbar()):"collapsible"===t?(this._super(t,e),this._createCollapse()):"showBottom"===t?(this._super(t,e),!0===e?this.$bottom.css("display",""):this.$bottom.css("display","none")):this._super(t,e)},a._generateCellRowOutline=function(){var e=this.options,i=e.editModel;if(this.$div_focus){if(e.debug)throw"this.$div_focus already present assert failed"}else{var r=this.element;i.inline&&(r=this.getCell(i.indices)).css("padding",0).empty(),this.$div_focus=t(["<div class='pq-editor-outer'>","<div class='pq-editor-inner'>","</div>","</div>"].join("")).appendTo(r),this.$div_focus.css("zIndex",r.zIndex()+5);var o=t.extend({all:!0},i.indices),n=this.getCell(o);n.css("height",n.height()),n.empty(),this.refreshEditorPos()}},a._removeCellRowOutline=function(e){if(this.$div_focus){var i=this.$div_focus.find(".pq-editor-focus");if((a=i).hasClass("hasDatepicker")&&a.datepicker("hide").datepicker("destroy"),i[0]==document.activeElement){var r=this._blurEditMode;this._blurEditMode=!0,i.blur(),this._blurEditMode=r}this.$div_focus.remove(),delete this.$div_focus;var o=this.options.editModel,n=t.extend({},o.indices);o.indices=null,this.refreshCell(n)}var a},a.refreshEditorPos=function(){var t=this.options.editModel,e=t.cellBorderWidth,i=this.$div_focus,r=this.getCell(t.indices);if(!r)return!1;var o=r[0].offsetWidth-(e?2*e:1),n=r[0].offsetHeight-(e?2*e:1),a=this.element.offset(),l=r.offset(),s=l.left-a.left-1,d=l.top-a.top-1;i.css({height:n,width:o,borderWidth:e,left:s,top:d})},a.setEditorPosTimer=function(){var t=this,e=this.options;this._refreshEditorPosTimer&&(window.clearInterval(this._refreshEditorPosTimer),this._refreshEditorPosTimer=null),this._refreshEditorPosTimer=window.setInterval(function(){e.editModel.indices&&t.refreshEditorPos()},200)},a._selectRow=function(t,e){this.selectRow(t,e)},a._findfirstUnhiddenColIndx=function(){for(var t=0;t<this.colModel.length;t++)if(!this.colModel[t].hidden)return t},a.selectRow=function(t){var e=t.evt;if(!e||"keydown"!=e.type&&"keypress"!=e.type){if(0==this.iRows.add(t))return!1}else if(0==this.iRows.replace(t))return!1;return!0},a.get$Tbl=function(e,i){var r=this.$tbl,o=[];if(r&&r.length){var n=this.pqpanes,a=this.options,l=a.freezeRows,s=a.freezeCols;return n.h&&n.v?null==i?e>=l?o.push(r[2],r[3]):o.push(r[0],r[1]):o=i>=s&&e>=l?r[3]:i<s&&e>=l?r[2]:i>=s&&e<l?r[1]:r[0]:o=n.v?null==i?r:i>=s?r[1]:r[0]:n.h&&e>=l?r[1]:r[0],o?t(o):void 0}},a.scrollCell=function(t){this.scrollRow(t),this.scrollColumn(t)},a.scrollY=function(t){this.$vscroll.pqScrollBar("option","cur_pos",t).pqScrollBar("scroll")},a.scrollRow=function(t){var e=this.options;if(!this.pdata||t.rowIndxPage>=this.pdata.length||"flex"===e.height)return!1;e.virtualY?this._scrollRowVirtual(t):this.iMouseSelection.scrollRowNonVirtual(t)},a._scrollRowVirtual=function(t){var e=this.options,i=t.rowIndxPage,r=!!this.iHierarchy,o=t.rowIndx,n=this.scrollCurPos,a=(i=null==i?o-this.rowIndxOffset:i,parseInt(e.freezeRows));if(!(i<a)){var l=this._calcCurPosFromRowIndxPage(i);if(null!=l){l<n&&this.$vscroll.pqScrollBar("option","cur_pos",l).pqScrollBar("scroll");var s=this.get$Tbl(i);if(!s||!s.length)return null;var d=(I=s.children("tbody").children("tr[pq-row-indx="+i+"]")).last(),h=d;I.length>1&&(h=I.first());var c=d[0],u=parseInt(s.css("marginTop"));if(void 0==c)this.$vscroll.pqScrollBar("option","cur_pos",l).pqScrollBar("scroll");else{var f=c.offsetTop+c.offsetHeight,p=this.$cont[0].offsetHeight,g=u,v=this._getSBHeight(),w=h.prev("tr");if(w.hasClass("pq-row-hidden")||w.hasClass("pq-last-frozen-row"))return;if(f>p-v-g){var x,m=f-(p-v-g),I=s.children().children("tr"),_=0,b=0;for(a?0==(x=I.filter("tr.pq-last-frozen-row").last().next()).length&&(x=I.filter("tr.pq-row-hidden").next()):x=I.filter("tr.pq-row-hidden").next();;){if(_+=x[0].offsetHeight,x[0]==d[0])break;if(r&&0!=x.hasClass("pq-detail-child")){if(_>=m)break}else if(b++,_>=m)break;x=x.next()}var y=n+b;y>l&&(y=l);var q=this.$vscroll.pqScrollBar("option","num_eles");q<y+1&&(q=y+1),this.$vscroll.pqScrollBar("option",{num_eles:q,cur_pos:y}).pqScrollBar("scroll")}}}}},a.blurEditor=function(t){if(this.$div_focus){var e=this.$div_focus.find(".pq-editor-focus");if(!t||!t.blurIfFocus)return e.triggerHandler("blur",t);document.activeElement==e[0]&&e.blur()}},a._scrollColumnVirtual=function(t){var e=null==(e=t.colIndx)?this.getColIndx({dataIndx:t.dataIndx}):e,i=this.options.freezeCols,r=this._calcRightEdgeCol(e).width,o=this._getSBWidth(),n=this.$cont[0].offsetWidth-o;if(r>n){for(var a=u.call(this,-1,e+1)-n,l=this.colModel,s=l.length,d=0,h=0,c=i;c<s;c++){var f=l[c];if(f.hidden||(d+=f.outerWidth),c==e){h=c-i-this._calcNumHiddenUnFrozens(c);break}if(d>=a){h=c-i-this._calcNumHiddenUnFrozens(c)+1;break}}return this.$hscroll.pqScrollBar("option","cur_pos",h).pqScrollBar("scroll"),!0}if(this.hidearrHS[e]){this.hidearrHS[e]=!1;var p=e-i-this._calcNumHiddenUnFrozens(e);return this.$hscroll.pqScrollBar("option","cur_pos",p).pqScrollBar("scroll"),!0}return!1},a.scrollColumn=function(t){var e=this.options,i=e.virtualX;return"flex"!==e.width&&(i?this._scrollColumnVirtual(t):this.iMouseSelection.scrollColumnNonVirtual(t))},a.selection=function(t){var e=t.method,i=t.type;return"row"==i?this.iRows[e](t):"cell"==i?this.iCells[e](t):void 0},a._bringPageIntoView=function(t){var e=t.rowIndx,i=this.options.pageModel;if("local"==i.type&&e>=0){var r=i.curPage,o=i.rPP;e>=(r-1)*o&&e<r*o||(i.curPage=Math.ceil((e+1)/o),this.refreshDataFromDataModel(),this.refresh())}},a.goToPage=function(t){var e=this.options.pageModel;if("local"==e.type||"remote"==e.type){var i=t.rowIndx,r=e.rPP,o=null==t.page?Math.ceil((i+1)/r):t.page;o!=e.curPage&&(e.curPage=o,"local"==e.type?(this.refreshDataFromDataModel(),this.refresh()):this.refreshDataAndView())}},a.setSelection=function(t){if(null==t)return this.iRows.removeAll({raiseEvent:!0}),this.iCells.removeAll({raiseEvent:!0}),!1;var e=this.pdata;if(t.rowData)r=this.getRowIndx(t).rowIndx;else{var i=this.rowIndxOffset,r=t.rowIndx,o=t.rowIndxPage;r=null==r?o+i:r}var n=null==t.colIndx&&void 0!==t.dataIndx?this.getColIndx({dataIndx:t.dataIndx}):t.colIndx;t.evt;return!(r<0||n<0||n>=this.colModel.length)&&(null!=e&&0!=e.length&&(t.rowIndx=r,t.colIndx=n,this._bringPageIntoView(t),o=r-this.rowIndxOffset,t.rowIndxPage=o,this.scrollRow({rowIndxPage:o}),null==n?this._selectRow(t):(this.scrollColumn({colIndx:n}),this.selectCell(t))))},a.getColModel=function(){return this.colModel},a.saveEditCell=function(e){var i=this.options,r=i.editModel;if(!r.indices)return null;var o,n=t.extend({},r.indices),a=e?e.evt:null,l=this.rowIndxOffset,s=n.colIndx,d=n.rowIndxPage,h=d+l,c=this.colModel[s],u=c.dataIndx,f=this.pdata[d],p=i.dataModel;if(null==f)return null;if(null!=d){var g=this.getEditCellData();if(t.isPlainObject(g))for(var v in o={},g)o[v]=f[v];else o=f[u];"<br>"==g&&(g=""),null==o&&""===g&&(g=null);var w={rowIndx:h,rowIndxPage:d,dataIndx:u,column:c,newVal:g,value:g,oldVal:o,rowData:f,dataModel:p};if(!1===this._trigger("cellBeforeSave",a,w))return!1;var x={},m=!1;if(t.isPlainObject(g)?(x=g,m=!0):x[u]=g,!1===this.updateRow({row:x,rowIndx:h,refresh:m,silent:!0,source:"edit",checkEditable:!1}))return!1;this._trigger("cellSave",a,w);return"flex"==i.height?(this.iRefresh.setContAndGridHeightFromTable(),this._fixIEFooterIssue()):e&&this.scrollRow({rowIndxPage:d}),!0}},a._addInvalid=function(t){},a._digestData=function(e){if(!1===this._trigger("beforeValidate",null,e))return!1;var i=this,r=i.options,o=r.editModel,n=r.dataModel,a=n.data,l=r.colModel,s=r.pageModel,d=r.historyModel,h=null==(h=e.validate)?o.validate:h,c=s.type,u=null==(u=e.allowInvalid)?o.allowInvalid:u,f=(o.invalidClass,r.trackModel),p=null==(p=e.track)?null==r.track?f.on:r.track:p,g=null==(g=e.history)?d.on:g,v=null==(v=e.checkEditable)||v,w=null==(w=e.checkEditableAdd)?v:w,x=this.columns,m=this.colIndxs,I=e.source,_=this.rowIndxOffset,b=t.paramquery.getValueFromDataType,y=e.rowList,q=y.length;a||(a=r.dataModel.data=[]);for(var C=[],R=0;R<q;R++){var M=(N=y[R]).newRow,D=N.rowData,P=N.type,S=N.checkEditable,T=N.rowIndx,$=N.oldRow;if(null==S&&("update"==P?S=v:"add"==P&&(S=w)),"update"==P){if(!$||!D)throw"assert failed: oldRow and rowData required while update";if(S&&!0!==r.editable&&!1===i.isEditableRow({rowIndx:T,rowData:D}))continue}else if("delete"==P){C.push(N);continue}if("add"==P)for(var H=0,k=l.length;H<k;H++){M[E=(V=l[H]).dataIndx]=M[E]}for(var E in M){var V=x[E],z=m[E];if(V){if(S&&null!=V.editable&&!1===i.isEditableCell({rowIndx:T,colIndx:z,dataIndx:E})){delete M[E];continue}var W=V.dataType,F=b(M[E],W),A=void 0!==(A=D?D[E]:void 0)?b(A,W):void 0;if(M[E]=F,h&&V.validations)if("edit"==I&&!1===u){if(0==(L=this.isValid({dataIndx:E,rowIndx:T,value:F})).valid&&!L.warn)return!1}else{var L,O="add"==P?M:D;!1===(L=this.iIsValid.isValidCell({column:V,rowData:O,allowInvalid:u,value:F})).valid&&(!1!==u||L.warn||delete M[E])}if("update"==P&&F===A){if("edit"==I)return null;delete M[E];continue}}"update"==P&&($[E]=A)}if(M)if("update"==P)for(var E in M){C.push(N);break}else C.push(N)}if(!(q=(y=e.rowList=C).length))return!1;g&&(i.iHistory.increment(),i.iHistory.push({rowList:y}));for(R=0;R<q;R++){P=(N=y[R]).type,M=N.newRow,T=N.rowIndx;var N,B=N.rowIndxPage;D=N.rowData;if("update"==P)for(var E in p&&this.iUCData.update({rowData:D,row:M,refresh:!1}),M){F=M[E];D[E]=F}else if("add"==P){if(p&&this.iUCData.add({rowData:M}),null==T&&null==B)a.push(M);else{B=T-_;var j="remote"==c?B:T;a.splice(j,0,M)}"remote"==c&&s.totalRecords++}else if("delete"==P){var U=i.getRowIndx({rowData:D}),G=U.uf;T=U.rowIndx;p&&this.iUCData.delete({rowIndx:T,rowData:D});B=T-_,j="remote"==c?B:T;if(G)n.dataUF.splice(j,1);else{var K=a.splice(j,1);K&&K.length&&"remote"==c&&s.totalRecords--}}}return i._trigger("change",null,e),!0},a._fixTableViewPort=function(){this.iGenerateView.setPanes();var t=this.element[0];t.scrollTop=0,t.scrollLeft=0;var e=this.$header_o[0];e.scrollLeft=0,e.scrollTop=0},a._fixIEFooterIssue=function(){t(".pq-grid-footer").css({position:"absolute"}),t(".pq-grid-footer").css({position:"relative"})},a.refreshColumn=function(t){var e=this.colModel,i=t.colIndx,r=t.dataIndx,o=(i=null==i?this.getColIndx({dataIndx:r}):i,r=null==r?e[i]:r,this.rowIndxOffset);t.colIndx=i;for(var n=this.initV,a=this.finalV,l=n;l<=a;l++){var s=l;t.rowIndx=s+o,t.rowIndxPage=s,t.colIndx=i,t.column=e[i],t.skip=!0,this.refreshCell(t)}this._fixTableViewPort(),this.iRefresh.refreshScrollbars(),this._trigger("refreshColumn",null,{dataModel:this.options.dataModel,colModel:e,initV:n,finalV:a,colIndx:i,dataIndx:r})},a.refreshCell=function(t){if(this.pdata){var e=this.rowIndxOffset,i=t.skip,r=t.rowIndx,o=t.rowIndxPage,n=(r=t.rowIndx=null==r?o+e:r,o=t.rowIndxPage=null==o?r-e:o,t.dataIndx),a=t.colIndx,l=(a=t.colIndx=null==a?this.getColIndx({dataIndx:n}):a,this.getCell({all:!0,rowIndxPage:o,colIndx:a})),s=t.column,d=this.colModel,h=(s=t.column=s||d[a],this.options.treeModel),c=this.pdata[o];if(c){var u=t;if(u.tree=!!h.labelIndx,u.rowData=c,l&&l.length>0){var f=this.iGenerateView.renderCell(u);l.replaceWith(f),i||(this._fixTableViewPort(),this.iRefresh.refreshScrollbars(),this._trigger("refreshCell",null,{dataModel:this.options.dataModel,colModel:d,rowData:c,rowIndx:r,rowIndxPage:o,colIndx:a,dataIndx:n}))}}}},a.refreshRow=function(e){if(this.pdata){var i=this.rowIndxOffset,r=e.rowIndx,o=e.rowIndxPage,n=(r=null==r?o+i:r,o=null==o?r-i:o,this.getRow({all:!0,rowIndxPage:o})),a=this.colModel,l=this.pdata[o],s=!1,d=document.activeElement;t(d);if((d==n[0]||n.length>1&&d==n[1])&&(s=!0),!l||!n||!n.length)return null;var h=[];this.iGenerateView.refreshRow(o,a,h,null,null,l.pq_detail&&l.pq_detail.show);var c=h.join("");if(n.replaceWith(c),this._fixTableViewPort(),this.iRefresh.refreshScrollbars(),s)this.getRow({all:!0,rowIndxPage:o}).attr("tabindex",0).focus();return this._trigger("refreshRow",null,{rowData:l,rowIndx:r,rowIndxPage:o}),!0}},a.quitEditMode=function(t){if(!this._quitEditMode){var e=!1,i=!1,r=!1,o=this.options.editModel,n=o.indices,a=void 0;this._quitEditMode=!0,t&&(e=t.old,i=t.silent,r=t.fireOnly,a=t.evt),n&&(i||e||this._trigger("editorEnd",a,n),r||(this._removeCellRowOutline(t),o.indices=null)),this._quitEditMode=null}},a._fixIE=function(){var t=this.$cont[0];t.scrollLeft=0,t.scrollTop=0},a.getViewPortRowsIndx=function(){return{beginIndx:this.initV,endIndx:this.finalV}},a.getViewPortIndx=function(){return{initV:this.initV,finalV:this.finalV,initH:this.initH,finalH:this.finalH}},a.getRowIndxOffset=function(){return this.rowIndxOffset},a.selectCell=function(t){var e=t.evt;if(!e||"keydown"!=e.type&&"keypress"!=e.type){if(!1===this.iCells.add(t))return!1}else if(0==this.iCells.replace(t))return!1;return!0},a.getEditCell=function(){var t=this.options.editModel;if(t.indices){var e=this.getCell(t.indices),i=this.$div_focus.children(".pq-editor-inner");return{$td:e,$cell:i,$editor:i.find(".pq-editor-focus")}}return null},a.editCell=function(t){this.scrollRow(t),this.scrollColumn(t);var e=this.getCell(t);if(e&&e.length)return this._editCell(t)},a.getFirstEditableColIndx=function(t){if(null==t.rowIndx)throw"rowIndx NA";if(!this.isEditableRow(t))return-1;for(var e=this.colModel,i=0;i<e.length;i++)if(t.colIndx=i,this.isEditableCell(t)&&!e[i].hidden)return i;return-1},a.editFirstCellInRow=function(t){var e=this.rowIndxOffset,i=t.rowIndx,r=t.rowIndxPage,o=(i=null==i?r+e:i,r=null==r?i-e:r,this.getFirstEditableColIndx({rowIndx:i}));-1!=o&&this.editCell({rowIndxPage:r,colIndx:o})},a._editCell=function(e){var i=this,r=e.evt,o=this.rowIndxOffset,n=e.rowIndxPage,a=null==(a=e.rowIndx)?n+o:a,l=(n=null==n?a-o:n,e.colIndx),s=e.dataIndx,d=(l=null==l?this.getColIndx({dataIndx:s}):l,this.colModel[l]),h=(s=d.dataIndx,d.editor),c=this.options,u=c.editModel,f=c.editor,p=h?t.extend({},f,h):f,g=i.pdata[n],v=!1;if(!this.pdata||n>=this.pdata.length)return!1;if(u.indices){var w=u.indices;if(w.rowIndxPage==n&&w.colIndx==l){this.refreshEditorPos();var x=this.$div_focus.find(".pq-editor-focus");return window.setTimeout(function(){x.focus()},0),!1}if(!1===this.blurEditor({evt:r}))return!1;this.quitEditMode({evt:r})}u.indices={rowIndxPage:n,rowIndx:a,colIndx:l,column:d,dataIndx:s},this._generateCellRowOutline();var m=this.$div_focus.children(".pq-editor-inner");"right"==d.align?m.addClass("pq-align-right"):"center"==d.align?m.addClass("pq-align-center"):m.addClass("pq-align-left");var I,_,b=g[s],y=p.type,q=null==e.select?p.select:e.select,C=p.init,R=p.valueIndx,M=p.dataMap,D=(D=p.mapIndices)||{},P="pq-editor-focus "+(p.cls?p.cls:""),S=P+" pq-cell-editor ",T=p.attr?p.attr:"",$=(_=(_=p.style)||"")?"style='"+_+"'":"",H=m.width()-8,k="style='width:"+H+"px;"+_+"'",E=_?"style='"+_+"'":"",V={rowIndx:a,rowIndxPage:n,$cell:m,cellData:b,rowData:g,cls:P,dataIndx:s,column:d};if("function"==typeof y)I=y.call(i.element[0],V);else if("checkbox"==y){var z=p.subtype;I="<input "+(b?"checked='checked'":"")+" class='"+S+"' "+T+" "+E+" type=checkbox name='"+s+"' />",m.html(I);var W=m.children("input");"triple"==z&&(W.pqval({val:b}),m.click(function(e){t(this).children("input").pqval({incr:!0})}))}else if("textarea"==y||"select"==y||"textbox"==y){if("textarea"==y)I="<textarea class='"+S+"' "+T+" "+k+" name='"+s+"' ></textarea>";else if("select"==y){var F;"function"==typeof(F=(F=p.options)||[])&&(F=F.call(i.element[0],{column:d,rowData:g}));var A=[T," class='",S,"' ",k," name='",s,"'"].join("");I=t.paramquery.select({options:F,attr:A,prepend:p.prepend,labelIndx:p.labelIndx,valueIndx:R,groupIndx:p.groupIndx,dataMap:M})}else I="<input class='"+S+"' "+T+" "+k+" type=text name='"+s+"' />";t(I).appendTo(m).width(H).val("select"==y&&null!=R&&(D[R]||this.columns[R])?D[R]?g[D[R]]:g[R]:b)}else I="<div contenteditable='true' tabindx='0' "+$+" "+T+" class='pq-editor-default "+P+"'></div>",m.html(I),m.children().html(b),v=!0;"function"==typeof C&&C.call(i.element[0],V);i=this,x=m.children(".pq-editor-focus");var L=u.filterKeys,O=d.editModel;O&&void 0!==O.filterKeys&&(L=O.filterKeys);var N={$cell:m,$editor:x,dataIndx:s,column:d,colIndx:l,rowIndx:a,rowIndxPage:n,rowData:g};if(u.indices=N,x.data({FK:L}).on("click",function(e){t(this).focus()}).on("keydown",function(t){i.iKeyNav._keyDownInEdit(t)}).on("keypress",function(t){return i.iKeyNav._keyPressInEdit(t,{FK:L})}).on("keyup",function(t){return i.iKeyNav._keyUpInEdit(t,{FK:L})}).on("blur",function(e,r){var o=i.options.editModel,n=o.onBlur,a="save"==n,l="validate"==n,s=o.cancelBlurCls,d=!!r&&r.force;if(!i._quitEditMode&&!i._blurEditMode&&o.indices){var h=t(e.target);if(!d){if(!1===i._trigger("editorBlur",e,N))return;if(!n)return;if(s&&h.hasClass(s))return;if(h.hasClass("hasDatepicker")){if(h.datepicker("widget").is(":visible"))return!1}else if(h.hasClass("ui-autocomplete-input")){if(h.autocomplete("widget").is(":visible"))return}else if(h.hasClass("ui-multiselect")){if(t(".ui-multiselect-menu").is(":visible")||t(document.activeElement).closest(".ui-multiselect-menu").length)return}else if(h.hasClass("pq-select-button")&&(t(".pq-select-menu").is(":visible")||t(document.activeElement).closest(".pq-select-menu").length))return}i._blurEditMode=!0;var c=d||a||!l;if(!i.saveEditCell({evt:e,silent:c})&&!d&&l)return i._deleteBlurEditMode(),!1;i.quitEditMode({evt:e}),i._deleteBlurEditMode()}}).on("focus",function(t){i._trigger("editorFocus",t,N)}),i._trigger("editorBegin",r,N),x.focus(),window.setTimeout(function(){!1===t(document.activeElement).hasClass("pq-editor-focus")&&i.element.find(".pq-editor-focus").focus()},0),i.element[0].scrollLeft=0,i.element[0].scrollTop=0,q)if(v)try{var B=x[0],j=document.createRange();j.selectNodeContents(B);var U=window.getSelection();U.removeAllRanges(),U.addRange(j)}catch(t){}else x.select()},a._deleteBlurEditMode=function(t){var e=this;t=t||{};e._blurEditMode&&(t.timer?window.setTimeout(function(){delete e._blurEditMode},0):delete e._blurEditMode)},a.getRow=function(t){var e,i=t.rowIndxPage,r=t.rowIndx,o=this.rowIndxOffset,n=(i=null==i?r-o:i,t.all?this.$tbl:this.get$Tbl(i));if(n&&n.length){var a=n.children("tbody");null!=i&&(e=a.children("tr[pq-row-indx="+i+"]")).length>n.length&&(e=e.filter(".pq-detail-master"))}return e},a.getCell=function(e){var i=e.rowIndxPage,r=e.rowIndx,o=(i=null==i?r-this.rowIndxOffset:i,e.colIndx),n=e.dataIndx,a=(o=null==o?this.getColIndx({dataIndx:n}):o,e.all?this.$tbl:this.get$Tbl(i,o));return a&&a.length?a.children().children("tr[pq-row-indx="+i+"]").children("td[pq-col-indx="+o+"]"):t()},a.getCellHeader=function(e){var i=e.colIndx,r=e.dataIndx,o=(i=null==i?this.getColIndx({dataIndx:r}):i,this.$tbl_header),n=this.options.freezeCols;if(void 0!=o){o.length>1&&(o=t(i>=n?o[1]:o[0]));var a=o.children().children("tr.pq-grid-title-row:last").children("td[pq-col-indx="+i+"]")}return 0==a.length||"hidden"==a[0].style.visibility?null:a},a.getEditorIndices=function(){var e=this.options.editModel.indices;return e?t.extend({},e):null},a.getEditCellData=function(){var e=this.options,i=e.editModel.indices;if(!i)return null;var r,o=i.colIndx,n=i.rowIndxPage,a=i.rowIndx,l=this.colModel[o],s=l.editor,d=e.editor,h=s?t.extend({},d,s):d,c=h.valueIndx,u=h.labelIndx,f=(f=h.mapIndices)||{},p=l.dataIndx,g=this.$div_focus.children(".pq-editor-inner");if("function"==typeof h.getData)r=h.getData.call(this.element[0],{$cell:g,rowData:i.rowData,dataIndx:p,rowIndx:a,rowIndxPage:n,column:l});else{var v=h.type;if("checkbox"==v){var w=g.children();r="triple"==h.subtype?w.pqval():!!w.is(":checked")}else{var x;if("contenteditable"==v)r=g.children().html();else if((x=g.find('*[name="'+p+'"]'))&&x.length)if("select"==v&&null!=c)if(f[c]||this.columns[c]){(r={})[f[c]?f[c]:c]=x.val(),r[f[u]?f[u]:u]=x.find("option:selected").text();var m=h.dataMap;if(m){var I=x.find("option:selected").data("map");if(I)for(var _=0;_<m.length;_++){var b=m[_];r[f[b]?f[b]:b]=I[b]}}}else r=x.val();else r=x.val();else(x=g.find(".pq-editor-focus"))&&x.length&&(r=x.val())}}return r},a.getCellIndices=function(t){var e=t.$td;if(null==e||0==e.length||e.closest(".pq-grid")[0]!=this.element[0])return{rowIndxPage:null,colIndx:null};var i,r=e.parent("tr").attr("pq-row-indx");null!=r&&(i=(r=parseInt(r))+this.rowIndxOffset);var o,n=e.attr("pq-col-indx");return null!=n&&(n=parseInt(n),o=this.colModel[n].dataIndx),{rowIndxPage:r,rowIndx:i,colIndx:n,dataIndx:o}},a.getRowsByClass=function(t){var e=this.options,i=e.dataModel,r="remote"==e.pageModel.type,o=this.rowIndxOffset,n=i.data,a=[];if(null==n)return a;for(var l=0,s=n.length;l<s;l++){var d=n[l];if(t.rowData=d,this.hasClass(t)){var h={rowData:d};h.rowIndx=r?l+o:l,a.push(h)}}return a},a.getCellsByClass=function(t){var e=this.options,i=e.dataModel,r="remote"==e.pageModel.type,o=this.rowIndxOffset,n=i.data,a=this.colModel,l=a.length,s=[],d=function(t){for(var e=0;e<l;e++){var i=a[e].dataIndx;if(t.dataIndx=i,this.hasClass(t)){var r={rowData:t.rowData,dataIndx:i,colIndx:e,rowIndx:t.rowIndx};s.push(r)}}};if(null==n)return s;if(null!=t.rowIndx||null!=t.rowIndxPage||null!=t.rowData)t.rowData=t.rowData||this.getRowData(t),null==t.rowIndx&&(t.rowIndx=this.getRowIndx({rowData:u})),d(t);else for(var h=0,c=n.length;h<c;h++){var u=n[h];t.rowData=u,t.rowIndx=r?h+o:h,d(t)}return s},a.data=function(e){var i=e.dataIndx,r=e.data,o=null==r||"string"==typeof r,n=e.rowData||this.getRowData(e);if(!n)return null;if(null==i){var a=n.pq_rowdata;if(o)return null!=a&&(d=null==r?a:a[r]),{data:d};var l=t.extend(!0,n.pq_rowdata,r);n.pq_rowdata=l}else{var s=n.pq_celldata;if(o){var d;if(null!=s){var h=s[i];d=null==r||null==h?h:h[r]}return{data:d}}s||(n.pq_celldata={});l=t.extend(!0,n.pq_celldata[i],r);n.pq_celldata[i]=l}},a.attr=function(e){var i=e.rowIndx,r=e.dataIndx,o=e.attr,n=null==o||"string"==typeof o,a=this.rowIndxOffset,l=e.refresh,s=e.rowData||this.getRowData(e);if(!s)return null;if(n||!1===l||null!=i||(i=this.getRowIndx({rowData:s}).rowIndx),null==r){var d=s.pq_rowattr;if(n)return null!=d&&(f=null==o?d:d[o]),{attr:f};var h=t.extend(s.pq_rowattr,o);if(s.pq_rowattr=h,!1!==l&&null!=i){var c=this.getRow({rowIndxPage:i-a});c&&c.attr(h)}}else{var u=s.pq_cellattr;if(n){var f;if(null!=u){var p=u[r];f=null==o||null==p?p:p[o]}return{attr:f}}u||(s.pq_cellattr={});h=t.extend(s.pq_cellattr[r],o);if(s.pq_cellattr[r]=h,!1!==l&&null!=i){var g=this.getCell({rowIndxPage:i-a,dataIndx:r});g&&g.attr(h)}}},a.removeData=function(e){var i,r=e.dataIndx,o="string"==typeof(i=null==(i=e.data)?[]:i)?i.split(" "):i,n=o.length,a=e.rowData||this.getRowData(e);if(a)if(null==r){var l=a.pq_rowdata;if(l){if(n)for(var s=0;s<n;s++){delete l[o[s]]}n&&!t.isEmptyObject(l)||delete a.pq_rowdata}}else{var d=a.pq_celldata;if(d&&d[r]){var h=d[r];if(n)for(s=0;s<n;s++){delete h[o[s]]}n&&!t.isEmptyObject(h)||delete d[r]}}},a.removeAttr=function(e){var i,r=e.rowIndx,o=e.dataIndx,n="string"==typeof(i=null==(i=e.attr)?[]:i)?i.split(" "):i,a=n.length,l=r-this.rowIndxOffset,s=e.refresh,d=e.rowData||this.getRowData(e);if(d)if(!1!==s&&null==r&&(r=this.getRowIndx({rowData:d}).rowIndx),null==o){var h=d.pq_rowattr;if(h){if(a)for(var c=0;c<a;c++){delete h[u=n[c]]}else for(var u in h)n.push(u);a&&!t.isEmptyObject(h)||delete d.pq_rowattr}if(!1!==s&&null!=r&&n.length){i=n.join(" ");var f=this.getRow({rowIndxPage:l});f&&f.removeAttr(i)}}else{var p=d.pq_cellattr;if(p&&p[o]){var g=p[o];if(a)for(c=0;c<a;c++){delete g[u=n[c]]}else for(var u in g)n.push(u);a&&!t.isEmptyObject(g)||delete p[o]}if(!1!==s&&null!=r&&n.length){i=n.join(" ");var v=this.getCell({rowIndxPage:l,dataIndx:o});v&&v.removeAttr(i)}}},t.paramquery.uniqueArray=function(e){for(var i=[],r=t.inArray,o=0,n=e.length;o<n;o++){var a=e[o];-1==r(a,i)&&i.push(a)}return i},a.addClass=function(e){var i=e.rowIndx,r=e.dataIndx,o=t.paramquery.uniqueArray,n=e.cls,a=this.rowIndxOffset,l=e.refresh,s=e.rowData||this.getRowData(e);if(s)if(!1!==l&&null==i&&(i=this.getRowIndx({rowData:s}).rowIndx),null==r){var d=s.pq_rowcls;if(g=o((g=d?d+" "+n:n).split(/\s+/)).join(" "),s.pq_rowcls=g,!1!==l&&null!=i){var h=this.getRow({rowIndxPage:i-a});h&&h.addClass(n)}}else{var c=[];"function"!=typeof r.push?c.push(r):c=r;var u=s.pq_cellcls;u||(u=s.pq_cellcls={});for(var f=0,p=c.length;f<p;f++){var g,v=u[r=c[f]];if(g=o((g=v?v+" "+n:n).split(/\s+/)).join(" "),u[r]=g,!1!==l&&null!=i){var w=this.getCell({rowIndxPage:i-a,dataIndx:r});w&&w.addClass(n)}}}},a.removeClass=function(t){var e=t.rowIndx,i=this.getRowData(t),r=t.dataIndx,o=t.cls,n=t.refresh;if(i){var a=i.pq_cellcls,l=i.pq_rowcls;if(!1!==n&&null==e&&(e=this.getRowIndx({rowData:i}).rowIndx),null==r){if(l&&(i.pq_rowcls=this._removeClass(l,o),null!=e&&!1!==n)){var s=this.getRow({rowIndx:e});s&&s.removeClass(o)}}else if(a){var d=[];"function"!=typeof r.push?d.push(r):d=r;for(var h=0,c=d.length;h<c;h++){var u=a[r=d[h]];if(u&&(i.pq_cellcls[r]=this._removeClass(u,o),null!=e&&!1!==n)){var f=this.getCell({rowIndx:e,dataIndx:r});f&&f.removeClass(o)}}}}},a.hasClass=function(t){var e,i=t.dataIndx,r=t.cls,o=this.getRowData(t),n=new RegExp("\\b"+r+"\\b");if(o){if(null==i)return!(!(e=o.pq_rowcls)||!n.test(e));var a=o.pq_cellcls;return!!(a&&a[i]&&n.test(a[i]))}return null},a._removeClass=function(t,e){if(t&&e){for(var i=t.split(/\s+/),r=e.split(/\s+/),o=[],n=0,a=i.length;n<a;n++){for(var l=i[n],s=!1,d=0,h=r.length;d<h;d++){if(l===r[d]){s=!0;break}}s||o.push(l)}return o.length>1?o.join(" "):1===o.length?o[0]:null}},a.getRowIndx=function(t){var e=t.$tr,i=t.rowData;if(i){var r=this.options,o=r.dataModel,n="remote"==r.pageModel.type,a=o.data,l=!1,s=o.dataUF,d=!1;if(a)for(var h=0,c=a.length;h<c;h++)if(a[h]==i){d=!0;break}if(!d&&s){l=!0;for(h=0,c=s.length;h<c;h++)if(s[h]==i){d=!0;break}}if(d){var u=this.rowIndxOffset,f=n?h:h-u;return{rowIndxPage:l?void 0:f,uf:l,rowIndx:n?h+u:h}}return{}}return null==e||0==e.length?{rowIndxPage:null}:null==(f=e.attr("pq-row-indx"))?{rowIndxPage:null}:{rowIndxPage:f=parseInt(f),rowIndx:f+this.rowIndxOffset}};var h=function(t){this.options=t.options,this.that=t;var e=this,i=t.widgetEventPrefix.toLowerCase(),r=t.eventNamespace;t.element.on(i+"celleditkeyup"+r,function(t,i){return e.filterKeys(t,i)})},c=h.prototype;c._incrRowIndx=function(t,e){for(var i=this.that,r=t,o=(e=null==e?1:e,i.pdata),n=0,a=t+1,l=o.length;a<l;a++){if(!o[a].pq_hidden&&(r=a,++n==e))return r}return r},c._decrRowIndx=function(t,e){for(var i=t,r=this.that.pdata,o=(e=null==e?1:e,0),n=t-1;n>=0;n--){if(!r[n].pq_hidden&&(i=n,++o==e))return i}return i},a.addColumn=function(t,e){var i=this.options,r=i.colModel,o=i.dataModel.data;r.push(t),this._calcThisColModel();for(var n=0;n<o.length;n++){o[n].push("")}},a.rowNextSelect=function(){var t,e=this.selection({type:"row",method:"getSelection"}),i=this.rowIndxOffset;return e&&e[0]&&(t=e[0].rowIndx-i,t=this.iKeyNav._incrRowIndx(t)),null!=t&&(this.setSelection(null),this._setSelection({rowIndxPage:t})),t},a.rowPrevSelect=function(){var t,e=this.selection({type:"row",method:"getSelection"}),i=this.rowIndxOffset;return e&&e[0]&&(t=e[0].rowIndx-i,t=this.iKeyNav._decrRowIndx(t)),null!=t&&(this.setSelection(null),this.setSelection({rowIndxPage:t})),t},c._incrIndx=function(t,e){var i,r=this.that,o=r._getLastVisibleRowIndxPage(r.pdata),n=r.colModel,a=n.length;if(null==e)return t==o?null:{rowIndxPage:t=this._incrRowIndx(t)};do{if(++e>=a){if(t==o)return null;t=this._incrRowIndx(t),e=0}i=n[e]}while(i&&i.hidden);return{rowIndxPage:t,colIndx:e}},c._decrIndx=function(t,e){var i,r=this.that,o=r.colModel,n=o.length,a=r._getFirstVisibleRowIndxPage(r.pdata);if(null==e)return t==a?null:{rowIndxPage:t=this._decrRowIndx(t)};do{if(--e<0){if(t==a)return null;t=this._decrRowIndx(t),e=n-1}i=o[e]}while(i&&i.hidden);return{rowIndxPage:t,colIndx:e}},c._incrEditIndx=function(t,e){var i,r=this.that,o=r.colModel,n=o.length,a=r.rowIndxOffset,l=r._getLastVisibleRowIndxPage(r.pdata);do{if(++e>=n){if(t==l)return null;do{var s=(t=this._incrRowIndx(t))+a,d=r.isEditableRow({rowIndx:s});if(t==l&&0==d)return null}while(0==d);e=0}i=o[e];s=t+a;var h=r.isEditableCell({rowIndx:s,colIndx:e,checkVisible:!0})}while(i&&(i.hidden||0==h));return{rowIndxPage:t,colIndx:e}},c._decrEditIndx=function(t,e){var i,r=this.that,o=r.colModel,n=o.length,a=r.rowIndxOffset,l=r._getFirstVisibleRowIndxPage(r.pdata);do{if(--e<0){if(t==l)return null;do{var s=(t=this._decrRowIndx(t))+a,d=r.isEditableRow({rowIndx:s});if(t==l&&0==d)return null}while(0==d);e=n-1}i=o[e];s=t+a;var h=r.isEditableCell({rowIndx:s,colIndx:e,checkVisible:!0})}while(i&&(i.hidden||0==h));return{rowIndxPage:t,colIndx:e}},c._incrEditRowIndx=function(t,e){var i=this.that,r=i.rowIndxOffset,o=i._getLastVisibleRowIndxPage(i.pdata);if(t==o)return null;do{var n=(t=this._incrRowIndx(t))+r,a=i.isEditableRow({rowIndx:n}),l=i.isEditableCell({rowIndx:n,colIndx:e}),s=a&&l;if(t==o&&!s)return null}while(!s);return{rowIndxPage:t,colIndx:e}},c._decrEditRowIndx=function(t,e){var i=this.that,r=i.rowIndxOffset,o=i._getFirstVisibleRowIndxPage(i.pdata);if(t==o)return null;do{var n=(t=this._decrRowIndx(t))+r,a=i.isEditableRow({rowIndx:n}),l=i.isEditableCell({rowIndx:n,colIndx:e}),s=a&&l;if(t==o&&!s)return null}while(!s);return{rowIndxPage:t,colIndx:e}},a._onKeyPressDown=function(e){return t(e.target).closest(".pq-grid-header").length>0?0!=this._trigger("headerKeyDown",e,{dataModel:this.options.dataModel}):!1!==this.iKeyNav._bodyKeyPressDown(e)&&(0!=this._trigger("keyDown",e,{dataModel:this.options.dataModel})&&void 0)},c._saveAndMove=function(t,e){if(null==t)return e.preventDefault(),!1;var i,r=this.that,o=this.options,n=o.selectionModel,a=(o.editModel,r.colModel,t.rowIndxPage),l=t.colIndx;if(r._blurEditMode=!0,!1===r.saveEditCell({evt:e})||!r.pdata)return r.pdata||r.quitEditMode(e),r._deleteBlurEditMode({timer:!0,msg:"_saveAndMove saveEditCell"}),e.preventDefault(),!1;(r.quitEditMode(e),t.incr)&&(a=(i=e.shiftKey?this._decrEditIndx(a,l):this._incrEditIndx(a,l))?i.rowIndxPage:a,l=i?i.colIndx:l);return"row"==n.type?(r.setSelection(null),r.setSelection({rowIndxPage:a}),r.scrollColumn({colIndx:l})):"cell"==n.type?(r.setSelection(null),r.setSelection({rowIndxPage:a,colIndx:l})):(r.scrollRow({rowIndxPage:a}),r.scrollColumn({colIndx:l})),!1!==t.edit&&r._editCell({rowIndxPage:a,colIndx:l}),r._deleteBlurEditMode({timer:!0,msg:"_saveAndMove"}),e.preventDefault(),!1},c._keyPressInEdit=function(e,i){var r=this.that,o=r.options.editModel.indices,n=(i=i||{}).FK,a=o.column.dataType;if(e.key&&-1!==t.inArray(e.key,["Backspace","Left","Right","Up","Down","Del","Home","End"]))return!0;if(!1===r._trigger("editorKeyPress",e,t.extend({},o)))return!1;if(n&&("float"==a||"integer"==a)){var l="float"==a?"0123456789.-":"0123456789-",s=(s=e.charCode)||e.keyCode,d=String.fromCharCode(s);if(d&&-1==l.indexOf(d))return!1}return!0},c.getValText=function(e){var i=e[0].nodeName.toLowerCase(),r="text";return-1!=t.inArray(i,["input","textarea","select"])&&(r="val"),r},c._keyUpInEdit=function(e,i){var r=this.that,o=r.options,n=(i=i||{}).FK,a=o.editModel,l=a.indices;r._trigger("editorKeyUp",e,t.extend({},l));var s=l.column.dataType;if(n&&("float"==s||"integer"==s)){var d=t(e.target),h="integer"==s?a.reInt:a.reFloat,c=this.getValText(d),u=d.data("oldVal"),f=d[c]();if(0==h.test(f))if(h.test(u))d[c](u);else{var p="float"==s?parseFloat(u):parseInt(u);isNaN(p)?d[c](0):d[c](p)}}},c._keyDownInEdit=function(e){var i=this.that,r=i.options,o=r.editModel.indices;if(o){var n=t(e.target),a=t.ui.keyCode,l=r.selectionModel,s=r.editModel,d=(p=t.extend({},o)).rowIndxPage,h=p.colIndx,c=p.column.editModel,u=c?t.extend({},s,c):s,f=this.getValText(n);if(n.data("oldVal",n[f]()),0==i._trigger("cellEditKeyDown",e,p))return!1;if(0==i._trigger("editorKeyDown",e,p))return!1;if(e.keyCode==a.TAB){var p={rowIndxPage:d,colIndx:h,incr:!0};return this._saveAndMove(p,e)}if(e.keyCode==u.saveKey)return p="next"==u.onSave?{rowIndxPage:d,colIndx:h,incr:!0}:{rowIndxPage:d,colIndx:h,edit:!1},this._saveAndMove(p,e);if(e.keyCode==a.ESCAPE){if(i.quitEditMode({evt:e}),"cell"==l.type)i.getCell({rowIndxPage:d,colIndx:h}).attr("tabindex",0).focus();else if("row"==l.type){var g=i.getRow({rowIndxPage:d});t(g[0]).attr("tabindex",0).focus()}return e.preventDefault(),!1}if(e.keyCode==a.PAGE_UP||e.keyCode==a.PAGE_DOWN)return e.preventDefault(),!1;if(u.keyUpDown){if(e.keyCode==a.DOWN){p=this._incrEditRowIndx(d,h);return this._saveAndMove(p,e)}if(e.keyCode==a.UP){p=this._decrEditRowIndx(d,h);return this._saveAndMove(p,e)}}}},c.select=function(t){var e=this.that,i=t.rowIndx,r=t.colIndx,o=e.options.selectionModel,n=t.evt;n.shiftKey&&"single"!=o.mode?"row"==o.type?(e.scrollRow({rowIndx:i}),e.iRows.extendSelection({rowIndx:i,evt:n})):"cell"==o.type&&(e.scrollCell({rowIndx:i,colIndx:r}),e.iCells.extendSelection({rowIndx:i,colIndx:r,evt:n})):e.setSelection({rowIndx:i,colIndx:r,evt:n,setFirst:!0})},c._bodyKeyPressDown=function(e){var i,r,o=this.that,n=o.rowIndxOffset,a=this.options,l=o.colModel,s=a.selectionModel,d=a.editModel,h=e.ctrlKey||e.metaKey,c=t.ui.keyCode,u=e.keyCode;if(d.indices)o.$div_focus.find(".pq-cell-focus").focus();else{if("row"==s.type){if(null==(r=h?o.iRows.getFocusSelection({old:!0}):o.iRows.getFocusSelection({old:!1})))return;var f=(I=r.rowIndx)-n;if(null==I)return;if(0==o._trigger("rowKeyDown",e,{rowData:o.pdata[f],rowIndx:I,rowIndxPage:f}))return!1}else{if("cell"!=s.type)return;if(null==(i=h?o.iCells.getFocusSelection({old:!0}):o.iCells.getFocusSelection({old:!1})))return;f=(I=(v=i).rowIndx)-n;var p=v.dataIndx,g=o.getColIndx({dataIndx:p});if(null==I||null==g)return;if(0==o._trigger("cellKeyDown",e,{rowData:o.pdata[f],rowIndx:I,rowIndxPage:f,colIndx:g,dataIndx:p,column:l[g]}))return!1;if(e.cancelBubble)return}var v;if(u==c.LEFT)return(v=this._decrIndx(f,g))&&(I=v.rowIndxPage+n,this.select({rowIndx:I,colIndx:v.colIndx,evt:e})),void e.preventDefault();if(u==c.RIGHT)return(v=this._incrIndx(f,g))&&(I=v.rowIndxPage+n,this.select({rowIndx:I,colIndx:v.colIndx,evt:e})),void e.preventDefault();if(u==c.UP)return null!=(f=this._decrRowIndx(f))&&(I=f+n,this.select({rowIndx:I,colIndx:g,evt:e})),void e.preventDefault();if(u==c.DOWN)return null!=(f=this._incrRowIndx(f))&&(I=f+n,this.select({rowIndx:I,colIndx:g,evt:e})),void e.preventDefault();if(u==c.PAGE_DOWN||u==c.SPACE){var w=this.pageDown(f);return w&&null!=(f=w.rowIndxPage)&&(I=f+n,this.select({rowIndx:I,colIndx:g,evt:e})),void e.preventDefault()}if(u==c.PAGE_UP){var x=this.pageUp(f);return x&&null!=(f=x.rowIndxPage)&&(I=f+n,this.select({rowIndx:I,colIndx:g,evt:e})),void e.preventDefault()}if(u==c.HOME)return"row"==s.type||h?(I=o._getFirstVisibleRowIndxPage(o.pdata)+n,this.select({rowIndx:I,colIndx:g,evt:e})):"cell"==s.type&&(g=o._getFirstVisibleColIndx(),this.select({rowIndx:I,colIndx:g,evt:e})),void e.preventDefault();if(u==c.END)return"row"==s.type||h?(I=o._getLastVisibleRowIndxPage(o.pdata)+n,this.select({rowIndx:I,colIndx:g,evt:e})):"cell"==s.type&&(g=o._getLastVisibleColIndx(),this.select({rowIndx:I,colIndx:g,evt:e})),void e.preventDefault();if(u!=c.ENTER){if(h&&"65"==u)return"row"==s.type&&"single"!=s.mode?o.iRows.selectAll({all:s.all}):"cell"==s.type&&"single"!=s.mode&&o.iCells.selectAll({all:s.all}),void e.preventDefault();if(d.pressToEdit&&u>=32&&u<=127&&!h&&null!=i&&(m=o.getCell({rowIndxPage:f,colIndx:g}))&&m.length>0){I=f+n,_=o.isEditableRow({rowIndx:I}),b=o.isEditableCell({rowIndx:I,colIndx:g});_&&b&&o.editCell({rowIndxPage:f,colIndx:g,select:!0})}}else{var m;if("row"==s.type)null!=r&&o.editFirstCellInRow({rowIndx:f+n});else if(null!=i&&(m=o.getCell({rowIndxPage:f,colIndx:g}))&&m.length>0){var I=f+n,_=o.isEditableRow({rowIndx:I}),b=o.isEditableCell({rowIndx:I,colIndx:g});_&&b&&o.editCell({rowIndxPage:f,colIndx:g})}e.preventDefault()}}},c.incrPageSize=function(){for(var e=this.that,i=e.$tbl,r=i.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),o=parseInt(i.css("marginTop")),n=e.iRefresh.getEContHt()-o,a=r.length-1;a>=0;a--){var l=r[a];if(l.offsetTop<n)break}return{rowIndxPage:e.getRowIndx({$tr:t(l)}).rowIndxPage}},c.pageNonVirtual=function(e,i){var r=this.that,o=r.$cont[0].offsetHeight-r._getSBHeight(),n=r.getRow({rowIndxPage:e}),a=0,l=0,s=t(n[0])[i]("tr.pq-grid-row"),d=s.length;if(d>0){do{if((a+=s[l].offsetHeight)>=o)break;l++}while(l<d);l=l>0?l-1:l;do{n=t(s[l]);if(null!=(e=r.getRowIndx({$tr:n}).rowIndxPage))break;l--}while(l>=0)}return e},c.pageDown=function(t){var e=this.that,i=e.options,r=e.$vscroll.pqScrollBar("option"),o=r.cur_pos,n=r.num_eles,a=r.ratio;if(i.virtualY){if(o<n-1){t=this.incrPageSize().rowIndxPage;var l=e._calcCurPosFromRowIndxPage(t);if(null==l)return;e.$vscroll.pqScrollBar("option","cur_pos",l).pqScrollBar("scroll")}}else if(null!=t)t=this.pageNonVirtual(t,"nextAll");else if(a<1){var s=e.iRefresh.getEContHt(),d=e.iMouseSelection;d.updateTableY(-1*s),d.syncScrollBarVert()}return{rowIndxPage:t,curPos:l}},c.pageUp=function(t){var e=this.that,i=e.options,r=e.$vscroll.pqScrollBar("option"),o=r.cur_pos,n=r.ratio;if(i.virtualY){if(o>0){t=this.decrPageSize().rowIndxPage;var a=e._calcCurPosFromRowIndxPage(t);if(null==a)return;e.$vscroll.pqScrollBar("option","cur_pos",a).pqScrollBar("scroll")}}else if(null!=t)t=this.pageNonVirtual(t,"prevAll");else if(n>0){var l=e.iRefresh.getEContHt(),s=e.iMouseSelection;s.updateTableY(l),s.syncScrollBarVert()}return{rowIndxPage:t,curPos:a}},c.decrPageSize=function(){var e,i=this.that,r=i.$tbl.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),o=i.options.freezeRows,n=0;r.length&&(o?(e=r.filter("tr.pq-last-frozen-row")).length&&(e=e.next()):r.length>=2&&(e=t(r[1])),e&&e.length&&(n=(n=i.getRowIndx({$tr:e}).rowIndxPage)-i.pageSize+4)<0&&(n=0));return{rowIndxPage:n}},a._calcNumHiddenFrozens=function(){for(var t=0,e=this.options.freezeCols,i=0;i<e;i++)this.colModel[i].hidden&&t++;return t},a._calcNumHiddenUnFrozens=function(t){for(var e=0,i=this.options.freezeCols,r=null!=t?t:this.colModel.length,o=i;o<r;o++)this.colModel[o].hidden&&e++;return e},a._getSBHeight=function(){return this.iRefresh.getSBHeight()},a._getSBWidth=function(t){return this.iRefresh.getSBWidth()},a._getFirstVisibleRowIndxPage=function(t){for(var e=0,i=t.length;e<i;e++){if(!t[e].pq_hidden)return e}},a._getLastVisibleRowIndxPage=function(t){for(var e=t.length-1;e>=0;e--){if(!t[e].pq_hidden)return e}return null},a._getFirstVisibleColIndx=function(){for(var t=this.colModel,e=t.length,i=0;i<e;i++){if(!t[i].hidden)return i}return null},a._getLastVisibleColIndx=function(){for(var t=this.colModel,e=t.length-1;e>=0;e--){if(!t[e].hidden)return e}return null},a.getTotalVisibleColumns=function(){for(var t=this.colModel,e=t.length,i=0,r=0;r<e;r++){t[r].hidden||i++}return i},a._calcCurPosFromRowIndxPage=function(t){var e=this.options,i=e.groupModel,r=i?this.dataGM:this.pdata,o=e.freezeRows;if(t<o)return 0;for(var n=0,a=o,l=o,s=r.length;l<s;l++){var d=r[l];if(i&&(d.groupSummary||d.groupTitle));else{if(a==t)break;a++}d.pq_hidden||n++}return n>=s?null:n},a._calcCurPosFromColIndx=function(t){var e=this.options,i=(this.pdata,this.colModel),r=e.freezeCols;if(t<r)return 0;for(var o=0,n=r,a=r,l=i.length;a<l;a++){var s=i[a];if(n==t)break;n++,s.hidden||o++}return o>=l?null:o};var u=function(t,e,i){var r=0,o=this.options,n=o.columnBorders?1:0,a=o.numberCell,l=this.colModel;if(-1==t&&(a.show&&(r+=i?parseInt(a.width)+1:a.outerWidth),t=0),i)for(var s=t;s<e;s++){if((d=l[s])&&!d.hidden){if(!d._width)throw"assert failed";r+=d._width+n}}else for(s=t;s<e;s++){var d;(d=l[s])&&!d.hidden&&(r+=d.outerWidth)}return r};t.paramquery.pqgrid.calcWidthCols=u,a.calcHeightFrozenRows=function(){var e=this.$tbl,i=0;if(e&&e.length){var r=t(e[0]).find("tr.pq-last-frozen-row");if(r&&r.length){var o=r[0];i=o.offsetTop+o.offsetHeight}}return i},a._calcRightEdgeCol=function(t){var e=0,i=0,r=this.colModel,o=this.hidearrHS,n=this.options.numberCell;n.show&&(e+=n.outerWidth,i++);for(var a=0;a<=t;a++){var l=r[a];l.hidden||0!=o[a]||(e+=l.outerWidth,i++)}return{width:e,cols:i}},a.nestedCols=function(t,e,i){var r=t.length,o=[];null==e&&(e=1);for(var n=e,a=0,l=0,s=0;s<r;s++){var d=t[s];if(!0!==i&&!1!==i||(d.hidden=i),null!=d.colModel&&d.colModel.length>0){var h=this.nestedCols(d.colModel,e+1,d.hidden);o=o.concat(h.colModel),h.colSpan>0?(h.depth>n&&(n=h.depth),d.colSpan=h.colSpan,a+=h.colSpan):(d.colSpan=0,d.hidden=!0),d.childCount=h.childCount,l+=h.childCount}else d.hidden?d.colSpan=0:(d.colSpan=1,a++),d.childCount=0,l++,o.push(d)}return{depth:n,colModel:o,colSpan:a,width:0,childCount:l}},a.getHeadersCells=function(){for(var t=this.options.colModel,e=this.colModel.length,i=this.depth,r=[],o=0;o<i;o++){r[o]=[];for(var n=0,a=0,l=0;l<e;l++){var s;if(0==o)s=t[n];else{var d=r[o-1][l],h=d.colModel;if(null==h||0==h.length)s=d;else{for(var c=l-d.leftPos,u=0,f=0,p=0;p<h.length;p++)if(c<(u+=h[p].childCount>0?h[p].childCount:1)){f=p;break}s=h[f]}}var g=s.childCount?s.childCount:1;l==a?(s.leftPos=l,r[o][l]=s,a+=g,t[n+1]&&n++):r[o][l]=r[o][l-1]}}return this.headerCells=r,r},a.getDataType=function(){var t=this.colModel;if(t&&t[0])return"string"==typeof t[0].dataIndx?"JSON":"ARRAY";throw"dataType unknown"},a.assignRowSpan=function(){this.options.colModel;for(var t=this.colModel.length,e=this.headerCells,i=this.depth,r=0;r<t;r++)for(var o=0;o<i;o++){var n=e[o][r];if(!(r>0&&n==e[o][r-1])&&!(o>0&&n==e[o-1][r])){for(var a=1,l=o+1;l<i;l++){n==e[l][r]&&a++}n.rowSpan=a}}return e},a._calcThisColModel=function(){var e=this.options,i=e.columnTemplate,r=e.colModel,o=this.nestedCols(r);this.colModel=o.colModel,this.depth=o.depth;var n=this.colModel,a=n.length;if(i)for(var l=0;l<a;l++){var s=n[l],d=t.extend({},i,s,!0);t.extend(s,d,!0)}this.getHeadersCells(),this.assignRowSpan(),this._refreshDataIndices()},a._createHeader=function(){this.iHeader.createHeader()},a.createTable=function(t){this.iGenerateView.generateView(t),this.iRefresh.setContAndHeaderHeight(),this.iGenerateView.setPanes(),this.iRefresh.refreshScrollbars()},t.widget("paramquery._pqGrid",t.ui.mouse,a)}(jQuery),function(t){var e=t.paramquery.pqgrid.calcWidthCols;function i(t){this.that=t}t.paramquery._pqGrid.prototype.getHeaderColumnFromTD=function(t){var e,i=t.attr("pq-col-indx"),r=t.attr("pq-row-indx");null!=i&&null!=r&&(i=parseInt(i),r=parseInt(r),e=this.headerCells[r][i]);var o=!0;return(!e||e.colModel&&e.colModel.length)&&(o=!1),{column:e,colIndx:i,rowIndx:r,leaf:o}},t.paramquery.cHeader=i;var r=i.prototype;r.createHeader=function(){var i=this.that,r=this,o=i.options,n=o.hwrap,a=i.pqpanes,l=parseInt(o.freezeCols),s=o.numberCell,d=i.colModel,h=i.depth,c=o.virtualX,u=o.virtualXHeader,f=!1===u?i.initHH:i.initH,p=!1===u?i.finalHH:i.finalH,g=i.headerCells,v=(i.hidearrHS,i.$header),w=i.$header_o;if(null==p)throw"finalH required for _createHeader";if(!1===o.showHeader)return v&&v.empty(),void w.css("display","none");w.css("display","");var x="pq-grid-header-table ",m=["<table class='"+(x+=n?"pq-wrap ":"pq-no-wrap ")+"' cellpadding=0 cellspacing=0 >"];if(h>=1){m.push("<tr>"),s.show&&m.push("<td style='width:"+(s.width+1)+"px;' ></td>");for(var I=0;I<=p;I++){if(I<f&&I>=l&&c&&(I=f)>p)throw"initH>finalH";var _=d[I];if(!_.hidden){var b=_.outerWidth;m.push("<td style='width:"+b+"px;' pq-col-indx="+I+"></td>")}}m.push("</tr>")}for(var y="pq-grid-col ",q=0;q<h;q++){m.push("<tr class='pq-grid-title-row'>"),0==q&&s.show&&m.push(["<td pq-col-indx='-1' class='pq-grid-number-col' rowspan='",h,"'>","<div class='pq-td-div'>",s.title?s.title:"&nbsp;","</div></td>"].join(""));for(I=0;I<=p;I++){if(I<f&&I>=l&&c&&(I=f)>p)throw"initH>finalH";r.createHeaderCell(q,I,g,m,y,l,f,h)}m.push("</tr>")}i.ovCreateHeader(m,y),m.push("</table>");var C=m.join("");w.empty(),a.vH?w.append(["<span class='pq-grid-header pq-grid-header-left ui-state-default'>",C,"</span>","<span class='pq-grid-header ui-state-default'>",C,"</span>"].join("")):w.append(["<span class='pq-grid-header ui-state-default'>",C,"</span>"].join(""));v=i.$header=t(".pq-grid-header",w);i.$tbl_header=v.children("table");b=e.call(i,-1,l);var R=i.$header_left=t(v[0]);if(a.vH){R=i.$header_left=t(v[0]);var M=i.$header_right=t(v[1]);R.css({width:b,zIndex:1});var D=e.call(i,l,f);M.css({left:-1*D+"px"})}v.click(function(t){return r._onHeaderClick(t)}),r._refreshResizeColumn(f,p,d),i._trigger("refreshHeader",null,null)},r._onHeaderClick=function(e){var i,r=this.that;if(!r.iDragColumns||"stop"==r.iDragColumns.status){var o=t(e.target).closest("td.pq-grid-col");if(o.length){e.stopImmediatePropagation();var n=r.getHeaderColumnFromTD(o);if(i=n.colIndx,0!=n.leaf)return this._onHeaderCellClick(i,e)}}},r.createHeaderCell=function(t,e,i,r,o,n,a,l){var s=i[t][e],d=s.colSpan,h=s.halign,c=s.align,u=(u=s.title)||"";if(!(t>0&&s==i[t-1][e]||e>0&&s==i[t][e-1]||s.hidden)){var f=o;null!=h?f+=" pq-align-"+h:null!=c&&(f+=" pq-align-"+c),e==n-1&&1==l&&(f+=" pq-last-frozen-col"),e<=n-1?f+=" pq-left-col":e>=a&&(f+=" pq-right-col");var p=s.cls;p&&(f=f+" "+p);null!=s.colModel&&0!=s.colModel.length||(f+=" pq-grid-col-leaf");var g="pq-row-indx="+t,v="pq-col-indx="+e;r.push(["<td ",""," ",v," ",g," "," class='",f,"' rowspan=",s.rowSpan," colspan=",d,">","<div class='pq-td-div'>",u,"<span class='pq-col-sort-icon'>&nbsp;</span></div></td>"].join(""))}},r._onHeaderCellClick=function(t,e){var i=this.that,r=i.colModel[t],o=i.options,n=r.dataIndx;!1!==i._trigger("headerCellClick",e,{column:r,colIndx:t,dataIndx:n})&&o.sortable&&0!=r.sortable&&i.sort({colIndx:t,column:r,dataIndx:n})},r._refreshResizeColumn=function(t,e,i){var r=this.that,o=r.options,n=!!o.filterModel.ficon,a=o.numberCell,l=parseInt(o.freezeCols),s=[],d=[],h=r.pqpanes.vH,c=0,u=0;a.show&&(c=a.outerWidth,a.resizable&&(u=c-5,s.push("<div pq-col-indx='-1' style='left:",u,"px;'"," class='pq-grid-col-resize-handle'>&nbsp;</div>")));for(var f=0;f<=e;f++){if(f<t&&f>=l&&(f=t)>e)throw"initH>finalH";var p=i[f];if(!p.hidden){var g=p.ficon,v=g||null==g&&n,w=s;c+=p.outerWidth,(!1!==p.resizable||v)&&(h&&f>=l&&(w=d),u=c-5,w.push("<div pq-col-indx='",f,"' style='left:",u,"px;'"," class='pq-grid-col-resize-handle'>&nbsp;</div>"))}}d.length&&r.$header_right.append(d.join("")),r.$header_left.append(s.join(""))},r.refreshHeaderSortIcons=function(){var t=this.that,e=t.iSort.sorters,i=t.$header;if(i){i.find(".pq-grid-col-leaf").removeClass("pq-col-sort-asc pq-col-sort-desc ui-state-active"),i.find(".pq-col-sort-icon").removeClass("ui-icon ui-icon-triangle-1-n ui-icon-triangle-1-s");for(var r=0;r<e.length;r++){var o=e[r],n=o.dataIndx,a=t.getColIndx({dataIndx:n}),l=o.dir,s="ui-state-active pq-col-sort-"+("up"==l?"asc":"desc"),d="ui-icon ui-icon-triangle-1-"+("up"==l?"n":"s");i.find(".pq-grid-col-leaf[pq-col-indx="+a+"]").addClass(s),i.find(".pq-grid-col-leaf[pq-col-indx="+a+"] .pq-col-sort-icon").addClass(d)}}};var o=function(e){this.that=e;var i=this;e.$header_o.on({mousedown:function(e){if(!e.pq_composed){var r=t(e.target);i.setDraggables(e),e.pq_composed=!0;var o=t.Event("mousedown",e);r.trigger(o)}}},".pq-grid-col-resize-handle")};t.paramquery.cResizeColumns=o;var n=o.prototype;n.setDraggables=function(e){var i,r,o=t(e.target),n=(this.that,this);o.draggable({axis:"x",helper:function(e,i){var r=t(e.target),o=parseInt(r.attr("pq-col-indx"));return n._setDragLimits(o),n._getDragHelper(e,i),r},start:function(t,e){i=e.position.left,r=parseInt(n.$cl[0].style.left)},drag:function(t,e){var o=e.position.left-i;n.$cl[0].style.left=r+o+"px"},stop:function(t,e){return n.resizeStop(t,e,i)}})},n._getDragHelper=function(e){var i=this.that,r=i.options,o=parseInt(r.freezeCols),n=t(e.target);this.$cl=t("<div class='pq-grid-drag-bar'></div>").appendTo(i.$grid_inner),this.$clleft=t("<div class='pq-grid-drag-bar'></div>").appendTo(i.$grid_inner);var a=parseInt(n.attr("pq-col-indx")),l=i.$grid_inner.outerHeight();this.$cl.height(l),this.$clleft.height(l);var s=t("td[pq-col-indx="+a+"]",i.$header)[0],d=s.offsetLeft;i.pqpanes.vH?a>=o&&(d+=i.$header[1].offsetLeft):d+=i.$header[0].offsetLeft,this.$clleft.css({left:d}),d+=s.offsetWidth,this.$cl.css({left:d})},n._setDragLimits=function(t){if(!(t<0)){var e=this.that,i=e.colModel[t],r=e.options,o=(r.numberCell,e.$header_left);t>=r.freezeCols&&e.pqpanes.vH&&(o=e.$header_right);var n=o.find("td[pq-col-indx='"+t+"']").offset().left+i._minWidth,a=n+i._maxWidth-i._minWidth;o.find("div.pq-grid-col-resize-handle[pq-col-indx="+t+"]").draggable("option","containment",[n,0,a,0])}},n.resizeStop=function(e,i,r){var o=this.that,n=o.colModel,a=o.options.numberCell;this.$clleft.remove(),this.$cl.remove();var l,s=i.position.left-r,d=t(i.helper),h=parseInt(d.attr("pq-col-indx"));if(-1==h){l=null;var c=(u=parseInt(a.width))+s;a.width=c}else{l=n[h];var u;c=(u=parseInt(l.width))+s;l.width=c,l._resized=!0}o.refresh(),o._trigger("columnResize",e,{colIndx:h,column:l,dataIndx:l?l.dataIndx:null,oldWidth:u,newWidth:l?l.width:a.width})};var a=function(e){this.that=e,this.$drag_helper=null;var i=e.options.dragColumns,r=i.topIcon,o=i.bottomIcon,n=this;this.status="stop",this.$arrowTop=t("<div class='pq-arrow-down ui-icon "+r+"'></div>").appendTo(e.element),this.$arrowBottom=t("<div class='pq-arrow-up ui-icon "+o+"' ></div>").appendTo(e.element),this.hideArrows(),i&&i.enabled&&e.$header_o.on("mousedown","td.pq-grid-col",function(e,i){if(!t(e.target).is("input,select,textarea")&&!e.pq_composed){n.setDraggables(e,i),e.pq_composed=!0;var r=t.Event("mousedown",e);t(e.target).trigger(r)}})};t.paramquery.cDragColumns=a;var l=a.prototype;l.showFeedback=function(t,e){var i=this.that,r=t[0],o=r.offsetParent.offsetParent,n=r.offsetLeft+o.offsetLeft+(e?0:r.offsetWidth)-8,a=i.$grid_inner[0].offsetTop+r.offsetTop-16,l=i.$grid_inner[0].offsetTop+i.$header[0].offsetHeight;this.$arrowTop.css({left:n,top:a,display:""}),this.$arrowBottom.css({left:n,top:l,display:""})},l.showArrows=function(){this.$arrowTop.show(),this.$arrowBottom.show()},l.hideArrows=function(){this.$arrowTop.hide(),this.$arrowBottom.hide()},l.updateDragHelper=function(t){var e=this.that.options.dragColumns,i=e.acceptIcon,r=e.rejectIcon,o=this.$drag_helper;o&&(t?(o.children("span.pq-drag-icon").addClass(i).removeClass(r),o.removeClass("ui-state-error")):(o.children("span.pq-drag-icon").removeClass(i).addClass(r),o.addClass("ui-state-error")))},l.setDraggables=function(e,i){var r=t(e.currentTarget),o=this.that,n=o.options.dragColumns.rejectIcon,a=this;r.hasClass("ui-draggable")||!1!==o.getHeaderColumnFromTD(r).leaf&&r.draggable({distance:10,cursorAt:{top:-18,left:-10},zIndex:"1000",appendTo:o.element,revert:"invalid",helper:function(){var e=t(this);a.status="helper",a.setDroppables(e),o.$header.find(".pq-grid-col-resize-handle").hide();var i=e.attr("pq-col-indx"),r=e.attr("pq-row-indx");e.droppable("destroy");var l=o.headerCells[r][i],s=t("<div class='pq-col-drag-helper ui-widget-content ui-corner-all' ><span class='pq-drag-icon ui-icon "+n+"'></span>"+l.title+"</div>");return a.$drag_helper=s,s[0]},drag:function(e,i){a.status="drag";var r=t("td.pq-drop-hover",o.$header);if(r.length>0){a.showArrows(),a.updateDragHelper(!0);var n=r.width();e.clientX-r.offset().left+t(document).scrollLeft()<n/2?(a.leftDrop=!0,a.showFeedback(r,!0)):(a.leftDrop=!1,a.showFeedback(r,!1))}else a.hideArrows(),o.$toolbar.hasClass("pq-drop-hover")?a.updateDragHelper(!0):a.updateDragHelper()},stop:function(t,e){a.status="stop",o.$header.find(".pq-grid-col-resize-handle").show(),a.hideArrows()}})},l._columnIndexOf=function(t,e){for(var i=0,r=t.length;i<r;i++)if(t[i]==e)return i;return-1},l.setDroppables=function(e){var i=this.that,r=this,o={hoverClass:"pq-drop-hover ui-state-highlight",tolerance:"pointer",drop:function(e,o){if(!r.dropPending){var n,a,l=parseInt(o.draggable.attr("pq-col-indx")),s=parseInt(o.draggable.attr("pq-row-indx")),d=t(this),h=parseInt(d.attr("pq-col-indx")),c=parseInt(d.attr("pq-row-indx")),u=i.options.colModel,f=i.headerCells,p=f[s][l];n=0==s?u:f[s-1][l].colModel,a=0==c?u:f[c-1][h].colModel;var g=f[c][h],v=r._columnIndexOf(n,p),w=n.splice(v,1)[0],x=r._columnIndexOf(a,g),m=r.leftDrop?1:0;a.splice(x+1-m,0,w),r.dropPending=!0,window.setTimeout(function(){i._calcThisColModel(),i.refresh(),r.dropPending=!1},0)}}},n=i.$header_left.find("td.pq-left-col"),a=i.pqpanes.v||i.pqpanes.vH?i.$header_right.find("td.pq-right-col"):i.$header_left.find("td.pq-right-col");(n=n.add(a)).each(function(e,i){var r=t(i);r.hasClass("ui-droppable")||r.droppable(o)})}}(jQuery),function(t){function e(e){var i=this;this.that=e,this.type="detail",this.refreshComplete=!0,this.detachView=!1;var r=e.widgetEventPrefix.toLowerCase(),o=e.eventNamespace;e.element.on(r+"cellclick"+o,function(t,e){if(i.belongs(t))return i.toggle(t,e)}).on(r+"cellkeydown"+o,function(e,r){if(i.belongs(e)&&e.keyCode==t.ui.keyCode.ENTER)return i.toggle(e,r)}).on(r+"refresh"+o,function(t,e){if(i.belongs(t))return i.aftertable()}).on(r+"beforetableview"+o,function(t,e){if(i.belongs(t))return i.beforeTableView(t,e)}).on(r+"tablewidthchange"+o,function(t,e){if(i.belongs(t))return i.tableWidthChange(t,e)})}t.paramquery.cHierarchy=e;var i=e.prototype=new t.paramquery.cClass;i.tableWidthChange=function(){if(this.refreshComplete){this.refreshComplete=!1;for(var e=this.that.$tbl.children("tbody").children("tr.pq-detail-child").children("td.pq-detail-child"),i=0,r=e.length;i<r;i++)for(var o=e[i],n=t(o).find(".pq-grid"),a=0,l=n.length;a<l;a++){var s=t(n[a]);s.is(":visible")&&s.pqGrid("onWindowResize")}this.refreshComplete=!0}},i.aftertable=function(e){var i=this.that,r=i.options.detailModel.init,o=i.pdata;if(this.refreshComplete){this.refreshComplete=!1;for(var n=0,a=(e=e||i.$tbl.children("tbody").children("tr.pq-detail-child")).length;n<a;n++){var l=e[n],s=t(l),d=o[s.attr("pq-row-indx")],h=!1,c=d.pq_detail.child;c||"function"==typeof r&&(h=!0,c=r.call(i.element[0],{rowData:d}),d.pq_detail.child=c,d.pq_detail.height=25);var u=s.children("td.pq-detail-child");u.append(c);for(var f=u.find(".pq-grid"),p=0,g=f.length;p<g;p++){var v=t(f[p]);h?v.hasClass("pq-pending-refresh")&&v.is(":visible")&&(v.removeClass("pq-pending-refresh"),v.pqGrid("refresh")):v.is(":visible")&&v.pqGrid("onWindowResize")}}this.refreshComplete=!0,this.detachView=!1}},i.beforeTableView=function(t,e){this.detachView||(this.detachInitView(),this.detachView=!0)},i.detachInitView=function(e){var i=this.that.$tbl;if(i&&i.length){e=e||i.children("tbody").children("tr.pq-detail-child");for(var r=0;r<e.length;r++){var o=e[r];t(o).children("td.pq-detail-child").children().detach()}}},i.toggle=function(t,e){var i=this.that,r=e.column,o=e.rowData,n=e.rowIndx,a=this.type;if(r&&r.type===a){var l="pq_detail",s={rowIndx:n,focus:!0};null==o[l]?i.rowExpand(s):!1===o[l].show?i.rowExpand(s):this.rowCollapse(s)}},i.rowExpand=function(t){this.normalize(t);var e=this.that,i=e.options,r=t.rowData,o=t.rowIndx,n=t.rowIndxPage,a=i.detailModel,l="pq_detail";if(null!=r){if(!1===e._trigger("beforeRowExpand",null,t))return!1;null==r[l]?r[l]={show:!0}:!1===r[l].show&&(r[l].show=!0),a.cache||this.rowInvalidate(t),e.refreshRow({rowIndx:o});var s=[];e.iGenerateView._generateDetailRow(r,n,e.colModel,s,null,!1);var d=e.getRow({rowIndxPage:n});d.after(s.join("")),this.aftertable(d.next()),t.focus&&e.getCell({rowIndx:o,dataIndx:l}).attr("tabindex","0").focus(),t.scrollRow&&this.scrollRow({rowIndx:o})}},i.rowInvalidate=function(t){var e=this.that.getRowData(t),i="pq_detail",r=e[i],o=r?r.child:null;o&&(o.remove(),e[i].child=null,e[i].height=0)},i.normalize=function(t){var e=this.that,i=t.rowIndx,r=t.rowIndxPage,o=e.rowIndxOffset;t.rowIndx=null==i?r+o:i,t.rowIndxPage=null==r?i-o:r,t.rowData=e.getRowData(t)},i.rowCollapse=function(t){this.normalize(t);var e=this.that,i=e.options,r=t.rowData,o=t.rowIndx,n=t.rowIndxPage,a=i.detailModel,l="pq_detail";if(null!=r&&null!=r[l]&&!0===r[l].show){if(a.cache||this.rowInvalidate(t),r[l].show=!1,i.virtualY)e.refresh();else{var s=e.getRow({rowIndxPage:n}).next("tr.pq-detail-child");s.length&&(this.detachInitView(s),s.remove(),e.refreshRow({rowIndx:o})),t.focus&&e.getCell({rowIndx:o,dataIndx:l}).attr("tabindex","0").focus()}if(t.scrollRow){o=t.rowIndx;this.scrollRow({rowIndx:o})}}}}(jQuery),function(t){var e=t.paramquery.pqgrid.calcWidthCols,i=function(t){this.that=t};t.paramquery.cRefresh=i;var r=i.prototype;r._computeOuterWidths=function(){for(var t=this.that,e=t.options,i=e.columnBorders?1:0,r=e.numberCell,o=t.colModel,n=(t.outerWidths,o.length),a=0;a<n;a++){var l=o[a];l.outerWidth=l._width+i}r.show&&(r.outerWidth=r.width+1)},r.autoFit=function(){var t=this.that,i=(t.options.columnBorders,t.colModel),r=i.length,o=e.call(t,-1,r,!0),n=this.contWd-this.getSBWidth();if(o!==n){for(var a,l=o-n,s=[],d=0;d<r;d++){var h=(f=i[d])._percent,c=(f.resizable,f._resized);if(!f.hidden&&!h&&!c)l<0?(v=f._maxWidth-f._width)&&s.push({availWd:-1*v,colIndx:d}):(v=f._width-f._minWidth)&&s.push({availWd:v,colIndx:d});c&&(a=f,delete f._resized)}s.sort(function(t,e){return t.availWd>e.availWd?1:t.availWd<e.availWd?-1:0});d=0;for(var u=s.length;d<u;d++){var f,p,g=s[d],v=g.availWd,w=g.colIndx,x=Math.round(l/(u-d)),m=(f=i[w])._width;Math.abs(v)>Math.abs(x)?(p=m-x,l-=x):(p=m-v,l-=v),f.width=f._width=p}if(0!=l&&a)(p=a._width-l)>a._maxWidth?p=a._maxWidth:p<a._minWidth&&(p=a._minWidth),a.width=a._width=p}},r.autoLastColumn=function(){var t=this.that,i=t.options,r=i.columnBorders?1:0,o=t.colModel,n=o.length,a=i.freezeCols,l=this.contWd-this.getSBWidth()-e.call(t,-1,a,!0),s=!1,d=t._getLastVisibleColIndx();if(null!=d){var h=o[d];if(!h._percent){for(var c,u=h._width,f=h._minWidth,p=h._maxWidth,g=n-1;g>=a;g--){var v=o[g];if(!v.hidden){var w=v._width+r;if((l-=w)<0){s=!0,c=u+l>=f?u+l:u+w+l;break}}}s||(c=u+l),c>p?c=p:c<f&&(c=f),h.width=h._width=c}}},r.numericVal=function(t,e){var i;return i=(t+"").indexOf("%")>-1?parseInt(t)*e/100:parseInt(t),Math.round(i)},r.refreshColumnWidths=function(){var t=this.that,e=t.options,i=e.numberCell,r="flex"===e.width,o=e.columnBorders?1:0,n=t.colModel,a=e.scrollModel,l=a.lastColumn,s=a.autoFit,d=this.contWd,h=n.length,c=this.getSBWidth(),u=e._minColWidth,f=e._maxColWidth,p=0;i.show&&(i.width<i.minWidth&&(i.width=i.minWidth),i.outerWidth=i.width+1,p=i.outerWidth);var g=r?null:d-c-p,v=(u=Math.floor(this.numericVal(u,g)),f=Math.ceil(this.numericVal(f,g)),0);if(!r&&g<5||isNaN(g)){if(e.debug)throw"availWidth N/A"}else{delete t.percentColumn;for(var w=0;w<h;w++){var x=n[w];if(!x.hidden){var m=x.width,I=(m+"").indexOf("%")>-1||null,_=x.minWidth,b=x.maxWidth;_=_?this.numericVal(_,g):u;if((b=b?this.numericVal(b,g):f)<_&&(b=_),void 0!=m){var y,q=0;!r&&I?(t.percentColumn=!0,x.resizable=!1,x._percent=!0,(v+=(y=this.numericVal(m,g)-o)-(q=Math.floor(y)))>=1&&(q+=1,v-=1)):m&&(q=parseInt(m)),q<_?q=_:!r&&q>b&&(q=b),x._width=q}else x._width=_;I||(x.width=x._width),x._minWidth=_,x._maxWidth=r?1e3:b}}!1===r&&(s&&this.autoFit(),"auto"===l&&e.virtualX&&this.autoLastColumn()),this._computeOuterWidths()}},r.estRowsInViewPort=function(){var t=Math.ceil(this.contHt/this.rowHt);return this.that.pageSize=t,t},r._refreshFrozenLine=function(){var i=this.that,r=i.options,o=r.numberCell,n=i.$cont_o,a=r.freezeCols;if(i.$freezeLine&&i.$freezeLine.remove(),a){var l=e.call(i,-1,a)-1;isNaN(l)||0===l||l>0&&o.show&&l===o.width||(i.$freezeLine=t(["<div class='pq-grid-vert-frozen-line' "," style = 'height:100%;top:0;left:",l,"px;' >","</div>"].join("")).appendTo(n))}},r._refreshHideArrHS=function(){for(var t=this.that,e=t.colModel,i=t.hidearrHS,r=t.initH,o=t.finalH,n=parseInt(t.options.freezeCols),a=0;a<n;a++)i[a]=!1;for(a=n;a<r;a++)i[a]=!0;for(a=r;a<=o;a++)i[a]=!1;a=o+1;for(var l=e.length;a<l;a++)i[a]=!0},r._setScrollVNumEles=function(){var e=this.that,i=e.$vscroll,r=e.options;if("flex"===r.height)return i.pqScrollBar("option","num_eles",0),0;var o,n,a=!!e.iHierarchy,l=i.pqScrollBar("option"),s=parseInt(l.num_eles),d=parseInt(l.cur_pos),h=this.getSBHeight(),c=this.contHt-h+1,u=(r.groupModel?e.dataGM:e.pdata)?e.totalVisibleRows:0,f=0;if(e.$tbl&&e.$tbl.length>0&&(f=(o=e.$tbl[e.$tbl.length-1]).offsetHeight,n=t(o)),f>0&&f>c){for(var p=n.children().children("tr"),g=0,v=0,w=0;w<p.length;w++){var x=p[w];if((g+=x.offsetHeight)>=c){v=a&&t(x).hasClass("pq-detail-child")?--v>1?v-1:1:v>1?v-1:0;break}a?!1===t(x).hasClass("pq-detail-child")&&v++:v++}0===v&&(v=p.length-1),s=u-v+1}else s=d+1;return s>u&&(s=u),i.pqScrollBar("option","num_eles",s),s},r._setScrollVLength=function(){var t=this.that;if("flex"!==t.options.height){var e=this.getSBHeight(),i=this.contHt-e;t.$vscroll.css("bottom",e).pqScrollBar("option","length",i)}},r.setContAndHeaderHeight=function(){var e,i,r,o=this.that,n=o.options,a=o.$header;if(a&&a.length){if(a.length>1){if(e=a[0].offsetHeight,i=a[1].offsetHeight,r=Math.max(e,i),e!==i){var l=t(a[0]).find(".pq-grid-header-search-row"),s=t(a[1]).find(".pq-grid-header-search-row");l.css("height",""),s.css("height",""),e=a[0].offsetHeight,i=a[1].offsetHeight,e<(r=Math.max(e,i))?l.height(s[0].offsetHeight-1):s.height(l[0].offsetHeight-1)}}else r=e=a[0].offsetHeight;o.$header_o.height(r-2),this.headerHt=r}else o.$header_o.height(0),this.headerHt=0;if("flex"!==n.height){var d=this.height-o.$header_o[0].offsetHeight-(n.showTop?o.$top[0].offsetHeight:0)-o.$bottom[0].offsetHeight;o.$cont.height(d),this.contHt=d}},r.setContAndGridHeightFromTable=function(){var e=0,i=this.that,r=this.getSBHeight(),o=i.$tbl;e=o&&o.length?t(o[0]).data("offsetHeight"):23,this.contHt=e+r-1,i.$cont.height(""),i.element.height(""),i.$grid_inner.height("")},r.setContAndGridWidthFromTable=function(){var t=this.that,i=e.call(t,-1,t.colModel.length),r=t.element,o=this.getSBWidth();this.contWd=i+o,r.width(this.contWd+"px")},r.getTotalVisibleRows=function(t,e,i){var r=this.that,o=this.estRowsInViewPort(),n=0,a=i?i.length:0,l=e,s=0,d=0,h=null,c=!1,u=!1,f=!!r.iHierarchy,p=r.options,g=p.detailModel.offset,v=0,w=this.rowHt,x=f?r.$cont[0].offsetHeight:void 0;if(null==i||0==a)return{initV:null,finalV:null,tvRows:n,lastFrozenRow:null};for(var m=0,I=a>e?e:a;m<I;m++){if(!(b=(_=i[m]).pq_hidden))if(h=m,n++,f)if((y=_.pq_detail)&&y.show)(q=y.height||0)>g&&(q=g),v+=q+w;else v+=w}if(a<e)return{initV:h,finalV:h,tvRows:n,lastFrozenRow:h};if(a>1e4&&null==p.groupModel)return(s=t+o)>=a&&(s=a-1),{initV:t+e,finalV:s,tvRows:a,lastFrozenRow:h};o-=n;for(m=e,I=a;m<I;m++){var _,b=(_=i[m]).pq_hidden;if(c?u||(b?s++:d===o?u=!0:(s++,d++)):b?l++:d===t?(c=!0,s=l,d=0):(l++,d++),!b&&(n++,f&&c)){var y,q;if((y=_.pq_detail)&&y.show)(q=y.height||0)>g&&(q=g),v+=q+w;else v+=w;v>x&&(u=!0)}}return l>=a&&(l=a-1),s<l&&(s=l),{initV:l,finalV:s,tvRows:n,lastFrozenRow:h}},r.calcInitFinal=function(){var t=this.that,e=t.options,i=e.virtualY,r=e.freezeRows,o="flex"===e.height,n=!!e.groupModel?t.dataGM:t.pdata;e.treeModel;if(null==n||0===n.length){var a=this.getTotalVisibleRows(s,r,n);t.totalVisibleRows=a.tvRows,t.initV=a.initV,t.finalV=a.finalV,t.lastFrozenRow=a.lastFrozenRow}else{if(!i){a=this.getTotalVisibleRows(0,r,n);return t.lastFrozenRow=a.lastFrozenRow,t.totalVisibleRows=a.tvRows,t.initV=0,void(t.finalV=n.length-1)}var l=t.$vscroll.pqScrollBar("option"),s=parseInt(l.cur_pos);if(isNaN(s)||s<0)throw"cur_pos NA";t.scrollCurPos=s;a=this.getTotalVisibleRows(s,r,n);t.totalVisibleRows=a.tvRows,t.initV=a.initV,t.lastFrozenRow=a.lastFrozenRow,t.finalV=o?n.length-1:a.finalV}},r.calcInitFinalH=function(){var t=this.that,i=t.options,r=i.virtualX,o=t.colModel,n=o.length;if(!r)return t.initH=0,void(t.finalH=n-1);!1===i.virtualXHeader&&(t.initHH=0,t.finalHH=n-1);for(var a=parseInt(t.$hscroll.pqScrollBar("option","cur_pos")),l=parseInt(i.freezeCols),s="flex"===i.width,d=l,h=0,c=l;c<n;c++)if(o[c].hidden)d++;else{if(h===a)break;d++,h++}if(d>n-1&&(d=n-1),t.initH=d,s||!r)t.finalH=n-1;else{var u=e.call(t,-1,l),f=this.getEContWd();for(c=d;c<n;c++){var p=o[c];if(!p.hidden){var g=p.outerWidth;if(!g&&i.debug)throw"outerwidth N/A";if((u+=g)>f)break}}var v=c;v>n-1&&(v=n-1),t.finalH=v}},r._calcOffset=function(t){var e=/(-|\+)([0-9]+)/.exec(t);return e&&3===e.length?parseInt(e[1]+e[2]):0},r.refreshGridWidthAndHeight=function(){var e,i,r=this.that,o=r.options,n=(o.width+"").indexOf("%")>-1,a=(o.height+"").indexOf("%")>-1,l=r.element;if(n||a){var s,d,h=l.parent();if(!h.length)return;h[0]==document.body||"fixed"==l.css("position")?(s=t(window).width(),d=window.innerHeight?window.innerHeight:t(window).height()):(s=h.width(),d=h.height());var c=null,u=this._calcOffset,f=n?u(o.width):0,p=a?u(o.height):0;if(0==s){for(;"BODY"!=h[0].tagName.toUpperCase();){var g=h.parent();if(null==g[0]){c=h;break}h=g}if(c){var v=c.css("position"),w=c.css("left"),x=c.css("top");c.css({position:"absolute",left:"-2000",top:"-2000"}).appendTo(t(document.body)),h=l.parent(),n&&(s=h.width()),a&&(d=h.height()),c.css({position:v,left:w,top:x})}}n&&(e=parseInt(o.width)*s/100+f),a&&(i=parseInt(o.height)*d/100+p)}n||(e=o.width),a||(i=o.height),parseFloat(e)==e?(e=e<o.minWidth?o.minWidth:e,l.width(e)):"auto"===e&&l.width(e),parseFloat(i)==i&&(i=i<o.minHeight?o.minHeight:i,l.height(i)),this.width=parseFloat(e)==e?Math.round(e):"auto"===e?Math.round(l.width()):null,this.height=parseFloat(i)==i?Math.round(i):null},r.decidePanes=function(){var t=this.that,e=t.pqpanes={v:!1,h:!1,vH:!1},i=t.options,r=i.virtualX,o=i.virtualXHeader,n=i.virtualY,a="flex"==i.height,l="flex"==i.width,s=i.numberCell,d=i.freezeRows,h=i.freezeCols;!d||a||!h&&!s.show||l?d&&!a?n||(e.h=!0):!h&&!s.show||l||(r||(e.v=!0,e.vH=!0),!1===o&&(e.vH=!0)):(n||(e.h=!0),r||(e.v=!0,e.vH=!0),!1===o&&(e.vH=!0))},r._storeColumnWidths=function(t){for(var e=this.that,i=e.colModel,r=t?0:e.initH,o=t?i.length-1:e.finalH,n=[],a=r;a<=o;a++)n[a]={outerWidth:i[a].outerWidth};return n},r._isColumnWidthChanged=function(t){for(var e=this.that,i=e.colModel,r=e.initH,o=e.finalH,n=r;n<=o;n++)if(i[n].outerWidth!==t[n].outerWidth)return!0;return!1},r.refreshScrollbars=function(){var t=this.that,e=t.options,i="flex"===e.height,r="flex"===e.width;if((i||this.contHt)&&(r||this.contWd)&&null!==t.totalVisibleRows){var o=this._setScrollVNumEles(!0),n=o>1;if(!i&&n!==this.vscroll&&(this.vscroll=n,e.scrollModel.autoFit||e.virtualX)){var a=this._storeColumnWidths();this.refreshColumnWidths(),this._isColumnWidthChanged(a)&&(this.ignoreTResize=!0,this._refreshTableWidths(a,{table:!0,header:!0}),delete this.ignoreTResize,e.virtualX&&(this.setContAndHeaderHeight(),t.iGenerateView.setPanes(),n=(o=this._setScrollVNumEles(!0))>1,this.vscroll=n)),a=null}o=this._setScrollHNumEles(),this.hscroll=o>1,this._setScrollHLength(),this._setScrollVLength(),this._setScrollHVLength()}},r._setScrollHVLength=function(){var t=this.that;this.vscroll&&this.hscroll||t.$hvscroll.css("visibility","hidden")},r._setScrollHLength=function(){var t=this.that,e=t.$hscroll,i=t.$hvscroll;if(!t.options.scrollModel.horizontal)return e.css("visibility","hidden"),void i.css("visibility","hidden");e.css("visibility",""),i.css("visibility","");var r=this.contWd,o=this.getSBWidth();e.css("right",0===o?0:""),e.pqScrollBar("option","length",r-o)},r.estVscroll=function(){var t=this.that;if(null==t.totalVisibleRows||null==this.contHt)throw"failed";var e=!0;t.totalVisibleRows*this.rowHt<this.contHt&&(e=!1),this.vscroll=e},r.getSBWidth=function(){return"flex"===this.that.options.height?0:(null==this.vscroll&&this.estVscroll(),this.vscroll?17:0)},r.estHscroll=function(){var t=this.that;if(null==this.contWd)throw"failed";var e=!1;this.calcColsOutsideCont(t.colModel)+1>1&&(e=!0),this.hscroll=e},r.getSBHeight=function(){return"flex"===this.that.options.width?0:(null==this.hscroll&&this.estHscroll(),this.hscroll?17:0)},r.getEContHt=function(){if(null==this.contHt)throw"contHt N/A";return this.contHt-this.getSBHeight()},r.getEContWd=function(){if(null==this.contWd)throw"contWd N/A";return this.contWd-this.getSBWidth()},r.calcColsOutsideCont=function(t){var e=this.that.options,i=e.numberCell,r=e.freezeCols,o=this.contWd-this.getSBWidth(),n=0;i.show&&(n+=i.outerWidth);for(var a=0;a<t.length;a++){var l=t[a];l.hidden||(n+=l.outerWidth)}var s=0,d=0,h=Math.round(n);for(h>o&&d++,a=r;a<t.length;a++)if(!(l=t[a]).hidden){if(!((h=n-(s+=l.outerWidth))>o))break;d++}return d},r._setScrollHNumEles=function(){var t=this.that,e=t.options,i=t.colModel,r=e.scrollModel,o=0;return"flex"!==e.width&&(o="fullScroll"===r.lastColumn?i.length-e.freezeCols-t._calcNumHiddenUnFrozens():this.calcColsOutsideCont(i)+1),t.$hscroll.pqScrollBar("option","num_eles",o),o},r.init=function(){var t=this.that,e=t.options;this.hscroll=this.vscroll=this.contHt=this.contWd=null,t.initH=t.initV=t.finalH=t.finalV=null,t.totalVisibleRows=t.lastFrozenRow=null,this.rowHt=22+(e.rowBorders?1:0),this.headerHt=0},r.initContHtAndWidth=function(){var t=this.that,e=t.options;"flex"!==e.width&&(this.contWd=this.width),"flex"!==e.height&&(this.contHt=this.height-(e.showHeader?this.rowHt:0)-(e.showTop?t.$top[0].offsetHeight:0)-(e.showBottom?t.$bottom[0].offsetHeight:0))},r._refresh=function(t){t=t||{};var e=this.that,i=t.header,r=t.table,o=e.element;if(o[0].offsetWidth){e.iMouseSelection.resetMargins(),this.init(),e.$grid_inner[0].scrollTop=0;var n=e.options;if(this.decidePanes(),n.collapsible._collapsed=!1,this.refreshGridWidthAndHeight(),this.initContHtAndWidth(),this.calcInitFinal(),!1===i||!1===r)var a=this._storeColumnWidths(!0);this.refreshColumnWidths(),this.calcInitFinalH(),this._refreshHideArrHS(),!1!==i?e._createHeader():this._isColumnWidthChanged(a)&&this._refreshTableWidths(a,{header:!0}),e._refreshHeaderSortIcons(),e._refreshPager(),this.setContAndHeaderHeight(),!1!==r?e.iGenerateView.generateView():(this._refreshTableWidths(a,{table:!0}),e._saveDims(),e.iGenerateView.scrollView()),this.refreshScrollbars(),"flex"==n.height&&this.setContAndGridHeightFromTable(),"flex"==n.width&&this.setContAndGridWidthFromTable(),this._refreshFrozenLine(),e._createCollapse(),n.dataModel.postDataOnce=void 0}else o.addClass("pq-pending-refresh")},r._refreshTableWidths=function(t,e){for(var i,r=this.that,o=r.colModel,n=r.$tbl_header,a=e.header&&n,l=r.$tbl,s=e.table&&l,d=r.initH,h=r.finalH,c=a?n.find("tr:nth-child(1):first"):null,u=a?r.$header.find("div.pq-grid-col-resize-handle"):null,f=s?l.find(".pq-row-hidden:first"):null,p=!1,g=0,v=d;v<=h;v++){var w=o[v],x=t[v];if(!w.hidden){var m=x.outerWidth,I=w.outerWidth;if(I!==m&&(a&&c.find("td[pq-col-indx="+v+"]").width(I),f&&(i=f.find("td[pq-col-indx="+v+"]")).length&&(p=!0,i.width(I))),g+=I-m,a&&0!==g){var _=u.filter("[pq-col-indx="+v+"]"),b=parseInt(_.css("left"));_.css("left",b+g)}}}p&&r._trigger("tableWidthChange"),r._saveDims()}}(jQuery),function(t){var e=t.paramquery.cClass,i=(t.paramquery.pqgrid.calcWidthCols,{getFocusElement:function(){var e=document.activeElement;if(e){var i=t(e),r=i.closest(".pq-grid");if(r.length)return r[0]==this.element[0]?{$ae:i,$grid:r}:{$ae:i,$childGrid:r}}},rowExpand:function(t){this.iHierarchy.rowExpand(t)},rowInvalidate:function(t){this.iHierarchy.rowInvalidate(t)},rowCollapse:function(t){this.iHierarchy.rowCollapse(t)}}),r=function(e){this.that=e;var i=this;this.dataHS={};var r=e.widgetEventPrefix.toLowerCase(),o=e.eventNamespace;function n(t,i,r){e.filter({data:[{dataIndx:t,value:i,value2:r}]})}e.element.on(r+"headerkeydown"+o,function(e,r){if(i.belongs(e)){var o=t(e.originalEvent.target);return!o.hasClass("pq-grid-hd-search-field")||i.onKeyDown(e,r,o)}}),e.element.on(r+"createheader"+o,function(t,e){if(i.belongs(t))return i._onCreateHeader()}),this.changeListener={change:function(t,e){n(e.dataIndx,e.value,e.value2)}},this.keyupListener={keyup:function(t,e){n(e.dataIndx,e.value,e.value2)}},this.clickListener={click:function(t,e){n(e.dataIndx,e.value)}}},o=r.prototype=new e;o.get$Ele=function(e,i){var r=this.that,o=r.options.freezeCols,n=t(r.$tbl_header[0]),a=".pq-grid-hd-search-field[name='"+i+"']",l=t(r.$tbl_header[2==r.$tbl_header.length?1:0]);return e>=o?l.find(a):n.find(a)},o.onKeyDown=function(e,i,r){var o=this.that;if(e.keyCode!==t.ui.keyCode.TAB)return!0;var n=r.attr("name"),a=o.getColIndx({dataIndx:n}),l=o.colModel,s=e.shiftKey;if("between"==(h=l[a]).filter.condition){o.scrollColumn({colIndx:a});var d=this.get$Ele(a,n);if(d[0]==r[0]?s||(u=d[1]):s&&(u=d[0]),u)return u.focus(),e.preventDefault(),!1}for(;;){if(s?a--:a++,a<0||a>=l.length)break;var h,c=(h=l[a]).filter;if(!h.hidden&&c){o.scrollColumn({colIndx:a});n=h.dataIndx;var u=this.get$Ele(a,n);if("between"==c.condition&&(u=t(s?u[1]:u[0])),u)return u.focus(),e.preventDefault(),!1;break}}},o._bindFocus=function(){var e=this.that,i=this;function r(r){e._fixTableViewPort();var o=t(r.target).closest(".pq-grid-hd-search-field").attr("name");if(e.scrollColumn({dataIndx:o})){var n=e.getColIndx({dataIndx:o});i.get$Ele(n,o).focus()}}for(var o=e.$header.find(".pq-grid-header-search-row"),n=0;n<o.length;n++)t(o[n]).on("focusin",r)},o._onCreateHeader=function(){var e=this.that,i=e.options;i.columnBorders;if(i.filterModel.header){this._bindFocus();var r=e.colModel,o=i.freezeCols,n=i.virtualX,a=i.virtualXHeader,l=!1===a?e.initHH:e.initH,s=!1===a?e.finalHH:e.finalH,d=e.$tbl_header,h=t(d[0]),c=t(d[1]),u="input,select";if(d.length>1){h.find(u).css("visibility","hidden");for(var f=0;f<o;f++){u="*[name='"+(p=r[f]).dataIndx+"']";h.find(u).css("visibility","visible"),c.find(u).css("visibility","hidden")}}for(f=0;f<=s;f++){if(f<l&&f>=o&&n&&(f=l)>s)throw"initH>finalH";var p;if(!(p=r[f]).hidden){var g=p.filter;if(g){var v=p.dataIndx,w=h;f>=o&&d.length>1&&(w=c);var x=w.find("*[name='"+v+"']");if(0!=x.length){var m=g.type,I=g.value,_=g.value2;"checkbox"==m&&"triple"==g.subtype?x.pqval({val:I}):"select"==m&&null!=I&&x.val(I);var b=g.init;b&&b.call(x,{dataIndx:v,column:p});var y=g.listeners;if(y)for(var q=0;q<y.length;q++){var C=y[q];for(var R in"string"==typeof C&&(C=this[C+"Listener"]),C){!function(i,r,o){i.bind(R,function(n){var a=e.getColumn({dataIndx:o}),l=a.filter;return"checkbox"==l.type?I="triple"==l.subtype?i.pqval({incr:!0}):!!i.is(":checked"):"between"==l.condition?(I=t(i[0]).val(),_=t(i[1]).val()):I=i.val(),r.call(this,n,{column:a,dataIndx:o,value:I,value2:_})})}(x,C[R],v)}}}}}}}},o.createDOM=function(e,i){var r=this.that,o=r.options,n=o.virtualX,a=o.virtualXHeader,l=!1===a?r.initHH:r.initH,s=!1===a?r.finalHH:r.finalH,d=o.freezeCols,h=r.colModel,c=(this.dataHS,o.numberCell),u=function(t,e){return["<div class='pq-from-div'>",t,"</div>","<span class='pq-from-to-center'>-</span>","<div class='pq-to-div'>",e,"</div>"].join("")};e.push("<tr class='pq-grid-header-search-row'>"),c.show&&e.push(["<td pq-col-indx='-1' class='pq-grid-number-col' rowspan='1'>","<div class='pq-td-div'>&nbsp;</div></td>"].join(""));for(var f=0;f<=s;f++){if(f<l&&f>=d&&n&&(f=l)>s)throw"initH>finalH";var p=h[f];if(!p.hidden){var g=i,v=p.halign;v||(v=p.align),"right"==v?g+=" pq-align-right":"center"==v&&(g+=" pq-align-center");var w=p.cls;w&&(g=g+" "+w);var x=p.filter;if(x){var m=p.dataIndx,I=x.type,_=x.value,b=x.condition,y="pq-grid-hd-search-field "+((y=x.cls)||""),q=(q=x.style)||"",C=(C=x.attr)||"",R="";if("between"==b)var M=null!=(M=x.value2)?M:"";if("textbox"===I)_=_||"",y+=" ui-corner-all pq-search-txt",R="between"==b?u(this._input(m,_,y+" pq-from",q,C),this._input(m,M,y+" pq-to",q,C)):this._input(m,_,y,q,C);else if("textarea"===I)_=_||"",y+=" ui-corner-all pq-search-txt",R="between"==b?u(this._textarea(m,_,y+" pq-from",q,C),this._textarea(m,M,y+" pq-to",q,C)):this._textarea(m,_,y,q,C);else if("select"===I)if(x.cache)R=x.cache;else{var D=x.options;"function"==typeof D&&(D=D.call(r.element[0],{column:p,value:_,dataIndx:m,cls:y,style:q,attr:C}));var P=["name='",m,"' class='",y+=" ui-corner-all","' style='",q,"' ",C].join("");R=t.paramquery.select({options:D,attr:P,prepend:x.prepend,valueIndx:x.valueIndx,labelIndx:x.labelIndx,groupIndx:x.groupIndx}),x.cache=R}else if("checkbox"==I)R=["<input ",null==_||0==_?"":"checked=checked"," name='",m,"' type=checkbox class='"+y+"' style='"+q+"' "+C+"/>"].join("");else"string"==typeof I?R=I:"function"==typeof I&&(R=I.call(r.element[0],{width:wd,value:_,value2:M,column:p,dataIndx:m,cls:y,attr:C,style:q}));e.push(["<td class='",g,"'><div class='pq-td-div' >","",R,"</div></td>"].join(""))}else e.push(["<td class='",g,"'><div class='pq-td-div' >","&nbsp;","</div></td>"].join(""))}}e.push("</tr>")},o._input=function(t,e,i,r,o){return['<input value="',e,"\" name='",t,"' type=text style='"+r+"' class='"+i+"' "+o+" />"].join("")},o._textarea=function(t,e,i,r,o){return["<textarea name='",t,"' style='"+r+"' class='"+i+"' "+o+" >",e,"</textarea>"].join("")},t.paramquery.select=function(t){var e,i,r,o=t.attr,n=t.options,a=t.groupIndx,l=t.labelIndx,s=t.valueIndx,d=null!=l&&null!=s,h=null!=a,c=t.prepend,u=t.dataMap,f=function(){for(var t={},e=0;e<u.length;e++){var i=u[e];t[i]=x[i]}return"data-map='"+JSON.stringify(t)+"'"},p=["<select ",o," >"];if(c)for(var g in c)p.push('<option value="',g,'">',c[g],"</option>");if(n&&n.length){for(var v=0,w=n.length;v<w;v++){var x=n[v];if(d){var m=x[s],I=x.pq_disabled?'disabled="disabled" ':"",_=x.pq_selected?'selected="selected" ':"";if(null==m)continue;if(r=u?f():"",h){var b=x.pq_disabled_group?'disabled="disabled" ':"";i!=(e=x[a])&&(null!=i&&p.push("</optgroup>"),p.push('<optgroup label="',e,'" ',b," >"),i=e)}if(l==s)p.push("<option ",_,I,r,">",m,"</option>");else{var y=x[l];p.push("<option ",_,I,r,' value="',m,'">',y,"</option>")}}else if("object"==typeof x)for(var g in x)p.push('<option value="',g,'">',x[g],"</option>");else p.push("<option>",x,"</option>")}h&&p.push("</optgroup>")}return p.push("</select>"),p.join("")},t.fn.pqval=function(t){if(t){if(t.incr){var e=this.data("pq_value");return this.prop("indeterminate",!1),e?(e=!1,this.prop("checked",!1)):!1===e?(e=null,this.prop("indeterminate",!0),this.prop("checked",!1)):(e=!0,this.prop("checked",!0)),this.data("pq_value",e),e}e=t.val;return this.data("pq_value",e),this.prop("indeterminate",!1),null==e?(this.prop("indeterminate",!0),this.prop("checked",!1)):e?this.prop("checked",!0):this.prop("checked",!1),this}return this.data("pq_value")};var n={_generateTitleRow:function(t,e,i,r){var o=this.that.options.numberCell,n=e.groupTitle,a=e.level,l=e.GMRowIndx,s=t.title,d=(d=(d=t.icon)?d[a]:null)&&d.length&&2==d.length&&"function"==typeof d.push?d:["ui-icon-minus","ui-icon-plus"];if(s&&null!=s[a]){if(!1===(s=s[a]))return;n="function"==typeof s?s(e):(n=s.replace("{0}",n)).replace("{1}",e.items)}else n=n+" - "+e.items+" item(s)";var h='pq-group-row pq-grid-row",(lastFrozenRow?" pq-last-frozen-row":""),"',c=t.titleCls;c&&(c=c[a])&&(h+=" "+c),i.push(["<tr class='",h,"' title=\"",e.groupTitle,"\" level='",a,"' GMRowIndx='",l,"'>"].join("")),o.show&&i.push("<td class='pq-grid-number-cell ui-state-default'>&nbsp;</td>");var u=d[0];e.collapsed&&(u=d[1]),i.push("<td class='pq-grid-cell' colSpan='100' >","<div class='pq-td-div' style='margin-left:",16*a,"px;'>","<span class='ui-icon ",u,"'></span>",n,"</div></td>"),i.push("</tr>")},_generateSummaryRow:function(t,e,i,r,o){var n=e.level,a=e.rowData,l="pq-summary-row pq-grid-row"+(o?" pq-last-frozen-row":""),s=t.summaryCls;s&&(s=s[n])&&(l+=" "+s);var d=this.that,h=d.options,c=h.virtualX,u=d.initH,f=d.finalH,p=h.freezeCols,g=h.numberCell,v=h.columnBorders,w=(this.offset,"<tr class='"+l+"'>");r.push(w),g.show&&r.push(["<td class='pq-grid-number-cell ui-state-default'>","&nbsp;</td>"].join(""));for(var x=0;x<=f;x++){if(x<u&&x>=p&&c&&(x=u)>f)throw"initH>finalH";var m=i[x],I=m.dataIndx;if(!m.hidden){var _="pq-grid-cell ";"right"==m.align?_+=" pq-align-right":"center"==m.align&&(_+=" pq-align-center"),x==p-1&&v&&(_+=" pq-last-frozen-col"),m.cls&&(_=_+" "+m.cls);var b,y=a[I];y&&(b=m.summary.title)&&(b=b[n])&&("function"==typeof b?(e.dataIndx=I,e.cellData=y,y=b.call(d.element[0],e)):y=b.replace("{0}",y));var q=["<td class='",_,"' style='","","' >",y=null==y?"&nbsp;":y,"</td>"].join("");r.push(q)}}return r.push("</tr>"),r},_generateDetailRow:function(t,e,i,r,o,n){var a="pq-grid-row pq-detail-child";n&&(a+=" pq-last-frozen-row");var l=this.that.options,s=l.numberCell,d=(i.length,this.offset,"pq-grid-cell ");l.wrap&&!o||(d+="pq-wrap-text "),l.stripeRows&&e/2==parseInt(e/2)&&(a+=" pq-grid-oddRow"),t.pq_rowselect&&(a+=" pq-row-select ui-state-highlight");var h=t.pq_rowcls;return null!=h&&(a+=" "+h),r.push("<tr pq-row-indx='"+e+"' class='"+a+"' >"),s.show&&r.push(["<td class='pq-grid-number-cell ui-state-default'>","&nbsp;</td>"].join("")),r.push("<td class='"+d+" pq-detail-child' colSpan='20'></td>"),r.push("</tr>"),r}},a=function(t){this.that=t},l=a.prototype;l._refreshDataFromDataModel=function(){this._groupData(),this.initcollapsed()},l.bindEvents=function(){var t=this;this.that.$cont.on("click","tr.pq-group-row",function(e){return t.onClickGroupRow(e)})},l.showHideRows=function(t,e,i){for(var r=[],o=this.that.dataGM,n=t,a=o.length;n<a;n++){var l=o[n],s=l;if(s.groupSummary){if(l.level<e)break;l.pq_hidden=i}else if(s.groupTitle){if(l.collapsed&&r.push({indx:n,level:l.level}),l.level<=e)break;l.pq_hidden=i}else l.pq_hidden=i}return r},l.onClickGroupRow=function(e){var i=t(e.currentTarget),r=this.that,o=parseInt(i.attr("level")),n=parseInt(i.attr("GMRowIndx")),a=!0,l=r.dataGM[n];if(l.collapsed?(l.collapsed=!1,a=!1):(l.collapsed=!0,a=!0),a)this.showHideRows(n+1,o,!0);else for(var s=this.showHideRows(n+1,o,!1),d=0;d<s.length;d++){var h=s[d].indx;o=s[d].level;this.showHideRows(h+1,o,!0)}r.refresh()},l.initcollapsed=function(){var t=this.that.dataGM;if(t)for(var e=0,i=t.length;e<i;e++){var r=t[e];if(void 0!==r.groupTitle){var o=r.level;r.collapsed&&this.showHideRows(e+1,o,!0)}}},l.max=function(t,e){var i;return"integer"==e||"float"==e?(i=Math.max.apply(Math,t),"float"===e&&(i=i.toFixed(2))):i="date"==e?(t=t.sort(function(t,e){return(t=Date.parse(t))-(e=Date.parse(e))}))[t.length-1]:(t=t.sort())[t.length-1],i},l.min=function(t,e){var i;return"integer"==e||"float"==e?(i=Math.min.apply(Math,t),"float"===e&&(i=i.toFixed(2))):i="date"==e?(t=t.sort(function(t,e){return(t=Date.parse(t))-(e=Date.parse(e))}))[0]:(t=t.sort())[0],i},l.count=function(t){return t.length},l.sum=function(t,e){var i,r=0;i="float"===e?parseFloat:"integer"===e?parseInt:function(t){return t};for(var o=0,n=t.length;o<n;o++)r+=i(t[o]);return"float"===e&&(r=r.toFixed(2)),r},l._groupData=function(){for(var e=this.that,i=e.pdata,r=e.options,o=r.groupModel,n=r.pageModel,a=e.colModel,l=n.type?(n.curPage-1)*n.rPP:0,s=a.length,d=o.dataIndx,h=d.length,c=o.collapsed,u=[],f=0;f<h;f++){u[f]=!1;for(var p=0;p<s;p++){if(D=(E=a[p]).summary)if((P=D.type)&&"function"==typeof P.push&&P[f]){u[f]=!0;break}}}if(o&&i&&i.length>0){var g=[],v=[],w=[],x=[],m=[];for(f=0;f<h;f++)x[f]="",w[f]="",m[f]={};for(var I=0,_=i.length;I<=_;I++){var b=i[I],y=!1,q=null;for(f=0;f<h;f++)w[f]=I<_?t.trim(b[d[f]]):"",x[f]!=w[f]&&(y=!0),y&&null==q&&(q=f);if(y){for(var C=0;C<h;C++)x[C]=w[C];if(I>0){for(f=h-1;f>=q;f--)if(u[f]){for(var R=[],M=0;M<s;M++){var D,P;if(P=(D=(E=a[M]).summary)&&D.type?D.type[f]:null){var S=E.dataIndx,T="";T="function"==typeof P?P(m[f][S],E.dataType):this[P](m[f][S],E.dataType),R[S]=T}}g.push({groupSummary:!0,level:f,prevRowData:i[I-1],rowData:R})}for(var $=q;$<h;$++)g[v[$]].items=m[$][a[0].dataIndx].length}if(I==_)break;for(var H=h-1;H>=q;H--)for(var k=0;k<s;k++){var E=a[k];m[H][E.dataIndx]=[]}for($=q;$<h;$++)g.push({groupTitle:w[$],level:$,nextRowData:b,GMRowIndx:g.length,collapsed:!(!c||null==c[$])&&c[$]}),v[$]=g.length-1}if(I==_)break;b.rowIndx=I+l,b.pq_hidden=!1,g.push(b);for(var V=0;V<s;V++)for(S=(E=a[V]).dataIndx,f=0;f<h;f++)m[f][S].push(b[S])}e.dataGM=g}else e.dataGM=null},i.options={detailModel:{cache:!0,offset:100,expandIcon:"ui-icon-triangle-1-se",collapseIcon:"ui-icon-triangle-1-e"},dragColumns:{enabled:!0,acceptIcon:"ui-icon-check",rejectIcon:"ui-icon-closethick",topIcon:"ui-icon-circle-arrow-s",bottomIcon:"ui-icon-circle-arrow-n"},track:null,treeModel:{collapsed:!0,indent:15,leafIcon:"ui-icon-radio-off",expandIcon:"ui-icon-triangle-1-se",collapseIcon:"ui-icon-triangle-1-e"},filterModel:{on:!0,mode:"AND",header:!1}},i._create=function(){t.extend(t.paramquery.cGenerateView.prototype,n);var e=this.options;this.iHistory=new t.paramquery.cHistory(this),this.iGroupView=new a(this),this.iHeaderSearch=new r(this),this.iUCData=new t.paramquery.cUCData(this),this.iMouseSelection=new t.paramquery.cMouseSelection(this),this._super(),this.iGroupView.bindEvents(),this.iDragColumns=new t.paramquery.cDragColumns(this),this._createToolbar(),"remote"===e.dataModel.location&&this.refresh({table:!0}),this.refreshDataAndView({header:!0})},i._createToolbar=function(){var e=this.options,i=e.toolbar;if(i){var r=i,o=(o=r.cls)||"",n=(n=r.style)||"",a=(a=r.attr)||"",l=r.items,s=t("<div class='"+o+"' style='"+n+"' "+a+" ></div>").appendTo(t(".pq-grid-top",this.element));s.pqToolbar({items:l,gridInstance:this}),e.showToolbar||s.css("display","none"),this.$toolbar=s}},i.isLeftOrRight=function(t){this.options;return t>this.freezeCols?"right":"left"},i.ovCreateHeader=function(t,e){this.options.filterModel.header&&this.iHeaderSearch.createDOM(t,e)},i._createHeader=function(){this._super(),this.options.showHeader&&this._trigger("createHeader")},i.exportExcel=function(e){return e.format="xml",t.paramquery.pqgrid.exportToExcel.call(this,e)},i.exportCsv=function(e){return e.format="csv",t.paramquery.pqgrid.exportToExcel.call(this,e)},i.filter=function(e){var i=this,r=this.options,o=void 0===e.apply||e.apply,n=void 0===e.sort||e.sort,a=r.dataModel,l=r.filterModel;if(void 0!=e)for(var s="replace"==e.oper,d=e.data,h=this.colModel,c=0,u=(h=o?h:t.extend(!0,[],h)).length,f=d.length,p=0;p<u;p++){for(var g=h[p],v=!1,w=0;w<f&&c!=f;w++){var x=d[w];if(x.dataIndx==g.dataIndx){v=!0,c++;var m=g.filter,I=x.condition,_=x.value;if(m?m.on=!0:m=g.filter={on:!0},I&&(m.condition=I),I=m.condition,m.value=_,"between"==I)m.value2=x.value2;else if("range"==I){var b=[];if(_)if("string"==typeof _){var y=m.options,q=_.indexOf('"'),C=_.lastIndexOf('"');if(_=_.substr(q,C+1),_=JSON.parse("["+_+"]"),y)for(var R=0,M=y.length;R<M;R++){var D=y[R];-1!=t.inArray(D,_)&&b.push(D)}else b=_.split(",s*")}else"function"==typeof _.push&&(b=_);m.value=b}break}}s&&!v&&g.filter&&(g.filter.on=!1)}var P={header:!1,apply:o,sort:n,CM:h};if("remote"!=a.location||"local"==l.type)return P.source="filter",i._onDataAvailable(P);this.remoteRequest({apply:o,CM:h,callback:function(){return i._onDataAvailable(P)}})},i._initTypeColumns=function(){for(var e=this.colModel,i=0,r=e.length;i<r;i++){var o=e[i],n=o.type;"checkBoxSelection"===n?new t.paramquery.cCheckBoxColumn(this,o):"detail"===n&&(o.dataIndx="pq_detail",this.iHierarchy=new t.paramquery.cHierarchy(this))}},i.refreshHeader=function(){this._createHeader()},i.refreshDataFromDataModel=function(){this._super.apply(this),!!this.options.groupModel&&this.iGroupView._refreshDataFromDataModel()};var s=(t.paramquery.cSort=function(t){this.that=t}).prototype;s._refreshSorters=function(e,i){var r=this.that.options,o=r.dataModel,n=o.sortIndx,a=t.isArray(n),l=r.groupModel,s=l?l.dataIndx:null,d=l?l.dir:null,h=-1,c=[];if(l)for(var u=0;u<s.length;u++){var f=s[u];f==e&&(h=u),c.push({dataIndx:f,dir:d&&d[u]?d[u]:"up"})}if(-1!==h){var p="up"===c[h].dir?"down":"up";c[h].dir=p,d[h]=p}else if(null!=e)if(a){var g=t.inArray(e,o.sortIndx);if(-1!=g)"up"==o.sortDir[g]?o.sortDir[g]="down":1==n.length?o.sortDir[g]="up":(o.sortIndx.splice(g,1),o.sortDir.splice(g,1));else{var v=o.sortIndx.length;o.sortIndx[v]=e,o.sortDir[v]="up"}}else o.sortIndx==e?o.sortDir=i||("up"==o.sortDir?"down":"up"):(o.sortIndx=e,o.sortDir=i||"up");if(null!=o.sortIndx)if(a)for(u=0;u<n.length;u++){var w=n[u];-1==this.inSorters(c,w)&&c.push({dataIndx:w,dir:o.sortDir[u]})}else-1==this.inSorters(c,o.sortIndx)&&c.push({dataIndx:o.sortIndx,dir:o.sortDir});this.sorters=c},s.inSorters=function(t,e){for(var i=-1,r=0;r<t.length;r++){if(t[r].dataIndx==e){i=r;break}}return i},s.sortLocalData=function(t){for(var e=this.that,i=e.colModel,r=this.sorters,o=0;o<r.length;o++){var n=r[o],a=n.dataIndx,l=i[e.getColIndx({dataIndx:a})],s=l.sortType,d=l.dataType;n.dataType=d,n.sortType=s}return this._sortLocalData(r,t)},s._sortLocalData=function(t,e){if(null==e||0==e.length)return[];if(!t||!t.length)return e;function i(t,e,i,r){var o=t[i],n=e[i];return((o=o?parseInt(o,10):0)-(n=n?parseInt(n,10):0))*r}function r(t,e,i,r){var o=t[i],n=e[i];return((o=o?Date.parse(o):0)-(n=n?Date.parse(n):0))*r}function o(t,e,i,r){var o=(t[i]+"").replace(/,/g,""),n=(e[i]+"").replace(/,/g,"");return((o=o?parseFloat(o):0)-(n=n?parseFloat(n):0))*r}function n(t,e,i,r){var o=t[i],n=e[i],a=0;return(o=o||"")>(n=n||"")?a=1:o<n&&(a=-1),a*r}function a(t,e,i,r){var o=t[i],n=e[i],a=0;return(o=o?o.toUpperCase():"")>(n=n?n.toUpperCase():"")?a=1:o<n&&(a=-1),a*r}function l(t,e,i,r){var o=t[i],n=e[i],a=0;return o&&!n||!1===o&&null===n?a=1:(n&&!o||!1===n&&null===o)&&(a=-1),a*r}return function(){for(var s=[],d=[],h=[],c=t.length,u=0;u<c;u++){var f=t[u],p=f.dataIndx,g="up"==f.dir?1:-1,v=f.sortType,w=f.dataType;d[u]=p,h[u]=g,s[u]="integer"==w?i:"float"==w?o:"function"==typeof w?function(t){return function(e,i,r,o){return n=i,l=o,t(e[a=r],n[a])*l;var n,a,l}}(w):v?function(t){return function(e,i,r,o){return n=o,t(e,i,r)*n;var n}}(v):"date"==w?r:"stringi"==w?a:"bool"==w?l:n}e=e.sort(function(t,e){for(var i=0,r=0;r<c&&0==(i=s[r](t,e,d[r],h[r]));r++);return i})}(),e},i._refreshHeaderSortIcons=function(){this.iHeader.refreshHeaderSortIcons()},i.getIndxInSorters=function(t){for(var e=this.sorters,i=0,r=e.length;i<r;i++)if(e[i].dataIndx==t)return i;return-1},i.getLargestRowCol=function(t){for(var e,i=0;i<t.length;i++){var r=t[i],o=r.rowIndx;null==e?e=r.rowIndx:o>e&&(e=o),e=r.rowIndx}},i.bringCellToView=function(t){this._bringCellToView(t)},i._setUrl=function(t){this.options.dataModel.getUrl=function(){return{url:this.url+(null!=t?t:"")}}},i.getDataPage=function(){return this.pdata},i.getData=function(t){var e=t.dataIndx,i=e.length,r=t.data,o=this.options.dataModel,n=o.data,a=o.dataUF,l=[],s=function(t){for(var r=0,o=t.length;r<o;r++){for(var n=t[r],a={},s=0;s<i;s++){var d=e[s];a[d]=n[d]}l.push(a)}};r?s(r):(n&&s(n),a&&s(a));for(var d=[],h=0;h<i;h++){var c=e[h],u=this.getColumn({dataIndx:c});d.push({dataIndx:c,dir:"up",dataType:u.dataType})}l=this.iSort._sortLocalData(d,l);for(var f=[],p=void 0,g=0;g<l.length;g++){var v=l[g],w=JSON.stringify(v);w!==p&&(f.push(v),p=w)}return f},i.getFilterData=function(e){var i=e.CM;if(!i)throw"CM N/A";for(var r=i.length,o=e.location,n=this.options.filterModel.multiple,a=t.paramquery.filter.getAllConditions,l=t.paramquery.filter.getTRConditions,s=[],h=function(e,i,r){return"between"==e?null!=i&&""!==i||null!=r&&""!==r:-1==t.inArray(e,a)||(null!=i&&""!==i||-1==t.inArray(e,l))},c=function(t,e){return"remote"==o?(t=null==t?"":t).toString():d.convert(t,e)},u=0;u<r;u++){var f=i[u],p=f.dataIndx,g=(g=f.dataType)&&"function"!=typeof g?g:"string",v=f.filter;if(n){var w=f.filterModel;if(w&&w.on){for(var x=[],m=w.mode,I=w.filters,_=0;_<I.length;_++){var b=(v=I[_]).value;h(y=v.condition,b)&&(b=c(b,g),x.push({value:b,condition:y}))}s.push({dataIndx:p,mode:m,dataType:g,filters:x})}}else if(v&&v.on){b=v.value;var y,q=v.value2;if(h(y=v.condition,b,q)){if("between"==y)""===b||null==b?(y="lte",b=c(q,g)):""===q||null==q?(y="gte",b=c(b,g)):(b=c(b,g),q=c(q,g));else if("regexp"==y){if("remote"==o)b=b.toString();else if("string"==typeof b)try{var C=(C=v.modifiers)||"gi";b=new RegExp(b,C)}catch(t){b=/.*/}}else if("range"==y){if(null==b)continue;if("string"==typeof b)b=(b=c(b,g)).split(/\s*,\s*/);else if(b&&"function"==typeof b.push){if(0==b.length)continue;_=0;for(var R=(b=b.slice()).length;_<R;_++)b[_]=c(b[_],g)}}else b=c(b,g);s.push({dataIndx:p,value:b,value2:q,condition:y,dataType:g,cbFn:"remote"==o?"":d.conditions[y]})}}}return s};var d=function(t){this.that=t},h=d.prototype;d.conditions={equal:function(t,e){if(t==e)return!0},contain:function(t,e){if(-1!=t.indexOf(e))return!0},notcontain:function(t,e){if(-1==t.indexOf(e))return!0},empty:function(t){if(0==t.length)return!0},notempty:function(t){if(t.length>0)return!0},begin:function(t,e){if(0==(t+"").indexOf(e))return!0},notbegin:function(t,e){if(0!=t.indexOf(e))return!0},end:function(t,e){var i=t.lastIndexOf(e);if(-1!=i&&i+e.length==t.length)return!0},notend:function(t,e){var i=t.lastIndexOf(e);if(-1==i||i+e.length!=t.length)return!0},regexp:function(t,e){if(e.test(t))return e.lastIndex=0,!0},notequal:function(t,e){if(t!=e)return!0},great:function(t,e){if(t>e)return!0},gte:function(t,e){if(t>=e)return!0},between:function(t,e,i){if(t>=e&&t<=i)return!0},range:function(e,i){if(-1!=t.inArray(e,i))return!0},less:function(t,e){if(t<e)return!0},lte:function(t,e){if(t<=e)return!0}},d.convert=function(e,i){return e=null==e?"":e,"string"==i?e=t.trim(e).toUpperCase():"date"==i?e=Date.parse(e):"integer"==i?e=parseInt(e):"float"==i?e=parseFloat(e):"bool"==i&&(e=String(e).toLowerCase()),e},h.isMatchCellSingle=function(t,e){var i=t.dataIndx,r=t.dataType,o=t.value,n=t.value2,a=t.condition,l=t.cbFn,s=e[i];return!!l(s="regexp"==a?null==s?"":s:d.convert(s,r),o,n)},h.isMatchCellMultiple=function(t,e){var i=t.dataIndx,r=t.dataType,o=t.mode,n=t.filters,a=n.length;if(0==a)return!0;for(var l=0;l<a;l++){var s=n[l],d=s.value,h=s.condition,c=e[i],u=this.isMatchRule(c,h,d,r);if("OR"==o&&u)return!0;if("AND"==o&&!u)return!1}return 1===a?u:"AND"==o||"OR"!=o&&void 0},h.isMatchRow=function(t,e,i){if(0==e.length)return!0;for(var r=0;r<e.length;r++){var o=e[r],n=this.isMatchCell(o,t);if("OR"==i&&n)return!0;if("AND"==i&&!n)return!1}return"AND"==i||"OR"!=i&&void 0},i.filterLocalData=function(t){var e=(t=t||{}).apply,i=!1===e?t.CM:this.colModel,r=this.getFilterData({CM:i}),o=this.options,n=o.dataModel,a=n.data,l=n.dataUF,s=[],h=[],c=o.filterModel,u=c.multiple,f=c?c.mode:null,p=new d;if(p.isMatchCell=u?p.isMatchCellMultiple:p.isMatchCellSingle,c.on&&f){if(a)for(var g=0,v=a.length;g<v;g++){var w=a[g];p.isMatchRow(w,r,f)?s.push(w):h.push(w)}if(l)for(g=0,v=l.length;g<v;g++){w=l[g];p.isMatchRow(w,r,f)?s.push(w):h.push(w)}}else{if(a)for(g=0,v=a.length;g<v;g++){w=a[g];s.push(w)}if(l)for(g=0,v=l.length;g<v;g++){w=l[g];s.push(w)}}return e&&(n.data=s,n.dataUF=h,this._trigger("filter",null,{type:"local",dataModel:n,colModel:i,filterModel:c})),{data:s,dataUF:h}},i._onDataAvailable=function(t){t=t||{};var e=this.options,i=t.apply,r=t.source,o=t.sort,n=[],a=e.filterModel,l=e.dataModel,s=l.location;if(!1!==i&&this._trigger("dataAvailable",t.evt,{dataModel:l,source:r}),n=a&&a.on&&("local"==s&&"remote"!=a.type||"remote"==s&&"local"==a.type)?this.filterLocalData(t).data:l.data,l.sorting&&"local"==l.sorting&&!1!==o&&(n=this.iSort.sortLocalData(n)),!1===i)return n;l.data=n,this.refreshView(t)},i.sort=function(t){t=t||{};var e=this,i=this.options,r=t.colIndx,o=i.editModel,n=t.dataIndx,a=t.dir,l=t.evt,s=i.dataModel;if(null!=r||null!=n||null!=(n=s.sortIndx)){r=null==r?this.getColIndx({dataIndx:n}):r;var d=this.colModel[r];n=null==n?d.dataIndx:n,0!=e._trigger("beforeSort",l,{dataModel:s,column:d,dataIndx:n})&&(o.indices&&e.blurEditor({force:!0}),this.iSort._refreshSorters(n,a),"local"==s.sorting?(this.iSort.sortLocalData(s.data),e._trigger("sort",l,{dataModel:s,column:d,dataIndx:n}),this.refreshView()):"remote"==s.sorting&&this.remoteRequest({callback:function(){e._trigger("sort",l,{dataModel:s,column:d,dataIndx:n}),e._onDataAvailable()}}))}},t.widget("paramquery.pqGrid",t.paramquery._pqGrid,i),t.paramquery.pqGrid.regional={},t.paramquery.pqGrid.regional.en=i._regional}(jQuery),function(t){t.paramquery=null==t.paramquery?{}:t.paramquery,t.paramquery.pqgrid=null==t.paramquery.pqgrid?{}:t.paramquery.pqgrid,t.paramquery.pqgrid.exportToExcel=function(e){var i=this,r=void 0===e.urlPost?e.url:e.urlPost,o=e.url,n=null==e.sheetName?"pqGrid":e.sheetName,a=e.format,l="xml"==a?function(){for(var t,e=i.colModel,r=e.length,o=i.options.dataModel.data,a=o.length,l=[],s=[],d=0;d<r;d++)!1!==(u=e[d]).copy&&((t=u._width)||(t=parseInt(u.width))||(t=100),s.push('<Column ss:AutoFitWidth="1"  ss:Width="'+t+'" />'));s.push("<Row>");for(d=0;d<r;d++)!1!==(u=e[d]).copy&&s.push('<Cell><Data ss:Type="String">'+u.title+"</Data></Cell>");s.push("</Row>"),s=s.join("\n");for(d=0;d<a;d++){var h=o[d];l.push("<Row>");for(var c=0;c<r;c++){var u;if(!1!==(u=e[c]).copy){var f=u.dataIndx;l.push('<Cell><Data ss:Type="String"><![CDATA['+h[f]+"]]></Data></Cell>")}}l.push("</Row>")}return l=l.join("\n"),['<?xml version="1.0"?>','<?mso-application progid="Excel.Sheet"?>','<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"',' xmlns:o="urn:schemas-microsoft-com:office:office"',' xmlns:x="urn:schemas-microsoft-com:office:excel"',' xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"',' xmlns:html="http://www.w3.org/TR/REC-html40">','<Worksheet ss:Name="',n,'">',"<Table>",s,l,"</Table>","</Worksheet>","</Workbook>"].join("\n")}():function(){for(var t=i.colModel,e=t.length,r=i.options.dataModel.data,o=r.length,n=[],a=[],l=[],s=0;s<e;s++)if(!1!==(u=t[s]).copy){var d=u.title.replace(/\"/g,'""');a.push('"'+d+'"')}n.push(a.join(","));for(s=0;s<o;s++){for(var h=r[s],c=0;c<e;c++){var u;if(!1!==(u=t[c]).copy){var f=h[u.dataIndx]+"";f=f.replace(/\"/g,'""'),l.push('"'+f+'"')}}n.push(l.join(",")),l=[]}return n.join("\n")}();t.ajax({url:r,type:"POST",cache:!1,data:{extension:a,excel:l},success:function(e){var i=o+(o.indexOf("?")>0?"&":"?")+"filename="+e;t(document.body).append("<iframe height='0' width='0' frameborder='0'  src="+i+"></iframe>")}})}}(jQuery),function(t){var e=t.paramquery.pqGrid.prototype.options;e.trackModel=e.trackModel||{on:!1,dirtyClass:"pq-cell-dirty"};var i=(t.paramquery.cUCData=function(t){this.that=t,this.udata=[],this.ddata=[],this.adata=[],this.options=t.options;var e=this,i=t.eventNamespace,r=t.widgetEventPrefix.toLowerCase();t.element.on(r+"dataavailable"+i,function(t,i){e.belongs(t)&&"filter"!=i.source&&(e.udata=[],e.ddata=[],e.adata=[])})}).prototype=new t.paramquery.cClass;i.add=function(t){for(var e=this.that,i=this.adata,r=t.rowData,o=this.options.trackModel.dirtyClass,n=e.getRecId({rowData:r}),a=0,l=i.length;a<l;a++){var s=i[a];if(null!=n&&s.recId==n)throw"primary key violation";if(s.rowData==r)throw"same data can't be added twice."}var d=[];for(var h in r)d.push(h);e.removeClass({rowData:r,dataIndx:d,cls:o});t={recId:n,rowData:r};i.push(t)},i.update=function(e){var i=this.that,r=this.options.trackModel.dirtyClass,o=e.rowData||i.getRowData(e),n=i.getRecId({rowData:o}),a=e.dataIndx,l=e.refresh,s=i.columns,d=t.paramquery.getValueFromDataType,h=e.row,c=this.udata,u=c.slice(0),f=!1;if(null!=n){for(var p=0,g=c.length;p<g;p++){var v=c[p],w=v.oldRow;if(v.rowData==o){for(var a in f=!0,h){var x=s[a].dataType,m=d(m=h[a],x),I=d(I=w[a],x);if(w.hasOwnProperty(a)&&I===m){var _={rowData:o,dataIndx:a,refresh:l,cls:r};i.removeClass(_),delete w[a]}else{_={rowData:o,dataIndx:a,refresh:l,cls:r};i.addClass(_),w.hasOwnProperty(a)||(w[a]=o[a])}}t.isEmptyObject(w)&&u.splice(p,1);break}}if(!f){w={};for(var a in h){w[a]=o[a];_={rowData:o,dataIndx:a,refresh:l,cls:r};i.addClass(_)}_={rowData:o,recId:n,oldRow:w};u.push(_)}this.udata=u}},i.delete=function(t){for(var e=this.that,i=t.rowIndx,r=t.rowIndxPage,o=e.rowIndxOffset,n=(i=null==i?r+o:i,r=null==r?i-o:r,"remote"==e.options.pageModel.type?r:i),a=this.adata,l=this.ddata,s=e.getRowData(t),d=0,h=a.length;d<h;d++)if(a[d].rowData==s)return void a.splice(d,1);l.push({indx:n,rowData:s,rowIndx:i})},i.isDirty=function(t){var e=this.that,i=this.udata,r=this.adata,o=this.ddata,n=!1,a=e.getRowData(t);if(a)for(var l=0;l<i.length;l++){if(a==i[l].rowData){n=!0;break}}else(i.length||r.length||o.length)&&(n=!0);return n},i.getChangesValue=function(){this.that;for(var e=this.udata,i=this.adata,r=this.ddata,o={updateList:[],addList:[],deleteList:[]},n=[],a=[],l=[],s=[],d=[],h=0,c=r.length;h<c;h++){var u=r[h].rowData,f={};for(var p in s.push(u),u)0!=p.indexOf("pq_")&&(f[p]=u[p]);d.push(f)}for(h=0;h<e.length;h++){u=e[h].rowData;if(-1==t.inArray(u,s)&&-1==t.inArray(u,n)){f={};for(var p in u)0!=p.indexOf("pq_")&&(f[p]=u[p]);n.push(u),a.push(f)}}for(h=0;h<i.length;h++){u=i[h].rowData,f={};for(var p in u)0!=p.indexOf("pq_")&&(f[p]=u[p]);l.push(f)}return o.updateList=a,o.addList=l,o.deleteList=d,o},i.getChanges=function(){this.that;for(var e=this.udata,i=this.adata,r=this.ddata,o={updateList:[],addList:[],deleteList:[]},n=[],a=[],l=[],s=0,d=r.length;s<d;s++){var h=r[s].rowData;l.push(h)}for(s=0,d=e.length;s<d;s++){h=e[s].rowData;-1==t.inArray(h,l)&&(-1==t.inArray(h,n)&&n.push(h))}for(s=0,d=i.length;s<d;s++){h=i[s].rowData;a.push(h)}return o.updateList=n,o.addList=a,o.deleteList=l,o},i.getChangesRaw=function(){this.that;var t=this.udata,e=this.adata,i=this.ddata,r={updateList:[],addList:[],deleteList:[]};return r.updateList=t,r.addList=e,r.deleteList=i,r},i.commitAdd=function(e,i){for(var r=this.that.colModel,o=r.length,n=this.adata,a=t.inArray,l=n.length,s=t.paramquery.getValueFromDataType,d=[],h=e.length,c=[],u=0;u<h;u++)for(var f=e[u],p=0;p<l;p++){var g=!0;if(-1==a(q=n[p].rowData,c)){for(var v=0;v<o;v++){var w=r[v],x=w.hidden,m=w.dataType,I=w.dataIndx;if(!x&&I!=i)if(s(q[I],m)!==s(f[I],m)){g=!1;break}}if(g){var _={},b={};_[i]=f[i],b[i]=q[i],d.push({type:"update",rowData:q,oldRow:b,newRow:_}),c.push(q);break}}}var y=[];for(p=0;p<l;p++){var q;-1==a(q=n[p].rowData,c)&&y.push(n[p])}return this.adata=y,d},i.commitUpdate=function(e,i){for(var r=this.that,o=this.options.trackModel.dirtyClass,n=r.colModel,a=n.length,l=this.udata,s=l.length,d=e.length,h=[],c=0;c<s;c++){var u=l[c],f=u.rowData,p=u.oldRow;if(-1==t.inArray(f,h))for(var g=0;g<d;g++){var v=e[g];if(f[i]==v[i]){h.push(f);for(var w=0;w<a;w++)var x=n[w].dataIndx;for(var x in p)r.removeClass({rowData:f,dataIndx:x,cls:o})}}}var m=[];for(c=0;c<s;c++){f=l[c].rowData;-1==t.inArray(f,h)&&m.push(l[c])}return this.udata=m,[]},i.commitDelete=function(e,i){for(var r=this.ddata,o=r.length,n=e.length,a=[],l=0;l<o;l++)for(var s=r[l].rowData,d=0;d<n;d++){var h=e[d];s[i]==h[i]&&a.push(s)}var c=[];for(l=0;l<o;l++){s=r[l].rowData;-1==t.inArray(s,a)&&c.push(r[l])}this.ddata=c},i.commitUpdateAll=function(){for(var t=this.that,e=this.options.trackModel.dirtyClass,i=this.udata,r=0,o=i.length;r<o;r++){var n=i[r],a=n.oldRow,l=n.rowData;for(var s in a)t.removeClass({rowData:l,dataIndx:s,cls:e})}this.udata=[]},i.commitAddAll=function(){this.adata=[]},i.commitDeleteAll=function(){this.ddata=[]},i.commit=function(t){var e,i=this.that,r=null!=(r=t?t.history:null)&&r,o=[],n=[],a=i.options.dataModel.recIndx;if(null==t)this.commitAddAll(),this.commitUpdateAll(),this.commitDeleteAll();else{var l=t.type,s=t.rows;"add"==l?s?o=this.commitAdd(s,a):this.commitAddAll():"update"==l?s?n=this.commitUpdate(s,a):this.commitUpdateAll():"delete"==l&&(s?this.commitDelete(s,a):this.commitDeleteAll())}(e=o.concat(n)).length&&(i._digestData({source:"commit",checkEditable:!1,track:!1,history:r,rowList:e}),i.refreshView())},i.rollbackAdd=function(t,e){for(var i=this.adata,r=[],o=(t.type,0),n=i.length;o<n;o++){var a=i[o].rowData;r.push({type:"delete",rowData:a})}return this.adata=[],r},i.rollbackDelete=function(t,e){for(var i=this.ddata,r=[],o=(t.type,i.length-1);o>=0;o--){var n=i[o],a=(n.indx,n.rowIndx),l=n.rowData;r.push({type:"add",rowIndx:a,newRow:l})}return this.ddata=[],r},i.rollbackUpdate=function(t,e){for(var i=this.that,r=this.options.trackModel.dirtyClass,o=this.udata,n=[],a=0,l=o.length;a<l;a++){var s=o[a],d=s.recId,h=s.rowData,c={},u=s.oldRow;if(null!=d){var f=[];for(var p in u)c[p]=h[p],f.push(p);i.removeClass({rowData:h,dataIndx:f,cls:r,refresh:!1}),n.push({type:"update",rowData:h,newRow:u,oldRow:c})}}return this.udata=[],n},i.rollback=function(t){var e,i=this.that,r=i.options.dataModel,o=i.options.pageModel,n=!t||null==t.refresh||t.refresh,a=t&&null!=t.type?t.type:null,l=[],s=[],d=[],h=r.data;null!=a&&"update"!=a||(s=this.rollbackUpdate(o,h)),null!=a&&"delete"!=a||(l=this.rollbackDelete(o,h)),null!=a&&"add"!=a||(d=this.rollbackAdd(o,h)),e=l.concat(d,s),i._digestData({history:!1,allowInvalid:!0,checkEditable:!1,source:"rollback",track:!1,rowList:e}),n&&i.refreshView()};var r=t.paramquery.pqGrid.prototype;r.getChanges=function(t){if(this.blurEditor({force:!0}),t){var e=t.format;if(e){if("byVal"==e)return this.iUCData.getChangesValue();if("raw"==e)return this.iUCData.getChangesRaw()}}return this.iUCData.getChanges()},r.rollback=function(t){this.blurEditor({force:!0}),this.iUCData.rollback(t)},r.isDirty=function(t){return this.iUCData.isDirty(t)},r.commit=function(t){this.iUCData.commit(t)},r._getRowIndx=function(){var t=this.selection({type:"row",method:"getSelection"});if(!(t&&t.length>0))return null;var e=t[0].rowIndx,i=this.rowIndxOffset,r=this.options.pageModel,o=r.type,n=e-i,a=r.rPP;return o?n>=0&&n<a?e:void 0:e},r.updateRow=function(t){var e=t.rowIndx,i=t.row,r=t.rowData||this.getRowData({rowIndx:e});if(!r)return!1;var o={};for(var n in i)o[n]=r[n];if(!1===this._digestData({source:t.source||"update",history:t.history,checkEditable:t.checkEditable,track:t.track,allowInvalid:t.allowInvalid,rowList:[{newRow:i,oldRow:o,rowData:r,rowIndx:e,type:"update"}]}))return!1;!1!==t.refresh&&this.refreshRow({rowIndx:e})},r.updateElseAdd=function(t){var e=t.rowIndx,i=t.row;null==this.getRowData({rowIndx:e})?(t.rowData=i,this.addRow(t)):this.updateRow(t)},r._fillForm=function(t){var e=this.options.dataModel,i=this.options.pageModel.type,r=e.data,o=this.colModel,n=this.rowIndxOffset,a=null==t.rowIndxPage?t.rowIndx-n:t.rowIndxPage,l=null==t.rowIndx?a+n:t.rowIndx,s=r["remote"==i?a:l];this.rowData=s,this.$crudDialog.dialog("option","title","Edit Record ("+(l+1)+")");for(var d=this.$crudForm,h=0;h<o.length;h++){var c=o[h].dataIndx,u=s[c];d.find("*[name='"+c+"']").val(u)}},r.getRecId=function(t){var e=this.options.dataModel;t.dataIndx=e.recIndx;var i=this.getCellData(t);return null==i?null:i},r.getCellData=function(t){var e=t.rowData||this.getRowData(t),i=t.dataIndx;return e?e[i]:null},r.getRowData=function(t){if(!t)return null;var e=t.rowData;if(null!=e)return e;var i=this.options,r=i.dataModel,o=i.pageModel.type,n=r.recIndx,a=t.recId,l=r.data;if(null==a){var s=t.rowIndx,d=t.rowIndxPage,h=this.rowIndxOffset;s=null!=s?s:d+h,d=null!=d?d:s-h;return f=l?l["remote"==o?d:s]:null}for(var c=0,u=l.length;c<u;c++){var f;if((f=l[c])[n]==a)return f}return null},r.deleteRow=function(t){var e=t.rowIndx,i=t.rowIndxPage,r=this.rowIndxOffset;if(null!=(e=null!=i?i+r:e)){var o=t.rowData||this.getRowData({rowIndx:e});this._digestData({source:t.source||"delete",history:t.history,track:t.track,rowList:[{rowIndx:e,rowData:o,oldRow:o,type:"delete"}]}),!1!==t.refresh&&this.refreshView()}},r.addRow=function(t){var e=t.rowData||t.row,i=t.rowIndx,r=t.rowIndxPage,o=this.rowIndxOffset,n=(i=null!=r?r+o:i,this.options.dataModel),a=n.data;return null==e?null:(null==a&&(n.data=[],a=n.data),!1!==this._digestData({source:t.source||"add",history:t.history,track:t.track,checkEditable:t.checkEditable,rowList:[{newRow:e,rowIndx:i,type:"add"}]})&&(!1!==t.refresh&&this.refreshView(),null==i?a.length-1:i))}}(jQuery),function(t){var e={options:{items:[],gridInstance:null},_create:function(){var e=(c=this.options).gridInstance,i=e.colModel,r=c.items,o=this.element;o.closest(".pq-grid");o.addClass("pq-toolbar");for(var n=0,a=r.length;n<a;n++){var l,s=r[n],d=s.type,h=s.icon,c=s.options,u=s.label,f=(b=s.listener)?[b]:s.listeners,p=s.cls,g="ui-corner-all "+(p||""),v=s.style,w=v?'style="'+v+'"':"",x=s.attr,m=x||"";if("textbox"==d)l=t("<input type='text' class='"+g+"' "+m+" "+w+">").appendTo(o);else if("checkbox"==d)l=t("<input type='checkbox' class='"+g+"' "+m+" "+w+">").appendTo(o);else if("separator"==d)t("<span class='pq-separator '"+g+"' "+m+" "+w+"></span>").appendTo(o);else if("button"==d){c=s.options?s.options:{};t.extend(c,{text:!!u,icons:{primary:h}}),l=t("<button type='button' class='"+g+"' "+m+" "+w+">"+u+"</button>").button(c).appendTo(o)}else{if("select"==d)"function"==typeof(c=s.options?s.options:[])&&(c=c.call(e.element[0],{colModel:i})),I=t.paramquery.select({options:c,attr:" class='"+g+"' "+m+" "+w,prepend:s.prepend,groupIndx:s.groupIndx,valueIndx:s.valueIndx,labelIndx:s.labelIndx}),l=t(I).appendTo(o);else if("string"==typeof d)l=t(d).appendTo(o);else if("function"==typeof d){var I=d.call(e.element[0],{colModel:i,cls:g});l=t(I).appendTo(o)}}if(f)for(var _=0;_<f.length;_++){var b=f[_];for(var y in b)l.bind(y,b[y])}}},_destroy:function(){this.element.empty().removeClass("pq-toolbar").enableSelection()},_disable:function(){null==this.$disable&&(this.$disable=t("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},_enable:function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},_setOption:function(t,e){"disabled"==t&&(1==e?this._disable():this._enable())}};t.widget("paramquery.pqToolbar",e)}(jQuery),function(t){var e=function(){this.focusSelection=null},i=e.prototype;i.triggerSelectChange=function(e){var i=this.that;if(i.options.selectionModel.fireSelectChange){var r=i.iRows.getSelection(),o=i.iCells.getSelection(),n=e.evt,a=e.ui,l={rows:r,cells:o};a=null==a?l:t.extend(l,a),i._trigger("selectChange",n,a)}},i.getOldRowSel=function(){var t,e=this.that;if((t=this.focusSelection)&&this.isSelected(t)){var i=e.getRowIndx(t);return i.rowData=t.rowData,i}},i.getOldCellSel=function(){var t,e=this.that;if((t=this.focusSelection)&&this.isSelected(t)){var i=t.rowData,r=e.getRowIndx({rowData:i});return r.rowData=i,r.dataIndx=t.dataIndx,r}},i.getNewRowSel=function(){var e=this.that,i=document.activeElement?t(document.activeElement):null;if(i&&i.hasClass("pq-grid-row")&&i.closest(".pq-grid")[0]==e.element[0]){var r=e.getRowIndx({$tr:i});return r.$tr=i,r}},i.getNewCellSel=function(){var e=this.that,i=document.activeElement?t(document.activeElement):null;if(i&&i.hasClass("pq-grid-cell")&&i.closest(".pq-grid")[0]==e.element[0]){var r=e.getCellIndices({$td:i});return r.$td=i,r}},i.getFocusSelection=function(t){return this instanceof r?t&&!0===t.old?this.getOldRowSel():this.getNewRowSel():this instanceof o?t&&!0===t.old?this.getOldCellSel():this.getNewCellSel():void 0},i.getFirstSelection=function(){var t=this.firstSelection;if(t&&this.isSelected(t))return t;this.refresh();var e=this.selection;return e.length?(this.firstSelection=e[0],e[0]):void 0},i.getLastSelection=function(){var t=this.lastSelection;if(t){var e=this.that;return!(t.rowData!=e.getRowData({rowIndx:rowIndx})||!this.isSelected(t))&&t}return null},i.getLastSelectionCurPage=function(){var t=this.lastSelection;if(t&&this.isSelected(t)){var e=t.rowIndx,i=this.that.options.pageModel;if(i.type){var r=i.curPage,o=i.rPP;return Math.ceil((e+1)/o)==r?t:null}return t}return null},i.getSelection=function(){return this.refresh(),this.selection},i.getSelectionCurPage=function(){var t=this.that,e=this.getSelection(),i=[],r=t.options.pageModel;if(r.type){for(var o=r.curPage,n=r.rPP,a=0;a<e.length;a++){var l=e[a],s=l.rowIndx;Math.ceil((s+1)/n)==o&&i.push(l)}return i}return e},i.inViewRow=function(t){var e=this.that,i=this.options,r=i.groupModel,o=e.rowIndxOffset,n=i.freezeRows,a=e.initV,l=e.finalV;if(t<n)return!0;if(r){var s=e.dataGM;if(s&&s.length)for(var d=a;d<=l;d++){var h=s[d].rowIndx-o;if(null!=h&&h==t)return!0}return!1}return t>=a&&t<=l},i.setDirty=function(){};var r=function(t){this.that=t,this.options=t.options,this.selection=[]};t.paramquery.cRows=r;var o=function(t){this.options=t.options,this.that=t,this.selection=[]};t.paramquery.cCells=o;var n=o.prototype=new e,a=r.prototype=new e;a.extendSelection=function(t){var e=this.that,i=t.rowIndx,r=e.options.selectionModel.mode,o=t.evt,n=this.getFirstSelection();if(null!=n){if("single"!=r){var a=n.rowIndx,l=a,s=i;a>i&&(l=i,s=a),this.selectRange({initRowIndx:l,finalRowIndx:s,evt:o}),this.add({rowIndx:i})}}else e.setSelection({rowIndx:i})},a.refresh=function(){this.selection=[];var t=this.that,e=t.options,i=e.dataModel,r="remote"==e.pageModel.type,o=t.rowIndxOffset,n=[],a=i.data;if(a){for(var l=0,s=a.length;l<s;l++){var d=a[l];if(d.pq_rowselect){var h=r?l+o:l;n.push({rowIndx:h,rowData:d})}}this.selection=n}},a.replace=function(t){var e=t.rowIndx,i=null==t.offset?this.that.getRowIndxOffset():t.offset,r=e-i;t.$tr,t.evt;t.offset=i,t.rowIndxPage=r,this.removeAll({raiseEvent:!0}),this.add(t)},a.indexOf=function(t){this.refresh();for(var e=t.rowIndx,i=this.selection,r=0;r<i.length;r++)if(i[r].rowIndx==e)return r;return-1},a.isSelected=function(t){var e=this.that,i=t.rowData||e.getRowData(t);return i?null!=i.pq_rowselect&&i.pq_rowselect:null},a._boundRow=function(t){var e=t.rowIndxPage,i=this.that,r=null==t.$tr?i.getRow({rowIndxPage:e}):t.$tr;return null!=r&&0!=r.length&&(r.addClass("pq-row-select ui-state-highlight"),r)},a.selectRange=function(t){this.that;for(var e=t.initRowIndx,i=t.finalRowIndx,r=t.evt,o=this.getSelection().slice(0),n=[],a=0;a<o.length;a++){var l=o[a];((d=l.rowIndx)<e||d>i)&&n.push({rowIndx:d,rowData:l.rowData})}if(this.remove({rows:n,evt:r}),n=[],e>i){var s=e;e=i,i=s}for(var d=e;d<=i;d++)n.push({rowIndx:d,evt:r});this.add({rows:n,evt:r})},n._addToData=function(t){var e=t.dataIndx,i=this.that.getRowData(t);i.pq_cellselect||(i.pq_cellselect={}),i.pq_cellselect[e]=!0},n.extendSelection=function(t){var e=this.that,i=this.getFirstSelection(),r=t.rowIndx,o=t.colIndx,n=e.options.selectionModel.mode,a=t.evt;if(null!=i){var l=i.rowIndx,s=e.getColIndx({dataIndx:i.dataIndx}),d=l,h=r,c=s,u=o;l>r&&(d=r,h=l),"range"==n?(l>r&&(c=o,u=s),r==l&&o<s&&(c=o,u=s),this.selectRange({initRowIndx:d,initColIndx:c,finalRowIndx:h,finalColIndx:u,evt:a}),this.add({rowIndx:r,colIndx:o})):"block"==n&&(s>o&&(c=o,u=s),this.selectBlock({initRowIndx:d,initColIndx:c,finalRowIndx:h,finalColIndx:u,evt:a}),this.add({rowIndx:r,colIndx:o}))}else e.setSelection({rowIndx:r,colIndx:o})},n._removeFromData=function(t){var e=t.rowData;e&&e.pq_cellselect&&delete e.pq_cellselect[t.dataIndx]},n.removeAll=function(){this.refresh();var t=this.selection.slice(0);this.remove({cells:t}),this.lastSelection=null},a.removeAll=function(t){if(t&&null!=t.page)throw"objP.page not supported in removeAll";var e=this.that,i=!t||null==t.all||t.all;this.refresh();var r=this.selection.slice(0);if(i)this.remove({rows:r}),this.lastSelection=null;else{for(var o=[],n=e.rowIndxOffset,a=e.pdata,l=a?a.length:0,s=0,d=r.length;s<d;s++){var h=r[s],c=h.rowIndx-n;if(c>=0){if(!(c<l))break;o.push(h)}}this.remove({rows:o})}},n.isSelected=function(t){var e=this.that,i=t.rowData||e.getRowData(t),r=t.dataIndx,o=t.colIndx;return null==o&&null==r?null:null==i?null:(r=null==r?e.colModel[o].dataIndx:r,!(!i.pq_cellselect||!i.pq_cellselect[r]))},n.refresh=function(){this.selection=[];var t=this.that,e=t.options.dataModel,i=t.options.pageModel,r=e.data,o=[],n="remote"==i.type,a=t.rowIndxOffset,l=this.that.colModel,s=l.length;if(r){for(var d=[],h=[],c=[],u=0;u<s;u++){var f=l[u],p=f.dataIndx;c[u]=p,d[p]=u,h[p]=f}u=0;for(var g=r.length;u<g;u++){var v=r[u],w=v.pq_cellselect;if(w)for(var x=n?u+a:u,m=0;m<s;m++){w[p=c[m]]&&o.push({rowIndx:x,rowData:v,dataIndx:p,colIndx:m,column:l[m]})}}this.selection=o}},n.replace=function(t){var e=t.rowIndx,i=(t.colIndx,null==t.offset?this.that.getRowIndxOffset():t.offset),r=e-i;t.$td,t.evt;t.rowIndxPage=r,t.offset=i,this.removeAll({raiseEvent:!0}),this.add(t)},n.inViewCell=function(t,e){var i=this.that,r=this.options.freezeCols;return!!this.inViewRow(t)&&(e<r||e>=i.initH&&e<=i.finalH)},n._add=function(t){var e,i=this.that,r=t.rowIndx,o=t.rowIndxPage,n=t.rowData||i.getRowData(t),a=i.rowIndxOffset,l=(r=null==r?o+a:r,o=null==o?r-a:o,t.colIndx),s=t.dataIndx,d=(l=null==l?i.getColIndx({dataIndx:s}):l,i.colModel[l]),h=(s=null==s?d.dataIndx:s,t.evt),c=this.isSelected({rowData:n,dataIndx:s});if(null==c)return!1;var u=this.inViewCell(o,l);if(!1===c){if(u){var f=i.getCell({rowIndxPage:o,colIndx:l});f&&f.addClass("pq-state-select ui-state-highlight")}this._addToData({rowData:n,dataIndx:s}),!1!==t.trigger&&i._trigger("cellSelect",h,{rowIndx:r,rowIndxPage:o,colIndx:l,dataIndx:s,column:d,rowData:n}),e=!0}return this.lastSelection={rowIndx:r,dataIndx:s,rowData:n},!1!==t.focus&&u&&(f&&f.length||(f=i.getCell({rowIndxPage:o,dataIndx:s})),f&&f.length&&(f.attr("tabindex","0"),f.focus(),i._fixTableViewPort(),this.focusSelection={rowData:n,rowIndx:r,dataIndx:s})),t.setFirst&&(this.firstSelection={rowIndx:r,rowData:n,dataIndx:s}),e?{rowIndx:r,rowData:n,dataIndx:s,colIndx:l,column:d}:void 0},a._add=function(e){var i,r=this.that,o=e.rowIndx,n=e.rowIndxPage,a=r.rowIndxOffset,l=(o=null==o?n+a:o,n=null==n?o-a:n,null==l?r.getRowData(e):l),s=e.$tr,d=e.evt,h=this.isSelected({rowData:l});if(e.rowIndxPage=n,null==h)return!1;var c=this.inViewRow(n);if(!1===h){if(c)s=this._boundRow(e);l.pq_rowselect=!0,!1!==e.trigger&&r._trigger("rowSelect",d,{rowIndx:o,rowIndxPage:n,rowData:l,$tr:s}),i=!0}return this.lastSelection={rowIndx:o,rowData:l},!1!==e.focus&&c&&(s&&s.length||(s=r.getRow({rowIndxPage:n})),s&&((s=t(s[0])).attr("tabindex","0"),s.focus(),r._fixTableViewPort(),this.focusSelection={rowData:l,rowIndx:o})),e.setFirst&&(this.firstSelection={rowIndx:o,rowData:l}),i?{rowIndx:o,rowData:l}:void 0},n.add=function(t){var e=this.that,i=t.evt,r=t.cells,o=!1,n=[];if(r&&"function"==typeof r.push){for(var a=0,l=r.length;a<l;a++){var s=r[a];s.trigger=!1,(o=this._add(s))&&n.push(o)}n.length&&(o=!0,e._trigger("cellSelect",i,{cells:n}))}else o=this._add(t);o&&(e._fixIE(),this.triggerSelectChange({evt:i}))},a.add=function(t){var e=this.that,i=t.evt,r=t.rows,o=!1,n=[];if(r&&"function"==typeof r.push){for(var a=0,l=r.length;a<l;a++){var s=r[a];s.trigger=!1,(o=this._add(s))&&n.push(o)}n.length&&(o=!0,e._trigger("rowSelect",i,{rows:n}))}else o=this._add(t);o&&(e._fixIE(),this.triggerSelectChange({evt:i}))},n._remove=function(t){var e=this.that,i=t.rowIndx,r=t.rowIndxPage,o=e.rowIndxOffset,n=(i=null==i?r+o:i,r=null==r?i-o:r,t.rowData||e.getRowData(t)),a=t.colIndx,l=t.dataIndx,s=(a=null==a?e.getColIndx({dataIndx:l}):a,null==(s=t.column)?e.colModel[a]:s),d=(l=null==l?s.dataIndx:l,t.evt);if(this.isSelected({rowData:n,dataIndx:l})){if(this.inViewCell(r,a)){var h=e.getCell({rowIndxPage:r,colIndx:a,all:!0});h&&(h.removeClass("pq-state-select ui-state-highlight"),h.removeAttr("tabindex"))}return this._removeFromData({rowData:n,dataIndx:l}),!1!==t.trigger&&e._trigger("cellUnSelect",d,{rowIndx:i,colIndx:a,dataIndx:l,rowData:n}),{rowIndx:i,rowData:n,dataIndx:l,colIndx:a,column:s}}},a._remove=function(t){var e=this.that,i=t.rowIndx,r=t.rowIndxPage,o=e.rowIndxOffset,n=(i=null==i?r+o:i,r=null==r?i-o:r,null==(n=t.rowData)?e.getRowData(t):n),a=t.$tr,l=t.evt;if(this.isSelected({rowData:n})){if(this.inViewRow(r))(a=e.getRow({rowIndxPage:r}))&&(a.removeClass("pq-row-select ui-state-highlight"),a.removeAttr("tabindex"));return n.pq_rowselect=!1,!1!==t.trigger&&e._trigger("rowUnSelect",l,{rowIndx:i,rowData:n,$tr:a}),{rowIndx:i,rowData:n}}},n.remove=function(t){var e=t.cells,i=t.evt,r=!1;if(e&&"function"==typeof e.push){for(var o=[],n=0,a=e.length;n<a;n++){var l=e[n];l.trigger=!1,(r=this._remove(l))&&o.push(r)}o.length&&(r=!0,this.that._trigger("cellUnSelect",i,{cells:o}))}else r=this._remove(t);r&&this.triggerSelectChange({evt:i})},a.remove=function(t){var e=t.rows,i=t.evt,r=!1;if(e&&"function"==typeof e.push){for(var o=[],n=0,a=e.length;n<a;n++){var l=e[n];l.trigger=!1,(r=this._remove(l))&&o.push(r)}o.length&&(r=!0,this.that._trigger("rowUnSelect",i,{rows:o}))}else r=this._remove(t);r&&this.triggerSelectChange({evt:i})},n.indexOf=function(t){this.refresh();var e=t.rowIndx,i=this.that,r=null==t.dataIndx?i.colModel[t.colIndx].dataIndx:t.dataIndx;t.dataIndx=r;for(var o=this.selection,n=0;n<o.length;n++){var a=o[n];if(a.rowIndx==e&&a.dataIndx==r)return n}return-1},n.selectAll=function(t){var e=this.that,i=!(!t||!t.all),r=i?this.options.dataModel.data:e.pdata,o=e.rowIndxOffset,n=e.colModel,a=n.length,l=[],s=function(t,e){for(var i=0;i<a;i++){var r=n[i];if(!r.hidden){var o={rowIndx:e,rowData:t,colIndx:i,dataIndx:r.dataIndx,focus:!1};l.push(o)}}};if(r){for(var d=0,h=r.length;d<h;d++)var c=r[d];if(i){var u="remote"==this.options.pageModel.type;for(d=0,h=r.length;d<h;d++){c=r[d];var f=d;u&&(f=d+o),s(c,f)}}else for(d=0,h=r.length;d<h;d++){s(c=r[d],f=d+o)}this.add({cells:l})}},a.selectAll=function(t){var e=this.that,i=!(!t||!t.all),r=i?this.options.dataModel.data:e.pdata,o=[];if(r){if(i)for(var n="remote"==this.options.pageModel.type,a=0,l=r.length;a<l;a++){var s={rowData:r[a],focus:!1};n?s.rowIndxPage=a:s.rowIndx=a,o.push(s)}else for(a=0,l=r.length;a<l;a++){var d=r[a];o.push({rowIndxPage:a,rowData:d,focus:!1})}this.add({rows:o})}},n.selectRange=function(t){for(var e=this.that,i=t.initRowIndx,r=t.initColIndx,o=t.finalRowIndx,n=t.finalColIndx,a=e.colModel,l=a.length,s=this.getSelection().slice(0),d=[],h=0;h<s.length;h++){var c=s[h],u=c.rowIndx,f=c.dataIndx,p=e.getColIndx({dataIndx:f});u<i||u>o?d.push({rowIndx:u,colIndx:p,dataIndx:f}):u==i&&p<r?d.push({rowIndx:u,colIndx:p,dataIndx:f}):u==o&&p>n&&d.push({rowIndx:u,colIndx:p,dataIndx:f})}this.remove({cells:d}),d=[];for(p=0;p<l;p++){var g=a[p];if(!g.hidden){f=g.dataIndx,u=i;do{if(u==i&&p<r);else{if(u==o&&p>n)break;d.push({rowIndx:u,colIndx:p,dataIndx:f,focus:!1})}u++}while(u<=o)}}this.add({cells:d})},n.selectBlock=function(t){for(var e=this.that,i=t.initRowIndx,r=t.initColIndx,o=t.finalRowIndx,n=t.finalColIndx,a=t.evt,l=this.getSelection().slice(0),s=e.colModel,d=[],h=0;h<l.length;h++){var c=l[h],u=c.rowIndx,f=c.dataIndx;(p=e.getColIndx({dataIndx:f}))<r||p>n?d.push({rowIndx:u,colIndx:p,dataIndx:f}):(u<i||u>o)&&d.push({rowIndx:u,colIndx:p,dataIndx:f})}this.remove({cells:d}),d=[];for(var p=r;p<=n;p++){var g=s[p];f=g.dataIndx;if(!g.hidden){u=i;do{d.push({rowIndx:u,colIndx:p,dataIndx:f,focus:!1}),u++}while(u<=o)}}this.add({cells:d,evt:a})}}(jQuery),function(t){var e=(t.paramquery.cCheckBoxColumn=function(t,e){var i=this;this.that=t,this.options=t.options,this.column=e,this.cb=e.cb=e.cb||{all:!1,header:!0},this.dataIndx=e.dataIndx;var r=t.widgetEventPrefix.toLowerCase(),o=t.element,n=t.eventNamespace;o.on(r+"dataavailable"+n,function(t,e){if(i.belongs(t))return i._onDataAvailable(t,e)}),o.on(r+"cellclick"+n,function(t,e){if(i.belongs(t))return i.cellClick(t,e)}),this.cb.reverse&&(o.on(r+"rowselect"+n,function(t,e){if(i.belongs(t))return i.rowSelect(t,e)}),o.on(r+"rowunselect"+n,function(t,e){if(i.belongs(t))return i.rowUnSelect(t,e)})),o.on(r+"cellkeydown"+n,function(t,e){if(i.belongs(t))return i.cellKeyDown(t,e)}),o.on(r+"refresh"+n+" "+r+"refreshrow"+n,function(t,e){if(i.belongs(t))return i.refreshHeader(t,e)})}).prototype=new t.paramquery.cClass;e.hasHeaderChkBox=function(){return this.cb.header},e.setValCBox=function(){if(this.hasHeaderChkBox()){for(var t=this.that,e=this.options,i=this.dataIndx,r=this.cb.all?e.dataModel.data:t.pdata,o=null,n=0,a=0,l=0,s=r.length;l<s;l++){r[l][i]?n++:a++}n==s?o=!0:a==s&&(o=!1),this.$inp.pqval({val:o})}},e.onHeaderClick=function(e){var i=this.that,r=t(e.currentTarget).find("input"),o=this.column,n=o.dataIndx,a=i.getColIndx({dataIndx:n}),l=this.cb.all?i.options.dataModel.data:i.pdata,s={column:o,dataIndx:n,source:"header"},d=!!t(e.target).is("input"),h=r.is(":checked"),c=h;if(d||(c=!h),c){if(!1===i._trigger("beforeCheck",e,s))return!1;d||r.pqval({val:!0});for(var u=0,f=l.length;u<f;u++){l[u][n]=!0}i.$cont.find("td[pq-col-indx="+a+"] input").prop("checked",!0),!1!==i._trigger("check",e,s)&&this.selectAllRows()}else{if(!1===i._trigger("beforeunCheck",e,s))return!1;d||r.pqval({val:!1});for(u=0,f=l.length;u<f;u++){l[u][n]=!1}i.$cont.find("td[pq-col-indx="+a+"] input").prop("checked",!1),!1!==i._trigger("unCheck",e,s)&&this.unSelectAllRows()}},e.refreshHeader=function(t,e){if(this.hasHeaderChkBox()){var i=this.that;if(i.pdata){var r=this,o=i.getCellHeader({dataIndx:this.dataIndx});if(o){o.html("<input type='checkbox'/>");this.$inp=o.find("input");o.click(function(t){return r.onHeaderClick(t)}),this.setValCBox()}}}},e.selectAllRows=function(){var t=this.that,e=this.cb.all;t.iRows.selectAll({all:e})},e.unSelectAllRows=function(){var t=this.that,e=this.cb.all;t.iRows.removeAll({all:e})},e._onDataAvailable=function(){var t=this.that,e=this.options,i=e.dataModel.data,r="remote"==e.pageModel.type?t.rowIndxOffset:0,o=this.column,n=o.dataIndx;if(null!=n&&i){for(var a=[],l=0,s=i.length;l<s;l++){(d=i[l])[n]&&a.push({rowIndx:l+r,rowData:d})}if(!1!==t._trigger("check",null,{rows:a,column:o,dataIndx:n,source:"dataAvailable"}))for(l=0;l<s;l++){var d;(d=i[l])[n]&&(d.pq_rowselect=!0)}}},e.cellClick=function(t,e){if(e.dataIndx===this.dataIndx)return this.raiseEvent(t,e)},e.rowSelect=function(t,e){var i=this.that,r=e.rows,o=e.rowData,n=this.dataIndx;if(r)for(var a=0,l=r.length;a<l;a++){var s=r[a],d=s.rowIndx;(o=s.rowData)[n]=!0,i.refreshCell({rowIndx:d,dataIndx:n})}else o&&(o[n]=!0,d=e.rowIndx,i.refreshCell({rowIndx:d,dataIndx:n}));this.setValCBox()},e.rowUnSelect=function(t,e){var i=this.that,r=e.rows,o=e.rowData,n=this.dataIndx;if(r)for(var a=0,l=r.length;a<l;a++){var s=r[a],d=s.rowIndx;(o=s.rowData)[n]=!1,i.refreshCell({rowIndx:d,dataIndx:n})}else o&&(o[n]=!1,d=e.rowIndx,i.refreshCell({rowIndx:d,dataIndx:n}));this.setValCBox()},e.raiseEvent=function(e,i){var r=this.that,o=i.rowData,n=!!t(e.originalEvent.target).is("input"),a=i.rowIndx,l=i.dataIndx;if(o[l]){if(!1===r._trigger("beforeunCheck",e,i))return!1;if(o[l]=!1,!n)r.getCell(i).find("input").pqval({val:!1});!1!==r._trigger("unCheck",e,i)&&r.iRows.remove({rowIndx:a})}else{if(!1===r._trigger("beforeCheck",e,i))return!1;if(o[l]=!0,!n)r.getCell(i).find("input").pqval({val:!0});!1!==r._trigger("check",e,i)&&r.iRows.add({rowIndx:a})}if(this.setValCBox(),!n)return!1},e.cellKeyDown=function(t,e){if((e.dataIndx=this.dataIndx)&&(13==t.keyCode||32==t.keyCode))return this.raiseEvent(t,e)}}(jQuery),function(){for(var t=0,e=["moz","webkit"],i=0;!window.requestAnimationFrame&&i<e.length;i++)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var i=(new Date).getTime(),r=Math.max(0,16-(i-t));return window.setTimeout(function(){t=(new Date).getTime(),e()},r)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),function(t){var e=t.paramquery.pqgrid.calcWidthCols;function i(t){this.that=t;var e=this,i=t.element,r=t.widgetEventPrefix.toLowerCase(),o=t.eventNamespace;this.scrollTop=0,this.scrollLeft=0,i.on(r+"contmousedown"+o,function(t,i){if(e.belongs(t))return e._onContMouseDown(t,i)}).on(r+"mousedrag"+o,function(t,i){if(e.belongs(t)&&e.swipedown)return e._onMouseDrag(t,i)}).on(r+"mousestop"+o,function(t,i){return e._onMouseStop(t,i)}).on(r+"mousepqup"+o,function(t,i){return e._onMousePQUp(t,i)}).on(r+"rowmousedown"+o,function(t,i){if(e.belongs(t))return e._onRowMouseDown(t,i)}).on(r+"cellmousedown"+o,function(t,i){if(e.belongs(t))return e._onCellMouseDown(t,i)}).on(r+"beforetableview"+o,function(t,i){if(e.belongs(t))return e._beforeTableView(t,i)}).on(r+"refresh"+o,function(t,i){if(e.belongs(t))return e._onRefresh(t,i)}).on(r+"cellmouseenter"+o,function(t,i){if(e.belongs(t))return e._onCellMouseEnter(t,i)}).on(r+"rowmouseenter"+o,function(t,i){if(e.belongs(t))return e._onRowMouseEnter(t,i)})}t.paramquery.cMouseSelection=i;var r=i.prototype=new t.paramquery.cClass;r._beforeTableView=function(t,e){var i=this.that,r=i.getFocusElement();if(this.lastFocus=null,r&&r.$grid){var o=r.$ae;if(o.hasClass("pq-grid-row")){var n=i.getRowIndx({$tr:o});this.lastFocus=n}else if(o.hasClass("pq-grid-cell")){n=i.getCellIndices({$td:o});this.lastFocus=n}}},r.inViewPort=function(t){var e=this.that.iRefresh,i=e.getEContHt(),r=e.getEContWd()+1,o=t[0],n=this.marginTop,a=this.scrollLeft;if(i>=o.offsetTop+o.offsetHeight+n){if("TD"!=o.nodeName.toUpperCase())return!0;if(r>=o.offsetLeft+o.offsetWidth+a)return!0}},r._onRefresh=function(t,e){var i,r=this.that,o=this.lastFocus;o&&(i=null!=o.dataIndx?r.getCell(o):r.getRow(o))&&i.length&&i.attr("tabindex","0").focus()},r._onCellMouseDown=function(t,e){var i=this.that,r=e.rowIndx,o=e.colIndx,n=i.options.selectionModel,a=n.type,l=n.mode;if("cell"==a&&null!=o)return t.shiftKey?(i.iCells.extendSelection({rowIndx:r,colIndx:o,mode:l,evt:t}),t.preventDefault()):(t.ctrlKey||t.metaKey)&&"single"!=l?i.iCells.isSelected({rowIndx:r,colIndx:o})?i.iCells.remove({rowIndx:r,colIndx:o}):i.setSelection({rowIndx:r,colIndx:o}):(this.mousedown={r1:r,c1:o},i.setSelection(null),i.setSelection({rowIndx:r,colIndx:o,setFirst:!0})),!0},r._onCellMouseEnter=function(e,i){var r=this.that,o=r.options.selectionModel,n=o.type;t.paramquery,o.mode;if("cell"==n&&this.mousedown){var a=this.mousedown,l=a.r1,s=a.c1,d=i.rowIndx,h=i.colIndx;if(l==d&&s==h)return;if(a.r2==d&&a.c2==h)return;this.mousedown.r2=d,this.mousedown.c2=h,r.scrollCell({rowIndx:d,colIndx:h}),r.iCells.extendSelection({rowIndx:d,colIndx:h,evt:e})}},r._onRowMouseEnter=function(t,e){var i=this.that;if("row"==i.options.selectionModel.type&&this.mousedown){this.mousedown;var r=this.mousedown.r1,o=e.rowIndx;if(r==o)return;if(this.mousedown.r2==o)return;this.mousedown.r2=o,i.scrollRow({rowIndx:o}),i.iRows.extendSelection({rowIndx:o,evt:t})}},r._onRowMouseDown=function(t,e){var i=this.that,r=e.rowIndx,o=i.options.selectionModel,n=o.mode;if("row"==o.type&&null!=r)return t.shiftKey?(i.iRows.extendSelection({rowIndx:r,evt:t}),t.preventDefault()):(t.ctrlKey||t.metaKey)&&"single"!=n?i.iRows.isSelected({rowIndx:r})?i.iRows.remove({rowIndx:r}):i.setSelection({rowIndx:r}):(this.mousedown={r1:r,y1:t.pageY,x1:t.pageX},i.setSelection(null),i.setSelection({rowIndx:r,setFirst:!0})),!0},r._onContMouseDown=function(t,e){return this.that.options.swipeModel.on&&(this._stopSwipe(!0),this.swipedown={x:t.pageX,y:t.pageY}),!0},r._onMousePQUp=function(t,e){this.that;this.mousedown=null},r._stopSwipe=function(t){t&&(this.swipedown=null,this.swipedownPrev=null),window.clearInterval(this.intID),window.cancelAnimationFrame(this.intID),this.intID=null},r._onMouseStop=function(t,e){var i=this,r=this.that;if(this.swipedownPrev){var o=r.options.swipeModel,n=this.swipedownPrev,a=n.ts,l=(new Date).getTime()-a,s=n.x,d=n.y,h=t.pageX,c=t.pageY,u=h-s,f=c-d;if(Math.sqrt(u*u+f*f)/l>o.ratio){var p=0,g=o.repeat;i._stopSwipe();var v=function(){p+=o.speed,g--;var t=h+p*u/l,e=c+p*f/l;i._onMouseDrag({pageX:t,pageY:e}),g>0?i.intID=window.requestAnimationFrame(v):i._stopSwipe(!0)};v()}else i.swipedown=null,i.swipedownPrev=null}},r._onMouseDrag=function(e,i){var r=this.that,o=(t.paramquery,r.options);if(this.swipedown){var n=this.swipedown,a=n.x,l=n.y,s=e.pageX,d=e.pageY;this.swipedownPrev={x:a,y:l,ts:(new Date).getTime()},o.virtualY||"flex"===o.height||(this.scrollVertSmooth(l,d),this.syncScrollBarVert()),o.virtualX||"flex"===o.width||(this.scrollHorSmooth(a,s),this.syncScrollBarHor()),n.x=s,n.y=d}return!0},r.updateTableY=function(t){if(0==t)return!1;var e=this.that,i=this.getTableForVertScroll(),r=e.iRefresh.getEContHt();if(!i||!i.length)return!1;var o,n=i.data("offsetHeight")-1,a=this.scrollTop-t;return o=a<0?0:t<0&&r-n+a>0?n-r:a,this.setScrollTop(o,i),!0},r.setScrollTop=function(t,e){t>=0&&(t=Math.round(t),this.scrollTop=t,e.parent("div").scrollTop(t))},r.getScrollLeft=function(){return this.scrollLeft},r.getScrollTop=function(){return this.scrollTop},r.setScrollLeft=function(t,e,i){t>=0&&(t=Math.round(t),this.scrollLeft=t,i&&i.css({marginLeft:-1*t}),e&&e.parent("div").scrollLeft(t))},r.scrollVertSmooth=function(t,e){t!=e&&this.updateTableY(e-t)},r.scrollHorSmooth=function(t,e){if(t!=e){var i=this.that,r=e-t,o=this.getTableForHorScroll(),n=this.getTableHeaderForHorScroll(),a=i.iRefresh.getEContWd();if(o||n){var l,s=(o||n).data("scrollWidth"),d=this.scrollLeft-r;l=d<0?0:s-a-d<0?s-a:d,this.setScrollLeft(l,o,n)}}},r.syncViewWithScrollBarVert=function(t){if(null!=t){var e=this.that,i=this.getTableForVertScroll();if(i&&i.length){var r=e.options;r.editModel.indices&&e.blurEditor({force:!0});var o=i.data("offsetHeight")-1,n=e.iRefresh.getEContHt(),a=(o-n)*t;if((!o||!n)&&r.debug)throw"_syncViewWithScrollBarVert !tblHt || !contHt";a<0&&(a=0),this.setScrollTop(a,i)}}},r.syncViewWithScrollBarHor=function(t){if(null!=t){var e=this.that,i=this.getTableForHorScroll(),r=this.getTableHeaderForHorScroll();if(i||r){e.options.editModel.indices&&e.blurEditor({force:!0});var o=(i||r).data("scrollWidth"),n=e.iRefresh.getEContWd(),a=(o-n)*t;o&&n&&(a<0&&(a=0),this.setScrollLeft(a,i,r))}}},r.resetMargins=function(){this.scrollLeft=0,this.scrollTop=0},r.syncHeaderViewWithScrollBarHor=function(t){if(null!=t){var i=this.that,r=this.getTableHeaderForHorScroll();if(r){var o=i.options,n=o.freezeCols;o.editModel.indices&&i.blurEditor({force:!0});var a=r.data("scrollWidth"),l=i.iRefresh.getEContWd(),s=e.call(i,n,t+n);a&&l&&(s<0&&(s=0),r.css("marginLeft",-s))}}},r.syncScrollBarVert=function(){var t=this.that,e=this.getTableForVertScroll();if(e&&e.length){var i=e.data("offsetHeight")-t.iRefresh.getEContHt(),r=this.scrollTop/i;r>=0&&r<=1&&t.$vscroll.hasClass("pq-sb-vert")&&t.$vscroll.pqScrollBar("option","ratio",r)}},r.syncScrollBarHor=function(){var t=this.that,e=this.getTableForHorScroll(),i=this.getTableHeaderForHorScroll();if(e||i){var r=(e||i).data("scrollWidth")-t.iRefresh.getEContWd(),o=this.scrollLeft/r;o>=0&&o<=1&&t.$hscroll.hasClass("pq-sb-horiz")&&t.$hscroll.pqScrollBar("option","ratio",o)}},r.getTableForVertScroll=function(){var e=this.that,i=e.pqpanes,r=e.$tbl;if(r&&r.length)return i.h&&i.v?r=t([r[2],r[3]]):i.v?r=t([r[0],r[1]]):i.h&&(r=t(r[1])),r},r.getTableForHorScroll=function(){var e=this.that,i=e.pqpanes,r=[],o=e.$tbl;if(o&&o.length){if(i.h&&i.v?r.push(o[1],o[3]):i.v?r.push(o[1]):i.h?r.push(o[0],o[1]):r.push(o[0]),e.tables.length){var n=e.tables[0].$tbl;i.v?r.push(n[1]):r.push(n[0])}return t(r)}},r.getTableHeaderForHorScroll=function(){var e=this.that,i=e.pqpanes,r=e.$tbl_header;if(r&&r.length)return(r=i.vH?t(r[1]):t(r[0])).parent()},r.scrollRowNonVirtual=function(t){var e=this.that,i=e.options,r=t.rowIndxPage,o=(e.iHierarchy,t.rowIndx),n=e.iRefresh.getEContHt();if(!((r=null==r?o-e.rowIndxOffset:r)<parseInt(i.freezeRows))){var a=e.get$Tbl(r),l=e.getRow({rowIndxPage:r})[0];if(l){var s=l.offsetHeight,d=this.getScrollTop(),h=l.offsetTop,c=parseInt(a.css("marginTop"));if(h-d+c<0){var u=h+c;this.setScrollTop(u,a),this.syncScrollBarVert()}else if(h+s-d>n){u=s+h-n;this.setScrollTop(u,a),this.syncScrollBarVert()}}}},r.scrollColumnNonVirtual=function(t){var e=this.that,i=null==(i=t.colIndx)?e.getColIndx({dataIndx:t.dataIndx}):i,r=e.options.freezeCols;if(!(i<r)){var o=e._calcRightEdgeCol(i).width,n=e._calcRightEdgeCol(i-1).width,a=e._calcRightEdgeCol(r-1).width,l=this.getTableForHorScroll(),s=this.getTableHeaderForHorScroll(),d=e.iRefresh.getEContWd(),h=this.scrollLeft;if(o-h>d){var c=o-d;this.setScrollLeft(c,l,s),this.syncScrollBarHor()}else if(n-a<h){c=n-a;this.setScrollLeft(c,l,s),this.syncScrollBarHor()}}}}(jQuery),function(t){var e=null,i=!1,r="",o=t.paramquery.pqGrid.prototype,n=o.options;o.copy=function(){(e=new a(this)).copy(),e=null},o.paste=function(){(e=new a(this)).paste(),e=null},n.pasteModel=n.pasteModel||{on:!0,compare:"byVal",select:!0,validate:!0,allowInvalid:!0,type:"replace"},n.copyModel=n.copyModel||{on:!0,header:!0,zIndex:1e4};var a=function(t,e){var i;this.that=t,e&&e.hasClass("pq-grid-row")?(this.rowIndx=t.getRowIndx({$tr:e}).rowIndx,this.dataIndx=null):e&&e.hasClass("pq-grid-cell")?(i=t.getCellIndices({$td:e}),this.rowIndx=i.rowIndx,this.dataIndx=i.dataIndx):(this.rowIndx=null,this.dataIndx=null)},l=a.prototype;l.createClipBoard=function(){var e=t("#pq-grid-excel-div"),i=this.that.options.copyModel,r=t("#pq-grid-excel");0==r.length&&(e=t("<div id='pq-grid-excel-div'  style='position:fixed;top:20px;left:20px;height:1px;width:1px;overflow:hidden;z-index:"+i.zIndex+";'/>").appendTo(document.body),(r=t("<textarea id='pq-grid-excel' autocomplete='off'  style='overflow:hidden;height:10000px;width:10000px;opacity:0' />").appendTo(e)).css({opacity:0})),r.select()},l.destroyClipBoard=function(){var e,i=this.that,r=i.iCells.getFocusSelection({old:!0});r?e=i.getCell({rowIndx:r.rowIndx,dataIndx:r.dataIndx}):(r=i.iRows.getFocusSelection({old:!0}))&&(e=i.getRow({rowIndx:r.rowIndx}));var o=t(window).scrollTop(),n=t(window).scrollLeft();e?e.attr("tabindex",0).focus():i.$cont.focus();var a=t(window).scrollTop(),l=t(window).scrollLeft();o==a&&n==l||window.scrollTo(n,o)},l.clearClipBoard=function(){t("#pq-grid-excel").val("")},l.copy=function(){var e=t("#pq-grid-excel"),i=this.that,o=i.options.copyModel,n=i.colModel,a=n.length,l=[],s=[];if(o.on){for(var d=0,h=(l=i.iRows.getSelection()).length;d<h;d++){for(var c=(w=l[d]).rowData,u=[],f=0;f<a;f++){!1!==(x=n[f]).copy&&u.push(c[x.dataIndx])}var p=u.join("\t");s.push(p)}c=null;var g=null,v=null;for(u=[],d=0,h=(l=i.iCells.getSelection()).length;d<h;d++){g=(w=l[d]).rowIndx,c=w.rowData;var w,x=w.column,m=w.dataIndx;if(!1!==x.copy){if(null!=v&&g!=v){p=u.join("\t");u=[],s.push(p),v=g}else null==v&&(v=g);u.push(c[m])}}s.push(u.join("\t"));p=s.join("\n");e.length&&(e.val(p),e.select()),r=p}},l.paste=function(){var e,i,o=this.that,n=t("#pq-grid-excel"),a=(e=(e=n.length?n.val():r).replace(/\n$/,"")).split("\n"),l=a.length,s=o.colModel,d=o.options.pasteModel,h="row",c=s.length;if(d.on&&0!=e.length&&0!=l){var u={rows:a};if(!1===o._trigger("beforePaste",null,u))return!1;var f,p,g,v,w,x,m=d.type,I=o.iRows.getSelectionCurPage();I&&I.length||(h="cell",I=o.iCells.getSelectionCurPage()),I&&I.length?(f=I[0].rowIndx,g=I[I.length-1].rowIndx,"cell"==h&&(p=o.getColIndx({dataIndx:I[0].dataIndx}),v=o.getColIndx({dataIndx:I[I.length-1].dataIndx}))):(f=0,g=0,p=0,v=0),"replace"==m?(w=f,"updateElseAdd",x=g-f+1<l?"extend":"repeat"):"append"==m?(w=g+1,x="extend","addRow"):"prepend"==m&&(w=f,x="extend","addRow");for(var _,b,y="extend"==x?l:g-f+1,q=0,C=[],R=0,M=0;M<y;M++){var D=a[q],P=M+w,S="replace"==m?o.getRowData({rowIndx:P}):null,T=S?{}:null,$={};void 0===D&&"repeat"===x&&(D=a[q=0]),q++;var H=D.split("\t");if(!b)if("cell"==h){if(i=H.length,b="extend"==(_=v-p+1<H.length?"extend":"repeat")?i:v-p+1,isNaN(b))throw"lenH NaN. assert failed.";b+p>c&&(b=c-p)}else b=c,p=0;var k=0,E=0,V=0,z=b;for(E=0;E<z;E++){var W=s[E+p],F=H[k],A=W.dataIndx;W.hidden?"extend"==_&&z+p<c&&z++:(void 0===F&&"repeat"===_&&(F=H[k=0]),k++,$[A]=F,T&&(T[A]=S[A]))}if(0==t.isEmptyObject($)){var L="update";null==S&&(L="add"),C.push({newRow:$,rowIndx:P,rowData:S,oldRow:T,type:L}),R++}}u={rowList:C,source:"paste",allowInvalid:d.allowInvalid,validate:d.validate};o._digestData(u),d.select&&("cell"==h?o.iCells.selectBlock({initRowIndx:w,finalRowIndx:w+R-1,initColIndx:p,finalColIndx:"extend"==_?p+b-1+V:v}):o.iRows.selectRange({initRowIndx:w,finalRowIndx:w+R-1})),o.refreshView();u={rows:a};o._trigger("paste",null,u)}},t(document).unbind(".pqExcel").bind("keydown.pqExcel",function(r){if(r.ctrlKey||r.metaKey){var o=t(r.target);if(!(o.hasClass("pq-grid-row")||o.hasClass("pq-grid-cell")||o.is("#pq-grid-excel")||o.is("div.pq-grid-cont")))return;var n=o.closest(".pq-grid");if(e||o.length&&n.length){if(!e){try{var l=n.pqGrid("getInstance").grid}catch(t){return!0}(e=new a(l,o)).createClipBoard()}if("67"==r.keyCode||"99"==r.keyCode)!0,e.copy();else if("86"==r.keyCode||"118"==r.keyCode)i=!0,e.clearClipBoard(),window.setTimeout(function(){e&&(e.paste(),e.destroyClipBoard(),e=null),i=!1},0);else{var s=t("#pq-grid-excel");if(s.length)document.activeElement==s[0]&&e.that._onKeyPressDown(r)}}}}).bind("keyup.pqExcel",function(r){var o=r.keyCode;i||!e||r.ctrlKey||r.metaKey||-1==t.inArray(o,[17,91,93,224])||(e.destroyClipBoard(),e=null),!1})}(jQuery),function(t){var e=t.paramquery.pqGrid.prototype.options;e.historyModel=e.historyModel||{on:!0,checkEditable:!0,checkEditableAdd:!1,allowInvalid:!0};var i=(t.paramquery.cHistory=function(t){var e=this;this.that=t,this.options=t.options,this.records=[],this.counter=0,this.id=0;var i=t.eventNamespace,r=t.widgetEventPrefix.toLowerCase();t.element.on(r+"keydown"+i,function(t,i){if(e.belongs(t))return e._onKeyDown(t,i)}),t.element.on(r+"dataavailable"+i,function(t,i){e.belongs(t)&&"filter"!=i.source&&e.reset()})}).prototype=new t.paramquery.cClass;i._onKeyDown=function(t,e){var i="90",r="89",o=t.ctrlKey||t.metaKey;return o&&t.keyCode==i?(this.undo(),!1):o&&t.keyCode==r?(this.redo(),!1):void 0},i.resetUndo=function(){if(0==this.counter)return!1;this.counter=0,this.that._trigger("history",null,{type:"resetUndo",num_undo:0,num_redo:this.records.length-this.counter,canUndo:!1,canRedo:!0})},i.reset=function(){if(0==this.counter&&0==this.records.length)return!1;this.records=[],this.counter=0,this.id=0,this.that._trigger("history",null,{num_undo:0,num_redo:0,type:"reset",canUndo:!1,canRedo:!1})},i.increment=function(){var t=this.records,e=t.length;if(e){var i=t[e-1].id;this.id=i+1}else this.id=0},i.push=function(e){var i=this.canRedo(),r=this.records,o=this.counter;r.length>o&&r.splice(o,r.length-o),r[o]=t.extend({id:this.id},e),this.counter++;var n,a,l=this.that;1==this.counter&&(n=!0),i&&this.counter==r.length&&(a=!1),l._trigger("history",null,{type:"add",canUndo:n,canRedo:a,num_undo:this.counter,num_redo:0})},i.canUndo=function(){return this.counter>0},i.canRedo=function(){return this.counter<this.records.length},i.undo=function(){var t=this.canRedo(),e=this.that,i=this.options.historyModel,r=this.records;if(!(this.counter>0))return!1;this.counter--;for(var o=r[this.counter],n=o.rowList,a=[],l=(o.id,0),s=n.length;l<s;l++){var d=n[l],h=d.newRow,c=d.rowData,u=d.type,f=d.oldRow,p=d.rowIndx;"update"==u?(p=e.getRowIndx({rowData:c}).rowIndx,a.push({type:u,rowIndx:p,rowData:c,oldRow:h,newRow:f})):"add"==u?a.push({type:"delete",rowData:h}):"delete"==u&&a.push({type:"add",rowIndx:p,newRow:c})}var g,v;e._digestData({history:!1,source:"undo",checkEditable:i.checkEditable,checkEditableAdd:i.checkEditableAdd,allowInvalid:i.allowInvalid,rowList:a});return e.refreshView(),!1===t&&(g=!0),0==this.counter&&(v=!1),e._trigger("history",null,{canUndo:v,canRedo:g,type:"undo",num_undo:this.counter,num_redo:this.records.length-this.counter}),!0},i.redo=function(){var t=this.canUndo(),e=this.that,i=this.options.historyModel,r=this.counter,o=this.records;if(r==o.length)return!1;for(var n=o[r],a=n.rowList,l=[],s=(n.id,0),d=a.length;s<d;s++){var h=a[s],c=h.newRow,u=h.rowData,f=h.type,p=h.oldRow,g=h.rowIndx;"update"==f?(g=e.getRowIndx({rowData:u}).rowIndx,l.push({type:f,rowIndx:g,rowData:u,oldRow:p,newRow:c})):"add"==f?l.push({type:"add",rowIndx:g,newRow:c}):"delete"==f&&l.push({type:"delete",rowData:u})}var v,w;e._digestData({history:!1,source:"redo",checkEditable:i.checkEditable,checkEditableAdd:i.checkEditableAdd,allowInvalid:i.allowInvalid,rowList:l});return e.refreshView(),this.counter<o.length&&this.counter++,0==t&&(v=!0),this.counter==this.records.length&&(w=!1),e._trigger("history",null,{canUndo:v,canRedo:w,type:"redo",num_undo:this.counter,num_redo:this.records.length-this.counter}),!0},t.paramquery.pqGrid.prototype.history=function(t){var e=t.method;return this.iHistory[e](t)}}(jQuery),function(t){var e=t.ui.autocomplete.prototype,i=e._renderMenu,r=e._renderItem;e._renderMenu=function(e,r){i.call(this,e,r);var o=this.options.selectItem;if(o&&o.on){var n=void 0===(n=o.cls)?"ui-state-highlight":n,a=this.element.val();a&&n&&t("a",e).filter(function(){return t(this).text()===a}).addClass(n)}},e._renderItem=function(t,e){var i=r.call(this,t,e),o=this.options.highlightText;if(o&&o.on){var n=this.element.val();if(n){var a=new RegExp("("+n+")","i"),l=e.label;if(a.test(l)){var s=void 0===(s=o.style)?"font-weight:bold;":s,d=void 0===(d=o.cls)?"":d;l=l.replace(a,"<span style='"+s+"' class='"+d+"'>$1</span>"),i.find("a").html(l)}}}return i};var o={options:{items:"td.pq-has-tooltip,td[title]",position:{my:"center top",at:"center bottom"},content:function(){var e=t(this),i=e.closest(".pq-grid").pqGrid("getInstance").grid,r=i.getCellIndices({$td:e}),o=r.rowIndx,n=r.dataIndx,a=i.data({rowIndx:o,dataIndx:n,data:"pq_valid"}).data;if(a){var l=a.icon,s=a.msg;return s=null!=s?s:"",(""==l?"":"<span class='ui-icon "+l+" pq-tooltip-icon'></span>")+s}return e.attr("title")}},_create:function(){this._super();var e=this.element,i=this.eventNamespace;e.on("pqtooltipopen"+i,function(e,i){var r=t(e.target),o=t(e.originalEvent.target);if(o.on("remove",function(t){r.pqTooltip("close",t,!0)}),i.tooltip.css("zIndex",o.zIndex()+5),r.is(".pq-grid")){var n,a=r.pqGrid("getCellIndices",{$td:o}),l=a.rowIndx,s=a.dataIndx;if((n=r.pqGrid("getRowData",{rowIndx:l}))&&(n=n.pq_celldata)&&(n=n[s])&&(n=n.pq_valid)){var d=n,h=d.style,c=d.cls;i.tooltip.addClass(c);var u=i.tooltip.attr("style");i.tooltip.attr("style",u+";"+h)}r.find("div.pq-sb-horiz,div.pq-sb-vert").on("pqscrollbardrag",function(t,e){t.currentTarget=o[0],r.pqTooltip("close",t,!0)})}}),e.on("pqtooltipclose"+i,function(e,i){var r=t(e.target);t(e.originalEvent.target).off("remove"),r.is(".pq-grid")&&r.find("div.pq-sb-horiz,div.pq-sb-vert").off("pqscrollbardrag")})}};t.widget("paramquery.pqTooltip",t.ui.tooltip,o)}(jQuery);
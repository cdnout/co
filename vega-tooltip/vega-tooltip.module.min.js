import{isArray,isString,isObject}from"vega-util";var name="vega-tooltip",version="0.25.0",description="A tooltip plugin for Vega-Lite and Vega visualizations.",keywords=["vega-lite","vega","tooltip"],repository={type:"git",url:"https://github.com/vega/vega-tooltip.git"},author={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},collaborators=["Dominik Moritz","Sira Horradarn","Zening Qu","Kanit Wongsuphasawat","Yuri Astrakhan","Jeffrey Heer"],license="BSD-3-Clause",bugs={url:"https://github.com/vega/vega-tooltip/issues"},homepage="https://github.com/vega/vega-tooltip#readme",main="build/vega-tooltip.js",module="build/vega-tooltip.module.js",unpkg="build/vega-tooltip.min.js",jsdelivr="build/vega-tooltip.min.js",types="build/vega-tooltip.module.d.ts",files=["src","build","types"],scripts={prebuild:"yarn clean && yarn build:style",build:"rollup -c","build:style":"./build-style.sh",clean:"rimraf build && rimraf src/style.ts","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && yarn copy:build && gh-pages -d examples && yarn clean",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint && yarn test",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",pretest:"yarn build:style",test:"beemo jest","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand",prepare:"beemo create-config && yarn copy:data",prettierbase:"beemo prettier '*.{css,scss,html}'",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check"},devDependencies={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.0.0","@wessberg/rollup-plugin-ts":"^1.3.4","browser-sync":"^2.26.12",concurrently:"^5.3.0","gh-pages":"^3.1.0","node-sass":"^5.0.0",path:"^0.12.7",rollup:"^2.28.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"~4.1.3","vega-datasets":"^2.1.0","vega-lite-dev-config":"^0.14.6","vega-typings":"^0.19.0"},dependencies={"vega-util":"^1.15.2"},beemo={module:"vega-lite-dev-config",drivers:["typescript","prettier","eslint","babel","jest"],eslint:{ignore:["types"]},typescript:{compilerOptions:{typeRoots:["node_modules/@types","types"]}}},pkg={name:name,version:version,description:description,keywords:keywords,repository:repository,author:author,collaborators:collaborators,license:license,bugs:bugs,homepage:homepage,main:main,module:module,unpkg:unpkg,jsdelivr:jsdelivr,types:types,files:files,scripts:scripts,devDependencies:devDependencies,dependencies:dependencies,beemo:beemo},defaultStyle="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n";const EL_ID="vg-tooltip-element",DEFAULT_OPTIONS={offsetX:10,offsetY:10,id:EL_ID,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:escapeHTML,maxDepth:2};function escapeHTML(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function createDefaultStyle(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return defaultStyle.toString().replace(EL_ID,e)}function __rest(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(i[n[l]]=e[n[l]])}return i}function formatValue(e,t,i){if(isArray(e))return`[${e.map(e=>t(isString(e)?e:stringify(e,i))).join(", ")}]`;if(isObject(e)){let n="";const l=e,{title:o,image:s}=l,r=__rest(l,["title","image"]);o&&(n+=`<h2>${t(o)}</h2>`),s&&(n+=`<img src="${t(s)}">`);const a=Object.keys(r);if(a.length>0){n+="<table>";for(const e of a){let l=r[e];void 0!==l&&(isObject(l)&&(l=stringify(l,i)),n+=`<tr><td class="key">${t(e)}:</td><td class="value">${t(l)}</td></tr>`)}n+="</table>"}return n||"{}"}return t(e)}function replacer(e){const t=[];return function(i,n){if("object"!=typeof n||null===n)return n;const l=t.indexOf(this)+1;return t.length=l,t.length>e?"[Object]":t.indexOf(n)>=0?"[Circular]":(t.push(n),n)}}function stringify(e,t){return JSON.stringify(e,replacer(t))}function calculatePosition(e,t,i,n){let l=e.clientX+i;l+t.width>window.innerWidth&&(l=+e.clientX-i-t.width);let o=e.clientY+n;return o+t.height>window.innerHeight&&(o=+e.clientY-n-t.height),{x:l,y:o}}class Handler{constructor(e){this.options=Object.assign(Object.assign({},DEFAULT_OPTIONS),e);const t=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const e=document.createElement("style");e.setAttribute("id",this.options.styleId),e.innerHTML=createDefaultStyle(t);const i=document.head;i.childNodes.length>0?i.insertBefore(e,i.childNodes[0]):i.appendChild(e)}}tooltipHandler(e,t,i,n){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(null!=document.fullscreenElement?document.fullscreenElement:document.body).appendChild(this.el),null==n||""===n)return void this.el.classList.remove("visible",`${this.options.theme}-theme`);this.el.innerHTML=formatValue(n,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:l,y:o}=calculatePosition(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${o}px; left: ${l}px`)}}const version$1=pkg.version;function index(e,t){const i=new Handler(t);return e.tooltip(i.call).run(),i}export default index;export{DEFAULT_OPTIONS,Handler,calculatePosition,createDefaultStyle,escapeHTML,formatValue,replacer,stringify,version$1 as version};
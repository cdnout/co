(function(a){a.fn.iframeTracker=function(b){var c=this.get();if(b===null||b===false){a.iframeTracker.untrack(c)}else{if(typeof b=="object"){a.iframeTracker.track(c,b)}else{throw new Error("Wrong handler type (must be an object, or null|false to untrack)")}}};a.iframeTracker={focusRetriever:null,focusRetrieved:false,handlersList:[],isIE8AndOlder:false,init:function(){try{if(a.browser.msie==true&&a.browser.version<9){this.isIE8AndOlder=true}}catch(b){try{var d=navigator.userAgent.match(/(msie) ([\w.]+)/i);if(d[2]<9){this.isIE8AndOlder=true}}catch(c){}}a(window).focus();a(window).blur(function(f){a.iframeTracker.windowLoseFocus(f)});a("body").append('<div style="position:fixed; top:0; left:0; overflow:hidden;"><input style="position:absolute; left:-300px;" type="text" value="" id="focus_retriever" readonly="true" /></div>');this.focusRetriever=a("#focus_retriever");this.focusRetrieved=false;a(document).mousemove(function(f){if(document.activeElement&&document.activeElement.tagName=="IFRAME"){a.iframeTracker.focusRetriever.focus();a.iframeTracker.focusRetrieved=true}});if(this.isIE8AndOlder){this.focusRetriever.blur(function(f){f.stopPropagation();f.preventDefault();a.iframeTracker.windowLoseFocus(f)});a("body").click(function(f){a(window).focus()});a("form").click(function(f){f.stopPropagation()});try{a("body").on("click","form",function(f){f.stopPropagation()})}catch(b){console.log("[iframeTracker] Please update jQuery to 1.7 or newer. (exception: "+b.message+")")}}},track:function(c,b){b.target=c;a.iframeTracker.handlersList.push(b);a(c).bind("mouseover",{handler:b},a.iframeTracker.mouseoverListener).bind("mouseout",{handler:b},a.iframeTracker.mouseoutListener)},untrack:function(e){if(typeof Array.prototype.filter!="function"){console.log("Your browser doesn't support Array filter, untrack disabled");return}a(e).each(function(f){a(this).unbind("mouseover",a.iframeTracker.mouseoverListener).unbind("mouseout",a.iframeTracker.mouseoutListener)});var b=function(f){return f===null?false:true};for(var d in this.handlersList){for(var c in this.handlersList[d].target){if(a.inArray(this.handlersList[d].target[c],e)!==-1){this.handlersList[d].target[c]=null}}this.handlersList[d].target=this.handlersList[d].target.filter(b);if(this.handlersList[d].target.length==0){this.handlersList[d]=null}}this.handlersList=this.handlersList.filter(b)},mouseoverListener:function(c){c.data.handler.over=true;try{c.data.handler.overCallback(this)}catch(b){}},mouseoutListener:function(c){c.data.handler.over=false;a.iframeTracker.focusRetriever.focus();try{c.data.handler.outCallback(this)}catch(b){}},windowLoseFocus:function(d){for(var c in this.handlersList){if(this.handlersList[c].over==true){try{this.handlersList[c].blurCallback()}catch(b){}}}}};a(document).ready(function(){a.iframeTracker.init()})})(jQuery);
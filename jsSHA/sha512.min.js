!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(n="undefined"!=typeof globalThis?globalThis:n||self).jsSHA=t()}(this,function(){"use strict";var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])})(n,t)},X="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function i(n,t,e,r){for(var o,i,u=t||[0],s=(e=e||0)>>>3,h=-1===r?3:0,w=0;w<n.length;w+=1)o=(i=w+s)>>>2,u.length<=o&&u.push(0),u[o]|=n[w]<<8*(h+r*(i%4));return{value:u,binLen:8*n.length+e}}function u(n,e,o){switch(e){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(n){case"HEX":return function(n,t,e){return function(n,t,e,r){var o,i,u;if(0!=n.length%2)throw new Error("String of HEX type must be in byte increments");for(var s=t||[0],h=(e=e||0)>>>3,w=-1===r?3:0,a=0;a<n.length;a+=2){if(o=parseInt(n.substr(a,2),16),isNaN(o))throw new Error("String of HEX type contains invalid characters");for(i=(u=(a>>>1)+h)>>>2;s.length<=i;)s.push(0);s[i]|=o<<8*(w+r*(u%4))}return{value:s,binLen:4*n.length+e}}(n,t,e,o)};case"TEXT":return function(n,X,t){return function(n,t,e,r){var o,i,u,s,h,w,a,f,c=0,p=X||[0],l=(e=e||0)>>>3;if("UTF8"===t)for(a=-1===r?3:0,u=0;u<n.length;u+=1)for(i=[],(o=n.charCodeAt(u))<128?i.push(o):o<2048?(i.push(192|o>>>6),i.push(128|63&o)):o<55296||57344<=o?i.push(224|o>>>12,128|o>>>6&63,128|63&o):(u+=1,o=65536+((1023&o)<<10|1023&n.charCodeAt(u)),i.push(240|o>>>18,128|o>>>12&63,128|o>>>6&63,128|63&o)),s=0;s<i.length;s+=1){for(h=(w=c+l)>>>2;p.length<=h;)p.push(0);p[h]|=i[s]<<8*(a+r*(w%4)),c+=1}else for(a=-1===r?2:0,f="UTF16LE"===t&&1!==r||"UTF16LE"!==t&&1===r,u=0;u<n.length;u+=1){for(o=n.charCodeAt(u),!0==f&&(o=(s=255&o)<<8|o>>>8),h=(w=c+l)>>>2;p.length<=h;)p.push(0);p[h]|=o<<8*(a+r*(w%4)),c+=2}return{value:p,binLen:8*c+e}}(n,e,t,o)};case"B64":return function(n,l,t){return function(n,t,e){var r,o,i,u,s,h,w=0,a=l||[0],f=(t=t||0)>>>3,c=-1===e?3:0,p=n.indexOf("=");if(-1===n.search(/^[a-zA-Z0-9=+/]+$/))throw new Error("Invalid character in base-64 string");if(n=n.replace(/=/g,""),-1!==p&&p<n.length)throw new Error("Invalid '=' found in base-64 string");for(r=0;r<n.length;r+=4){for(u=n.substr(r,4),o=i=0;o<u.length;o+=1)i|=X.indexOf(u.charAt(o))<<18-6*o;for(o=0;o<u.length-1;o+=1){for(s=(h=w+f)>>>2;a.length<=s;)a.push(0);a[s]|=(i>>>16-8*o&255)<<8*(c+e*(h%4)),w+=1}}return{value:a,binLen:8*w+t}}(n,t,o)};case"BYTES":return function(n,a,t){return function(n,t,e){for(var r,o,i,u=a||[0],s=(t=t||0)>>>3,h=-1===e?3:0,w=0;w<n.length;w+=1)r=n.charCodeAt(w),o=(i=w+s)>>>2,u.length<=o&&u.push(0),u[o]|=r<<8*(h+e*(i%4));return{value:u,binLen:8*n.length+t}}(n,t,o)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(n){throw new Error("ARRAYBUFFER not supported by this environment")}return function(n,t,e){return r=t,t=e,e=o,i(new Uint8Array(n),r,t,e);var r};case"UINT8ARRAY":try{new Uint8Array(0)}catch(n){throw new Error("UINT8ARRAY not supported by this environment")}return function(n,t,e){return i(n,t,e,o)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function s(n,h,t,e){switch(n){case"HEX":return function(n){return function(n,t,e){for(var r,o="",i=h/8,u=-1===t?3:0,s=0;s<i;s+=1)r=n[s>>>2]>>>8*(u+t*(s%4)),o+="0123456789abcdef".charAt(r>>>4&15)+"0123456789abcdef".charAt(15&r);return e.outputUpper?o.toUpperCase():o}(n,t,e)};case"B64":return function(n){return function(n,t,e,r){for(var o,i,u,s,h="",w=t/8,a=-1===e?3:0,f=0;f<w;f+=3)for(u=f+1<w?n[f+1>>>2]:0,s=f+2<w?n[f+2>>>2]:0,i=(n[f>>>2]>>>8*(a+e*(f%4))&255)<<16|(u>>>8*(a+e*((f+1)%4))&255)<<8|s>>>8*(a+e*((f+2)%4))&255,o=0;o<4;o+=1)h+=8*f+6*o<=t?X.charAt(i>>>6*(3-o)&63):r.b64Pad;return h}(n,h,t,e)};case"BYTES":return function(n){return function(n,t){for(var e,r="",o=h/8,i=-1===t?3:0,u=0;u<o;u+=1)e=n[u>>>2]>>>8*(i+t*(u%4))&255,r+=String.fromCharCode(e);return r}(n,t)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(n){throw new Error("ARRAYBUFFER not supported by this environment")}return function(n){return function(n,t){for(var e=h/8,r=new ArrayBuffer(e),o=new Uint8Array(r),i=-1===t?3:0,u=0;u<e;u+=1)o[u]=n[u>>>2]>>>8*(i+t*(u%4))&255;return r}(n,t)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(n){throw new Error("UINT8ARRAY not supported by this environment")}return function(n){return function(n,t){for(var e=h/8,r=-1===t?3:0,o=new Uint8Array(e),i=0;i<e;i+=1)o[i]=n[i>>>2]>>>8*(r+t*(i%4))&255;return o}(n,t)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}var n=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],t=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],r=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function h(n){var t={outputUpper:!1,b64Pad:"=",outputLen:-1},e=n||{},n="Output length must be a multiple of 8";if(t.outputUpper=e.outputUpper||!1,e.b64Pad&&(t.b64Pad=e.b64Pad),e.outputLen){if(e.outputLen%8!=0)throw new Error(n);t.outputLen=e.outputLen}else if(e.shakeLen){if(e.shakeLen%8!=0)throw new Error(n);t.outputLen=e.shakeLen}if("boolean"!=typeof t.outputUpper)throw new Error("Invalid outputUpper formatting option");if("string"!=typeof t.b64Pad)throw new Error("Invalid b64Pad formatting option");return t}var o=(w.prototype.update=function(n){for(var t=0,e=this.R>>>5,n=this.U(n,this.u,this.s),r=n.binLen,o=n.value,i=r>>>5,u=0;u<i;u+=e)t+this.R<=r&&(this.T=this.m(o.slice(u,u+e),this.T),t+=this.R);this.v+=t,this.u=o.slice(t>>>5),this.s=r%this.R,this.h=!0},w.prototype.getHash=function(n,t){var e,r,o=this.F,t=h(t);if(this.B){if(-1===t.outputLen)throw new Error("Output length must be specified in options");o=t.outputLen}n=s(n,o,this.g,t);if(this.A&&this.Y)return n(this.Y(t));for(r=this.H(this.u.slice(),this.s,this.v,this.S(this.T),o),e=1;e<this.numRounds;e+=1)this.B&&o%32!=0&&(r[r.length-1]&=16777215>>>24-o%32),r=this.H(r,o,0,this.I(this.o),o);return n(r)},w.prototype.setHMACKey=function(n,t,e){if(!this.C)throw new Error("Variant does not support HMAC");if(this.h)throw new Error("Cannot set MAC key after calling update");e=u(t,(e||{}).encoding||"UTF8",this.g);this.L(e(n))},w.prototype.L=function(n){var t,e=this.R>>>3,r=e/4-1;if(1!==this.numRounds)throw new Error("Cannot set numRounds with MAC");if(this.A)throw new Error("MAC key already set");for(e<n.binLen/8&&(n.value=this.H(n.value,n.binLen,0,this.I(this.o),this.F));n.value.length<=r;)n.value.push(0);for(t=0;t<=r;t+=1)this.p[t]=909522486^n.value[t],this.l[t]=1549556828^n.value[t];this.T=this.m(this.p,this.T),this.v=this.R,this.A=!0},w.prototype.getHMAC=function(n,t){t=h(t);return s(n,this.F,this.g,t)(this.N())},w.prototype.N=function(){if(!this.A)throw new Error("Cannot call getHMAC without first setting MAC key");var n=this.H(this.u.slice(),this.s,this.v,this.S(this.T),this.F),t=this.m(this.l,this.I(this.o));return this.H(n,this.F,this.R,t,this.F)},w),E=function(n,t){this.X=n,this.M=t};function w(n,t,e){e=e||{};if(this.t=t,this.i=e.encoding||"UTF8",this.numRounds=e.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||this.numRounds<1)throw new Error("numRounds must a integer >= 1");this.o=n,this.u=[],this.s=0,this.h=!1,this.v=0,this.A=!1,this.p=[],this.l=[]}function R(n,t){var e;return t<32?(e=32-t,new E(n.X>>>t|n.M<<e,n.M>>>t|n.X<<e)):(e=64-t,new E(n.M>>>t|n.X<<e,n.X>>>t|n.M<<e))}function y(n,t){return new E(n.X>>>t,n.M>>>t|n.X<<32-t)}function m(n,t){var e,r=(65535&n.M)+(65535&t.M),o=(65535&(e=(n.M>>>16)+(t.M>>>16)+(r>>>16)))<<16|65535&r;return r=(65535&n.X)+(65535&t.X)+(e>>>16),e=(n.X>>>16)+(t.X>>>16)+(r>>>16),new E((65535&e)<<16|65535&r,o)}var a,f,b=[new E(n[0],3609767458),new E(n[1],602891725),new E(n[2],3964484399),new E(n[3],2173295548),new E(n[4],4081628472),new E(n[5],3053834265),new E(n[6],2937671579),new E(n[7],3664609560),new E(n[8],2734883394),new E(n[9],1164996542),new E(n[10],1323610764),new E(n[11],3590304994),new E(n[12],4068182383),new E(n[13],991336113),new E(n[14],633803317),new E(n[15],3479774868),new E(n[16],2666613458),new E(n[17],944711139),new E(n[18],2341262773),new E(n[19],2007800933),new E(n[20],1495990901),new E(n[21],1856431235),new E(n[22],3175218132),new E(n[23],2198950837),new E(n[24],3999719339),new E(n[25],766784016),new E(n[26],2566594879),new E(n[27],3203337956),new E(n[28],1034457026),new E(n[29],2466948901),new E(n[30],3758326383),new E(n[31],168717936),new E(n[32],1188179964),new E(n[33],1546045734),new E(n[34],1522805485),new E(n[35],2643833823),new E(n[36],2343527390),new E(n[37],1014477480),new E(n[38],1206759142),new E(n[39],344077627),new E(n[40],1290863460),new E(n[41],3158454273),new E(n[42],3505952657),new E(n[43],106217008),new E(n[44],3606008344),new E(n[45],1432725776),new E(n[46],1467031594),new E(n[47],851169720),new E(n[48],3100823752),new E(n[49],1363258195),new E(n[50],3750685593),new E(n[51],3785050280),new E(n[52],3318307427),new E(n[53],3812723403),new E(n[54],2003034995),new E(n[55],3602036899),new E(n[56],1575990012),new E(n[57],1125592928),new E(n[58],2716904306),new E(n[59],442776044),new E(n[60],593698344),new E(n[61],3733110249),new E(n[62],2999351573),new E(n[63],3815920427),new E(3391569614,3928383900),new E(3515267271,566280711),new E(3940187606,3454069534),new E(4118630271,4000239992),new E(116418474,1914138554),new E(174292421,2731055270),new E(289380356,3203993006),new E(460393269,320620315),new E(685471733,587496836),new E(852142971,1086792851),new E(1017036298,365543100),new E(1126000580,2618297676),new E(1288033470,3409855158),new E(1501505948,4234509866),new E(1607167915,987167468),new E(1816402316,1246189591)];function c(n){return"SHA-384"===n?[new E(3418070365,t[0]),new E(1654270250,t[1]),new E(2438529370,t[2]),new E(355462360,t[3]),new E(1731405415,t[4]),new E(41048885895,t[5]),new E(3675008525,t[6]),new E(1203062813,t[7])]:[new E(r[0],4089235720),new E(r[1],2227873595),new E(r[2],4271175723),new E(r[3],1595750129),new E(r[4],2917565137),new E(r[5],725511199),new E(r[6],4215389547),new E(r[7],327033209)]}function p(n,t){for(var e,r,o,i,u,s,h,w,a,f=[],c=t[0],p=t[1],l=t[2],X=t[3],M=t[4],d=t[5],v=t[6],A=t[7],g=0;g<80;g+=1)g<16?(e=2*g,f[g]=new E(n[e],n[1+e])):f[g]=(s=u=i=void 0,i=R(a=f[g-2],19),u=R(a,61),s=y(a,6),r=new E(i.X^u.X^s.X,i.M^u.M^s.M),o=f[g-7],h=f[g-15],a=w=void 0,w=R(h,1),a=R(h,8),h=y(h,7),i=new E(w.X^a.X^h.X,w.M^a.M^h.M),u=f[g-16],a=w=s=void 0,w=(65535&r.M)+(65535&o.M)+(65535&i.M)+(65535&u.M),a=(65535&(s=(r.M>>>16)+(o.M>>>16)+(i.M>>>16)+(u.M>>>16)+(w>>>16)))<<16|65535&w,w=(65535&r.X)+(65535&o.X)+(65535&i.X)+(65535&u.X)+(s>>>16),s=(r.X>>>16)+(o.X>>>16)+(i.X>>>16)+(u.X>>>16)+(w>>>16),new E((65535&s)<<16|65535&w,a)),h=A,o=r=void 0,r=R(i=M,14),o=R(i,18),i=R(i,41),u=new E(r.X^o.X^i.X,r.M^o.M^i.M),s=d,w=v,r=new E((a=M).X&s.X^~a.X&w.X,a.M&s.M^~a.M&w.M),o=b[g],i=f[g],w=a=s=void 0,a=(65535&h.M)+(65535&u.M)+(65535&r.M)+(65535&o.M)+(65535&i.M),w=(65535&(s=(h.M>>>16)+(u.M>>>16)+(r.M>>>16)+(o.M>>>16)+(i.M>>>16)+(a>>>16)))<<16|65535&a,a=(65535&h.X)+(65535&u.X)+(65535&r.X)+(65535&o.X)+(65535&i.X)+(s>>>16),s=(h.X>>>16)+(u.X>>>16)+(r.X>>>16)+(o.X>>>16)+(i.X>>>16)+(a>>>16),i=new E((65535&s)<<16|65535&a,w),a=m((a=s=void 0,s=R(w=c,28),a=R(w,34),w=R(w,39),new E(s.X^a.X^w.X,s.M^a.M^w.M)),(s=p,a=l,new E((w=c).X&s.X^w.X&a.X^s.X&a.X,w.M&s.M^w.M&a.M^s.M&a.M))),A=v,v=d,d=M,M=m(X,i),X=l,l=p,p=c,c=m(i,a);return t[0]=m(c,t[0]),t[1]=m(p,t[1]),t[2]=m(l,t[2]),t[3]=m(X,t[3]),t[4]=m(M,t[4]),t[5]=m(d,t[5]),t[6]=m(v,t[6]),t[7]=m(A,t[7]),t}return e(f=l,o=a=o),f.prototype=null===o?Object.create(o):(M.prototype=o.prototype,new M),l;function l(r,n,t){var e=this;if("SHA-384"!==r&&"SHA-512"!==r)throw new Error("Chosen SHA variant is not supported");var o=t||{};return(e=a.call(this,r,n,t)||this).Y=e.N,e.C=!0,e.g=-1,e.U=u(e.t,e.i,e.g),e.m=p,e.S=function(n){return n.slice()},e.I=c,e.H=function(n,t,s,e){return function(n,t,e,r){for(var o,i=31+(t+129>>>10<<5),u=t+s;n.length<=i;)n.push(0);for(n[t>>>5]|=128<<24-t%32,n[i]=4294967295&u,n[i-1]=u/4294967296|0,o=0;o<n.length;o+=32)e=p(n.slice(o,o+32),e);return"SHA-384"===r?[e[0].X,e[0].M,e[1].X,e[1].M,e[2].X,e[2].M,e[3].X,e[3].M,e[4].X,e[4].M,e[5].X,e[5].M]:[e[0].X,e[0].M,e[1].X,e[1].M,e[2].X,e[2].M,e[3].X,e[3].M,e[4].X,e[4].M,e[5].X,e[5].M,e[6].X,e[6].M,e[7].X,e[7].M]}(n,t,e,r)},e.T=c(r),e.R=1024,e.F="SHA-384"===r?384:512,e.B=!1,o.hmacKey&&e.L(function(n,t){var e="hmacKey must include a value and format";if(!n)throw new Error(e);if(void 0===n.value||!n.format)throw new Error(e);return u(n.format,n.encoding||"UTF8",t)(n.value)}(o.hmacKey,e.g)),e}function M(){this.constructor=f}});
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(t="undefined"!=typeof globalThis?globalThis:t||self).jsSHA=r()}(this,function(){"use strict";var n=function(t,r){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])})(t,r)},d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function i(t,r,n,e){for(var o,i,u=r||[0],s=(n=n||0)>>>3,h=-1===e?3:0,a=0;a<t.length;a+=1)o=(i=a+s)>>>2,u.length<=o&&u.push(0),u[o]|=t[a]<<8*(h+e*(i%4));return{value:u,binLen:8*t.length+n}}function u(t,n,o){switch(n){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(t){case"HEX":return function(t,r,n){return function(t,r,n,e){var o,i,u;if(0!=t.length%2)throw new Error("String of HEX type must be in byte increments");for(var s=r||[0],h=(n=n||0)>>>3,a=-1===e?3:0,f=0;f<t.length;f+=2){if(o=parseInt(t.substr(f,2),16),isNaN(o))throw new Error("String of HEX type contains invalid characters");for(i=(u=(f>>>1)+h)>>>2;s.length<=i;)s.push(0);s[i]|=o<<8*(a+e*(u%4))}return{value:s,binLen:4*t.length+n}}(t,r,n,o)};case"TEXT":return function(t,d,r){return function(t,r,n,e){var o,i,u,s,h,a,f,c,p=0,l=d||[0],w=(n=n||0)>>>3;if("UTF8"===r)for(f=-1===e?3:0,u=0;u<t.length;u+=1)for(i=[],(o=t.charCodeAt(u))<128?i.push(o):o<2048?(i.push(192|o>>>6),i.push(128|63&o)):o<55296||57344<=o?i.push(224|o>>>12,128|o>>>6&63,128|63&o):(u+=1,o=65536+((1023&o)<<10|1023&t.charCodeAt(u)),i.push(240|o>>>18,128|o>>>12&63,128|o>>>6&63,128|63&o)),s=0;s<i.length;s+=1){for(h=(a=p+w)>>>2;l.length<=h;)l.push(0);l[h]|=i[s]<<8*(f+e*(a%4)),p+=1}else for(f=-1===e?2:0,c="UTF16LE"===r&&1!==e||"UTF16LE"!==r&&1===e,u=0;u<t.length;u+=1){for(o=t.charCodeAt(u),!0==c&&(o=(s=255&o)<<8|o>>>8),h=(a=p+w)>>>2;l.length<=h;)l.push(0);l[h]|=o<<8*(f+e*(a%4)),p+=2}return{value:l,binLen:8*p+n}}(t,n,r,o)};case"B64":return function(t,w,r){return function(t,r,n){var e,o,i,u,s,h,a=0,f=w||[0],c=(r=r||0)>>>3,p=-1===n?3:0,l=t.indexOf("=");if(-1===t.search(/^[a-zA-Z0-9=+/]+$/))throw new Error("Invalid character in base-64 string");if(t=t.replace(/=/g,""),-1!==l&&l<t.length)throw new Error("Invalid '=' found in base-64 string");for(e=0;e<t.length;e+=4){for(u=t.substr(e,4),o=i=0;o<u.length;o+=1)i|=d.indexOf(u.charAt(o))<<18-6*o;for(o=0;o<u.length-1;o+=1){for(s=(h=a+c)>>>2;f.length<=s;)f.push(0);f[s]|=(i>>>16-8*o&255)<<8*(p+n*(h%4)),a+=1}}return{value:f,binLen:8*a+r}}(t,r,o)};case"BYTES":return function(t,f,r){return function(t,r,n){for(var e,o,i,u=f||[0],s=(r=r||0)>>>3,h=-1===n?3:0,a=0;a<t.length;a+=1)e=t.charCodeAt(a),o=(i=a+s)>>>2,u.length<=o&&u.push(0),u[o]|=e<<8*(h+n*(i%4));return{value:u,binLen:8*t.length+r}}(t,r,o)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(t){throw new Error("ARRAYBUFFER not supported by this environment")}return function(t,r,n){return e=r,r=n,n=o,i(new Uint8Array(t),e,r,n);var e};case"UINT8ARRAY":try{new Uint8Array(0)}catch(t){throw new Error("UINT8ARRAY not supported by this environment")}return function(t,r,n){return i(t,r,n,o)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function s(t,h,r,n){switch(t){case"HEX":return function(t){return function(t,r,n){for(var e,o="",i=h/8,u=-1===r?3:0,s=0;s<i;s+=1)e=t[s>>>2]>>>8*(u+r*(s%4)),o+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(15&e);return n.outputUpper?o.toUpperCase():o}(t,r,n)};case"B64":return function(t){return function(t,r,n,e){for(var o,i,u,s,h="",a=r/8,f=-1===n?3:0,c=0;c<a;c+=3)for(u=c+1<a?t[c+1>>>2]:0,s=c+2<a?t[c+2>>>2]:0,i=(t[c>>>2]>>>8*(f+n*(c%4))&255)<<16|(u>>>8*(f+n*((c+1)%4))&255)<<8|s>>>8*(f+n*((c+2)%4))&255,o=0;o<4;o+=1)h+=8*c+6*o<=r?d.charAt(i>>>6*(3-o)&63):e.b64Pad;return h}(t,h,r,n)};case"BYTES":return function(t){return function(t,r){for(var n,e="",o=h/8,i=-1===r?3:0,u=0;u<o;u+=1)n=t[u>>>2]>>>8*(i+r*(u%4))&255,e+=String.fromCharCode(n);return e}(t,r)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(t){throw new Error("ARRAYBUFFER not supported by this environment")}return function(t){return function(t,r){for(var n=h/8,e=new ArrayBuffer(n),o=new Uint8Array(e),i=-1===r?3:0,u=0;u<n;u+=1)o[u]=t[u>>>2]>>>8*(i+r*(u%4))&255;return e}(t,r)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(t){throw new Error("UINT8ARRAY not supported by this environment")}return function(t){return function(t,r){for(var n=h/8,e=-1===r?3:0,o=new Uint8Array(n),i=0;i<n;i+=1)o[i]=t[i>>>2]>>>8*(e+r*(i%4))&255;return o}(t,r)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}var h,t,r,y=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],e=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],o=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function a(t){var r={outputUpper:!1,b64Pad:"=",outputLen:-1},n=t||{},t="Output length must be a multiple of 8";if(r.outputUpper=n.outputUpper||!1,n.b64Pad&&(r.b64Pad=n.b64Pad),n.outputLen){if(n.outputLen%8!=0)throw new Error(t);r.outputLen=n.outputLen}else if(n.shakeLen){if(n.shakeLen%8!=0)throw new Error(t);r.outputLen=n.shakeLen}if("boolean"!=typeof r.outputUpper)throw new Error("Invalid outputUpper formatting option");if("string"!=typeof r.b64Pad)throw new Error("Invalid b64Pad formatting option");return r}function R(t,r){return t>>>r|t<<32-r}function m(t,r){var n=(65535&t)+(65535&r);return(65535&(t>>>16)+(r>>>16)+(n>>>16))<<16|65535&n}function f(t){return("SHA-224"==t?e:o).slice()}function c(t,r){for(var n,e,o,i,u,s,h,a,f=[],c=r[0],p=r[1],l=r[2],w=r[3],d=r[4],A=r[5],v=r[6],g=r[7],E=0;E<64;E+=1)f[E]=E<16?t[E]:(o=R(e=f[E-2],17)^R(e,19)^e>>>10,i=f[E-7],a=f[E-15],u=R(a,7)^R(a,18)^a>>>3,s=f[E-16],h=void 0,(65535&(o>>>16)+(i>>>16)+(u>>>16)+(s>>>16)+((h=(65535&o)+(65535&i)+(65535&u)+(65535&s))>>>16))<<16|65535&h),n=g,a=R(e=d,6)^R(e,11)^R(e,25),i=(o=d)&A^~o&v,u=y[E],s=f[E],h=void 0,o=m(R(e=c,2)^R(e,13)^R(e,22),(o=c)&(e=p)^o&(o=l)^e&o),g=v,v=A,A=d,d=m(w,h=(65535&(n>>>16)+(a>>>16)+(i>>>16)+(u>>>16)+(s>>>16)+((h=(65535&n)+(65535&a)+(65535&i)+(65535&u)+(65535&s))>>>16))<<16|65535&h),w=l,l=p,p=c,c=m(h,o);return r[0]=m(c,r[0]),r[1]=m(p,r[1]),r[2]=m(l,r[2]),r[3]=m(w,r[3]),r[4]=m(d,r[4]),r[5]=m(A,r[5]),r[6]=m(v,r[6]),r[7]=m(g,r[7]),r}return w.prototype.update=function(t){for(var r=0,n=this.T>>>5,t=this.s(t,this.Y,this.H),e=t.binLen,o=t.value,i=e>>>5,u=0;u<i;u+=n)r+this.T<=e&&(this.U=this.A(o.slice(u,u+n),this.U),r+=this.T);this.I+=r,this.Y=o.slice(r>>>5),this.H=e%this.T,this.S=!0},w.prototype.getHash=function(t,r){var n,e,o=this.m,r=a(r);if(this.F){if(-1===r.outputLen)throw new Error("Output length must be specified in options");o=r.outputLen}t=s(t,o,this.u,r);if(this.C&&this.t)return t(this.t(r));for(e=this.R(this.Y.slice(),this.H,this.I,this.p(this.U),o),n=1;n<this.numRounds;n+=1)this.F&&o%32!=0&&(e[e.length-1]&=16777215>>>24-o%32),e=this.R(e,o,0,this.l(this.g),o);return t(e)},w.prototype.setHMACKey=function(t,r,n){if(!this.o)throw new Error("Variant does not support HMAC");if(this.S)throw new Error("Cannot set MAC key after calling update");n=u(r,(n||{}).encoding||"UTF8",this.u);this.B(n(t))},w.prototype.B=function(t){var r,n=this.T>>>3,e=n/4-1;if(1!==this.numRounds)throw new Error("Cannot set numRounds with MAC");if(this.C)throw new Error("MAC key already set");for(n<t.binLen/8&&(t.value=this.R(t.value,t.binLen,0,this.l(this.g),this.m));t.value.length<=e;)t.value.push(0);for(r=0;r<=e;r+=1)this.L[r]=909522486^t.value[r],this.N[r]=1549556828^t.value[r];this.U=this.A(this.L,this.U),this.I=this.T,this.C=!0},w.prototype.getHMAC=function(t,r){r=a(r);return s(t,this.m,this.u,r)(this.i())},w.prototype.i=function(){if(!this.C)throw new Error("Cannot call getHMAC without first setting MAC key");var t=this.R(this.Y.slice(),this.H,this.I,this.p(this.U),this.m),r=this.A(this.N,this.l(this.g));return this.R(t,this.m,this.T,r,this.m)},n(t=p,r=h=w),t.prototype=null===r?Object.create(r):(l.prototype=r.prototype,new l),p;function p(e,t,r){var n=this;if("SHA-224"!==e&&"SHA-256"!==e)throw new Error("Chosen SHA variant is not supported");var o=r||{};return(n=h.call(this,e,t,r)||this).t=n.i,n.o=!0,n.u=-1,n.s=u(n.h,n.v,n.u),n.A=c,n.p=function(t){return t.slice()},n.l=f,n.R=function(t,r,s,n){return function(t,r,n,e){for(var o,i=15+(r+65>>>9<<4),u=r+s;t.length<=i;)t.push(0);for(t[r>>>5]|=128<<24-r%32,t[i]=4294967295&u,t[i-1]=u/4294967296|0,o=0;o<t.length;o+=16)n=c(t.slice(o,o+16),n);return"SHA-224"===e?[n[0],n[1],n[2],n[3],n[4],n[5],n[6]]:n}(t,r,n,e)},n.U=f(e),n.T=512,n.m="SHA-224"===e?224:256,n.F=!1,o.hmacKey&&n.B(function(t,r){var n="hmacKey must include a value and format";if(!t)throw new Error(n);if(void 0===t.value||!t.format)throw new Error(n);return u(t.format,t.encoding||"UTF8",r)(t.value)}(o.hmacKey,n.u)),n}function l(){this.constructor=t}function w(t,r,n){n=n||{};if(this.h=r,this.v=n.encoding||"UTF8",this.numRounds=n.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||this.numRounds<1)throw new Error("numRounds must a integer >= 1");this.g=t,this.Y=[],this.H=0,this.S=!1,this.I=0,this.C=!1,this.L=[],this.N=[]}});
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(t="undefined"!=typeof globalThis?globalThis:t||self).jsSHA=r()}(this,function(){"use strict";var i,t,r,n=function(t,r){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])})(t,r)},d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function u(t,r,n,e){for(var o,i,u=r||[0],s=(n=n||0)>>>3,h=-1===e?3:0,a=0;a<t.length;a+=1)o=(i=a+s)>>>2,u.length<=o&&u.push(0),u[o]|=t[a]<<8*(h+e*(i%4));return{value:u,binLen:8*t.length+n}}function s(t,n,o){switch(n){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(t){case"HEX":return function(t,r,n){return function(t,r,n,e){var o,i,u;if(0!=t.length%2)throw new Error("String of HEX type must be in byte increments");for(var s=r||[0],h=(n=n||0)>>>3,a=-1===e?3:0,f=0;f<t.length;f+=2){if(o=parseInt(t.substr(f,2),16),isNaN(o))throw new Error("String of HEX type contains invalid characters");for(i=(u=(f>>>1)+h)>>>2;s.length<=i;)s.push(0);s[i]|=o<<8*(a+e*(u%4))}return{value:s,binLen:4*t.length+n}}(t,r,n,o)};case"TEXT":return function(t,d,r){return function(t,r,n,e){var o,i,u,s,h,a,f,c,p=0,l=d||[0],w=(n=n||0)>>>3;if("UTF8"===r)for(f=-1===e?3:0,u=0;u<t.length;u+=1)for(i=[],(o=t.charCodeAt(u))<128?i.push(o):o<2048?(i.push(192|o>>>6),i.push(128|63&o)):o<55296||57344<=o?i.push(224|o>>>12,128|o>>>6&63,128|63&o):(u+=1,o=65536+((1023&o)<<10|1023&t.charCodeAt(u)),i.push(240|o>>>18,128|o>>>12&63,128|o>>>6&63,128|63&o)),s=0;s<i.length;s+=1){for(h=(a=p+w)>>>2;l.length<=h;)l.push(0);l[h]|=i[s]<<8*(f+e*(a%4)),p+=1}else for(f=-1===e?2:0,c="UTF16LE"===r&&1!==e||"UTF16LE"!==r&&1===e,u=0;u<t.length;u+=1){for(o=t.charCodeAt(u),!0==c&&(o=(s=255&o)<<8|o>>>8),h=(a=p+w)>>>2;l.length<=h;)l.push(0);l[h]|=o<<8*(f+e*(a%4)),p+=2}return{value:l,binLen:8*p+n}}(t,n,r,o)};case"B64":return function(t,w,r){return function(t,r,n){var e,o,i,u,s,h,a=0,f=w||[0],c=(r=r||0)>>>3,p=-1===n?3:0,l=t.indexOf("=");if(-1===t.search(/^[a-zA-Z0-9=+/]+$/))throw new Error("Invalid character in base-64 string");if(t=t.replace(/=/g,""),-1!==l&&l<t.length)throw new Error("Invalid '=' found in base-64 string");for(e=0;e<t.length;e+=4){for(u=t.substr(e,4),o=i=0;o<u.length;o+=1)i|=d.indexOf(u.charAt(o))<<18-6*o;for(o=0;o<u.length-1;o+=1){for(s=(h=a+c)>>>2;f.length<=s;)f.push(0);f[s]|=(i>>>16-8*o&255)<<8*(p+n*(h%4)),a+=1}}return{value:f,binLen:8*a+r}}(t,r,o)};case"BYTES":return function(t,f,r){return function(t,r,n){for(var e,o,i,u=f||[0],s=(r=r||0)>>>3,h=-1===n?3:0,a=0;a<t.length;a+=1)e=t.charCodeAt(a),o=(i=a+s)>>>2,u.length<=o&&u.push(0),u[o]|=e<<8*(h+n*(i%4));return{value:u,binLen:8*t.length+r}}(t,r,o)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(t){throw new Error("ARRAYBUFFER not supported by this environment")}return function(t,r,n){return e=r,r=n,n=o,u(new Uint8Array(t),e,r,n);var e};case"UINT8ARRAY":try{new Uint8Array(0)}catch(t){throw new Error("UINT8ARRAY not supported by this environment")}return function(t,r,n){return u(t,r,n,o)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function h(t,h,r,n){switch(t){case"HEX":return function(t){return function(t,r,n){for(var e,o="",i=h/8,u=-1===r?3:0,s=0;s<i;s+=1)e=t[s>>>2]>>>8*(u+r*(s%4)),o+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(15&e);return n.outputUpper?o.toUpperCase():o}(t,r,n)};case"B64":return function(t){return function(t,r,n,e){for(var o,i,u,s,h="",a=r/8,f=-1===n?3:0,c=0;c<a;c+=3)for(u=c+1<a?t[c+1>>>2]:0,s=c+2<a?t[c+2>>>2]:0,i=(t[c>>>2]>>>8*(f+n*(c%4))&255)<<16|(u>>>8*(f+n*((c+1)%4))&255)<<8|s>>>8*(f+n*((c+2)%4))&255,o=0;o<4;o+=1)h+=8*c+6*o<=r?d.charAt(i>>>6*(3-o)&63):e.b64Pad;return h}(t,h,r,n)};case"BYTES":return function(t){return function(t,r){for(var n,e="",o=h/8,i=-1===r?3:0,u=0;u<o;u+=1)n=t[u>>>2]>>>8*(i+r*(u%4))&255,e+=String.fromCharCode(n);return e}(t,r)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(t){throw new Error("ARRAYBUFFER not supported by this environment")}return function(t){return function(t,r){for(var n=h/8,e=new ArrayBuffer(n),o=new Uint8Array(e),i=-1===r?3:0,u=0;u<n;u+=1)o[u]=t[u>>>2]>>>8*(i+r*(u%4))&255;return e}(t,r)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(t){throw new Error("UINT8ARRAY not supported by this environment")}return function(t){return function(t,r){for(var n=h/8,e=-1===r?3:0,o=new Uint8Array(n),i=0;i<n;i+=1)o[i]=t[i>>>2]>>>8*(e+r*(i%4))&255;return o}(t,r)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function a(t){var r={outputUpper:!1,b64Pad:"=",outputLen:-1},n=t||{},t="Output length must be a multiple of 8";if(r.outputUpper=n.outputUpper||!1,n.b64Pad&&(r.b64Pad=n.b64Pad),n.outputLen){if(n.outputLen%8!=0)throw new Error(t);r.outputLen=n.outputLen}else if(n.shakeLen){if(n.shakeLen%8!=0)throw new Error(t);r.outputLen=n.shakeLen}if("boolean"!=typeof r.outputUpper)throw new Error("Invalid outputUpper formatting option");if("string"!=typeof r.b64Pad)throw new Error("Invalid b64Pad formatting option");return r}function c(t,r){return t<<r|t>>>32-r}function p(t,r){var n=(65535&t)+(65535&r);return(65535&(t>>>16)+(r>>>16)+(n>>>16))<<16|65535&n}function l(t,r,n,e,o){var i=(65535&t)+(65535&r)+(65535&n)+(65535&e)+(65535&o);return(65535&(t>>>16)+(r>>>16)+(n>>>16)+(e>>>16)+(o>>>16)+(i>>>16))<<16|65535&i}function f(t){return[1732584193,4023233417,2562383102,271733878,3285377520]}function w(t,r){for(var n,e,o=[],i=r[0],u=r[1],s=r[2],h=r[3],a=r[4],f=0;f<80;f+=1)o[f]=f<16?t[f]:c(o[f-3]^o[f-8]^o[f-14]^o[f-16],1),e=f<20?l(c(i,5),u&s^~u&h,a,1518500249,o[f]):f<40?l(c(i,5),u^s^h,a,1859775393,o[f]):f<60?l(c(i,5),(e=u)&(n=s)^e&(e=h)^n&e,a,2400959708,o[f]):l(c(i,5),u^s^h,a,3395469782,o[f]),a=h,h=s,s=c(u,30),u=i,i=e;return r[0]=p(i,r[0]),r[1]=p(u,r[1]),r[2]=p(s,r[2]),r[3]=p(h,r[3]),r[4]=p(a,r[4]),r}function A(t,r,n,e){for(var o,i=15+(r+65>>>9<<4),n=r+n;t.length<=i;)t.push(0);for(t[r>>>5]|=128<<24-r%32,t[i]=4294967295&n,t[i-1]=n/4294967296|0,o=0;o<t.length;o+=16)e=w(t.slice(o,o+16),e);return e}return v.prototype.update=function(t){for(var r=0,n=this.T>>>5,t=this.u(t,this.Y,this.I),e=t.binLen,o=t.value,i=e>>>5,u=0;u<i;u+=n)r+this.T<=e&&(this.U=this.A(o.slice(u,u+n),this.U),r+=this.T);this.H+=r,this.Y=o.slice(r>>>5),this.I=e%this.T,this.C=!0},v.prototype.getHash=function(t,r){var n,e,o=this.m,r=a(r);if(this.F){if(-1===r.outputLen)throw new Error("Output length must be specified in options");o=r.outputLen}t=h(t,o,this.s,r);if(this.L&&this.i)return t(this.i(r));for(e=this.R(this.Y.slice(),this.I,this.H,this.p(this.U),o),n=1;n<this.numRounds;n+=1)this.F&&o%32!=0&&(e[e.length-1]&=16777215>>>24-o%32),e=this.R(e,o,0,this.l(this.g),o);return t(e)},v.prototype.setHMACKey=function(t,r,n){if(!this.t)throw new Error("Variant does not support HMAC");if(this.C)throw new Error("Cannot set MAC key after calling update");n=s(r,(n||{}).encoding||"UTF8",this.s);this.B(n(t))},v.prototype.B=function(t){var r,n=this.T>>>3,e=n/4-1;if(1!==this.numRounds)throw new Error("Cannot set numRounds with MAC");if(this.L)throw new Error("MAC key already set");for(n<t.binLen/8&&(t.value=this.R(t.value,t.binLen,0,this.l(this.g),this.m));t.value.length<=e;)t.value.push(0);for(r=0;r<=e;r+=1)this.N[r]=909522486^t.value[r],this.S[r]=1549556828^t.value[r];this.U=this.A(this.N,this.U),this.H=this.T,this.L=!0},v.prototype.getHMAC=function(t,r){r=a(r);return h(t,this.m,this.s,r)(this.o())},v.prototype.o=function(){if(!this.L)throw new Error("Cannot call getHMAC without first setting MAC key");var t=this.R(this.Y.slice(),this.I,this.H,this.p(this.U),this.m),r=this.A(this.S,this.l(this.g));return this.R(t,this.m,this.T,r,this.m)},n(t=e,r=i=v),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o),e;function e(t,r,n){var e=this;if("SHA-1"!==t)throw new Error("Chosen SHA variant is not supported");var o=n||{};return(e=i.call(this,t,r,n)||this).t=!0,e.i=e.o,e.s=-1,e.u=s(e.h,e.v,e.s),e.A=w,e.p=function(t){return t.slice()},e.l=f,e.R=A,e.U=[1732584193,4023233417,2562383102,271733878,3285377520],e.T=512,e.m=160,e.F=!1,o.hmacKey&&e.B(function(t,r){var n="hmacKey must include a value and format";if(!t)throw new Error(n);if(void 0===t.value||!t.format)throw new Error(n);return s(t.format,t.encoding||"UTF8",r)(t.value)}(o.hmacKey,e.s)),e}function o(){this.constructor=t}function v(t,r,n){n=n||{};if(this.h=r,this.v=n.encoding||"UTF8",this.numRounds=n.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||this.numRounds<1)throw new Error("numRounds must a integer >= 1");this.g=t,this.Y=[],this.I=0,this.C=!1,this.H=0,this.L=!1,this.N=[],this.S=[]}});
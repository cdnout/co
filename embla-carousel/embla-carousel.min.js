"use strict";function _extends(){return(_extends=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}function Alignment(e){var n=e.viewSize,t=e.align,r={start:function(){return 0},center:function(e){return(n-e)/2},end:function(e){return n-e}};return{measure:function(e){return"number"==typeof t?n*Number(t):r[t](e)}}}function Animation(e){var n=requestAnimationFrame.bind(window),t=cancelAnimationFrame.bind(window),r=0;function o(e,n){return function(){e===!!r&&n()}}function i(){r=n(e)}return{proceed:o(!0,i),start:o(!1,i),stop:o(!0,function(){t(r),r=0})}}function Axis(e){var o="y"===e?"y":"x";return{cross:"y"===e?"x":"y",measure:function(e){var n=e.getBoundingClientRect(),t=n.width,r=n.height;return"x"==o?t:r},scroll:o}}function Counter(e){var n=e.start,t=e.limit,r=e.loop,o=t.min,i=t.max,a=r?"loop":"constrain",c=l(n);function u(){return c}function s(e){return c=l(e),d}function l(e){return t[a](e)}var d={add:function e(n){if(0===n)return d;var t=n/Math.abs(n);return s(c+t),e(n+-1*t)},clone:function(){return Counter({start:c,limit:t,loop:r})},get:u,max:i,min:o,set:s};return d}function Vector1D(e){var n=e;function t(e){return n/=e,o}function r(e){return"number"==typeof e?e:e.get()}var o={add:function(e){return n+=r(e),o},divide:t,get:function(){return n},multiply:function(e){return n*=e,o},normalize:function(){return 0!==n&&t(n),o},set:function(e){return n=r(e),o},subtract:function(e){return n-=r(e),o}};return o}function Direction(e){var t=Vector1D(r(e));function r(e){return 0===e?0:e/Math.abs(e)}var o={get:t.get,set:function(e){var n=r(e.get());return 0!==n&&t.set(n),o}};return o}function EventStore(){var o=[];var i={add:function(e,n,t,r){return void 0===r&&(r=!1),e.addEventListener(n,t,r),o.push(function(){return e.removeEventListener(n,t,r)}),i},removeAll:function(){return o.filter(function(e){return e()}),o.length=0,i}};return i}function DragHandler(s){var l=s.target,d=s.scrollBody,f=s.dragFree,u=s.animation,e=s.axis,m=s.element,v=s.dragTracker,p=s.location,g=s.events,x=s.limit,S=e.scroll,h=e.cross,y=["INPUT","SELECT","TEXTAREA"],w=Vector1D(0),D=Vector1D(0),T=Vector1D(0),n=EventStore(),b=EventStore(),t=n.removeAll,r=b.removeAll,E={mouse:2.5,touch:3.5},M={mouse:4,touch:7},z={mouse:12,touch:14},C={mouse:6,touch:5},A=4,P=!1,L=!1,V=!1,I=!1;function o(e){var n,t,r,o,i,a,c;(I="mousedown"===e.type)&&0!==e.button||(n=2<=k(l.get(),p.get()),t=I||!n,o=e.target,i=o.nodeName||"",r=!(-1<y.indexOf(i)),a=n||I&&r,P=!0,v.pointerDown(e),T.set(l),l.set(p),d.useDefaultMass().useSpeed(80),c=I?document:m,b.add(c,"touchmove",B).add(c,"touchend",O).add(c,"mousemove",B).add(c,"mouseup",O),w.set(v.readPoint(e,S)),D.set(v.readPoint(e,h)),g.emit("pointerDown"),t&&(V=!1),a&&e.preventDefault())}function B(e){if(!L&&!I){var n=v.readPoint(e,S).get(),t=v.readPoint(e,h).get(),r=k(n,w.get()),o=k(t,D.get());if(!(L=o<r)&&!V)return O()}var i=v.pointerMove(e),a=x.reachedAny(p.get()),c=!s.loop&&a?2:1;!V&&i&&(V=!0),u.start(),l.add(i/c),e.preventDefault()}function O(){var e,n,t,r,o,i,a,c,u=v.pointerUp()*(f?M:E)[I?"mouse":"touch"];.5<=k(l.get(),T.get())&&!I&&(V=!0),P=L=I=!1,b.removeAll(),d.useSpeed((f?C:z)[I?"mouse":"touch"]),e=u,r=s.scrollTo,o=s.scrollTarget,i=s.index,a=x.reachedAny(l.get()+e),c=!(o.byDistance(0,!1).index!==i.get())&&Math.abs(e)>A,f||a||!c?r.distance(e,!f):(n=-1*Direction(e).get(),t=i.clone().add(n),r.index(t.get(),0)),g.emit("pointerUp")}function k(e,n){return Math.abs(e-n)}function i(e){V&&e.preventDefault()}return{addActivationEvents:function(){var e=m;n.add(e,"touchmove",function(){}).add(e,"touchend",function(){}).add(e,"touchstart",o).add(e,"mousedown",o).add(e,"touchcancel",O).add(e,"contextmenu",O).add(e,"click",i)},clickAllowed:function(){return!V},pointerDown:function(){return P},removeActivationEvents:t,removeInteractionEvents:r}}function DragTracker(e){var n=e.axis,r=e.pxToPercent,o=n.scroll,i={x:"clientX",y:"clientY"},t=Vector1D(0),a=Vector1D(0),c=Vector1D(0),u=Vector1D(0),s=[],l=(new Date).getTime(),d=!1;function f(e,n){d=!e.touches;var t=i[n],r=d?e[t]:e.touches[0][t];return u.set(r)}return{pointerDown:function(e){var n=f(e,o);return t.set(n),c.set(n),r.measure(t.get())},pointerMove:function(e){var n=f(e,o),t=(new Date).getTime();return 10<=t-l&&(s.push(n.get()),l=t),a.set(n).subtract(c),c.set(n),r.measure(a.get())},pointerUp:function(){var n=c.get(),e=d?5:4,t=s.slice(-e).map(function(e){return n-e}).sort(function(e,n){return Math.abs(e)<Math.abs(n)?1:-1})[0];return c.set(t||0),s=[],r.measure(c.get())},readPoint:f}}function Limit(e){var n=e.min,t=e.max,r={min:t,max:n},o={min:n,max:t},i=Math.abs(n-t);function a(e){return e<n}function c(e){return t<e}function u(e){return e<n?"min":t<e?"max":""}return{constrain:function(e){var n=u(e);return n?o[n]:e},length:i,loop:function(e){var n=u(e);return n?r[n]:e},max:t,min:n,reachedAny:function(e){return e<n||t<e},reachedMax:c,reachedMin:a,removeOffset:function(e){if(n===t)return e;for(;e<n;)e+=i;for(;t<e;)e-=i;return e}}}function PxToPercent(n){var e={measure:function(e){return e/n*100},totalPercent:100};return Object.freeze(e)}function map(e,n,t,r,o){return r+(e-n)/(t-n)*(o-r)}function arrayFromCollection(e){return Array.prototype.slice.call(e)}function debounce(e,n){var t={id:0};return function(){window.clearTimeout(t.id),t.id=window.setTimeout(e,n)||0}}function roundToDecimals(e){var n=Math.pow(10,e);return function(e){return Math.round(e*n)/n}}function groupArray(e,n){for(var t=[],r=0;r<e.length;r+=n)t.push(e.slice(r,r+n));return t}function arrayKeys(e){return Object.keys(e).map(Number)}function removeClass(e,n){var t=e.classList;t.contains(n)&&t.remove(n)}function addClass(e,n){var t=e.classList;t.contains(n)||t.add(n)}function ScrollBody(e){var r=e.location,n=e.speed,t=e.mass,o=roundToDecimals(2),i=Vector1D(0),a=Vector1D(0),c=Vector1D(0),u=Direction(0),s={speed:n,mass:t};function l(e){return s.speed=e,f}function d(e){return s.mass=e,f}var f={direction:u,location:r,seek:function(e){c.set(e).subtract(r);var n,t=map(c.get(),0,100,0,s.speed);return u.set(c),c.normalize().multiply(t).subtract(i),(n=c).divide(s.mass),a.add(n),f},settle:function(e){var n=e.get()-r.get(),t=!o(n);return t&&r.set(e),t},update:function(){i.add(a),r.add(i),a.multiply(0)},useDefaultMass:function(){return d(t),f},useDefaultSpeed:function(){return l(n),f},useMass:d,useSpeed:l};return f}function ScrollBounds(e){var t=e.limit,r=e.location,o=e.scrollBody,i=e.animation,a=t.min,c=t.max,u=t.reachedMin,s=t.reachedMax,l=!1,d=0;return{constrain:function(n){var e;e=n,l||d||(u(r.get())?e.get()===a:!s(r.get())||e.get()===c)||(d=window.setTimeout(function(){var e=t.constrain(n.get());n.set(e),o.useSpeed(10).useMass(3),i.start(),d=0},50))},toggleActive:function(e){l=!e}}}function ScrollContain(e){var n=e.alignment,t=e.contentSize,r=e.viewSize,s=Limit({min:-t+r,max:0}),l=[n.measure(t)],d=r<t;return{measure:function(e,n){var t,r,o,i=e.map(s.constrain),a=(r=(t=i)[0],o=t[t.length-1],Limit({min:t.lastIndexOf(r)+1,max:t.indexOf(o)})),c=a.min,u=a.max;return d?n?i.slice(c-1,u+1):i:l}}}function ScrollLimit(e){var r=e.contentSize,o=e.loop;return{measure:function(e){var n=e[0],t=e[e.length-1];return Limit({min:o?n-r:t,max:n})}}}function ScrollLooper(e){var o=e.contentSize,i=e.location,n=e.limit,t=e.pxToPercent,r=Limit({min:n.min+t.measure(.1),max:n.max+t.measure(.1)}),a=r.reachedMin,c=r.reachedMax;return{loop:function(e,n){var t,r;(1===(t=n)?c(i.get()):-1===t&&a(i.get()))&&(r=o*(-1*n),e.forEach(function(e){return e.add(r)}))}}}function ScrollProgress(e){var n=e.limit,t=n.max,r=n.length;return{get:function(e){return(e-t)/-r}}}function ScrollSnap(e){var r,n=e.snapSizes,t=e.alignment,o=e.loop,i=n.map(t.measure),a=(r=Counter({limit:Limit({min:0,max:n.length-1}),start:0,loop:o}),n.map(function(e,n){var t=r.set(n+1).get();return e+i[n]-i[t]}));return{measure:function(e){return a.slice(0,e).reduce(function(e,n){return e-n},i[0])}}}function ScrollTarget(c){var u=c.loop,e=c.limit,s=c.scrollSnaps,a=c.contentSize,l=e.reachedMax,d=e.reachedAny,f=e.removeOffset;function m(e,n){return Math.abs(e)<Math.abs(n)?e:n}function v(e,n){var t=e,r=e+a,o=e-a;if(!u)return t;if(!n)return m(m(t,r),o);var i=m(t,1===n?r:o);return Math.abs(i)*n}return{byDistance:function(e,n){var t,r=c.target.get()+e,o=(t=f(r),{index:s.map(function(e){return e-t}).map(function(e){return v(e,0)}).map(function(e,n){return{diff:e,index:n}}).sort(function(e,n){return Math.abs(e.diff)-Math.abs(n.diff)})[0].index,distance:t}),i=function(e,n){if(!(!u&&d(e)))return n;var t=c.index,r=t.min,o=t.max;return l(e)?r:o}(r,o.index),a=!u&&d(r);return!n||a?{index:i,distance:e}:{index:i,distance:e+v(s[i]-o.distance,0)}},byIndex:function(e,n){return{index:e,distance:v(s[e]-c.target.get(),n)}},shortcut:v}}function ScrollTo(e){var r=e.index,o=e.scrollTarget,i=e.animation,a=e.indexPrevious,c=e.events,u=e.target;function s(e){var n=e.distance,t=e.index!==r.get();n&&(i.start(),u.add(n)),t&&(a.set(r.get()),r.set(e.index),c.emit("select"))}return{distance:function(e,n){s(o.byDistance(e,n))},index:function(e,n){var t=r.clone().set(e);s(o.byIndex(t.get(),n))}}}function SlideLooper(e){var n,t,r,o,i,a=e.axis,c=e.location,m=e.contentSize,u=e.viewSize,s=e.slideSizes,l=e.scrollSnaps,v=arrayKeys(s),d=arrayKeys(s).reverse(),f=(r=l[0]-1,o=x(r,d),i=S(r,o,0),h(o,i,1).concat((n=x(u-l[0]-1,v),t=S(m,v,-u),h(n,-t,0)))),p="x"===a.scroll?"left":"top";function g(e,n){return e.reduce(function(e,n){return e-s[n]},n)}function x(t,e){return e.reduce(function(e,n){return 0<g(e,t)?e.concat([n]):e},[])}function S(r,e,n){return e.reduce(function(e,n){var t=e+s[n];return t<r?t:e},n)}function h(e,l,d){var f=e.slice().sort(function(e,n){return e-n});return f.map(function(e,n){var t,r,o,i,a=m*(d?-1:0),c=m*(d?0:1),u=f.slice(0,n),s=(t=u,r=l,o=d,i=v.length-1,g(t.map(function(e){return(e+o)%i}),r));return{point:s,getTarget:function(e){return s<e?a:c},index:e,location:-1}})}return{canLoop:function(){return f.every(function(e){var n=e.index;return g(v.filter(function(e){return e!==n}),u)<=0})},clear:function(t){f.forEach(function(e){var n=e.index;t[n].style[p]=""})},loop:function(i){f.forEach(function(e){var n=e.getTarget,t=e.location,r=e.index,o=n(c.get());o!==t&&(i[r].style[p]=o+"%",e.location=o)})},loopPoints:f}}function SlidesInView(e){var n=e.contentSize,r=e.slideSizes,o=e.viewSize,t=e.inViewThreshold,i=e.loop,a=r.map(function(e){return e*t}),c=arrayKeys(r).map(function(e){return r.slice(0,e).reduce(function(e,n){return e-n},0)}),u=(i?[0,n,-n]:[0]).map(s).reduce(function(e,n){return e.concat(n)},[]);function s(t){return c.map(function(e,n){return{start:e-r[n]+a[n]+t,end:e+o-a[n]+t,index:n}})}return{check:function(i){return u.reduce(function(e,n){var t=n.index,r=n.start,o=n.end;return!(-1!==e.indexOf(t))&&(r<i&&i<o)?e.concat([t]):e},[])}}}function Translate(e){var n=e.axis,t=e.container,r={x:function(e){return"translate3d("+e+"%,0px,0px)"},y:function(e){return"translate3d(0px,"+e+"%,0px)"}}[n.scroll],o=roundToDecimals(2),i=t.style,a=!1,c=0;return{clear:function(){i.transform="",c=0},to:function(e){var n;a||(n=o(e.get()),c!==n&&(getComputedStyle(t).transform,i.transform=r(n),c=n))},toggleActive:function(e){a=!e}}}function Engine(e,n,t,r,o){var i=r.align,a=r.axis,c=r.startIndex,u=r.inViewThreshold,s=r.loop,l=r.speed,d=r.dragFree,f=r.slidesToScroll,m=r.containScroll,v=Axis(a),p=PxToPercent(v.measure(n)),g=p.totalPercent,x=t.map(v.measure).map(p.measure),S=groupArray(x,f).map(function(e){return e.reduce(function(e,n){return e+n})}),h=arrayKeys(S),y=x.reduce(function(e,n){return e+n},0),w=Alignment({align:i,viewSize:g}),D=ScrollSnap({snapSizes:S,alignment:w,loop:s}),T=h.map(D.measure),b=ScrollContain({alignment:w,contentSize:y,viewSize:g}),E=!s&&""!==m,M="trimSnaps"===m,z=b.measure(T,M),C=E?z:T,A=Counter({limit:Limit({min:0,max:C.length-1}),start:c,loop:s}),P=A.clone(),L=ScrollLimit({loop:s,contentSize:y}).measure(C),V=Animation(function(){K.scrollBody.seek(O).update();var e,n=K.scrollBody.settle(O);H.pointerDown()||(s||K.scrollBounds.constrain(O),n&&(K.animation.stop(),o.emit("settle"))),s&&(e=K.scrollBody.direction.get(),K.scrollLooper.loop(k,e),K.slideLooper.loop(t)),n||o.emit("scroll"),K.translate.to(K.scrollBody.location),K.animation.proceed()}),I=C[A.get()],B=Vector1D(I),O=Vector1D(I),k=[B,O],N=ScrollBody({location:B,speed:l,mass:1}),U=ScrollTarget({contentSize:y,index:A,limit:L,loop:s,scrollSnaps:C,target:O}),F=ScrollTo({animation:V,events:o,index:A,indexPrevious:P,scrollTarget:U,target:O}),H=DragHandler({animation:V,axis:v,dragFree:d,dragTracker:DragTracker({axis:v,pxToPercent:p}),element:e,events:o,index:A,limit:L,location:B,loop:s,scrollBody:N,scrollTo:F,scrollTarget:U,target:O}),K={animation:V,axis:v,dragHandler:H,pxToPercent:p,index:A,indexPrevious:P,limit:L,location:B,options:r,scrollBody:N,scrollBounds:ScrollBounds({animation:V,limit:L,location:B,scrollBody:N}),scrollLooper:ScrollLooper({contentSize:y,limit:L,location:B,pxToPercent:p}),scrollProgress:ScrollProgress({limit:L}),scrollSnaps:C,scrollTarget:U,scrollTo:F,slideLooper:SlideLooper({axis:v,contentSize:y,location:B,scrollSnaps:C,slideSizes:x,viewSize:g}),slidesInView:SlidesInView({contentSize:y,inViewThreshold:u,loop:s,slideSizes:x,viewSize:g}),snapIndexes:h,target:O,translate:Translate({axis:v,container:n})};return K}function EventEmitter(){var t={destroy:[],pointerDown:[],pointerUp:[],init:[],reInit:[],resize:[],scroll:[],select:[],settle:[]};var r={emit:function(n){return t[n].forEach(function(e){return e(n)}),r},off:function(e,n){return t[e]=t[e].filter(function(e){return e!==n}),r},on:function(e,n){return t[e]=t[e].concat([n]),r}};return r}var defaultOptions={align:"center",axis:"x",containScroll:"",containerSelector:"*",dragFree:!1,draggable:!0,draggableClass:"is-draggable",draggingClass:"is-dragging",inViewThreshold:0,loop:!1,selectedClass:"is-selected",slidesToScroll:1,speed:10,startIndex:0};function EmblaCarousel(d,e){void 0===e&&(e={});var f,m,v,p=EventEmitter(),g=EventStore(),x=debounce(function(){var e=f.axis.measure(m);y!==e&&b();p.emit("resize")},500),n=b,t=p.on,r=p.off,S=!1,h=_extends({},defaultOptions),y=0;function o(e){void 0===e&&(e={}),function(){if(!d)throw new Error("Missing root node ðŸ˜¢");var e=h.containerSelector,n=d.querySelector(e);if(!n)throw new Error("Missing container node ðŸ˜¢");v=arrayFromCollection((m=n).children)}(),h=_extends(h,e);var n=(f=Engine(d,m,v,h,p)).axis,t=f.scrollBody,r=f.translate,o=f.dragHandler,i=f.slideLooper,a=h.loop,c=h.draggable,u=h.draggableClass,s=h.selectedClass,l=h.draggingClass;if(y=n.measure(m),g.add(window,"resize",x),r.to(t.location),v.forEach(T),o.addActivationEvents(),a){if(!i.canLoop())return b({loop:!1});i.loop(v)}c?(u&&addClass(d,u),l&&(p.on("pointerDown",w),p.on("pointerUp",w))):p.on("pointerDown",o.removeInteractionEvents),s&&(D(),p.on("select",D),p.on("pointerUp",D)),S||(setTimeout(function(){return p.emit("init")},0),S=!0)}function w(e){var n=h.draggingClass;("pointerDown"===e?addClass:removeClass)(d,n)}function D(){var n=h.selectedClass,e=a(!0);c(!0).forEach(function(e){return removeClass(v[e],n)}),e.forEach(function(e){return addClass(v[e],n)})}function T(e,t){g.add(e,"focus",function(){var e=Math.floor(t/h.slidesToScroll),n=t?e:t;d.scrollLeft=0,u(n)},!0)}function b(e){void 0===e&&(e={});var n=_extends({startIndex:f.index.get()},e);i(),o(n),p.emit("reInit")}function i(){var n=h.selectedClass,e=h.draggableClass;f.dragHandler.removeActivationEvents(),f.dragHandler.removeInteractionEvents(),f.animation.stop(),g.removeAll(),f.translate.clear(),f.slideLooper.clear(v),removeClass(d,e),v.forEach(function(e){return removeClass(e,n)}),p.off("select",D),p.off("pointerUp",D),p.off("pointerDown",w),p.off("pointerUp",w)}function a(e){void 0===e&&(e=!1);var n=f[e?"target":"location"].get(),t=h.loop?"removeOffset":"constrain";return f.slidesInView.check(f.limit[t](n))}function c(e){void 0===e&&(e=!1);var n=a(e);return f.snapIndexes.filter(function(e){return-1===n.indexOf(e)})}function u(e){f.scrollBody.useDefaultMass().useDefaultSpeed(),f.scrollTo.index(e,0)}return o(e),{canScrollNext:function(){var e=f.index;return h.loop||e.get()!==e.max},canScrollPrev:function(){var e=f.index;return h.loop||e.get()!==e.min},clickAllowed:function(){return f.dragHandler.clickAllowed()},containerNode:function(){return m},dangerouslyGetEngine:function(){return f},destroy:function(){S&&(i(),S=!1,f={},p.emit("destroy"))},off:r,on:t,previousScrollSnap:function(){return f.indexPrevious.get()},reInit:n,scrollNext:function(){var e=f.index.clone().add(1);f.scrollBody.useDefaultMass().useDefaultSpeed(),f.scrollTo.index(e.get(),-1)},scrollPrev:function(){var e=f.index.clone().add(-1);f.scrollBody.useDefaultMass().useDefaultSpeed(),f.scrollTo.index(e.get(),1)},scrollProgress:function(){var e=f.location.get();return f.scrollProgress.get(e)},scrollSnapList:function(){var e=f.scrollProgress.get;return f.scrollSnaps.map(e)},scrollTo:u,selectedScrollSnap:function(){return f.index.get()},slideNodes:function(){return v},slidesInView:a,slidesNotInView:c}}module.exports=EmblaCarousel;
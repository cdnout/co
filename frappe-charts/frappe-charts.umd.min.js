!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self)["frappe-charts"]=e()}(this,function(){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function t(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=s(n);return t=i?(t=s(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!=typeof t&&"function"!=typeof t?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e):t}}function c(t,e,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,a=!1,s=void 0;try{for(var o,r=t[Symbol.iterator]();!(i=(o=r.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){a=!0,s=t}finally{try{i||null==r.return||r.return()}finally{if(a)throw s}}return n}}(t,e)||a(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){if(t){if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function p(t,e){return"string"==typeof t?(e||document).querySelector(t):t||null}function f(t){t=t.getBoundingClientRect();return{top:t.top+(document.documentElement.scrollTop||document.body.scrollTop),left:t.left+(document.documentElement.scrollLeft||document.body.scrollLeft)}}p.create=function(t,e){var n,i=document.createElement(t);for(n in e){var a,s=e[n];"inside"===n?p(s).appendChild(i):"around"===n?((a=p(s)).parentNode.insertBefore(i,a),i.appendChild(a)):"styles"===n?"object"===o(s)&&Object.keys(s).map(function(t){i.style[t]=s[t]}):n in i?i[n]=s:i.setAttribute(n,s)}return i};var v={margins:{top:10,bottom:10,left:20,right:20},paddings:{top:20,bottom:40,left:30,right:10},baseHeight:240,titleHeight:20,legendHeight:30,titleFontSize:12};function g(t){return t.titleHeight+t.margins.top+t.paddings.top}function m(t){return t.margins.left+t.paddings.left}function y(t){return t.margins.top+t.margins.bottom+t.paddings.top+t.paddings.bottom+t.titleHeight+t.legendHeight}function b(t){return t.margins.left+t.margins.right+t.paddings.left+t.paddings.right}var x=["pink","blue","green","grey","red","yellow","purple","teal","cyan","orange"],k={bar:x,line:x,pie:x,percentage:x,heatmap:["#ebedf0","#c6e48b","#7bc96f","#239a3b","#196127"],donut:x},w=Math.PI/180,A=(t(D,[{key:"setup",value:function(){this.makeTooltip()}},{key:"refresh",value:function(){this.fill(),this.calcPosition()}},{key:"makeTooltip",value:function(){var t=this;this.container=p.create("div",{inside:this.parent,className:"graph-svg-tip comparison",innerHTML:'<span class="title"></span>\n\t\t\t\t<ul class="data-point-list"></ul>\n\t\t\t\t<div class="svg-pointer"></div>'}),this.hideTip(),this.title=this.container.querySelector(".title"),this.list=this.container.querySelector(".data-point-list"),this.dataPointList=this.container.querySelector(".data-point-list"),this.parent.addEventListener("mouseleave",function(){t.hideTip()})}},{key:"fill",value:function(){var t,i=this;this.index&&this.container.setAttribute("data-point-index",this.index),t=this.titleValueFirst?"<strong>".concat(this.titleValue,"</strong>").concat(this.titleName):"".concat(this.titleName,"<strong>").concat(this.titleValue,"</strong>"),4<this.listValues.length?this.list.classList.add("tooltip-grid"):this.list.classList.remove("tooltip-grid"),this.title.innerHTML=t,this.dataPointList.innerHTML="",this.listValues.map(function(t,e){var n=i.colors[e]||"black",e=0===t.formatted||t.formatted?t.formatted:t.value,t=p.create("li",{innerHTML:'<div class="tooltip-legend" style="background: '.concat(n,';"></div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class="tooltip-value">').concat(0===e||e?e:"",'</div>\n\t\t\t\t\t\t<div class="tooltip-label">').concat(t.title||"","</div>\n\t\t\t\t\t</div>")});i.dataPointList.appendChild(t)})}},{key:"calcPosition",value:function(){var t=this.container.offsetWidth;this.top=this.y-this.container.offsetHeight-7.48,this.left=this.x-t/2;var e=this.parent.offsetWidth-t,n=this.container.querySelector(".svg-pointer");this.left<0?(n.style.left="calc(50% - ".concat(-1*this.left,"px)"),this.left=0):this.left>e?(t=this.left-e,t="calc(50% + ".concat(t,"px)"),n.style.left=t,this.left=e):n.style.left="50%"}},{key:"setValues",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[],a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:-1;this.titleName=n.name,this.titleValue=n.value,this.listValues=i,this.x=t,this.y=e,this.titleValueFirst=n.valueFirst||0,this.index=a,this.refresh()}},{key:"hideTip",value:function(){this.container.style.top="0px",this.container.style.left="0px",this.container.style.opacity="0"}},{key:"showTip",value:function(){this.container.style.top=this.top+"px",this.container.style.left=this.left+"px",this.container.style.opacity="1"}}]),D);function D(t){var e=t.parent,e=void 0===e?null:e,t=t.colors,t=void 0===t?[]:t;r(this,D),this.parent=e,this.colors=t,this.titleName="",this.titleValue="",this.listValues=[],this.titleValueFirst=0,this.x=0,this.y=0,this.top=0,this.left=0,this.setup()}function L(t){return parseFloat(t.toFixed(2))}function M(t,e,n,i){i=3<arguments.length&&void 0!==i&&i;n=n||(i?t[0]:t[t.length-1]);n=new Array(Math.abs(e)).fill(n);return i?n.concat(t):t.concat(n)}function P(t,e){return(t+"").length*e}function T(t,e){return{x:Math.sin(t*w)*e,y:Math.cos(t*w)*e}}function C(t,e){e=1<arguments.length&&void 0!==e&&e;return!Number.isNaN(t)&&void 0!==t&&Number.isFinite(t)&&!(e&&t<0)}function N(t){return Number(Math.round(t+"e4")+"e-4")}function O(t){var e,n,i;if(t instanceof Date)return new Date(t.getTime());if("object"!==o(t)||null===t)return t;for(i in e=Array.isArray(t)?[]:{},t)n=t[i],e[i]=O(n);return e}function E(t,e){var n,e=t<=e?(n=e-t,t):(n=t-e,e);return[n,e]}function S(t,e,n){n=2<arguments.length&&void 0!==n?n:e.length-t.length;return 0<n?t=M(t,n):e=M(e,n),[t,e]}function F(t,e){for(var n=[],i=(Math.min(t.length,e.length),0);i<t.length;i++)n.push([t[i],e[i]]);function a(t,e,n,i){var a,i=(e=(e=(a=n||t)[0]-(n=e||t)[0],n=a[1]-n[1],{length:Math.sqrt(Math.pow(e,2)+Math.pow(n,2)),angle:Math.atan2(n,e)})).angle+(i?Math.PI:0),e=.2*e.length;return[t[0]+Math.cos(i)*e,t[1]+Math.sin(i)*e]}return n.reduce(function(t,e,n,i){return 0===n?"".concat(e[0],",").concat(e[1]):"".concat(t," ").concat((t=e,n=a((e=i)[(i=n)-1],e[i-2],t),i=a(t,e[i-1],e[i+1],!0),"C ".concat(n[0],",").concat(n[1]," ").concat(i[0],",").concat(i[1]," ").concat(t[0],",").concat(t[1])))},"")}function z(t,e){return"string"==typeof t?(e||document).querySelector(t):t||null}function H(t,e){var n,i=document.createElementNS("http://www.w3.org/2000/svg",t);for(n in e){var a,s=e[n];"inside"===n?z(s).appendChild(i):"around"===n?((a=z(s)).parentNode.insertBefore(i,a),i.appendChild(a)):"styles"===n?"object"===o(s)&&Object.keys(s).map(function(t){i.style[t]=s[t]}):"innerHTML"===(n="className"===n?"class":n)?i.textContent=s:i.setAttribute(n,s)}return i}function R(t,e,n,i){return H("stop",{inside:t,style:"stop-color: ".concat(n),offset:e,"stop-opacity":i})}function W(t,e,n){e=1<arguments.length&&void 0!==e?e:"",n=2<arguments.length&&void 0!==n?n:void 0,e={className:t,transform:e};return n&&(e.inside=n),H("g",e)}function j(t,e,n,i,a){return H("path",{className:1<arguments.length&&void 0!==e?e:"",d:t,styles:{stroke:2<arguments.length&&void 0!==n?n:"none",fill:3<arguments.length&&void 0!==i?i:"none","stroke-width":4<arguments.length&&void 0!==a?a:2}})}function B(t,e,n,i){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,o=n.x+t.x,r=n.y+t.y,t=n.x+e.x,e=n.y+e.y;return"M".concat(n.x," ").concat(n.y,"\n\t\tL").concat(o," ").concat(r,"\n\t\tA ").concat(i," ").concat(i," 0 ").concat(s," ").concat(a?1:0,"\n\t\t").concat(t," ").concat(e," z")}function I(t,e,n,i){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,o=n.x+t.x,r=n.y+t.y,l=n.x+e.x,t=2*n.y,e=n.y+e.y;return"M".concat(n.x," ").concat(n.y,"\n\t\tL").concat(o," ").concat(r,"\n\t\tA ").concat(i," ").concat(i," 0 ").concat(s," ").concat(a?1:0,"\n\t\t").concat(l," ").concat(t," z\n\t\tL").concat(o," ").concat(t,"\n\t\tA ").concat(i," ").concat(i," 0 ").concat(s," ").concat(a?1:0,"\n\t\t").concat(l," ").concat(e," z")}function Y(t,e,n,i){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,o=n.x+t.x,r=n.y+t.y,t=n.x+e.x,e=n.y+e.y;return"M".concat(o," ").concat(r,"\n\t\tA ").concat(i," ").concat(i," 0 ").concat(s," ").concat(a?1:0,"\n\t\t").concat(t," ").concat(e)}function V(t,e,n,i){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,o=n.x+t.x,r=n.y+t.y,l=n.x+e.x,e=2*i+r,t=n.y+t.y;return"M".concat(o," ").concat(r,"\n\t\tA ").concat(i," ").concat(i," 0 ").concat(s," ").concat(a?1:0,"\n\t\t").concat(l," ").concat(e,"\n\t\tM").concat(o," ").concat(e,"\n\t\tA ").concat(i," ").concat(i," 0 ").concat(s," ").concat(a?1:0,"\n\t\t").concat(l," ").concat(t)}function U(t,e,n){var i=2<arguments.length&&void 0!==n&&n,n="path-fill-gradient-"+e+"-"+(i?"lighter":"default"),t=H("linearGradient",{inside:t,id:n,x1:0,x2:0,y1:0,y2:1}),i=i?[.15,.05,0]:[1,.6,.2];return R(t,"0%",e,i[0]),R(t,"50%",e,i[1]),R(t,"100%",e,i[2]),n}function _(t,e,n,i,a,s,o){var s=5<arguments.length&&void 0!==s?s:"none",r=6<arguments.length&&void 0!==o?o:{},l={className:t,x:e,y:n,width:i,height:i,rx:a,fill:s};return Object.keys(r).map(function(t){l[t]=r[t]}),H("rect",l)}function q(t,e,n,i,a,s,o,r,l){a=4<arguments.length&&void 0!==a?a:"none",s=5<arguments.length?s:void 0,o=6<arguments.length?o:void 0,r=7<arguments.length&&void 0!==r?r:null,a={className:"legend-dot",x:0,y:4-n,height:n,width:n,rx:i,fill:a},l=H("text",{className:"legend-dataset-label",x:n,y:0,dx:(r=r||10)+"px",dy:r/3+"px","font-size":1.6*r+"px","text-anchor":"start",innerHTML:s=8<arguments.length&&void 0!==l&&l?function(t,e){if(t)return t.length>e?t.slice(0,e-3)+"...":t}(s,18):s}),s=null;o&&(s=H("text",{className:"legend-dataset-value",x:n,y:20,dx:"10px",dy:10/3+"px","font-size":"12px","text-anchor":"start",innerHTML:o}));e=H("g",{transform:"translate(".concat(t,", ").concat(e,")")});return e.appendChild(H("rect",a)),e.appendChild(l),o&&s&&e.appendChild(s),e}function G(t,e,n,i,a){var s=4<arguments.length&&void 0!==a?a:{},a=s.fontSize||10;return H("text",{className:t,x:e,y:n,dy:(void 0!==s.dy?s.dy:a/2)+"px","font-size":a+"px",fill:s.fill||"var(--charts-label-color)","text-anchor":s.textAnchor||"start",innerHTML:i})}function X(t,e,n,i,a){a=4<arguments.length&&void 0!==a?a:{};a.lineType||(a.lineType=""),a.shortenNumbers&&(e=function(t){var e;if("number"==typeof t)e=t;else if("string"==typeof t&&(e=Number(t),Number.isNaN(e)))return t;var n=Math.floor(Math.log10(Math.abs(e)));return n<=2?e:(t=Math.floor(n/3),n=Math.pow(10,n-3*t)*+(e/Math.pow(10,n)).toFixed(1),Math.round(100*n)/100+["","K","M","B","T"][t])}(e));a=H("line",{className:"line-horizontal "+a.className+("dashed"===a.lineType?"dashed":""),x1:n,x2:i,y1:0,y2:0,styles:{stroke:a.stroke}}),e=H("text",{x:n<i?n-4:n+4,y:0,dy:"3px","font-size":"10px","text-anchor":n<i?"end":"start",innerHTML:e+""}),t=H("g",{transform:"translate(0, ".concat(t,")"),"stroke-opacity":1});return 0!==e&&"0"!==e||(t.style.stroke="rgba(27, 31, 35, 0.6)"),t.appendChild(a),t.appendChild(e),t}function J(t,e,n,i,a,s,o){a=4<arguments.length&&void 0!==a?a:"",s=5<arguments.length&&void 0!==s?s:0,o=6<arguments.length&&void 0!==o&&o,i=H("circle",{style:"fill: ".concat(i,"; ").concat(o?"stroke: ".concat(i):""),"data-point-index":s,cx:t,cy:e,r:n});if((a+="")||a.length){i.setAttribute("cy",0),i.setAttribute("cx",0);a=H("text",{className:"data-point-value",x:0,y:0,dy:-5-n+"px","font-size":"10px","text-anchor":"middle",innerHTML:a}),e=H("g",{"data-point-index":s,transform:"translate(".concat(t,", ").concat(e,")")});return e.appendChild(i),e.appendChild(a),e}return i}var K={bar:function(t){var e;"rect"!==t.nodeName&&(e=t.getAttribute("transform"),t=t.childNodes[0]);t=t.cloneNode();return t.style.fill="#000000",t.style.opacity="0.4",e&&t.setAttribute("transform",e),t},dot:function(t){var e;"circle"!==t.nodeName&&(e=t.getAttribute("transform"),t=t.childNodes[0]);var n=t.cloneNode(),i=t.getAttribute("r"),t=t.getAttribute("fill");return n.setAttribute("r",parseInt(i)+4),n.setAttribute("fill",t),n.style.opacity="0.6",e&&n.setAttribute("transform",e),n},heat_square:function(t){var e;"circle"!==t.nodeName&&(e=t.getAttribute("transform"),t=t.childNodes[0]);var n=t.cloneNode(),i=t.getAttribute("r"),t=t.getAttribute("fill");return n.setAttribute("r",parseInt(i)+4),n.setAttribute("fill",t),n.style.opacity="0.6",e&&n.setAttribute("transform",e),n}},$={bar:function(t,e){var n;"rect"!==t.nodeName&&(n=t.getAttribute("transform"),t=t.childNodes[0]);var i=["x","y","width","height"];Object.values(t.attributes).filter(function(t){return i.includes(t.name)&&t.specified}).map(function(t){e.setAttribute(t.name,t.nodeValue)}),n&&e.setAttribute("transform",n)},dot:function(t,e){var n;"circle"!==t.nodeName&&(n=t.getAttribute("transform"),t=t.childNodes[0]);var i=["cx","cy"];Object.values(t.attributes).filter(function(t){return i.includes(t.name)&&t.specified}).map(function(t){e.setAttribute(t.name,t.nodeValue)}),n&&e.setAttribute("transform",n)},heat_square:function(t,e){var n;"circle"!==t.nodeName&&(n=t.getAttribute("transform"),t=t.childNodes[0]);var i=["cx","cy"];Object.values(t.attributes).filter(function(t){return i.includes(t.name)&&t.specified}).map(function(t){e.setAttribute(t.name,t.nodeValue)}),n&&e.setAttribute("transform",n)}},Q={pink:"#F683AE",blue:"#318AD8",green:"#48BB74",grey:"#A6B1B9",red:"#F56B6B",yellow:"#FACF7A",purple:"#44427B",teal:"#5FD8C4",cyan:"#15CCEF",orange:"#F8814F","light-pink":"#FED7E5","light-blue":"#BFDDF7","light-green":"#48BB74","light-grey":"#F4F5F6","light-red":"#F6DFDF","light-yellow":"#FEE9BF","light-purple":"#E8E8F7","light-teal":"#D3FDF6","light-cyan":"#DDF8FD","light-orange":"#FECDB8"};function Z(t,e,n,i){e="string"==typeof e?e:e.join(", ");return[t,{transform:n.join(", ")},i,"easein","translate",{transform:e}]}function tt(t,e,n){return Z(t,[0,n],[0,e],350)}function et(t,e){return[t,{d:e},350,"easein"]}var nt={ease:"0.25 0.1 0.25 1",linear:"0 0 1 1",easein:"0.1 0.8 0.2 1",easeout:"0 0 0.58 1",easeinout:"0.42 0 0.58 1"};function it(t,e){t.style.transform=e,t.style.webkitTransform=e,t.style.msTransform=e,t.style.mozTransform=e,t.style.oTransform=e}function at(t,n){var a=[],s=[];n.map(function(t){var e=t[0],n=e.parentNode;t[0]=e;var i=h(function(t,e,n){var i,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"linear",s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:void 0,o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{},r=t.cloneNode(!0),l=t.cloneNode(!0);for(i in e){var c,u=void 0,u="transform"===i?document.createElementNS("http://www.w3.org/2000/svg","animateTransform"):document.createElementNS("http://www.w3.org/2000/svg","animate"),h=o[i]||t.getAttribute(i),d=e[i],p={attributeName:i,from:h,to:d,begin:"0s",dur:n/1e3+"s",values:h+";"+d,keySplines:nt[a],keyTimes:"0;1",calcMode:"spline",fill:"freeze"};for(c in s&&(p.type=s),p)u.setAttribute(c,p[c]);r.appendChild(u),s?l.setAttribute(i,"translate(".concat(d,")")):l.setAttribute(i,d)}return[r,l]}.apply(void 0,u(t)),2),t=i[0],i=i[1];a.push(i),s.push([t,n]),n.replaceChild(t,e)});t=t.cloneNode(!0);return s.map(function(t,e){t[1].replaceChild(a[e],t[0]),n[e][0]=a[e]}),t}var st=(t(ct,[{key:"prepareData",value:function(t){return t}},{key:"prepareFirstData",value:function(t){return t}},{key:"validateColors",value:function(t,e){var i=[];return(t=(t||[]).concat(k[e])).forEach(function(t){var e,n=/rgb[a]{0,1}\([\d, ]+\)/gim.test(e=t)?/\D+(\d*)\D+(\d*)\D+(\d*)/gim.exec(e).map(function(t,e){return 0!==e?Number(t).toString(16):"#"}).reduce(function(t,e){return"".concat(t).concat(e)}):Q[e]||e;/(^\s*)(#)((?:[A-Fa-f0-9]{3}){1,2})$/i.test(e=n)||/(^\s*)(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/i.test(e)?i.push(n):console.warn('"'+t+'" is not a valid color.')}),i}},{key:"setMeasures",value:function(){}},{key:"configure",value:function(){var t=this,e=this.argHeight;this.baseHeight=e,this.height=e-y(this.measures),this.boundDrawFn=function(){return t.draw(!0)},ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.boundDrawFn),this.resizeObserver.observe(this.parent)),window.addEventListener("resize",this.boundDrawFn),window.addEventListener("orientationchange",this.boundDrawFn)}},{key:"destroy",value:function(){this.resizeObserver&&this.resizeObserver.disconnect(),window.removeEventListener("resize",this.boundDrawFn),window.removeEventListener("orientationchange",this.boundDrawFn)}},{key:"setup",value:function(){this.makeContainer(),this.updateWidth(),this.makeTooltip(),this.draw(!1,!0)}},{key:"makeContainer",value:function(){this.parent.innerHTML="";var t={inside:this.parent,className:"chart-container"};this.independentWidth&&(t.styles={width:this.independentWidth+"px"}),this.container=p.create("div",t)}},{key:"makeTooltip",value:function(){this.tip=new A({parent:this.container,colors:this.colors}),this.bindTooltip()}},{key:"bindTooltip",value:function(){}},{key:"draw",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];t&&null===this.parent.offsetParent||(this.updateWidth(),this.calc(t),this.makeChartArea(),this.setupComponents(),this.components.forEach(function(t){return t.setup(e.drawArea)}),this.render(this.components,!1),n&&(this.data=this.realData,setTimeout(function(){e.update(e.data,!0)},this.initTimeout)),this.config.showLegend&&this.renderLegend(),this.setupNavigation(n))}},{key:"calc",value:function(){}},{key:"updateWidth",value:function(){var t,e;this.baseWidth=(t=this.parent,e=window.getComputedStyle(t),e=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight),t.clientWidth-e),this.width=this.baseWidth-b(this.measures)}},{key:"makeChartArea",value:function(){this.svg&&this.container.removeChild(this.svg);var t=this.measures;this.svg=H("svg",{className:"frappe-chart chart",inside:this.container,width:this.baseWidth,height:this.baseHeight}),this.svgDefs=H("defs",{inside:this.svg}),this.title.length&&(this.titleEL=G("title",t.margins.left,t.margins.top,this.title,{fontSize:t.titleFontSize,fill:"#666666",dy:t.titleFontSize}));var e=g(t);this.drawArea=W(this.type+"-chart chart-draw-area","translate(".concat(m(t),", ").concat(e,")")),this.config.showLegend&&(e+=this.height+t.paddings.bottom,this.legendArea=W("chart-legend","translate(".concat(m(t),", ").concat(e,")"))),this.title.length&&this.svg.appendChild(this.titleEL),this.svg.appendChild(this.drawArea),this.config.showLegend&&this.svg.appendChild(this.legendArea),this.updateTipOffset(m(t),g(t))}},{key:"updateTipOffset",value:function(t,e){this.tip.offset={x:t,y:e}}},{key:"setupComponents",value:function(){this.components=new Map}},{key:"update",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];t||console.error("No data to update."),e||(t=O(t));e=e?!this.config.disableEntryAnimation:this.config.animate;this.data=this.prepareData(t),this.calc(),this.render(this.components,e)}},{key:"render",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.components,n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.config.isNavigable&&this.overlays.map(function(t){return t.parentNode.removeChild(t)});var i,a,s,o,r=[];e.forEach(function(t){r=r.concat(t.update(n))}),0<r.length?(i=this.container,a=this.svg,0!==(s=r).length&&(o=at(a,s),a.parentNode==i&&(i.removeChild(a),i.appendChild(o)),setTimeout(function(){o.parentNode==i&&(i.removeChild(o),i.appendChild(a))},250)),setTimeout(function(){e.forEach(function(t){return t.make()}),t.updateNav()},400)):(e.forEach(function(t){return t.make()}),this.updateNav())}},{key:"updateNav",value:function(){this.config.isNavigable&&(this.makeOverlay(),this.bindUnits())}},{key:"renderLegend",value:function(t){var i=this;this.legendArea.textContent="";var a=0,s=0;t.map(function(t,e){Math.floor(i.width/150)<a&&(a=0,s+=i.config.legendRowHeight);var n=150*a,n=i.makeLegend(t,e,n,s);i.legendArea.appendChild(n),a++})}},{key:"makeLegend",value:function(){}},{key:"setupNavigation",value:function(){var n=this;this.config.isNavigable&&(0<arguments.length&&void 0!==arguments[0]&&arguments[0])&&(this.bindOverlay(),this.keyActions={13:this.onEnterKey.bind(this),37:this.onLeftArrow.bind(this),38:this.onUpArrow.bind(this),39:this.onRightArrow.bind(this),40:this.onDownArrow.bind(this)},document.addEventListener("keydown",function(t){var e;0<=(e=(e=n.container).getBoundingClientRect()).top&&0<=e.left&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)&&(t=t||window.event,n.keyActions[t.keyCode]&&n.keyActions[t.keyCode]())}))}},{key:"makeOverlay",value:function(){}},{key:"updateOverlay",value:function(){}},{key:"bindOverlay",value:function(){}},{key:"bindUnits",value:function(){}},{key:"onLeftArrow",value:function(){}},{key:"onRightArrow",value:function(){}},{key:"onUpArrow",value:function(){}},{key:"onDownArrow",value:function(){}},{key:"onEnterKey",value:function(){}},{key:"addDataPoint",value:function(){}},{key:"removeDataPoint",value:function(){}},{key:"getDataPoint",value:function(){}},{key:"setCurrentDataPoint",value:function(){}},{key:"updateDataset",value:function(){}},{key:"export",value:function(){var t=function(t){var e=t.cloneNode(!0);e.classList.add("chart-container"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");t=p.create("style",{innerHTML:".chart-container{position:relative;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif}.chart-container .axis,.chart-container .chart-label{fill:#555b51}.chart-container .axis line,.chart-container .chart-label line{stroke:#dadada}.chart-container .dataset-units circle{stroke:#fff;stroke-width:2}.chart-container .dataset-units path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container .dataset-path{stroke-width:2px}.chart-container .path-group path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container line.dashed{stroke-dasharray:5,3}.chart-container .axis-line .specific-value{text-anchor:start}.chart-container .axis-line .y-line{text-anchor:end}.chart-container .axis-line .x-line{text-anchor:middle}.chart-container .legend-dataset-text{fill:#6c7680;font-weight:600}.graph-svg-tip{position:absolute;z-index:99999;padding:10px;font-size:12px;color:#959da5;text-align:center;background:rgba(0,0,0,.8);border-radius:3px}.graph-svg-tip ul{padding-left:0;display:flex}.graph-svg-tip ol{padding-left:0;display:flex}.graph-svg-tip ul.data-point-list li{min-width:90px;flex:1;font-weight:600}.graph-svg-tip strong{color:#dfe2e5;font-weight:600}.graph-svg-tip .svg-pointer{position:absolute;height:5px;margin:0 0 0 -5px;content:' ';border:5px solid transparent;}.graph-svg-tip.comparison{padding:0;text-align:left;pointer-events:none}.graph-svg-tip.comparison .title{display:block;padding:10px;margin:0;font-weight:600;line-height:1;pointer-events:none}.graph-svg-tip.comparison ul{margin:0;white-space:nowrap;list-style:none}.graph-svg-tip.comparison li{display:inline-block;padding:5px 10px}"});e.insertBefore(t,e.firstChild);t=p.create("div");return t.appendChild(e),t.innerHTML}(this.svg);!function(t,e){var n=document.createElement("a");n.style="display: none";var e=new Blob(e,{type:"image/svg+xml; charset=utf-8"}),i=window.URL.createObjectURL(e);n.href=i,n.download=t,document.body.appendChild(n),n.click(),setTimeout(function(){document.body.removeChild(n),window.URL.revokeObjectURL(i)},300)}(this.title||"Chart",[t])}}]),ct),ot=function(){e(i,st);var n=l(i);function i(t,e){return r(this,i),n.call(this,t,e)}return t(i,[{key:"configure",value:function(t){c(s(i.prototype),"configure",this).call(this,t),this.config.formatTooltipY=(t.tooltipOptions||{}).formatTooltipY,this.config.maxSlices=t.maxSlices||20,this.config.maxLegendPoints=t.maxLegendPoints||20,this.config.legendRowHeight=60}},{key:"calc",value:function(){var i=this,e=this.state,t=this.config.maxSlices;e.sliceTotals=[];var n,a=this.data.labels.map(function(t,e){var n=0;return i.data.datasets.map(function(t){n+=t.values[e]}),[n,t]}).filter(function(t){return 0<=t[0]}),s=a;a.length>t&&(a.sort(function(t,e){return e[0]-t[0]}),s=a.slice(0,t-1),a=a.slice(t-1),n=0,a.map(function(t){n+=t[0]}),s.push([n,"Rest"]),this.colors[t-1]="grey"),e.labels=[],s.map(function(t){e.sliceTotals.push(N(t[0])),e.labels.push(t[1])}),e.grandTotal=e.sliceTotals.reduce(function(t,e){return t+e},0),this.center={x:this.width/2,y:this.height/2}}},{key:"renderLegend",value:function(){var t=this.state;this.legendArea.textContent="",this.legendTotals=t.sliceTotals.slice(0,this.config.maxLegendPoints),c(s(i.prototype),"renderLegend",this).call(this,this.legendTotals)}},{key:"makeLegend",value:function(t,e,n,i){t=this.config.formatTooltipY?this.config.formatTooltipY(t):t;return q(n,i,12,3,this.colors[e],this.state.labels[e],t,null,this.config.truncateLegends)}}]),i}(),rt=["January","February","March","April","May","June","July","August","September","October","November","December"],lt=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function ct(t,e){if(r(this,ct),e=O(e),this.parent="string"==typeof t?document.querySelector(t):t,!(this.parent instanceof HTMLElement))throw new Error("No `parent` element to render on was provided.");this.rawChartArgs=e,this.title=e.title||"",this.type=e.type||"",this.realData=this.prepareData(e.data),this.data=this.prepareFirstData(this.realData),this.colors=this.validateColors(e.colors,this.type),this.config={showTooltip:1,showLegend:void 0!==e.showLegend?e.showLegend:1,isNavigable:e.isNavigable||0,animate:void 0!==e.animate?e.animate:1,disableEntryAnimation:e.disableEntryAnimation||0,truncateLegends:e.truncateLegends||1},this.measures=JSON.parse(JSON.stringify(v));t=this.measures;this.setMeasures(e),this.title.length||(t.titleHeight=0),this.config.showLegend||(t.legendHeight=0),this.argHeight=e.height||t.baseHeight,this.state={},this.options={},this.initTimeout=700,this.config.isNavigable&&(this.overlays=[]),this.configure(e)}function ut(t){t=new Date(t);return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t}function ht(t){var e=t.getDate(),n=t.getMonth()+1;return[t.getFullYear(),(9<n?"":"0")+n,(9<e?"":"0")+e].join("-")}function dt(t){return new Date(t.getTime())}function pt(t,e){t=gt(t);return Math.ceil((t=t,(ut(e)-ut(t))/864e5/7))}function ft(t,e){t=rt[t];return 1<arguments.length&&void 0!==e&&e?t.slice(0,3):t}function vt(t,e){return new Date(e,t+1,0)}function gt(t){var e=dt(t),t=e.getDay();return 0!==t&&mt(e,-1*t),e}function mt(t,e){t.setDate(t.getDate()+e)}var yt=(t(xt,[{key:"refresh",value:function(t){this.data=t||this.getData()}},{key:"setup",value:function(t){this.layer=W(this.layerClass,this.layerTransform,t)}},{key:"make",value:function(){this.render(this.data),this.oldData=this.data}},{key:"render",value:function(t){var e=this;this.store=this.makeElements(t),this.layer.textContent="",this.store.forEach(function(t){e.layer.appendChild(t)}),this.labels.forEach(function(t){e.layer.appendChild(t)})}},{key:"update",value:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.refresh();var e=[];return e=t?this.animateElements(this.data)||[]:e}}]),xt),bt={donutSlices:{layerClass:"donut-slices",makeElements:function(n){return n.sliceStrings.map(function(t,e){e=j(t,"donut-path",n.colors[e],"none",n.strokeWidth);return e.style.transition="transform .3s;",e})},animateElements:function(n){return this.store.map(function(t,e){return et(t,n.sliceStrings[e])})}},pieSlices:{layerClass:"pie-slices",makeElements:function(n){return n.sliceStrings.map(function(t,e){e=j(t,"pie-path","none",n.colors[e]);return e.style.transition="transform .3s;",e})},animateElements:function(n){return this.store.map(function(t,e){return et(t,n.sliceStrings[e])})}},percentageBars:{layerClass:"percentage-bars",makeElements:function(n){var i=this,a=n.xPositions.length;return n.xPositions.map(function(t,e){return function(t,e,n,i,a,s,o){var r,l,o=6<arguments.length&&void 0!==o?o:"none";return s?j((r=n,r-=s=(l=i)/2,"M".concat(t,",0 h").concat(r," q").concat(s,",0 ").concat(s,",").concat(s," q0,").concat(s," -").concat(s,",").concat(s," h-").concat(r," v").concat(l,"z")),"percentage-bar",null,o):a?j((r=n,r-=a=(l=i)/2,"M".concat(t+a,",0 h").concat(r," v").concat(l," h-").concat(r," q-").concat(a,", 0 -").concat(a,",-").concat(a," q0,-").concat(a," ").concat(a,",-").concat(a,"z")),"percentage-bar",null,o):H("rect",{className:"percentage-bar",x:t,y:0,width:n,height:i,fill:o})}(t,0,n.widths[e],i.constants.barHeight,0==e,e==a-1,n.colors[e])})},animateElements:function(t){if(t)return[]}},yAxis:{layerClass:"y axis",makeElements:function(n){var i=this;return n.positions.map(function(t,e){return function(t,e,n,i){var a=3<arguments.length&&void 0!==i?i:{};C(t)||(t=0),a.pos||(a.pos="left"),a.offset||(a.offset=0),a.mode||(a.mode="span"),a.stroke||(a.stroke="#E2E6E9"),a.className||(a.className="");var s=-6,i="span"===a.mode?n+6:0;return"tick"===a.mode&&"right"===a.pos&&(s=n+6,i=n),s+=a.offset,i+=a.offset,X(t,e="number"==typeof e?N(e):e,s,i,{className:a.className,lineType:a.lineType,shortenNumbers:a.shortenNumbers})}(t,n.labels[e],i.constants.width,{mode:i.constants.mode,pos:i.constants.pos,shortenNumbers:i.constants.shortenNumbers})})},animateElements:function(t){var n=t.positions,e=t.labels,i=this.oldData.positions,a=this.oldData.labels,t=h(S(i,n),2),i=t[0],n=t[1],t=h(S(a,e),2),e=(t[0],t[1]);return this.render({positions:i,labels:e}),this.store.map(function(t,e){return tt(t,n[e],i[e])})}},xAxis:{layerClass:"x axis",makeElements:function(n){var i=this;return n.positions.map(function(t,e){return function(t,e,n,i){var a=3<arguments.length&&void 0!==i?i:{};C(t)||(t=0),a.pos||(a.pos="bottom"),a.offset||(a.offset=0),a.mode||(a.mode="span"),a.className||(a.className="");i=n+6,n="span"===a.mode?-6:n;return"tick"===a.mode&&"top"===a.pos&&(i=-6,n=0),function(t,e,n,i,a){return a=H("line",{className:"line-vertical "+(a=4<arguments.length&&void 0!==a?a:{}).className,x1:0,x2:0,y1:n,y2:i,styles:{stroke:a.stroke}}),e=H("text",{x:0,y:i<n?n+4:n-4-10,dy:"10px","font-size":"10px","text-anchor":"middle",innerHTML:e+""}),(t=H("g",{transform:"translate(".concat(t,", 0)")})).appendChild(a),t.appendChild(e),t}(t,e,i,n,{className:a.className,lineType:a.lineType})}(t,n.calcLabels[e],i.constants.height,{mode:i.constants.mode,pos:i.constants.pos})})},animateElements:function(t){var i=t.positions,e=t.calcLabels,a=this.oldData.positions,n=this.oldData.calcLabels,t=h(S(a,i),2),a=t[0],i=t[1],t=h(S(n,e),2),e=(t[0],t[1]);return this.render({positions:a,calcLabels:e}),this.store.map(function(t,e){return n=i[e],Z(t,[a[e],0],[n,0],350);var n})}},yMarkers:{layerClass:"y-markers",makeElements:function(t){var e=this;return t.map(function(t){return function(t,e,n,i){i=3<arguments.length&&void 0!==i?i:{};C(t)||(t=0),i.labelPos||(i.labelPos="right"),i.lineType||(i.lineType="dashed");e=H("text",{className:"chart-label",x:"left"===i.labelPos?4:n-P(e,5)-4,y:0,dy:"-5px","font-size":"10px","text-anchor":"start",innerHTML:e+""}),i=X(t,"",0,n,{stroke:i.stroke||"#E2E6E9",className:i.className||"",lineType:i.lineType});return i.appendChild(e),i}(t.position,t.label,e.constants.width,{labelPos:t.options.labelPos,stroke:t.options.stroke,mode:"span",lineType:t.options.lineType})})},animateElements:function(t){var e=h(S(this.oldData,t),2);this.oldData=e[0];var n=(t=e[1]).map(function(t){return t.position}),i=t.map(function(t){return t.label}),a=t.map(function(t){return t.options}),s=this.oldData.map(function(t){return t.position});return this.render(s.map(function(t,e){return{position:s[e],label:i[e],options:a[e]}})),this.store.map(function(t,e){return tt(t,n[e],s[e])})}},yRegions:{layerClass:"y-regions",makeElements:function(t){var e=this;return t.map(function(t){return function(t,e,n,i,a){a=4<arguments.length&&void 0!==a?a:{},t-=e,t=H("rect",{className:"bar mini",styles:{fill:a.fill||"rgba(228, 234, 239, 0.49)",stroke:a.stroke||"#E2E6E9","stroke-dasharray":"".concat(n,", ").concat(t)},x:0,y:0,width:n,height:t});a.labelPos||(a.labelPos="right");i=H("text",{className:"chart-label",x:"left"===a.labelPos?4:n-P(i+"",4.5)-4,y:0,dy:"-5px","font-size":"10px","text-anchor":"start",innerHTML:i+""}),e=H("g",{transform:"translate(0, ".concat(e,")")});return e.appendChild(t),e.appendChild(i),e}(t.startPos,t.endPos,e.constants.width,t.label,{labelPos:t.options.labelPos,stroke:t.options.stroke,fill:t.options.fill})})},animateElements:function(t){var e=h(S(this.oldData,t),2);this.oldData=e[0];var o=(t=e[1]).map(function(t){return t.endPos}),n=t.map(function(t){return t.label}),r=t.map(function(t){return t.startPos}),i=t.map(function(t){return t.options}),l=this.oldData.map(function(t){return t.endPos}),a=this.oldData.map(function(t){return t.startPos});this.render(l.map(function(t,e){return{startPos:a[e],endPos:l[e],label:n[e],options:i[e]}}));var c=[];return this.store.map(function(t,e){var n,i,a,s;c=c.concat((n=t,i=r[e],a=o[e],s=l[e],t=i-a,e=n.childNodes[0],i=e.getAttribute("width"),[[e,{height:t,"stroke-dasharray":"".concat(i,", ").concat(t)},350,"easein"],Z(n,[0,s],[0,a],350)]))}),c}},heatDomain:{layerClass:function(){return"heat-domain domain-"+this.constants.index},makeElements:function(t){var n=this,e=this.constants,i=e.index,a=e.colWidth,s=e.rowHeight,o=e.squareSize,r=e.radius,l=e.xTranslate,c=0;return this.serializedSubDomains=[],t.cols.map(function(t,e){1===e&&n.labels.push(G("domain-name",l,-12,ft(i,!0).toUpperCase(),{fontSize:9})),t.map(function(t,e){t.fill&&(e={"data-date":t.yyyyMmDd,"data-value":t.dataValue,"data-day":e},e=_("day",l,c,o,r,t.fill,e),n.serializedSubDomains.push(e)),c+=s}),c=0,l+=a}),this.serializedSubDomains},animateElements:function(t){if(t)return[]}},barGraph:{layerClass:function(){return"dataset-units dataset-bars dataset-"+this.constants.index},makeElements:function(n){var i=this.constants;return this.unitType="bar",this.units=n.yPositions.map(function(t,e){return function(t,e,n,i,a,s,o,r){var l=4<arguments.length&&void 0!==a?a:"",a=5<arguments.length&&void 0!==s?s:0,s=6<arguments.length&&void 0!==o?o:0,o=7<arguments.length&&void 0!==r?r:{},r=h(E(e,o.zeroLine),2),e=r[0],r=r[1];r-=s,0===e&&(e=o.minHeight,r-=o.minHeight),C(t)||(t=0),C(r)||(r=0),C(e,!0)||(e=0),C(n,!0)||(n=0);e=H("rect",{className:"bar mini",style:"fill: ".concat(i),"data-point-index":a,x:t,y:r,width:n,height:e});if((l+="")||l.length){e.setAttribute("y",0),e.setAttribute("x",0);l=H("text",{className:"data-point-value",x:n/2,y:0,dy:"-5px","font-size":"10px","text-anchor":"middle",innerHTML:l}),r=H("g",{"data-point-index":a,transform:"translate(".concat(t,", ").concat(r,")")});return r.appendChild(e),r.appendChild(l),r}return e}(n.xPositions[e],t,n.barWidth,i.color,n.labels[e],e,n.offsets[e],{zeroLine:n.zeroLine,barsWidth:n.barsWidth,minHeight:i.minHeight})}),this.units},animateElements:function(n){var i=n.xPositions,a=n.yPositions,s=n.offsets,t=n.labels,e=this.oldData.xPositions,o=this.oldData.yPositions,r=this.oldData.offsets,l=this.oldData.labels,c=h(S(e,i),2),e=c[0],i=c[1],c=h(S(o,a),2),o=c[0],a=c[1],c=h(S(r,s),2),r=c[0],s=c[1],c=h(S(l,t),2),t=(c[0],c[1]);this.render({xPositions:e,yPositions:o,offsets:r,labels:t,zeroLine:this.oldData.zeroLine,barsWidth:this.oldData.barsWidth,barWidth:this.oldData.barWidth});var u=[];return this.store.map(function(t,e){u=u.concat(function(t,e,n,i,a,s){a=4<arguments.length&&void 0!==a?a:0,n=h(E(n,(5<arguments.length&&void 0!==s?s:{}).zeroLine),2),s=n[0],n=n[1];if(n-=a,"rect"===t.nodeName)return[[t,{width:i,height:s,x:e,y:n},350,"easein"]];i=[t.childNodes[0],{width:i,height:s},350,"easein"],s=t.getAttribute("transform").split("(")[1].slice(0,-1);return[i,Z(t,s,[e,n],350)]}(t,i[e],a[e],n.barWidth,s[e],{zeroLine:n.zeroLine}))}),u}},lineGraph:{layerClass:function(){return"dataset-units dataset-line dataset-"+this.constants.index},makeElements:function(n){var t,i=this.constants;return this.unitType="dot",this.paths={},i.hideLine||(this.paths=function(n,t,e,i,a){var s=3<arguments.length&&void 0!==i?i:{},o=4<arguments.length&&void 0!==a?a:{},i=t.map(function(t,e){return n[e]+","+t}).join("L"),a=j("M"+(i=s.spline?F(n,t):i),"line-graph-path",e);s.heatline&&(t=U(o.svgDefs,e),a.style.stroke="url(#".concat(t,")"));a={path:a};return s.regionFill&&(e=U(o.svgDefs,e,!0),o="M"+"".concat(n[0],",").concat(o.zeroLine,"L")+i+"L".concat(n.slice(-1)[0],",").concat(o.zeroLine),a.region=j(o,"region-fill","none","url(#".concat(e,")"))),a}(n.xPositions,n.yPositions,i.color,{heatline:i.heatline,regionFill:i.regionFill,spline:i.spline},{svgDefs:i.svgDefs,zeroLine:n.zeroLine})),this.units=[],i.showDots&&(this.units=n.yPositions.map(function(t,e){return J(n.xPositions[e],t,n.radius,i.color,i.valuesOverPoints?n.values[e]:"",e,i.hideDotBorder)})),i.trailingDot&&!i.showDots&&(t=n.yPositions.length-1,t=J(n.xPositions[t],n.yPositions[t],n.radius,i.color,i.valuesOverPoints?n.values[t]:"",t,i.hideDotBorder),this.units.push(t)),Object.values(this.paths).concat(this.units)},animateElements:function(t){var n=t.xPositions,i=t.yPositions,e=t.values,a=this.oldData.xPositions,s=this.oldData.yPositions,o=this.oldData.values,r=h(S(a,n),2),a=r[0],n=r[1],r=h(S(s,i),2),s=r[0],i=r[1],r=h(S(o,e),2),e=(r[0],r[1]);this.render({xPositions:a,yPositions:s,values:e,zeroLine:this.oldData.zeroLine,radius:this.oldData.radius});var l=[];return Object.keys(this.paths).length&&(l=l.concat(function(t,n,e,i,a){var s=[],o=e.map(function(t,e){return n[e]+","+t}).join("L");a&&(o=F(n,e));e=[t.path,{d:"M"+o},350,"easein"];return s.push(e),t.region&&(e="".concat(n[0],",").concat(i,"L"),i="L".concat(n.slice(-1)[0],", ").concat(i),i=[t.region,{d:"M"+e+o+i},350,"easein"],s.push(i)),s}(this.paths,n,i,t.zeroLine,this.constants.spline))),this.units.length&&this.units.map(function(t,e){l=l.concat(function(t,e,n){if("circle"===t.nodeName)return[[t,{cx:e,cy:n},350,"easein"]];var i=t.getAttribute("transform").split("(")[1].slice(0,-1);return[Z(t,i,[e,n],350)]}(t,n[e],i[e]))}),l}}};function xt(t){var e=t.layerClass,n=void 0===e?"":e,i=t.layerTransform,a=void 0===i?"":i,s=t.constants,e=t.getData,i=t.makeElements,t=t.animateElements;r(this,xt),this.layerTransform=a,this.constants=s,this.makeElements=i,this.getData=e,this.animateElements=t,this.store=[],this.labels=[],this.layerClass=n,this.layerClass="function"==typeof this.layerClass?this.layerClass():this.layerClass,this.refresh()}function kt(e,t,n){var i=Object.keys(bt).filter(function(t){return e.includes(t)}),i=bt[i[0]];return Object.assign(i,{constants:t,getData:n}),new yt(i)}var wt=function(){e(a,ot);var n=l(a);function a(t,e){return r(this,a),(e=n.call(this,t,e)).type="percentage",e.setup(),e}return t(a,[{key:"setMeasures",value:function(t){var e=this.measures;this.barOptions=t.barOptions||{};t=this.barOptions;t.height=t.height||16,e.paddings.right=30,e.paddings.top=60,e.paddings.bottom=0,e.legendHeight=80,e.baseHeight=8*t.height+y(e)}},{key:"setupComponents",value:function(){var t=this.state,e=[["percentageBars",{barHeight:this.barOptions.height},function(){return{xPositions:t.xPositions,widths:t.widths,colors:this.colors}}.bind(this)]];this.components=new Map(e.map(function(t){var e=kt.apply(void 0,u(t));return[t[0],e]}))}},{key:"calc",value:function(){var e=this;c(s(a.prototype),"calc",this).call(this);var n=this.state;n.xPositions=[],n.widths=[];var i=0;n.sliceTotals.map(function(t){t=e.width*t/n.grandTotal;n.widths.push(t),n.xPositions.push(i),i+=t})}},{key:"makeDataByIndex",value:function(){}},{key:"bindTooltip",value:function(){var a=this,s=this.state;this.container.addEventListener("mousemove",function(t){var e,n=a.components.get("percentageBars").store,i=t.target;n.includes(i)&&(e=n.indexOf(i),t=f(a.container),n=f(i),i=i.getAttribute("width")||i.getBoundingClientRect().width,i=n.left-t.left+parseInt(i)/2,n=n.top-t.top,t=(a.formattedLabels&&0<a.formattedLabels.length?a.formattedLabels:a.state.labels)[e]+": ",e=s.sliceTotals[e]/s.grandTotal,a.tip.setValues(i,n,{name:t,value:(100*e).toFixed(1)+"%"}),a.tip.showTip())})}}]),a}(),At=function(){e(i,ot);var n=l(i);function i(t,e){return r(this,i),(e=n.call(this,t,e)).initTimeout=0,e.init=1,e.setup(),e}return t(i,[{key:"configure",value:function(t){c(s(i.prototype),"configure",this).call(this,t),this.mouseMove=this.mouseMove.bind(this),this.mouseLeave=this.mouseLeave.bind(this),this.hoverRadio=t.hoverRadio||.1,this.config.startAngle=t.startAngle||0,this.type="pie",this.sliceName="pieSlices",this.arcFunc=B,this.shapeFunc=I,this.clockWise=t.clockWise||!1}},{key:"getRadius",value:function(){return this.height>this.width?this.center.x:this.center.y}},{key:"calc",value:function(){var u=this;c(s(i.prototype),"calc",this).call(this);var h=this.state;this.radius=this.getRadius();var d=this.radius,p=this.clockWise,f=h.slicesProperties||[];h.sliceStrings=[],h.slicesProperties=[];var v=180-this.config.startAngle;h.sliceTotals.map(function(t,e){var n,i=v,a=t/h.grandTotal*360,s=180<a?1:0,o=p?-a:a,r=v+=o,l=T(i,d),c=T(r,d),e=u.init&&f[e],e=u.init?(n=e?e.startPosition:l,e?e.endPosition:l):(n=l,c),s=360==a?u.shapeFunc(n,e,u.center,u.radius,p,s):u.arcFunc(n,e,u.center,u.radius,p,s);h.sliceStrings.push(s),h.slicesProperties.push({startPosition:l,endPosition:c,value:t,total:h.grandTotal,startAngle:i,endAngle:r,angle:o})}),this.init=0}},{key:"setupComponents",value:function(){var t=this.state,e=[["pieSlices",{},function(){return{sliceStrings:t.sliceStrings,colors:this.colors}}.bind(this)]];this.components=new Map(e.map(function(t){var e=kt.apply(void 0,u(t));return[t[0],e]}))}},{key:"calTranslateByAngle",value:function(t){var e=this.radius,n=this.hoverRadio,e=T(t.startAngle+t.angle/2,e);return"translate3d(".concat(e.x*n,"px,").concat(e.y*n,"px,0)")}},{key:"hoverSlice",value:function(t,e,n,i){var a,s;t&&(a=this.colors[e],n?(it(t,this.calTranslateByAngle(this.state.slicesProperties[e])),s=f(this.svg),n=i.pageX-s.left+10,i=i.pageY-s.top-10,s=(this.formatted_labels&&0<this.formatted_labels.length?this.formatted_labels:this.state.labels)[e]+": ",e=(100*this.state.sliceTotals[e]/this.state.grandTotal).toFixed(1),this.tip.setValues(n,i,{name:s,value:e+"%"}),this.tip.showTip()):this.resetHover(t,a))}},{key:"resetHover",value:function(t,e){it(t,"translate3d(0,0,0)"),this.tip.hideTip(),t.style.fill=e}},{key:"bindTooltip",value:function(){this.container.addEventListener("mousemove",this.mouseMove),this.container.addEventListener("mouseleave",this.mouseLeave)}},{key:"mouseMove",value:function(t){var e=t.target,n=this.components.get(this.sliceName).store,i=this.curActiveSliceIndex,a=this.curActiveSlice;n.includes(e)?(n=n.indexOf(e),this.hoverSlice(a,i,!1),this.curActiveSlice=e,this.curActiveSliceIndex=n,this.hoverSlice(e,n,!0,t)):this.mouseLeave()}},{key:"mouseLeave",value:function(){this.hoverSlice(this.curActiveSlice,this.curActiveSliceIndex,!1)}}]),i}();function Dt(t){if(0===t)return[0,0];if(isNaN(t))return{mantissa:-6755399441055744,exponent:972};var e=0<t?1:-1;if(!isFinite(t))return{mantissa:4503599627370496*e,exponent:972};t=Math.abs(t);var n=Math.floor(Math.log10(t));return[e*(t/Math.pow(10,n)),n]}function Lt(t,e){var n=1<arguments.length&&void 0!==e?e:0,e=h(Dt(t),2),t=e[0],i=e[1],n=n?n/Math.pow(10,i):0,n=function(t,e){var e=1<arguments.length&&void 0!==e?e:0,t=Math.ceil(t),n=Math.floor(e),e=t-n,i=e,a=1;5<e&&(i=(e=e%2!=0?++t-n:e)/2,a=2),e<=2&&(a=e/(i=4)),0===e&&(i=5,a=1);for(var s=[],o=0;o<=i;o++)s.push(n+a*o);return s}(t=t.toFixed(6),n);return n.map(function(t){return t*Math.pow(10,i)})}function Mt(t){return t[1]-t[0]}function Pt(t,e){return L(e.zeroLine-t*e.scaleMultiplier)}x=function(){e(a,st);var i=l(a);function a(t,e){var n;r(this,a),(n=i.call(this,t,e)).type="heatmap",n.countLabel=e.countLabel||"";t=["Sunday","Monday"],e=t.includes(e.startSubDomain)?e.startSubDomain:"Sunday";return n.startSubDomainIndex=t.indexOf(e),n.setup(),n}return t(a,[{key:"setMeasures",value:function(t){var e=this.measures;this.discreteDomains=0===t.discreteDomains?0:1,e.paddings.top=36,e.paddings.bottom=0,e.legendHeight=24,e.baseHeight=84+y(e);var n=this.data,t=this.discreteDomains?12:0;this.independentWidth=12*(pt(n.start,n.end)+t)+b(e)}},{key:"updateWidth",value:function(){var t=this.discreteDomains?12:0,e=this.state.noOfWeeks||52;this.baseWidth=12*(e+t)+b(this.measures)}},{key:"prepareData",value:function(){var n,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.data;if(i.start&&i.end&&i.start>i.end)throw new Error("Start date cannot be greater than end date.");return i.start||(i.start=new Date,i.start.setFullYear(i.start.getFullYear()-1)),i.end||(i.end=new Date),i.dataPoints=i.dataPoints||{},1e5<parseInt(Object.keys(i.dataPoints)[0])&&(n={},Object.keys(i.dataPoints).forEach(function(t){var e=new Date(1e3*t);n[ht(e)]=i.dataPoints[t]}),i.dataPoints=n),i}},{key:"calc",value:function(){var t=this.state;t.start=dt(this.data.start),t.end=dt(this.data.end),t.firstWeekStart=dt(t.start),t.noOfWeeks=pt(t.start,t.end),t.distribution=function(t){for(var e=Math.max.apply(Math,u(t)),n=[],i=0;i<5;i++)n.push(e*(.25*i));return n}(Object.values(this.data.dataPoints)),t.domainConfigs=this.getDomains()}},{key:"setupComponents",value:function(){var i=this,e=this.state,a=this.discreteDomains?0:1,t=e.domainConfigs.map(function(t,n){return["heatDomain",{index:t.index,colWidth:12,rowHeight:12,squareSize:10,radius:i.rawChartArgs.radius||0,xTranslate:12*e.domainConfigs.filter(function(t,e){return e<n}).map(function(t){return t.cols.length-a}).reduce(function(t,e){return t+e},0)},function(){return e.domainConfigs[n]}.bind(i)]});this.components=new Map(t.map(function(t,e){var n=kt.apply(void 0,u(t));return[t[0]+"-"+e,n]}));var n=0;lt.forEach(function(t,e){[1,3,5].includes(e)&&(t=G("subdomain-name",-6,n,t,{fontSize:10,dy:8,textAnchor:"end"}),i.drawArea.appendChild(t)),n+=12})}},{key:"update",value:function(t){t||console.error("No data to update."),this.data=this.prepareData(t),this.draw(),this.bindTooltip()}},{key:"bindTooltip",value:function(){var r=this;this.container.addEventListener("mousemove",function(o){r.components.forEach(function(t){var e,n,i,a=t.store,s=o.target;a.includes(s)&&(n=s.getAttribute("data-value"),i=s.getAttribute("data-date").split("-"),e=ft(parseInt(i[1])-1,!0),t=r.container.getBoundingClientRect(),a=s.getBoundingClientRect(),s=parseInt(o.target.getAttribute("width")),s=a.left-t.left+s/2,t=a.top-t.top,n=n+" "+r.countLabel,i=" on "+e+" "+i[0]+", "+i[2],r.tip.setValues(s,t,{name:i,value:n,valueFirst:1},[]),r.tip.showTip())})})}},{key:"renderLegend",value:function(){var n=this;this.legendArea.textContent="";var i=this.rawChartArgs.radius||0,t=G("subdomain-name",0,12,"Less",{fontSize:11,dy:9});this.legendArea.appendChild(t),this.colors.slice(0,5).map(function(t,e){t=_("heatmap-legend-unit",30+15*e,12,10,i,t);n.legendArea.appendChild(t)});t=G("subdomain-name",108,12,"More",{fontSize:11,dy:9});this.legendArea.appendChild(t)}},{key:"getDomains",value:function(){for(var t,e=this.state,n=[e.start.getMonth(),e.start.getFullYear()],i=n[0],a=n[1],n=[e.end.getMonth(),e.end.getFullYear()],s=n[0]-i+1+12*(n[1]-a),o=[],r=dt(e.start),l=0;l<s;l++){var c,u=e.end;t=r,c=e.end,t.getMonth()===c.getMonth()&&t.getFullYear()===c.getFullYear()||(u=vt((c=[r.getMonth(),r.getFullYear()])[0],c[1])),o.push(this.getDomainConfig(r,u)),mt(u,1),r=u}return o}},{key:"getDomainConfig",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=[t.getMonth(),t.getFullYear()],i=n[0],n=n[1],a=gt(t),t={index:i,cols:[]};mt(e=dt(e)||vt(i,n),1);for(var s,o=pt(a,e),r=[],l=0;l<o;l++)s=this.getCol(a,i),r.push(s),mt(a=new Date(s[6].yyyyMmDd),1);return void 0!==s[6].dataValue&&(mt(a,1),r.push(this.getCol(a,i,!0))),t.cols=r,t}},{key:"getCol",value:function(t,e){for(var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=this.state,a=dt(t),s=[],o=0;o<7;o++,mt(a,1)){var r={},l=a>=i.start&&a<=i.end;n||a.getMonth()!==e||!l?r.yyyyMmDd=ht(a):r=this.getSubDomainConfig(a),s.push(r)}return s}},{key:"getSubDomainConfig",value:function(t){var e,n=ht(t),t=this.data.dataPoints[n];return{yyyyMmDd:n,dataValue:t||0,fill:this.colors[e=t,this.state.distribution.filter(function(t){return t<e}).length]}}}]),a}();var Tt=function(){e(a,st);var n=l(a);function a(t,e){return r(this,a),(t=n.call(this,t,e)).barOptions=e.barOptions||{},t.lineOptions=e.lineOptions||{},t.type=e.type||"line",t.init=1,t.setup(),t}return t(a,[{key:"setMeasures",value:function(){this.data.datasets.length<=1&&(this.config.showLegend=0,this.measures.paddings.bottom=30)}},{key:"configure",value:function(t){c(s(a.prototype),"configure",this).call(this,t),t.axisOptions=t.axisOptions||{},t.tooltipOptions=t.tooltipOptions||{},this.config.xAxisMode=t.axisOptions.xAxisMode||"span",this.config.yAxisMode=t.axisOptions.yAxisMode||"span",this.config.xIsSeries=t.axisOptions.xIsSeries||0,this.config.shortenYAxisNumbers=t.axisOptions.shortenYAxisNumbers||0,this.config.yAxisRange=t.axisOptions.yAxisRange||{},this.config.formatTooltipX=t.tooltipOptions.formatTooltipX,this.config.formatTooltipY=t.tooltipOptions.formatTooltipY,this.config.valuesOverPoints=t.valuesOverPoints,this.config.legendRowHeight=30}},{key:"prepareData",value:function(){return function(t,n){t.labels=t.labels||[];var i=t.labels.length,e=t.datasets,a=new Array(i).fill(0);return(e=e||[{values:a}]).map(function(t){var e;t.values?(e=(e=(e=t.values).map(function(t){return isNaN(t)?0:t})).length>i?e.slice(0,i):M(e,i-e.length,0),t.values=e):t.values=a,t.chartType||(t.chartType=n)}),t.yRegions&&t.yRegions.map(function(t){var e;t.end<t.start&&(e=[t.end,t.start],t.start=e[0],t.end=e[1])}),t}(0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.data,this.type)}},{key:"prepareFirstData",value:function(){var t,e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.data;return n=(t=n).labels.length,e=new Array(n).fill(0),n={labels:t.labels.slice(0,-1),datasets:t.datasets.map(function(t){return{name:"",values:e.slice(0,-1),chartType:t.chartType}})},t.yMarkers&&(n.yMarkers=[{value:0,label:""}]),t.yRegions&&(n.yRegions=[{start:0,end:0,label:""}]),n}},{key:"calc",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.calcXPositions(),t||this.calcYAxisParameters(this.getAllYValues(),"line"===this.type),this.makeDataByIndex()}},{key:"calcXPositions",value:function(){var n=this.state,t=this.data.labels;n.datasetLength=t.length,n.unitWidth=this.width/n.datasetLength,n.xOffset=n.unitWidth/2,n.xAxis={labels:t,positions:t.map(function(t,e){return L(n.xOffset+e*n.unitWidth)})}}},{key:"calcYAxisParameters",value:function(t){var e,n=function(t,e,n){var i=1<arguments.length&&void 0!==e&&e,a=2<arguments.length&&void 0!==n?n:{},e=Math.max.apply(Math,u(t)),n=Math.min.apply(Math,u(t));function s(t,e){for(var n=Lt(t),i=n[1]-n[0],a=0;a<e;0)n.unshift(-1*(a+=i));return n}return void 0!==a.max&&(e=e>a.max?e:a.max),void 0!==a.min&&(n=n<a.min?n:a.min),t=[],0<=e&&0<=n?(Dt(e)[1],t=i?Lt(e,n):Lt(e)):0<e&&n<0?t=(a=Math.abs(n))<=e?(Dt(e)[1],s(e,a)):(Dt(a)[1],s(a,e).reverse().map(function(t){return-1*t})):e<=0&&n<=0&&(n=Math.abs(n),e=Math.abs(e),Dt(n)[1],t=(t=i?Lt(n,e):Lt(n)).reverse().map(function(t){return-1*t})),t}(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:"false",this.config.yAxisRange),i=this.height/((e=n)[e.length-1]-e[0]),a=Mt(n)*i,s=this.height-(e=Mt(t=n),(t=0<=t.indexOf(0)?t.indexOf(0):0<t[0]?-1*t[0]/e:-1*t[t.length-1]/e+(t.length-1))*a);this.state.yAxis={labels:n,positions:n.map(function(t){return s-t*i}),scaleMultiplier:i,zeroLine:s},this.calcDatasetPoints(),this.calcYExtremes(),this.calcYRegions()}},{key:"calcDatasetPoints",value:function(){function a(t){return t.map(function(t){return Pt(t,e.yAxis)})}var e=this.state;e.datasets=this.data.datasets.map(function(t,e){var n=t.values,i=t.cumulativeYs||[];return{name:t.name&&t.name.replace(/<|>|&/g,function(t){return"&"==t?"&amp;":"<"==t?"&lt;":"&gt;"}),index:e,chartType:t.chartType,values:n,yPositions:a(n),cumulativeYs:i,cumulativeYPos:a(i)}})}},{key:"calcYExtremes",value:function(){var n=this.state;this.barOptions.stacked?n.yExtremes=n.datasets[n.datasets.length-1].cumulativeYPos:(n.yExtremes=new Array(n.datasetLength).fill(9999),n.datasets.map(function(t){t.yPositions.map(function(t,e){t<n.yExtremes[e]&&(n.yExtremes[e]=t)})}))}},{key:"calcYRegions",value:function(){var e=this.state;this.data.yMarkers&&(this.state.yMarkers=this.data.yMarkers.map(function(t){return t.position=Pt(t.value,e.yAxis),t.options||(t.options={}),t})),this.data.yRegions&&(this.state.yRegions=this.data.yRegions.map(function(t){return t.startPos=Pt(t.start,e.yAxis),t.endPos=Pt(t.end,e.yAxis),t.options||(t.options={}),t}))}},{key:"getAllYValues",value:function(){var t,i,a=this,s="values";this.barOptions.stacked&&(s="cumulativeYs",i=new Array(this.state.datasetLength).fill(0),this.data.datasets.map(function(t,e){var n=a.data.datasets[e].values;t[s]=i=i.map(function(t,e){return t+n[e]})}));var e=this.data.datasets.map(function(t){return t[s]});return this.data.yMarkers&&e.push(this.data.yMarkers.map(function(t){return t.value})),this.data.yRegions&&this.data.yRegions.map(function(t){e.push([t.end,t.start])}),(t=[]).concat.apply(t,u(e))}},{key:"setupComponents",value:function(){var n=this,t=[["yAxis",{mode:this.config.yAxisMode,width:this.width,shortenNumbers:this.config.shortenYAxisNumbers},function(){return this.state.yAxis}.bind(this)],["xAxis",{mode:this.config.xAxisMode,height:this.height},function(){var t=this.state;return t.xAxis.calcLabels=function(t,e,n){var i,a=1<arguments.length&&void 0!==e?e:[],s=!(2<arguments.length&&void 0!==n)||n,t=t/a.length*.6,o=(t=t<=0?1:t)/7;return s&&(t=Math.max.apply(Math,u(a.map(function(t){return t.length}))),i=Math.ceil(t/o)),a.map(function(t,e){return(t+="").length>o&&(s?e%i!=0?e!==a.length-1&&(t=""):e>a.length-i/2&&(t=""):t=0<o-3?t.slice(0,o-3)+" ...":t.slice(0,o)+".."),t})}(this.width,t.xAxis.labels,this.config.xIsSeries),t.xAxis}.bind(this)],["yRegions",{width:this.width,pos:"right"},function(){return this.state.yRegions}.bind(this)]],c=this.state.datasets.filter(function(t){return"bar"===t.chartType}),e=this.state.datasets.filter(function(t){return"line"===t.chartType}),i=c.map(function(t){var l=t.index;return["barGraph-"+t.index,{index:l,color:n.colors[l],stacked:n.barOptions.stacked,valuesOverPoints:n.config.valuesOverPoints,minHeight:0*n.height},function(){var t=this.state,n=t.datasets[l],e=this.barOptions.stacked,i=this.barOptions.spaceRatio||.5,a=t.unitWidth*(1-i),s=a/(e?1:c.length),o=t.xAxis.positions.map(function(t){return t-a/2});e||(o=o.map(function(t){return t+s*l}));var r=new Array(t.datasetLength).fill("");this.config.valuesOverPoints&&(r=e&&n.index===t.datasets.length-1?n.cumulativeYs:n.values);i=new Array(t.datasetLength).fill(0);return e&&(i=n.yPositions.map(function(t,e){return t-n.cumulativeYPos[e]})),{xPositions:o,yPositions:n.yPositions,offsets:i,labels:r,zeroLine:t.yAxis.zeroLine,barsWidth:a,barWidth:s}}.bind(n)]}),a=e.map(function(t){var i=t.index;return["lineGraph-"+t.index,{index:i,color:n.colors[i],svgDefs:n.svgDefs,heatline:n.lineOptions.heatline,regionFill:n.lineOptions.regionFill,spline:n.lineOptions.spline,showDots:n.lineOptions.showDots,trailingDot:n.lineOptions.trailingDot,hideDotBorder:n.lineOptions.hideDotBorder,hideLine:n.lineOptions.hideLine,valuesOverPoints:n.config.valuesOverPoints},function(){var t=this.state,e=t.datasets[i],n=t.yAxis.positions[0]<t.yAxis.zeroLine?t.yAxis.positions[0]:t.yAxis.zeroLine;return{xPositions:t.xAxis.positions,yPositions:e.yPositions,values:e.values,zeroLine:n,radius:this.lineOptions.dotSize||4}}.bind(n)]}),e=[["yMarkers",{width:this.width,pos:"right"},function(){return this.state.yMarkers}.bind(this)]],t=t.concat(i,a,e),s=["yMarkers","yRegions"];this.dataUnitComponents=[],this.components=new Map(t.filter(function(t){return!s.includes(t[0])||n.state[t[0]]}).map(function(t){var e=kt.apply(void 0,u(t));return(t[0].includes("lineGraph")||t[0].includes("barGraph"))&&n.dataUnitComponents.push(e),[t[0],e]}))}},{key:"makeDataByIndex",value:function(){var a=this;this.dataByIndex={};var n=this.state,s=this.config.formatTooltipX,o=this.config.formatTooltipY;n.xAxis.labels.map(function(t,i){var e=a.state.datasets.map(function(t,e){var n=t.values[i];return{title:t.name,value:n,yPos:t.yPositions[i],color:a.colors[e],formatted:o?o(n):n}});a.dataByIndex[i]={label:t,formattedLabel:s?s(t):t,xPos:n.xAxis.positions[i],values:e,yExtreme:n.yExtremes[i]}})}},{key:"bindTooltip",value:function(){var a=this;this.container.addEventListener("mousemove",function(t){var e=a.measures,n=f(a.container),i=t.pageX-n.left-m(e),n=t.pageY-n.top;n<a.height+g(e)&&n>g(e)?a.mapTooltipXPosition(i):a.tip.hideTip()})}},{key:"mapTooltipXPosition",value:function(t){var e=this.state;!e.yExtremes||0<=(t=function(n,t,e){var i=2<arguments.length&&void 0!==e&&e,e=t.reduce(function(t,e){return Math.abs(e-n)<Math.abs(t-n)?e:t},[]);return i?t.indexOf(e):e}(t,e.xAxis.positions,!0))&&(e=this.dataByIndex[t],this.tip.setValues(e.xPos+this.tip.offset.x,e.yExtreme+this.tip.offset.y,{name:e.formattedLabel,value:""},e.values,t),this.tip.showTip())}},{key:"renderLegend",value:function(){var t=this.data;1<t.datasets.length&&c(s(a.prototype),"renderLegend",this).call(this,t.datasets)}},{key:"makeLegend",value:function(t,e,n,i){return q(n,i+5,12,3,this.colors[e],t.name,null,8.75,this.config.truncateLegends)}},{key:"makeOverlay",value:function(){var n=this;this.init?this.init=0:(this.overlayGuides&&this.overlayGuides.forEach(function(t){t=t.overlay;t.parentNode.removeChild(t)}),this.overlayGuides=this.dataUnitComponents.map(function(t){return{type:t.unitType,overlay:void 0,units:t.units}}),void 0===this.state.currentIndex&&(this.state.currentIndex=this.state.datasetLength-1),this.overlayGuides.map(function(t){var e=t.units[n.state.currentIndex];t.overlay=K[t.type](e),n.drawArea.appendChild(t.overlay)}))}},{key:"updateOverlayGuides",value:function(){this.overlayGuides&&this.overlayGuides.forEach(function(t){t=t.overlay;t.parentNode.removeChild(t)})}},{key:"bindOverlay",value:function(){var t=this;this.parent.addEventListener("data-select",function(){t.updateOverlay()})}},{key:"bindUnits",value:function(){var n=this;this.dataUnitComponents.map(function(t){t.units.map(function(e){e.addEventListener("click",function(){var t=e.getAttribute("data-point-index");n.setCurrentDataPoint(t)})})}),this.tip.container.addEventListener("click",function(){var t=n.tip.container.getAttribute("data-point-index");n.setCurrentDataPoint(t)})}},{key:"updateOverlay",value:function(){var n=this;this.overlayGuides.map(function(t){var e=t.units[n.state.currentIndex];$[t.type](e,t.overlay)})}},{key:"onLeftArrow",value:function(){this.setCurrentDataPoint(this.state.currentIndex-1)}},{key:"onRightArrow",value:function(){this.setCurrentDataPoint(this.state.currentIndex+1)}},{key:"getDataPoint",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.state.currentIndex,t=this.state;return{index:e,label:t.xAxis.labels[e],values:t.datasets.map(function(t){return t.values[e]})}}},{key:"setCurrentDataPoint",value:function(t){var e=this.state;(t=(t=(t=parseInt(t))<0?0:t)>=e.xAxis.labels.length?e.xAxis.labels.length-1:t)!==e.currentIndex&&(e.currentIndex=t,function(t,e){var n,i=document.createEvent("HTMLEvents");for(n in i.initEvent("data-select",!0,!0),e)i[n]=e[n];t.dispatchEvent(i)}(this.parent,this.getDataPoint()))}},{key:"addDataPoint",value:function(t,n){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.state.datasetLength;c(s(a.prototype),"addDataPoint",this).call(this,t,n,i),this.data.labels.splice(i,0,t),this.data.datasets.map(function(t,e){t.values.splice(i,0,n[e])}),this.update(this.data)}},{key:"removeDataPoint",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.state.datasetLength-1;this.data.labels.length<=1||(c(s(a.prototype),"removeDataPoint",this).call(this,e),this.data.labels.splice(e,1),this.data.datasets.map(function(t){t.values.splice(e,1)}),this.update(this.data))}},{key:"updateDataset",value:function(t){this.data.datasets[1<arguments.length&&void 0!==arguments[1]?arguments[1]:0].values=t,this.update(this.data)}},{key:"updateDatasets",value:function(n){this.data.datasets.map(function(t,e){n[e]&&(t.values=n[e])}),this.update(this.data)}}]),a}(),Ct={bar:Tt,line:Tt,percentage:wt,heatmap:x,pie:At,donut:function(){e(i,At);var n=l(i);function i(t,e){return r(this,i),n.call(this,t,e)}return t(i,[{key:"configure",value:function(t){c(s(i.prototype),"configure",this).call(this,t),this.type="donut",this.sliceName="donutSlices",this.arcFunc=Y,this.shapeFunc=V,this.strokeWidth=t.strokeWidth||30}},{key:"getRadius",value:function(){return this.height>this.width?this.center.x-this.strokeWidth/2:this.center.y-this.strokeWidth/2}},{key:"resetHover",value:function(t,e){it(t,"translate3d(0,0,0)"),this.tip.hideTip(),t.style.stroke=e}},{key:"setupComponents",value:function(){var t=this.state,e=[[this.sliceName,{},function(){return{sliceStrings:t.sliceStrings,colors:this.colors,strokeWidth:this.strokeWidth}}.bind(this)]];this.components=new Map(e.map(function(t){var e=kt.apply(void 0,u(t));return[t[0],e]}))}}]),i}()},x=Object.freeze({__proto__:null,Chart:function t(e,n){return r(this,t),function(t,e,n){t=0<arguments.length&&void 0!==t?t:"line",e=1<arguments.length?e:void 0,n=2<arguments.length?n:void 0;return"axis-mixed"===t?(n.type="line",new Tt(e,n)):Ct[t]?new Ct[t](e,n):void console.error("Undefined chart type: "+t)}(n.type,e,n)},PercentageChart:wt,PieChart:At,Heatmap:x,AxisChart:Tt});return Object.assign({},{NAME:"Frappe Charts",VERSION:"2.0.0-rc20"},x)});
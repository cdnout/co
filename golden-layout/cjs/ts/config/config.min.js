"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PopoutLayoutConfig=exports.LayoutConfig=exports.RootItemConfig=exports.RowOrColumnItemConfig=exports.ComponentItemConfig=exports.StackItemConfig=exports.HeaderedItemConfig=exports.ItemConfig=void 0;const external_error_1=require("../errors/external-error"),internal_error_1=require("../errors/internal-error"),types_1=require("../utils/types"),resolved_config_1=require("./resolved-config");var ItemConfig,HeaderedItemConfig,StackItemConfig,ComponentItemConfig,RowOrColumnItemConfig,RootItemConfig,LayoutConfig,PopoutLayoutConfig;!function(e){e.resolve=function(e){switch(e.type){case types_1.ItemType.ground:throw new external_error_1.ConfigurationError("ItemConfig cannot specify type ground",JSON.stringify(e));case types_1.ItemType.row:case types_1.ItemType.column:return RowOrColumnItemConfig.resolve(e);case types_1.ItemType.stack:return StackItemConfig.resolve(e);case types_1.ItemType.component:return ComponentItemConfig.resolve(e);default:throw new internal_error_1.UnreachableCaseError("UCUICR55499",e.type)}},e.resolveContent=function(o){if(void 0===o)return[];{const n=o.length,t=new Array(n);for(let i=0;i<n;i++)t[i]=e.resolve(o[i]);return t}},e.resolveId=function(e){return void 0===e?resolved_config_1.ResolvedItemConfig.defaults.id:Array.isArray(e)?0===e.length?resolved_config_1.ResolvedItemConfig.defaults.id:e[0]:e},e.isGround=function(e){return e.type===types_1.ItemType.ground},e.isRow=function(e){return e.type===types_1.ItemType.row},e.isColumn=function(e){return e.type===types_1.ItemType.column},e.isStack=function(e){return e.type===types_1.ItemType.stack},e.isComponent=function(e){return e.type===types_1.ItemType.component}}(ItemConfig=exports.ItemConfig||(exports.ItemConfig={})),function(e){const o="__glMaximised";let n;!function(e){e.resolve=function(e,o){var n;if(void 0!==e||void 0!==o)return{show:null!==(n=null==e?void 0:e.show)&&void 0!==n?n:void 0===o?void 0:!!o&&resolved_config_1.ResolvedLayoutConfig.Header.defaults.show,popout:null==e?void 0:e.popout,dock:null==e?void 0:e.dock,maximise:null==e?void 0:e.maximise,close:null==e?void 0:e.close,minimise:null==e?void 0:e.minimise,tabDropdown:null==e?void 0:e.tabDropdown}}}(n=e.Header||(e.Header={})),e.resolveIdAndMaximised=function(e){let n,t,i=e.id,l=!1;if(void 0===i)n=resolved_config_1.ResolvedItemConfig.defaults.id;else if(Array.isArray(i)){const e=i.findIndex(e=>e===o);e>0&&(l=!0,i=i.splice(e,1)),n=i.length>0?i[0]:resolved_config_1.ResolvedItemConfig.defaults.id}else n=i;return{id:n,maximised:t=void 0!==e.maximised?e.maximised:l}}}(HeaderedItemConfig=exports.HeaderedItemConfig||(exports.HeaderedItemConfig={})),function(e){function o(e){if(void 0===e)return[];{const o=e.length,n=new Array(o);for(let t=0;t<o;t++){const o=e[t],i=ItemConfig.resolve(o);if(!resolved_config_1.ResolvedItemConfig.isComponentItem(i))throw new internal_error_1.AssertError("UCUSICRC91114",JSON.stringify(i));n[t]=i}return n}}e.resolve=function(e){var n,t,i,l,r,s;const{id:d,maximised:u}=HeaderedItemConfig.resolveIdAndMaximised(e);return{type:types_1.ItemType.stack,content:o(e.content),width:null!==(n=e.width)&&void 0!==n?n:resolved_config_1.ResolvedItemConfig.defaults.width,minWidth:null!==(t=e.minWidth)&&void 0!==t?t:resolved_config_1.ResolvedItemConfig.defaults.minWidth,height:null!==(i=e.height)&&void 0!==i?i:resolved_config_1.ResolvedItemConfig.defaults.height,minHeight:null!==(l=e.minHeight)&&void 0!==l?l:resolved_config_1.ResolvedItemConfig.defaults.minHeight,id:d,maximised:u,isClosable:null!==(r=e.isClosable)&&void 0!==r?r:resolved_config_1.ResolvedItemConfig.defaults.isClosable,activeItemIndex:null!==(s=e.activeItemIndex)&&void 0!==s?s:resolved_config_1.ResolvedStackItemConfig.defaultActiveItemIndex,header:HeaderedItemConfig.Header.resolve(e.header,e.hasHeaders)}},e.resolveContent=o}(StackItemConfig=exports.StackItemConfig||(exports.StackItemConfig={})),function(e){e.resolve=function(o){var n,t,i,l,r,s,d;let u=o.componentType;if(void 0===u&&(u=o.componentName),void 0===u)throw new Error("ComponentItemConfig.componentType is undefined");{const{id:a,maximised:f}=HeaderedItemConfig.resolveIdAndMaximised(o);let v;return v=void 0===o.title||""===o.title?e.componentTypeToTitle(u):o.title,{type:o.type,content:[],width:null!==(n=o.width)&&void 0!==n?n:resolved_config_1.ResolvedItemConfig.defaults.width,minWidth:null!==(t=o.minWidth)&&void 0!==t?t:resolved_config_1.ResolvedItemConfig.defaults.minWidth,height:null!==(i=o.height)&&void 0!==i?i:resolved_config_1.ResolvedItemConfig.defaults.height,minHeight:null!==(l=o.minHeight)&&void 0!==l?l:resolved_config_1.ResolvedItemConfig.defaults.minHeight,id:a,maximised:f,isClosable:null!==(r=o.isClosable)&&void 0!==r?r:resolved_config_1.ResolvedItemConfig.defaults.isClosable,reorderEnabled:null!==(s=o.reorderEnabled)&&void 0!==s?s:resolved_config_1.ResolvedComponentItemConfig.defaultReorderEnabled,title:v,header:HeaderedItemConfig.Header.resolve(o.header,o.hasHeaders),componentType:u,componentState:null!==(d=o.componentState)&&void 0!==d?d:{}}}},e.componentTypeToTitle=function(e){switch(typeof e){case"string":return e;case"number":case"boolean":return e.toString();default:return""}}}(ComponentItemConfig=exports.ComponentItemConfig||(exports.ComponentItemConfig={})),function(e){e.isChildItemConfig=function(e){switch(e.type){case types_1.ItemType.row:case types_1.ItemType.column:case types_1.ItemType.stack:case types_1.ItemType.component:return!0;case types_1.ItemType.ground:return!1;default:throw new internal_error_1.UnreachableCaseError("UROCOSPCICIC13687",e.type)}},e.resolve=function(o){var n,t,i,l,r;return{type:o.type,content:e.resolveContent(o.content),width:null!==(n=o.width)&&void 0!==n?n:resolved_config_1.ResolvedItemConfig.defaults.width,minWidth:null!==(t=o.width)&&void 0!==t?t:resolved_config_1.ResolvedItemConfig.defaults.minWidth,height:null!==(i=o.height)&&void 0!==i?i:resolved_config_1.ResolvedItemConfig.defaults.height,minHeight:null!==(l=o.height)&&void 0!==l?l:resolved_config_1.ResolvedItemConfig.defaults.minHeight,id:ItemConfig.resolveId(o.id),isClosable:null!==(r=o.isClosable)&&void 0!==r?r:resolved_config_1.ResolvedItemConfig.defaults.isClosable}},e.resolveContent=function(o){if(void 0===o)return[];{const n=o.length,t=new Array(n);for(let i=0;i<n;i++){const n=o[i];if(!e.isChildItemConfig(n))throw new external_error_1.ConfigurationError("ItemConfig is not Row, Column or Stack",n);{const e=ItemConfig.resolve(n);if(!resolved_config_1.ResolvedRowOrColumnItemConfig.isChildItemConfig(e))throw new internal_error_1.AssertError("UROCOSPIC99512",JSON.stringify(e));t[i]=e}}return t}}}(RowOrColumnItemConfig=exports.RowOrColumnItemConfig||(exports.RowOrColumnItemConfig={})),function(e){e.isRootItemConfig=function(e){switch(e.type){case types_1.ItemType.row:case types_1.ItemType.column:case types_1.ItemType.stack:case types_1.ItemType.component:return!0;case types_1.ItemType.ground:return!1;default:throw new internal_error_1.UnreachableCaseError("URICIR23687",e.type)}},e.resolve=function(e){if(void 0!==e){const o=ItemConfig.resolve(e);if(resolved_config_1.ResolvedRootItemConfig.isRootItemConfig(o))return o;throw new external_error_1.ConfigurationError("ItemConfig is not Row, Column or Stack",JSON.stringify(e))}}}(RootItemConfig=exports.RootItemConfig||(exports.RootItemConfig={})),function(e){let o,n,t;function i(e){return"parentId"in e||"indexInParent"in e||"window"in e}!function(e){e.resolve=function(e){var o,n,t,i,l,r,s,d,u;return{constrainDragToContainer:null!==(o=null==e?void 0:e.constrainDragToContainer)&&void 0!==o?o:resolved_config_1.ResolvedLayoutConfig.Settings.defaults.constrainDragToContainer,reorderEnabled:null!==(n=null==e?void 0:e.reorderEnabled)&&void 0!==n?n:resolved_config_1.ResolvedLayoutConfig.Settings.defaults.reorderEnabled,popoutWholeStack:null!==(t=null==e?void 0:e.popoutWholeStack)&&void 0!==t?t:resolved_config_1.ResolvedLayoutConfig.Settings.defaults.popoutWholeStack,blockedPopoutsThrowError:null!==(i=null==e?void 0:e.blockedPopoutsThrowError)&&void 0!==i?i:resolved_config_1.ResolvedLayoutConfig.Settings.defaults.blockedPopoutsThrowError,closePopoutsOnUnload:null!==(l=null==e?void 0:e.closePopoutsOnUnload)&&void 0!==l?l:resolved_config_1.ResolvedLayoutConfig.Settings.defaults.closePopoutsOnUnload,responsiveMode:null!==(r=null==e?void 0:e.responsiveMode)&&void 0!==r?r:resolved_config_1.ResolvedLayoutConfig.Settings.defaults.responsiveMode,tabOverlapAllowance:null!==(s=null==e?void 0:e.tabOverlapAllowance)&&void 0!==s?s:resolved_config_1.ResolvedLayoutConfig.Settings.defaults.tabOverlapAllowance,reorderOnTabMenuClick:null!==(d=null==e?void 0:e.reorderOnTabMenuClick)&&void 0!==d?d:resolved_config_1.ResolvedLayoutConfig.Settings.defaults.reorderOnTabMenuClick,tabControlOffset:null!==(u=null==e?void 0:e.tabControlOffset)&&void 0!==u?u:resolved_config_1.ResolvedLayoutConfig.Settings.defaults.tabControlOffset}}}(o=e.Settings||(e.Settings={})),function(e){e.resolve=function(e){var o,n,t,i,l,r,s;return{borderWidth:null!==(o=null==e?void 0:e.borderWidth)&&void 0!==o?o:resolved_config_1.ResolvedLayoutConfig.Dimensions.defaults.borderWidth,borderGrabWidth:null!==(n=null==e?void 0:e.borderGrabWidth)&&void 0!==n?n:resolved_config_1.ResolvedLayoutConfig.Dimensions.defaults.borderGrabWidth,minItemHeight:null!==(t=null==e?void 0:e.minItemHeight)&&void 0!==t?t:resolved_config_1.ResolvedLayoutConfig.Dimensions.defaults.minItemHeight,minItemWidth:null!==(i=null==e?void 0:e.minItemWidth)&&void 0!==i?i:resolved_config_1.ResolvedLayoutConfig.Dimensions.defaults.minItemWidth,headerHeight:null!==(l=null==e?void 0:e.headerHeight)&&void 0!==l?l:resolved_config_1.ResolvedLayoutConfig.Dimensions.defaults.headerHeight,dragProxyWidth:null!==(r=null==e?void 0:e.dragProxyWidth)&&void 0!==r?r:resolved_config_1.ResolvedLayoutConfig.Dimensions.defaults.dragProxyWidth,dragProxyHeight:null!==(s=null==e?void 0:e.dragProxyHeight)&&void 0!==s?s:resolved_config_1.ResolvedLayoutConfig.Dimensions.defaults.dragProxyHeight}}}(n=e.Dimensions||(e.Dimensions={})),function(e){e.resolve=function(e,o,n){var t,i,l,r,s,d,u,a,f,v,g,m;let c;return{show:c=void 0!==(null==e?void 0:e.show)?e.show:void 0!==o&&void 0!==o.hasHeaders?!!o.hasHeaders&&resolved_config_1.ResolvedLayoutConfig.Header.defaults.show:resolved_config_1.ResolvedLayoutConfig.Header.defaults.show,popout:null!==(i=null!==(t=null==e?void 0:e.popout)&&void 0!==t?t:null==n?void 0:n.popout)&&void 0!==i?i:!1!==(null==o?void 0:o.showPopoutIcon)&&resolved_config_1.ResolvedLayoutConfig.Header.defaults.popout,dock:null!==(r=null!==(l=null==e?void 0:e.popin)&&void 0!==l?l:null==n?void 0:n.popin)&&void 0!==r?r:resolved_config_1.ResolvedLayoutConfig.Header.defaults.dock,maximise:null!==(d=null!==(s=null==e?void 0:e.maximise)&&void 0!==s?s:null==n?void 0:n.maximise)&&void 0!==d?d:!1!==(null==o?void 0:o.showMaximiseIcon)&&resolved_config_1.ResolvedLayoutConfig.Header.defaults.maximise,close:null!==(a=null!==(u=null==e?void 0:e.close)&&void 0!==u?u:null==n?void 0:n.close)&&void 0!==a?a:!1!==(null==o?void 0:o.showCloseIcon)&&resolved_config_1.ResolvedLayoutConfig.Header.defaults.close,minimise:null!==(v=null!==(f=null==e?void 0:e.minimise)&&void 0!==f?f:null==n?void 0:n.minimise)&&void 0!==v?v:resolved_config_1.ResolvedLayoutConfig.Header.defaults.minimise,tabDropdown:null!==(m=null!==(g=null==e?void 0:e.tabDropdown)&&void 0!==g?g:null==n?void 0:n.tabDropdown)&&void 0!==m?m:resolved_config_1.ResolvedLayoutConfig.Header.defaults.tabDropdown}}}(t=e.Header||(e.Header={})),e.isPopout=i,e.resolve=function(o){if(i(o))return PopoutLayoutConfig.resolve(o);{let n;return n=void 0!==o.root?o.root:void 0!==o.content&&o.content.length>0?o.content[0]:void 0,{resolved:!0,root:RootItemConfig.resolve(n),openPopouts:e.resolveOpenPopouts(o.openPopouts),dimensions:e.Dimensions.resolve(o.dimensions),settings:e.Settings.resolve(o.settings),header:e.Header.resolve(o.header,o.settings,o.labels)}}},e.fromResolved=function(e){const o=resolved_config_1.ResolvedLayoutConfig.createCopy(e);return{root:o.root,openPopouts:o.openPopouts,dimensions:o.dimensions,settings:o.settings,header:o.header}},e.isResolved=function(e){const o=e;return void 0!==o.resolved&&!0===o.resolved},e.resolveOpenPopouts=function(e){if(void 0===e)return[];{const o=e.length,n=new Array(o);for(let t=0;t<o;t++)n[t]=PopoutLayoutConfig.resolve(e[t]);return n}}}(LayoutConfig=exports.LayoutConfig||(exports.LayoutConfig={})),function(e){let o;!function(e){e.resolve=function(e,o){var n,t,i,l,r,s,d,u;let a;const f=resolved_config_1.ResolvedPopoutLayoutConfig.Window.defaults;return a=void 0!==e?{width:null!==(n=e.width)&&void 0!==n?n:f.width,height:null!==(t=e.height)&&void 0!==t?t:f.height,left:null!==(i=e.left)&&void 0!==i?i:f.left,top:null!==(l=e.top)&&void 0!==l?l:f.top}:{width:null!==(r=null==o?void 0:o.width)&&void 0!==r?r:f.width,height:null!==(s=null==o?void 0:o.height)&&void 0!==s?s:f.height,left:null!==(d=null==o?void 0:o.left)&&void 0!==d?d:f.left,top:null!==(u=null==o?void 0:o.top)&&void 0!==u?u:f.top}}}(o=e.Window||(e.Window={})),e.resolve=function(o){var n,t;let i;return i=void 0!==o.root?o.root:void 0!==o.content&&o.content.length>0?o.content[0]:void 0,{root:RootItemConfig.resolve(i),openPopouts:LayoutConfig.resolveOpenPopouts(o.openPopouts),settings:LayoutConfig.Settings.resolve(o.settings),dimensions:LayoutConfig.Dimensions.resolve(o.dimensions),header:LayoutConfig.Header.resolve(o.header,o.settings,o.labels),parentId:null!==(n=o.parentId)&&void 0!==n?n:null,indexInParent:null!==(t=o.indexInParent)&&void 0!==t?t:null,window:e.Window.resolve(o.window,o.dimensions),resolved:!0}}}(PopoutLayoutConfig=exports.PopoutLayoutConfig||(exports.PopoutLayoutConfig={}));
import{ComponentItemConfig,ItemConfig}from"../config/config";import{AssertError,UnexpectedNullError}from"../errors/internal-error";import{EventEmitter}from"../utils/event-emitter";import{deepExtend,setElementHeight,setElementWidth}from"../utils/utils";export class ComponentContainer extends EventEmitter{constructor(t,e,i,n,s,h,o,r,m){super(),this._config=t,this._parent=e,this._layoutManager=i,this._element=n,this._updateItemConfigEvent=s,this._showEvent=h,this._hideEvent=o,this._focusEvent=r,this._blurEvent=m,this._width=null,this._height=null,this._isHidden=!1,this._isShownWithZeroDimensions=!1,this._componentType=t.componentType,this._isClosable=t.isClosable,this._initialState=t.componentState,this._state=this._initialState,this._component=this.layoutManager.getComponent(this,t)}get width(){return this._width}get height(){return this._height}get parent(){return this._parent}get componentName(){return this._componentType}get componentType(){return this._componentType}get component(){return this._component}get tab(){return this._tab}get title(){return this._parent.title}get layoutManager(){return this._layoutManager}get isHidden(){return this._isHidden}get state(){return this._state}get initialState(){return this._initialState}get element(){return this._element}destroy(){this.releaseComponent(),this.stateRequestEvent=void 0,this.emit("destroy")}getElement(){return this._element}hide(){this._hideEvent()}checkEmitHide(){this._isHidden||(this.emit("hide"),this._isHidden=!0,this._isShownWithZeroDimensions=!1)}show(){this._showEvent()}focus(t=!1){this._focusEvent(t)}blur(t=!1){this._blurEvent(t)}checkEmitShow(){this._isHidden?(this._isHidden=!1,0===this._height&&0===this._width?this._isShownWithZeroDimensions=!0:(this._isShownWithZeroDimensions=!1,this.emit("shown"))):!this._isShownWithZeroDimensions||0===this._height&&0===this._width||(this._isShownWithZeroDimensions=!1,this.emit("shown"))}setSize(t,e){let i=this._parent;if(i.isColumn||i.isRow||null===i.parent)throw new AssertError("ICSSPRC","ComponentContainer cannot have RowColumn Parent");{let n;do{n=i,i=i.parent}while(null!==i&&!i.isColumn&&!i.isRow);if(null===i)return!1;{const s=i.isColumn?"height":"width",h=this[s];if(null===h)throw new UnexpectedNullError("ICSSCS11194");{const o=("height"===s?e:t)/(h*(1/(n[s]/100)))*100,r=(n[s]-o)/(i.contentItems.length-1);for(let t=0;t<i.contentItems.length;t++)i.contentItems[t]===n?i.contentItems[t][s]=o:i.contentItems[t][s]+=r;return i.updateSize(),!0}}}}close(){this._isClosable&&(this.emit("close"),this._parent.close())}replaceComponent(t){if(this.releaseComponent(),!ItemConfig.isComponent(t))throw new Error("ReplaceComponent not passed a component ItemConfig");{const e=ComponentItemConfig.resolve(t);this._initialState=e.componentState,this._state=this._initialState,this._componentType=e.componentType,this._updateItemConfigEvent(e),this._component=this.layoutManager.getComponent(this,e),this.emit("stateChanged")}}getState(){return this._state}extendState(t){const e=deepExtend(this._state,t);this.setState(e)}setState(t){this._state=t,this._parent.emitBaseBubblingEvent("stateChanged")}setTitle(t){this._parent.setTitle(t)}setTab(t){this._tab=t,this.emit("tab",t)}setDragSize(t,e){setElementWidth(this._element,t),setElementHeight(this._element,e)}setSizeToNodeSize(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,setElementWidth(this._element,t),setElementHeight(this._element,e),this.emit("resize"),!this._isShownWithZeroDimensions||0===this._height&&0===this._width||(this._isShownWithZeroDimensions=!1,this.emit("shown")))}releaseComponent(){this.emit("beforeComponentRelease",this._component),this.layoutManager.releaseComponent(this,this._component)}};
import{ComponentItemConfig}from"../config/config";import{UnexpectedNullError}from"../errors/internal-error";import{ComponentItem}from"../items/component-item";import{GroundItem}from"../items/ground-item";import{DragListener}from"../utils/drag-listener";import{DragProxy}from"./drag-proxy";export class DragSource{constructor(t,e,r,n,o,i){this._layoutManager=t,this._element=e,this._extraAllowableChildTargets=r,this._componentTypeOrFtn=n,this._componentState=o,this._title=i,this._dragListener=null,this._dummyGroundContainer=document.createElement("div"),this._dummyGroundContentItem=new GroundItem(this._layoutManager,this._layoutManager.layoutConfig.root,this._dummyGroundContainer),this.createDragListener()}destroy(){this.removeDragListener()}createDragListener(){this.removeDragListener(),this._dragListener=new DragListener(this._element,this._extraAllowableChildTargets),this._dragListener.on("dragStart",(t,e)=>this.onDragStart(t,e)),this._dragListener.on("dragStop",()=>this.onDragStop())}onDragStart(t,e){let r,n,o;if("function"==typeof this._componentTypeOrFtn){const t=this._componentTypeOrFtn();r=t.type,n=t.state,o=t.title}else r=this._componentTypeOrFtn,n=this._componentState,o=this._title;const i={type:"component",componentType:r,componentState:n,title:o},s=ComponentItemConfig.resolve(i),a=new ComponentItem(this._layoutManager,s,this._dummyGroundContentItem);if(this._dummyGroundContentItem.contentItems.push(a),null===this._dragListener)throw new UnexpectedNullError("DSODSD66746");{const r=new DragProxy(t,e,this._dragListener,this._layoutManager,a,this._dummyGroundContentItem),n=this._layoutManager.transitionIndicator;if(null===n)throw new UnexpectedNullError("DSODST66746");n.transitionElements(this._element,r.element)}}onDragStop(){this.createDragListener()}removeDragListener(){null!==this._dragListener&&(this._dragListener.destroy(),this._dragListener=null)}};
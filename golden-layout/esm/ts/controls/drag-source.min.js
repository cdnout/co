import{ItemConfig}from"../config/config";import{ResolvedItemConfig}from"../config/resolved-config";import{UnexpectedNullError}from"../errors/internal-error";import{ComponentItem}from"../items/component-item";import{GroundItem}from"../items/ground-item";import{DragListener}from"../utils/drag-listener";import{DragProxy}from"./drag-proxy";export class DragSource{constructor(t,e,r,n){this._element=t,this._extraAllowableChildTargets=e,this._itemConfigOrFtn=r,this._layoutManager=n,this._dragListener=null,this._dummyGroundContainer=document.createElement("div"),this._dummyGroundContentItem=new GroundItem(this._layoutManager,this._layoutManager.layoutConfig.root,this._dummyGroundContainer),this.createDragListener()}destroy(){this.removeDragListener()}createDragListener(){this.removeDragListener(),this._dragListener=new DragListener(this._element,this._extraAllowableChildTargets),this._dragListener.on("dragStart",(t,e)=>this.onDragStart(t,e)),this._dragListener.on("dragStop",()=>this.onDragStop())}onDragStart(t,e){let r;r="function"==typeof this._itemConfigOrFtn?this._itemConfigOrFtn():this._itemConfigOrFtn;const n=ItemConfig.resolve(r),o=ResolvedItemConfig.createCopy(n),i=new ComponentItem(this._layoutManager,o,this._dummyGroundContentItem);if(null===this._dragListener)throw new UnexpectedNullError("DSODSD66746");{const r=new DragProxy(t,e,this._dragListener,this._layoutManager,i,this._dummyGroundContentItem),n=this._layoutManager.transitionIndicator;if(null===n)throw new UnexpectedNullError("DSODST66746");n.transitionElements(this._element,r.element)}}onDragStop(){this.createDragListener()}removeDragListener(){null!==this._dragListener&&(this._dragListener.destroy(),this._dragListener=null)}};
/**
 * @license
 * v1.3.11
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2020 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https://github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@pnp/common"),require("@pnp/logging"),require("@pnp/odata"),require("..")):"function"==typeof define&&define.amd?define(["exports","@pnp/common","@pnp/logging","@pnp/odata",".."],t):t((e.pnp=e.pnp||{},e.pnp.sp={}),e.pnp.common,e.pnp.logging,e.pnp.odata,e.__)}(this,function(u,d,h,a,n){"use strict";var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function e(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(i<3?o(a):3<i?o(t,n,a):o(t,n))||a);return 3<i&&a&&Object.defineProperty(t,n,a),a}function f(i,a,s,u){return new(s=s||Promise)(function(e,t){function n(e){try{o(u.next(e))}catch(e){t(e)}}function r(e){try{o(u.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,r)}o((u=u.apply(i,a||[])).next())})}function y(n,r){var o,i,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function g(e){if(d.stringIsNullOrEmpty(e))return"";var t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),-1<t?e.substr(0,t):e}function l(e){var t=[],n=["odata.type","odata.editLink","__metadata","odata.metadata"];return d.hOP(e,n[0])&&"SP.Web"===e[n[0]]?d.hOP(e,n[1])?t.push(e[n[1]]):d.hOP(e,n[2])&&t.push(e.__metadata.uri):d.hOP(e,n[3])&&d.hOP(e,n[1])?t.push(g(e[n[3]]),"_api",e[n[1]]):d.hOP(e,n[1])?t.push("_api",e[n[1]]):d.hOP(e,n[2])&&t.push(e.__metadata.uri),t.length<1?(h.Logger.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),""):d.combine.apply(void 0,t)}var t,i=(o(s,t=a.ODataParserBase),s.prototype.parse=function(e){var n=this;return t.prototype.parse.call(this,e).then(function(e){var t=new n.factory(l(e),null);return d.extend(t,e)})},s);function s(e){var n=t.call(this)||this;return n.factory=e,n.hydrate=function(e){var t=new n.factory(l(e),null);return d.extend(t,e)},n}var c,p=(o(m,c=a.ODataParserBase),m.prototype.parse=function(e){var n=this;return c.prototype.parse.call(this,e).then(function(e){return e.map(function(e){var t=new n.factory(l(e),null);return d.extend(t,e)})})},m);function m(e){var n=c.call(this)||this;return n.factory=e,n.hydrate=function(e){return e.map(function(e){var t=new n.factory(l(e),null);return d.extend(t,e)})},n}function b(e){return new i(e)}function v(){}var P=new(Object.defineProperty(v.prototype,"headers",{get:function(){var e=d.RuntimeConfig.get("sp");return void 0!==e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"baseUrl",{get:function(){var e=d.RuntimeConfig.get("sp");return void 0!==e&&void 0!==e.baseUrl?e.baseUrl:void 0!==d.RuntimeConfig.spfxContext&&null!==d.RuntimeConfig.spfxContext?d.RuntimeConfig.spfxContext.pageContext.web.absoluteUrl:null},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"fetchClientFactory",{get:function(){var e=d.RuntimeConfig.get("sp");return void 0!==e&&void 0!==e.fetchClientFactory?e.fetchClientFactory:function(){return new d.FetchClient}},enumerable:!0,configurable:!0}),v),S=function(){},C=new Map,w=(I.prototype.getDigest=function(o){var i=this,e=this._digests.get(o);if(void 0!==e&&new Date<e.expiration)return Promise.resolve(e.value);var t=d.combine(o,"/_api/contextinfo");return this._httpClient.fetchRaw(t,{cache:"no-cache",credentials:"same-origin",headers:d.extend({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"},P.headers,!0),method:"POST"}).then(function(e){return(new a.ODataDefaultParser).parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(e){var t=new S;t.value=e.FormDigestValue;var n=e.FormDigestTimeoutSeconds,r=new Date;return r.setTime(r.getTime()+1e3*n),t.expiration=r,i._digests.set(o,t),t.value})},I.prototype.clear=function(){this._digests.clear()},I);function I(e,t){void 0===t&&(t=C),this._httpClient=e,this._digests=t}var T=(O.prototype.fetch=function(t,e){var n=this;void 0===e&&(e={});var r=d.extend(e,{cache:"no-cache",credentials:"same-origin"},!0),o=new Headers;return d.mergeHeaders(o,P.headers),d.mergeHeaders(o,e.headers),o.has("Accept")||o.append("Accept","application/json"),o.has("Content-Type")||o.append("Content-Type","application/json;odata=verbose;charset=utf-8"),o.has("X-ClientService-ClientTag")||o.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-1.3.11"),o.has("User-Agent")||o.append("User-Agent","NONISV|SharePointPnP|PnPCoreJS/1.3.11"),!(r=d.extend(r,{headers:o})).method||"GET"===r.method.toUpperCase()||o.has("X-RequestDigest")||o.has("Authorization")?this.fetchRaw(t,r):this._digestCache.getDigest(g(t)).then(function(e){return o.append("X-RequestDigest",e),n.fetchRaw(t,r)})},O.prototype.fetchRaw=function(e,r){var o=this;void 0===r&&(r={});var t=new Headers;d.mergeHeaders(t,r.headers),r=d.extend(r,{headers:t});var i=function(n){function t(e){var t;e.headers.has("Retry-After")?t=parseInt(e.headers.get("Retry-After"),10):(t=n.delay,n.delay*=2),n.attempts++,n.retryCount<=n.attempts?n.reject(Error("Retry count exceeded ("+n.retryCount+") for request. Response status: ["+e.status+"] "+e.statusText)):setTimeout(d.getCtxCallback(o,i,n),t)}o._impl.fetch(e,r).then(function(e){429===e.status?t(e):n.resolve(e)}).catch(function(e){503===e.status||504===e.status?t(e):n.reject(e)})};return new Promise(function(e,t){var n={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};i.call(o,n)})},O.prototype.get=function(e,t){void 0===t&&(t={});var n=d.extend(t,{method:"GET"});return this.fetch(e,n)},O.prototype.post=function(e,t){void 0===t&&(t={});var n=d.extend(t,{method:"POST"});return this.fetch(e,n)},O.prototype.patch=function(e,t){void 0===t&&(t={});var n=d.extend(t,{method:"PATCH"});return this.fetch(e,n)},O.prototype.delete=function(e,t){void 0===t&&(t={});var n=d.extend(t,{method:"DELETE"});return this.fetch(e,n)},O);function O(e){void 0===e&&(e=P.fetchClientFactory()),this._impl=e,this._digestCache=new w(this)}var x="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function U(o){return new Promise(function(n){if(d.isUrlAbsolute(o))return n(o);if(null!==P.baseUrl)return n(d.combine(P.baseUrl,o));if(void 0!==x._spPageContextInfo){if(d.hOP(x._spPageContextInfo,"webAbsoluteUrl"))return n(d.combine(x._spPageContextInfo.webAbsoluteUrl,o));if(d.hOP(x._spPageContextInfo,"webServerRelativeUrl"))return n(d.combine(x._spPageContextInfo.webServerRelativeUrl,o))}if(void 0!==x.location){var r=x.location.toString().toLowerCase();["/_layouts/","/siteassets/"].forEach(function(e){var t=r.indexOf(e);if(0<t)return n(d.combine(r.substr(0,t),o))})}return n(o)})}function j(e){return{__metadata:{type:e}}}var F,D=(o(R,F=a.ODataQueryable),R.prototype.as=function(e){var t=new e(this._url,null);return d.extend(t,this,!0)},R.prototype.toUrlAndQuery=function(){var r=new Map(this.query),e=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(e,t,n){return h.Logger.write("Rewriting aliased parameter from match "+e+" to label: "+t+" value: "+n,0),r.set(t,"'"+n+"'"),t});if(0<r.size){var t=-1<e.indexOf("?")?"&":"?";e+=t+Array.from(r).map(function(e){return e[0]+"="+e[1]}).join("&")}return e},R.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0<e.length&&this.query.set("$select",e.join(",")),this},R.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0<e.length&&this.query.set("$expand",e.join(",")),this},R.prototype.getParent=function(e,t,n,r){void 0===t&&(t=this.parentUrl);var o=new e(t,n).configureFrom(this),i="@target";return this.query.has(i)&&o.query.set(i,this.query.get(i)),void 0!==r&&(o=o.inBatch(r)),o},R.prototype.clone=function(e,t,n){void 0===n&&(n=!0);var r=F.prototype._clone.call(this,new e(this,t),{includeBatch:n}),o="@target";return this.query.has(o)&&r.query.set(o,this.query.get(o)),r},R.prototype.toRequestContext=function(t,n,r,o){var i=this;void 0===n&&(n={});var a=this.hasBatch?this._batchDependency:function(){};return U(this.toUrlAndQuery()).then(function(e){return d.mergeOptions(n,i._options),{batch:i.batch,batchDependency:a,cachingOptions:i._cachingOptions,clientFactory:function(){return new T},isBatched:i.hasBatch,isCached:i._forceCaching||i._useCaching&&/^get$/i.test(t),options:n,parser:r,pipeline:o,requestAbsoluteUrl:e,requestId:d.getGUID(),verb:t}})},R);function R(e,t){var n=F.call(this)||this;if(n._forceCaching=!1,"string"==typeof e)if(d.isUrlAbsolute(e)||e.lastIndexOf("/")<0)n._parentUrl=e,n._url=d.combine(e,t);else if(e.lastIndexOf("/")>e.lastIndexOf("(")){var r=e.lastIndexOf("/");n._parentUrl=e.slice(0,r),t=d.combine(e.slice(r),t),n._url=d.combine(n._parentUrl,t)}else{r=e.lastIndexOf("(");n._parentUrl=e.slice(0,r),n._url=d.combine(e,t)}else{n.extend(e,t);var o=e.query.get("@target");void 0!==o&&n.query.set("@target",o)}return n}var L,_=(o(B,L=D),B.prototype.filter=function(e){return this.query.set("$filter",e),this},B.prototype.orderBy=function(e,t){void 0===t&&(t=!0);var n="$orderby",r=this.query.has(n)?this.query.get(n).split(","):[];return r.push(e+" "+(t?"asc":"desc")),this.query.set(n,r.join(",")),this},B.prototype.skip=function(e){return this.query.set("$skip",e.toString()),this},B.prototype.top=function(e){return this.query.set("$top",e.toString()),this},B);function B(){return null!==L&&L.apply(this,arguments)||this}var A,E=(o(k,A=D),k.prototype._update=function(e,n){var r=this;return function(t){return r.postCore({body:d.jsS(d.extend(j(e),t)),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return n(e,t)})}},k.prototype._delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},k.prototype._deleteWithETag=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},k);function k(){return null!==A&&A.apply(this,arguments)||this}function N(r){return function(e){return o(t,n=e),t;function t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.call(this,e[0],1<e.length&&void 0!==e[1]?e[1]:r)||this}var n}}var M,q,W=(o(V,M=_),(q=V).prototype.getById=function(e){return new K(this,"getById("+e+")")},V.prototype.getByEmail=function(e){return new K(this,"getByEmail('"+e+"')")},V.prototype.getByLoginName=function(e){var t=new K(this);return t.concat("('!@v::"+encodeURIComponent(e)+"')"),t},V.prototype.removeById=function(e){return this.clone(q,"removeById("+e+")").postCore()},V.prototype.removeByLoginName=function(e){var t=this.clone(q,"removeByLoginName(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.postCore()},V.prototype.add=function(e){var t=this;return this.clone(q,null).postCore({body:d.jsS(d.extend(j("SP.User"),{LoginName:e}))}).then(function(){return t.getByLoginName(e)})},V=q=e([N("siteusers")],V));function V(){return null!==M&&M.apply(this,arguments)||this}var H,G=(o(Q,H=E),Object.defineProperty(Q.prototype,"groups",{get:function(){return new re(this,"groups")},enumerable:!0,configurable:!0}),Q);function Q(){return null!==H&&H.apply(this,arguments)||this}var z,K=(o(X,z=G),X);function X(){var t=null!==z&&z.apply(this,arguments)||this;return t.update=t._update("SP.User",function(e){return{data:e,user:t}}),t.delete=t._delete,t}var J,$,Z,Y=(o(ee,J=G),ee=e([N("currentuser")],ee));function ee(){return null!==J&&J.apply(this,arguments)||this}(Z=$=$||{})[Z.None=0]="None",Z[Z.User=1]="User",Z[Z.DistributionList=2]="DistributionList",Z[Z.SecurityGroup=4]="SecurityGroup",Z[Z.SharePointGroup=8]="SharePointGroup",Z[Z.All=15]="All";var te,ne,re=(o(oe,te=_),(ne=oe).prototype.getById=function(e){var t=new ae(this);return t.concat("("+e+")"),t},oe.prototype.add=function(e){var t=this,n=d.jsS(d.extend(j("SP.Group"),e));return this.postCore({body:n}).then(function(e){return{data:e,group:t.getById(e.Id)}})},oe.prototype.getByName=function(e){return new ae(this,"getByName('"+e+"')")},oe.prototype.removeById=function(e){return this.clone(ne,"removeById('"+e+"')").postCore()},oe.prototype.removeByLoginName=function(e){return this.clone(ne,"removeByLoginName('"+e+"')").postCore()},oe=ne=e([N("sitegroups")],oe));function oe(){return null!==te&&te.apply(this,arguments)||this}var ie,ae=(o(se,ie=E),Object.defineProperty(se.prototype,"users",{get:function(){return new W(this,"users")},enumerable:!0,configurable:!0}),se.prototype.setUserAsOwner=function(t){return f(this,void 0,void 0,function(){return y(this,function(e){return[2,this.clone(se,"SetUserAsOwner("+t+")").postCore()]})})},se);function se(){var r=null!==ie&&ie.apply(this,arguments)||this;return r.update=r._update("SP.Group",function(e,t){var n=r;return d.hOP(t,"Title")&&(n=r.getParent(se,r.parentUrl,"getByName('"+t.Title+"')")),{data:e,group:n}}),r}var ue,le,ce=(o(pe,ue=_),(le=pe).prototype.getById=function(e){var t=new he(this);return t.concat("("+e+")"),t},pe.prototype.add=function(e,t){return this.clone(le,"addroleassignment(principalid="+e+", roledefid="+t+")").postCore()},pe.prototype.remove=function(e,t){return this.clone(le,"removeroleassignment(principalid="+e+", roledefid="+t+")").postCore()},pe=le=e([N("roleassignments")],pe));function pe(){return null!==ue&&ue.apply(this,arguments)||this}var de,he=(o(fe,de=E),Object.defineProperty(fe.prototype,"groups",{get:function(){return new re(this,"groups")},enumerable:!0,configurable:!0}),Object.defineProperty(fe.prototype,"bindings",{get:function(){return new Ve(this)},enumerable:!0,configurable:!0}),fe);function fe(){var e=null!==de&&de.apply(this,arguments)||this;return e.delete=e._delete,e}var ye,ge=(o(me,ye=_),me.prototype.getById=function(e){return new ve(this,"getById("+e+")")},me.prototype.getByName=function(e){return new ve(this,"getbyname('"+e+"')")},me.prototype.getByType=function(e){return new ve(this,"getbytype("+e+")")},me.prototype.add=function(e,t,n,r){var o=this,i=d.jsS({BasePermissions:{High:r.High.toString(),Low:r.Low.toString()},Description:t,Name:e,Order:n,__metadata:{type:"SP.RoleDefinition"}});return this.postCore({body:i}).then(function(e){return{data:e,definition:o.getById(e.Id)}})},me=e([N("roledefinitions")],me));function me(){return null!==ye&&ye.apply(this,arguments)||this}var be,ve=(o(Pe,be=E),Pe.prototype.update=function(n){var r=this;void 0!==d.hOP(n,"BasePermissions")&&(n.BasePermissions=d.extend({__metadata:{type:"SP.BasePermissions"}},{High:n.BasePermissions.High.toString(),Low:n.BasePermissions.Low.toString()}));var e=d.jsS(d.extend(j("SP.RoleDefinition"),n));return this.postCore({body:e,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){var t=r;return d.hOP(n,"Name")&&(t=r.getParent(ge,r.parentUrl,"").getByName(n.Name)),{data:e,definition:t}})},Pe);function Pe(){var e=null!==be&&be.apply(this,arguments)||this;return e.delete=e._delete,e}var Se,Ce,we,Ie,Te,Oe,xe,Ue,je,Fe,De,Re,Le,_e,Be,Ae,Ee,ke,Ne,Me,qe,We,Ve=(o(He,Se=_),He=e([N("roledefinitionbindings")],He));function He(){return null!==Se&&Se.apply(this,arguments)||this}(Ce=u.ControlMode||(u.ControlMode={}))[Ce.Display=1]="Display",Ce[Ce.Edit=2]="Edit",Ce[Ce.New=3]="New",(we=u.FieldTypes||(u.FieldTypes={}))[we.Invalid=0]="Invalid",we[we.Integer=1]="Integer",we[we.Text=2]="Text",we[we.Note=3]="Note",we[we.DateTime=4]="DateTime",we[we.Counter=5]="Counter",we[we.Choice=6]="Choice",we[we.Lookup=7]="Lookup",we[we.Boolean=8]="Boolean",we[we.Number=9]="Number",we[we.Currency=10]="Currency",we[we.URL=11]="URL",we[we.Computed=12]="Computed",we[we.Threading=13]="Threading",we[we.Guid=14]="Guid",we[we.MultiChoice=15]="MultiChoice",we[we.GridChoice=16]="GridChoice",we[we.Calculated=17]="Calculated",we[we.File=18]="File",we[we.Attachments=19]="Attachments",we[we.User=20]="User",we[we.Recurrence=21]="Recurrence",we[we.CrossProjectLink=22]="CrossProjectLink",we[we.ModStat=23]="ModStat",we[we.Error=24]="Error",we[we.ContentTypeId=25]="ContentTypeId",we[we.PageSeparator=26]="PageSeparator",we[we.ThreadIndex=27]="ThreadIndex",we[we.WorkflowStatus=28]="WorkflowStatus",we[we.AllDayEvent=29]="AllDayEvent",we[we.WorkflowEventType=30]="WorkflowEventType",(Ie=u.DateTimeFieldFormatType||(u.DateTimeFieldFormatType={}))[Ie.DateOnly=0]="DateOnly",Ie[Ie.DateTime=1]="DateTime",(Te=u.DateTimeFieldFriendlyFormatType||(u.DateTimeFieldFriendlyFormatType={}))[Te.Unspecified=0]="Unspecified",Te[Te.Disabled=1]="Disabled",Te[Te.Relative=2]="Relative",(Oe=u.AddFieldOptions||(u.AddFieldOptions={}))[Oe.DefaultValue=0]="DefaultValue",Oe[Oe.AddToDefaultContentType=1]="AddToDefaultContentType",Oe[Oe.AddToNoContentType=2]="AddToNoContentType",Oe[Oe.AddToAllContentTypes=4]="AddToAllContentTypes",Oe[Oe.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",Oe[Oe.AddFieldToDefaultView=16]="AddFieldToDefaultView",Oe[Oe.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName",(xe=u.CalendarType||(u.CalendarType={}))[xe.Gregorian=1]="Gregorian",xe[xe.Japan=3]="Japan",xe[xe.Taiwan=4]="Taiwan",xe[xe.Korea=5]="Korea",xe[xe.Hijri=6]="Hijri",xe[xe.Thai=7]="Thai",xe[xe.Hebrew=8]="Hebrew",xe[xe.GregorianMEFrench=9]="GregorianMEFrench",xe[xe.GregorianArabic=10]="GregorianArabic",xe[xe.GregorianXLITEnglish=11]="GregorianXLITEnglish",xe[xe.GregorianXLITFrench=12]="GregorianXLITFrench",xe[xe.KoreaJapanLunar=14]="KoreaJapanLunar",xe[xe.ChineseLunar=15]="ChineseLunar",xe[xe.SakaEra=16]="SakaEra",xe[xe.UmAlQura=23]="UmAlQura",(Ue=u.UrlFieldFormatType||(u.UrlFieldFormatType={}))[Ue.Hyperlink=0]="Hyperlink",Ue[Ue.Image=1]="Image",(je=u.PermissionKind||(u.PermissionKind={}))[je.EmptyMask=0]="EmptyMask",je[je.ViewListItems=1]="ViewListItems",je[je.AddListItems=2]="AddListItems",je[je.EditListItems=3]="EditListItems",je[je.DeleteListItems=4]="DeleteListItems",je[je.ApproveItems=5]="ApproveItems",je[je.OpenItems=6]="OpenItems",je[je.ViewVersions=7]="ViewVersions",je[je.DeleteVersions=8]="DeleteVersions",je[je.CancelCheckout=9]="CancelCheckout",je[je.ManagePersonalViews=10]="ManagePersonalViews",je[je.ManageLists=12]="ManageLists",je[je.ViewFormPages=13]="ViewFormPages",je[je.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",je[je.Open=17]="Open",je[je.ViewPages=18]="ViewPages",je[je.AddAndCustomizePages=19]="AddAndCustomizePages",je[je.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",je[je.ApplyStyleSheets=21]="ApplyStyleSheets",je[je.ViewUsageData=22]="ViewUsageData",je[je.CreateSSCSite=23]="CreateSSCSite",je[je.ManageSubwebs=24]="ManageSubwebs",je[je.CreateGroups=25]="CreateGroups",je[je.ManagePermissions=26]="ManagePermissions",je[je.BrowseDirectories=27]="BrowseDirectories",je[je.BrowseUserInfo=28]="BrowseUserInfo",je[je.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",je[je.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",je[je.ManageWeb=31]="ManageWeb",je[je.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",je[je.UseClientIntegration=37]="UseClientIntegration",je[je.UseRemoteAPIs=38]="UseRemoteAPIs",je[je.ManageAlerts=39]="ManageAlerts",je[je.CreateAlerts=40]="CreateAlerts",je[je.EditMyUserInfo=41]="EditMyUserInfo",je[je.EnumeratePermissions=63]="EnumeratePermissions",je[je.FullMask=65]="FullMask",(Fe=u.PrincipalType||(u.PrincipalType={}))[Fe.None=0]="None",Fe[Fe.User=1]="User",Fe[Fe.DistributionList=2]="DistributionList",Fe[Fe.SecurityGroup=4]="SecurityGroup",Fe[Fe.SharePointGroup=8]="SharePointGroup",Fe[Fe.All=15]="All",(De=u.PrincipalSource||(u.PrincipalSource={}))[De.None=0]="None",De[De.UserInfoList=1]="UserInfoList",De[De.Windows=2]="Windows",De[De.MembershipProvider=4]="MembershipProvider",De[De.RoleProvider=8]="RoleProvider",De[De.All=15]="All",(Re=u.RoleType||(u.RoleType={}))[Re.None=0]="None",Re[Re.Guest=1]="Guest",Re[Re.Reader=2]="Reader",Re[Re.Contributor=3]="Contributor",Re[Re.WebDesigner=4]="WebDesigner",Re[Re.Administrator=5]="Administrator",(Le=u.PageType||(u.PageType={}))[Le.Invalid=-1]="Invalid",Le[Le.DefaultView=0]="DefaultView",Le[Le.NormalView=1]="NormalView",Le[Le.DialogView=2]="DialogView",Le[Le.View=3]="View",Le[Le.DisplayForm=4]="DisplayForm",Le[Le.DisplayFormDialog=5]="DisplayFormDialog",Le[Le.EditForm=6]="EditForm",Le[Le.EditFormDialog=7]="EditFormDialog",Le[Le.NewForm=8]="NewForm",Le[Le.NewFormDialog=9]="NewFormDialog",Le[Le.SolutionForm=10]="SolutionForm",Le[Le.PAGE_MAXITEMS=11]="PAGE_MAXITEMS",(_e=u.SharingLinkKind||(u.SharingLinkKind={}))[_e.Uninitialized=0]="Uninitialized",_e[_e.Direct=1]="Direct",_e[_e.OrganizationView=2]="OrganizationView",_e[_e.OrganizationEdit=3]="OrganizationEdit",_e[_e.AnonymousView=4]="AnonymousView",_e[_e.AnonymousEdit=5]="AnonymousEdit",_e[_e.Flexible=6]="Flexible",(Be=u.SharingRole||(u.SharingRole={}))[Be.None=0]="None",Be[Be.View=1]="View",Be[Be.Edit=2]="Edit",Be[Be.Owner=3]="Owner",(Ae=u.SharingOperationStatusCode||(u.SharingOperationStatusCode={}))[Ae.CompletedSuccessfully=0]="CompletedSuccessfully",Ae[Ae.AccessRequestsQueued=1]="AccessRequestsQueued",Ae[Ae.NoResolvedUsers=-1]="NoResolvedUsers",Ae[Ae.AccessDenied=-2]="AccessDenied",Ae[Ae.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",Ae[Ae.UnknowError=-4]="UnknowError",Ae[Ae.EmailBodyTooLong=-5]="EmailBodyTooLong",Ae[Ae.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",Ae[Ae.CapabilityDisabled=-7]="CapabilityDisabled",Ae[Ae.ObjectNotSupported=-8]="ObjectNotSupported",Ae[Ae.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported",(Ee=u.SPSharedObjectType||(u.SPSharedObjectType={}))[Ee.Unknown=0]="Unknown",Ee[Ee.File=1]="File",Ee[Ee.Folder=2]="Folder",Ee[Ee.Item=3]="Item",Ee[Ee.List=4]="List",Ee[Ee.Web=5]="Web",Ee[Ee.Max=6]="Max",(ke=u.SharingDomainRestrictionMode||(u.SharingDomainRestrictionMode={}))[ke.None=0]="None",ke[ke.AllowList=1]="AllowList",ke[ke.BlockList=2]="BlockList",(Ne=u.RenderListDataOptions||(u.RenderListDataOptions={}))[Ne.None=0]="None",Ne[Ne.ContextInfo=1]="ContextInfo",Ne[Ne.ListData=2]="ListData",Ne[Ne.ListSchema=4]="ListSchema",Ne[Ne.MenuView=8]="MenuView",Ne[Ne.ListContentType=16]="ListContentType",Ne[Ne.FileSystemItemId=32]="FileSystemItemId",Ne[Ne.ClientFormSchema=64]="ClientFormSchema",Ne[Ne.QuickLaunch=128]="QuickLaunch",Ne[Ne.Spotlight=256]="Spotlight",Ne[Ne.Visualization=512]="Visualization",Ne[Ne.ViewMetadata=1024]="ViewMetadata",Ne[Ne.DisableAutoHyperlink=2048]="DisableAutoHyperlink",Ne[Ne.EnableMediaTAUrls=4096]="EnableMediaTAUrls",Ne[Ne.ParentInfo=8192]="ParentInfo",Ne[Ne.PageContextInfo=16384]="PageContextInfo",Ne[Ne.ClientSideComponentManifest=32768]="ClientSideComponentManifest",(Me=u.FieldUserSelectionMode||(u.FieldUserSelectionMode={}))[Me.PeopleAndGroups=1]="PeopleAndGroups",Me[Me.PeopleOnly=0]="PeopleOnly",(qe=u.ChoiceFieldFormatType||(u.ChoiceFieldFormatType={}))[qe.Dropdown=0]="Dropdown",qe[qe.RadioButtons=1]="RadioButtons",(We=u.UrlZone||(u.UrlZone={}))[We.DefaultZone=0]="DefaultZone",We[We.Intranet=1]="Intranet",We[We.Internet=2]="Internet",We[We.Custom=3]="Custom",We[We.Extranet=4]="Extranet";var Ge,Qe=(o(ze,Ge=E),Object.defineProperty(ze.prototype,"roleAssignments",{get:function(){return new ce(this)},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"firstUniqueAncestorSecurableObject",{get:function(){return new E(this,"FirstUniqueAncestorSecurableObject")},enumerable:!0,configurable:!0}),ze.prototype.getUserEffectivePermissions=function(e){var t=this.clone(D,"getUserEffectivePermissions(@user)");return t.query.set("@user","'"+encodeURIComponent(e)+"'"),t.get().then(function(e){return d.hOP(e,"GetUserEffectivePermissions")?e.GetUserEffectivePermissions:e})},ze.prototype.getCurrentUserEffectivePermissions=function(){return this.clone(D,"EffectiveBasePermissions").get().then(function(e){return d.hOP(e,"EffectiveBasePermissions")?e.EffectiveBasePermissions:e})},ze.prototype.breakRoleInheritance=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),this.clone(ze,"breakroleinheritance(copyroleassignments="+e+", clearsubscopes="+t+")").postCore()},ze.prototype.resetRoleInheritance=function(){return this.clone(ze,"resetroleinheritance").postCore()},ze.prototype.userHasPermissions=function(e,t){var n=this;return this.getUserEffectivePermissions(e).then(function(e){return n.hasPermissions(e,t)})},ze.prototype.currentUserHasPermissions=function(t){var n=this;return this.getCurrentUserEffectivePermissions().then(function(e){return n.hasPermissions(e,t)})},ze.prototype.hasPermissions=function(e,t){if(!t)return!0;if(t===u.PermissionKind.FullMask)return 32767==(32767&e.High)&&65535===e.Low;var n=1;return 0<=--t&&t<32?(n<<=t,0!=(e.Low&n)):32<=t&&t<64&&(n<<=t-32,0!=(e.High&n))},ze);function ze(){return null!==Ge&&Ge.apply(this,arguments)||this}var Ke,Xe=(o(Je,Ke=D),Je.prototype.getShareLink=function(e,t){void 0===t&&(t=null);var n=null!==t?t.toISOString():null;return this.clone(Je,"shareLink").postCore({body:d.jsS({request:{createLink:!0,emailData:null,settings:{expiration:n,linkKind:e}}})})},Je.prototype.shareWith=function(e,t,n,r,o){var i=this;void 0===n&&(n=!1),void 0===r&&(r=!1),Array.isArray(e)||(e=[e]);var a=d.jsS(e.map(function(e){return{Key:e}})),s=t===u.SharingRole.Edit?u.RoleType.Contributor:u.RoleType.Reader;return new _("_api/web","roledefinitions").select("Id").filter("RoleTypeKind eq "+s).get().then(function(e){if(!Array.isArray(e)||e.length<1)throw Error("Could not locate a role defintion with RoleTypeKind "+s);var t={includeAnonymousLinkInEmail:n,peoplePickerInput:a,propagateAcl:r,roleValue:"role:"+e[0].Id,useSimplifiedRoles:!0};return void 0!==o&&(t=d.extend(t,{emailBody:o.body,emailSubject:void 0!==o.subject?o.subject:"",sendEmail:!0})),i.clone(Je,"shareObject").postCore({body:d.jsS(t)})})},Je.prototype.shareObject=function(n,e){var r=this;return void 0===e&&(e=!1),e?this.sendShareObjectRequest(n):(n=d.extend(n,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0),this.getRoleValue(n.role,n.group).then(function(e){Array.isArray(n.loginNames)||(n.loginNames=[n.loginNames]);var t={peoplePickerInput:d.jsS(n.loginNames.map(function(e){return{Key:e}})),roleValue:e,url:n.url};return void 0!==n.emailData&&null!==n.emailData&&(t=d.extend(t,{emailBody:n.emailData.body,emailSubject:void 0!==n.emailData.subject?n.emailData.subject:"Shared with you.",sendEmail:!0})),r.sendShareObjectRequest(t)}))},Je.prototype.unshareObjectWeb=function(e){return this.clone(Je,"unshareObject").postCore({body:d.jsS({url:e})})},Je.prototype.checkPermissions=function(e){return this.clone(Je,"checkPermissions").postCore({body:d.jsS({recipients:e})})},Je.prototype.getSharingInformation=function(e,t){void 0===e&&(e=null);var n=this.clone(Je,"getSharingInformation");return n.expand.apply(n,t).postCore({body:d.jsS({request:e})})},Je.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(Je,"getObjectSharingSettings").postCore({body:d.jsS({useSimplifiedRoles:e})})},Je.prototype.unshareObject=function(){return this.clone(Je,"unshareObject").postCore()},Je.prototype.deleteLinkByKind=function(e){return this.clone(Je,"deleteLinkByKind").postCore({body:d.jsS({linkKind:e})})},Je.prototype.unshareLink=function(e,t){return void 0===t&&(t="00000000-0000-0000-0000-000000000000"),this.clone(Je,"unshareLink").postCore({body:d.jsS({linkKind:e,shareId:t})})},Je.prototype.getRoleValue=function(e,t){if(null==t){var n=e===u.SharingRole.Edit?u.RoleType.Contributor:u.RoleType.Reader;return new _("_api/web","roledefinitions").select("Id").top(1).filter("RoleTypeKind eq "+n).get().then(function(e){if(e.length<1)throw Error("Could not locate associated role definition for supplied role. Edit and View are supported");return"role: "+e[0].Id})}switch(t){case u.RoleType.Contributor:return new E("_api/web","associatedmembergroup").select("Id").get().then(function(e){return"group: "+e.Id});case u.RoleType.Reader:case u.RoleType.Guest:return new E("_api/web","associatedvisitorgroup").select("Id").get().then(function(e){return"group: "+e.Id});default:throw Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}},Je.prototype.getShareObjectWeb=function(e){return Promise.resolve(new E(g(e),"/_api/SP.Web.ShareObject"))},Je.prototype.sendShareObjectRequest=function(t){return this.getShareObjectWeb(this.toUrl()).then(function(e){return e.expand("UsersWithAccessRequests","GroupsSharedWith").as(Je).postCore({body:d.jsS(t)})})},Je);function Je(){return null!==Ke&&Ke.apply(this,arguments)||this}var $e,Ze=(o(Ye,$e=Qe),Ye.prototype.shareWith=function(t,n,r){var o=this;void 0===n&&(n=u.SharingRole.View);var i=this.addBatchDependency();return new E(g(this.toUrl()),"/_api/web/url").get().then(function(e){return i(),o.shareObject(d.combine(e,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),t,n,r)})},Ye.prototype.shareObject=function(e,t,n,r,o,i,a,s){return void 0===i&&(i=!1),void 0===a&&(a=!1),void 0===s&&(s=!0),this.clone(Xe,null).shareObject({emailData:r,group:o,includeAnonymousLinkInEmail:a,loginNames:t,propagateAcl:i,role:n,url:e,useSimplifiedRoles:s})},Ye.prototype.shareObjectRaw=function(e){return this.clone(Xe,null).shareObject(e,!0)},Ye.prototype.unshareObject=function(e){return this.clone(Xe,null).unshareObjectWeb(e)},Ye);function Ye(){return null!==$e&&$e.apply(this,arguments)||this}var et,tt=(o(nt,et=Qe),nt.prototype.getShareLink=function(e,t){return void 0===e&&(e=u.SharingLinkKind.OrganizationView),void 0===t&&(t=null),this.clone(Xe,null).getShareLink(e,t)},nt.prototype.shareWith=function(e,t,n,r){return void 0===t&&(t=u.SharingRole.View),void 0===n&&(n=!1),this.clone(Xe,null).shareWith(e,t,n,!1,r)},nt.prototype.checkSharingPermissions=function(e){return this.clone(Xe,null).checkPermissions(e)},nt.prototype.getSharingInformation=function(e,t){return void 0===e&&(e=null),this.clone(Xe,null).getSharingInformation(e,t)},nt.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(Xe,null).getObjectSharingSettings(e)},nt.prototype.unshare=function(){return this.clone(Xe,null).unshareObject()},nt.prototype.deleteSharingLinkByKind=function(e){return this.clone(Xe,null).deleteLinkByKind(e)},nt.prototype.unshareLink=function(e,t){return this.clone(Xe,null).unshareLink(e,t)},nt);function nt(){return null!==et&&et.apply(this,arguments)||this}var rt,ot=(o(it,rt=E),it.prototype.getShareLink=function(t,n){void 0===t&&(t=u.SharingLinkKind.OrganizationView),void 0===n&&(n=null);var r=this.addBatchDependency();return this.getShareable().then(function(e){return r(),e.getShareLink(t,n)})},it.prototype.checkSharingPermissions=function(t){var n=this.addBatchDependency();return this.getShareable().then(function(e){return n(),e.checkPermissions(t)})},it.prototype.getSharingInformation=function(t,n){void 0===t&&(t=null);var r=this.addBatchDependency();return this.getShareable().then(function(e){return r(),e.getSharingInformation(t,n)})},it.prototype.getObjectSharingSettings=function(t){void 0===t&&(t=!0);var n=this.addBatchDependency();return this.getShareable().then(function(e){return n(),e.getObjectSharingSettings(t)})},it.prototype.unshare=function(){var t=this.addBatchDependency();return this.getShareable().then(function(e){return t(),e.unshareObject()})},it.prototype.deleteSharingLinkByKind=function(t){var n=this.addBatchDependency();return this.getShareable().then(function(e){return n(),e.deleteLinkByKind(t)})},it.prototype.unshareLink=function(t,n){var r=this.addBatchDependency();return this.getShareable().then(function(e){return r(),e.unshareLink(t,n)})},it.prototype.getShareable=function(){var n=this;return this.clone(st,"listItemAllFields",!1).select("odata.id").get().then(function(e){var t=new Xe(l(e));return n.hasBatch&&(t=t.inBatch(n.batch)),t})},it);function it(){return null!==rt&&rt.apply(this,arguments)||this}var at,st=(o(ut,at=ot),ut.prototype.shareWith=function(t,n,r,o){void 0===n&&(n=u.SharingRole.View),void 0===r&&(r=!1);var i=this.addBatchDependency();return this.getShareable().then(function(e){return i(),e.shareWith(t,n,r,!1,o)})},ut);function ut(){return null!==at&&at.apply(this,arguments)||this}var lt,ct=(o(pt,lt=ot),pt.prototype.shareWith=function(t,n,r,o,i){void 0===n&&(n=u.SharingRole.View),void 0===r&&(r=!1),void 0===o&&(o=!1);var a=this.addBatchDependency();return this.getShareable().then(function(e){return a(),e.shareWith(t,n,r,o,i)})},pt);function pt(){return null!==lt&&lt.apply(this,arguments)||this}var dt,ht=(o(ft,dt=D),Object.defineProperty(ft.prototype,"webparts",{get:function(){return new gt(this,"webparts")},enumerable:!0,configurable:!0}),ft.prototype.export=function(e){return this.clone(ft,"ExportWebPart").postCore({body:d.jsS({webPartId:e})})},ft.prototype.import=function(e){return this.clone(ft,"ImportWebPart").postCore({body:d.jsS({webPartXml:e})})},ft);function ft(){return null!==dt&&dt.apply(this,arguments)||this}var yt,gt=(o(mt,yt=_),mt.prototype.getById=function(e){return new vt(this,"getbyid('"+e+"')")},mt.prototype.getByControlId=function(e){return new vt(this,"getByControlId('"+e+"')")},mt);function mt(){return null!==yt&&yt.apply(this,arguments)||this}var bt,vt=(o(Pt,bt=E),Object.defineProperty(Pt.prototype,"webpart",{get:function(){return new Ct(this)},enumerable:!0,configurable:!0}),Pt.prototype.saveChanges=function(){return this.clone(Pt,"SaveWebPartChanges").postCore()},Pt.prototype.moveTo=function(e,t){return this.clone(Pt,"MoveWebPartTo(zoneID='"+e+"', zoneIndex="+t+")").postCore()},Pt.prototype.close=function(){return this.clone(Pt,"CloseWebPart").postCore()},Pt.prototype.open=function(){return this.clone(Pt,"OpenWebPart").postCore()},Pt.prototype.delete=function(){return this.clone(Pt,"DeleteWebPart").postCore()},Pt);function Pt(){return null!==bt&&bt.apply(this,arguments)||this}var St,Ct=(o(wt,St=E),wt=e([N("webpart")],wt));function wt(){return null!==St&&St.apply(this,arguments)||this}var It,Tt,Ot=(o(xt,It=_),(Tt=xt).prototype.getByName=function(e){var t=new jt(this);return t.concat("('"+e+"')"),t},xt.prototype.add=function(t){var n=this;return this.clone(Tt,"add('"+t+"')").postCore().then(function(e){return{data:e,folder:n.getByName(t)}})},xt.prototype.addUsingPath=function(t,e){var n=this;return void 0===e&&(e=!1),this.clone(Tt,"addUsingPath(DecodedUrl='"+t+"',overwrite="+e+")").postCore().then(function(e){return{data:e,folder:new jt(g(n.toUrl()),"_api/web/getFolderByServerRelativePath(decodedUrl='"+t+"')")}})},xt=Tt=e([N("folders")],xt));function xt(){return null!==It&&It.apply(this,arguments)||this}var Ut,jt=(o(Ft,Ut=ct),Object.defineProperty(Ft.prototype,"contentTypeOrder",{get:function(){return new _(this,"contentTypeOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(Ft.prototype,"files",{get:function(){return new Cr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Ft.prototype,"folders",{get:function(){return new Ot(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Ft.prototype,"listItemAllFields",{get:function(){return new E(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(Ft.prototype,"parentFolder",{get:function(){return new Ft(this,"parentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(Ft.prototype,"properties",{get:function(){return new E(this,"properties")},enumerable:!0,configurable:!0}),Object.defineProperty(Ft.prototype,"serverRelativeUrl",{get:function(){return new D(this,"serverRelativeUrl")},enumerable:!0,configurable:!0}),Object.defineProperty(Ft.prototype,"uniqueContentTypeOrder",{get:function(){return new _(this,"uniqueContentTypeOrder")},enumerable:!0,configurable:!0}),Ft.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(Ft,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},Ft.prototype.recycle=function(){return this.clone(Ft,"recycle").postCore()},Ft.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.listItemAllFields;return n.select.apply(n,e).get().then(function(e){return d.extend(new or(l(e)),e)})},Ft.prototype.moveTo=function(o){return this.select("ServerRelativeUrl").get().then(function(e){var t=e.ServerRelativeUrl,n=g(e["odata.id"]),r=n.replace("://","___").split("/")[0].replace("___","://");return new Ft(n,"/_api/SP.MoveCopyUtil.MoveFolder()").postCore({body:d.jsS({destUrl:d.isUrlAbsolute(o)?o:""+r+o,srcUrl:""+r+t})})})},Ft.prototype.copyTo=function(o){return this.select("ServerRelativeUrl").get().then(function(e){var t=e.ServerRelativeUrl,n=g(e["odata.id"]),r=n.replace("://","___").split("/")[0].replace("___","://");return new Ft(n,"/_api/SP.MoveCopyUtil.CopyFolder()").postCore({body:d.jsS({destUrl:d.isUrlAbsolute(o)?o:""+r+o,srcUrl:""+r+t})})})},Ft);function Ft(){var t=null!==Ut&&Ut.apply(this,arguments)||this;return t.update=t._update("SP.Folder",function(e){return{data:e,folder:t}}),t}var Dt,Rt,Lt=(o(_t,Dt=_),(Rt=_t).prototype.addAvailableContentType=function(e){var t=this,n=d.jsS({contentTypeId:e});return this.clone(Rt,"addAvailableContentType").postCore({body:n}).then(function(e){return{contentType:t.getById(e.id),data:e}})},_t.prototype.getById=function(e){var t=new At(this);return t.concat("('"+e+"')"),t},_t.prototype.add=function(e,t,n,r,o){var i=this;void 0===n&&(n=""),void 0===r&&(r="Custom Content Types"),void 0===o&&(o={});var a=d.jsS(Object.assign(j("SP.ContentType"),{Description:n,Group:r,Id:{StringValue:e},Name:t},o));return this.postCore({body:a}).then(function(e){return{contentType:i.getById(e.id),data:e}})},_t=Rt=e([N("contenttypes")],_t));function _t(){return null!==Dt&&Dt.apply(this,arguments)||this}var Bt,At=(o(Et,Bt=E),Object.defineProperty(Et.prototype,"fieldLinks",{get:function(){return new Nt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Et.prototype,"fields",{get:function(){return new _(this,"fields")},enumerable:!0,configurable:!0}),Object.defineProperty(Et.prototype,"parent",{get:function(){return new Et(this,"parent")},enumerable:!0,configurable:!0}),Object.defineProperty(Et.prototype,"workflowAssociations",{get:function(){return new _(this,"workflowAssociations")},enumerable:!0,configurable:!0}),Et);function Et(){var e=null!==Bt&&Bt.apply(this,arguments)||this;return e.delete=e._delete,e}var kt,Nt=(o(Mt,kt=_),Mt.prototype.getById=function(e){var t=new Wt(this);return t.concat("(guid'"+e+"')"),t},Mt=e([N("fieldlinks")],Mt));function Mt(){return null!==kt&&kt.apply(this,arguments)||this}var qt,Wt=(o(Vt,qt=E),Vt);function Vt(){return null!==qt&&qt.apply(this,arguments)||this}var Ht,Gt,Qt=(o(zt,Ht=_),(Gt=zt).prototype.getByName=function(e){var t=new Xt(this);return t.concat("('"+e+"')"),t},zt.prototype.add=function(t,e){var n=this;return this.clone(Gt,"add(FileName='"+t+"')",!1).postCore({body:e}).then(function(e){return{data:e,file:n.getByName(t)}})},zt.prototype.addMultiple=function(e){var n=this;return e.reduce(function(e,t){return e.then(function(){return n.clone(Gt,"add(FileName='"+t.name+"')",!1).postCore({body:t.content})})},Promise.resolve())},zt.prototype.deleteMultiple=function(){for(var n=this,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(function(e,t){return e.then(function(){return n.getByName(t).delete()})},Promise.resolve())},zt.prototype.recycleMultiple=function(){for(var n=this,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(function(e,t){return e.then(function(){return n.getByName(t).recycle()})},Promise.resolve())},zt=Gt=e([N("AttachmentFiles")],zt));function zt(){return null!==Ht&&Ht.apply(this,arguments)||this}var Kt,Xt=(o(Jt,Kt=E),Jt.prototype.getText=function(){return this.getParsed(new a.TextParser)},Jt.prototype.getBlob=function(){return this.getParsed(new a.BlobParser)},Jt.prototype.getBuffer=function(){return this.getParsed(new a.BufferParser)},Jt.prototype.getJSON=function(){return this.getParsed(new a.JSONParser)},Jt.prototype.setContent=function(e){var t=this;return this.clone(Jt,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new Jt(t)})},Jt.prototype.recycle=function(e){return void 0===e&&(e="*"),this.clone(Jt,"recycleObject").postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},Jt.prototype.getParsed=function(e){return this.clone(Jt,"$value",!1).get(e)},Jt);function Jt(){var e=null!==Kt&&Kt.apply(this,arguments)||this;return e.delete=e._deleteWithETag,e}var $t,Zt,Yt=(o(en,$t=_),(Zt=en).prototype.getById=function(e){var t=new nn(this);return t.concat("('"+e+"')"),t},en.prototype.getByTitle=function(e){return new nn(this,"getByTitle('"+e+"')")},en.prototype.add=function(e,t,n){var r=this;void 0===t&&(t=!1),void 0===n&&(n={});var o=d.jsS(Object.assign(j("SP.View"),{PersonalView:t,Title:e},n));return this.clone(Zt,null).postCore({body:o}).then(function(e){return{data:e,view:r.getById(e.Id)}})},en=Zt=e([N("views")],en));function en(){return null!==$t&&$t.apply(this,arguments)||this}var tn,nn=(o(rn,tn=E),Object.defineProperty(rn.prototype,"fields",{get:function(){return new sn(this)},enumerable:!0,configurable:!0}),rn.prototype.renderAsHtml=function(){return this.clone(D,"renderashtml").get()},rn.prototype.setViewXml=function(e){return this.clone(rn,"SetViewXml").postCore({body:d.jsS({viewXml:e})})},rn);function rn(){var t=null!==tn&&tn.apply(this,arguments)||this;return t.update=t._update("SP.View",function(e){return{data:e,view:t}}),t.delete=t._delete,t}var on,an,sn=(o(un,on=_),(an=un).prototype.getSchemaXml=function(){return this.clone(D,"schemaxml").get()},un.prototype.add=function(e){return this.clone(an,"addviewfield('"+e+"')").postCore()},un.prototype.move=function(e,t){return this.clone(an,"moveviewfieldto").postCore({body:d.jsS({field:e,index:t})})},un.prototype.removeAll=function(){return this.clone(an,"removeallviewfields").postCore()},un.prototype.remove=function(e){return this.clone(an,"removeviewfield('"+e+"')").postCore()},un=an=e([N("viewfields")],un));function un(){return null!==on&&on.apply(this,arguments)||this}var ln,cn,pn=(o(dn,ln=_),(cn=dn).prototype.getById=function(e){var t=new fn(this);return t.concat("('"+e+"')"),t},dn.prototype.getByTitle=function(e){return new fn(this,"getByTitle('"+e+"')")},dn.prototype.getByInternalNameOrTitle=function(e){return new fn(this,"getByInternalNameOrTitle('"+e+"')")},dn.prototype.createFieldAsXml=function(e){var t,n=this;t="string"==typeof e?{SchemaXml:e}:e;var r=d.jsS({parameters:d.extend(j("SP.XmlSchemaFieldCreationInformation"),t)});return this.clone(cn,"createfieldasxml").postCore({body:r}).then(function(e){return{data:e,field:n.getById(e.Id)}})},dn.prototype.add=function(e,t,n){var r=this,o=d.jsS(Object.assign(j(t),{Title:e},n));return this.clone(cn,null).postCore({body:o}).then(function(e){return{data:e,field:r.getById(e.Id)}})},dn.prototype.addText=function(e,t,n){void 0===t&&(t=255);var r={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",d.extend(r,n))},dn.prototype.addCalculated=function(e,t,n,r,o){void 0===r&&(r=u.FieldTypes.Text);var i={DateFormat:n,FieldTypeKind:17,Formula:t,OutputType:r};return this.add(e,"SP.FieldCalculated",d.extend(i,o))},dn.prototype.addDateTime=function(e,t,n,r,o){void 0===t&&(t=u.DateTimeFieldFormatType.DateOnly),void 0===n&&(n=u.CalendarType.Gregorian),void 0===r&&(r=u.DateTimeFieldFriendlyFormatType.Unspecified);var i={DateTimeCalendarType:n,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:r};return this.add(e,"SP.FieldDateTime",d.extend(i,o))},dn.prototype.addNumber=function(e,t,n,r){var o={FieldTypeKind:9};return void 0!==t&&(o=d.extend({MinimumValue:t},o)),void 0!==n&&(o=d.extend({MaximumValue:n},o)),this.add(e,"SP.FieldNumber",d.extend(o,r))},dn.prototype.addCurrency=function(e,t,n,r,o){void 0===r&&(r=1033);var i={CurrencyLocaleId:r,FieldTypeKind:10};return void 0!==t&&(i=d.extend({MinimumValue:t},i)),void 0!==n&&(i=d.extend({MaximumValue:n},i)),this.add(e,"SP.FieldCurrency",d.extend(i,o))},dn.prototype.addMultilineText=function(e,t,n,r,o,i,a){void 0===t&&(t=6),void 0===n&&(n=!0),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===i&&(i=!0);var s={AllowHyperlink:i,AppendOnly:o,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:r,RichText:n};return this.add(e,"SP.FieldMultiLineText",d.extend(s,a))},dn.prototype.addUrl=function(e,t,n){void 0===t&&(t=u.UrlFieldFormatType.Hyperlink);var r={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",d.extend(r,n))},dn.prototype.addUser=function(e,t,n){var r={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",d.extend(r,n))},dn.prototype.addLookup=function(e,t,n,r){var o=this,i=d.extend({FieldTypeKind:7,LookupFieldName:n,LookupListId:t,Title:e},r),a=d.jsS({parameters:d.extend(j("SP.FieldCreationInformation"),i)});return this.clone(cn,"addfield").postCore({body:a}).then(function(e){return{data:e,field:o.getById(e.Id)}})},dn.prototype.addChoice=function(e,t,n,r,o){void 0===n&&(n=u.ChoiceFieldFormatType.Dropdown);var i={Choices:{results:t},EditFormat:n,FieldTypeKind:6,FillInChoice:r};return this.add(e,"SP.FieldChoice",d.extend(i,o))},dn.prototype.addMultiChoice=function(e,t,n,r){var o={Choices:{results:t},FieldTypeKind:15,FillInChoice:n};return this.add(e,"SP.FieldMultiChoice",d.extend(o,r))},dn.prototype.addBoolean=function(e,t){return this.add(e,"SP.Field",d.extend({FieldTypeKind:8},t))},dn.prototype.addDependentLookupField=function(e,t,n){var r=this;return this.clone(cn,"adddependentlookupfield(displayName='"+e+"', primarylookupfieldid='"+t+"', showfield='"+n+"')").postCore().then(function(e){return{data:e,field:r.getById(e.Id)}})},dn.prototype.addLocation=function(e,t){return this.add(e,"SP.FieldLocation",d.extend({FieldTypeKind:33},t))},dn=cn=e([N("fields")],dn));function dn(){return null!==ln&&ln.apply(this,arguments)||this}var hn,fn=(o(yn,hn=E),yn.prototype.update=function(e,t){var n=this;void 0===t&&(t="SP.Field");var r=d.jsS(d.extend(j(t),e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,field:n}})},yn.prototype.setShowInDisplayForm=function(e){return this.clone(yn,"setshowindisplayform("+e+")").postCore()},yn.prototype.setShowInEditForm=function(e){return this.clone(yn,"setshowineditform("+e+")").postCore()},yn.prototype.setShowInNewForm=function(e){return this.clone(yn,"setshowinnewform("+e+")").postCore()},yn);function yn(){var e=null!==hn&&hn.apply(this,arguments)||this;return e.delete=e._delete,e}var gn,mn=(o(bn,gn=_),bn.prototype.getById=function(e){var t=new Pn(this);return t.concat("('"+e+"')"),t},bn=e([N("forms")],bn));function bn(){return null!==gn&&gn.apply(this,arguments)||this}var vn,Pn=(o(Sn,vn=E),Sn);function Sn(){return null!==vn&&vn.apply(this,arguments)||this}var Cn,wn=(o(In,Cn=_),In.prototype.getById=function(e){var t=new On(this);return t.concat("('"+e+"')"),t},In.prototype.add=function(e,t,n){var r=this,o={expirationDateTime:t,notificationUrl:e,resource:this.toUrl()};return n&&(o.clientState=n),this.postCore({body:d.jsS(o),headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:r.getById(e.id)}})},In=e([N("subscriptions")],In));function In(){return null!==Cn&&Cn.apply(this,arguments)||this}var Tn,On=(o(xn,Tn=E),xn.prototype.update=function(e,t,n){var r=this,o={};return e&&(o.expirationDateTime=e),t&&(o.notificationUrl=t),n&&(o.clientState=n),this.patchCore({body:d.jsS(o),headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:r}})},xn.prototype.delete=function(){return Tn.prototype.deleteCore.call(this)},xn);function xn(){return null!==Tn&&Tn.apply(this,arguments)||this}var Un,jn,Fn=(o(Dn,Un=_),(jn=Dn).prototype.getById=function(e){var t=new Ln(this);return t.concat("('"+e+"')"),t},Dn.prototype.add=function(e){var t=this,n=d.jsS(d.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:n}).then(function(e){return{action:t.getById(e.Id),data:e}})},Dn.prototype.clear=function(){return this.clone(jn,"clear").postCore()},Dn=jn=e([N("usercustomactions")],Dn));function Dn(){return null!==Un&&Un.apply(this,arguments)||this}var Rn,Ln=(o(_n,Rn=E),_n.prototype.delete=function(){return Rn.prototype.deleteCore.call(this)},_n);function _n(){var t=null!==Rn&&Rn.apply(this,arguments)||this;return t.update=t._update("SP.UserCustomAction",function(e){return{data:e,action:t}}),t}var Bn,An,En=(o(kn,Bn=_),(An=kn).prototype.getById=function(e){var t=new Mn(this);return t.concat("('"+e+"')"),t},kn.prototype.getByTitle=function(e){return new Mn(this,"getByTitle('"+e+"')")},kn.prototype.add=function(e,t,n,r,o){var i=this;void 0===t&&(t=""),void 0===n&&(n=100),void 0===r&&(r=!1),void 0===o&&(o={});var a=d.extend({AllowContentTypes:r,BaseTemplate:n,ContentTypesEnabled:r,Description:t,Title:e,__metadata:{type:"SP.List"}},o);return this.postCore({body:d.jsS(a)}).then(function(e){return{data:e,list:i.getByTitle(a.Title)}})},kn.prototype.ensure=function(i,a,s,u,e){var l=this;if(void 0===a&&(a=""),void 0===s&&(s=100),void 0===u&&(u=!1),void 0===e&&(e={}),this.hasBatch)throw Error("The ensure list method is not supported for use in a batch.");return new Promise(function(t,n){var r=d.extend(e,{Title:i,Description:a,ContentTypesEnabled:u},!0),o=l.getByTitle(r.Title);o.get().then(function(e){o.update(r).then(function(e){t({created:!1,data:e,list:l.getByTitle(r.Title)})}).catch(function(e){return n(e)})}).catch(function(e){l.add(i,a,s,u,r).then(function(e){t({created:!0,data:e.data,list:l.getByTitle(r.Title)})}).catch(function(e){return n(e)})})})},kn.prototype.ensureSiteAssetsLibrary=function(){return this.clone(An,"ensuresiteassetslibrary").postCore().then(function(e){return new Mn(l(e))})},kn.prototype.ensureSitePagesLibrary=function(){return this.clone(An,"ensuresitepageslibrary").postCore().then(function(e){return new Mn(l(e))})},kn=An=e([N("lists")],kn));function kn(){return null!==Bn&&Bn.apply(this,arguments)||this}var Nn,Mn=(o(qn,Nn=Qe),Object.defineProperty(qn.prototype,"contentTypes",{get:function(){return new Lt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(qn.prototype,"items",{get:function(){return new tr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(qn.prototype,"views",{get:function(){return new Yt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(qn.prototype,"fields",{get:function(){return new pn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(qn.prototype,"forms",{get:function(){return new mn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(qn.prototype,"defaultView",{get:function(){return new nn(this,"DefaultView")},enumerable:!0,configurable:!0}),Object.defineProperty(qn.prototype,"userCustomActions",{get:function(){return new Fn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(qn.prototype,"effectiveBasePermissions",{get:function(){return new D(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(qn.prototype,"eventReceivers",{get:function(){return new _(this,"EventReceivers")},enumerable:!0,configurable:!0}),Object.defineProperty(qn.prototype,"relatedFields",{get:function(){return new D(this,"getRelatedFields")},enumerable:!0,configurable:!0}),Object.defineProperty(qn.prototype,"informationRightsManagementSettings",{get:function(){return new D(this,"InformationRightsManagementSettings")},enumerable:!0,configurable:!0}),Object.defineProperty(qn.prototype,"subscriptions",{get:function(){return new wn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(qn.prototype,"rootFolder",{get:function(){return new jt(this,"rootFolder")},enumerable:!0,configurable:!0}),qn.prototype.getView=function(e){return new nn(this,"getView('"+e+"')")},qn.prototype.update=function(n,e){var r=this;void 0===e&&(e="*");var t=d.jsS(d.extend({__metadata:{type:"SP.List"}},n));return this.postCore({body:t,headers:{"IF-Match":e,"X-HTTP-Method":"MERGE"}}).then(function(e){var t=r;return d.hOP(n,"Title")&&(t=r.getParent(qn,r.parentUrl,"getByTitle('"+n.Title+"')")),{data:e,list:t}})},qn.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},qn.prototype.getChanges=function(e){return this.clone(qn,"getchanges").postCore({body:d.jsS({query:d.extend(j("SP.ChangeQuery"),e)})})},qn.prototype.getItemsByCAMLQuery=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.clone(qn,"getitems");return r.expand.apply(r,t).postCore({body:d.jsS({query:d.extend({__metadata:{type:"SP.CamlQuery"}},e)})})},qn.prototype.getListItemChangesSinceToken=function(e){return this.clone(qn,"getlistitemchangessincetoken").postCore({body:d.jsS({query:d.extend({__metadata:{type:"SP.ChangeLogItemQuery"}},e)})},{parse:function(e){return e.text()}})},qn.prototype.recycle=function(){return this.clone(qn,"recycle").postCore().then(function(e){return d.hOP(e,"Recycle")?e.Recycle:e})},qn.prototype.renderListData=function(e){var t=this.clone(qn,"renderlistdata(@viewXml)");return t.query.set("@viewXml","'"+e+"'"),t.postCore().then(function(e){return JSON.parse(d.hOP(e,"RenderListData")?e.RenderListData:e)})},qn.prototype.renderListDataAsStream=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=new Map),d.hOP(e,"RenderOptions")&&d.isArray(e.RenderOptions)&&(e.RenderOptions=e.RenderOptions.reduce(function(e,t){return e+t}));var r={overrideParameters:d.extend(j("SP.RenderListDataOverrideParameters"),t),parameters:d.extend(j("SP.RenderListDataParameters"),e)},o=this.clone(qn,"RenderListDataAsStream",!0);return n&&0<n.size&&n.forEach(function(e,t){return o.query.set(t,e)}),o.postCore({body:d.jsS(r)})},qn.prototype.renderListFormData=function(e,t,n){return this.clone(qn,"renderlistformdata(itemid="+e+", formid='"+t+"', mode='"+n+"')").postCore().then(function(e){return JSON.parse(d.hOP(e,"RenderListFormData")?e.RenderListFormData:e)})},qn.prototype.reserveListItemId=function(){return this.clone(qn,"reservelistitemid").postCore().then(function(e){return d.hOP(e,"ReserveListItemId")?e.ReserveListItemId:e})},qn.prototype.getListItemEntityTypeFullName=function(){return this.clone(qn,null,!1).select("ListItemEntityTypeFullName").get().then(function(e){return e.ListItemEntityTypeFullName})},qn.prototype.addValidateUpdateItemUsingPath=function(e,t,n,r){return void 0===n&&(n=!1),this.clone(qn,"AddValidateUpdateItemUsingPath()").postCore({body:d.jsS({bNewDocumentUpdate:n,checkInComment:r,formValues:e,listItemCreateInfo:{FolderPath:{DecodedUrl:t,__metadata:{type:"SP.ResourcePath"}},__metadata:{type:"SP.ListItemCreationInformationUsingPath"}}})}).then(function(e){return void 0!==e.AddValidateUpdateItemUsingPath?e.AddValidateUpdateItemUsingPath.results:e})},qn.prototype.getSiteScript=function(){return f(this,void 0,void 0,function(){var t;return y(this,function(e){switch(e.label){case 0:return[4,this.clone(qn).rootFolder.select("ServerRelativeUrl").get()];case 1:return[4,U(e.sent().ServerRelativeUrl)];case 2:return t=e.sent(),[2,new n.SiteScripts(this,"").getSiteScriptFromList(t)]}})})},qn);function qn(){return null!==Nn&&Nn.apply(this,arguments)||this}var Wn,Vn,Hn=(o(Gn,Wn=_),(Vn=Gn).prototype.add=function(e){var t=this;"string"==typeof e&&(e={text:e});var n=d.jsS(d.extend(j("Microsoft.SharePoint.Comments.comment"),e));return this.clone(Vn,null).postCore({body:n}).then(function(e){return d.extend(t.getById(e.id),e)})},Gn.prototype.getById=function(e){var t=new zn(this);return t.concat("("+e+")"),t},Gn.prototype.clear=function(){return this.clone(Vn,"DeleteAll").postCore()},Gn=Vn=e([N("comments")],Gn));function Gn(){return null!==Wn&&Wn.apply(this,arguments)||this}var Qn,zn=(o(Kn,Qn=E),Object.defineProperty(Kn.prototype,"replies",{get:function(){return new $n(this)},enumerable:!0,configurable:!0}),Kn.prototype.like=function(){return this.clone(Kn,"Like").postCore()},Kn.prototype.unlike=function(){return this.clone(Kn,"Unlike").postCore()},Kn.prototype.delete=function(){return this.deleteCore()},Kn);function Kn(){return null!==Qn&&Qn.apply(this,arguments)||this}var Xn,Jn,$n=(o(Zn,Xn=_),(Jn=Zn).prototype.add=function(e){"string"==typeof e&&(e={text:e});var t=d.jsS(d.extend(j("Microsoft.SharePoint.Comments.comment"),e));return this.clone(Jn,null).postCore({body:t}).then(function(e){return d.extend(new zn(l(e)),e)})},Zn=Jn=e([N("replies")],Zn));function Zn(){return null!==Xn&&Xn.apply(this,arguments)||this}var Yn,er,tr=(o(nr,Yn=_),(er=nr).prototype.getById=function(e){var t=new or(this);return t.concat("("+e+")"),t},nr.prototype.getItemByStringId=function(e){return new or(this.parentUrl,"getItemByStringId('"+e+"')")},nr.prototype.skip=function(e,t){return void 0===t&&(t=!1),t?this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&PagedPrev=TRUE&p_ID="+e)):this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},nr.prototype.getPaged=function(e){return void 0===e&&(e=new a.ODataDefaultParser),this.get(new yr(this,e))},nr.prototype.getAll=function(e,t){void 0===e&&(e=2e3),void 0===t&&(t="application/json;odata=nometadata"),h.Logger.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",2);var i=new er(this,"").top(e).configure({headers:{Accept:t}});return this.query.forEach(function(e,t){/^\$select|filter|top|expand$/i.test(t)&&i.query.set(t,e)}),new Promise(function(t,n){var r=[],o=function(e){[].push.apply(r,e.results),e.hasNext?e.getNext().then(o).catch(n):t(r)};i.getPaged().then(o).catch(n)})},nr.prototype.add=function(r,e){var o=this;void 0===r&&(r={}),void 0===e&&(e=null);var i=this.addBatchDependency();return this.ensureListItemEntityTypeName(e).then(function(e){var t=d.jsS(d.extend(j(e),r)),n=o.clone(er,"").postCore({body:t}).then(function(e){return{data:e,item:o.getById(e.Id)}});return i(),n})},nr.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(Mn).getListItemEntityTypeFullName()},nr=er=e([N("items")],nr));function nr(){return null!==Yn&&Yn.apply(this,arguments)||this}var rr,or=(o(ir,rr=tt),Object.defineProperty(ir.prototype,"attachmentFiles",{get:function(){return new Qt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(ir.prototype,"contentType",{get:function(){return new At(this,"ContentType")},enumerable:!0,configurable:!0}),Object.defineProperty(ir.prototype,"comments",{get:function(){return new Hn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(ir.prototype,"effectiveBasePermissions",{get:function(){return new D(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(ir.prototype,"effectiveBasePermissionsForUI",{get:function(){return new D(this,"EffectiveBasePermissionsForUI")},enumerable:!0,configurable:!0}),Object.defineProperty(ir.prototype,"fieldValuesAsHTML",{get:function(){return new E(this,"FieldValuesAsHTML")},enumerable:!0,configurable:!0}),Object.defineProperty(ir.prototype,"fieldValuesAsText",{get:function(){return new E(this,"FieldValuesAsText")},enumerable:!0,configurable:!0}),Object.defineProperty(ir.prototype,"fieldValuesForEdit",{get:function(){return new E(this,"FieldValuesForEdit")},enumerable:!0,configurable:!0}),Object.defineProperty(ir.prototype,"folder",{get:function(){return new jt(this,"folder")},enumerable:!0,configurable:!0}),Object.defineProperty(ir.prototype,"file",{get:function(){return new Tr(this,"file")},enumerable:!0,configurable:!0}),Object.defineProperty(ir.prototype,"versions",{get:function(){return new sr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(ir.prototype,"list",{get:function(){return this.getParent(Mn,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/")))},enumerable:!0,configurable:!0}),ir.prototype.update=function(o,i,e){var a=this;return void 0===i&&(i="*"),void 0===e&&(e=null),new Promise(function(n,t){var r=a.addBatchDependency();return a.ensureListItemEntityTypeName(e).then(function(e){var t=d.jsS(d.extend(j(e),o));return r(),a.postCore({body:t,headers:{"IF-Match":i,"X-HTTP-Method":"MERGE"}},new br).then(function(e){n({data:e,item:a})})}).catch(function(e){return t(e)})})},ir.prototype.getLikedBy=function(){return this.clone(ir,"likedBy").postCore()},ir.prototype.like=function(){return this.clone(ir,"like").postCore()},ir.prototype.unlike=function(){return this.clone(ir,"unlike").postCore()},ir.prototype.recycle=function(){return this.clone(ir,"recycle").postCore()},ir.prototype.getWopiFrameUrl=function(e){void 0===e&&(e=0);var t=this.clone(ir,"getWOPIFrameUrl(@action)");return t.query.set("@action",e),t.postCore().then(function(e){return d.hOP(e,"GetWOPIFrameUrl")?e.GetWOPIFrameUrl:e})},ir.prototype.validateUpdateListItem=function(e,t){return void 0===t&&(t=!1),this.clone(ir,"validateupdatelistitem").postCore({body:d.jsS({formValues:e,bNewDocumentUpdate:t})})},ir.prototype.getLikedByInformation=function(){return this.clone(ir,"likedByInformation").expand("likedby").getCore()},ir.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.list.getListItemEntityTypeFullName()},ir);function ir(){var e=null!==rr&&rr.apply(this,arguments)||this;return e.delete=e._deleteWithETag,e}var ar,sr=(o(ur,ar=_),ur.prototype.getById=function(e){var t=new cr(this);return t.concat("("+e+")"),t},ur=e([N("versions")],ur));function ur(){return null!==ar&&ar.apply(this,arguments)||this}var lr,cr=(o(pr,lr=E),pr);function pr(){var e=null!==lr&&lr.apply(this,arguments)||this;return e.delete=e._deleteWithETag,e}var dr=(Object.defineProperty(hr.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&0<this.nextUrl.length},enumerable:!0,configurable:!0}),hr.prototype.getNext=function(){return this.hasNext?new tr(this.nextUrl,null).configureFrom(this.parent).getPaged(this.innerParser):new Promise(function(e){return e(null)})},hr);function hr(e,t,n,r){this.parent=e,this.nextUrl=t,this.results=n,this.innerParser=r}var fr,yr=(o(gr,fr=a.ODataParserBase),gr.prototype.parse=function(e){var t=this;return this.innerParser.parse(e).then(function(r){return f(t,void 0,void 0,function(){var t,n;return y(this,function(e){return t=this.innerParser.rawJson,n=d.hOP(t,"d")&&d.hOP(t.d,"__next")?t.d.__next:t["odata.nextLink"],[2,new dr(this._parent,n,r,this.innerParser)]})})})},gr);function gr(e,t){var n=fr.call(this)||this;return n._parent=e,n.innerParser=t,n}var mr,br=(o(vr,mr=a.ODataParserBase),vr.prototype.parse=function(r){return f(this,void 0,void 0,function(){var n=this;return y(this,function(e){return[2,new Promise(function(e,t){n.handleError(r,t)&&e({"odata.etag":r.headers.get("etag")})})]})})},vr);function vr(){return null!==mr&&mr.apply(this,arguments)||this}var Pr,Sr,Cr=(o(wr,Pr=_),(Sr=wr).prototype.getByName=function(e){var t=new Tr(this);return t.concat("('"+e+"')"),t},wr.prototype.add=function(t,e,n){var r=this;return void 0===n&&(n=!0),new Sr(this,"add(overwrite="+n+",url='"+t+"')").postCore({body:e}).then(function(e){return{data:e,file:r.getByName(t)}})},wr.prototype.addUsingPath=function(t,e,n){var r=this;void 0===n&&(n={Overwrite:!1});var o=["AddUsingPath(decodedurl='"+t+"'"];return n&&(n.Overwrite&&o.push(",Overwrite=true"),n.AutoCheckoutOnInvalidData&&o.push(",AutoCheckoutOnInvalidData=true"),d.stringIsNullOrEmpty(n.XorHash)||o.push(",XorHash="+n.XorHash)),o.push(")"),new Sr(this,o.join("")).postCore({body:e}).then(function(e){return{data:e,file:r.getByName(t)}})},wr.prototype.addChunked=function(e,t,n,r,o){var i=this;return void 0===r&&(r=!0),void 0===o&&(o=10485760),this.clone(Sr,"add(overwrite = "+r+", url = '"+e+"')",!1).postCore().then(function(){return i.getByName(e)}).then(function(e){return e.setContentChunked(t,n,o)})},wr.prototype.addTemplateFile=function(t,e){var n=this;return this.clone(Sr,"addTemplateFile(urloffile = '"+t+"', templatefiletype = "+e+")",!1).postCore().then(function(e){return{data:e,file:n.getByName(t)}})},wr=Sr=e([N("files")],wr));function wr(){return null!==Pr&&Pr.apply(this,arguments)||this}var Ir,Tr=(o(Or,Ir=st),Object.defineProperty(Or.prototype,"listItemAllFields",{get:function(){return new E(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(Or.prototype,"versions",{get:function(){return new jr(this)},enumerable:!0,configurable:!0}),Or.prototype.approve=function(e){return void 0===e&&(e=""),this.clone(Or,"approve(comment = '"+e+"')").postCore()},Or.prototype.cancelUpload=function(e){return this.clone(Or,"cancelUpload(uploadId = guid'"+e+"')",!1).postCore()},Or.prototype.checkin=function(e,t){if(void 0===e&&(e=""),void 0===t&&(t=u.CheckinType.Major),1023<e.length)throw Error("The maximum comment length is 1023 characters.");return this.clone(Or,"checkin(comment = '"+e+"', checkintype = "+t+")").postCore()},Or.prototype.checkout=function(){return this.clone(Or,"checkout").postCore()},Or.prototype.copyTo=function(e,t){return void 0===t&&(t=!0),this.clone(Or,"copyTo(strnewurl = '"+e+"', boverwrite = "+t+")").postCore()},Or.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(Or,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},Or.prototype.deny=function(e){if(void 0===e&&(e=""),1023<e.length)throw Error("The maximum comment length is 1023 characters.");return this.clone(Or,"deny(comment = '"+e+"')").postCore()},Or.prototype.getLimitedWebPartManager=function(e){return void 0===e&&(e=u.WebPartsPersonalizationScope.Shared),new ht(this,"getLimitedWebPartManager(scope = "+e+")")},Or.prototype.moveTo=function(e,t){return void 0===t&&(t=u.MoveOperations.Overwrite),this.clone(Or,"moveTo(newurl = '"+e+"', flags = "+t+")").postCore()},Or.prototype.publish=function(e){if(void 0===e&&(e=""),1023<e.length)throw Error("The maximum comment length is 1023 characters.");return this.clone(Or,"publish(comment = '"+e+"')").postCore()},Or.prototype.recycle=function(){return this.clone(Or,"recycle").postCore()},Or.prototype.undoCheckout=function(){return this.clone(Or,"undoCheckout").postCore()},Or.prototype.unpublish=function(e){if(void 0===e&&(e=""),1023<e.length)throw Error("The maximum comment length is 1023 characters.");return this.clone(Or,"unpublish(comment = '"+e+"')").postCore()},Or.prototype.getText=function(){return this.clone(Or,"$value",!1).get(new a.TextParser,{headers:{binaryStringResponseBody:"true"}})},Or.prototype.getBlob=function(){return this.clone(Or,"$value",!1).get(new a.BlobParser,{headers:{binaryStringResponseBody:"true"}})},Or.prototype.getBuffer=function(){return this.clone(Or,"$value",!1).get(new a.BufferParser,{headers:{binaryStringResponseBody:"true"}})},Or.prototype.getJSON=function(){return this.clone(Or,"$value",!1).get(new a.JSONParser,{headers:{binaryStringResponseBody:"true"}})},Or.prototype.setContent=function(e){var t=this;return this.clone(Or,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new Or(t)})},Or.prototype.getItem=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=this.listItemAllFields;return r.select.apply(r,e).get().then(function(e){return d.extend(new or(l(e)).configureFrom(t),e)})},Or.prototype.setContentChunked=function(n,r,o){var i=this;void 0===o&&(o=10485760),void 0===r&&(r=function(){return null});var a=n.size,s=parseInt((n.size/o).toString(),10)+(n.size%o==0?1:0),u=d.getGUID();r({uploadId:u,blockNumber:1,chunkSize:o,currentPointer:0,fileSize:a,stage:"starting",totalBlocks:s});for(var e=this.startUpload(u,n.slice(0,o)),t=function(t){e=e.then(function(e){return r({uploadId:u,blockNumber:t,chunkSize:o,currentPointer:e,fileSize:a,stage:"continue",totalBlocks:s}),i.continueUpload(u,e,n.slice(e,e+o))})},l=2;l<s;l++)t(l);return e.then(function(e){return r({uploadId:u,blockNumber:s,chunkSize:o,currentPointer:e,fileSize:a,stage:"finishing",totalBlocks:s}),i.finishUpload(u,e,n.slice(e))})},Or.prototype.startUpload=function(e,t){return this.clone(Or,"startUpload(uploadId = guid'"+e+"')",!1).postCore({body:t}).then(function(e){return"object"==typeof e&&(e=e.StartUpload),parseFloat(e)})},Or.prototype.continueUpload=function(e,t,n){return this.clone(Or,"continueUpload(uploadId = guid'"+e+"', fileOffset = "+t+")",!1).postCore({body:n}).then(function(e){return"object"==typeof e&&(e=e.ContinueUpload),parseFloat(e)})},Or.prototype.finishUpload=function(e,t,n){return this.clone(Or,"finishUpload(uploadId = guid'"+e+"', fileOffset = "+t+")",!1).postCore({body:n}).then(function(e){return{data:e,file:new Or(l(e))}})},Or);function Or(){return null!==Ir&&Ir.apply(this,arguments)||this}var xr,Ur,jr=(o(Fr,xr=_),(Ur=Fr).prototype.getById=function(e){var t=new Ar(this);return t.concat("("+e+")"),t},Fr.prototype.deleteAll=function(){return new Ur(this,"deleteAll").postCore()},Fr.prototype.deleteById=function(e){return this.clone(Ur,"deleteById(vid = "+e+")").postCore()},Fr.prototype.recycleByID=function(e){return this.clone(Ur,"recycleByID(vid = "+e+")").postCore()},Fr.prototype.deleteByLabel=function(e){return this.clone(Ur,"deleteByLabel(versionlabel = '"+e+"')").postCore()},Fr.prototype.recycleByLabel=function(e){return this.clone(Ur,"recycleByLabel(versionlabel = '"+e+"')").postCore()},Fr.prototype.restoreByLabel=function(e){return this.clone(Ur,"restoreByLabel(versionlabel = '"+e+"')").postCore()},Fr=Ur=e([N("versions")],Fr));function Fr(){return null!==xr&&xr.apply(this,arguments)||this}var Dr,Rr,Lr,_r,Br,Ar=(o(Er,Dr=E),Er);function Er(){var e=null!==Dr&&Dr.apply(this,arguments)||this;return e.delete=e._deleteWithETag,e}(Rr=u.CheckinType||(u.CheckinType={}))[Rr.Minor=0]="Minor",Rr[Rr.Major=1]="Major",Rr[Rr.Overwrite=2]="Overwrite",(Lr=u.WebPartsPersonalizationScope||(u.WebPartsPersonalizationScope={}))[Lr.User=0]="User",Lr[Lr.Shared=1]="Shared",(_r=u.MoveOperations||(u.MoveOperations={}))[_r.Overwrite=1]="Overwrite",_r[_r.AllowBrokenThickets=8]="AllowBrokenThickets",(Br=u.TemplateFileType||(u.TemplateFileType={}))[Br.StandardPage=0]="StandardPage",Br[Br.WikiPage=1]="WikiPage",Br[Br.FormPage=2]="FormPage",Br[Br.ClientSidePage=3]="ClientSidePage";var kr,Nr=(o(Mr,kr=_),Mr.prototype.getAppById=function(e){return new Wr(this,"getById('"+e+"')")},Mr.prototype.add=function(e,t,n){void 0===n&&(n=!0);var r=0<this.toUrl().indexOf("tenantappcatalog")?"tenantappcatalog":"sitecollectionappcatalog";return new Mr(g(this.toUrl()),"_api/web/"+r+"/add(overwrite="+n+",url='"+e+"')").postCore({body:t}).then(function(e){return{data:e,file:new Tr(l(e))}})},Mr);function Mr(e,t){return void 0===t&&(t="_api/web/tenantappcatalog/AvailableApps"),kr.call(this,g("string"==typeof e?e:e.toUrl()),t)||this}var qr,Wr=(o(Vr,qr=E),Vr.prototype.deploy=function(e){return void 0===e&&(e=!1),this.clone(Vr,"Deploy("+e+")").postCore()},Vr.prototype.retract=function(){return this.clone(Vr,"Retract").postCore()},Vr.prototype.install=function(){return this.clone(Vr,"Install").postCore()},Vr.prototype.uninstall=function(){return this.clone(Vr,"Uninstall").postCore()},Vr.prototype.upgrade=function(){return this.clone(Vr,"Upgrade").postCore()},Vr.prototype.remove=function(){return this.clone(Vr,"Remove").postCore()},Vr);function Vr(){return null!==qr&&qr.apply(this,arguments)||this}var Hr,Gr=(o(Qr,Hr=a.ODataBatch),Qr.ParseResponse=function(d){return new Promise(function(e,t){for(var n,r,o=[],i="--batchresponse_",a=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),s=d.split("\n"),u="batch",l=0;l<s.length;++l){var c=s[l];switch(u){case"batch":if(c.substr(0,i.length)===i)u="batchHeaders";else if(""!==c.trim())throw Error("Invalid response, line "+l);break;case"batchHeaders":""===c.trim()&&(u="status");break;case"status":var p=a.exec(c);if(3!==p.length)throw Error("Invalid status, line "+l);n=parseInt(p[1],10),r=p[2],u="statusHeaders";break;case"statusHeaders":""===c.trim()&&(u="body");break;case"body":o.push(204===n?new Response:new Response(c,{status:n,statusText:r})),u="batch"}}"status"!==u&&t(Error("Unexpected end of input")),e(o)})},Qr.prototype.executeImpl=function(){var c=this;if(h.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1)return h.Logger.write("Resolving empty batch.",1),Promise.resolve();var p=new T;return U(this.baseUrl).then(function(e){for(var n=[],t="",r=0;r<c.requests.length;r++){var o=c.requests[r];"GET"===o.method?(0<t.length&&(n.push("--changeset_"+t+"--\n\n"),t=""),n.push("--batch_"+c.batchId+"\n")):(t.length<1&&(t=d.getGUID(),n.push("--batch_"+c.batchId+"\n"),n.push('Content-Type: multipart/mixed; boundary="changeset_'+t+'"\n\n')),n.push("--changeset_"+t+"\n")),n.push("Content-Type: application/http\n"),n.push("Content-Transfer-Encoding: binary\n\n");var i=new Headers,a=d.isUrlAbsolute(o.url)?o.url:d.combine(e,o.url);if(h.Logger.write("["+c.batchId+"] ("+(new Date).getTime()+") Adding request "+o.method+" "+a+" to batch.",0),"GET"!==o.method){var s=o.method,u=o.options.headers;d.hOP(o,"options")&&d.hOP(o.options,"headers")&&void 0!==u["X-HTTP-Method"]&&(s=u["X-HTTP-Method"],delete u["X-HTTP-Method"]),n.push(s+" "+a+" HTTP/1.1\n"),i.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else n.push(o.method+" "+a+" HTTP/1.1\n");d.mergeHeaders(i,P.headers),o.options&&d.mergeHeaders(i,o.options.headers),i.has("Accept")||i.append("Accept","application/json"),i.has("Content-Type")||i.append("Content-Type","application/json;odata=verbose;charset=utf-8"),i.has("X-ClientService-ClientTag")||i.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-1.3.11"),i.forEach(function(e,t){n.push(t+": "+e+"\n")}),n.push("\n"),o.options.body&&n.push(o.options.body+"\n\n")}0<t.length&&(n.push("--changeset_"+t+"--\n\n"),t=""),n.push("--batch_"+c.batchId+"--\n");var l={body:n.join(""),headers:{"Content-Type":"multipart/mixed; boundary=batch_"+c.batchId},method:"POST"};return h.Logger.write("["+c.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),p.fetch(d.combine(e,"/_api/$batch"),l).then(function(e){return e.text()}).then(Qr.ParseResponse).then(function(e){if(e.length!==c.requests.length)throw Error("Could not properly parse responses to match requests in batch.");return h.Logger.write("["+c.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),e.reduce(function(e,t,n){var r=c.requests[n];return h.Logger.write("["+r.id+"] ("+(new Date).getTime()+") Resolving request in batch "+c.batchId+".",1),e.then(function(e){return r.parser.parse(t).then(r.resolve).catch(r.reject)})},Promise.resolve())})})},Qr);function Qr(e){var t=Hr.call(this)||this;return t.baseUrl=e,t}var zr,Kr,Xr=(o(Jr,zr=_),(Kr=Jr).prototype.add=function(t,e){var n=this;return void 0===e&&(e=!1),this.clone(Kr,"add").postCore({body:d.jsS({featdefScope:0,featureId:t,force:e})}).then(function(e){return{data:e,feature:n.getById(t)}})},Jr.prototype.getById=function(e){var t=new Zr(this);return t.concat("('"+e+"')"),t},Jr.prototype.remove=function(e,t){return void 0===t&&(t=!1),this.clone(Kr,"remove").postCore({body:d.jsS({featureId:e,force:t})})},Jr=Kr=e([N("features")],Jr));function Jr(){return null!==zr&&zr.apply(this,arguments)||this}var $r,Zr=(o(Yr,$r=E),Yr.prototype.deactivate=function(n){var r=this;void 0===n&&(n=!1);var o=this.addBatchDependency();return new Yr(this).select("DefinitionId").get().then(function(e){var t=r.getParent(Xr,r.parentUrl,"",r.batch).remove(e.DefinitionId,n);return o(),t})},Yr);function Yr(){return null!==$r&&$r.apply(this,arguments)||this}var eo,to,no=(o(ro,eo=E),to=ro,Object.defineProperty(ro.prototype,"rootWeb",{get:function(){return new $o(this,"rootweb")},enumerable:!0,configurable:!0}),Object.defineProperty(ro.prototype,"features",{get:function(){return new Xr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(ro.prototype,"userCustomActions",{get:function(){return new Fn(this)},enumerable:!0,configurable:!0}),ro.prototype.getRootWeb=function(){return this.rootWeb.select("Url").get().then(function(e){return new $o(e.Url)})},ro.prototype.getContextInfo=function(){return new to(this.parentUrl,"_api/contextinfo").postCore().then(function(e){if(d.hOP(e,"GetContextWebInformation")){var t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})},ro.prototype.getDocumentLibraries=function(e){var t=new D("","_api/sp.web.getdocumentlibraries(@v)");return t.query.set("@v","'"+e+"'"),t.get().then(function(e){return d.hOP(e,"GetDocumentLibraries")?e.GetDocumentLibraries:e})},ro.prototype.getWebUrlFromPageUrl=function(e){var t=new D("","_api/sp.web.getweburlfrompageurl(@v)");return t.query.set("@v","'"+e+"'"),t.get().then(function(e){return d.hOP(e,"GetWebUrlFromPageUrl")?e.GetWebUrlFromPageUrl:e})},ro.prototype.getChanges=function(e){var t=d.jsS({query:d.extend({__metadata:{type:"SP.ChangeQuery"}},e)});return this.clone(to,"getchanges").postCore({body:t})},ro.prototype.delete=function(){return f(this,void 0,void 0,function(){var t;return y(this,function(e){switch(e.label){case 0:return[4,this.clone(to,"").select("Id").get()];case 1:return t=e.sent(),[4,new to(this.parentUrl,"_api/SPSiteManager/Delete").postCore({body:d.jsS({siteId:t.Id})})];case 2:return e.sent(),[2]}})})},ro.prototype.createBatch=function(){return new Gr(this.parentUrl)},ro.prototype.openWebById=function(e){return this.clone(to,"openWebById('"+e+"')").postCore().then(function(e){return{data:e,web:$o.fromUrl(e["odata.id"]||e.__metadata.uri)}})},ro.prototype.joinHubSite=function(e){return this.clone(to,"joinHubSite('"+e+"')").postCore()},ro.prototype.registerHubSite=function(){return this.clone(to,"registerHubSite").postCore()},ro.prototype.unRegisterHubSite=function(){return this.clone(to,"unRegisterHubSite").postCore()},ro.prototype.createCommunicationSite=function(e,t,n,r,o,i,a,s,u){var l=this;void 0===t&&(t=1033),void 0===n&&(n=!1),void 0===o&&(o=""),void 0===i&&(i=""),void 0===a&&(a="00000000-0000-0000-0000-000000000000"),void 0===s&&(s="00000000-0000-0000-0000-000000000000");var c={Classification:i,Description:o,HubSiteId:s,Lcid:t,Owner:u,ShareByEmailEnabled:n,SiteDesignId:a,Title:e,Url:r,WebTemplate:"SITEPAGEPUBLISHING#0",WebTemplateExtensionId:"00000000-0000-0000-0000-000000000000"},p=d.jsS({request:d.extend({__metadata:{type:"Microsoft.SharePoint.Portal.SPSiteCreationRequest"}},c)});return this.getRootWeb().then(function(r){return f(l,void 0,void 0,function(){var t,n;return y(this,function(e){return t=new T,n=r.parentUrl+"/_api/SPSiteManager/Create",[2,t.post(n,{body:p,headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"}}).then(function(e){return e.json()}).then(function(e){if(d.hOP(e,"error"))throw e;return d.hOP(e,"d")&&d.hOP(e.d,"Create")?e.d.Create:e})]})})})},ro.prototype.createModernTeamSite=function(e,t,n,r,o,i,a,s,u){var l=this;void 0===n&&(n=!0),void 0===r&&(r=1033),void 0===o&&(o=""),void 0===i&&(i=""),void 0===s&&(s="00000000-0000-0000-0000-000000000000");var c={alias:t,displayName:e,isPublic:n,optionalParams:{Classification:i,CreationOptions:{results:["SPSiteLanguage:"+r,"HubSiteId:"+s]},Description:o,Owners:{results:a||[]}}};return u&&c.optionalParams.CreationOptions.results.push("implicit_formula_292aa8a00786498a87a5ca52d9f4214a_"+u),this.getRootWeb().then(function(r){return f(l,void 0,void 0,function(){var t,n;return y(this,function(e){return t=new T,n=r.parentUrl+"/_api/GroupSiteManager/CreateGroupEx",[2,t.post(n,{body:d.jsS(c),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"}}).then(function(e){return e.json()})]})})})},ro=to=e([N("_api/site")],ro));function ro(){return null!==eo&&eo.apply(this,arguments)||this}var oo,io=(o(ao,oo=_),ao.prototype.getById=function(e){var t=new uo(this);return t.concat("("+e+")"),t},ao.prototype.add=function(e,t,n){var r=this;void 0===n&&(n=!0);var o=d.jsS(d.extend(j("SP.NavigationNode"),{IsVisible:n,Title:e,Url:t}));return this.clone(ao,null).postCore({body:o}).then(function(e){return{data:e,node:r.getById(e.Id)}})},ao.prototype.moveAfter=function(e,t){var n=d.jsS({nodeId:e,previousNodeId:t});return this.clone(ao,"MoveAfter").postCore({body:n})},ao);function ao(){return null!==oo&&oo.apply(this,arguments)||this}var so,uo=(o(lo,so=E),Object.defineProperty(lo.prototype,"children",{get:function(){return new io(this,"Children")},enumerable:!0,configurable:!0}),lo.prototype.delete=function(){return so.prototype.deleteCore.call(this)},lo.prototype.update=function(e){var t=this,n=d.jsS(d.extend({__metadata:{type:"SP.NavigationNode"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,node:t}})},lo);function lo(){return null!==so&&so.apply(this,arguments)||this}var co,po=(o(ho,co=D),Object.defineProperty(ho.prototype,"quicklaunch",{get:function(){return new io(this,"quicklaunch")},enumerable:!0,configurable:!0}),Object.defineProperty(ho.prototype,"topNavigationBar",{get:function(){return new io(this,"topnavigationbar")},enumerable:!0,configurable:!0}),ho=e([N("navigation")],ho));function ho(){return null!==co&&co.apply(this,arguments)||this}var fo,yo=(o(go,fo=D),go.prototype.getMenuState=function(e,t,n,r){return void 0===e&&(e=null),void 0===t&&(t=10),void 0===n&&(n=null),void 0===r&&(r=null),new go(this,"_api/navigation/MenuState").postCore({body:d.jsS({customProperties:r,depth:t,mapProviderName:n,menuNodeKey:e})})},go.prototype.getMenuNodeKey=function(e,t){return void 0===t&&(t=null),new go(this,"_api/navigation/MenuNodeKey").postCore({body:d.jsS({currentUrl:e,mapProviderName:t})})},go);function go(e,t){return void 0===t&&(t=null),fo.call(this,e,t)||this}var mo,bo,vo=(o(Po,mo=D),(bo=Po).FromUrl=function(e){if(null===e)return new bo("");var t=e.indexOf("_api/");return new bo(-1<t?e.substr(0,t):e)},Po.prototype.getRelatedItems=function(e,t){var n=this.clone(bo,null);return n.concat(".GetRelatedItems"),n.postCore({body:d.jsS({SourceItemID:t,SourceListName:e})})},Po.prototype.getPageOneRelatedItems=function(e,t){var n=this.clone(bo,null);return n.concat(".GetPageOneRelatedItems"),n.postCore({body:d.jsS({SourceItemID:t,SourceListName:e})})},Po.prototype.addSingleLink=function(e,t,n,r,o,i,a){void 0===a&&(a=!1);var s=this.clone(bo,null);return s.concat(".AddSingleLink"),s.postCore({body:d.jsS({SourceItemID:t,SourceListName:e,SourceWebUrl:n,TargetItemID:o,TargetListName:r,TargetWebUrl:i,TryAddReverseLink:a})})},Po.prototype.addSingleLinkToUrl=function(e,t,n,r){void 0===r&&(r=!1);var o=this.clone(bo,null);return o.concat(".AddSingleLinkToUrl"),o.postCore({body:d.jsS({SourceItemID:t,SourceListName:e,TargetItemUrl:n,TryAddReverseLink:r})})},Po.prototype.addSingleLinkFromUrl=function(e,t,n,r){void 0===r&&(r=!1);var o=this.clone(bo,null);return o.concat(".AddSingleLinkFromUrl"),o.postCore({body:d.jsS({SourceItemUrl:e,TargetItemID:n,TargetListName:t,TryAddReverseLink:r})})},Po.prototype.deleteSingleLink=function(e,t,n,r,o,i,a){void 0===a&&(a=!1);var s=this.clone(bo,null);return s.concat(".DeleteSingleLink"),s.postCore({body:d.jsS({SourceItemID:t,SourceListName:e,SourceWebUrl:n,TargetItemID:o,TargetListName:r,TargetWebUrl:i,TryDeleteReverseLink:a})})},Po=bo=e([N("_api/SP.RelatedItemManager")],Po));function Po(){return null!==mo&&mo.apply(this,arguments)||this}var So,Co=(o(wo,So=E),Object.defineProperty(wo.prototype,"installedLanguages",{get:function(){return new To(this)},enumerable:!0,configurable:!0}),Object.defineProperty(wo.prototype,"globalInstalledLanguages",{get:function(){return new To(this,"globalinstalledlanguages")},enumerable:!0,configurable:!0}),Object.defineProperty(wo.prototype,"timeZone",{get:function(){return new jo(this)},enumerable:!0,configurable:!0}),Object.defineProperty(wo.prototype,"timeZones",{get:function(){return new Lo(this)},enumerable:!0,configurable:!0}),wo=e([N("regionalsettings")],wo));function wo(){return null!==So&&So.apply(this,arguments)||this}var Io,To=(o(Oo,Io=_),Oo=e([N("installedlanguages")],Oo));function Oo(){return null!==Io&&Io.apply(this,arguments)||this}var xo,Uo,jo=(o(Fo,xo=E),(Uo=Fo).prototype.utcToLocalTime=function(e){var t;return t="string"==typeof e?e:e.toISOString(),this.clone(Uo,"utctolocaltime('"+t+"')").postCore().then(function(e){return d.hOP(e,"UTCToLocalTime")?e.UTCToLocalTime:e})},Fo.prototype.localTimeToUTC=function(e){var t;return t="string"==typeof e?e:d.dateAdd(e,"minute",-1*e.getTimezoneOffset()).toISOString(),this.clone(Uo,"localtimetoutc('"+t+"')").postCore().then(function(e){return d.hOP(e,"LocalTimeToUTC")?e.LocalTimeToUTC:e})},Fo=Uo=e([N("timezone")],Fo));function Fo(){return null!==xo&&xo.apply(this,arguments)||this}var Do,Ro,Lo=(o(_o,Do=_),(Ro=_o).prototype.getById=function(e){return this.clone(Ro,"GetById("+e+")").postCore({},b(jo))},_o=Ro=e([N("timezones")],_o));function _o(){return null!==Do&&Do.apply(this,arguments)||this}var Bo,Ao=(o(Eo,Bo=D),Eo.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e.toUrl(),n=t.indexOf("_api/");return n<0?t:t.substr(0,n)},Eo.prototype.execute=function(e){return this.postCore({body:JSON.stringify(e),headers:{"Content-Type":"application/json;charset=utf-8"}})},Eo.prototype.createSiteDesign=function(t){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Eo,"CreateSiteDesign").execute({info:t})];case 1:return[2,e.sent()]}})})},Eo.prototype.applySiteDesign=function(t,n){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Eo,"ApplySiteDesign").execute({siteDesignId:t,webUrl:n})];case 1:return[2,e.sent()]}})})},Eo.prototype.getSiteDesigns=function(){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Eo,"GetSiteDesigns").execute({})];case 1:return[2,e.sent()]}})})},Eo.prototype.getSiteDesignMetadata=function(t){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Eo,"GetSiteDesignMetadata").execute({id:t})];case 1:return[2,e.sent()]}})})},Eo.prototype.updateSiteDesign=function(t){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Eo,"UpdateSiteDesign").execute({updateInfo:t})];case 1:return[2,e.sent()]}})})},Eo.prototype.deleteSiteDesign=function(t){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Eo,"DeleteSiteDesign").execute({id:t})];case 1:return[2,e.sent()]}})})},Eo.prototype.getSiteDesignRights=function(t){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Eo,"GetSiteDesignRights").execute({id:t})];case 1:return[2,e.sent()]}})})},Eo.prototype.grantSiteDesignRights=function(t,n,r){return void 0===r&&(r=1),f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Eo,"GrantSiteDesignRights").execute({grantedRights:r.toString(),id:t,principalNames:n})];case 1:return[2,e.sent()]}})})},Eo.prototype.revokeSiteDesignRights=function(t,n){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Eo,"RevokeSiteDesignRights").execute({id:t,principalNames:n})];case 1:return[2,e.sent()]}})})},Eo.prototype.addSiteDesignTask=function(t,n){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Eo,"AddSiteDesignTask").execute({webUrl:t,siteDesignId:n})];case 1:return[2,e.sent()]}})})},Eo.prototype.addSiteDesignTaskToCurrentWeb=function(t){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Eo,"AddSiteDesignTaskToCurrentWeb").execute({siteDesignId:t})];case 1:return[2,e.sent()]}})})},Eo.prototype.getSiteDesignTask=function(n){return f(this,void 0,void 0,function(){var t;return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Eo,"GetSiteDesignTask").execute({taskId:n})];case 1:return t=e.sent(),[2,d.hOP(t,"ID")?t:null]}})})},Eo.prototype.getSiteDesignRun=function(t,n){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Eo,"GetSiteDesignRun").execute({webUrl:t,siteDesignId:n})];case 1:return[2,e.sent()]}})})},Eo.prototype.getSiteDesignRunStatus=function(t,n){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Eo,"GetSiteDesignRunStatus").execute({webUrl:t,runId:n})];case 1:return[2,e.sent()]}})})},Eo);function Eo(e,t){return Bo.call(this,Eo.getBaseUrl(e),"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility."+t)||this}var ko,No=(o(Mo,ko=D),Mo.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e.toUrl(),n=t.indexOf("_api/");return n<0?t:t.substr(0,n)},Mo.prototype.execute=function(e){return this.postCore({body:JSON.stringify(e)})},Mo.prototype.getSiteScripts=function(){return this.clone(Mo,"GetSiteScripts",!0).execute({})},Mo.prototype.createSiteScript=function(t,n,r){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Mo,"CreateSiteScript(Title=@title,Description=@desc)?@title='"+encodeURIComponent(t)+"'&@desc='"+encodeURIComponent(n)+"'").execute(r)];case 1:return[2,e.sent()]}})})},Mo.prototype.getSiteScriptMetadata=function(t){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Mo,"GetSiteScriptMetadata").execute({id:t})];case 1:return[2,e.sent()]}})})},Mo.prototype.deleteSiteScript=function(t){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Mo,"DeleteSiteScript").execute({id:t})];case 1:return e.sent(),[2]}})})},Mo.prototype.updateSiteScript=function(t,n){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return n&&(t.Content=JSON.stringify(n)),[4,this.clone(Mo,"UpdateSiteScript").execute({updateInfo:t})];case 1:return[2,e.sent()]}})})},Mo.prototype.getSiteScriptFromList=function(t){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Mo,"GetSiteScriptFromList").execute({listUrl:t})];case 1:return[2,e.sent()]}})})},Mo.prototype.getSiteScriptFromWeb=function(t,n){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,this.clone(Mo,"getSiteScriptFromWeb").execute({webUrl:t,info:n})];case 1:return[2,e.sent()]}})})},Mo);function Mo(e,t){return ko.call(this,Mo.getBaseUrl(e),"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility."+t)||this}var qo,Wo,Vo=(o(Ho,qo=_),(Wo=Ho).prototype.add=function(e,t,n,r,o,i){void 0===n&&(n=""),void 0===r&&(r="STS"),void 0===o&&(o=1033),void 0===i&&(i=!0);var a={Description:n,Language:o,Title:e,Url:t,UseSamePermissionsAsParentSite:i,WebTemplate:r},s=d.jsS({parameters:d.extend({__metadata:{type:"SP.WebCreationInformation"}},a)});return this.clone(Wo,"add").postCore({body:s}).then(function(e){return{data:e,web:new $o(l(e).replace(/_api\/web\/?/i,""))}})},Ho=Wo=e([N("webs")],Ho));function Ho(){return null!==qo&&qo.apply(this,arguments)||this}var Go,Qo=(o(zo,Go=_),zo=e([N("webinfos")],zo));function zo(){return null!==Go&&Go.apply(this,arguments)||this}var Ko,Xo,Jo,$o=(o(Zo,Ko=Ze),(Xo=Zo).fromUrl=function(e,t){return new Xo(g(e),t)},Object.defineProperty(Zo.prototype,"webs",{get:function(){return new Vo(this)},enumerable:!0,configurable:!0}),Zo.prototype.getParentWeb=function(){var n=this;return this.select("ParentWeb/Id").expand("ParentWeb").get().then(function(e){var t=e.ParentWeb;return t?new no(n.parentUrl).openWebById(t.Id):null})},Zo.prototype.getSubwebsFilteredForCurrentUser=function(e,t){return void 0===e&&(e=-1),void 0===t&&(t=-1),this.clone(Vo,"getSubwebsFilteredForCurrentUser(nWebTemplateFilter="+e+",nConfigurationFilter="+t+")")},Object.defineProperty(Zo.prototype,"allProperties",{get:function(){return this.clone(E,"allproperties")},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"webinfos",{get:function(){return new Qo(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"contentTypes",{get:function(){return new Lt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"lists",{get:function(){return new En(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"fields",{get:function(){return new pn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"features",{get:function(){return new Xr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"availablefields",{get:function(){return new pn(this,"availablefields")},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"navigation",{get:function(){return new po(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"siteUsers",{get:function(){return new W(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"siteGroups",{get:function(){return new re(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"siteUserInfoList",{get:function(){return new Mn(this,"siteuserinfolist")},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"regionalSettings",{get:function(){return new Co(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"currentUser",{get:function(){return new Y(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"folders",{get:function(){return new Ot(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"userCustomActions",{get:function(){return new Fn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"roleDefinitions",{get:function(){return new ge(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"relatedItems",{get:function(){return vo.FromUrl(this.toUrl())},enumerable:!0,configurable:!0}),Zo.prototype.createBatch=function(){return new Gr(this.parentUrl)},Object.defineProperty(Zo.prototype,"rootFolder",{get:function(){return new jt(this,"rootFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"associatedOwnerGroup",{get:function(){return new ae(this,"associatedownergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"associatedMemberGroup",{get:function(){return new ae(this,"associatedmembergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"associatedVisitorGroup",{get:function(){return new ae(this,"associatedvisitorgroup")},enumerable:!0,configurable:!0}),Object.defineProperty(Zo.prototype,"defaultDocumentLibrary",{get:function(){return new Mn(this,"DefaultDocumentLibrary")},enumerable:!0,configurable:!0}),Zo.prototype.getFolderById=function(e){return new jt(this,"getFolderById('"+e+"')")},Zo.prototype.getFolderByServerRelativeUrl=function(e){return new jt(this,"getFolderByServerRelativeUrl('"+e+"')")},Zo.prototype.getFolderByServerRelativePath=function(e){return new jt(this,"getFolderByServerRelativePath(decodedUrl='"+e+"')")},Zo.prototype.getFileById=function(e){return new Tr(this,"getFileById('"+e+"')")},Zo.prototype.getFileByServerRelativeUrl=function(e){return new Tr(this,"getFileByServerRelativeUrl('"+e+"')")},Zo.prototype.getFileByServerRelativePath=function(e){return new Tr(this,"getFileByServerRelativePath(decodedUrl='"+e+"')")},Zo.prototype.getList=function(e){return new Mn(this,"getList('"+e+"')")},Zo.prototype.update=function(e){var t=this,n=d.jsS(d.extend({__metadata:{type:"SP.Web"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,web:t}})},Zo.prototype.delete=function(){return Ko.prototype.deleteCore.call(this)},Zo.prototype.applyTheme=function(e,t,n,r){var o=d.jsS({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:r});return this.clone(Xo,"applytheme").postCore({body:o})},Zo.prototype.applyWebTemplate=function(e){var t=this.clone(Xo,"applywebtemplate");return t.concat("(@t)"),t.query.set("@t",e),t.postCore()},Zo.prototype.ensureUser=function(e){var t=d.jsS({logonName:e});return this.clone(Xo,"ensureuser").postCore({body:t}).then(function(e){return{data:e,user:new K(l(e))}})},Zo.prototype.availableWebTemplates=function(e,t){return void 0===e&&(e=1033),void 0===t&&(t=!0),new _(this,"getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")")},Zo.prototype.getCatalog=function(e){return this.clone(Xo,"getcatalog("+e+")").select("Id").get().then(function(e){return new Mn(l(e))})},Zo.prototype.getChanges=function(e){var t=d.jsS({query:d.extend({__metadata:{type:"SP.ChangeQuery"}},e)});return this.clone(Xo,"getchanges").postCore({body:t})},Object.defineProperty(Zo.prototype,"customListTemplate",{get:function(){return new _(this,"getcustomlisttemplates")},enumerable:!0,configurable:!0}),Zo.prototype.getUserById=function(e){return new K(this,"getUserById("+e+")")},Zo.prototype.mapToIcon=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=""),this.clone(Xo,"maptoicon(filename='"+e+"', progid='"+n+"', size="+t+")").get()},Zo.prototype.getStorageEntity=function(e){return this.clone(Xo,"getStorageEntity('"+e+"')").get()},Zo.prototype.setStorageEntity=function(e,t,n,r){return void 0===n&&(n=""),void 0===r&&(r=""),this.clone(Xo,"setStorageEntity").postCore({body:d.jsS({comments:r,description:n,key:e,value:t})})},Zo.prototype.removeStorageEntity=function(e){return this.clone(Xo,"removeStorageEntity('"+e+"')").postCore()},Zo.prototype.getAppCatalog=function(e){return new Nr(e||this)},Zo.prototype.getSiteCollectionAppCatalog=function(e){return new Nr(e||this,"_api/web/sitecollectionappcatalog/AvailableApps")},Zo.prototype.getClientSideWebParts=function(){return this.clone(_,"GetClientSideWebParts").get()},Zo.prototype.addClientSidePage=function(e,t){return void 0===t&&(t=e.replace(/\.[^/.]+$/,"")),ni.create(this,e,t)},Zo.prototype.addClientSidePageByPath=function(e,t){return void 0===t&&(t=e.replace(/\.[^/.]+$/,"")),ni.create(this,e,t)},Zo.prototype.createDefaultAssociatedGroups=function(e,t,n){var r=this.clone(Xo,"createDefaultAssociatedGroups(userLogin=@u,userLogin2=@v,groupNameSeed=@s)");return r.query.set("@u","'"+encodeURIComponent(e||"")+"'"),r.query.set("@v","'"+encodeURIComponent(t||"")+"'"),r.query.set("@s","'"+encodeURIComponent(n||"")+"'"),r.postCore()},Zo.prototype.hubSiteData=function(t){return void 0===t&&(t=!1),f(this,void 0,void 0,function(){return y(this,function(e){return[2,this.clone(Xo,"hubSiteData("+t+")").get().then(function(e){return JSON.parse(e)})]})})},Zo.prototype.syncHubSiteTheme=function(){return this.clone(Xo,"syncHubSiteTheme").postCore()},Zo.prototype.getSiteDesignRuns=function(e){return new Ao(this,"").getSiteDesignRun(void 0,e)},Zo.prototype.getSiteScript=function(e){return new No(this,"").getSiteScriptFromWeb(void 0,e)},Zo.prototype.addSiteDesignTask=function(e){return new Ao(this,"").addSiteDesignTaskToCurrentWeb(e)},Zo.prototype.getSiteDesignRunStatus=function(e){return new Ao(this,"").getSiteDesignRunStatus(void 0,e)},Zo=Xo=e([N("_api/web")],Zo));function Zo(){return null!==Ko&&Ko.apply(this,arguments)||this}function Yo(e){return e.length<1?1:Math.max.apply(null,e.map(function(e){return e.order}))+1}function ei(e){for(var t=0;t<e.length;t++)e[t].order=t+1,d.hOP(e[t],"columns")?ei(e[t].columns):d.hOP(e[t],"controls")&&ei(e[t].controls)}(Jo=u.PromotedState||(u.PromotedState={}))[Jo.NotPromoted=0]="NotPromoted",Jo[Jo.PromoteOnPublish=1]="PromoteOnPublish",Jo[Jo.Promoted=2]="Promoted";var ti,ni=(o(ri,ti=D),ri.create=function(r,o,i,a,s){return void 0===a&&(a="Article"),void 0===s&&(s=0),f(this,void 0,void 0,function(){var t,n;return y(this,function(e){switch(e.label){case 0:return o=o.replace(/\.aspx$/i,""),[4,ri.initFrom(r,"_api/sitepages/pages").postCore({body:d.jsS(Object.assign(j("SP.Publishing.SitePage"),{PageLayoutType:a,PromotedState:s}))})];case 1:return t=e.sent(),(n=new ri(r,"",t)).title=o,[4,n.save(!1)];case 2:return e.sent(),n.title=i,[2,n]}})})},ri.fromFile=function(t){return t.getItem().then(function(e){return new ri(g(t.toUrl()),"",{Id:e.Id},!0).configureFrom(t).load()})},ri.getDefaultLayoutPart=function(){return{dataVersion:"1.4",description:"Title Region Description",id:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",instanceId:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",properties:{authors:[],layoutType:"FullWidthImage",showPublishDate:!1,showTopicHeader:!1,textAlignment:"Left",title:"",topicHeader:""},serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},title:"Title area"}},ri.initFrom=function(e,t){return new ri(g(e.toUrl()),t).configureFrom(e)},Object.defineProperty(ri.prototype,"pageLayout",{get:function(){return this.json.PageLayoutType},set:function(e){this.json.PageLayoutType=e},enumerable:!0,configurable:!0}),Object.defineProperty(ri.prototype,"bannerImageUrl",{get:function(){return this.json.BannerImageUrl},set:function(e){this.json.BannerImageUrl=e,this._bannerImageDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(ri.prototype,"bannerImageSourceType",{get:function(){return this._layoutPart.properties.imageSourceType},set:function(e){this._layoutPart.properties.imageSourceType=e},enumerable:!0,configurable:!0}),Object.defineProperty(ri.prototype,"topicHeader",{get:function(){return d.objectDefinedNotNull(this.json.TopicHeader)?this.json.TopicHeader:""},set:function(e){this.json.TopicHeader=e,this._layoutPart.properties.topicHeader=e,d.stringIsNullOrEmpty(e)&&(this.showTopicHeader=!1)},enumerable:!0,configurable:!0}),Object.defineProperty(ri.prototype,"title",{get:function(){return this._layoutPart.properties.title},set:function(e){this.json.Title=e,this._layoutPart.properties.title=e},enumerable:!0,configurable:!0}),Object.defineProperty(ri.prototype,"layoutType",{get:function(){return this._layoutPart.properties.layoutType},set:function(e){this._layoutPart.properties.layoutType=e},enumerable:!0,configurable:!0}),Object.defineProperty(ri.prototype,"headerTextAlignment",{get:function(){return this._layoutPart.properties.textAlignment},set:function(e){this._layoutPart.properties.textAlignment=e},enumerable:!0,configurable:!0}),Object.defineProperty(ri.prototype,"showTopicHeader",{get:function(){return this._layoutPart.properties.showTopicHeader},set:function(e){this._layoutPart.properties.showTopicHeader=e},enumerable:!0,configurable:!0}),Object.defineProperty(ri.prototype,"showPublishDate",{get:function(){return this._layoutPart.properties.showPublishDate},set:function(e){this._layoutPart.properties.showPublishDate=e},enumerable:!0,configurable:!0}),Object.defineProperty(ri.prototype,"hasVerticalSection",{get:function(){return-1<this.sections.findIndex(function(e){return 2===e.layoutIndex})},enumerable:!0,configurable:!0}),Object.defineProperty(ri.prototype,"verticalSection",{get:function(){return this.hasVerticalSection?this.addVerticalSection():null},enumerable:!0,configurable:!0}),ri.prototype.addSection=function(){var e=new oi(this,Yo(this.sections),1);return this.sections.push(e),e},ri.prototype.addVerticalSection=function(){var e=this.sections.findIndex(function(e){return 2===e.layoutIndex});if(-1<e)return this.sections[e];var t=new oi(this,Yo(this.sections),2);return this.sections.push(t),t},ri.prototype.fromJSON=function(e){this.json=e;var t=JSON.parse(e.CanvasContent1),n=JSON.parse(e.LayoutWebpartsContent);return n&&0<n.length&&(this._layoutPart=n[0]),this.setControls(t),this},ri.prototype.load=function(){var n=this;return this.getItem("Id","CommentsDisabled").then(function(t){return new D(n,"_api/sitepages/pages("+t.Id+")").get().then(function(e){return n.commentsDisabled=t.CommentsDisabled,n.fromJSON(e)})})},ri.prototype.save=function(e){var p=this;if(void 0===e&&(e=!0),null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");var t=Promise.resolve({});return this._bannerImageDirty&&(t=t.then(function(e){return new Promise(function(t,e){var n=p.json.BannerImageUrl;d.isUrlAbsolute(n)&&(n=n.replace(/^https?:\/\/[a-z0-9\.]*?\.[a-z]{2,3}\//i,"/"));var r=new no(g(p.toUrl())),o=new $o(g(p.toUrl())),i=o.getFileByServerRelativePath(n),a="",s="",u="",l="",c="";Promise.all([r.select("Id","Url").get().then(function(e){return a=e.Id}),o.select("Id","Url").get().then(function(e){s=e.Id,c=e.Url}),i.listItemAllFields.select("UniqueId","ParentList/Id").expand("ParentList").get().then(function(e){u=e.UniqueId,l=e.ParentList.Id})]).then(function(){var e=new D(c,"_layouts/15/getpreview.ashx");e.query.set("guidSite",""+a),e.query.set("guidWeb",""+s),e.query.set("guidFile",""+u),p.bannerImageUrl=e.toUrlAndQuery(),d.objectDefinedNotNull(p._layoutPart.serverProcessedContent)||(p._layoutPart.serverProcessedContent={}),p._layoutPart.serverProcessedContent.imageSources={imageSource:n},d.objectDefinedNotNull(p._layoutPart.serverProcessedContent.customMetadata)||(p._layoutPart.serverProcessedContent.customMetadata={}),p._layoutPart.serverProcessedContent.customMetadata.imageSource={listId:l,siteId:a,uniqueId:u,webId:s},p._layoutPart.properties.webId=s,p._layoutPart.properties.siteId=a,p._layoutPart.properties.listId=l,p._layoutPart.properties.uniqueId=u,t()}).catch(e)})})),this.json.IsPageCheckedOutToCurrentUser||(t=t.then(function(e){return ri.initFrom(p,"_api/sitepages/pages("+p.json.Id+")/checkoutpage").postCore()})),t=t.then(function(e){var t=Object.assign(j("SP.Publishing.SitePage"),{AuthorByline:p.json.AuthorByline||[],BannerImageUrl:p.bannerImageUrl,CanvasContent1:p.getCanvasContent1(),LayoutWebpartsContent:p.getLayoutWebpartsContent(),Title:p.title,TopicHeader:p.topicHeader}),n=ri.initFrom(p,"_api/sitepages/pages("+p.json.Id+")/savepage");return n.configure({headers:{"if-match":"*"}}),n.postCore({body:d.jsS(t)})}),e&&(t=t.then(function(e){return ri.initFrom(p,"_api/sitepages/pages("+p.json.Id+")/publish").postCore()}).then(function(e){e&&(p.json.IsPageCheckedOutToCurrentUser=!1)})),t=t.then(function(e){p._bannerImageDirty=!1})},ri.prototype.discardPageCheckout=function(){return f(this,void 0,void 0,function(){var t;return y(this,function(e){switch(e.label){case 0:if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");return[4,ri.initFrom(this,"_api/sitepages/pages("+this.json.Id+")/discardPage").postCore({body:d.jsS(j("SP.Publishing.SitePage"))})];case 1:return t=e.sent(),this.fromJSON(t),[2]}})})},ri.prototype.promoteToNews=function(){return f(this,void 0,void 0,function(){return y(this,function(e){return[2,this.promoteNewsImpl("promoteToNews")]})})},ri.prototype.enableComments=function(){var t=this;return this.setCommentsOn(!0).then(function(e){return t.commentsDisabled=!1,e})},ri.prototype.disableComments=function(){var t=this;return this.setCommentsOn(!1).then(function(e){return t.commentsDisabled=!0,e})},ri.prototype.findControlById=function(t){return this.findControl(function(e){return e.id===t})},ri.prototype.findControl=function(e){for(var t=0;t<this.sections.length;t++)for(var n=0;n<this.sections[t].columns.length;n++)for(var r=0;r<this.sections[t].columns[n].controls.length;r++)if(e(this.sections[t].columns[n].controls[r]))return this.sections[t].columns[n].controls[r];return null},ri.prototype.like=function(){return this.getItem().then(function(e){return e.like()})},ri.prototype.unlike=function(){return this.getItem().then(function(e){return e.unlike()})},ri.prototype.getLikedByInformation=function(){return this.getItem().then(function(e){return e.getLikedByInformation()})},ri.prototype.copyPage=function(n,r,o,i,a){return void 0===i&&(i=!0),void 0===a&&(a=0),f(this,void 0,void 0,function(){var t;return y(this,function(e){switch(e.label){case 0:return[4,ri.create(n,r,o,this.pageLayout,a)];case 1:return(t=e.sent()).setControls(this.getControls()),[4,t.save(i)];case 2:return e.sent(),[2,t]}})})},ri.prototype.setBannerImage=function(e,t){this.bannerImageUrl=e,this.bannerImageSourceType=2,d.objectDefinedNotNull(t)&&(d.hOP(t,"translateX")&&(this._layoutPart.properties.translateX=t.translateX),d.hOP(t,"translateY")&&(this._layoutPart.properties.translateY=t.translateY),d.hOP(t,"imageSourceType")&&(this.bannerImageSourceType=t.imageSourceType),d.hOP(t,"altText")&&(this._layoutPart.properties.altText=t.altText))},ri.prototype.getCanvasContent1=function(){return JSON.stringify(this.getControls())},ri.prototype.getLayoutWebpartsContent=function(){return this._layoutPart?JSON.stringify([this._layoutPart]):JSON.stringify(null)},ri.prototype.setControls=function(e){if(e&&e.length){for(var t=0;t<e.length;t++)switch(d.hOP(e[t],"controlType")?e[t].controlType:0){case 0:d.hOP(e[t],"pageSettingsSlice")?this._pageSettings=e[t]:this.mergeColumnToTree(new ai(e[t]));break;case 3:var n=new fi(e[t]);this.mergePartToTree(n,n.data.position);break;case 4:var r=e[t],o=new pi(r.innerHTML,r);this.mergePartToTree(o,o.data.position)}ei(this.sections)}},ri.prototype.getControls=function(){var n=this;ei(this.sections);var r=[];return this.sections.forEach(function(t){t.columns.forEach(function(e){e.controls.length<1?r.push({displayMode:e.data.displayMode,emphasis:n.getEmphasisObj(t.emphasis),position:e.data.position}):e.controls.forEach(function(e){e.data.emphasis=n.getEmphasisObj(t.emphasis),r.push(e.data)})})}),r.push(this._pageSettings),r},ri.prototype.getEmphasisObj=function(e){return e<1||3<e?{}:{zoneEmphasis:e}},ri.prototype.setCommentsOn=function(t){return this.getItem().then(function(e){return new or(e,"SetCommentsDisabled("+!t+")").update({})})},ri.prototype.promoteNewsImpl=function(t){return f(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return d.stringIsNullOrEmpty(this.json.VersionInfo.LastVersionCreatedBy)&&new Date(this.json.VersionInfo.LastVersionCreated).getFullYear()<2e3?[4,this.save(!0)]:[3,2];case 1:e.sent(),e.label=2;case 2:if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");return[4,ri.initFrom(this,"_api/sitepages/pages("+this.json.Id+")/"+t).postCore({body:d.jsS(j("SP.Publishing.SitePage"))})];case 3:return[2,e.sent()]}})})},ri.prototype.mergePartToTree=function(e,t){var n=null,r=12,o=0,i=0,a=1;t&&(d.hOP(t,"zoneIndex")&&(i=t.zoneIndex),d.hOP(t,"sectionIndex")&&(o=t.sectionIndex),d.hOP(t,"sectionFactor")&&(r=t.sectionFactor),d.hOP(t,"layoutIndex")&&(a=t.layoutIndex));var s=e.data&&e.data.emphasis&&e.data.emphasis.zoneEmphasis?e.data.emphasis.zoneEmphasis:0,u=this.getOrCreateSection(i,a,s),l=u.columns.filter(function(e){return e.order===o});n=l.length<1?u.addColumn(r,a):l[0],(e.column=n).addControl(e)},ri.prototype.mergeColumnToTree=function(e){var t=d.hOP(e.data,"position")&&d.hOP(e.data.position,"zoneIndex")?e.data.position.zoneIndex:0,n=d.hOP(e.data,"position")&&d.hOP(e.data.position,"layoutIndex")?e.data.position.layoutIndex:1,r=this.getOrCreateSection(t,n,e.data.emphasis.zoneEmphasis||0);(e.section=r).columns.push(e)},ri.prototype.getOrCreateSection=function(t,n,e){var r=null,o=this.sections.filter(function(e){return e.order===t&&e.layoutIndex===n});return o.length<1?((r=2===n?this.addVerticalSection():this.addSection()).order=t,r.emphasis=e):r=o[0],r},ri.prototype.getItem=function(){for(var n=this,r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return ri.initFrom(this,"/_api/lists/EnsureClientRenderedSitePagesLibrary").select("EnableModeration","EnableMinorVersions","Id").postCore().then(function(e){var t=new Mn(e["odata.id"]).configureFrom(n).items.getById(n.json.Id);return t.select.apply(t,r).get().then(function(e){return d.extend(new or(l(e)).configureFrom(n),e)})})},ri);function ri(e,t,n,r,o,i){void 0===r&&(r=!1),void 0===o&&(o=[]),void 0===i&&(i=!1);var a=ti.call(this,e,t)||this;return a.json=n,a.sections=o,a.commentsDisabled=i,a._bannerImageDirty=!1,"string"==typeof e?(a._parentUrl="",a._url=d.combine(g(e),t)):a.extend(ri.initFrom(e,null),t),a._pageSettings={controlType:0,pageSettingsSlice:{isDefaultDescription:!0,isDefaultThumbnail:!0}},a._layoutPart=ri.getDefaultLayoutPart(),void 0===n||r||a.fromJSON(n),a}var oi=(Object.defineProperty(ii.prototype,"order",{get:function(){return this._order},set:function(e){this._order=e;for(var t=0;t<this.columns.length;t++)this.columns[t].data.position.zoneIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(ii.prototype,"layoutIndex",{get:function(){return this._layoutIndex},set:function(e){this._layoutIndex=e;for(var t=0;t<this.columns.length;t++)this.columns[t].data.position.layoutIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(ii.prototype,"defaultColumn",{get:function(){return this.columns.length<1&&this.addColumn(12),this.columns[0]},enumerable:!0,configurable:!0}),ii.prototype.addColumn=function(e,t){void 0===t&&(t=1);var n=new ai;return n.section=this,n.data.position.zoneIndex=this.order,n.data.position.layoutIndex=t,n.data.position.sectionFactor=e,n.order=Yo(this.columns),this.columns.push(n),n},ii.prototype.addControl=function(e){return this.defaultColumn.addControl(e),this},Object.defineProperty(ii.prototype,"emphasis",{get:function(){return this._emphasis},set:function(e){this._emphasis=e},enumerable:!0,configurable:!0}),ii.prototype.remove=function(){var t=this;this.page.sections=this.page.sections.filter(function(e){return e._memId!==t._memId}),ei(this.page.sections)},ii);function ii(e,t,n,r,o){void 0===r&&(r=[]),void 0===o&&(o=0),this.page=e,this.columns=r,this._emphasis=o,this._memId=d.getGUID(),this._order=t,this._layoutIndex=n}var ai=(Object.defineProperty(si.prototype,"data",{get:function(){return this.json},enumerable:!0,configurable:!0}),Object.defineProperty(si.prototype,"section",{get:function(){return this._section},set:function(e){this._section=e},enumerable:!0,configurable:!0}),Object.defineProperty(si.prototype,"order",{get:function(){return this.data.position.sectionIndex},set:function(e){this.data.position.sectionIndex=e;for(var t=0;t<this.controls.length;t++)this.controls[t].data.position.zoneIndex=this.data.position.zoneIndex,this.controls[t].data.position.layoutIndex=this.data.position.layoutIndex,this.controls[t].data.position.sectionIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(si.prototype,"factor",{get:function(){return this.data.position.sectionFactor},set:function(e){this.data.position.sectionFactor=e},enumerable:!0,configurable:!0}),si.prototype.addControl=function(e){return(e.column=this).controls.push(e),this},si.prototype.getControl=function(e){return this.controls[e]},si.prototype.remove=function(){var t=this;this.section.columns=this.section.columns.filter(function(e){return e._memId!==t._memId}),ei(this.section.columns)},si.Default={controlType:0,displayMode:2,emphasis:{},position:{layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}},si);function si(e,t){void 0===e&&(e=JSON.parse(JSON.stringify(si.Default))),void 0===t&&(t=[]),this.json=e,this.controls=t,this._section=null,this._memId=d.getGUID()}var ui=(Object.defineProperty(li.prototype,"id",{get:function(){return this.json.id},enumerable:!0,configurable:!0}),Object.defineProperty(li.prototype,"data",{get:function(){return this.json},enumerable:!0,configurable:!0}),Object.defineProperty(li.prototype,"column",{get:function(){return this._column},set:function(e){this._column=e,this.onColumnChange(this._column)},enumerable:!0,configurable:!0}),li.prototype.remove=function(){var t=this;this.column.controls=this.column.controls.filter(function(e){return e.id!==t.id}),ei(this.column.controls)},li.prototype.setData=function(e){this.json=e},li);function li(e){this.json=e}var ci,pi=(o(di,ci=ui),Object.defineProperty(di.prototype,"text",{get:function(){return this.data.innerHTML},set:function(e){e.startsWith("<p>")||(e="<p>"+e+"</p>"),this.data.innerHTML=e},enumerable:!0,configurable:!0}),Object.defineProperty(di.prototype,"order",{get:function(){return this.data.position.controlIndex},set:function(e){this.data.position.controlIndex=e},enumerable:!0,configurable:!0}),di.prototype.onColumnChange=function(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=Yo(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.order,this.data.position.layoutIndex=e.data.position.layoutIndex},di.Default={addedFromPersistedData:!1,anchorComponentId:"",controlType:4,displayMode:2,editorType:"CKEditor",emphasis:{},id:"",innerHTML:"",position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}},di);function di(e,t){void 0===t&&(t=JSON.parse(JSON.stringify(di.Default)));var n=this;return d.stringIsNullOrEmpty(t.id)&&(t.id=d.getGUID(),t.anchorComponentId=t.id),(n=ci.call(this,t)||this).text=e,n}var hi,fi=(o(yi,hi=ui),yi.fromComponentDef=function(e){var t=new yi;return t.import(e),t},Object.defineProperty(yi.prototype,"title",{get:function(){return this.data.webPartData.title},set:function(e){this.data.webPartData.title=e},enumerable:!0,configurable:!0}),Object.defineProperty(yi.prototype,"description",{get:function(){return this.data.webPartData.description},set:function(e){this.data.webPartData.description=e},enumerable:!0,configurable:!0}),Object.defineProperty(yi.prototype,"order",{get:function(){return this.data.position.controlIndex},set:function(e){this.data.position.controlIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(yi.prototype,"height",{get:function(){return this.data.reservedHeight},set:function(e){this.data.reservedHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(yi.prototype,"width",{get:function(){return this.data.reservedWidth},set:function(e){this.data.reservedWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(yi.prototype,"dataVersion",{get:function(){return this.data.webPartData.dataVersion},set:function(e){this.data.webPartData.dataVersion=e},enumerable:!0,configurable:!0}),yi.prototype.setProperties=function(e){return this.data.webPartData.properties=d.extend(this.data.webPartData.properties,e),this},yi.prototype.getProperties=function(){return this.data.webPartData.properties},yi.prototype.onColumnChange=function(e){this.data.position={controlIndex:Yo(e.controls),layoutIndex:e.data.position.layoutIndex,sectionFactor:e.factor,sectionIndex:e.data.position.sectionIndex,zoneIndex:e.data.position.zoneIndex}},yi.prototype.import=function(e){var t=d.getGUID(),n=e.Id.replace(/^\{|\}$/g,"").toLowerCase(),r=JSON.parse(e.Manifest).preconfiguredEntries[0];this.setData(Object.assign({},this.data,{id:t,webPartData:{dataVersion:"1.0",description:r.description.default,id:n,instanceId:t,properties:r.properties,title:r.title.default},webPartId:n}))},yi.Default={addedFromPersistedData:!1,controlType:3,displayMode:2,emphasis:{},id:null,position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1},reservedHeight:500,reservedWidth:500,webPartData:null,webPartId:null},yi);function yi(e){return void 0===e&&(e=JSON.parse(JSON.stringify(yi.Default))),hi.call(this,e)||this}var gi=new Map([["text","Querytext"],["template","QueryTemplate"],["sourceId","SourceId"],["trimDuplicatesIncludeId",""],["startRow",""],["rowLimit",""],["rankingModelId",""],["rowsPerPage",""],["selectProperties",""],["culture",""],["timeZoneId",""],["refinementFilters",""],["refiners",""],["hiddenConstraints",""],["sortList",""],["timeout",""],["hithighlightedProperties",""],["clientType",""],["personalizationData",""],["resultsURL",""],["queryTag",""],["properties",""],["queryTemplatePropertiesUrl",""],["reorderingRules",""],["hitHighlightedMultivaluePropertyLimit",""],["collapseSpecification",""],["uiLanguage",""],["desiredSnippetLength",""],["maxSnippetLength",""],["summaryLength",""]]),mi=new Map([]);function bi(e){return e.replace(/^(.)/,function(e){return e.toUpperCase()})}var vi,Pi=(o(Si,vi=E),Si.prototype.execute=function(e){var t=this,n=this.parseQuery(e),r=d.jsS({request:d.extend(j("Microsoft.Office.Server.Search.REST.SearchRequest"),Object.assign({},n,{HitHighlightedProperties:this.fixArrProp(n.HitHighlightedProperties),Properties:this.fixArrProp(n.Properties),RefinementFilters:this.fixArrProp(n.RefinementFilters),ReorderingRules:this.fixArrProp(n.ReorderingRules),SelectProperties:this.fixArrProp(n.SelectProperties),SortList:this.fixArrProp(n.SortList)}))});if(this._useCaching){this._forceCaching=!0;var o="PnPjs.SearchWithCaching("+d.getHashCode(r)+")";d.objectDefinedNotNull(this._cachingOptions)?/\/_api\/search\/postquery$/i.test(this._cachingOptions.key)&&(this._cachingOptions.key=o):this._cachingOptions=new a.CachingOptions(o)}return this.postCore({body:r}).then(function(e){return new Ti(e,t.toUrl(),n)})},Si.prototype.fixArrProp=function(e){return void 0===e?{results:[]}:(e=d.isArray(e)?e:[e],d.hOP(e,"results")?e:{results:e})},Si.prototype.parseQuery=function(e){return"string"==typeof e?{Querytext:e}:e.toSearchQuery?e.toSearchQuery():e},Si=e([N("_api/search/postquery")],Si));function Si(){return null!==vi&&vi.apply(this,arguments)||this}var Ci,wi,Ii,Ti=(Object.defineProperty(Oi.prototype,"ElapsedTime",{get:function(){return this.RawSearchResults.ElapsedTime},enumerable:!0,configurable:!0}),Object.defineProperty(Oi.prototype,"RowCount",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(Oi.prototype,"TotalRows",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRows},enumerable:!0,configurable:!0}),Object.defineProperty(Oi.prototype,"TotalRowsIncludingDuplicates",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates},enumerable:!0,configurable:!0}),Object.defineProperty(Oi.prototype,"RawSearchResults",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(Oi.prototype,"PrimarySearchResults",{get:function(){return null===this._primary&&(this._primary=this.formatSearchResults(this._raw.PrimaryQueryResult.RelevantResults.Table.Rows)),this._primary},enumerable:!0,configurable:!0}),Oi.prototype.getPage=function(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var n=void 0!==t?t:d.hOP(this._query,"RowLimit")?this._query.RowLimit:10,r=d.extend(this._query,{RowLimit:n,StartRow:n*(e-1)});return r.StartRow>this.TotalRows?Promise.resolve(null):new Pi(this._url,null).execute(r)},Oi.prototype.formatSearchResults=function(e){for(var t=new Array,n=0,r=e.results?e.results:e;n<r.length;n++){var o=r[n],i=o.Cells.results?o.Cells.results:o.Cells;t.push(i.reduce(function(e,t){return Object.defineProperty(e,t.Key,{configurable:!1,enumerable:!0,value:t.Value,writable:!1}),e},{}))}return t},Oi);function Oi(e,t,n,r,o){void 0===r&&(r=null),void 0===o&&(o=null),this._url=t,this._query=n,this._raw=r,this._primary=o,this._raw=e.postquery?e.postquery:e}(Ci=u.SortDirection||(u.SortDirection={}))[Ci.Ascending=0]="Ascending",Ci[Ci.Descending=1]="Descending",Ci[Ci.FQLFormula=2]="FQLFormula",(wi=u.ReorderingRuleMatchType||(u.ReorderingRuleMatchType={}))[wi.ResultContainsKeyword=0]="ResultContainsKeyword",wi[wi.TitleContainsKeyword=1]="TitleContainsKeyword",wi[wi.TitleMatchesKeyword=2]="TitleMatchesKeyword",wi[wi.UrlStartsWith=3]="UrlStartsWith",wi[wi.UrlExactlyMatches=4]="UrlExactlyMatches",wi[wi.ContentTypeIs=5]="ContentTypeIs",wi[wi.FileExtensionMatches=6]="FileExtensionMatches",wi[wi.ResultHasTag=7]="ResultHasTag",wi[wi.ManualCondition=8]="ManualCondition",(Ii=u.QueryPropertyValueType||(u.QueryPropertyValueType={}))[Ii.None=0]="None",Ii[Ii.StringType=1]="StringType",Ii[Ii.Int32Type=2]="Int32Type",Ii[Ii.BooleanType=3]="BooleanType",Ii[Ii.StringArrayType=4]="StringArrayType",Ii[Ii.UnSupportedType=5]="UnSupportedType";var xi=(Ui.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",Ui.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",Ui.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",Ui.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",Ui.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",Ui.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",Ui.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",Ui.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",Ui.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",Ui.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",Ui.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",Ui.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",Ui.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",Ui.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",Ui.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",Ui);function Ui(){}var ji,Fi=(o(Di,ji=E),Di.prototype.execute=function(e){return this.mapQueryToQueryString(e),this.get().then(function(t){var e=d.hOP(t,"suggest")?function(e){return t.suggest[e].results}:function(e){return t[e]};return{PeopleNames:e("PeopleNames"),PersonalResults:e("PersonalResults"),Queries:e("Queries")}})},Di.prototype.mapQueryToQueryString=function(e){var n=this;this.query.set("querytext","'"+e.querytext+"'");var r,t=(r=e,function(t){return function(e){d.hOP(r,t)&&n.query.set(e,r[t].toString())}});t("count")("inumberofquerysuggestions"),t("personalCount")("inumberofresultsuggestions"),t("preQuery")("fprequerysuggestions"),t("hitHighlighting")("fhithighlighting"),t("capitalize")("fcapitalizefirstletters"),t("culture")("culture"),t("stemming")("enablestemming"),t("includePeople")("showpeoplenamesuggestions"),t("queryRules")("enablequeryrules"),t("prefixMatch")("fprefixmatchallterms")},Di=e([N("_api/search/suggest")],Di));function Di(){return null!==ji&&ji.apply(this,arguments)||this}var Ri,Li=(o(_i,Ri=E),Object.defineProperty(_i.prototype,"editProfileLink",{get:function(){return this.clone(_i,"EditProfileLink").get()},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"isMyPeopleListPublic",{get:function(){return this.clone(_i,"IsMyPeopleListPublic").get()},enumerable:!0,configurable:!0}),_i.prototype.amIFollowedBy=function(e){var t=this.clone(_i,"amifollowedby(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.get()},_i.prototype.amIFollowing=function(e){var t=this.clone(_i,"amifollowing(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.get()},_i.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(_i,"getfollowedtags("+e+")").get()},_i.prototype.getFollowersFor=function(e){var t=this.clone(_i,"getfollowersfor(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(_i.prototype,"myFollowers",{get:function(){return new _(this,"getmyfollowers")},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"myProperties",{get:function(){return new _i(this,"getmyproperties")},enumerable:!0,configurable:!0}),_i.prototype.getPeopleFollowedBy=function(e){var t=this.clone(_i,"getpeoplefollowedby(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.get()},_i.prototype.getPropertiesFor=function(e){var t=this.clone(_i,"getpropertiesfor(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(_i.prototype,"trendingTags",{get:function(){var e=this.clone(_i,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!0,configurable:!0}),_i.prototype.getUserProfilePropertyFor=function(e,t){var n=this.clone(_i,"getuserprofilepropertyfor(accountname=@v, propertyname='"+t+"')");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},_i.prototype.hideSuggestion=function(e){var t=this.clone(_i,"hidesuggestion(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.postCore()},_i.prototype.isFollowing=function(e,t){var n=this.clone(_i,null);return n.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.query.set("@y","'"+encodeURIComponent(t)+"'"),n.get()},_i.prototype.setMyProfilePic=function(o){var i=this;return new Promise(function(t,n){var r=null,e=new FileReader;e.onload=function(e){return r=e.target.result},e.readAsArrayBuffer(o),new _i(i,"setmyprofilepicture").postCore({body:String.fromCharCode.apply(null,new Uint16Array(r))}).then(function(e){return t()}).catch(function(e){return n(e)})})},_i.prototype.setSingleValueProfileProperty=function(e,t,n){var r=d.jsS({accountName:e,propertyName:t,propertyValue:n});return this.clone(_i,"SetSingleValueProfileProperty").postCore({body:r})},_i.prototype.setMultiValuedProfileProperty=function(e,t,n){var r=d.jsS({accountName:e,propertyName:t,propertyValues:n});return this.clone(_i,"SetMultiValuedProfileProperty").postCore({body:r})},_i.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(_i.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),_i.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},_i.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},_i.prototype.clientPeoplePickerResolveUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)},_i.prototype.clientPeoplePickerSearchUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)},_i);function _i(e,t){void 0===t&&(t="_api/sp.userprofiles.peoplemanager");var n=Ri.call(this,e,t)||this;return n.clientPeoplePickerQuery=new qi(e).configureFrom(n),n.profileLoader=new Ei(e).configureFrom(n),n}var Bi,Ai,Ei=(o(ki,Bi=D),(Ai=ki).prototype.createPersonalSiteEnqueueBulk=function(e){return this.clone(Ai,"createpersonalsiteenqueuebulk",!1).postCore({body:d.jsS({emailIDs:e})})},Object.defineProperty(ki.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(Ai,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),e.postCore()},enumerable:!0,configurable:!0}),Object.defineProperty(ki.prototype,"userProfile",{get:function(){return this.clone(Ai,"getuserprofile").postCore()},enumerable:!0,configurable:!0}),ki.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.clone(Ai,"getuserprofile/createpersonalsiteenque("+e+")").postCore()},ki.prototype.shareAllSocialData=function(e){return this.clone(Ai,"getuserprofile/shareallsocialdata("+e+")").postCore()},ki=Ai=e([N("_api/sp.userprofiles.profileloader.getprofileloader")],ki));function ki(){return null!==Bi&&Bi.apply(this,arguments)||this}var Ni,Mi,qi=(o(Wi,Ni=D),(Mi=Wi).prototype.clientPeoplePickerResolveUser=function(e){var t=this.clone(Mi,null);return t.concat(".clientpeoplepickerresolveuser"),t.postCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return"object"==typeof e?e.ClientPeoplePickerResolveUser:e}).then(JSON.parse)},Wi.prototype.clientPeoplePickerSearchUser=function(e){var t=this.clone(Mi,null);return t.concat(".clientpeoplepickersearchuser"),t.postCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return"object"==typeof e?e.ClientPeoplePickerSearchUser:e}).then(JSON.parse)},Wi.prototype.createClientPeoplePickerQueryParametersRequestBody=function(e){return d.jsS({queryParams:d.extend(j("SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"),e)})},Wi=Mi=e([N("_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface")],Wi));function Wi(){return null!==Ni&&Ni.apply(this,arguments)||this}var Vi,Hi,Gi=(o(Qi,Vi=E),Hi=Qi,Object.defineProperty(Qi.prototype,"my",{get:function(){return new Yi(this)},enumerable:!0,configurable:!0}),Qi.prototype.getFollowedSitesUri=function(){return this.clone(Hi,"FollowedSitesUri").get().then(function(e){return e.FollowedSitesUri||e})},Qi.prototype.getFollowedDocumentsUri=function(){return this.clone(Hi,"FollowedDocumentsUri").get().then(function(e){return e.FollowedDocumentsUri||e})},Qi.prototype.follow=function(e){return this.clone(Hi,"follow").postCore({body:this.createSocialActorInfoRequestBody(e)})},Qi.prototype.isFollowed=function(e){return this.clone(Hi,"isfollowed").postCore({body:this.createSocialActorInfoRequestBody(e)})},Qi.prototype.stopFollowing=function(e){return this.clone(Hi,"stopfollowing").postCore({body:this.createSocialActorInfoRequestBody(e)})},Qi.prototype.createSocialActorInfoRequestBody=function(e){return d.jsS({actor:Object.assign(j("SP.Social.SocialActorInfo"),{Id:null},e)})},Qi=Hi=e([N("_api/social.following")],Qi));function Qi(){return null!==Vi&&Vi.apply(this,arguments)||this}var zi,Ki,Xi,Ji,$i,Zi,Yi=(o(ea,zi=E),(Ki=ea).prototype.followed=function(e){return this.clone(Ki,"followed(types="+e+")").get().then(function(e){return d.hOP(e,"Followed")?e.Followed.results:e})},ea.prototype.followedCount=function(e){return this.clone(Ki,"followedcount(types="+e+")").get().then(function(e){return e.FollowedCount||e})},ea.prototype.followers=function(){return this.clone(Ki,"followers").get().then(function(e){return d.hOP(e,"Followers")?e.Followers.results:e})},ea.prototype.suggestions=function(){return this.clone(Ki,"suggestions").get().then(function(e){return d.hOP(e,"Suggestions")?e.Suggestions.results:e})},ea=Ki=e([N("my")],ea));function ea(){return null!==zi&&zi.apply(this,arguments)||this}(Xi=u.SocialActorType||(u.SocialActorType={}))[Xi.User=0]="User",Xi[Xi.Document=1]="Document",Xi[Xi.Site=2]="Site",Xi[Xi.Tag=3]="Tag",(Ji=u.SocialActorTypes||(u.SocialActorTypes={}))[Ji.None=0]="None",Ji[Ji.User=1]="User",Ji[Ji.Document=2]="Document",Ji[Ji.Site=4]="Site",Ji[Ji.Tag=8]="Tag",Ji[Ji.ExcludeContentWithoutFeeds=268435456]="ExcludeContentWithoutFeeds",Ji[Ji.IncludeGroupsSites=536870912]="IncludeGroupsSites",Ji[Ji.WithinLast24Hours=1073741824]="WithinLast24Hours",($i=u.SocialFollowResult||(u.SocialFollowResult={}))[$i.Ok=0]="Ok",$i[$i.AlreadyFollowing=1]="AlreadyFollowing",$i[$i.LimitReached=2]="LimitReached",$i[$i.InternalError=3]="InternalError",(Zi=u.SocialStatusCode||(u.SocialStatusCode={}))[Zi.OK=0]="OK",Zi[Zi.InvalidRequest=1]="InvalidRequest",Zi[Zi.AccessDenied=2]="AccessDenied",Zi[Zi.ItemNotFound=3]="ItemNotFound",Zi[Zi.InvalidOperation=4]="InvalidOperation",Zi[Zi.ItemNotModified=5]="ItemNotModified",Zi[Zi.InternalError=6]="InternalError",Zi[Zi.CacheReadError=7]="CacheReadError",Zi[Zi.CacheUpdateError=8]="CacheUpdateError",Zi[Zi.PersonalSiteNotFound=9]="PersonalSiteNotFound",Zi[Zi.FailedToCreatePersonalSite=10]="FailedToCreatePersonalSite",Zi[Zi.NotAuthorizedToCreatePersonalSite=11]="NotAuthorizedToCreatePersonalSite",Zi[Zi.CannotCreatePersonalSite=12]="CannotCreatePersonalSite",Zi[Zi.LimitReached=13]="LimitReached",Zi[Zi.AttachmentError=14]="AttachmentError",Zi[Zi.PartialData=15]="PartialData",Zi[Zi.FeatureDisabled=16]="FeatureDisabled",Zi[Zi.StorageQuotaExceeded=17]="StorageQuotaExceeded",Zi[Zi.DatabaseError=18]="DatabaseError";var ta,na=(o(ra,ta=D),ra.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e.toUrl(),n=t.indexOf("_api/");return n<0?t:t.substr(0,n)},ra.prototype.excute=function(e){return this.postCore({body:d.jsS(e)})},ra.prototype.sendEmail=function(e){var t={properties:d.extend(j("SP.Utilities.EmailProperties"),{Body:e.Body,From:e.From,Subject:e.Subject})};return e.To&&0<e.To.length&&(t.properties=d.extend(t.properties,{To:{results:e.To}})),e.CC&&0<e.CC.length&&(t.properties=d.extend(t.properties,{CC:{results:e.CC}})),e.BCC&&0<e.BCC.length&&(t.properties=d.extend(t.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(t.properties=d.extend(t.properties,{AdditionalHeaders:e.AdditionalHeaders})),this.clone(ra,"SendEmail",!0).excute(t)},ra.prototype.getCurrentUserEmailAddresses=function(){return this.clone(ra,"GetCurrentUserEmailAddresses",!0).excute({}).then(function(e){return d.hOP(e,"GetCurrentUserEmailAddresses")?e.GetCurrentUserEmailAddresses:e})},ra.prototype.resolvePrincipal=function(e,t,n,r,o,i){void 0===i&&(i=!1);var a={addToUserInfoList:o,input:e,inputIsEmailOnly:r,matchUserInfoList:i,scopes:t,sources:n};return this.clone(ra,"ResolvePrincipalInCurrentContext",!0).excute(a).then(function(e){return d.hOP(e,"ResolvePrincipalInCurrentContext")?e.ResolvePrincipalInCurrentContext:e})},ra.prototype.searchPrincipals=function(e,t,n,r,o){var i={groupName:r,input:e,maxCount:o,scopes:t,sources:n};return this.clone(ra,"SearchPrincipalsUsingContextWeb",!0).excute(i).then(function(e){return d.hOP(e,"SearchPrincipalsUsingContextWeb")?e.SearchPrincipalsUsingContextWeb:e})},ra.prototype.createEmailBodyForInvitation=function(e){var t={pageAddress:e};return this.clone(ra,"CreateEmailBodyForInvitation",!0).excute(t).then(function(e){return d.hOP(e,"CreateEmailBodyForInvitation")?e.CreateEmailBodyForInvitation:e})},ra.prototype.expandGroupsToPrincipals=function(e,t){void 0===t&&(t=30);var n={inputs:e,maxCount:t};return this.clone(ra,"ExpandGroupsToPrincipals",!0).excute(n).then(function(e){return d.hOP(e,"ExpandGroupsToPrincipals")?e.ExpandGroupsToPrincipals:e})},ra.prototype.createWikiPage=function(e){return this.clone(ra,"CreateWikiPageInContextWeb",!0).excute({parameters:e}).then(function(e){return{data:d.hOP(e,"CreateWikiPageInContextWeb")?e.CreateWikiPageInContextWeb:e,file:new Tr(l(e))}})},ra.prototype.containsInvalidFileFolderChars=function(e,t){return void 0===t&&(t=!1),t?(ra.InvalidFileFolderNameCharsOnPremiseRegex.lastIndex=0,ra.InvalidFileFolderNameCharsOnPremiseRegex.test(e)):(ra.InvalidFileFolderNameCharsOnlineRegex.lastIndex=0,ra.InvalidFileFolderNameCharsOnlineRegex.test(e))},ra.prototype.stripInvalidFileFolderChars=function(e,t,n){return void 0===t&&(t=""),void 0===n&&(n=!1),n?e.replace(ra.InvalidFileFolderNameCharsOnPremiseRegex,t):e.replace(ra.InvalidFileFolderNameCharsOnlineRegex,t)},ra.InvalidFileFolderNameCharsOnlineRegex=/["*:<>?/\\|\x00-\x1f\x7f-\x9f]/g,ra.InvalidFileFolderNameCharsOnPremiseRegex=/["#%*:<>?/\\|\x00-\x1f\x7f-\x9f]/g,ra);function ra(e,t){return ta.call(this,ra.getBaseUrl(e),"_api/SP.Utilities.Utility."+t)||this}var oa,ia=(o(aa,oa=_),aa.prototype.getById=function(e){return new ua(this,"GetById?hubSiteId='"+e+"'")},aa=e([N("_api/hubsites")],aa));function aa(){return null!==oa&&oa.apply(this,arguments)||this}var sa,ua=(o(la,sa=E),la);function la(){return null!==sa&&sa.apply(this,arguments)||this}var ca=(pa.prototype.configure=function(e,t){return void 0===t&&(t=""),new pa(e,t)},pa.prototype.setup=function(e){var t;t=e,d.RuntimeConfig.extend(t)},pa.prototype.searchSuggest=function(e){var t;return t="string"==typeof e?{querytext:e}:e,this.create(Fi).execute(t)},pa.prototype.search=function(e){return this.create(Pi).execute(e)},pa.prototype.searchWithCaching=function(e,t){return this.create(Pi).usingCaching(t).execute(e)},Object.defineProperty(pa.prototype,"site",{get:function(){return this.create(no)},enumerable:!0,configurable:!0}),Object.defineProperty(pa.prototype,"web",{get:function(){return this.create($o)},enumerable:!0,configurable:!0}),Object.defineProperty(pa.prototype,"profiles",{get:function(){return this.create(Li)},enumerable:!0,configurable:!0}),Object.defineProperty(pa.prototype,"social",{get:function(){return this.create(Gi)},enumerable:!0,configurable:!0}),Object.defineProperty(pa.prototype,"navigation",{get:function(){return this.create(yo)},enumerable:!0,configurable:!0}),pa.prototype.createBatch=function(){return this.web.createBatch()},Object.defineProperty(pa.prototype,"utility",{get:function(){return this.create(na,"")},enumerable:!0,configurable:!0}),Object.defineProperty(pa.prototype,"siteScripts",{get:function(){return this.create(No,"")},enumerable:!0,configurable:!0}),Object.defineProperty(pa.prototype,"siteDesigns",{get:function(){return this.create(Ao,"")},enumerable:!0,configurable:!0}),Object.defineProperty(pa.prototype,"hubSites",{get:function(){return this.create(ia)},enumerable:!0,configurable:!0}),pa.prototype.getTenantAppCatalogWeb=function(){var t=this;return this.create($o,"_api/SP_TenantSettings_Current").get().then(function(e){return new $o(e.CorporateCatalogUrl).configure(t._options)})},pa.prototype.create=function(e,t){return new e(this._baseUrl,t).configure(this._options)},pa);function pa(e,t){void 0===e&&(e={}),void 0===t&&(t=""),this._options=e,this._baseUrl=t}var da=new ca;u.odataUrlFrom=l,u.spODataEntity=b,u.spODataEntityArray=function(e){return new p(e)},u.SharePointQueryable=D,u.SharePointQueryableInstance=E,u.SharePointQueryableCollection=_,u.SharePointQueryableSecurable=Qe,u.FileFolderShared=ot,u.SharePointQueryableShareable=Xe,u.SharePointQueryableShareableFile=st,u.SharePointQueryableShareableFolder=ct,u.SharePointQueryableShareableItem=tt,u.SharePointQueryableShareableWeb=Ze,u.AppCatalog=Nr,u.App=Wr,u.SPBatch=Gr,u.ContentType=At,u.ContentTypes=Lt,u.FieldLink=Wt,u.FieldLinks=Nt,u.Field=fn,u.Fields=pn,u.File=Tr,u.Files=Cr,u.Folder=jt,u.Folders=Ot,u.SPHttpClient=T,u.Item=or,u.Items=tr,u.ItemVersion=cr,u.ItemVersions=sr,u.PagedItemCollection=dr,u.NavigationNodes=io,u.NavigationNode=uo,u.NavigationService=yo,u.List=Mn,u.Lists=En,u.RegionalSettings=Co,u.InstalledLanguages=To,u.TimeZone=jo,u.TimeZones=Lo,u.sp=da,u.SPRest=ca,u.RoleDefinitionBindings=Ve,u.Search=Pi,u.SearchQueryBuilder=function(e,t){return void 0===e&&(e=""),void 0===t&&(t={}),new Proxy({query:Object.assign({Querytext:e},t)},{get:function(r,e,o){var i=e.toString();if("toSearchQuery"===i)return function(){return r.query};if(gi.has(i))return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=gi.get(i);return r.query[0<n.length?n:bi(i)]=1<e.length?e:e[0],o};var t=mi.has(i)?mi.get(i):bi(i);return r.query[t]=!0,o}})},u.SearchResults=Ti,u.SearchBuiltInSourceId=xi,u.SearchSuggest=Fi,u.Site=no,u.UserProfileQuery=Li,u.toAbsoluteUrl=U,u.extractWebUrl=g,u.UtilityMethod=na,u.View=nn,u.Views=Yt,u.ViewFields=sn,u.WebPartDefinitions=gt,u.WebPartDefinition=vt,u.WebPart=Ct,u.Web=$o,u.SiteScripts=No,u.SiteDesigns=Ao,u.HubSite=ua,u.HubSites=ia,u.ClientSidePage=ni,u.CanvasSection=oi,u.CanvasColumn=ai,u.ColumnControl=ui,u.ClientSideText=pi,u.ClientSideWebpart=fi,u.Comments=Hn,u.Comment=zn,u.Replies=$n,u.SocialQuery=Gi,u.MySocialQuery=Yi,Object.defineProperty(u,"__esModule",{value:!0})});
//# sourceMappingURL=sp.es5.umd.min.js.map

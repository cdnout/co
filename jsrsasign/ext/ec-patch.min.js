ECFieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},ECPointFp.prototype.getEncoded=function(t){function i(t,i){var e=t.toByteArrayUnsigned();if(i<e.length)e=e.slice(e.length-i);else for(;i>e.length;)e.unshift(0);return e}var e=this.getX().toBigInteger(),r=this.getY().toBigInteger(),e=i(e,32);return t?r.isEven()?e.unshift(2):e.unshift(3):(e.unshift(4),e=e.concat(i(r,32))),e},ECPointFp.decodeFrom=function(t,i){i[0];var e=i.length-1,r=i.slice(1,1+e/2),e=i.slice(1+e/2,1+e);r.unshift(0),e.unshift(0);r=new BigInteger(r),e=new BigInteger(e);return new ECPointFp(t,t.fromBigInteger(r),t.fromBigInteger(e))},ECPointFp.decodeFromHex=function(t,i){i.substr(0,2);var e=i.length-2,r=i.substr(2,e/2),e=i.substr(2+e/2,e/2),r=new BigInteger(r,16),e=new BigInteger(e,16);return new ECPointFp(t,t.fromBigInteger(r),t.fromBigInteger(e))},ECPointFp.prototype.add2D=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;if(this.x.equals(t.x))return this.y.equals(t.y)?this.twice():this.curve.getInfinity();var i=t.x.subtract(this.x),i=t.y.subtract(this.y).divide(i),t=i.square().subtract(this.x).subtract(t.x),i=i.multiply(this.x.subtract(t)).subtract(this.y);return new ECPointFp(this.curve,t,i)},ECPointFp.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=this.curve.fromBigInteger(BigInteger.valueOf(2)),i=this.curve.fromBigInteger(BigInteger.valueOf(3)),i=this.x.square().multiply(i).add(this.curve.a).divide(this.y.multiply(t)),t=i.square().subtract(this.x.multiply(t)),i=i.multiply(this.x.subtract(t)).subtract(this.y);return new ECPointFp(this.curve,t,i)},ECPointFp.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();for(var i=t,e=i.multiply(new BigInteger("3")),r=this.negate(),n=this,o=e.bitLength()-2;0<o;--o){n=n.twice();var s=e.testBit(o);s!=i.testBit(o)&&(n=n.add2D(s?this:r))}return n},ECPointFp.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),i=this.getY().toBigInteger(),e=this.curve.getA().toBigInteger(),r=this.curve.getB().toBigInteger(),n=this.curve.getQ(),i=i.multiply(i).mod(n),n=t.multiply(t).multiply(t).add(e.multiply(t)).add(r).mod(n);return i.equals(n)},ECPointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},ECPointFp.prototype.validate=function(){var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var i=this.getX().toBigInteger(),e=this.getY().toBigInteger();if(i.compareTo(BigInteger.ONE)<0||0<i.compareTo(t.subtract(BigInteger.ONE)))throw new Error("x coordinate out of bounds");if(e.compareTo(BigInteger.ONE)<0||0<e.compareTo(t.subtract(BigInteger.ONE)))throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};
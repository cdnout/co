function parseBigInt(t,n){return new BigInteger(t,n)}function linebrk(t,n){for(var e="",r=0;r+n<t.length;)e+=t.substring(r,r+n)+"\n",r+=n;return e+t.substring(r,t.length)}function byte2Hex(t){return t<16?"0"+t.toString(16):t.toString(16)}function pkcs1pad2(t,n){if(n<t.length+11)throw"Message too long for RSA";for(var e=new Array,r=t.length-1;0<=r&&0<n;){var i=t.charCodeAt(r--);i<128?e[--n]=i:127<i&&i<2048?(e[--n]=63&i|128,e[--n]=i>>6|192):(e[--n]=63&i|128,e[--n]=i>>6&63|128,e[--n]=i>>12|224)}e[--n]=0;for(var o=new SecureRandom,l=new Array;2<n;){for(l[0]=0;0==l[0];)o.nextBytes(l);e[--n]=l[0]}return e[--n]=2,e[--n]=0,new BigInteger(e)}function oaep_mgf1_arr(t,n,e){for(var r="",i=0;r.length<n;)r+=e(String.fromCharCode.apply(String,t.concat([(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i]))),i+=1;return r}function oaep_pad(t,n,e,r){var i,o=KJUR.crypto.MessageDigest,l=KJUR.crypto.Util;if("string"==typeof(e=e||"sha1")&&(i=o.getCanonicalAlgName(e),r=o.getHashLength(i),e=function(t){return hextorstr(l.hashHex(rstrtohex(t),i))}),t.length+2*r+2>n)throw"Message too long for RSA";for(var u="",h=0;h<n-t.length-2*r-2;h+=1)u+="\0";var a=e("")+u+""+t,s=new Array(r);(new SecureRandom).nextBytes(s);var g=oaep_mgf1_arr(s,a.length,e),c=[];for(h=0;h<a.length;h+=1)c[h]=a.charCodeAt(h)^g.charCodeAt(h);var p=oaep_mgf1_arr(c,s.length,e),f=[0];for(h=0;h<s.length;h+=1)f[h+1]=s[h]^p.charCodeAt(h);return new BigInteger(f.concat(c))}function RSAKey(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function RSASetPublic(t,n){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof t)this.n=t,this.e=n;else{if(!(null!=t&&null!=n&&0<t.length&&0<n.length))throw"Invalid RSA public key";this.n=parseBigInt(t,16),this.e=parseInt(n,16)}}function RSADoPublic(t){return t.modPowInt(this.e,this.n)}function RSAEncrypt(t){t=pkcs1pad2(t,this.n.bitLength()+7>>3);if(null==t)return null;t=this.doPublic(t);if(null==t)return null;t=t.toString(16);return 0==(1&t.length)?t:"0"+t}function RSAEncryptOAEP(t,n,e){e=oaep_pad(t,this.n.bitLength()+7>>3,n,e);if(null==e)return null;e=this.doPublic(e);if(null==e)return null;e=e.toString(16);return 0==(1&e.length)?e:"0"+e}RSAKey.prototype.doPublic=RSADoPublic,RSAKey.prototype.setPublic=RSASetPublic,RSAKey.prototype.encrypt=RSAEncrypt,RSAKey.prototype.encryptOAEP=RSAEncryptOAEP,RSAKey.prototype.type="RSA";
(function(){angular.module("template/treeGrid/treeGrid.html",[]).run(["$templateCache",function(e){e.put("template/treeGrid/treeGrid.html",'<div class="table-responsive">\n <table class="table tree-grid">\n   <thead>\n     <tr>\n       <th><a ng-if="expandingProperty.sortable" ng-click="sortBy(expandingProperty)">{{expandingProperty.displayName || expandingProperty.field || expandingProperty}}</a><span ng-if="!expandingProperty.sortable">{{expandingProperty.displayName || expandingProperty.field || expandingProperty}}</span><i ng-if="expandingProperty.sorted" class="{{expandingProperty.sortingIcon}} pull-right"></i></th>\n       <th ng-repeat="col in colDefinitions"><a ng-if="col.sortable" ng-click="sortBy(col)">{{col.displayName || col.field}}</a><span ng-if="!col.sortable">{{col.displayName || col.field}}</span><i ng-if="col.sorted" class="{{col.sortingIcon}} pull-right"></i></th>\n     </tr>\n   </thead>\n   <tbody>\n     <tr ng-repeat="row in tree_rows | searchFor:$parent.filterString:expandingProperty:colDefinitions track by row.branch.uid"\n       ng-class="\'level-\' + {{ row.level }} + (row.branch.selected ? \' active\':\'\')" class="tree-grid-row">\n       <td><a ng-click="user_clicks_branch(row.branch)"><i ng-class="row.tree_icon"\n              ng-click="row.branch.expanded = !row.branch.expanded"\n              class="indented tree-icon"></i></a><span ng-if="expandingProperty.cellTemplate" class="indented tree-label"               ng-click="on_user_click(row.branch)" compile="expandingProperty.cellTemplate"></span>              <span  ng-if="!expandingProperty.cellTemplate" class="indented tree-label" ng-click="on_user_click(row.branch)">\n             {{row.branch[expandingProperty.field] || row.branch[expandingProperty]}}</span>\n       </td>\n       <td ng-repeat="col in colDefinitions">\n         <div ng-if="col.cellTemplate" compile="col.cellTemplate" cell-template-scope="col.cellTemplateScope"></div>\n         <div ng-if="!col.cellTemplate">{{row.branch[col.field]}}</div>\n       </td>\n     </tr>\n   </tbody>\n </table>\n</div>\n')}]),angular.module("treeGrid",["template/treeGrid/treeGrid.html"]).directive("compile",["$compile",function(e){return{restrict:"A",link:function(n,r,t){n.cellTemplateScope=n.$eval(t.cellTemplateScope),n.$watch(t.compile,function(t){var l=e(t),i=l(n);r.append(i)})}}}]).directive("treeGrid",["$timeout","treegridTemplate",function(e,n){return{restrict:"E",templateUrl:function(e,r){return r.templateUrl||n.getPath()},replace:!0,scope:{treeData:"=",colDefs:"=",expandOn:"=",onSelect:"&",onClick:"&",initialSelection:"@",treeControl:"=",expandTo:"="},link:function(n,r,t){var l,i,c,a,o,u,s,d,f,p,h;if(function(e){console.log("ERROR:"+e)},t.iconExpand=t.iconExpand?t.iconExpand:"icon-plus  glyphicon glyphicon-plus  fa fa-plus",t.iconCollapse=t.iconCollapse?t.iconCollapse:"icon-minus glyphicon glyphicon-minus fa fa-minus",t.iconLeaf=t.iconLeaf?t.iconLeaf:"icon-file  glyphicon glyphicon-file  fa fa-file",t.sortedAsc=t.sortedAsc?t.sortedAsc:"icon-file  glyphicon glyphicon-chevron-up  fa angle-up",t.sortedDesc=t.sortedDesc?t.sortedDesc:"icon-file  glyphicon glyphicon-chevron-down  fa angle-down",t.expandLevel=t.expandLevel?t.expandLevel:"0",c=parseInt(t.expandLevel,10),!n.treeData)return void alert("No data was defined for the tree, please define treeData!");var g=function(){if(t.expandOn)l=n.expandOn,n.expandingProperty=n.expandOn;else if(n.treeData.length){for(var e=n.treeData[0],r=Object.keys(e),i=0,c=r.length;i<c;i++)if("string"==typeof e[r[i]]){l=r[i];break}l||(l=r[0]),n.expandingProperty=l}};if(g(),t.colDefs)n.colDefinitions=n.colDefs;else if(n.treeData.length){var _=[],b=n.treeData[0],v=["children","level","expanded","icons",l];for(var x in b)-1===v.indexOf(x)&&_.push({field:x});n.colDefinitions=_}o=function(e){var r,t,l,i,c,a;for(r=function(n,t){var l,i,c,a,o;if(e(n,t),null!=n.children){for(a=n.children,o=[],i=0,c=a.length;i<c;i++)l=a[i],o.push(r(l,t+1));return o}},c=n.treeData,a=[],l=0,i=c.length;l<i;l++)t=c[l],a.push(r(t,1));return a},p=null,f=function(r){if(!r)return null!=p&&(p.selected=!1),void(p=null);if(r!==p){if(null!=p&&(p.selected=!1),r.selected=!0,p=r,i(r),null!=r.onSelect)return e(function(){return r.onSelect(r)});if(null!=n.onSelect)return e(function(){return n.onSelect({branch:r})})}},n.on_user_click=function(e){n.onClick&&n.onClick({branch:e})},n.user_clicks_branch=function(e){if(e!==p)return f(e)},n.sortBy=function(e){"asc"===e.sortDirection?(y(n.treeData,e,!0),e.sortDirection="desc",e.sortingIcon=t.sortedDesc):(y(n.treeData,e,!1),e.sortDirection="asc",e.sortingIcon=t.sortedAsc),e.sorted=!0,D(e)};var y=function(e,n,r){e.sort(m(n,r));for(var t=0;t<e.length;t++)y(e[t].children,n,r)},m=function(e,n){var r=n?-1:1;if("custom"===e.sortingType&&"function"==typeof e.sortingFunc)return function(n,t){return e.sortingFunc(n,t)*r};var t=function(n){return null===n[e.field]?"":n[e.field].toLowerCase()};switch(e.sortingType){case"number":t=function(n){return parseFloat(n[e.field])};break;case"date":t=function(n){return new Date(n[e.field])}}return function(e,n){return e=t(e),n=t(n),r*((e>n)-(n>e))}},D=function(e){for(var r=n.colDefinitions.length,t=0;t<r;t++){var l=n.colDefinitions[t];l.field!=e.field&&(l.sorted=!1,l.sortDirection="none")}};return u=function(e){var n;return n=void 0,e.parent_uid&&o(function(r){if(r.uid===e.parent_uid)return n=r}),n},a=function(e,n){var r;if(null!=(r=u(e)))return n(r),a(r,n)},i=function(e){return a(e,function(e){return e.expanded=!0})},n.tree_rows=[],d=function(){g();var e,r,i,a,u,s;for(o(function(e,n){if(!e.uid)return e.uid=""+Math.random()}),o(function(e){var n,r,t,l,i;if(angular.isArray(e.children)){for(l=e.children,i=[],r=0,t=l.length;r<t;r++)n=l[r],i.push(n.parent_uid=e.uid);return i}}),n.tree_rows=[],o(function(e){var n,r;return e.children?e.children.length>0?(r=function(e){return"string"==typeof e?{label:e,children:[]}:e},e.children=function(){var t,l,i,c;for(i=e.children,c=[],t=0,l=i.length;t<l;t++)n=i[t],c.push(r(n));return c}()):void 0:e.children=[]}),e=function(r,i,a){var o,u,s,d,f,p,h;if(null==i.expanded&&(i.expanded=!1),s=i.children&&0!==i.children.length?i.expanded?i.icons&&i.icons.iconCollapse||t.iconCollapse:i.icons&&i.icons.iconExpand||t.iconExpand:i.icons&&i.icons.iconLeaf||t.iconLeaf,i.level=r,n.tree_rows.push({level:r,branch:i,label:i[l],tree_icon:s,visible:a}),null!=i.children){for(p=i.children,h=[],d=0,f=p.length;d<f;d++)o=p[d],u=a&&(i.expanded||i.level<c),h.push(e(r+1,o,u));return h}},u=n.treeData,s=[],i=0,a=u.length;i<a;i++)r=u[i],s.push(e(1,r,!0));return s},n.$watch("treeData",d,!0),on_expandTo_change=function(){angular.isDefined(n.expandTo)&&o(function(r){if(r.expanded=!1,r[l.field]===n.expandTo||r[l]===n.expandTo)return e(function(){return f(r)})})},n.$watch("expandTo",on_expandTo_change,!0),null!=t.initialSelection&&o(function(n){if(n.label===t.initialSelection)return e(function(){return f(n)})}),s=n.treeData.length,o(function(e,n){return e.level=n,e.expanded=e.level<c}),null!=n.treeControl&&angular.isObject(n.treeControl)?(h=n.treeControl,h.expand_all=function(){return o(function(e,n){return e.expanded=!0})},h.collapse_all=function(){return o(function(e,n){return e.expanded=!1})},h.get_first_branch=function(){if((s=n.treeData.length)>0)return n.treeData[0]},h.select_first_branch=function(){var e;return e=h.get_first_branch(),h.select_branch(e)},h.get_selected_branch=function(){return p},h.get_parent_branch=function(e){return u(e)},h.select_branch=function(e){return f(e),e},h.get_children=function(e){return e.children},h.select_parent_branch=function(e){var n;if(null==e&&(e=h.get_selected_branch()),null!=e&&null!=(n=h.get_parent_branch(e)))return h.select_branch(n),n},h.add_branch=function(e,r){return null!=e?(e.children.push(r),e.expanded=!0):n.treeData.push(r),r},h.add_root_branch=function(e){return h.add_branch(null,e),e},h.expand_branch=function(e){if(null==e&&(e=h.get_selected_branch()),null!=e)return e.expanded=!0,e},h.collapse_branch=function(e){if(null==e&&(e=p),null!=e)return e.expanded=!1,e},h.get_siblings=function(e){var r;if(null==e&&(e=p),null!=e)return r=h.get_parent_branch(e),r?r.children:n.treeData},h.get_next_sibling=function(e){var n,r;if(null==e&&(e=p),null!=e&&(r=h.get_siblings(e),s=r.length,(n=r.indexOf(e))<s))return r[n+1]},h.get_prev_sibling=function(e){var n,r;if(null==e&&(e=p),r=h.get_siblings(e),s=r.length,(n=r.indexOf(e))>0)return r[n-1]},h.select_next_sibling=function(e){var n;if(null==e&&(e=p),null!=e&&null!=(n=h.get_next_sibling(e)))return h.select_branch(n)},h.select_prev_sibling=function(e){var n;if(null==e&&(e=p),null!=e&&null!=(n=h.get_prev_sibling(e)))return h.select_branch(n)},h.get_first_child=function(e){var n;if(null==e&&(e=p),null!=e&&(null!=(n=e.children)?n.length:void 0)>0)return e.children[0]},h.get_closest_ancestor_next_sibling=function(e){var n,r;return n=h.get_next_sibling(e),null!=n?n:(r=h.get_parent_branch(e),h.get_closest_ancestor_next_sibling(r))},h.get_next_branch=function(e){var n;if(null==e&&(e=p),null!=e)return n=h.get_first_child(e),null!=n?n:n=h.get_closest_ancestor_next_sibling(e)},h.select_next_branch=function(e){var n;if(null==e&&(e=p),null!=e&&null!=(n=h.get_next_branch(e)))return h.select_branch(n),n},h.last_descendant=function(e){var n;return s=e.children.length,0===s?e:(n=e.children[s-1],h.last_descendant(n))},h.get_prev_branch=function(e){var n;if(null==e&&(e=p),null!=e)return n=h.get_prev_sibling(e),null!=n?h.last_descendant(n):h.get_parent_branch(e)},h.select_prev_branch=function(e){var n;if(null==e&&(e=p),null!=e&&null!=(n=h.get_prev_branch(e)))return h.select_branch(n),n}):void 0}}}]).provider("treegridTemplate",function(){var e="template/treeGrid/treeGrid.html";this.setPath=function(n){e=n},this.$get=function(){return{getPath:function(){return e}}}}).filter("searchFor",function(){function e(e,r,t,l){var i=!1,c=!1;t.filterable&&(c=!0,n(e,r,t)&&(i=!0));for(var a=l.length,o=0;o<a;o++){var u=l[o];u.filterable&&(c=!0,n(e,r,u)&&(i=!0))}return!c||i}function n(e,n,r){if("number"===r.sortingType){if(null!=e.branch[r.field]&&parseFloat(e.branch[r.field])===parseFloat(n))return!0}else if(null!=e.branch[r.field]&&-1!==e.branch[r.field].toLowerCase().indexOf(n.toLowerCase()))return!0}return function(n,r,t,l,i){var c=[];if(!r||r.length<3)for(var a=0;a<n.length;a++){var o=n[a];o.visible&&c.push(o)}else for(var u=[],s=0,a=0;a<n.length;a++){for(var o=n[a];s>=o.level;)throwAway=u.pop(),s--;if(u.push(o),s=o.level,e(o,r,t,l)){for(var d=0;d<u.length;d++)ancestor=u[d],ancestor.visible&&(i&&(ancestor.branch.expanded=!0),c.push(ancestor));u=[]}}return c}})}).call(window);
//# sourceMappingURL=tree-grid-directive.min.js.map
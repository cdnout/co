/*! Monio: bundle.js
    v0.24.2 (c) 2021 Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
!function UMDBundle(t,n){for(let[e,i,r]of n)"function"==typeof define&&define.amd?(i=Object.values(i),define(e,i,r)):"undefined"!=typeof module&&module.exports?(i=Object.keys(i).map((t=>require(t))),module.exports[e]=r(...i)):(i=Object.values(i).map((n=>t[n])),t[e]=r(...i))}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:new Function("return this")(),[["MonioUtil",{},function DEF(){"use strict";let t={};t={getMonadFlatMap:getMonadFlatMap,isMonad:isMonad,liftM:liftM,isFunction:isFunction,isPromise:isPromise,curry:curry},t.getMonadFlatMap=getMonadFlatMap,t.isMonad=isMonad,t.liftM=liftM,t.isFunction=isFunction,t.isPromise=isPromise,t.curry=curry;var n=new Set([Function.prototype.bind,Array.prototype.flatMap,Set.prototype.flatMap,function*(){}().flatMap,async function*(){}().flatMap].filter(isFunction));function getMonadFlatMap(t){var n=t.flatMap||t.chain||t.bind;return isFunction(n)?n:void 0}function isMonad(t){var e=t&&("object"==typeof t||isFunction(t))?getMonadFlatMap(t):void 0;return!(!e||n.has(e)||(e.toString()||"").includes("[native code]")&&!(e.name||"").startsWith("bound"))}function liftM(t){return isMonad(t)?t:Just(t)}function isFunction(t){return!(!t||"function"!=typeof t)}function isPromise(t){return!(!t||!isFunction(t.then))}function curry(t,n=t.length){return function nextCurried(e){return(...i)=>{var r=[...e,...i];return r.length>=n?t(...r):nextCurried(r)}}([])}return t}],["Nothing",{"./lib/util.js":"MonioUtil"},function DEF(t){"use strict";var{isFunction:n}=t,e={};let i={};function Nothing(){var t={map:noop,chain:noop,flatMap:noop,bind:noop,ap:noop,concat:noop,_inspect:function _inspect(){return`${t[Symbol.toStringTag]}()`},_is:function _is(t){return t===e},[Symbol.toStringTag]:"Nothing"};return t;function noop(){return t}}return i=Object.assign(Nothing,{of:Nothing,pure:Nothing,unit:Nothing,is:function is(t){return t&&n(t._is)&&t._is(e)},isEmpty:function isEmpty(t){return null==t}}),i}],["Just",{"./lib/util.js":"MonioUtil"},function DEF(t){"use strict";var{isFunction:n}=t,e={};let i={};function Just(t){var i={map:function map(n){return Just(n(t))},chain:chain,flatMap:chain,bind:chain,ap:function ap(n){return n.map(t)},concat:function concat(n){return n.map((n=>t.concat(n)))},_inspect:function _inspect(){return`${i[Symbol.toStringTag]}(${_serialize(t)})`},_is:function _is(t){return t===e},[Symbol.toStringTag]:"Just"};return i;function chain(n){return n(t)}function _serialize(t){return"string"==typeof t?`"${t}"`:void 0===t?"":n(t)?t.name||"anonymous function":t&&n(t._inspect)?t._inspect():Array.isArray(t)?`[${t.map((t=>null==t?String(t):_serialize(t)))}]`:String(t)}}return i=Object.assign(Just,{of:Just,pure:Just,unit:Just,is:function is(t){return t&&n(t._is)&&t._is(e)}}),i}],["Maybe",{"./lib/util.js":"MonioUtil","./just.js":"Just","./nothing.js":"Nothing"},function DEF(t,n,e){"use strict";var{isFunction:i}=t,r={};Object.assign(MaybeJust,n),Object.assign(MaybeNothing,e);let o={};function MaybeJust(t){return Maybe(t)}function MaybeNothing(){return Maybe(e())}function Maybe(t){var e=t,i=MaybeJust.is(e)&&!is(e),o=MaybeNothing.is(e)&&!is(e);i||o?t=i?e.chain((t=>t)):void 0:(e=n(t),i=!0);var u={map:function map(t){return i?Maybe(e.map(t)):u},chain:chain,flatMap:chain,bind:chain,ap:function ap(n){return i?n.map(t):u},concat:function concat(n){return i?n.map((n=>t.concat(n))):u},fold:function fold(n,e){return i?e(t):n(t)},_inspect:function _inspect(){var t=i?e._inspect().match(/^Just\((.*)\)$/)[1]:"";return`${u[Symbol.toStringTag]}(${t})`},_is:function _is(t){return t===r||e._is(t)},get[Symbol.toStringTag](){return`Maybe:${e[Symbol.toStringTag]}`}};return u;function chain(t){return i?e.chain(t):u}}function is(t){return t&&i(t._is)&&t._is(r)}return o=Object.assign(Maybe,{Just:MaybeJust,Nothing:MaybeNothing,of:Maybe,pure:Maybe,unit:Maybe,is:is,from:function from(t){return MaybeNothing.isEmpty(t)?MaybeNothing():Maybe(t)}}),o}],["Either",{"./lib/util.js":"MonioUtil","./just.js":"Just"},function DEF(t,n){"use strict";var{isFunction:e}=t,i={};Left.is=function LeftIs(t){return is(t)&&!t._is_right()},Right.is=function RightIs(t){return is(t)&&t._is_right()};let r={};function Left(t){return LeftOrRight(t,!1)}function Right(t){return LeftOrRight(t,!0)}function LeftOrRight(t,e=!0){var r={map:function map(n){return e?LeftOrRight(n(t),e):r},chain:chain,flatMap:chain,bind:chain,ap:function ap(n){return e?n.map(t):r},concat:function concat(n){return e?n.map((n=>t.concat(n))):r},fold:function fold(n,i){return e?i(t):n(t)},_inspect:function _inspect(){var e=n(t)._inspect().match(/^Just\((.*)\)$/)[1];return`${r[Symbol.toStringTag]}(${e})`},_is:function _is(t){return t===i},_is_right:function _is_right(){return e},get[Symbol.toStringTag](){return"Either:"+(e?"Right":"Left")}};return r;function chain(n){return e?n(t):r}}function is(t){return t&&e(t._is)&&t._is(i)}return r=Object.assign((function Either(t){return LeftOrRight(t,!0)}),{Left:Left,Right:Right,of:Right,pure:Right,unit:Right,is:is,fromFoldable:function fromFoldable(t){return t.fold(Left,Right)}}),r}],["IO",{"./lib/util.js":"MonioUtil","./nothing.js":"Nothing","./either.js":"Either"},function DEF(t,n,e){"use strict";var{isFunction:i,isPromise:r,isMonad:o,getMonadFlatMap:u}=t,a={};let s={};function IO(t){var n={map:function map(n){return IO((e=>{var i=t(e);return r(i)?i.then(n):n(i)}))},chain:chain,flatMap:chain,bind:chain,ap:function ap(n){return n.map(t)},concat:function concat(n){return IO((e=>{var i=t(e),o=n.run(e);return r(i)||r(o)?Promise.all([i,o]).then((([t,n])=>t.concat(n))):i.concat(o)}))},run:function run(n){return t(n)},_inspect:function _inspect(){return`${n[Symbol.toStringTag]}(${i(t)?t.name||"anonymous function":t&&i(t._inspect)?t._inspect():val})`},_is:function _is(t){return t===a},[Symbol.toStringTag]:"IO"};return n;function chain(n){return IO((e=>{var i=t(e);return r(i)?i.then(n).then((t=>t.run(e))):n(i).run(e)}))}}function processNext(t,i,a,s=!1){return new Promise((async function c(f,l){try{let[h,d]=r(i)?await async function safeUnwrap(t,n){try{if(t=r(t)?await t:t,n&&e.Left.is(t))throw t;return[t,"value"]}catch(t){return[t,"error"]}}(i,s):[i,s&&e.Left.is(i)?"error":"value"],p=n.is(h)?IO((()=>f())):function monadFlatMap(t,n){return u(t).call(t,n)}(s&&"error"==d&&e.Left.is(h)||!o(h)?IO.of(h):h,(n=>IO((()=>t(n,d).then(f,l)))));try{await p.run(a)}catch(n){f(await t(n,"error"))}}catch(t){l(t)}}))}function getIterator(t,n){return i(t)?t(n):t&&"object"==typeof t&&i(t.next)?t:void 0}return s=Object.assign(IO,{of:function of(t){return IO((()=>t))},is:function is(t){return t&&i(t._is)&&t._is(a)},do:function $do(t){return IO((n=>{var e=getIterator(t,n);return async function next(t,i){var o="error"===i?e.throw(t):e.next(t);return(o=r(o)?await o:o).done?IO.is(o.value)?o.value.run(n):o.value:processNext(next,o.value,n,!1)}()}))},doEither:function doEither(t){return IO((n=>{var i=getIterator(t,n);return async function next(t,o){t="error"!=o||e.Left.is(t)?"value"!=o||e.Right.is(t)?e.is(t)?t:e(t):e.Right(t):e.Left(t);try{let o=t.fold((t=>i.throw(t)),(t=>i.next(t)));if(o=r(o)?await o:o,o.done){let t=r(o.value)?await o.value:o.value;if(t=IO.is(t)?t.run(n):t,t=r(t)?await t:t,e.Left.is(t))throw t;return e.Right.is(t)?t:e.Right(t)}return processNext(next,o.value,n,!0)}catch(t){throw e.Left.is(t)?t:e.Left(t)}}()}))}}),s.RIO=IO,s.Reader=IO,s}],["IOHelpers",{"./lib/util.js":"MonioUtil","./io.js":"IO","./maybe.js":"Maybe","./either.js":"Either"},function DEF(t,n,e,i){"use strict";var{isFunction:r,isPromise:o,isMonad:u,liftM:a,curry:s}=t,f=new WeakSet;let l={};function log(...t){return n((()=>console.log(...t)))}function getReader(){return n((t=>t))}function waitAll(...t){return n((n=>Promise.all(t.map((t=>liftIO(n,t).run(n))))))}function applyIO(t,e){return n((()=>t.run(e)))}function doIO(t,...e){return e.length>0?n((i=>n.do(t(i,...e)).run(i))):n.do(t)}function doEIO(t,...e){return e.length>0?n((i=>n.doEither(t(i,...e)).run(i))):n.doEither(t)}function doIOBind(t,e){var i=n((()=>n.do(t).run(e)));return(...r)=>r.length>0?n((()=>n.do(t(e,...r)).run(e))):i}function doEIOBind(t,e){var i=n((()=>n.doEither(t).run(e)));return(...r)=>r.length>0?n((()=>n.doEither(t(e,...r)).run(e))):i}function listFilterInIO(t,n){return listConcatIO(n.map((n=>t(n).map((t=>t?[n]:[])))))}function listFilterOutIO(t,n){return listFilterInIO((n=>iNot(t(n))),n)}function listConcatIO(t){return t.reduce(((t,n)=>t.concat(n)),n.of([]))}function iif(t,e,...i){return n((o=>liftIO(o,t).chain((function doThens(t){return t?(e=r(e)?e():e,(e=Array.isArray(e)?e:[e]).reduce(((t,e)=>t.chain((t=>liftIO(o,t).chain((t=>f.has(t)?n.of(t):liftIO(o,e)))))),n.of()).chain((e=>liftIO(o,e).chain((e=>n.of(f.has(e)?e:t)))))):n.of(t)})).chain(function doNextElse(t){return e=>!e&&t.length>0?liftIO(o,t[0]).chain(doNextElse(t.slice(1))):n.of(e)}(i)).run(o)))}function elif(t,n){return iif(t,n)}function els(t){return iif(!0,t)}function iReturn(t){return n((n=>liftIO(n,t).map((t=>{var n={returned:t};return f.add(n),n})).run(n)))}function iNot(t){return n((n=>liftIO(n,t).map((t=>!t)).run(n)))}function wasReturned(t){return f.has(t)}function ifReturned(t){return t.map((t=>wasReturned(t)?t.returned:void 0))}function getPropIO(t,e){return a(e).chain((e=>n((()=>e[t]))))}function assignPropIO(t,e,i){return a(e).chain((e=>a(i).chain((i=>n((()=>i[t]=e))))))}function liftIO(t,o){if(u(o)){if(n.is(o))return o;if(i.Left.is(o)||e.Nothing.is(o)){let t={returned:o};return f.add(t),n.of(t)}{let t=o.chain(n.of);return n.is(t)?t:n.of(o)}}return r(o)?liftIO(t,o(t)):o&&"object"==typeof o&&r(o.next)?n.do(o):n.of(o)}return l={log:log,getReader:getReader,waitAll:waitAll,applyIO:applyIO,doIO:doIO,doEIO:doEIO,doIOBind:doIOBind,doEIOBind:doEIOBind,listFilterInIO:listFilterInIO,listFilterOutIO:listFilterOutIO,listConcatIO:listConcatIO,iif:iif,elif:elif,els:els,iNot:iNot,iReturn:iReturn,wasReturned:wasReturned,ifReturned:ifReturned,getPropIO:getPropIO,assignPropIO:assignPropIO},l.log=log,l.getReader=getReader,l.waitAll=waitAll,l.applyIO=applyIO,l.doIO=doIO,l.doEIO=doEIO,l.doIOBind=doIOBind,l.doEIOBind=doEIOBind,l.listFilterInIO=listFilterInIO,l.listFilterOutIO=listFilterOutIO,l.listConcatIO=listConcatIO,l.iif=iif,l.elif=elif,l.els=els,l.iNot=iNot,l.iReturn=iReturn,l.wasReturned=wasReturned,l.ifReturned=ifReturned,l.getPropIO=getPropIO,l.assignPropIO=assignPropIO,l}],["IOEventStream",{"./lib/util.js":"MonioUtil","./io.js":"IO"},function DEF(t,n){"use strict";var{isFunction:e,curry:i}=t;let r={};function IOEventStream(t,i,r={}){var{bufferSize:o=100,throwBufferOverflow:u=!1,evtOpts:a={}}=r;return n((()=>{var n,r,s=Symbol("force closed"),{pr:f,next:l}=getDeferred(),h=async function*eventStream(){n=[],r=[],e(t.addEventListener)?t.addEventListener(i,handler,a):e(t.addListener)?t.addListener(i,handler):e(t.on)&&t.on(i,handler);try{for(;;){if(0==n.length){let{pr:t,next:e}=getDeferred();n.push(t),r.push(e)}let t=await Promise.race([f,n.shift()]);if(t==s)return;yield t}}finally{e(t.removeEventListener)?t.removeEventListener(i,handler,a):e(t.removeListener)?t.removeListener(i,handler):e(t.off)&&t.off(i,handler),n.length=r.length=0}}(),d=h.return;return h.return=function itReturn(...t){var n=d.apply(h,t);return h.closed=!0,l(s),h.return=d,n},h.closed=!1,h;function handler(t){if(r.length>0){r.shift()(t)}else if(n.length<o){let{pr:e,next:i}=getDeferred();n.push(e),i(t)}else if(u){let n=new Error("Event stream buffer overflow");throw n.evt=t,n}}}))}function merge(...t){return n((()=>async function*mergeStreams(){try{for(;;){let n=pullFromStreams(t);if(!(n.length>0))return;try{if(1==n.length){let[e,i,r]=await n[0];if(r.done)return void(t[e]=null);t[e]=i,yield r.value}else{let[e,i,r]=await Promise.race(n);t[e]=null,r.done||(t.push(i),yield r.value)}}catch(t){return Promise.reject(t)}}}finally{await close(t)}}()))}function zip(...t){return n((()=>async function*zipStreams(){try{for(;;){let n=pullFromStreams(t);if(!(n.length>0))return;try{let e=(await Promise.all(n)).reduce((function getStreamVals(n,e){var[i,r,o]=e;return o.done?(t[i]=null,n):(t[i]=r,[...n,o.value])}),[]);if(!(e.length>0))return;yield e}catch(t){return Promise.reject(t)}}}finally{await close(...t).run()}}()))}function pullFromStreams(t){return t.map((function callIter(n,i){return n&&e(n.next)?(t[i]=async function getNext(){var e=n.next();try{let r=await e;return t[i]=[i,n,r]}catch(n){return t[i]=null,e}}(),t[i]):n})).filter(Boolean)}function close(...t){return n((()=>Promise.all(t.map((async function closeStream(t){if(t&&e(t.return))try{return await t.return()}catch(t){}})))))}function getDeferred(){var t;return{pr:new Promise((n=>t=n)),next:t}}return r=IOEventStream=Object.assign(i(IOEventStream,2),{merge:merge,zip:zip,close:close}),r.merge=merge,r.zip=zip,r.close=close,r}],["AsyncEither",{"./lib/util.js":"MonioUtil","./either.js":"Either"},function DEF(t,n){"use strict";var{isFunction:e,isPromise:i}=t,r={};let o={};function AsyncRight(t){return AsyncEither(n.Right(t))}function AsyncEither(t){return fromPromise(i(t)?t:n.Left.is(t)?Promise.reject(t):Promise.resolve(t))}function fromPromise(t){t=splitPromise(t);var e={map:function map(n){var handle=t=>{var _doMap=n=>{var e=t.chain(n);return i(e)?splitPromise(e):t._is_right()?e:Promise.reject(e)};return i(n)?n.then(_doMap):_doMap(n)};return AsyncEither(t.then(handle,handle))},chain:chain,flatMap:chain,bind:chain,ap:function ap(n){return n.map(t)},concat:function concat(n){return n.map((n=>t.then((t=>t.concat(n)))))},fold:function fold(n,e){var handle=t=>n=>n.fold((n=>Promise.reject(t(n))),t);return t.then(handle(e),handle(n))},_inspect:function _inspect(){return`${e[Symbol.toStringTag]}(Promise)`},_is:function _is(t){return t===r},[Symbol.toStringTag]:"AsyncEither"};return e;function chain(e){var handle=t=>{var _doChain=e=>{var i=t.chain(e);return is(i)?i.fold((t=>t),(t=>t)):n.is(i)?i.fold((t=>Promise.reject(t)),(t=>t)):i};return i(e)?e.then(_doChain):_doChain(e)};return AsyncEither(t.then(handle,handle))}}function is(t){return t&&e(t._is)&&t._is(r)}function splitPromise(t){return t.then((t=>n.is(t)?t:n.Right(t)),(t=>Promise.reject(n.is(t)?t:n.Left(t))))}return o=Object.assign(AsyncEither,{Left:function AsyncLeft(t){return AsyncEither(n.Left(t))},Right:AsyncRight,of:AsyncRight,pure:AsyncRight,unit:AsyncRight,is:is,fromFoldable:function fromFoldable(t){return t.fold(AsyncEither.Left,AsyncEither.Right)},fromPromise:fromPromise}),o}],["Monio",{"./lib/util.js":"MonioUtil","./just.js":"Just","./nothing.js":"Nothing","./maybe.js":"Maybe","./either.js":"Either","./async-either.js":"AsyncEither","./io.js":"IO","./io-helpers.js":"IOHelpers","./io-event-stream.js":"IOEventStream"},function DEF(t,n,e,i,r,o,u,a,s){"use strict";let f={};return f.MonioUtil=t,f.Just=n,f.Nothing=e,f.Maybe=i,f.Either=r,f.AsyncEither=o,f.IO=u,f.RIO=u,f.Reader=u,f.IOHelpers=a,f.IOEventStream=s,f}]]);
!function(t){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],t):"object"==typeof module&&module.exports?t(require("./load-image"),require("./load-image-meta")):t(window.loadImage)}(function(t){"use strict";function u(){}function l(t,e,i,n,a){return"binary"===e.types[t]?new Blob([i.buffer.slice(n,n+a)]):"Uint16"===e.types[t]?i.getUint16(n):function(t,e,i){for(var n="",a=e+i,o=e;o<a;o+=1)n+=String.fromCharCode(t.getUint8(o));return n}(i,n,a)}function m(t,e,i,n,a,o){for(var r,s,f,p,c,d=e+i,g=e;g<d;)28===t.getUint8(g)&&2===t.getUint8(g+1)&&(f=t.getUint8(g+2),a&&!a[f]||o&&o[f]||(s=t.getInt16(g+3),r=l(f,n.iptc,t,g+5,s),n.iptc[f]=(p=n.iptc[f],c=r,void 0===p?c:p instanceof Array?(p.push(c),p):[p,c]),n.iptcOffsets&&(n.iptcOffsets[f]=g))),g+=1}u.prototype.map={ObjectName:5},u.prototype.types={0:"Uint16",200:"Uint16",201:"Uint16",202:"binary"},u.prototype.get=function(t){return this[t]||this[this.map[t]]},t.parseIptcData=function(t,e,i,n,a){if(!a.disableIptc)for(var o,r,s,f,p=e+i;e+8<p;){if(f=e,943868237===(s=t).getUint32(f)&&1028===s.getUint16(f+4)){var c=(o=e,r=void 0,(r=t.getUint8(o+7))%2!=0&&(r+=1),0===r&&(r=4),r),d=e+8+c;if(p<d){console.log("Invalid IPTC data: Invalid segment offset.");break}var g=t.getUint16(e+6+c);if(p<e+g){console.log("Invalid IPTC data: Invalid segment size.");break}return n.iptc=new u,a.disableIptcOffsets||(n.iptcOffsets=new u),void m(t,d,g,n,a.includeIptcTags,a.excludeIptcTags||{202:!0})}e+=1}},t.metaDataParsers.jpeg[65517].push(t.parseIptcData),t.IptcMap=u});
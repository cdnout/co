!function(e){e.fn.extend({liveUrl:function(t){var i={meta:[["description","name","description"],["description","property","og:description"],["description","property","pinterestapp:about"],["image","property","og:image"],["image","itemprop","image"],["title","property","og:title"],["video","property","og:video"],["video_type","property","og:video:type"],["video_width","property","og:video:width"],["video_height","property","og:video:height"]],findLogo:!1,findDescription:!0,matchNoData:!0,multipleImages:!0,defaultProtocol:"http://",minWidth:100,minHeight:32,logoWord:"logo",success:function(){},loadStart:function(){},loadEnd:function(){},imgLoadStart:function(){},imgLoadEnd:function(){},addImage:function(){}},t=e.extend(i,t);this.each(function(){var i=t,r={already:[]},a={};r.init=function(){r.preview=!1,a={url:"",images:[],image:"",title:"",description:""}},r.textUpdate=function(t){var i=e.urlHelper.getLinks(e(t).val());r.cleanDuplicates(i),null!=i&&(r.preview||(r.current=e(t),r.process(i)))},r.process=function(t){for(var n in t){var o=t[n];if("string"==typeof o){var s=new e.urlHelper.UriParser(o);if((s.subdomain&&s.subdomain.length>0||s.protocol&&s.protocol.length>0)&&(0==s.protocol.length&&(o=i.defaultProtocol+o),!r.isDuplicate(o,r.already)))return e.urlHelper.isImage(o)?(a.image=o,r.getPreview({},o)):r.getData(o),!0}}},r.cleanDuplicates=function(t){var i=r.createLinks(t);for(var a in r.already){var n=r.already[a];if(!r.isDuplicate(n,i)){var a=e.inArray(n,r.already);r.already.splice(a,1)}}},r.createLinks=function(t){var r=[];for(var a in t){var n=t[a];if("string"==typeof n){var o=new e.urlHelper.UriParser(n);(o.subdomain&&o.subdomain.length>0||o.protocol&&o.protocol.length>0)&&(0==o.protocol.length&&(n=i.defaultProtocol+n),r.push(n))}}return r},r.isDuplicate=function(t,i){var r=!1;return e.each(i,function(e,i){i==t&&(r=!0)}),r},r.getData=function(t){var i="//head|//body",a='select * from html where url="'+t+'" and compat="html5" and xpath="'+i+'"';r.addLoader(),e.yql(a,function(){var e={query:{results:null}};return r.ajaxSuccess(e,t),r.removeLoader(),!1},function(e){r.ajaxSuccess(e,t)})},r.ajaxSuccess=function(t,a){return r.isDuplicate(a,r.already)||r.preview?(r.removeLoader(),!1):void(0==e(t).find("results").text().length?i.matchNoData?r.getPreview(t,a):(r.already.push(a),r.removeLoader()):r.getPreview(t,a))},r.hasValue=function(e){return 0==a[e].length?!1:!0},r.getPreview=function(t,n){r.preview=!0,r.already.push(n);var o="";if(e(t,"<head>").find("title").each(function(){o=e(this).text()}),a.title=o||n,a.url=n,e(t,"<head>").find("meta").each(function(){r.setMetaData(e(this))}),i.findDescription&&!r.hasValue("description")&&e(t,"<body>").find("p").each(function(){var t=e.trim(e(this).text());return t.length>3?(a.description=t,!1):void 0}),!r.hasValue("image")){var s=e(t,"<body>").find("img");i.findLogo&&s.each(function(){var t=e(this);return t.attr("src")&&-1!=t.attr("src").search(i.logoWord,"i")||t.attr("id")&&-1!=t.attr("id").search(i.logoWord,"i")||this.className&&-1!=this.className.search(i.logoWord,"i")?(a.image=e(this).attr("src"),!1):void 0}),!r.hasValue("image")&&s.length>0&&s.each(function(){a.images.push(e(this).attr("src"))})}r.removeLoader();var l="undefined",t={title:a.title,description:a.description,url:a.url,video:typeof a.video!=l&&a.video.length>0?{}:null};null!=t.video&&(t.video={file:a.video,type:typeof a.video_type!=l?a.video_type:"",width:typeof a.video_width!=l?a.video_width:"",height:typeof a.video_height!=l?a.video_height:""}),i.success(t),r.hasValue("image")&&(a.images.push(a.image),a.image=""),r.addImages(),r.current.one("clear",function(){r.init()})},r.addLoader=function(){i.loadStart()},r.removeLoader=function(){i.loadEnd()},r.setMetaData=function(e){for(index in i.meta){var t=i.meta[index];a[t[0]]=r.getValue(e,t[1],t[2])||a[t[0]]}},r.getValue=function(e,t,i){return e.attr(t)&&e.attr(t).toLowerCase()==i.toLowerCase()&&e.attr("content")&&e.attr("content").length>0?e.attr("content"):void 0},r.addImages=function(){for(var t in a.images){var n=a.images[t];if(!e.urlHelper.isAbsolute(n)){var o=new e.urlHelper.UriParser(a.url),s=o.url+o.subdomain+o.domain;n=e.urlHelper.isPathAbsolute(n)?s+n:s+e.urlHelper.stripFile(o.path)+"/"+n}r.getImage(n,function(e){e.width>=i.minWidth&&e.height>=i.minHeight&&r.preview&&(i.addImage(e),!i.multipleImages)})}},r.getImage=function(t,i){var r=e.urlHelper.hasParam(t)?"&":"?";t+=r+"random="+(new Date).getTime(),e("<img />").attr({src:t}).load(function(){var e=this,t=window.setInterval(function(){e.width&&(window.clearInterval(t),i(e))},100)})},r.init();var n=this,o=e(this);o.on("keyup",function(t){var i=e.urlHelper.getLinks(e(o).val());r.cleanDuplicates(i),window.clearInterval(r.textTimer);var a=t.keyCode?t.keyCode:t.which;13==a||32==a?r.textUpdate(n):r.textTimer=window.setInterval(function(){r.textUpdate(n),window.clearInterval(r.textTimer)},1e3)}).on("paste",function(){r.textUpdate(n)})})}}),jQuery.yql=function t(i,r,a){var t={path:"http://query.yahooapis.com/v1/public/yql?q=",query:encodeURIComponent(i)},n=/msie/.test(navigator.userAgent.toLowerCase());if(n&&window.XDomainRequest){var o=new XDomainRequest;o.open("get",t.path+t.query),o.onload=function(){a(o.responseText)},o.send()}else e.ajax({crossDomain:!0,cache:!1,type:"GET",url:t.path+t.query,timeout:8e3,dataType:"xml",error:r,success:a})},jQuery.urlHelper={UriParser:function(e){this._regExp=/^((\w+):\/\/\/?)?((\w+):?(\w+)?@)?([^\/\?:]+)?(:\d+)?(.*)?/,this._regExpHost=/^(.+\.)?(.+\..+)$/,this._getVal=function(e,t){return e?"undefined"==typeof e[t]?"":e[t]:null},this.parse=function(e){var t=this._regExp.exec(e);this.results=t,this.url=this._getVal(t,1),this.protocol=this._getVal(t,2),this.username=this._getVal(t,4),this.password=this._getVal(t,5),this.domain=this._getVal(t,6),this.port=this._getVal(t,7),this.path=this._getVal(t,8);var i=this._regExpHost.exec(this.domain);return this.subdomain=this._getVal(i,1),this.domain=this._getVal(i,2),t},e&&this.parse(e)},getLinks:function(e){var t=/((https?:\/\/)?[\w-]+(\.[\w-]+)+\.?(:\d+)?(\/\S*)?)/gi;return e.match(t)},isImage:function(e,t){null==t&&(t="jpg|gif|png|jpeg");var i=/([^\s]+(?=\.(jpg|gif|png|jpeg))\.\2)/gm;return e.match(i)},isAbsolute:function(e){var t=/^(https?:)?\/\//i,i=null!=e.match(t)?!0:!1;return i},isPathAbsolute:function(e){return"/"==e.substr(0,1)?!0:void 0},hasParam:function(e){return-1==e.lastIndexOf("?")?!1:!0},stripFile:function(e){return e.substr(0,e.lastIndexOf("/")+1)}}}(jQuery);
"use strict";var rawAsap=require("./raw"),freeTasks=[],pendingErrors=[],requestErrorThrow=rawAsap.makeRequestCallFromTimer(throwFirstError);function throwFirstError(){if(pendingErrors.length)throw pendingErrors.shift()}function asap(r){var s=freeTasks.length?freeTasks.pop():new RawTask;s.task=r,rawAsap(s)}function RawTask(){this.task=null}module.exports=asap,RawTask.prototype.call=function(){try{this.task.call()}catch(r){asap.onerror?asap.onerror(r):(pendingErrors.push(r),requestErrorThrow())}finally{this.task=null,freeTasks[freeTasks.length]=this}};
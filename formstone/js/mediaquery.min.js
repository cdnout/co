!function(e){"function"==typeof define&&define.amd?define(["jquery","./core"],e):e(jQuery,Formstone)}(function(a,e){"use strict";function o(){!function(){for(var e in r={unit:m.unit},u)if(u.hasOwnProperty(e))for(var t in l[e]){var n,i;l[e].hasOwnProperty(t)&&(n="Infinity"===t?1/0:parseInt(t,10),i=-1<e.indexOf("max"),l[e][t].matches&&(i?(!r[e]||n<r[e])&&(r[e]=n):(!r[e]||n>r[e])&&(r[e]=n)))}}(),n.trigger(c.mqChange,[r])}function s(e){var t=h(e.media),n=v[t],e=e.matches,i=e?c.enter:c.leave;if(n&&(n.active||!n.active&&e)){for(var r in n[i])n[i].hasOwnProperty(r)&&n[i][r].apply(n.mq);n.active=!0}}function h(e){return e.replace(/[^a-z0-9\s]/gi,"").replace(/[_\s]/g,"").replace(/^\s+|\s+$/g,"")}var t=e.Plugin("mediaquery",{utilities:{_initialize:function(e){for(var t in e=e||{},u)u.hasOwnProperty(t)&&(m[t]=e[t]?a.merge(e[t],m[t]):m[t]);for(var n in(m=a.extend(m,e)).minWidth.sort(f.sortDesc),m.maxWidth.sort(f.sortAsc),m.minHeight.sort(f.sortDesc),m.maxHeight.sort(f.sortAsc),u)if(u.hasOwnProperty(n))for(var i in l[n]={},m[n]){var r;m[n].hasOwnProperty(i)&&((r=window.matchMedia("("+u[n]+": "+(m[n][i]===1/0?1e5:m[n][i])+m.unit+")")).addListener(o),l[n][m[n][i]]=r)}o()},state:function(){return r},bind:function(e,t,n){var i,r=d.matchMedia(t),a=h(r.media);for(i in v[a]||(v[a]={mq:r,active:!0,enter:{},leave:{}},v[a].mq.addListener(s)),n)n.hasOwnProperty(i)&&v[a].hasOwnProperty(i)&&(v[a][i][e]=n[i]);var o=v[a];(t=r.matches)&&o[c.enter].hasOwnProperty(e)?(o[c.enter][e].apply(r),o.active=!0):!t&&o[c.leave].hasOwnProperty(e)&&(o[c.leave][e].apply(r),o.active=!1)},unbind:function(e,t){if(e)if(t){t=h(t);v[t]&&(v[t].enter[e]&&delete v[t].enter[e],v[t].leave[e]&&delete v[t].leave[e])}else for(var n in v)v.hasOwnProperty(n)&&(v[n].enter[e]&&delete v[n].enter[e],v[n].leave[e]&&delete v[n].leave[e])}},events:{mqChange:"mqchange"}}),m={minWidth:[0],maxWidth:[1/0],minHeight:[0],maxHeight:[1/0],unit:"px"},c=a.extend(t.events,{enter:"enter",leave:"leave"}),n=e.$window,d=n[0],f=t.functions,r=null,v=[],l={},u={minWidth:"min-width",maxWidth:"max-width",minHeight:"min-height",maxHeight:"max-height"}});
!function(t){"function"==typeof define&&define.amd?define(["jquery","./core","./touch"],t):t(jQuery,Formstone)}(function(i,t){"use strict";function e(t){t.$el.addClass(g.isSetup);var n={},e={},o={},a=0,i=!0;o=t.horizontal?(t.barHeight=t.$content[0].offsetHeight-t.$content[0].clientHeight,t.frameWidth=t.$content.outerWidth(),t.trackWidth=t.frameWidth-2*t.trackMargin,t.scrollWidth=t.$content[0].scrollWidth,t.ratio=t.trackWidth/t.scrollWidth,t.trackRatio=t.trackWidth/t.scrollWidth,t.handleWidth=0<t.handleSize?t.handleSize:t.trackWidth*t.trackRatio,t.scrollRatio=(t.scrollWidth-t.frameWidth)/(t.trackWidth-t.handleWidth),t.handleBounds={left:0,right:t.trackWidth-t.handleWidth},t.$content.css({paddingBottom:t.barHeight+t.paddingBottom}),a=t.$content.scrollLeft()*t.ratio,i=t.scrollWidth<=t.frameWidth,n={width:t.frameWidth},e={width:t.trackWidth,marginLeft:t.trackMargin,marginRight:t.trackMargin},{width:t.handleWidth}):(t.barWidth=t.$content[0].offsetWidth-t.$content[0].clientWidth,t.frameHeight=t.$content.outerHeight(),t.trackHeight=t.frameHeight-2*t.trackMargin,t.scrollHeight=t.$content[0].scrollHeight,t.ratio=t.trackHeight/t.scrollHeight,t.trackRatio=t.trackHeight/t.scrollHeight,t.handleHeight=0<t.handleSize?t.handleSize:t.trackHeight*t.trackRatio,t.scrollRatio=(t.scrollHeight-t.frameHeight)/(t.trackHeight-t.handleHeight),t.handleBounds={top:0,bottom:t.trackHeight-t.handleHeight},a=t.$content.scrollTop()*t.ratio,i=t.scrollHeight<=t.frameHeight,n={height:t.frameHeight},e={height:t.trackHeight,marginBottom:t.trackMargin,marginTop:t.trackMargin},{height:t.handleHeight}),i?t.$el.removeClass(g.active):t.$el.addClass(g.active),t.$bar.css(n),t.$track.css(e),t.$handle.css(o),t.panning=!1,s(t,a),l({data:t}),t.$el.removeClass(g.setup)}function l(t){p.killEvent(t);var n,e=t.data,t={};e.panning||(t=e.horizontal?((n=e.$content.scrollLeft())<0&&(n=0),e.handleLeft=n/e.scrollRatio,e.handleLeft>e.handleBounds.right&&(e.handleLeft=e.handleBounds.right),{left:e.handleLeft}):((n=e.$content.scrollTop())<0&&(n=0),e.handleTop=n/e.scrollRatio,e.handleTop>e.handleBounds.bottom&&(e.handleTop=e.handleBounds.bottom),{top:e.handleTop}),e.$handle.css(t))}function o(t){a(t,!0)}function a(t,n){var e,o=t.data;if(o.horizontal){var a=o.$content[0].scrollLeft,i=o.$content[0].scrollWidth,l=o.$content.outerWidth(),r=t.originalEvent.deltaX*(!0===n?-1:1);return!0===n?(o.$content.scrollLeft(a-r),c(t)):"left"===(e=r<0?"right":"left")&&i-l-a<r?(o.$content.scrollLeft(i),c(t)):"right"===e&&a<-r?(o.$content.scrollLeft(0),c(t)):void 0}l=o.$content[0].scrollTop,i=o.$content[0].scrollHeight,a=o.$content.outerHeight();return r=t.originalEvent.deltaY*(!0===n?-1:1),!0===n?(o.$content.scrollTop(l-r),c(t)):"down"===(e=r<0?"up":"down")&&i-a-l<r?(o.$content.scrollTop(i),c(t)):"up"===e&&l<-r?(o.$content.scrollTop(0),c(t)):void 0}function c(t){return p.killEvent(t),t.returnValue=!1}function r(t){var n=t.data,e=n.$track.offset();n.panning=!0,e=n.horizontal?n.handleLeft=t.pageX-e.left-n.handleWidth/2:n.handleTop=t.pageY-e.top-n.handleHeight/2,s(n,e)}function h(t){var n=t.data,t=n.horizontal?n.handleLeft+t.deltaX:n.handleTop+t.deltaY;s(n,t)}function d(t){var n=t.data;n.panning=!1,n.horizontal?n.handleLeft+=t.deltaX:n.handleTop+=t.deltaY}function s(t,n){var e={};t.horizontal?(n<t.handleBounds.left&&(n=t.handleBounds.left),n>t.handleBounds.right&&(n=t.handleBounds.right),e={left:n},t.$content.scrollLeft(Math.round(n*t.scrollRatio))):(n<t.handleBounds.top&&(n=t.handleBounds.top),n>t.handleBounds.bottom&&(n=t.handleBounds.bottom),e={top:n},t.$content.scrollTop(Math.round(n*t.scrollRatio))),t.$handle.css(e)}var n=t.Plugin("scrollbar",{widget:!0,defaults:{customClass:"",duration:0,handleSize:0,horizontal:!1,mouseWheel:!0,theme:"fs-light",trackMargin:0},classes:["content","bar","track","handle","horizontal","setup","active"],methods:{_construct:function(t){var n="";n+='<div class="'+g.bar+'">',n+='<div class="'+g.track+'">',n+='<button type="button" class="'+g.handle+'" aria-hidden="true" tabindex="-1"></button>',n+="</div></div>",t.paddingRight=parseInt(this.css("padding-right"),10),t.paddingBottom=parseInt(this.css("padding-bottom"),10),t.thisClasses=[g.base,t.theme,t.customClass,t.horizontal?g.horizontal:""],this.addClass(t.thisClasses.join(" ")).wrapInner('<div class="'+g.content+'" tabindex="0"></div>').prepend(n),t.$content=this.find(f.content),t.$bar=this.find(f.bar),t.$track=this.find(f.track),t.$handle=this.find(f.handle),t.trackMargin=parseInt(t.trackMargin,10),t.$content.on(u.scroll,t,l),t.mouseWheel&&t.$content.on("wheel"+u.namespace,t,a),t.$track.fsTouch({axis:t.horizontal?"x":"y",pan:!0}).on(u.panStart,t,r).on(u.pan,t,h).on(u.panEnd,t,d).on(u.click,p.killEvent).on("wheel"+u.namespace,t,o),e(t),$=i(f.base)},_destruct:function(t){t.$track.fsTouch("destroy"),t.$bar.remove(),t.$content.off(u.namespace).contents().unwrap(),this.removeClass(t.thisClasses.join(" ")).off(u.namespace),this.attr("id")===t.rawGuid&&this.removeAttr("id")},_resize:function(t){p.iterate.call($,e)},scroll:function(t,n,e){var o=e||t.duration,a={};"number"!=typeof n&&(n=0<(e=i(n)).length?(e=e.position(),t.horizontal?e.left+t.$content.scrollLeft():e.top+t.$content.scrollTop()):"top"===n?0:"bottom"===n?t.horizontal?t.$content[0].scrollWidth:t.$content[0].scrollHeight:t.$content.scrollTop()),a[t.horizontal?"scrollLeft":"scrollTop"]=n,t.$content.stop().animate(a,o)},resize:e}}),f=n.classes,g=f.raw,u=n.events,p=n.functions,$=(t.$window,[]);t.Ready(function(){t.$body})});
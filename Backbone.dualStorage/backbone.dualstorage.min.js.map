{"version":3,"sources":["./backbone.dualstorage.js"],"names":["S4","backboneSync","callbackTranslator","dualsync","getStoreName","localsync","modelUpdatedWithResponse","onlineSync","parseRemoteResponse","indexOf","item","i","l","this","length","Backbone","DualStorage","offlineStatusCodes","Model","prototype","hasTempId","_","isString","id","collection","model","result","Collection","syncDirty","options","ids","len","ref","results","store","localStorage","getItem","split","push","get","save","dirtyModels","models","call","compact","syncDestroyed","set","idAttribute","destroy","destroyedModelIds","syncDirtyAndDestroyed","Math","random","toString","substring","window","Store","name","records","recordsOn","sep","generateId","setItem","join","key","dirty","dirtyRecords","include","clean","from","without","destroyed","destroyedRecords","create","isObject","JSON","stringify","toJSON","update","clear","removeItem","hasDirtyOrDestroyed","isEmpty","find","modelAsJson","parse","findAll","reject","record_id","exists","storeName","needsTranslation","VERSION","forBackboneCaller","callback","resp","forDualstorageCaller","method","isValidModel","preExisting","response","Error","add","merge","attributes","ignoreCallbacks","success","error","object","parseBeforeLocalSave","isFunction","modelClone","originalSync","sync","hasOfflineStatusCode","local","relayErrorCallback","temporaryId","useOfflineStorage","storeExists","remote","xhr","status","online","_status","_xhr","modelAttributes","responseModel","updatedModel","silent"],"mappings":"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","file":"./backbone.dualstorage.min.js"}
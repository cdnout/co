{"version":3,"sources":["./backbone.dualstorage.amd.js"],"names":["root","factory","define","amd","require","module","exports","Backbone","this","S4","backboneSync","callbackTranslator","dualsync","getStoreName","localsync","modelUpdatedWithResponse","onlineSync","parseRemoteResponse","indexOf","item","i","l","length","DualStorage","offlineStatusCodes","Model","prototype","hasTempId","_","isString","id","collection","model","result","Collection","syncDirty","options","ids","len","ref","results","store","localStorage","getItem","split","push","get","save","dirtyModels","models","call","compact","syncDestroyed","set","idAttribute","destroy","destroyedModelIds","syncDirtyAndDestroyed","Math","random","toString","substring","window","Store","name","records","recordsOn","sep","generateId","setItem","join","key","dirty","dirtyRecords","include","clean","from","without","destroyed","destroyedRecords","create","isObject","JSON","stringify","toJSON","update","clear","removeItem","hasDirtyOrDestroyed","isEmpty","find","modelAsJson","parse","findAll","reject","record_id","exists","storeName","needsTranslation","VERSION","forBackboneCaller","callback","resp","forDualstorageCaller","method","isValidModel","preExisting","response","Error","add","merge","attributes","ignoreCallbacks","success","error","object","parseBeforeLocalSave","isFunction","modelClone","originalSync","sync","hasOfflineStatusCode","local","relayErrorCallback","temporaryId","useOfflineStorage","storeExists","remote","xhr","status","online","_status","_xhr","modelAttributes","responseModel","updatedModel","silent"],"mappings":"CAAA,SAAUA,EAAMC,GACd,GAAsB,kBAAXC,SAAyBA,OAAOC,IACzCD,QAAQ,YAAaD,OAChB,CAAA,GAAuB,kBAAZG,UAA2G,OAA7D,mBAAXC,SAAqC,OAAXA,OAAkBA,OAAOC,QAAU,QAChH,MAAOD,QAAOC,QAAUL,EAAQG,QAAQ,YAExCH,GAAQD,EAAKO,YAEdC,KAAM,SAASD,GAUlB,GAAIE,GAAIC,EAAcC,EAAoBC,EAAUC,EAAcC,EAAWC,EAA0BC,EAAYC,EACjHC,KAAaA,SAAW,SAASC,GAAQ,IAAK,GAAIC,GAAI,EAAGC,EAAIb,KAAKc,OAAYD,EAAJD,EAAOA,IAAO,GAAIA,IAAKZ,OAAQA,KAAKY,KAAOD,EAAM,MAAOC,EAAK,OAAO,GAEhJb,GAASgB,aACPC,oBAAqB,IAAK,MAG5BjB,EAASkB,MAAMC,UAAUC,UAAY,WACnC,MAAOC,GAAEC,SAASrB,KAAKsB,KAA0B,KAAnBtB,KAAKsB,GAAGR,QAA0C,IAAzBd,KAAKsB,GAAGZ,QAAQ,MAGzEL,EAAe,SAASkB,EAAYC,GAElC,MADAA,KAAUA,EAAQD,EAAWC,MAAMN,WAC5BE,EAAEK,OAAOF,EAAY,cAAgBH,EAAEK,OAAOD,EAAO,cAAgBJ,EAAEK,OAAOF,EAAY,QAAUH,EAAEK,OAAOD,EAAO,YAAcJ,EAAEK,OAAOD,EAAO,QAG3JzB,EAAS2B,WAAWR,UAAUS,UAAY,SAASC,GACjD,GAAIhB,GAAGU,EAAIO,EAAKC,EAAKC,EAAKC,EAASC,CAInC,KAHAA,EAAQC,aAAaC,QAAS9B,EAAaL,MAAS,UACpD6B,EAAOI,GAASA,EAAMG,MAAM,SAC5BJ,KACKpB,EAAI,EAAGkB,EAAMD,EAAIf,OAAYgB,EAAJlB,EAASA,IACrCU,EAAKO,EAAIjB,GACToB,EAAQK,KAA6B,OAAvBN,EAAM/B,KAAKsC,IAAIhB,IAAeS,EAAIQ,KAAK,KAAMX,GAAW,OAExE,OAAOI,IAGTjC,EAAS2B,WAAWR,UAAUsB,YAAc,WAC1C,GAAIlB,GAAIO,EAAKY,EAAQR,CAYrB,OAXAA,GAAQC,aAAaC,QAAS9B,EAAaL,MAAS,UACpD6B,EAAOI,GAASA,EAAMG,MAAM,SAC5BK,EAAS,WACP,GAAI7B,GAAGkB,EAAKE,CAEZ,KADAA,KACKpB,EAAI,EAAGkB,EAAMD,EAAIf,OAAYgB,EAAJlB,EAASA,IACrCU,EAAKO,EAAIjB,GACToB,EAAQK,KAAKrC,KAAKsC,IAAIhB,GAExB,OAAOU,IACNU,KAAK1C,MACDoB,EAAEuB,QAAQF,IAGnB1C,EAAS2B,WAAWR,UAAU0B,cAAgB,SAAShB,GACrD,GAAIhB,GAAGU,EAAIO,EAAKC,EAAKN,EAAOQ,EAASC,CAIrC,KAHAA,EAAQC,aAAaC,QAAS9B,EAAaL,MAAS,cACpD6B,EAAOI,GAASA,EAAMG,MAAM,SAC5BJ,KACKpB,EAAI,EAAGkB,EAAMD,EAAIf,OAAYgB,EAAJlB,EAASA,IACrCU,EAAKO,EAAIjB,GACTY,EAAQ,GAAIxB,MAAKwB,MACjBA,EAAMqB,IAAIrB,EAAMsB,YAAaxB,GAC7BE,EAAMD,WAAavB,KACnBgC,EAAQK,KAAKb,EAAMuB,QAAQnB,GAE7B,OAAOI,IAGTjC,EAAS2B,WAAWR,UAAU8B,kBAAoB,WAChD,GAAInB,GAAKI,CAET,OADAA,GAAQC,aAAaC,QAAS9B,EAAaL,MAAS,cAC7C6B,EAAOI,GAASA,EAAMG,MAAM,UAGrCrC,EAAS2B,WAAWR,UAAU+B,sBAAwB,SAASrB,GAE7D,MADA5B,MAAK2B,UAAUC,GACR5B,KAAK4C,cAAchB,IAG5B3B,EAAK,WACH,OAA+B,OAArB,EAAIiD,KAAKC,UAAuB,GAAGC,SAAS,IAAIC,UAAU,IAGtEC,OAAOC,MAAQ,WAGb,QAASA,GAAMC,GACbxD,KAAKwD,KAAOA,EACZxD,KAAKyD,QAAUzD,KAAK0D,UAAU1D,KAAKwD,MAiHrC,MArHAD,GAAMrC,UAAUyC,IAAM,GAOtBJ,EAAMrC,UAAU0C,WAAa,WAC3B,MAAO,IAAM3D,IAAKoD,UAAU,GAAKpD,IAAO,IAAMA,IAAO,IAAMA,IAAO,IAAMA,IAAO,IAAMA,IAAOA,IAAOA,KAGrGsD,EAAMrC,UAAUqB,KAAO,WACrB,MAAOL,cAAa2B,QAAQ7D,KAAKwD,KAAMxD,KAAKyD,QAAQK,KAAK,OAG3DP,EAAMrC,UAAUwC,UAAY,SAASK,GACnC,GAAI9B,EAEJ,OADAA,GAAQC,aAAaC,QAAQ4B,GACrB9B,GAASA,EAAMG,MAAM,UAG/BmB,EAAMrC,UAAU8C,MAAQ,SAASxC,GAC/B,GAAIyC,EAMJ,OALAA,GAAejE,KAAK0D,UAAU1D,KAAKwD,KAAO,UACrCpC,EAAE8C,QAAQD,EAAczC,EAAMF,GAAG8B,cACpCa,EAAa5B,KAAKb,EAAMF,IACxBY,aAAa2B,QAAQ7D,KAAKwD,KAAO,SAAUS,EAAaH,KAAK,OAExDtC,GAGT+B,EAAMrC,UAAUiD,MAAQ,SAAS3C,EAAO4C,GACtC,GAAIH,GAAchC,CAMlB,OALAA,GAAQjC,KAAKwD,KAAO,IAAMY,EAC1BH,EAAejE,KAAK0D,UAAUzB,GAC1Bb,EAAE8C,QAAQD,EAAczC,EAAMF,GAAG8B,aACnClB,aAAa2B,QAAQ5B,EAAOb,EAAEiD,QAAQJ,EAAczC,EAAMF,GAAG8B,YAAYU,KAAK,MAEzEtC,GAGT+B,EAAMrC,UAAUoD,UAAY,SAAS9C,GACnC,GAAI+C,EAMJ,OALAA,GAAmBvE,KAAK0D,UAAU1D,KAAKwD,KAAO,cACzCpC,EAAE8C,QAAQK,EAAkB/C,EAAMF,GAAG8B,cACxCmB,EAAiBlC,KAAKb,EAAMF,IAC5BY,aAAa2B,QAAQ7D,KAAKwD,KAAO,aAAce,EAAiBT,KAAK,OAEhEtC,GAGT+B,EAAMrC,UAAUsD,OAAS,SAAShD,EAAOI,GACvC,MAAKR,GAAEqD,SAASjD,IAGXA,EAAMF,IACTE,EAAMqB,IAAIrB,EAAMsB,YAAa9C,KAAK4D,cAEpC1B,aAAa2B,QAAQ7D,KAAKwD,KAAOxD,KAAK2D,IAAMnC,EAAMF,GAAIoD,KAAKC,UAAUnD,EAAMoD,OAASpD,EAAMoD,OAAOhD,GAAWJ,IAC5GxB,KAAKyD,QAAQpB,KAAKb,EAAMF,GAAG8B,YAC3BpD,KAAKuC,OACEf,GAREA,GAWX+B,EAAMrC,UAAU2D,OAAS,SAASrD,EAAOI,GAMvC,MALAM,cAAa2B,QAAQ7D,KAAKwD,KAAOxD,KAAK2D,IAAMnC,EAAMF,GAAIoD,KAAKC,UAAUnD,EAAMoD,OAASpD,EAAMoD,OAAOhD,GAAWJ,IACvGJ,EAAE8C,QAAQlE,KAAKyD,QAASjC,EAAMF,GAAG8B,aACpCpD,KAAKyD,QAAQpB,KAAKb,EAAMF,GAAG8B,YAE7BpD,KAAKuC,OACEf,GAGT+B,EAAMrC,UAAU4D,MAAQ,WACtB,GAAIlE,GAAGU,EAAIQ,EAAKC,CAEhB,KADAA,EAAM/B,KAAKyD,QACN7C,EAAI,EAAGkB,EAAMC,EAAIjB,OAAYgB,EAAJlB,EAASA,IACrCU,EAAKS,EAAInB,GACTsB,aAAa6C,WAAW/E,KAAKwD,KAAOxD,KAAK2D,IAAMrC,EAGjD,OADAtB,MAAKyD,WACEzD,KAAKuC,QAGdgB,EAAMrC,UAAU8D,oBAAsB,WACpC,OAAQ5D,EAAE6D,QAAQ/C,aAAaC,QAAQnC,KAAKwD,KAAO,aAAepC,EAAE6D,QAAQ/C,aAAaC,QAAQnC,KAAKwD,KAAO,gBAG/GD,EAAMrC,UAAUgE,KAAO,SAAS1D,GAC9B,GAAI2D,EAEJ,OADAA,GAAcjD,aAAaC,QAAQnC,KAAKwD,KAAOxD,KAAK2D,IAAMnC,EAAMF,IAC5C,OAAhB6D,EACK,KAEFT,KAAKU,MAAMD,IAGpB5B,EAAMrC,UAAUmE,QAAU,WACxB,GAAIzE,GAAGU,EAAIQ,EAAKC,EAAKC,CAGrB,KAFAD,EAAM/B,KAAKyD,QACXzB,KACKpB,EAAI,EAAGkB,EAAMC,EAAIjB,OAAYgB,EAAJlB,EAASA,IACrCU,EAAKS,EAAInB,GACToB,EAAQK,KAAKqC,KAAKU,MAAMlD,aAAaC,QAAQnC,KAAKwD,KAAOxD,KAAK2D,IAAMrC,IAEtE,OAAOU,IAGTuB,EAAMrC,UAAU6B,QAAU,SAASvB,GAMjC,MALAU,cAAa6C,WAAW/E,KAAKwD,KAAOxD,KAAK2D,IAAMnC,EAAMF,IACrDtB,KAAKyD,QAAUrC,EAAEkE,OAAOtF,KAAKyD,QAAS,SAAS8B,GAC7C,MAAOA,KAAc/D,EAAMF,GAAG8B,aAEhCpD,KAAKuC,OACEf,GAGF+B,KAITD,OAAOC,MAAMiC,OAAS,SAASC,GAC7B,MAA2C,QAApCvD,aAAaC,QAAQsD,IAG9BtF,GACEuF,iBAAuC,WAArB3F,EAAS4F,QAC3BC,kBAAmB,SAASC,GAC1B,MAAI7F,MAAK0F,iBACA,SAASlE,EAAOsE,EAAMlE,GAC3B,MAAOiE,GAASnD,KAAK,KAAMoD,IAGtBD,GAGXE,qBAAsB,SAASF,EAAUrE,EAAOI,GAC9C,MAAI5B,MAAK0F,iBACA,SAASI,GACd,MAAOD,GAASnD,KAAK,KAAMlB,EAAOsE,EAAMlE,IAGnCiE,IAKbvF,EAAY,SAAS0F,EAAQxE,EAAOI,GAClC,GAAIqE,GAAcC,EAAaC,EAAUlE,CAIzC,IAHAgE,EAA2B,UAAXD,GAAmC,wBAAXA,EACxCC,IAAiBA,EAAezE,YAAiBzB,GAASkB,OAC1DgF,IAAiBA,EAAezE,YAAiBzB,GAAS2B,aACrDuE,EACH,KAAM,IAAIG,OAAM,oEA+DlB,OA7DAnE,GAAQ,GAAIsB,OAAM3B,EAAQ6D,WAC1BU,EAAW,WACT,OAAQH,GACN,IAAK,OACH,MAAIxE,aAAiBzB,GAASkB,MACrBgB,EAAMiD,KAAK1D,GAEXS,EAAMoD,SAGjB,KAAK,sBACH,MAAOpD,GAAM+C,qBACf,KAAK,QACH,MAAO/C,GAAM6C,OACf,KAAK,SACH,MAAIlD,GAAQyE,MAAQzE,EAAQ0E,QAAUJ,EAAcjE,EAAMiD,KAAK1D,IACtD0E,GAEP1E,EAAQS,EAAMuC,OAAOhD,EAAOI,GACxBA,EAAQoC,OACV/B,EAAM+B,MAAMxC,GAEPA,EAGX,KAAK,SAEH,MADAS,GAAM4C,OAAOrD,EAAOI,GAChBA,EAAQoC,MACH/B,EAAM+B,MAAMxC,GAEZS,EAAMkC,MAAM3C,EAAO,QAG9B,KAAK,SAEH,MADAS,GAAMc,QAAQvB,GACVI,EAAQoC,QAAUxC,EAAML,YACnBc,EAAMqC,UAAU9C,GAEnBA,EAAML,YACDc,EAAMkC,MAAM3C,EAAO,SAEnBS,EAAMkC,MAAM3C,EAAO,iBAKhC2E,IACEA,EAASvB,SACXuB,EAAWA,EAASvB,OAAOhD,IAEzBuE,EAASI,aACXJ,EAAWA,EAASI,aAGnB3E,EAAQ4E,kBACPL,EACFvE,EAAQ6E,QAAQN,GAEhBvE,EAAQ8E,MAAM,qBAGXP,GAGT1F,EAAsB,SAASkG,EAAQR,GACrC,MAAMQ,IAAUA,EAAOC,qBAGnBxF,EAAEyF,WAAWF,EAAOC,sBACfD,EAAOC,qBAAqBT,GADrC,OAFSA,GAOX5F,EAA2B,SAASiB,EAAO2E,GACzC,GAAIW,EAKJ,OAJAA,GAAa,GAAI/G,GAASkB,MAC1B6F,EAAWhE,YAActB,EAAMsB,YAC/BgE,EAAWjE,IAAIrB,EAAM+E,YACrBO,EAAWjE,IAAIrB,EAAM4D,MAAMe,IACpBW,GAGT5G,EAAeH,EAASgB,YAAYgG,aAAehH,EAASiH,KAE5DxG,EAAa,SAASwF,EAAQxE,EAAOI,GAGnC,MAFAA,GAAQ6E,QAAUtG,EAAmByF,kBAAkBhE,EAAQ6E,SAC/D7E,EAAQ8E,MAAQvG,EAAmByF,kBAAkBhE,EAAQ8E,OACtD3G,EAASgB,YAAYgG,aAAaf,EAAQxE,EAAOI,IAG1DxB,EAAW,SAAS4F,EAAQxE,EAAOI,GACjC,GAAI8E,GAAOO,EAAsBC,EAAOC,EAAoBV,EAASW,EAAaC,CAKlF,IAJAzF,EAAQ6D,UAAYpF,EAAamB,EAAMD,WAAYC,GACnDI,EAAQ0F,YAAc/D,MAAMiC,OAAO5D,EAAQ6D,WAC3C7D,EAAQ6E,QAAUtG,EAAmB4F,qBAAqBnE,EAAQ6E,QAASjF,EAAOI,GAClFA,EAAQ8E,MAAQvG,EAAmB4F,qBAAqBnE,EAAQ8E,MAAOlF,EAAOI,GAC1ER,EAAEK,OAAOD,EAAO,WAAaJ,EAAEK,OAAOD,EAAMD,WAAY,UAC1D,MAAOf,GAAWwF,EAAQxE,EAAOI,EAInC,IAFAsF,EAAQ9F,EAAEK,OAAOD,EAAO,UAAYJ,EAAEK,OAAOD,EAAMD,WAAY,SAC/DK,EAAQoC,MAAQpC,EAAQ2F,UAAW,IAAUL,EACzCtF,EAAQ2F,UAAW,GAASL,EAC9B,MAAO5G,GAAU0F,EAAQxE,EAAOI,EA6BlC,QA3BAA,EAAQ4E,iBAAkB,EAC1BC,EAAU7E,EAAQ6E,QAClBC,EAAQ9E,EAAQ8E,MAChBW,EAAoB,WAKlB,MAJAzF,GAAQoC,OAAQ,EAChBpC,EAAQ4E,iBAAkB,EAC1B5E,EAAQ6E,QAAUA,EAClB7E,EAAQ8E,MAAQA,EACTpG,EAAU0F,EAAQxE,EAAOI,IAElCqF,EAAuB,SAASO,GAC9B,GAAIxG,GAAoBe,CAKxB,OAJAf,GAAqBjB,EAASgB,YAAYC,mBACtCI,EAAEyF,WAAW7F,KACfA,EAAqBA,EAAmBwG,IAEpB,IAAfA,EAAIC,SAAiB1F,EAAMyF,EAAIC,OAAQ/G,EAAQgC,KAAK1B,EAAoBe,IAAQ,IAEzFoF,EAAqB,SAASK,GAC5B,GAAIE,EAEJ,OADAA,IAAUT,EAAqBO,GAC3BE,GAAqB,SAAX1B,IAAsBpE,EAAQ0F,YACnCZ,EAAMc,GAENH,KAGHrB,GACN,IAAK,OACH,MAAI1F,GAAU,sBAAuBkB,EAAOI,GACnCyF,KAEPzF,EAAQ6E,QAAU,SAASX,EAAM6B,EAASC,GACxC,GAAIrG,GAAYX,EAAGkC,EAAahB,EAAK+F,EAAiBC,CACtD,IAAIb,EAAqBrF,EAAQ4F,KAC/B,MAAOH,IAGT,IADAvB,EAAOrF,EAAoBe,EAAOsE,GAC9BtE,YAAiBzB,GAAS2B,WAM5B,IALAH,EAAaC,EACbsB,EAAcvB,EAAWC,MAAMN,UAAU4B,YACpClB,EAAQyE,KACX/F,EAAU,QAASiB,EAAYK,GAE5BhB,EAAI,EAAGkB,EAAMgE,EAAKhF,OAAYgB,EAAJlB,EAASA,IACtCiH,EAAkB/B,EAAKlF,GACvBY,EAAQD,EAAWe,IAAIuF,EAAgB/E,IAErCgF,EADEtG,EACcjB,EAAyBiB,EAAOqG,GAEhC,GAAItG,GAAWC,MAAMqG,GAEvCvH,EAAU,SAAUwH,EAAelG,OAGrCkG,GAAgBvH,EAAyBiB,EAAOsE,GAChDxF,EAAU,SAAUwH,EAAelG,EAErC,OAAO6E,GAAQX,EAAM6B,EAASC,IAEhChG,EAAQ8E,MAAQ,SAASc,GACvB,MAAOL,GAAmBK,IAErB5F,EAAQ4F,IAAMhH,EAAWwF,EAAQxE,EAAOI,GAGnD,KAAK,SAaH,MAZAA,GAAQ6E,QAAU,SAASX,EAAM6B,EAASC,GACxC,GAAIG,EACJ,OAAId,GAAqBrF,EAAQ4F,KACxBH,KAETU,EAAexH,EAAyBiB,EAAOsE,GAC/CxF,EAAU0F,EAAQ+B,EAAcnG,GACzB6E,EAAQX,EAAM6B,EAASC,KAEhChG,EAAQ8E,MAAQ,SAASc,GACvB,MAAOL,GAAmBK,IAErB5F,EAAQ4F,IAAMhH,EAAWwF,EAAQxE,EAAOI,EACjD,KAAK,SACH,MAAIJ,GAAML,aACRiG,EAAc5F,EAAMF,GACpBM,EAAQ6E,QAAU,SAASX,EAAM6B,EAASC,GACxC,GAAIG,EAIJ,OAHAvG,GAAMqB,IAAIrB,EAAMsB,YAAasE,GAC3BY,QAAQ,IAENf,EAAqBrF,EAAQ4F,KACxBH,KAETU,EAAexH,EAAyBiB,EAAOsE,GAC/CxF,EAAU,SAAUkB,EAAOI,GAC3BtB,EAAU,SAAUyH,EAAcnG,GAC3B6E,EAAQX,EAAM6B,EAASC,KAEhChG,EAAQ8E,MAAQ,SAASc,GAIvB,MAHAhG,GAAMqB,IAAIrB,EAAMsB,YAAasE,GAC3BY,QAAQ,IAEHb,EAAmBK,IAE5BhG,EAAMqB,IAAIrB,EAAMsB,YAAa,MAC3BkF,QAAQ,IAEHpG,EAAQ4F,IAAMhH,EAAW,SAAUgB,EAAOI,KAEjDA,EAAQ6E,QAAU,SAASX,EAAM6B,EAASC,GACxC,GAAIG,EACJ,OAAId,GAAqBrF,EAAQ4F,KACxBH,KAETU,EAAexH,EAAyBiB,EAAOsE,GAC/CxF,EAAU0F,EAAQ+B,EAAcnG,GACzB6E,EAAQX,EAAM6B,EAASC,KAEhChG,EAAQ8E,MAAQ,SAASc,GACvB,MAAOL,GAAmBK,IAErB5F,EAAQ4F,IAAMhH,EAAWwF,EAAQxE,EAAOI,GAGnD,KAAK,SACH,MAAIJ,GAAML,aACRS,EAAQ4E,iBAAkB,EACnBlG,EAAU0F,EAAQxE,EAAOI,KAEhCA,EAAQ6E,QAAU,SAASX,EAAM6B,EAASC,GACxC,MAAIX,GAAqBrF,EAAQ4F,KACxBH,KAET/G,EAAU0F,EAAQxE,EAAOI,GAClB6E,EAAQX,EAAM6B,EAASC,KAEhChG,EAAQ8E,MAAQ,SAASc,GACvB,MAAOL,GAAmBK,IAErB5F,EAAQ4F,IAAMhH,EAAWwF,EAAQxE,EAAOI,MAKvD7B,EAASiH,KAAO5G","file":"./backbone.dualstorage.amd.min.js"}
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(r,t){var d=!1,p=null,e=!1,n=document.createElement("div");n.classList.add("backdrop-popover");function f(t,e,n){t.setAttribute("data-value",e),t.setAttribute("data-text",n)}var v=[];function i(){var t=document.createElement("div");return t.classList.add("popover"),t.setAttribute("id",function(){for(var t="",e="abcdefghijklmnopqrstuvwxyz",n=0;n<8;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}()),t.setAttribute("data-virtual","true"),document.body.appendChild(t),document.body.lastChild}function a(t){var e="string"==typeof t?t:t.text,n="string"==typeof t?t:t.value;return'<li><a class="padded-list" data-value="'.concat(n,'">').concat(e,"</a></li>")}function y(t){return!t.classList.contains("active")&&(e=!0,(p=t).style.display="block",r.setTimeout(function(){t.style.visibility="visible",t.classList.add("active")},10),t.querySelector("ul").scrollTop=0,document.querySelector(".app-page.app-active").appendChild(n),!0)}function g(t,e,n){var i=document.querySelector(".app-page.app-active");if(null===(e="string"==typeof e?i.querySelector(e):e))throw new Error("The trigger for the popover does not exists");if(y(t)){var o=e.getBoundingClientRect(),r=n&&n.width?n.width:e.clientWidth,a=o.top,c=o.left;if(n&&n.direction){for(var l=(e.clientWidth-r)/2,u=0,s=n.margin?n.margin:0,d=n.direction.split(" "),p=0;p<d.length;p++)"left"===d[p]?l=-r-s:"right"===d[p]?l=e.clientWidth+s:"top"===d[p]?u=-t.clientHeight-s:"bottom"===d[p]&&(u=e.clientHeight+s);c+=l,a+=u}t.style.top="".concat(a,"px"),t.style.left="".concat(c,"px"),t.style.width="".concat(r,"px")}}function h(t,e){if(void 0===e&&(e="left"),y(t)){var n=document.querySelector(".app-page.app-active"),i=n.currentStyle||r.getComputedStyle(n);if("title"===e||"title-left"===e){var o=n.querySelector(".header-bar");t.style.top="".concat(o.offsetHeight,"px"),t.style.left="".concat("title"===e?o.clientWidth/2+parseInt(i.marginLeft)-t.clientWidth/2:16+parseInt(i.marginLeft),"px")}else"left"!==e&&"right"!==e||(t.style.top="12px","left"===e?t.style.left="".concat(16+parseInt(i.marginLeft),"px"):(t.style.left="auto",t.style.right="16px"))}}function m(t){e=!1,(p=t).classList.contains("active")&&(t.classList.toggle("active"),r.setTimeout(function(){!function(){var t=document.querySelector(".app-active");null!==t.querySelector("div.backdrop-popover")&&t.removeChild(n),p.style.visibility="hidden",p.style.display="none","true"===p.getAttribute("data-virtual")&&document.body.removeChild(p),p=null}()},250))}function o(n){return{setList:function(t,e){return function(t,e,n){if(!(e instanceof Array))throw new Error("The list of the popover must be an array, ".concat(_typeof(e)," given"));var i='<ul class="list">',o=a;"function"==typeof n&&(o=n);for(var r=0;r<e.length;r++)i+=o(e[r]);i+="</ul>",t.innerHTML=i}(n,t,e),this},open:function(t){return h(n,t),this},openFrom:function(t,e){return g(n,t,e),this},close:function(){return m(n),this},onItemChanged:function(t){return v.push({id:n.getAttribute("id"),callback:t}),this},attachButton:function(t,e){return function(t,e,n){if(null===(e="string"==typeof e?document.querySelector(e):e))throw new Error("The button does not exists");var i=t.getAttribute("id");e.setAttribute("data-popover-id",i),!0===n&&e.setAttribute("data-autobind",!0)}(n,t,e),this},setActiveItem:function(t,e){f(n,0<arguments.length&&void 0!==t?t:"",1<arguments.length&&void 0!==e?e:"")},getActiveItem:function(){return{text:n.getAttribute("data-text"),value:n.getAttribute("data-value"),target:n}}}}document.on(t.event.start,function(t){!function(t){for(;t&&t!==document;t=t.parentNode)if(t.classList.contains("popover")&&t.classList.contains("active"))return t;return!1}((t=t.originalEvent||t).target)&&e&&m(p),d=!1}),document.on(t.event.move,function(t){t=t.originalEvent||t,d=!0}),document.on(t.event.end,function(t){var e=t.target,n=function(t){for(var e={target:null,id:null,direction:null};t&&t!==document;t=t.parentNode){var n=t.getAttribute("data-popover-id");if(null!==n){e.target=t,e.id=n,e.direction="left",!t.classList.contains("title")&&t.classList.contains("pull-left")?e.direction="left":!t.classList.contains("title")&&t.parentNode.classList.contains("pull-left")?e.direction="left":t.classList.contains("title")&&t.classList.contains("pull-left")?e.direction="title-left":t.parentNode&&t.parentNode.classList.contains("pull-left")&&t.classList.contains("title")?e.direction="title-left":t.classList.contains("pull-right")?e.direction="right":t.parentNode&&t.parentNode.classList.contains("pull-right")?e.direction="right":t.classList.contains("center")?e.direction="title":t.parentNode&&t.parentNode.classList.contains("center")?e.direction="title":e.direction="button";break}}return e}(e),i=document.querySelector("#".concat(n.id));if(n.target&&i&&(i.classList.contains("active")&&!d?m(i):"button"===n.direction?g(i,n.target):h(i,n.direction)),null!==e.parentNode&&function(t){for(;t&&t!==document;t=t.parentNode)if(t===p)return!0;return!1}(e)&&!d){m(p);var o=e.innerText||e.textContent,r=e.getAttribute("data-value"),a={text:o,value:r,target:t.target},c=function(t){for(;t&&t!==document;t=t.parentNode)if(t.classList.contains("popover"))return t;return null}(e);f(c,r,o),t=new CustomEvent("itemchanged",{detail:a,bubbles:!0,cancelable:!0});for(var l=document.querySelectorAll('[data-popover-id="'.concat(p.id,'"]')),u=l.length-1;0<=u;u--){"true"===(n=l[u]).getAttribute("data-autobind")&&("textContent"in n?n.textContent=e.textContent:n.innerText=e.innerText)}p.dispatchEvent(t);for(u=0;u<v.length;u++){var s=v[u];s.id===p.getAttribute("id")&&s.callback(a)}}}),t.popover=function(t){if("string"==typeof t&&"_caller"===t)return o();if(void 0===t)return o(i());var e="string"==typeof t?document.querySelector(t):t;if(null===e)throw new Error("The popover with ID ".concat(t," does not exists"));return o(e)},t.popoverUtil={closeActive:function(){var t=!!p;return t&&m(p),t}},r.phonon=t,"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=t.popover:"function"==typeof define&&define.amd&&define(function(){return t.popover})}("undefined"!=typeof window?window:void 0,window.phonon||{});
"use strict";var __decorate=this&&this.__decorate||function(n,e,r,t){var o,i=arguments.length,u=i<3?e:null===t?t=Object.getOwnPropertyDescriptor(e,r):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,e,r,t);else for(var a=n.length-1;0<=a;a--)(o=n[a])&&(u=(i<3?o(u):3<i?o(e,r,u):o(e,r))||u);return 3<i&&u&&Object.defineProperty(e,r,u),u};Object.defineProperty(exports,"__esModule",{value:!0});var doc_1=require("../doc"),environment_1=require("../environment"),util=require("../util"),operation_1=require("./operation"),ops=require("./ops"),ops_1=require("./ops"),selu_util=require("./selu_util"),UnaryOps=function(){function r(){}return r.neg=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.neg(e)},{x:e},function(n){return{x:function(){return n.neg()}}})},r.ceil=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.ceil(e)},{x:e},function(n){return{x:function(){return ops.zerosLike(n)}}})},r.floor=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.floor(e)},{x:e},function(n){return{x:function(){return ops.zerosLike(n)}}})},r.exp=function(r){return environment_1.ENV.engine.runKernel(function(n,e){return e(n.exp(r))},{x:r},function(n,e){var r=e[0];return{x:function(){return n.mulStrict(r)}}})},r.log=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.log(e)},{x:e},function(n){return{x:function(){return n.divStrict(e.toFloat())}}})},r.sqrt=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.sqrt(e)},{x:e},function(n){return{x:function(){return n.divStrict(e.toFloat().sqrt().mul(ops.scalar(2)))}}})},r.square=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.square(e)},{x:e},function(n){return{x:function(){return n.mulStrict(e.toFloat().mul(ops.scalar(2)))}}})},r.abs=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.abs(e)},{x:e},function(n){return{x:function(){return n.mulStrict(e.toFloat().step(-1))}}})},r.clipByValue=function(e,r,t){util.assert(r<=t,"Error in clip: min ("+r+") must beless than or equal to max ("+t+").");return environment_1.ENV.engine.runKernel(function(n){return n.clip(e,r,t)},{x:e},function(n){return{x:function(){return n.where(e.greater(ops.scalar(r)).logicalAnd(e.less(ops.scalar(t))),ops_1.zerosLike(n))}}})},r.relu=function(r){return environment_1.ENV.engine.runKernel(function(n){return n.relu(r)},{x:r},function(n){var e=r.step();return{x:function(){return n.mulStrict(e.toFloat())}}})},r.elu=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.elu(e)},{x:e},function(n){return{x:function(){return n.mulStrict(eluDer(e))}}})},r.selu=function(u){return environment_1.ENV.engine.runKernel(function(n){return n.selu(u)},{x:u},function(i){return{x:function(){var n=u.greater(ops.scalar(0)),e=ops.scalar(selu_util.SELU_SCALEALPHA),r=ops.scalar(selu_util.SELU_SCALE),t=i.mul(r),o=i.mul(e).mul(u.toFloat().exp());return ops.where(n,t,o)}}})},r.leakyRelu=function(e,r){void 0===r&&(r=.2);return environment_1.ENV.engine.runKernel(function(n){return n.leakyRelu(e,r)},{x:e},function(n){return{x:function(){return n.mulStrict(e.step(r))}}})},r.prelu=function(e,r){return environment_1.ENV.engine.runKernel(function(n){return n.prelu(e,r)},{x:e},function(n){return{x:function(){return n.mulStrict(preluDer(e,r))}}})},r.sigmoid=function(r){return environment_1.ENV.engine.runKernel(function(n,e){return e(n.sigmoid(r))},{x:r},function(n,e){var r=e[0];return{x:function(){return n.mulStrict(r.mul(ops.scalar(1).sub(r)))}}})},r.sin=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.sin(e)},{x:e},function(n){return{x:function(){return e.toFloat().cos().mulStrict(n)}}})},r.cos=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.cos(e)},{x:e},function(n){return{x:function(){return e.toFloat().sin().neg().mulStrict(n)}}})},r.tan=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.tan(e)},{x:e},function(n){return{x:function(){return n.divStrict(e.cos().square())}}})},r.asin=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.asin(e)},{x:e},function(n){return{x:function(){return n.divStrict(r.sqrt(ops.scalar(1).sub(e.toFloat().square())))}}})},r.acos=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.acos(e)},{x:e},function(n){return{x:function(){return n.divStrict(r.sqrt(ops.scalar(1).sub(e.toFloat().square()))).neg()}}})},r.atan=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.atan(e)},{x:e},function(n){return{x:function(){return n.divStrict(ops.scalar(1).add(e.toFloat().square()))}}})},r.sinh=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.sinh(e)},{x:e},function(n){return{x:function(){return e.toFloat().cosh().mulStrict(n)}}})},r.cosh=function(e){return environment_1.ENV.engine.runKernel(function(n){return n.cosh(e)},{x:e},function(n){return{x:function(){return e.toFloat().sinh().mulStrict(n)}}})},r.tanh=function(r){return environment_1.ENV.engine.runKernel(function(n,e){return e(n.tanh(r))},{x:r},function(n,e){var r=e[0];return{x:function(){return ops.scalar(1).sub(r.square()).mulStrict(n)}}})},r.step=function(e,r){void 0===r&&(r=0);return environment_1.ENV.engine.runKernel(function(n){return n.step(e,r)},{x:e},function(n){return{x:function(){return ops.zerosLike(n)}}})},__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"neg",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"ceil",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"floor",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"exp",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"log",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"sqrt",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"square",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"abs",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"clipByValue",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"relu",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"elu",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"selu",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"leakyRelu",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"prelu",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"sigmoid",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"sin",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"cos",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"tan",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"asin",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"acos",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"atan",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"sinh",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"cosh",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"tanh",null),__decorate([doc_1.doc({heading:"Operations",subheading:"Basic math"}),operation_1.operation],r,"step",null),r}();function preluDer(e,r){return environment_1.ENV.engine.runKernel(function(n){return n.preluDer(e,r)},{x:e,alpha:r})}function eluDer(e){return environment_1.ENV.engine.runKernel(function(n){return n.eluDer(e)},{x:e})}exports.UnaryOps=UnaryOps;
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var util=require("./util"),FORMAT_LIMIT_NUM_VALS=20,FORMAT_NUM_FIRST_LAST_VALS=3,FORMAT_NUM_SIG_DIGITS=7;function tensorToString(r,n){var t=r.dataSync(),e=computeMaxSizePerColumn(r),a=subTensorToString(t,r.shape,r.strides,e),o=["Tensor"];return n&&(o.push("  dtype: "+r.dtype),o.push("  rank: "+r.rank),o.push("  shape: ["+r.shape+"]"),o.push("  values:")),o.push(a.map(function(r){return"    "+r}).join("\n")),o.join("\n")}function computeMaxSizePerColumn(r){var n=r.dataSync(),t=r.size,e=r.strides[r.strides.length-1],a=new Array(e).fill(0);if(1<r.rank)for(var o=0;o<t/e;o++)for(var i=o*e,u=0;u<e;u++)a[u]=Math.max(a[u],valToString(n[i+u],0).length);return a}function valToString(r,n){return util.rightPad(parseFloat(r.toFixed(FORMAT_NUM_SIG_DIGITS)).toString(),n)}function subTensorToString(r,n,t,e,a){void 0===a&&(a=!0);var o=n[0],i=n.length;if(0===i)return[r[0].toString()];if(1===i){if(FORMAT_LIMIT_NUM_VALS<o){var u=Array.from(r.subarray(0,FORMAT_NUM_FIRST_LAST_VALS)),s=Array.from(r.subarray(o-FORMAT_NUM_FIRST_LAST_VALS,o));return["["+u.map(function(r,n){return valToString(r,e[n])}).join(", ")+", ..., "+s.map(function(r,n){return valToString(r,e[o-FORMAT_NUM_FIRST_LAST_VALS+n])}).join(", ")+"]"]}return["["+Array.from(r).map(function(r,n){return valToString(r,e[n])}).join(", ")+"]"]}var T=n.slice(1),S=t.slice(1),_=t[0],p=[];if(FORMAT_LIMIT_NUM_VALS<o){for(var A=0;A<FORMAT_NUM_FIRST_LAST_VALS;A++){var M=(l=A*_)+_;p.push.apply(p,subTensorToString(r.subarray(l,M),T,S,e,!1))}p.push("...");for(A=o-FORMAT_NUM_FIRST_LAST_VALS;A<o;A++){M=(l=A*_)+_;p.push.apply(p,subTensorToString(r.subarray(l,M),T,S,e,A===o-1))}}else for(A=0;A<o;A++){var l,M=(l=A*_)+_;p.push.apply(p,subTensorToString(r.subarray(l,M),T,S,e,A===o-1))}var f=2===i?",":"";p[0]="["+p[0]+f;for(A=1;A<p.length-1;A++)p[A]=" "+p[A]+f;for(var g=",\n",A=2;A<i;A++)g+="\n";return p[p.length-1]=" "+p[p.length-1]+"]"+(a?"":g),p}exports.tensorToString=tensorToString;
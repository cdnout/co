"use strict";var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(t,e){function r(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var globals_1=require("../../globals"),util=require("../../util"),graph_util=require("../graph_util"),op_1=require("./op"),Subtract=function(o){function t(t,e,r){var a=o.call(this)||this;return a.t1=t,a.t2=e,a.outTensor=r,util.assert(1===util.sizeFromShape(t.shape)||1===util.sizeFromShape(e.shape)||util.arraysEqual(t.shape,e.shape),"One of t1 or t2 must be a scalar, or t1 and t2 must have the same shape"),a}return __extends(t,o),t.prototype.feedForward=function(e,r){var a=this,o=r.get(this.t1),s=r.get(this.t2);globals_1.tidy(function(){var t=util.isScalarShape(o.shape)?e.scalarMinusArray(o,s):util.isScalarShape(s.shape)?e.arrayMinusScalar(o,s):e.subtract(o,s);r.set(a.outTensor,globals_1.keep(t))})},t.prototype.backProp=function(r,t,a){var o=this,s=a.get(this.outTensor);globals_1.tidy(function(){var t,e;graph_util.shouldBackProp(o.t1)&&(util.isScalarShape(o.t1.shape)?(t=r.sum(s),a.add(o.t1,t)):a.add(o.t1,r.clone(s))),graph_util.shouldBackProp(o.t2)&&(util.isScalarShape(o.t2.shape)?(t=r.sum(s),e=r.neg(t),a.add(o.t2,e)):a.add(o.t2,r.neg(s)))})},t.prototype.dispose=function(){null!=this.dySizeScalar&&this.dySizeScalar.dispose()},t}(op_1.Operation);exports.Subtract=Subtract;
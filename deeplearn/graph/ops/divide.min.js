"use strict";var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(e,r){function t(){this.constructor=e}a(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}();Object.defineProperty(exports,"__esModule",{value:!0});var globals_1=require("../../globals"),util=require("../../util"),graph_util=require("../graph_util"),op_1=require("./op"),Divide=function(i){function e(e,r,t){var a=i.call(this)||this;return a.x1Tensor=e,a.x2Tensor=r,a.yTensor=t,util.assert(1===util.sizeFromShape(e.shape)||1===util.sizeFromShape(r.shape)||util.arraysEqual(e.shape,r.shape),"One of t1 or t2 must be a scalar, or t1 and t2 must have the same shape"),a}return __extends(e,i),e.prototype.feedForward=function(r,t){var a=this,i=t.get(this.x1Tensor),s=t.get(this.x2Tensor);globals_1.tidy(function(){var e=util.isScalarShape(i.shape)?r.scalarDividedByArray(i,s):util.isScalarShape(s.shape)?r.arrayDividedByScalar(i,s):r.divide(i,s);t.set(a.yTensor,globals_1.keep(e))})},e.prototype.backProp=function(s,e,o){var n=this,l=e.get(this.x1Tensor),u=e.get(this.x2Tensor),d=o.get(this.yTensor),p=util.isScalarShape(l.shape),h=util.isScalarShape(u.shape);globals_1.tidy(function(){var e,r,t,a,i;graph_util.shouldBackProp(n.x1Tensor)&&(p?(e=s.divide(d,u),o.add(n.x1Tensor,s.sum(e)),e.dispose()):h?o.add(n.x1Tensor,s.arrayDividedByScalar(d,u)):o.add(n.x1Tensor,s.divide(d,u))),graph_util.shouldBackProp(n.x2Tensor)&&(r=s.elementWiseMul(u,u),t=void 0,t=h?s.arrayDividedByScalar(l,r):p?s.scalarDividedByArray(l,r):s.divide(l,r),a=s.neg(t),i=s.elementWiseMul(d,a),h?o.add(n.x2Tensor,s.sum(i)):o.add(n.x2Tensor,i))})},e}(op_1.Operation);exports.Divide=Divide;
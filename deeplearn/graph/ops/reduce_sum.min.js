"use strict";var __extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0});var environment_1=require("../../environment"),globals_1=require("../../globals"),tensor_1=require("../../tensor"),util=require("../../util"),graph_util=require("../graph_util"),op_1=require("./op"),ReduceSum=function(r){function e(e,t){var o=r.call(this)||this;return o.x=e,o.outTensor=t,util.assertShapesMatch(t.shape,[]),o.ones=environment_1.ENV.math.keep(tensor_1.Tensor.ones(e.shape)),o}return __extends(e,r),e.prototype.feedForward=function(e,t){var o=this,r=t.get(this.x);globals_1.tidy(function(){t.set(o.outTensor,globals_1.keep(e.sum(r)))})},e.prototype.backProp=function(t,e,o){var r=this;graph_util.shouldBackProp(this.x)&&globals_1.tidy(function(){var e=o.get(r.outTensor);o.add(r.x,t.scalarTimesArray(e,r.ones))})},e.prototype.dispose=function(){this.ones.dispose()},e}(op_1.Operation);exports.ReduceSum=ReduceSum;
"use strict";var __decorate=this&&this.__decorate||function(e,n,t,o){var r,l=arguments.length,i=l<3?n:null===o?o=Object.getOwnPropertyDescriptor(n,t):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,t,o);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(i=(l<3?r(i):3<l?r(n,t,i):r(n,t))||i);return 3<l&&i&&Object.defineProperty(n,t,i),i},__metadata=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};Object.defineProperty(exports,"__esModule",{value:!0});var context_1=require("./context/context"),constants_1=require("./constants"),columnController_1=require("./columnController/columnController"),gridOptionsWrapper_1=require("./gridOptionsWrapper"),pinnedRowModel_1=require("./rowModels/pinnedRowModel"),utils_1=require("./utils"),CellNavigationService=function(){function e(){}return e.prototype.getNextCellToFocus=function(e,n){for(var t=n,o=!1;!o;){switch(e){case constants_1.Constants.KEY_UP:t=this.getCellAbove(t);break;case constants_1.Constants.KEY_DOWN:t=this.getCellBelow(t);break;case constants_1.Constants.KEY_RIGHT:t=this.gridOptionsWrapper.isEnableRtl()?this.getCellToLeft(t):this.getCellToRight(t);break;case constants_1.Constants.KEY_LEFT:t=this.gridOptionsWrapper.isEnableRtl()?this.getCellToRight(t):this.getCellToLeft(t);break;default:t=null,console.warn("ag-Grid: unknown key for navigation "+e)}o=!t||this.isCellGoodToFocusOn(t)}return t},e.prototype.isCellGoodToFocusOn=function(e){var n,t=e.column;switch(e.rowPinned){case constants_1.Constants.PINNED_TOP:n=this.pinnedRowModel.getPinnedTopRow(e.rowIndex);break;case constants_1.Constants.PINNED_BOTTOM:n=this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);break;default:n=this.rowModel.getRow(e.rowIndex)}return!t.isSuppressNavigable(n)},e.prototype.getCellToLeft=function(e){if(!e)return null;var n=this.columnController.getDisplayedColBefore(e.column);return n?{rowIndex:e.rowIndex,column:n,rowPinned:e.rowPinned}:null},e.prototype.getCellToRight=function(e){if(!e)return null;var n=this.columnController.getDisplayedColAfter(e.column);return n?{rowIndex:e.rowIndex,column:n,rowPinned:e.rowPinned}:null},e.prototype.getRowBelow=function(e){var n=e.rowIndex,t=e.rowPinned;if(this.isLastRowInContainer(e))switch(t){case constants_1.Constants.PINNED_BOTTOM:return null;case constants_1.Constants.PINNED_TOP:return this.rowModel.isRowsToRender()?{rowIndex:0,rowPinned:null}:this.pinnedRowModel.isRowsToRender(constants_1.Constants.PINNED_BOTTOM)?{rowIndex:0,rowPinned:constants_1.Constants.PINNED_BOTTOM}:null;default:return this.pinnedRowModel.isRowsToRender(constants_1.Constants.PINNED_BOTTOM)?{rowIndex:0,rowPinned:constants_1.Constants.PINNED_BOTTOM}:null}return{rowIndex:n+1,rowPinned:t}},e.prototype.getCellBelow=function(e){if(!e)return null;var n=this.getRowBelow(e);return n?{rowIndex:n.rowIndex,column:e.column,rowPinned:n.rowPinned}:null},e.prototype.isLastRowInContainer=function(e){var n=e.rowPinned,e=e.rowIndex;return n===constants_1.Constants.PINNED_TOP?this.pinnedRowModel.getPinnedTopRowData().length-1<=e:n===constants_1.Constants.PINNED_BOTTOM?this.pinnedRowModel.getPinnedBottomRowData().length-1<=e:this.rowModel.getRowCount()-1<=e},e.prototype.getRowAbove=function(e){var n=e.rowIndex,e=e.rowPinned;return 0===n?e===constants_1.Constants.PINNED_TOP?null:e&&this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender(constants_1.Constants.PINNED_TOP)?this.getLastFloatingTopRow():null:{rowIndex:n-1,rowPinned:e}},e.prototype.getCellAbove=function(e){if(!e)return null;var n=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});return n?{rowIndex:n.rowIndex,column:e.column,rowPinned:n.rowPinned}:null},e.prototype.getLastBodyCell=function(){return{rowIndex:this.rowModel.getRowCount()-1,rowPinned:null}},e.prototype.getLastFloatingTopRow=function(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowData().length-1,rowPinned:constants_1.Constants.PINNED_TOP}},e.prototype.getNextTabbedCell=function(e,n){return n?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)},e.prototype.getNextTabbedCellForwards=function(e){var n=this.columnController.getAllDisplayedColumns(),t=e.rowIndex,o=e.rowPinned,r=this.columnController.getDisplayedColAfter(e.column);if(!r){r=n[0];e=this.getRowBelow(e);if(utils_1._.missing(e))return null;t=e?e.rowIndex:null,o=e?e.rowPinned:null}return{rowIndex:t,column:r,rowPinned:o}},e.prototype.getNextTabbedCellBackwards=function(e){var n=this.columnController.getAllDisplayedColumns(),t=e.rowIndex,o=e.rowPinned,r=this.columnController.getDisplayedColBefore(e.column);if(!r){r=utils_1._.last(n);e=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});if(utils_1._.missing(e))return null;t=e?e.rowIndex:null,o=e?e.rowPinned:null}return{rowIndex:t,column:r,rowPinned:o}},__decorate([context_1.Autowired("columnController"),__metadata("design:type",columnController_1.ColumnController)],e.prototype,"columnController",void 0),__decorate([context_1.Autowired("rowModel"),__metadata("design:type",Object)],e.prototype,"rowModel",void 0),__decorate([context_1.Autowired("pinnedRowModel"),__metadata("design:type",pinnedRowModel_1.PinnedRowModel)],e.prototype,"pinnedRowModel",void 0),__decorate([context_1.Autowired("gridOptionsWrapper"),__metadata("design:type",gridOptionsWrapper_1.GridOptionsWrapper)],e.prototype,"gridOptionsWrapper",void 0),__decorate([context_1.Bean("cellNavigationService")],e)}();exports.CellNavigationService=CellNavigationService;
"use strict";var __decorate=this&&this.__decorate||function(e,t,o,r){var i,n=arguments.length,d=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)d=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(d=(n<3?i(d):3<n?i(t,o,d):i(t,o))||d);return 3<n&&d&&Object.defineProperty(t,o,d),d},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var gridOptionsWrapper_1=require("../gridOptionsWrapper"),context_1=require("../context/context"),dragAndDropService_1=require("../dragAndDrop/dragAndDropService"),columnController_1=require("../columnController/columnController"),eventService_1=require("../eventService"),events_1=require("../events"),headerRowComp_1=require("./headerRowComp"),bodyDropTarget_1=require("./bodyDropTarget"),column_1=require("../entities/column"),scrollVisibleService_1=require("../gridPanel/scrollVisibleService"),utils_1=require("../utils"),HeaderContainer=function(){function e(e,t,o){this.headerRowComps=[],this.eContainer=e,this.pinned=o,this.eViewport=t}return e.prototype.registerGridComp=function(e){this.setupDragAndDrop(e)},e.prototype.forEachHeaderElement=function(t){this.headerRowComps.forEach(function(e){return e.forEachHeaderElement(t)})},e.prototype.init=function(){this.scrollWidth=this.gridOptionsWrapper.getScrollbarWidth(),this.eventService.addEventListener(events_1.Events.EVENT_COLUMN_VALUE_CHANGED,this.onColumnValueChanged.bind(this)),this.eventService.addEventListener(events_1.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onColumnRowGroupChanged.bind(this)),this.eventService.addEventListener(events_1.Events.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.eventService.addEventListener(events_1.Events.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.eventService.addEventListener(events_1.Events.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.eventService.addEventListener(events_1.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this))},e.prototype.onColumnRowGroupChanged=function(){this.onGridColumnsChanged()},e.prototype.onColumnValueChanged=function(){this.onGridColumnsChanged()},e.prototype.onColumnResized=function(){this.setWidthOfPinnedContainer()},e.prototype.onDisplayedColumnsChanged=function(){this.setWidthOfPinnedContainer()},e.prototype.onScrollVisibilityChanged=function(){this.setWidthOfPinnedContainer()},e.prototype.setWidthOfPinnedContainer=function(){var e=this.pinned===column_1.Column.PINNED_LEFT,t=this.pinned===column_1.Column.PINNED_RIGHT,o=this.columnController,r=this.gridOptionsWrapper.isEnableRtl();(e||t)&&(o=o[e?"getPinnedLeftContainerWidth":"getPinnedRightContainerWidth"](),this.scrollVisibleService.isVerticalScrollShowing()&&(r&&e||!r&&t)&&(o+=this.scrollWidth),utils_1._.setFixedWidth(this.eContainer,o))},e.prototype.destroy=function(){this.removeHeaderRowComps()},e.prototype.getRowComps=function(){return this.headerRowComps},e.prototype.onGridColumnsChanged=function(){this.removeAndCreateAllRowComps()},e.prototype.removeAndCreateAllRowComps=function(){this.removeHeaderRowComps(),this.createHeaderRowComps()},e.prototype.refresh=function(){this.removeAndCreateAllRowComps()},e.prototype.setupDragAndDrop=function(e){var t=this.eViewport||this.eContainer,t=new bodyDropTarget_1.BodyDropTarget(this.pinned,t);this.context.wireBean(t),t.registerGridComp(e)},e.prototype.removeHeaderRowComps=function(){this.headerRowComps.forEach(function(e){e.destroy()}),this.headerRowComps.length=0,utils_1._.clearElement(this.eContainer)},e.prototype.createHeaderRowComps=function(){for(var e=this.columnController.getHeaderRowCount(),t=0;t<e;t++){var o=t!==e-1?headerRowComp_1.HeaderRowType.COLUMN_GROUP:headerRowComp_1.HeaderRowType.COLUMN,r=new headerRowComp_1.HeaderRowComp(t,o,this.pinned,this.dropTarget);this.context.wireBean(r),this.headerRowComps.push(r),r.getGui().setAttribute("aria-rowindex",this.headerRowComps.length.toString()),this.eContainer.appendChild(r.getGui())}this.gridOptionsWrapper.isFloatingFilter()&&!this.columnController.isPivotMode()&&(r=new headerRowComp_1.HeaderRowComp(e,headerRowComp_1.HeaderRowType.FLOATING_FILTER,this.pinned,this.dropTarget),this.context.wireBean(r),this.headerRowComps.push(r),r.getGui().setAttribute("aria-rowindex",this.headerRowComps.length.toString()),this.eContainer.appendChild(r.getGui()))},__decorate([context_1.Autowired("gridOptionsWrapper"),__metadata("design:type",gridOptionsWrapper_1.GridOptionsWrapper)],e.prototype,"gridOptionsWrapper",void 0),__decorate([context_1.Autowired("context"),__metadata("design:type",context_1.Context)],e.prototype,"context",void 0),__decorate([context_1.Autowired("$scope"),__metadata("design:type",Object)],e.prototype,"$scope",void 0),__decorate([context_1.Autowired("dragAndDropService"),__metadata("design:type",dragAndDropService_1.DragAndDropService)],e.prototype,"dragAndDropService",void 0),__decorate([context_1.Autowired("columnController"),__metadata("design:type",columnController_1.ColumnController)],e.prototype,"columnController",void 0),__decorate([context_1.Autowired("eventService"),__metadata("design:type",eventService_1.EventService)],e.prototype,"eventService",void 0),__decorate([context_1.Autowired("scrollVisibleService"),__metadata("design:type",scrollVisibleService_1.ScrollVisibleService)],e.prototype,"scrollVisibleService",void 0),__decorate([context_1.PostConstruct,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],e.prototype,"init",null),e}();exports.HeaderContainer=HeaderContainer;
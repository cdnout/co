"use strict";var __extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};return function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__decorate=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(a=(i<3?n(a):3<i?n(t,o,a):n(t,o))||a);return 3<i&&a&&Object.defineProperty(t,o,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var gridOptionsWrapper_1=require("../gridOptionsWrapper"),columnController_1=require("../columnController/columnController"),column_1=require("../entities/column"),context_1=require("../context/context"),headerContainer_1=require("./headerContainer"),eventService_1=require("../eventService"),events_1=require("../events"),component_1=require("../widgets/component"),componentAnnotations_1=require("../widgets/componentAnnotations"),gridApi_1=require("../gridApi"),autoWidthCalculator_1=require("../rendering/autoWidthCalculator"),constants_1=require("../constants"),utils_1=require("../utils"),HeaderRootComp=function(e){function t(){return e.call(this,t.TEMPLATE)||this}return __extends(t,e),t.prototype.registerGridComp=function(t){this.gridPanel=t,this.childContainers.forEach(function(e){return e.registerGridComp(t)})},t.prototype.postConstruct=function(){var t=this;this.printLayout=this.gridOptionsWrapper.getDomLayout()===constants_1.Constants.DOM_LAYOUT_PRINT,this.gridApi.registerHeaderRootComp(this),this.autoWidthCalculator.registerHeaderRootComp(this);var e=new headerContainer_1.HeaderContainer(this.eHeaderContainer,this.eHeaderViewport,null),o=new headerContainer_1.HeaderContainer(this.ePinnedLeftHeader,null,column_1.Column.PINNED_LEFT),r=new headerContainer_1.HeaderContainer(this.ePinnedRightHeader,null,column_1.Column.PINNED_RIGHT);this.childContainers=[e,o,r],this.childContainers.forEach(function(e){return t.getContext().wireBean(e)}),this.addDestroyableEventListener(this.eventService,events_1.Events.EVENT_COLUMN_VALUE_CHANGED,this.refreshHeader.bind(this)),this.addDestroyableEventListener(this.gridOptionsWrapper,gridOptionsWrapper_1.GridOptionsWrapper.PROP_DOM_LAYOUT,this.onDomLayoutChanged.bind(this)),this.addDestroyableEventListener(this.eventService,events_1.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this)),this.onPivotModeChanged(),this.addPreventHeaderScroll(),this.columnController.isReady()&&this.refreshHeader()},t.prototype.onDomLayoutChanged=function(){var e=this.gridOptionsWrapper.getDomLayout()===constants_1.Constants.DOM_LAYOUT_PRINT;this.printLayout!==e&&(this.printLayout=e,this.refreshHeader())},t.prototype.setHorizontalScroll=function(e){this.eHeaderContainer.style.transform="translateX("+e+"px)"},t.prototype.forEachHeaderElement=function(t){this.childContainers.forEach(function(e){return e.forEachHeaderElement(t)})},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.childContainers.forEach(function(e){return e.destroy()})},t.prototype.refreshHeader=function(){this.childContainers.forEach(function(e){return e.refresh()})},t.prototype.onPivotModeChanged=function(){var e=this.columnController.isPivotMode();utils_1._.addOrRemoveCssClass(this.getGui(),"ag-pivot-on",e),utils_1._.addOrRemoveCssClass(this.getGui(),"ag-pivot-off",!e)},t.prototype.setHeight=function(e){e+="px";this.getGui().style.height=e,this.getGui().style.minHeight=e},t.prototype.addPreventHeaderScroll=function(){var t=this;this.addDestroyableEventListener(this.eHeaderViewport,"scroll",function(){var e=t.eHeaderViewport.scrollLeft;0!==e&&(t.gridPanel.scrollHorizontally(e),t.eHeaderViewport.scrollLeft=0)})},t.prototype.setHeaderContainerWidth=function(e){this.eHeaderContainer.style.width=e+"px"},t.prototype.setLeftVisible=function(e){utils_1._.setDisplayed(this.ePinnedLeftHeader,e)},t.prototype.setRightVisible=function(e){utils_1._.setDisplayed(this.ePinnedRightHeader,e)},t.prototype.getHeaderRowCount=function(){return 0===this.childContainers.length?0:this.childContainers[0].getRowComps().length},t.TEMPLATE='<div class="ag-header" role="presentation">\n            <div class="ag-pinned-left-header" ref="ePinnedLeftHeader" role="presentation"></div>\n            <div class="ag-header-viewport" ref="eHeaderViewport" role="presentation">\n                <div class="ag-header-container" ref="eHeaderContainer" role="rowgroup"></div>\n            </div>\n            <div class="ag-pinned-right-header" ref="ePinnedRightHeader" role="presentation"></div>\n        </div>',__decorate([componentAnnotations_1.RefSelector("ePinnedLeftHeader"),__metadata("design:type",HTMLElement)],t.prototype,"ePinnedLeftHeader",void 0),__decorate([componentAnnotations_1.RefSelector("ePinnedRightHeader"),__metadata("design:type",HTMLElement)],t.prototype,"ePinnedRightHeader",void 0),__decorate([componentAnnotations_1.RefSelector("eHeaderContainer"),__metadata("design:type",HTMLElement)],t.prototype,"eHeaderContainer",void 0),__decorate([componentAnnotations_1.RefSelector("eHeaderViewport"),__metadata("design:type",HTMLElement)],t.prototype,"eHeaderViewport",void 0),__decorate([context_1.Autowired("gridOptionsWrapper"),__metadata("design:type",gridOptionsWrapper_1.GridOptionsWrapper)],t.prototype,"gridOptionsWrapper",void 0),__decorate([context_1.Autowired("columnController"),__metadata("design:type",columnController_1.ColumnController)],t.prototype,"columnController",void 0),__decorate([context_1.Autowired("eventService"),__metadata("design:type",eventService_1.EventService)],t.prototype,"eventService",void 0),__decorate([context_1.Autowired("gridApi"),__metadata("design:type",gridApi_1.GridApi)],t.prototype,"gridApi",void 0),__decorate([context_1.Autowired("autoWidthCalculator"),__metadata("design:type",autoWidthCalculator_1.AutoWidthCalculator)],t.prototype,"autoWidthCalculator",void 0),__decorate([context_1.PostConstruct,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],t.prototype,"postConstruct",null),t}(component_1.Component);exports.HeaderRootComp=HeaderRootComp;
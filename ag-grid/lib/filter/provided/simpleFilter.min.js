"use strict";var __extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)};return function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),__decorate=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;0<=s;s--)(i=t[s])&&(a=(r<3?i(a):3<r?i(e,o,a):i(e,o))||a);return 3<r&&a&&Object.defineProperty(e,o,a),a},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(exports,"__esModule",{value:!0});var ConditionPosition,componentAnnotations_1=require("../../widgets/componentAnnotations"),optionsFactory_1=require("./optionsFactory"),providedFilter_1=require("./providedFilter"),utils_1=require("../../utils");!function(t){t[t.One=0]="One",t[t.Two=1]="Two"}(ConditionPosition=exports.ConditionPosition||(exports.ConditionPosition={}));var DEFAULT_TRANSLATIONS={loadingOoo:"Loading...",empty:"Choose One",equals:"Equals",notEqual:"Not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"In range",lessThanOrEqual:"Less than or equals",greaterThanOrEqual:"Greater than or equals",filterOoo:"Filter...",contains:"Contains",notContains:"Not contains",startsWith:"Starts with",endsWith:"Ends with",searchOoo:"Search...",selectAll:"Select All",applyFilter:"Apply Filter",clearFilter:"Clear Filter",andCondition:"AND",orCondition:"OR"},SimpleFilter=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.showValueFrom=function(t){return!this.doesFilterHaveHiddenInput(t)&&t!==o.EMPTY},o.prototype.showValueTo=function(t){return t===o.IN_RANGE},o.prototype.onFloatingFilterChanged=function(t,e){this.setValueFromFloatingFilter(e),this.setTypeFromFloatingFilter(t),this.onUiChanged(!0)},o.prototype.setTypeFromFloatingFilter=function(t){this.eType1.value=t,this.eType2.value=null,this.eJoinOperatorAnd.checked=!0},o.prototype.getModelFromUi=function(){return this.isConditionUiComplete(ConditionPosition.One)?this.isAllowTwoConditions()&&this.isConditionUiComplete(ConditionPosition.Two)?{filterType:this.getFilterType(),operator:this.getJoinOperator(),condition1:this.createCondition(ConditionPosition.One),condition2:this.createCondition(ConditionPosition.Two)}:this.createCondition(ConditionPosition.One):null},o.prototype.getCondition1Type=function(){return this.eType1.value},o.prototype.getCondition2Type=function(){return this.eType2.value},o.prototype.getJoinOperator=function(){return this.eJoinOperatorOr.checked?"OR":"AND"},o.prototype.areModelsEqual=function(t,e){if(!t&&!e)return!0;if(!t&&e||t&&!e)return!1;var o=!t.operator,n=!e.operator;return!(!o&&n||o&&!n)&&(o?this.areSimpleModelsEqual(t,e):(e=e,(t=t).operator===e.operator&&this.areSimpleModelsEqual(t.condition1,e.condition1)&&this.areSimpleModelsEqual(t.condition2,e.condition2)))},o.prototype.setModelIntoUi=function(t){var e,o;t.operator?(o="OR"===(e=t).operator,this.eJoinOperatorAnd.checked=!o,this.eJoinOperatorOr.checked=o,this.eType1.value=e.condition1.type,this.eType2.value=e.condition2.type,this.setConditionIntoUi(e.condition1,ConditionPosition.One),this.setConditionIntoUi(e.condition2,ConditionPosition.Two)):(t=t,this.eJoinOperatorAnd.checked=!0,this.eJoinOperatorOr.checked=!1,this.eType1.value=t.type,this.eType2.value=this.optionsFactory.getDefaultOption(),this.setConditionIntoUi(t,ConditionPosition.One),this.setConditionIntoUi(null,ConditionPosition.Two))},o.prototype.doesFilterPass=function(t){var e=this.getModel();if(e.operator){var o=e,n=this.individualConditionPasses(t,o.condition1),i=this.individualConditionPasses(t,o.condition2);return"AND"===o.operator?n&&i:n||i}return this.individualConditionPasses(t,e)},o.prototype.setParams=function(t){e.prototype.setParams.call(this,t),this.simpleFilterParams=t,this.optionsFactory=new optionsFactory_1.OptionsFactory,this.optionsFactory.init(t,this.getDefaultFilterOptions()),this.allowTwoConditions=!t.suppressAndOrCondition,this.putOptionsIntoDropdown(),this.addChangedListeners()},o.prototype.putOptionsIntoDropdown=function(){var i=this,t=this.optionsFactory.getFilterOptions();t.forEach(function(n){function t(){var t="string"==typeof n?n:n.displayKey,e=i.translate(t),o=document.createElement("option");return o.text=e,o.value=t,o}i.eType1.add(t()),i.eType2.add(t())});t=t.length<=1;this.eType1.disabled=t,this.eType2.disabled=t},o.prototype.isAllowTwoConditions=function(){return this.allowTwoConditions},o.prototype.createBodyTemplate=function(){var t=this.createValueTemplate(ConditionPosition.One),e=this.createValueTemplate(ConditionPosition.Two),o="ag-simple-filter-and-or-"+this.getCompId(),n=this.gridOptionsWrapper.getLocaleTextFunc();return'<select class="ag-filter-select" ref="eOptions1"></select>\n                '+t+"\n                "+('<div class="ag-filter-condition" ref="eJoinOperatorPanel">\n                    <label>\n                        <input ref="eJoinOperatorAnd" type="radio" class="and" name="'+o+'" value="AND")} checked="checked" />\n                        '+n("andCondition","AND")+'\n                    </label>\n                    <label>\n                        <input ref="eJoinOperatorOr" type="radio" class="or" name="'+o+'" value="OR" />\n                        '+n("orCondition","OR")+"\n                    </label>\n                </div>")+'\n                <select class="ag-filter-select" ref="eOptions2"></select>\n                '+e},o.prototype.updateUiVisibility=function(){var t=this.isConditionUiComplete(ConditionPosition.One),t=this.allowTwoConditions&&t;utils_1._.setDisplayed(this.eCondition2Body,t),utils_1._.setDisplayed(this.eType2,t),utils_1._.setDisplayed(this.eJoinOperatorPanel,t)},o.prototype.resetUiToDefaults=function(){this.eJoinOperatorAnd.checked=!0;var t=this.optionsFactory.getDefaultOption();this.eType1.value=t,this.eType2.value=t},o.prototype.translate=function(t){var e=this.gridOptionsWrapper.getLocaleTextFunc(),o=DEFAULT_TRANSLATIONS[t];return!o&&this.optionsFactory.getCustomOption(t)&&(o=this.optionsFactory.getCustomOption(t).displayName),e(t,o)},o.prototype.addChangedListeners=function(){function t(){return e.onUiChanged()}var e=this;this.addDestroyableEventListener(this.eType1,"change",t),this.addDestroyableEventListener(this.eType2,"change",t),this.addDestroyableEventListener(this.eJoinOperatorOr,"change",t),this.addDestroyableEventListener(this.eJoinOperatorAnd,"change",t)},o.prototype.doesFilterHaveHiddenInput=function(t){t=this.optionsFactory.getCustomOption(t);return t&&t.hideFilterInput},o.EMPTY="empty",o.EQUALS="equals",o.NOT_EQUAL="notEqual",o.LESS_THAN="lessThan",o.LESS_THAN_OR_EQUAL="lessThanOrEqual",o.GREATER_THAN="greaterThan",o.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",o.IN_RANGE="inRange",o.CONTAINS="contains",o.NOT_CONTAINS="notContains",o.STARTS_WITH="startsWith",o.ENDS_WITH="endsWith",__decorate([componentAnnotations_1.RefSelector("eOptions1"),__metadata("design:type",HTMLSelectElement)],o.prototype,"eType1",void 0),__decorate([componentAnnotations_1.RefSelector("eOptions2"),__metadata("design:type",HTMLSelectElement)],o.prototype,"eType2",void 0),__decorate([componentAnnotations_1.RefSelector("eJoinOperatorAnd"),__metadata("design:type",HTMLInputElement)],o.prototype,"eJoinOperatorAnd",void 0),__decorate([componentAnnotations_1.RefSelector("eJoinOperatorOr"),__metadata("design:type",HTMLInputElement)],o.prototype,"eJoinOperatorOr",void 0),__decorate([componentAnnotations_1.RefSelector("eCondition2Body"),__metadata("design:type",HTMLElement)],o.prototype,"eCondition2Body",void 0),__decorate([componentAnnotations_1.RefSelector("eJoinOperatorPanel"),__metadata("design:type",HTMLElement)],o.prototype,"eJoinOperatorPanel",void 0),o}(providedFilter_1.ProvidedFilter);exports.SimpleFilter=SimpleFilter;
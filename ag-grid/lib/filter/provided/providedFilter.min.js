"use strict";var __extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)};return function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),__decorate=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,p=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(p=(r<3?i(p):3<r?i(e,o,p):i(e,o))||p);return 3<r&&p&&Object.defineProperty(e,o,p),p},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(exports,"__esModule",{value:!0});var component_1=require("../../widgets/component"),componentAnnotations_1=require("../../widgets/componentAnnotations"),context_1=require("../../context/context"),gridOptionsWrapper_1=require("../../gridOptionsWrapper"),utils_1=require("../../utils"),constants_1=require("../../constants"),ProvidedFilter=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.onFilterChanged=function(){console.warn("ag-Grid: you should not call onFilterChanged() directly on the filter, please call\n        gridApi.onFilterChanged() instead. onFilterChanged is not part of the exposed filter interface (it was\n        a method that existed on an old version of the filters that was not intended for public use."),this.providedFilterParams.filterChangedCallback()},n.prototype.isFilterActive=function(){return!!this.appliedModel},n.prototype.postConstruct=function(){var t=this.createTemplate();this.setTemplate(t)},n.prototype.init=function(t){this.setParams(t),this.resetUiToDefaults(),this.updateUiVisibility(),this.setupOnBtApplyDebounce()},n.prototype.setParams=function(t){var e=this;this.providedFilterParams=t,this.clearActive=!0===t.clearButton,this.applyActive=n.isUseApplyButton(t),t.newRowsAction===n.NEW_ROWS_ACTION_KEEP?this.newRowsActionKeep=!0:t.newRowsAction===n.NEW_ROWS_ACTION_CLEAR?this.newRowsActionKeep=!1:(o=this.rowModel.getType(),t=[constants_1.Constants.ROW_MODEL_TYPE_SERVER_SIDE,constants_1.Constants.ROW_MODEL_TYPE_INFINITE],this.newRowsActionKeep=0<=t.indexOf(o)),utils_1._.setDisplayed(this.eApplyButton,this.applyActive),this.addDestroyableEventListener(this.eApplyButton,"click",function(){return e.onBtApply()}),utils_1._.setDisplayed(this.eClearButton,this.clearActive),this.addDestroyableEventListener(this.eClearButton,"click",this.onBtClear.bind(this));var o=this.applyActive||this.clearActive;utils_1._.setDisplayed(this.eButtonsPanel,o)},n.prototype.getDefaultDebounceMs=function(){return 0},n.prototype.setupOnBtApplyDebounce=function(){var t=n.getDebounceMs(this.providedFilterParams,this.getDefaultDebounceMs());this.onBtApplyDebounce=utils_1._.debounce(this.onBtApply.bind(this),t)},n.prototype.getModel=function(){return this.appliedModel},n.prototype.setModel=function(t){t?this.setModelIntoUi(t):this.resetUiToDefaults(),this.updateUiVisibility(),this.applyModel()},n.prototype.onBtClear=function(){this.resetUiToDefaults(),this.updateUiVisibility(),this.onUiChanged()},n.prototype.applyModel=function(){var t=this.appliedModel;return this.appliedModel=this.getModelFromUi(),!this.areModelsEqual(this.appliedModel,t)},n.prototype.onBtApply=function(t){void 0===t&&(t=!1),this.applyModel()&&this.providedFilterParams.filterChangedCallback({afterFloatingFilter:t})},n.prototype.onNewRowsLoaded=function(){this.newRowsActionKeep||(this.resetUiToDefaults(),this.appliedModel=null)},n.prototype.isNewRowsActionKeep=function(){return this.newRowsActionKeep},n.prototype.onUiChanged=function(t){void 0===t&&(t=!1),this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),t?this.onBtApply(!0):this.applyActive||this.onBtApplyDebounce()},n.prototype.createTemplate=function(){var t=this.createBodyTemplate(),e=this.gridOptionsWrapper.getLocaleTextFunc();return"<div>\n                    <div class='ag-filter-body-wrapper' ref=\"eFilterBodyWrapper\">"+t+'</div>\n                    <div class="ag-filter-apply-panel" ref="eButtonsPanel">\n                        <button type="button" ref="eClearButton">'+e("clearFilter","Clear Filter")+'</button>\n                        <button type="button" ref="eApplyButton">'+e("applyFilter","Apply Filter")+"</button>\n                    </div>\n                </div>"},n.getDebounceMs=function(t,e){return n.isUseApplyButton(t)?(null!=t.debounceMs&&console.warn("ag-Grid: debounceMs is ignored when applyButton = true"),0):null!=t.debounceMs?t.debounceMs:e},n.isUseApplyButton=function(t){return t.apply&&!t.applyButton&&(console.warn("ag-Grid: as of ag-Grid v21, filterParams.apply is now filterParams.applyButton, please change to applyButton"),t.applyButton=!0),!0===t.applyButton},n.NEW_ROWS_ACTION_KEEP="keep",n.NEW_ROWS_ACTION_CLEAR="clear",__decorate([componentAnnotations_1.RefSelector("eButtonsPanel"),__metadata("design:type",HTMLElement)],n.prototype,"eButtonsPanel",void 0),__decorate([componentAnnotations_1.RefSelector("eFilterBodyWrapper"),__metadata("design:type",HTMLElement)],n.prototype,"eFilterBodyWrapper",void 0),__decorate([componentAnnotations_1.RefSelector("eApplyButton"),__metadata("design:type",HTMLElement)],n.prototype,"eApplyButton",void 0),__decorate([componentAnnotations_1.RefSelector("eClearButton"),__metadata("design:type",HTMLElement)],n.prototype,"eClearButton",void 0),__decorate([context_1.Autowired("gridOptionsWrapper"),__metadata("design:type",gridOptionsWrapper_1.GridOptionsWrapper)],n.prototype,"gridOptionsWrapper",void 0),__decorate([context_1.Autowired("rowModel"),__metadata("design:type",Object)],n.prototype,"rowModel",void 0),__decorate([context_1.PostConstruct,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],n.prototype,"postConstruct",null),n}(component_1.Component);exports.ProvidedFilter=ProvidedFilter;
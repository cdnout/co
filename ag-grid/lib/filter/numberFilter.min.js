"use strict";var __extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};return function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),__decorate=this&&this.__decorate||function(e,t,i,r){var o,n=arguments.length,l=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(l=(n<3?o(l):3<n?o(t,i,l):o(t,i))||l);return 3<n&&l&&Object.defineProperty(t,i,l),l},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var componentAnnotations_1=require("../widgets/componentAnnotations"),baseFilter_1=require("./baseFilter"),utils_1=require("../utils"),NumberFilter=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return __extends(o,t),o.prototype.modelFromFloatingFilter=function(e){return{type:this.selectedFilter,filter:Number(e),filterTo:this.filterNumberTo,filterType:"number"}},o.prototype.getApplicableFilterTypes=function(){return[baseFilter_1.BaseFilter.EQUALS,baseFilter_1.BaseFilter.NOT_EQUAL,baseFilter_1.BaseFilter.LESS_THAN,baseFilter_1.BaseFilter.LESS_THAN_OR_EQUAL,baseFilter_1.BaseFilter.GREATER_THAN,baseFilter_1.BaseFilter.GREATER_THAN_OR_EQUAL,baseFilter_1.BaseFilter.IN_RANGE]},o.prototype.bodyTemplate=function(e){var t=this.translate.bind(this),i=e==baseFilter_1.FilterConditionType.MAIN?"filterText":"filterConditionText",r=e==baseFilter_1.FilterConditionType.MAIN?"filterNumberToPanel":"filterNumberToPanelCondition",e=e==baseFilter_1.FilterConditionType.MAIN?"filterToText":"filterToConditionText";return'<div class="ag-filter-body">\n            <div class="ag-input-text-wrapper">\n                <input class="ag-filter-filter" id="'+i+'" type="text" placeholder="'+t("filterOoo")+'"/>\n            </div>\n             <div class="ag-input-text-wrapper ag-filter-number-to" id="'+r+'">\n                <input class="ag-filter-filter" id="'+e+'" type="text" placeholder="'+t("filterOoo")+'"/>\n            </div>\n        </div>'},o.prototype.initialiseFilterBodyUi=function(e){t.prototype.initialiseFilterBodyUi.call(this,e),e===baseFilter_1.FilterConditionType.MAIN?(this.eFilterTextField=this.queryForHtmlInputElement("#filterText"),this.addFilterChangedEventListeners(e,this.eFilterTextField,this.eFilterToTextField)):(this.eFilterTextConditionField=this.queryForHtmlInputElement("#filterConditionText"),this.addFilterChangedEventListeners(e,this.eFilterTextConditionField,this.eFilterToConditionText),this.setFilter(this.filterNumberCondition,baseFilter_1.FilterConditionType.CONDITION),this.setFilterTo(this.filterNumberConditionTo,baseFilter_1.FilterConditionType.CONDITION),this.setFilterType(this.selectedFilterCondition,baseFilter_1.FilterConditionType.CONDITION))},o.prototype.addFilterChangedEventListeners=function(e,t,i){var r=this,o=this.getDebounceMs(this.filterParams),o=utils_1._.debounce(function(){return r.onTextFieldsChanged(e,t,i)},o);this.addDestroyableEventListener(t,"input",o),this.addDestroyableEventListener(i,"input",o)},o.prototype.afterGuiAttached=function(){this.eFilterTextField.focus()},o.prototype.comparator=function(){return function(e,t){return e===t?0:e<t?1:t<e?-1:void 0}},o.prototype.onTextFieldsChanged=function(e,t,i){t=this.stringToFloat(t.value),i=this.stringToFloat(i.value);e===baseFilter_1.FilterConditionType.MAIN?this.filterNumber===t&&this.filterNumberTo===i||(this.filterNumber=t,this.filterNumberTo=i,this.onFilterChanged()):this.filterNumberCondition===t&&this.filterNumberConditionTo===i||(this.filterNumberCondition=t,this.filterNumberConditionTo=i,this.onFilterChanged())},o.prototype.filterValues=function(e){return e===baseFilter_1.FilterConditionType.MAIN?this.selectedFilter!==baseFilter_1.BaseFilter.IN_RANGE?this.asNumber(this.filterNumber):[this.asNumber(this.filterNumber),this.asNumber(this.filterNumberTo)]:this.selectedFilterCondition!==baseFilter_1.BaseFilter.IN_RANGE?this.asNumber(this.filterNumberCondition):[this.asNumber(this.filterNumberCondition),this.asNumber(this.filterNumberConditionTo)]},o.prototype.asNumber=function(e){return utils_1._.isNumeric(e)?e:null},o.prototype.stringToFloat=function(e){e=utils_1._.makeNull(e);return e&&""===e.trim()&&(e=null),null!=e?parseFloat(e):null},o.prototype.setFilter=function(e,t){null!==(e=utils_1._.makeNull(e))&&"number"!=typeof e&&(e=parseFloat(e)),t===baseFilter_1.FilterConditionType.MAIN?(this.filterNumber=e,this.eFilterTextField&&(this.eFilterTextField.value=e)):(this.filterNumberCondition=e,this.eFilterTextConditionField&&(this.eFilterTextConditionField.value=e))},o.prototype.setFilterTo=function(e,t){null!==(e=utils_1._.makeNull(e))&&"number"!=typeof e&&(e=parseFloat(e)),t===baseFilter_1.FilterConditionType.MAIN?(this.filterNumberTo=e,this.eFilterToTextField&&(this.eFilterToTextField.value=e)):(this.filterNumberConditionTo=e,this.eFilterToConditionText&&(this.eFilterToConditionText.value=e))},o.prototype.getFilter=function(e){return e===baseFilter_1.FilterConditionType.MAIN?this.filterNumber:this.filterNumberCondition},o.prototype.serialize=function(e){var t=e===baseFilter_1.FilterConditionType.MAIN?this.selectedFilter:this.selectedFilterCondition,i=e===baseFilter_1.FilterConditionType.MAIN?this.filterNumber:this.filterNumberCondition,e=e===baseFilter_1.FilterConditionType.MAIN?this.filterNumberTo:this.filterNumberConditionTo;return{type:t||this.defaultFilter,filter:i,filterTo:e,filterType:"number"}},o.prototype.parse=function(e,t){this.setFilterType(e.type,t),this.setFilter(e.filter,t),this.setFilterTo(e.filterTo,t)},o.prototype.refreshFilterBodyUi=function(e){var t,i=e===baseFilter_1.FilterConditionType.MAIN?this.selectedFilter:this.selectedFilterCondition,r=e===baseFilter_1.FilterConditionType.MAIN?this.eNumberToPanel:this.eNumberToConditionPanel;r&&(t=i===o.IN_RANGE,utils_1._.setVisible(r,t));e=e===baseFilter_1.FilterConditionType.MAIN?this.eFilterTextField:this.eFilterTextConditionField;e&&(i=!this.doesFilterHaveHiddenInput(i)&&i!==baseFilter_1.BaseFilter.EMPTY,utils_1._.setVisible(e,i))},o.prototype.resetState=function(e){void 0===e&&(e=!1),e||(this.setFilterType(this.defaultFilter,baseFilter_1.FilterConditionType.MAIN),this.setFilter(null,baseFilter_1.FilterConditionType.MAIN),this.setFilterTo(null,baseFilter_1.FilterConditionType.MAIN)),this.setFilterType(this.defaultFilter,baseFilter_1.FilterConditionType.CONDITION),this.setFilter(null,baseFilter_1.FilterConditionType.CONDITION),this.setFilterTo(null,baseFilter_1.FilterConditionType.CONDITION)},o.prototype.setType=function(e,t){this.setFilterType(e,t)},o.LESS_THAN="lessThan",__decorate([componentAnnotations_1.QuerySelector("#filterText"),__metadata("design:type",HTMLInputElement)],o.prototype,"eFilterTextField",void 0),__decorate([componentAnnotations_1.QuerySelector("#filterTextCondition"),__metadata("design:type",HTMLInputElement)],o.prototype,"eFilterTextConditionField",void 0),__decorate([componentAnnotations_1.QuerySelector("#filterToText"),__metadata("design:type",HTMLInputElement)],o.prototype,"eFilterToTextField",void 0),__decorate([componentAnnotations_1.QuerySelector("#filterToConditionText"),__metadata("design:type",HTMLInputElement)],o.prototype,"eFilterToConditionText",void 0),__decorate([componentAnnotations_1.QuerySelector("#filterNumberToPanel"),__metadata("design:type",HTMLElement)],o.prototype,"eNumberToPanel",void 0),__decorate([componentAnnotations_1.QuerySelector("#filterNumberToPanelCondition"),__metadata("design:type",HTMLElement)],o.prototype,"eNumberToConditionPanel",void 0),o}(baseFilter_1.ScalarBaseFilter);exports.NumberFilter=NumberFilter;
"use strict";var __decorate=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,p=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;0<=s;s--)(i=t[s])&&(p=(r<3?i(p):3<r?i(e,o,p):i(e,o))||p);return 3<r&&p&&Object.defineProperty(e,o,p),p},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(exports,"__esModule",{value:!0});var gridOptionsWrapper_1=require("../gridOptionsWrapper"),rowNode_1=require("../entities/rowNode"),context_1=require("../context/context"),eventService_1=require("../eventService"),events_1=require("../events"),constants_1=require("../constants"),columnApi_1=require("../columnController/columnApi"),gridApi_1=require("../gridApi"),utils_1=require("../utils"),PinnedRowModel=function(){function t(){}return t.prototype.init=function(){this.setPinnedTopRowData(this.gridOptionsWrapper.getPinnedTopRowData()),this.setPinnedBottomRowData(this.gridOptionsWrapper.getPinnedBottomRowData())},t.prototype.isEmpty=function(t){t=t===constants_1.Constants.PINNED_TOP?this.pinnedTopRows:this.pinnedBottomRows;return utils_1._.missingOrEmpty(t)},t.prototype.isRowsToRender=function(t){return!this.isEmpty(t)},t.prototype.getRowAtPixel=function(t,e){var o=e===constants_1.Constants.PINNED_TOP?this.pinnedTopRows:this.pinnedBottomRows;if(utils_1._.missingOrEmpty(o))return 0;for(var n=0;n<o.length;n++){var i=o[n];if(t<=i.rowTop+i.rowHeight-1)return n}return o.length-1},t.prototype.setPinnedTopRowData=function(t){this.pinnedTopRows=this.createNodesFromData(t,!0);t={type:events_1.Events.EVENT_PINNED_ROW_DATA_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(t)},t.prototype.setPinnedBottomRowData=function(t){this.pinnedBottomRows=this.createNodesFromData(t,!1);t={type:events_1.Events.EVENT_PINNED_ROW_DATA_CHANGED,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(t)},t.prototype.createNodesFromData=function(t,n){var i,r=this,p=[];return t&&(i=0,t.forEach(function(t,e){var o=new rowNode_1.RowNode;r.context.wireBean(o),o.data=t,o.id=(n?"t":"b")+"-"+e,o.rowPinned=n?constants_1.Constants.PINNED_TOP:constants_1.Constants.PINNED_BOTTOM,o.setRowTop(i),o.setRowHeight(r.gridOptionsWrapper.getRowHeightForNode(o).height),o.setRowIndex(e),i+=o.rowHeight,p.push(o)})),p},t.prototype.getPinnedTopRowData=function(){return this.pinnedTopRows},t.prototype.getPinnedBottomRowData=function(){return this.pinnedBottomRows},t.prototype.getPinnedTopTotalHeight=function(){return this.getTotalHeight(this.pinnedTopRows)},t.prototype.getPinnedTopRowCount=function(){return this.pinnedTopRows?this.pinnedTopRows.length:0},t.prototype.getPinnedBottomRowCount=function(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0},t.prototype.getPinnedTopRow=function(t){return this.pinnedTopRows[t]},t.prototype.getPinnedBottomRow=function(t){return this.pinnedBottomRows[t]},t.prototype.forEachPinnedTopRow=function(t){utils_1._.missingOrEmpty(this.pinnedTopRows)||this.pinnedTopRows.forEach(t)},t.prototype.forEachPinnedBottomRow=function(t){utils_1._.missingOrEmpty(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(t)},t.prototype.getPinnedBottomTotalHeight=function(){return this.getTotalHeight(this.pinnedBottomRows)},t.prototype.getTotalHeight=function(t){if(t&&0!==t.length){t=utils_1._.last(t);return t.rowTop+t.rowHeight}return 0},__decorate([context_1.Autowired("gridOptionsWrapper"),__metadata("design:type",gridOptionsWrapper_1.GridOptionsWrapper)],t.prototype,"gridOptionsWrapper",void 0),__decorate([context_1.Autowired("eventService"),__metadata("design:type",eventService_1.EventService)],t.prototype,"eventService",void 0),__decorate([context_1.Autowired("context"),__metadata("design:type",context_1.Context)],t.prototype,"context",void 0),__decorate([context_1.Autowired("columnApi"),__metadata("design:type",columnApi_1.ColumnApi)],t.prototype,"columnApi",void 0),__decorate([context_1.Autowired("gridApi"),__metadata("design:type",gridApi_1.GridApi)],t.prototype,"gridApi",void 0),__decorate([context_1.PostConstruct,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],t.prototype,"init",null),__decorate([context_1.Bean("pinnedRowModel")],t)}();exports.PinnedRowModel=PinnedRowModel;
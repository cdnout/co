"use strict";var __decorate=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,l=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;0<=s;s--)(n=e[s])&&(l=(r<3?n(l):3<r?n(t,o,l):n(t,o))||l);return 3<r&&l&&Object.defineProperty(t,o,l),l},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var context_1=require("./context/context"),eventService_1=require("./eventService"),events_1=require("./events"),gridOptionsWrapper_1=require("./gridOptionsWrapper"),columnApi_1=require("./columnController/columnApi"),columnController_1=require("./columnController/columnController"),gridApi_1=require("./gridApi"),cellComp_1=require("./rendering/cellComp"),utils_1=require("./utils"),FocusedCellController=function(){function e(){}return e.prototype.init=function(){this.eventService.addEventListener(events_1.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.clearFocusedCell.bind(this)),this.eventService.addEventListener(events_1.Events.EVENT_COLUMN_EVERYTHING_CHANGED,this.clearFocusedCell.bind(this)),this.eventService.addEventListener(events_1.Events.EVENT_COLUMN_GROUP_OPENED,this.clearFocusedCell.bind(this)),this.eventService.addEventListener(events_1.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,this.clearFocusedCell.bind(this))},e.prototype.clearFocusedCell=function(){this.focusedCellPosition=null,this.onCellFocused(!1)},e.prototype.getFocusedCell=function(){return this.focusedCellPosition},e.prototype.getFocusCellToUseAfterRefresh=function(){return!this.gridOptionsWrapper.isSuppressFocusAfterRefresh()&&this.focusedCellPosition&&this.getGridCellForDomElement(document.activeElement)?this.focusedCellPosition:null},e.prototype.getGridCellForDomElement=function(e){for(var t=e;t;){var o=this.gridOptionsWrapper.getDomData(t,cellComp_1.CellComp.DOM_DATA_KEY_CELL_COMP);if(o)return o.getCellPosition();t=t.parentNode}return null},e.prototype.setFocusedCell=function(e,t,o,i){void 0===i&&(i=!1);t=utils_1._.makeNull(this.columnController.getGridColumn(t));this.focusedCellPosition={rowIndex:e,rowPinned:utils_1._.makeNull(o),column:t},this.onCellFocused(i)},e.prototype.isCellFocused=function(e){return!utils_1._.missing(this.focusedCellPosition)&&(this.focusedCellPosition.column===e.column&&this.isRowFocused(e.rowIndex,e.rowPinned))},e.prototype.isRowNodeFocused=function(e){return this.isRowFocused(e.rowIndex,e.rowPinned)},e.prototype.isAnyCellFocused=function(){return!!this.focusedCellPosition},e.prototype.isRowFocused=function(e,t){if(utils_1._.missing(this.focusedCellPosition))return!1;t=utils_1._.makeNull(t);return this.focusedCellPosition.rowIndex===e&&this.focusedCellPosition.rowPinned===t},e.prototype.onCellFocused=function(e){e={type:events_1.Events.EVENT_CELL_FOCUSED,forceBrowserFocus:e,rowIndex:null,column:null,floating:null,api:this.gridApi,columnApi:this.columnApi,rowPinned:null};this.focusedCellPosition&&(e.rowIndex=this.focusedCellPosition.rowIndex,e.column=this.focusedCellPosition.column,e.rowPinned=this.focusedCellPosition.rowPinned),this.eventService.dispatchEvent(e)},__decorate([context_1.Autowired("eventService"),__metadata("design:type",eventService_1.EventService)],e.prototype,"eventService",void 0),__decorate([context_1.Autowired("gridOptionsWrapper"),__metadata("design:type",gridOptionsWrapper_1.GridOptionsWrapper)],e.prototype,"gridOptionsWrapper",void 0),__decorate([context_1.Autowired("columnController"),__metadata("design:type",columnController_1.ColumnController)],e.prototype,"columnController",void 0),__decorate([context_1.Autowired("columnApi"),__metadata("design:type",columnApi_1.ColumnApi)],e.prototype,"columnApi",void 0),__decorate([context_1.Autowired("gridApi"),__metadata("design:type",gridApi_1.GridApi)],e.prototype,"gridApi",void 0),__decorate([context_1.PostConstruct,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],e.prototype,"init",null),__decorate([context_1.Bean("focusedCellController")],e)}();exports.FocusedCellController=FocusedCellController;
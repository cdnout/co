"use strict";var __extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};return function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),__decorate=this&&this.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;0<=a;a--)(o=e[a])&&(n=(s<3?o(n):3<s?o(t,i,n):o(t,i))||n);return 3<s&&n&&Object.defineProperty(t,i,n),n},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var context_1=require("../../context/context"),dragService_1=require("../../dragAndDrop/dragService");function Resizable(e){var t;function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.RESIZE_TEMPLATE='\n            <div class="ag-resizer-wrapper">\n                <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>\n                <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>\n                <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>\n                <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>\n                <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>\n                <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>\n                <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>\n                <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>\n            </div>\n        ',e.resizable={},e.isResizable=!1,e.isResizing=!1,e.lastPosition={x:0,y:0,width:0,height:0},e}return __extends(i,t=e),i.prototype.postConstruct=function(){t.prototype.postConstruct.call(this);var e=this.config.resizable;this.addResizers(),e&&this.setResizable(e)},i.prototype.addResizers=function(){var e,t=this.getGui();t&&(e=(new DOMParser).parseFromString(this.RESIZE_TEMPLATE,"text/html").body,t.appendChild(e.firstChild),this.createMap())},i.prototype.createMap=function(){var e=this.getGui();this.resizerMap={topLeft:{element:e.querySelector("[ref=eTopLeftResizer]")},top:{element:e.querySelector("[ref=eTopResizer]")},topRight:{element:e.querySelector("[ref=eTopRightResizer]")},right:{element:e.querySelector("[ref=eRightResizer]")},bottomRight:{element:e.querySelector("[ref=eBottomRightResizer]")},bottom:{element:e.querySelector("[ref=eBottomResizer]")},bottomLeft:{element:e.querySelector("[ref=eBottomLeftResizer]")},left:{element:e.querySelector("[ref=eLeftResizer]")}}},i.prototype.getResizerElement=function(e){return this.resizerMap[e].element},i.prototype.onResizeStart=function(e){this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)},i.prototype.onResize=function(e,t){var i,r,o,s,n,a,c,p,l;this.isResizing&&(i=!!t.match(/left/i),o=!!t.match(/right/i),r=!!t.match(/top/i),s=!!t.match(/bottom/i),a=i||o,p=r||s,c=(n=this.calculateMouseMovement({e:e,isLeft:i,isTop:r})).movementX,t=n.movementY,s=o=0,a&&c&&(l=i?-1:1,a=(n=this.getWidth())+c*l,c=!1,i&&(o=n-a,(this.position.x+o<=0||a<=this.minWidth)&&(c=!0,o=0)),c||this.setWidth(a)),p&&t&&(l=r?-1:1,t=(p=this.getHeight())+t*l,l=!1,r&&(s=p-t,(this.position.y+s<=0||t<=this.minHeight)&&(l=!0,s=0)),l||this.setHeight(t)),this.updateDragStartPosition(e.clientX,e.clientY),(o||s)&&this.offsetElement(this.position.x+o,this.position.y+s))},i.prototype.onResizeEnd=function(){this.isResizing=!1;var e={type:"resize",api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi()};this.localEventService&&this.localEventService.dispatchEvent(e)},i.prototype.destroy=function(){t.prototype.destroy.call(this),this.setResizable(!1)},i.prototype.setResizable=function(o){var s=this,n=!1;"boolean"==typeof o&&(o={topLeft:o,top:o,topRight:o,right:o,bottomRight:o,bottom:o,bottomLeft:o,left:o}),Object.keys(o).forEach(function(e){var t=e,i=!!o[t],r=s.getResizerElement(t),e=s.resizerMap[t].dragSource||{eElement:r,onDragStart:s.onResizeStart.bind(s),onDragging:function(e){return s.onResize(e,t)},onDragStop:s.onResizeEnd.bind(s)};!!s.resizable[t]==i&&(s.isAlive()||i)||(i?(s.dragService.addDragSource(e),r.style.pointerEvents="all",n=!0):(s.dragService.removeDragSource(e),r.style.pointerEvents="none"),s.resizerMap[t].dragSource=i?e:void 0)}),this.isResizable=n},__decorate([context_1.Autowired("dragService"),__metadata("design:type",dragService_1.DragService)],i.prototype,"dragService",void 0),i}exports.Resizable=Resizable;
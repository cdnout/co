"use strict";var __extends=this&&this.__extends||function(){var o=function(t,i){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(t,i)};return function(t,i){function e(){this.constructor=t}o(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}}(),__decorate=this&&this.__decorate||function(t,i,e,o){var n,s=arguments.length,r=s<3?i:null===o?o=Object.getOwnPropertyDescriptor(i,e):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,i,e,o);else for(var p=t.length-1;0<=p;p--)(n=t[p])&&(r=(s<3?n(r):3<s?n(i,e,r):n(i,e))||r);return 3<s&&r&&Object.defineProperty(i,e,r),r},__metadata=this&&this.__metadata||function(t,i){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,i)};Object.defineProperty(exports,"__esModule",{value:!0});var popupService_1=require("../../widgets/popupService"),context_1=require("../../context/context"),gridOptionsWrapper_1=require("../../gridOptionsWrapper"),utils_1=require("../../utils");function Positionable(t){var i;function e(){var t=null!==i&&i.apply(this,arguments)||this;return t.positioned=!1,t.dragStartPosition={x:0,y:0},t.position={x:0,y:0},t.size={width:void 0,height:void 0},t}return __extends(e,i=t),e.prototype.postConstruct=function(){var t,i,e,o,n,s,r;this.positioned||(t=(r=this.config).minWidth,i=r.width,e=r.minHeight,o=r.height,n=r.centered,s=r.x,r=r.y,this.minHeight=null!=e?e:250,this.minWidth=null!=t?t:250,this.popupParent=this.popupService.getPopupParent(),i&&this.setWidth(i),o&&this.setHeight(o),this.renderComponent&&this.renderComponent(),i&&o||this.refreshSize(),n?this.center():(s||r)&&this.offsetElement(s,r),this.positioned=!0)},e.prototype.updateDragStartPosition=function(t,i){this.dragStartPosition={x:t,y:i}},e.prototype.calculateMouseMovement=function(t){var i=this.popupParent.getBoundingClientRect(),e=t.e,o=t.isLeft,n=t.isTop,s=t.anywhereWithin,r=t.topBuffer,p=e.clientX-this.dragStartPosition.x,h=e.clientY-this.dragStartPosition.y,c=this.getWidth(),u=this.getHeight(),t=i.left>=e.clientX&&this.position.x<=0||i.right<=e.clientX&&i.right<=this.position.x+i.left+c;return{movementX:p=(t=t||(o?p<0&&e.clientX>this.position.x+i.left||0<p&&e.clientX<this.position.x+i.left:s?p<0&&e.clientX>this.position.x+i.left+c||0<p&&e.clientX<this.position.x+i.left:p<0&&e.clientX>this.position.x+i.left+c||0<p&&e.clientX<this.position.x+i.left+c))?0:p,movementY:h=i.top>=e.clientY&&this.position.y<=0||i.bottom<=e.clientY&&i.bottom<=this.position.y+i.top+u||n&&(h<0&&e.clientY>this.position.y+i.top+(r||0)||0<h&&e.clientY<this.position.y+i.top)||!n&&(h<0&&e.clientY>this.position.y+i.top+u||0<h&&e.clientY<this.position.y+i.top+u)?0:h}},e.prototype.refreshSize=function(){var t=this.size,i=t.width,t=t.height;i||this.setWidth(this.getGui().offsetWidth),t||this.setHeight(this.getGui().offsetHeight)},e.prototype.offsetElement=function(t,i){void 0===t&&(t=0),void 0===i&&(i=0);var e=this.getGui();this.popupService.positionPopup({ePopup:e,x:t,y:i,minWidth:this.minWidth,minHeight:this.minHeight,keepWithinBounds:!0}),this.position.x=parseInt(e.style.left,10),this.position.y=parseInt(e.style.top,10)},e.prototype.getHeight=function(){return this.size.height},e.prototype.setHeight=function(t){var i,e=this.getGui(),o=!1;"string"==typeof t&&-1!==t.indexOf("%")?(utils_1._.setFixedHeight(e,t),t=utils_1._.getAbsoluteHeight(e),o=!0):(t=Math.max(this.minHeight,t),(i=e.offsetParent)&&i.clientHeight&&t+this.position.y>i.clientHeight&&(t=i.clientHeight-this.position.y)),this.size.height!==t&&(this.size.height=t,o||utils_1._.setFixedHeight(e,t))},e.prototype.getWidth=function(){return this.size.width},e.prototype.setWidth=function(t){var i,e=this.getGui(),o=!1;"string"==typeof t&&-1!==t.indexOf("%")?(utils_1._.setFixedWidth(e,t),t=utils_1._.getAbsoluteWidth(e),o=!0):(t=Math.max(this.minWidth,t),(i=e.offsetParent)&&i.clientWidth&&t+this.position.x>i.clientWidth&&(t=i.clientWidth-this.position.x)),this.size.width!==t&&(this.size.width=t,o||utils_1._.setFixedWidth(e,t))},e.prototype.center=function(){var t=this.getGui(),i=t.offsetParent.clientWidth/2-this.getWidth()/2,t=t.offsetParent.clientHeight/2-this.getHeight()/2;this.offsetElement(i,t)},__decorate([context_1.Autowired("popupService"),__metadata("design:type",popupService_1.PopupService)],e.prototype,"popupService",void 0),__decorate([context_1.Autowired("gridOptionsWrapper"),__metadata("design:type",gridOptionsWrapper_1.GridOptionsWrapper)],e.prototype,"gridOptionsWrapper",void 0),e}exports.Positionable=Positionable;
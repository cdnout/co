"use strict";var __extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};return function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var s in t=arguments[o])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var cellComp_1=require("./cellComp"),rowNode_1=require("../entities/rowNode"),column_1=require("../entities/column"),events_1=require("../events"),component_1=require("../widgets/component"),utils_1=require("../utils"),RowComp=function(u){function n(e,t,o,n,s,i,r,a,l,d,h){var p=u.call(this)||this;return p.eAllRowContainers=[],p.active=!0,p.rowContainerReadyCount=0,p.refreshNeeded=!1,p.columnRefreshPending=!1,p.cellComps={},p.createSecondPassFuncs=[],p.removeFirstPassFuncs=[],p.removeSecondPassFuncs=[],p.initialised=!1,p.parentScope=e,p.beans=r,p.bodyContainerComp=t,p.pinnedLeftContainerComp=o,p.pinnedRightContainerComp=n,p.fullWidthContainerComp=s,p.rowNode=i,p.rowIsEven=p.rowNode.rowIndex%2==0,p.paginationPage=p.beans.paginationProxy.getCurrentPage(),p.useAnimationFrameForCreate=l,p.printLayout=d,p.embedFullWidth=h,p.setAnimateFlags(a),p}return __extends(n,u),n.prototype.init=function(){var e=this;this.rowFocused=this.beans.focusedCellController.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.scope=this.createChildScopeOrNull(this.rowNode.data),this.setupRowContainers(),this.addListeners(),this.slideRowIn&&this.createSecondPassFuncs.push(function(){e.onTopChanged()}),this.fadeRowIn&&this.createSecondPassFuncs.push(function(){e.eAllRowContainers.forEach(function(e){return utils_1._.removeCssClass(e,"ag-opacity-zero")})})},n.prototype.createTemplate=function(e,t){void 0===t&&(t=null);var o=[],n=this.rowNode.rowHeight,s=this.getInitialRowClasses(t).join(" "),i=utils_1._.escape(this.rowNode.id),r=this.preProcessStylesFromGridOptions(),a=this.getRowBusinessKey(),l=utils_1._.escape(a),d=this.getInitialRowTopStyle(),h=this.rowNode.getRowIndexString(),t=this.beans.gridPanel.headerRootComp.getHeaderRowCount();return o.push("<div"),o.push(' role="row"'),o.push(' row-index="'+h+'" aria-rowindex="'+(t+this.rowNode.rowIndex+1)+'"'),o.push(i?' row-id="'+i+'"':""),o.push(a?' row-business-key="'+l+'"':""),o.push(' comp-id="'+this.getCompId()+'"'),o.push(' class="'+s+'"'),o.push(' style="height: '+n+"px; "+d+" "+r+'">'),o.push(e),o.push("</div>"),o.join("")},n.prototype.getCellForCol=function(e){e=this.cellComps[e.getColId()];return e?e.getGui():null},n.prototype.afterFlush=function(){this.initialised||(this.initialised=!0,this.executeProcessRowPostCreateFunc())},n.prototype.executeProcessRowPostCreateFunc=function(){var e=this.beans.gridOptionsWrapper.getProcessRowPostCreateFunc();e&&e({eRow:this.eBodyRow,ePinnedLeftRow:this.ePinnedLeftRow,ePinnedRightRow:this.ePinnedRightRow,node:this.rowNode,api:this.beans.gridOptionsWrapper.getApi(),rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),context:this.beans.gridOptionsWrapper.getContext()})},n.prototype.getInitialRowTopStyle=function(){if(this.printLayout)return"";var e=this.slideRowIn?this.roundRowTopToBounds(this.rowNode.oldRowTop):this.rowNode.rowTop,e=this.applyPaginationOffset(e),e=this.beans.maxDivHeightScaler.getRealPixelPosition(e);return this.beans.gridOptionsWrapper.isSuppressRowTransform()?"top: "+e+"px; ":"transform: translateY("+e+"px);"},n.prototype.getRowBusinessKey=function(){var e=this.beans.gridOptionsWrapper.getBusinessKeyForNodeFunc();if("function"==typeof e)return e(this.rowNode)},n.prototype.areAllContainersReady=function(){return 3===this.rowContainerReadyCount},n.prototype.lazyCreateCells=function(e,t){this.active&&(e=this.createCells(e),t.innerHTML=e.template,this.callAfterRowAttachedOnCells(e.cellComps,t),this.rowContainerReadyCount++,this.areAllContainersReady()&&this.refreshNeeded&&this.refreshCells())},n.prototype.createRowContainer=function(t,o,n){var s=this,i=this.useAnimationFrameForCreate,r=i?{cellComps:[],template:""}:this.createCells(o),e=this.createTemplate(r.template);t.appendRowTemplate(e,function(){var e=t.getRowElement(s.getCompId());s.afterRowAttached(t,e),n(e),i?s.beans.taskQueue.addP1Task(s.lazyCreateCells.bind(s,o,e),s.rowNode.rowIndex):(s.callAfterRowAttachedOnCells(r.cellComps,e),s.rowContainerReadyCount=3)})},n.prototype.createChildScopeOrNull=function(e){if(!this.beans.gridOptionsWrapper.isAngularCompileRows())return null;var t=this.parentScope.$new();return t.data=__assign({},e),t.rowNode=this.rowNode,t.context=this.beans.gridOptionsWrapper.getContext(),this.addDestroyFunc(function(){t.$destroy(),t.data=null,t.rowNode=null,t.context=null}),t},n.prototype.setupRowContainers=function(){var e=this.beans.gridOptionsWrapper.getIsFullWidthCellFunc(),t=!!e&&e(this.rowNode),o=this.beans.doingMasterDetail&&this.rowNode.detail,e=this.beans.columnController.isPivotMode(),e=this.rowNode.group&&!this.rowNode.footer&&this.beans.gridOptionsWrapper.isGroupUseEntireRow(e);this.rowNode.stub?this.createFullWidthRows(n.LOADING_CELL_RENDERER,n.LOADING_CELL_RENDERER_COMP_NAME):o?this.createFullWidthRows(n.DETAIL_CELL_RENDERER,n.DETAIL_CELL_RENDERER_COMP_NAME):t?this.createFullWidthRows(n.FULL_WIDTH_CELL_RENDERER,null):e?this.createFullWidthRows(n.GROUP_ROW_RENDERER,n.GROUP_ROW_RENDERER_COMP_NAME):this.setupNormalRowContainers()},n.prototype.setupNormalRowContainers=function(){var e,t,o=this,n=this.printLayout?(e=this.beans.columnController.getAllDisplayedColumns(),t=[],[]):(e=this.beans.columnController.getAllDisplayedCenterVirtualColumnsForRow(this.rowNode),t=this.beans.columnController.getDisplayedLeftColumnsForRow(this.rowNode),this.beans.columnController.getDisplayedRightColumnsForRow(this.rowNode));this.createRowContainer(this.bodyContainerComp,e,function(e){return o.eBodyRow=e}),this.createRowContainer(this.pinnedRightContainerComp,n,function(e){return o.ePinnedRightRow=e}),this.createRowContainer(this.pinnedLeftContainerComp,t,function(e){return o.ePinnedLeftRow=e})},n.prototype.createFullWidthRows=function(e,t){var o=this;this.fullWidthRow=!0,this.embedFullWidth?(this.createFullWidthRowContainer(this.bodyContainerComp,null,null,e,t,function(e){o.eFullWidthRowBody=e},function(e){o.fullWidthRowComponentBody=e}),this.printLayout||(this.createFullWidthRowContainer(this.pinnedLeftContainerComp,column_1.Column.PINNED_LEFT,"ag-cell-last-left-pinned",e,t,function(e){o.eFullWidthRowLeft=e},function(e){o.fullWidthRowComponentLeft=e}),this.createFullWidthRowContainer(this.pinnedRightContainerComp,column_1.Column.PINNED_RIGHT,"ag-cell-first-right-pinned",e,t,function(e){o.eFullWidthRowRight=e},function(e){o.fullWidthRowComponentRight=e}))):this.createFullWidthRowContainer(this.fullWidthContainerComp,null,null,e,t,function(e){o.eFullWidthRow=e},function(e){o.fullWidthRowComponent=e})},n.prototype.setAnimateFlags=function(e){e?(e=utils_1._.exists(this.rowNode.oldRowTop),this.slideRowIn=e,this.fadeRowIn=!e):(this.slideRowIn=!1,this.fadeRowIn=!1)},n.prototype.isEditing=function(){return this.editingRow},n.prototype.stopRowEditing=function(e){this.stopEditing(e)},n.prototype.isFullWidth=function(){return this.fullWidthRow},n.prototype.refreshFullWidth=function(){var n=this,e=function(e,t,o){if(!e||!t)return!0;if(!t.refresh)return!1;o=n.createFullWidthParams(e,o);return t.refresh(o)},t=e(this.eFullWidthRow,this.fullWidthRowComponent,null),o=e(this.eFullWidthRowBody,this.fullWidthRowComponentBody,null),s=e(this.eFullWidthRowLeft,this.fullWidthRowComponentLeft,column_1.Column.PINNED_LEFT),e=e(this.eFullWidthRowRight,this.fullWidthRowComponentRight,column_1.Column.PINNED_RIGHT);return t&&o&&s&&e},n.prototype.addListeners=function(){this.addDestroyableEventListener(this.rowNode,rowNode_1.RowNode.EVENT_HEIGHT_CHANGED,this.onRowHeightChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,rowNode_1.RowNode.EVENT_ROW_SELECTED,this.onRowSelected.bind(this)),this.addDestroyableEventListener(this.rowNode,rowNode_1.RowNode.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,rowNode_1.RowNode.EVENT_TOP_CHANGED,this.onTopChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,rowNode_1.RowNode.EVENT_EXPANDED_CHANGED,this.onExpandedChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,rowNode_1.RowNode.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,rowNode_1.RowNode.EVENT_CELL_CHANGED,this.onRowNodeCellChanged.bind(this)),this.addDestroyableEventListener(this.rowNode,rowNode_1.RowNode.EVENT_DRAGGING_CHANGED,this.onRowNodeDraggingChanged.bind(this));var e=this.beans.eventService;this.addDestroyableEventListener(e,events_1.Events.EVENT_HEIGHT_SCALE_CHANGED,this.onTopChanged.bind(this)),this.addDestroyableEventListener(e,events_1.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addDestroyableEventListener(e,events_1.Events.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addDestroyableEventListener(e,events_1.Events.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addDestroyableEventListener(e,events_1.Events.EVENT_CELL_FOCUSED,this.onCellFocusChanged.bind(this)),this.addDestroyableEventListener(e,events_1.Events.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addDestroyableEventListener(e,events_1.Events.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addDestroyableEventListener(e,events_1.Events.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addListenersForCellComps()},n.prototype.addListenersForCellComps=function(){var e=this;this.addDestroyableEventListener(this.rowNode,rowNode_1.RowNode.EVENT_ROW_INDEX_CHANGED,function(){e.forEachCellComp(function(e){return e.onRowIndexChanged()})}),this.addDestroyableEventListener(this.rowNode,rowNode_1.RowNode.EVENT_CELL_CHANGED,function(t){e.forEachCellComp(function(e){return e.onCellChanged(t)})})},n.prototype.onGridColumnsChanged=function(){this.removeRenderedCells(Object.keys(this.cellComps))},n.prototype.onRowNodeDataChanged=function(t){this.forEachCellComp(function(e){return e.refreshCell({suppressFlash:!t.update,newData:!t.update})}),this.onRowSelected(),this.postProcessCss()},n.prototype.onRowNodeCellChanged=function(e){this.postProcessCss()},n.prototype.postProcessCss=function(){this.postProcessStylesFromGridOptions(),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()},n.prototype.onRowNodeDraggingChanged=function(){this.postProcessRowDragging()},n.prototype.postProcessRowDragging=function(){var t=this.rowNode.dragging;this.eAllRowContainers.forEach(function(e){return utils_1._.addOrRemoveCssClass(e,"ag-row-dragging",t)})},n.prototype.onExpandedChanged=function(){var t=this.rowNode;this.eAllRowContainers.forEach(function(e){return utils_1._.addOrRemoveCssClass(e,"ag-row-group-expanded",t.expanded)}),this.eAllRowContainers.forEach(function(e){return utils_1._.addOrRemoveCssClass(e,"ag-row-group-contracted",!t.expanded)})},n.prototype.onDisplayedColumnsChanged=function(){this.fullWidthRow||this.refreshCells()},n.prototype.destroyFullWidthComponents=function(){this.fullWidthRowComponent&&(this.beans.detailRowCompCache.addOrDestroy(this.rowNode,null,this.fullWidthRowComponent),this.fullWidthRowComponent=null),this.fullWidthRowComponentBody&&(this.beans.detailRowCompCache.addOrDestroy(this.rowNode,null,this.fullWidthRowComponentBody),this.fullWidthRowComponent=null),this.fullWidthRowComponentLeft&&(this.beans.detailRowCompCache.addOrDestroy(this.rowNode,column_1.Column.PINNED_LEFT,this.fullWidthRowComponentLeft),this.fullWidthRowComponentLeft=null),this.fullWidthRowComponentRight&&(this.beans.detailRowCompCache.addOrDestroy(this.rowNode,column_1.Column.PINNED_RIGHT,this.fullWidthRowComponentRight),this.fullWidthRowComponent=null)},n.prototype.getContainerForCell=function(e){switch(e){case column_1.Column.PINNED_LEFT:return this.ePinnedLeftRow;case column_1.Column.PINNED_RIGHT:return this.ePinnedRightRow;default:return this.eBodyRow}},n.prototype.onVirtualColumnsChanged=function(){this.fullWidthRow||this.refreshCells()},n.prototype.onColumnResized=function(){this.fullWidthRow||this.refreshCells()},n.prototype.refreshCells=function(){this.areAllContainersReady()?this.beans.gridOptionsWrapper.isSuppressAnimationFrame()||this.printLayout?this.refreshCellsInAnimationFrame():this.columnRefreshPending||this.beans.taskQueue.addP1Task(this.refreshCellsInAnimationFrame.bind(this),this.rowNode.rowIndex):this.refreshNeeded=!0},n.prototype.refreshCellsInAnimationFrame=function(){var e,t,o,n;this.active&&(this.columnRefreshPending=!1,n=this.printLayout?(e=this.beans.columnController.getAllDisplayedColumns(),t=[],[]):(e=this.beans.columnController.getAllDisplayedCenterVirtualColumnsForRow(this.rowNode),t=this.beans.columnController.getDisplayedLeftColumnsForRow(this.rowNode),this.beans.columnController.getDisplayedRightColumnsForRow(this.rowNode)),this.insertCellsIntoContainer(this.eBodyRow,e),this.insertCellsIntoContainer(this.ePinnedLeftRow,t),this.insertCellsIntoContainer(this.ePinnedRightRow,n),o=Object.keys(this.cellComps),e.forEach(function(e){return utils_1._.removeFromArray(o,e.getId())}),t.forEach(function(e){return utils_1._.removeFromArray(o,e.getId())}),n.forEach(function(e){return utils_1._.removeFromArray(o,e.getId())}),n=utils_1._.filter(o,this.isCellEligibleToBeRemoved.bind(this)),this.removeRenderedCells(n))},n.prototype.removeRenderedCells=function(e){var o=this;e.forEach(function(e){var t=o.cellComps[e];utils_1._.missing(t)||(t.detach(),t.destroy(),o.cellComps[e]=null)})},n.prototype.isCellEligibleToBeRemoved=function(e){var t=this.beans.columnController.getAllDisplayedColumns(),o=this.cellComps[e];if(!o)return!0;if(this.isCellInWrongRow(o))return!0;var n=o.isEditing(),e=this.beans.focusedCellController.isCellFocused(o.getCellPosition());if(n||e){o=o.getColumn();return!(0<=t.indexOf(o))}return!0},n.prototype.ensureCellInCorrectContainer=function(e){var t,o,n;this.printLayout||(t=e.getGui(),n=e.getColumn().getPinned(),o=this.getContainerForCell(n),(n=e.getParentRow())!==o&&(n&&n.removeChild(t),o.appendChild(t),e.setParentRow(o)))},n.prototype.isCellInWrongRow=function(e){var t=e.getColumn(),t=this.getContainerForCell(t.getPinned());return e.getParentRow()!==t},n.prototype.insertCellsIntoContainer=function(o,e){var n,s,i=this;o&&(n=[],s=[],e.forEach(function(e){var t=e.getId(),t=i.cellComps[t];t?i.ensureCellInCorrectContainer(t):i.createNewCell(e,o,n,s)}),0<n.length&&(utils_1._.appendHtml(o,n.join("")),this.callAfterRowAttachedOnCells(s,o)))},n.prototype.addDomData=function(e){var t=this.beans.gridOptionsWrapper;t.setDomData(e,n.DOM_DATA_KEY_RENDERED_ROW,this),this.addDestroyFunc(function(){t.setDomData(e,n.DOM_DATA_KEY_RENDERED_ROW,null)})},n.prototype.createNewCell=function(e,t,o,n){var s=new cellComp_1.CellComp(this.scope,this.beans,e,this.rowNode,this,!1,this.printLayout),i=s.getCreateTemplate();o.push(i),n.push(s),(this.cellComps[e.getId()]=s).setParentRow(t)},n.prototype.onMouseEvent=function(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t)}},n.prototype.createRowEvent=function(e,t){return{type:e,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,context:this.beans.gridOptionsWrapper.getContext(),api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),event:t}},n.prototype.createRowEventWithSource=function(e,t){t=this.createRowEvent(e,t);return t.source=this,t},n.prototype.onRowDblClick=function(e){utils_1._.isStopPropagationForAgGrid(e)||(e=this.createRowEventWithSource(events_1.Events.EVENT_ROW_DOUBLE_CLICKED,e),this.beans.eventService.dispatchEvent(e))},n.prototype.onRowClick=function(e){var t,o,n;utils_1._.isStopPropagationForAgGrid(e)||(o=this.createRowEventWithSource(events_1.Events.EVENT_ROW_CLICKED,e),this.beans.eventService.dispatchEvent(o),n=e.ctrlKey||e.metaKey,t=e.shiftKey,this.rowNode.group||!this.rowNode.selectable||this.rowNode.rowPinned||!this.beans.gridOptionsWrapper.isRowSelection()||this.beans.gridOptionsWrapper.isSuppressRowClickSelection()||(o=this.beans.gridOptionsWrapper.isRowMultiSelectWithClick(),e=this.beans.gridOptionsWrapper.isRowDeselection(),this.rowNode.isSelected()?o?this.rowNode.setSelectedParams({newValue:!1}):n?e&&this.rowNode.setSelectedParams({newValue:!1}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!0}):(n=!o&&!n,this.rowNode.setSelectedParams({newValue:!0,clearSelection:n,rangeSelect:t}))))},n.prototype.createFullWidthRowContainer=function(s,i,e,r,a,l,d){var h=this,e=this.createTemplate("",e);s.appendRowTemplate(e,function(){function e(e){var t;h.isAlive()?(t=e.getGui(),o.appendChild(t),d(e)):e.destroy&&e.destroy()}var o=s.getRowElement(h.getCompId()),t=h.createFullWidthParams(o,i),n=h.beans.detailRowCompCache.get(h.rowNode,i);if(n)e(n);else{t=h.beans.userComponentFactory.newFullWidthCellRenderer(t,r,a);if(!t)return void console.error("ag-Grid: fullWidthCellRenderer not defined");t.then(e)}h.afterRowAttached(s,o),l(o),h.angular1Compile(o)})},n.prototype.angular1Compile=function(e){this.scope&&this.beans.$compile(e)(this.scope)},n.prototype.createFullWidthParams=function(e,t){return{fullWidth:!0,data:this.rowNode.data,node:this.rowNode,value:this.rowNode.key,$scope:this.scope||this.parentScope,$compile:this.beans.$compile,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),context:this.beans.gridOptionsWrapper.getContext(),eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this)}},n.prototype.getInitialRowClasses=function(e){var t=[],o=this.beans.gridOptionsWrapper.isTreeData(),n=this.rowNode;return utils_1._.exists(e)&&t.push(e),t.push("ag-row"),t.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeRowIn&&t.push("ag-opacity-zero"),t.push(this.rowIsEven?"ag-row-even":"ag-row-odd"),n.isSelected()&&t.push("ag-row-selected"),n.group?(t.push("ag-row-group"),t.push("ag-row-level-"+n.level),n.footer&&t.push("ag-row-footer")):t.push("ag-row-level-"+(n.parent?n.parent.level+1:"0")),n.stub&&t.push("ag-row-stub"),this.fullWidthRow&&t.push("ag-full-width-row"),(o?n.allChildrenCount:n.group&&!n.footer)&&t.push(n.expanded?"ag-row-group-expanded":"ag-row-group-contracted"),n.dragging&&t.push("ag-row-dragging"),utils_1._.pushAll(t,this.processClassesFromGridOptions()),utils_1._.pushAll(t,this.preProcessRowClassRules()),t.push(this.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),this.firstRowOnPage=this.isFirstRowOnPage(),this.lastRowOnPage=this.isLastRowOnPage(),this.firstRowOnPage&&t.push("ag-row-first"),this.lastRowOnPage&&t.push("ag-row-last"),t},n.prototype.isFirstRowOnPage=function(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageFirstRow()},n.prototype.isLastRowOnPage=function(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageLastRow()},n.prototype.onModelUpdated=function(){var t=this.isFirstRowOnPage(),o=this.isLastRowOnPage();this.firstRowOnPage!==t&&(this.firstRowOnPage=t,this.eAllRowContainers.forEach(function(e){return utils_1._.addOrRemoveCssClass(e,"ag-row-first",t)})),this.lastRowOnPage!==o&&(this.lastRowOnPage=o,this.eAllRowContainers.forEach(function(e){return utils_1._.addOrRemoveCssClass(e,"ag-row-last",o)}))},n.prototype.preProcessRowClassRules=function(){var t=[];return this.processRowClassRules(function(e){t.push(e)},function(e){}),t},n.prototype.processRowClassRules=function(e,t){this.beans.stylingService.processClassRules(this.beans.gridOptionsWrapper.rowClassRules(),{value:void 0,colDef:void 0,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),$scope:this.scope,context:this.beans.gridOptionsWrapper.getContext()},e,t)},n.prototype.stopEditing=function(t){var e;void 0===t&&(t=!1),this.forEachCellComp(function(e){e.stopEditing(t)}),this.editingRow&&(t||(e=this.createRowEvent(events_1.Events.EVENT_ROW_VALUE_CHANGED),this.beans.eventService.dispatchEvent(e)),this.setEditingRow(!1))},n.prototype.setEditingRow=function(t){this.editingRow=t,this.eAllRowContainers.forEach(function(e){return utils_1._.addOrRemoveCssClass(e,"ag-row-editing",t)});var e=t?this.createRowEvent(events_1.Events.EVENT_ROW_EDITING_STARTED):this.createRowEvent(events_1.Events.EVENT_ROW_EDITING_STOPPED);this.beans.eventService.dispatchEvent(e)},n.prototype.startRowEditing=function(o,n,s){void 0===o&&(o=null),void 0===n&&(n=null),void 0===s&&(s=null),this.editingRow||(this.forEachCellComp(function(e){var t=e===s;t?e.startEditingIfEnabled(o,n,t):e.startEditingIfEnabled(null,null,t)}),this.setEditingRow(!0))},n.prototype.forEachCellComp=function(o){utils_1._.iterateObject(this.cellComps,function(e,t){t&&o(t)})},n.prototype.postProcessClassesFromGridOptions=function(){var e=this,t=this.processClassesFromGridOptions();t&&t.length&&t.forEach(function(t){e.eAllRowContainers.forEach(function(e){return utils_1._.addCssClass(e,t)})})},n.prototype.postProcessRowClassRules=function(){var e=this;this.processRowClassRules(function(t){e.eAllRowContainers.forEach(function(e){return utils_1._.addCssClass(e,t)})},function(t){e.eAllRowContainers.forEach(function(e){return utils_1._.removeCssClass(e,t)})})},n.prototype.processClassesFromGridOptions=function(){function e(e){"string"==typeof e?t.push(e):Array.isArray(e)&&e.forEach(function(e){return t.push(e)})}var t=[],o=this.beans.gridOptionsWrapper.getRowClass();if(o){if("function"==typeof o)return void console.warn("ag-Grid: rowClass should not be a function, please use getRowClass instead");e(o)}o=this.beans.gridOptionsWrapper.getRowClassFunc();return o&&e(o({node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,context:this.beans.gridOptionsWrapper.getContext(),api:this.beans.gridOptionsWrapper.getApi()})),t},n.prototype.preProcessStylesFromGridOptions=function(){var e=this.processStylesFromGridOptions();return utils_1._.cssStyleObjectToMarkup(e)},n.prototype.postProcessStylesFromGridOptions=function(){var t=this.processStylesFromGridOptions();this.eAllRowContainers.forEach(function(e){return utils_1._.addStylesToElement(e,t)})},n.prototype.processStylesFromGridOptions=function(){var e=this.beans.gridOptionsWrapper.getRowStyle();if(!e||"function"!=typeof e){var t,o=this.beans.gridOptionsWrapper.getRowStyleFunc();return o&&(t=o({data:this.rowNode.data,node:this.rowNode,api:this.beans.gridOptionsWrapper.getApi(),context:this.beans.gridOptionsWrapper.getContext(),$scope:this.scope})),utils_1._.assign({},e,t)}console.warn("ag-Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead")},n.prototype.createCells=function(e){var n=this,s=[],i=[];return e.forEach(function(e){var t=new cellComp_1.CellComp(n.scope,n.beans,e,n.rowNode,n,!1,n.printLayout),o=t.getCreateTemplate();s.push(o),i.push(t),n.cellComps[e.getId()]=t}),{template:s.join(""),cellComps:i}},n.prototype.onRowSelected=function(){var t=this.rowNode.isSelected();this.eAllRowContainers.forEach(function(e){return utils_1._.addOrRemoveCssClass(e,"ag-row-selected",t)})},n.prototype.callAfterRowAttachedOnCells=function(e,t){var o=this;e.forEach(function(e){e.setParentRow(t),e.afterAttached(),o.editingRow&&e.startEditingIfEnabled()})},n.prototype.afterRowAttached=function(e,t){var o=this;this.addDomData(t),this.removeSecondPassFuncs.push(function(){e.removeRowElement(t)}),this.removeFirstPassFuncs.push(function(){var e;utils_1._.exists(o.rowNode.rowTop)?(e=o.roundRowTopToBounds(o.rowNode.rowTop),o.setRowTop(e)):utils_1._.addCssClass(t,"ag-opacity-zero")}),this.eAllRowContainers.push(t),this.useAnimationFrameForCreate?this.beans.taskQueue.addP2Task(this.addHoverFunctionality.bind(this,t)):this.addHoverFunctionality(t)},n.prototype.addHoverFunctionality=function(e){var t=this;this.active&&(this.addDestroyableEventListener(e,"mouseenter",function(){return t.rowNode.onMouseEnter()}),this.addDestroyableEventListener(e,"mouseleave",function(){return t.rowNode.onMouseLeave()}),this.addDestroyableEventListener(this.rowNode,rowNode_1.RowNode.EVENT_MOUSE_ENTER,function(){t.beans.gridOptionsWrapper.isSuppressRowHoverHighlight()||utils_1._.addCssClass(e,"ag-row-hover")}),this.addDestroyableEventListener(this.rowNode,rowNode_1.RowNode.EVENT_MOUSE_LEAVE,function(){utils_1._.removeCssClass(e,"ag-row-hover")}))},n.prototype.roundRowTopToBounds=function(e){var t=this.beans.gridPanel.getVScrollPosition(),o=this.applyPaginationOffset(t.top,!0)-100,t=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(o,e),t)},n.prototype.getFrameworkOverrides=function(){return this.beans.frameworkOverrides},n.prototype.onRowHeightChanged=function(){var t;utils_1._.exists(this.rowNode.rowHeight)&&(t=this.rowNode.rowHeight+"px",this.eAllRowContainers.forEach(function(e){return e.style.height=t}))},n.prototype.addEventListener=function(e,t){"renderedRowRemoved"!==e&&"rowRemoved"!==e||(e=events_1.Events.EVENT_VIRTUAL_ROW_REMOVED,console.warn("ag-Grid: Since version 11, event renderedRowRemoved is now called "+events_1.Events.EVENT_VIRTUAL_ROW_REMOVED)),u.prototype.addEventListener.call(this,e,t)},n.prototype.removeEventListener=function(e,t){"renderedRowRemoved"!==e&&"rowRemoved"!==e||(e=events_1.Events.EVENT_VIRTUAL_ROW_REMOVED,console.warn("ag-Grid: Since version 11, event renderedRowRemoved and rowRemoved is now called "+events_1.Events.EVENT_VIRTUAL_ROW_REMOVED)),u.prototype.removeEventListener.call(this,e,t)},n.prototype.destroy=function(e){void 0===e&&(e=!1),u.prototype.destroy.call(this),this.active=!1,this.destroyFullWidthComponents(),e?(this.removeFirstPassFuncs.forEach(function(e){return e()}),this.removeSecondPassFuncs.push(this.destroyContainingCells.bind(this))):(this.destroyContainingCells(),this.getAndClearDelayedDestroyFunctions().forEach(function(e){return e()}));e=this.createRowEvent(events_1.Events.EVENT_VIRTUAL_ROW_REMOVED);this.dispatchEvent(e),this.beans.eventService.dispatchEvent(e)},n.prototype.destroyContainingCells=function(){this.forEachCellComp(function(e){return e.destroy()}),this.destroyFullWidthComponents()},n.prototype.getAndClearDelayedDestroyFunctions=function(){var e=this.removeSecondPassFuncs;return this.removeSecondPassFuncs=[],e},n.prototype.onCellFocusChanged=function(){var t=this.beans.focusedCellController.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.eAllRowContainers.forEach(function(e){return utils_1._.addOrRemoveCssClass(e,"ag-row-focus",t)}),this.eAllRowContainers.forEach(function(e){return utils_1._.addOrRemoveCssClass(e,"ag-row-no-focus",!t)}),this.rowFocused=t),!t&&this.editingRow&&this.stopEditing(!1)},n.prototype.onPaginationChanged=function(){var e=this.beans.paginationProxy.getCurrentPage();this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged())},n.prototype.onTopChanged=function(){this.setRowTop(this.rowNode.rowTop)},n.prototype.applyPaginationOffset=function(e,t){return void 0===t&&(t=!1),this.rowNode.isRowPinned()?e:e+this.beans.paginationProxy.getPixelOffset()*(t?1:-1)},n.prototype.setRowTop=function(e){var t;this.printLayout||utils_1._.exists(e)&&(e=this.applyPaginationOffset(e),t=this.beans.maxDivHeightScaler.getRealPixelPosition(e)+"px",this.beans.gridOptionsWrapper.isSuppressRowTransform()?this.eAllRowContainers.forEach(function(e){return e.style.top=t}):this.eAllRowContainers.forEach(function(e){return e.style.transform="translateY("+t+")"}))},n.prototype.getAndClearNextVMTurnFunctions=function(){var e=this.createSecondPassFuncs;return this.createSecondPassFuncs=[],e},n.prototype.getRowNode=function(){return this.rowNode},n.prototype.getRenderedCellForColumn=function(t){var o=this,e=this.cellComps[t.getColId()];if(e)return e;e=Object.keys(this.cellComps).map(function(e){return o.cellComps[e]}).filter(function(e){return e&&-1!==e.getColSpanningList().indexOf(t)});return e.length?e[0]:void 0},n.prototype.onRowIndexChanged=function(){this.onCellFocusChanged(),this.updateRowIndexes()},n.prototype.updateRowIndexes=function(){var t=this,o=this.rowNode.getRowIndexString(),n=this.rowNode.rowIndex%2==0,s=this.rowIsEven!==n,i=this.beans.gridPanel.headerRootComp.getHeaderRowCount();s&&(this.rowIsEven=n),this.eAllRowContainers.forEach(function(e){e.setAttribute("row-index",o),e.setAttribute("aria-rowindex",(i+t.rowNode.rowIndex+1).toString()),s&&(utils_1._.addOrRemoveCssClass(e,"ag-row-even",n),utils_1._.addOrRemoveCssClass(e,"ag-row-odd",!n))})},n.prototype.ensureDomOrder=function(){[{el:this.getBodyRowElement(),ct:this.bodyContainerComp},{el:this.getPinnedLeftRowElement(),ct:this.pinnedLeftContainerComp},{el:this.getPinnedRightRowElement(),ct:this.pinnedRightContainerComp},{el:this.getFullWidthRowElement(),ct:this.fullWidthContainerComp}].forEach(function(e){e.el&&e.ct.ensureDomOrder(e.el)})},n.prototype.getPinnedLeftRowElement=function(){return this.ePinnedLeftRow||this.eFullWidthRowLeft},n.prototype.getPinnedRightRowElement=function(){return this.ePinnedRightRow||this.eFullWidthRowRight},n.prototype.getBodyRowElement=function(){return this.eBodyRow||this.eFullWidthRowBody},n.prototype.getFullWidthRowElement=function(){return this.eFullWidthRow},n.DOM_DATA_KEY_RENDERED_ROW="renderedRow",n.FULL_WIDTH_CELL_RENDERER="fullWidthCellRenderer",n.GROUP_ROW_RENDERER="groupRowRenderer",n.GROUP_ROW_RENDERER_COMP_NAME="agGroupRowRenderer",n.LOADING_CELL_RENDERER="loadingCellRenderer",n.LOADING_CELL_RENDERER_COMP_NAME="agLoadingCellRenderer",n.DETAIL_CELL_RENDERER="detailCellRenderer",n.DETAIL_CELL_RENDERER_COMP_NAME="agDetailCellRenderer",n}(component_1.Component);exports.RowComp=RowComp;
"use strict";var __decorate=this&&this.__decorate||function(t,e,o,r){var i,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,r);else for(var c=t.length-1;0<=c;c--)(i=t[c])&&(s=(a<3?i(s):3<a?i(e,o,s):i(e,o))||s);return 3<a&&s&&Object.defineProperty(e,o,s),s},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(exports,"__esModule",{value:!0});var column_1=require("../entities/column"),context_1=require("../context/context"),gridOptionsWrapper_1=require("../gridOptionsWrapper"),DetailRowCompCache=function(){function t(){this.cacheItems=[]}return t.prototype.postConstruct=function(){this.active=this.gridOptionsWrapper.isKeepDetailRows(),this.maxCacheSize=this.gridOptionsWrapper.getKeepDetailRowsCount()},t.prototype.addOrDestroy=function(t,e,o){if(!this.active||!t.detail)this.destroyFullWidthRow(o);else{t=this.getCacheItem(t,!0);switch(e){case column_1.Column.PINNED_LEFT:this.destroyFullWidthRow(t.left),t.left=o;break;case column_1.Column.PINNED_RIGHT:this.destroyFullWidthRow(t.right),t.right=o;break;default:this.destroyFullWidthRow(t.center),t.center=o}this.cacheItems.sort(function(t,e){return e.lastAccessedTime-t.lastAccessedTime}),this.purgeCache(this.maxCacheSize)}},t.prototype.getCacheItem=function(t,e){var o;void 0===e&&(e=!1);for(var r=0;r<this.cacheItems.length;r++){var i=this.cacheItems[r];if(i.rowNode===t){o=i;break}}return!o&&e&&(o={rowNode:t},this.cacheItems.push(o)),o&&this.stampCacheItem(o),o},t.prototype.stampCacheItem=function(t){t.lastAccessedTime=(new Date).getTime()},t.prototype.destroyFullWidthRow=function(t){t&&t.destroy&&t.destroy()},t.prototype.purgeCache=function(t){for(var e=t;e<this.cacheItems.length;e++){var o=this.cacheItems[e];this.destroyFullWidthRow(o.center),this.destroyFullWidthRow(o.left),this.destroyFullWidthRow(o.right)}this.cacheItems.length>t&&(this.cacheItems.length=t)},t.prototype.get=function(t,e){if(t.detail){var o,t=this.getCacheItem(t);if(t)switch(e){case column_1.Column.PINNED_LEFT:t.left&&(o=t.left,t.left=void 0);break;case column_1.Column.PINNED_RIGHT:t.right&&(o=t.right,t.right=void 0);break;default:t.center&&(o=t.center,t.center=void 0)}return o}},t.prototype.destroy=function(){this.purgeCache(0)},__decorate([context_1.Autowired("gridOptionsWrapper"),__metadata("design:type",gridOptionsWrapper_1.GridOptionsWrapper)],t.prototype,"gridOptionsWrapper",void 0),__decorate([context_1.PostConstruct,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],t.prototype,"postConstruct",null),__decorate([context_1.PreDestroy,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],t.prototype,"destroy",null),__decorate([context_1.Bean("detailRowCompCache")],t)}();exports.DetailRowCompCache=DetailRowCompCache;
"use strict";var GlobalSet,protoIsSupported,set_makeObservable,set_clear,set_add,set_delete,observableSetProperties,ChangeDispatchSet,Set=require("./_set"),PropertyChanges=require("./listen/property-changes"),RangeChanges=require("./listen/range-changes"),MapChanges=require("./listen/map-changes"),SIZE="size";function setupCollectionSet(){function s(e,t,a,r){return i._init(s,this,e,t,a,r)}var i=Set.CollectionsSet;(s.Set=s).from=i.from,((Set.CollectionsSet=s).prototype=new i).constructor=s;var e=require("./list"),t=require("./fast-set");s.prototype.Order=e,s.prototype.Store=t,Object.defineProperty(s.prototype,"_dispatchEmptyArray",{value:[]}),s.prototype.add=function(e){var t=new this.order.Node(e);if(this.store.has(t))return!1;var a=this.length,r=[e];return this.dispatchBeforeOwnPropertyChange(SIZE,a),this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange(r,this._dispatchEmptyArray,a),this.order.add(e),t=this.order.head.prev,this.store.add(t),this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange(r,this._dispatchEmptyArray,a),this.dispatchOwnPropertyChange(SIZE,a+1),!0},s.prototype.delete=function(e,t){if(t)throw new Error("Set#delete does not support second argument: equals");var a=new this.order.Node(e);if(this.store.has(a)){a=this.store.get(a);var r=[e];return this.dispatchBeforeOwnPropertyChange(SIZE,this.length),this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange(this._dispatchEmptyArray,r,a.index),this.store.delete(a),this.order.splice(a,1),this.length--,this.dispatchesRangeChanges&&this.dispatchRangeChange(this._dispatchEmptyArray,r,a.index),this.dispatchOwnPropertyChange(SIZE,this.length),!0}return!1},s.prototype.clear=function(){var e,t=this.length;t&&this.dispatchBeforeOwnPropertyChange(SIZE,t),this.dispatchesRangeChanges&&(e=this.toArray(),this.dispatchBeforeRangeChange(this._dispatchEmptyArray,e,0)),this._clear(),this.dispatchesRangeChanges&&this.dispatchRangeChange(this._dispatchEmptyArray,e,0),t&&this.dispatchOwnPropertyChange(SIZE,0)},Object.addEach(Set.CollectionsSet.prototype,PropertyChanges.prototype),Object.addEach(Set.CollectionsSet.prototype,RangeChanges.prototype),Set.CollectionsSet.prototype.makeObservable=function(){this.order.makeObservable()},module.exports=s}void 0!==global.Set&&"function"==typeof global.Set.prototype.values?(GlobalSet=global.Set,module.exports=Set,set_makeObservable=(protoIsSupported={}.__proto__===Object.prototype)?function(){this.__proto__=ChangeDispatchSet}:function(){Object.defineProperties(this,observableSetProperties)},Object.defineProperty(GlobalSet.prototype,"makeObservable",{value:set_makeObservable,writable:!0,configurable:!0,enumerable:!1}),set_clear=GlobalSet.prototype.clear,set_add=GlobalSet.prototype.add,set_delete=GlobalSet.prototype.delete,observableSetProperties={_dispatchEmptyArray:{value:[]},clear:{value:function(){var e,t=this.size;t&&this.dispatchBeforeOwnPropertyChange(SIZE,t),this.dispatchesRangeChanges&&(e=this.toArray(),this.dispatchBeforeRangeChange(this._dispatchEmptyArray,e,0)),set_clear.call(this),this.dispatchesRangeChanges&&this.dispatchRangeChange(this._dispatchEmptyArray,e,0),t&&this.dispatchOwnPropertyChange(SIZE,0)},writable:!0,configurable:!0},add:{value:function(e){if(this.has(e))return!1;var t=this.size,a=[e];return this.dispatchBeforeOwnPropertyChange(SIZE,t),this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange(a,this._dispatchEmptyArray,t),set_add.call(this,e),this.dispatchesRangeChanges&&this.dispatchRangeChange(a,this._dispatchEmptyArray,t),this.dispatchOwnPropertyChange(SIZE,t+1),!0},writable:!0,configurable:!0},delete:{value:function(e,t){if(this.has(e)){var a=this.size;if(void 0===t){var r=this.values();for(t=0;r.next().value!==e;)t++}this.dispatchBeforeOwnPropertyChange(SIZE,a);var s=[e];return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange(this._dispatchEmptyArray,s,t),set_delete.call(this,e),this.dispatchesRangeChanges&&this.dispatchRangeChange(this._dispatchEmptyArray,s,t),this.dispatchOwnPropertyChange(SIZE,a-1),!0}return!1}}},ChangeDispatchSet=Object.create(GlobalSet.prototype,observableSetProperties),Object.defineEach(Set.prototype,PropertyChanges.prototype,!1,!0,!1,!0),Object.defineProperty(Set.prototype,"makePropertyObservable",{value:function(){},writable:!0,configurable:!0,enumerable:!1}),Object.defineEach(Set.prototype,RangeChanges.prototype,!1,!0,!1,!0),Object.defineEach(Set.prototype,MapChanges.prototype,!1,!0,!1,!0),Object.defineProperty(Set,"_setupCollectionSet",{value:setupCollectionSet,writable:!0,configurable:!0,enumerable:!1})):setupCollectionSet();
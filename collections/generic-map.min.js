"use strict";var Object=require("./shim-object"),Iterator=require("./iterator");function GenericMap(){throw new Error("Can't construct. GenericMap is a mixin.")}function Item(e,t){this.key=e,this.value=t}(module.exports=GenericMap).prototype.isMap=!0,GenericMap.prototype.addEach=function(t){var e;if(t&&Object(t)===t)if("function"==typeof t.forEach)!0===t.isMap?t.forEach(function(e,t){this.set(t,e)},this):t.forEach(function(e){this.set(e[0],e[1])},this);else if("number"==typeof t.length)for(e=0;e<t.length;e++)this.add(t[e],e);else Object.keys(t).forEach(function(e){this.set(e,t[e])},this);else if(t&&"number"==typeof t.length)for(e=0;e<t.length;e++)this.add(t[e],e);return this},GenericMap.prototype.get=function(e,t){var r=this.store.get(new this.Item(e));return r?r.value:1<arguments.length?(console.log("Use of a second argument as default value is deprecated to match standards"),t):this.getDefault(e)},GenericMap.prototype.set=function(e,t){var r=new this.Item(e,t),i=this.store.get(r);return i?(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,i.value),i.value=t):(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,void 0),this.store.add(r)&&(this.length++,0)),this.dispatchesMapChanges&&this.dispatchMapChange(e,t),this},GenericMap.prototype.add=function(e,t){return this.set(t,e)},GenericMap.prototype.has=function(e){return this.store.has(new this.Item(e))},GenericMap.prototype.delete=function(e){var t=new this.Item(e);if(this.store.has(t)){var r=this.store.get(t).value;return this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,r),this.store.delete(t),this.length--,this.dispatchesMapChanges&&this.dispatchMapChange(e,void 0),!0}return!1},GenericMap.prototype.clear=function(){var e,t;if(this.dispatchesMapChanges&&(this.forEach(function(e,t){this.dispatchBeforeMapChange(t,e)},this),e=this.keysArray()),this.store.clear(),this.length=0,this.dispatchesMapChanges)for(var r=0;t=e[r];r++)this.dispatchMapChange(t)},GenericMap.prototype.reduce=function(r,e,i){return this.store.reduce(function(e,t){return r.call(i,e,t.value,t.key,this)},e,this)},GenericMap.prototype.reduceRight=function(r,e,i){return this.store.reduceRight(function(e,t){return r.call(i,e,t.value,t.key,this)},e,this)},GenericMap.prototype.keysArray=function(){return this.map(function(e,t){return t})},GenericMap.prototype.keys=function(){return new Iterator(this.keysArray(),!0)},GenericMap.prototype.valuesArray=function(){return this.map(Function.identity)},GenericMap.prototype.values=function(){return new Iterator(this.valuesArray(),!0)},GenericMap.prototype.entriesArray=function(){return this.map(function(e,t){return[t,e]})},GenericMap.prototype.entries=function(){return new Iterator(this.entriesArray(),!0)},GenericMap.prototype.items=function(){return this.entriesArray()},GenericMap.prototype.equals=function(t,r){return r=r||Object.equals,this===t||(t&&"function"==typeof t.every?t.length===this.length&&t.every(function(e,t){return r(this.get(t),e)},this):Object.keys(t).length===this.length&&Object.keys(t).every(function(e){return r(this.get(e),t[e])},this))},GenericMap.prototype.toJSON=function(){return this.entriesArray()},(GenericMap.prototype.Item=Item).prototype.equals=function(e){return Object.equals(this.key,e.key)&&Object.equals(this.value,e.value)},Item.prototype.compare=function(e){return Object.compare(this.key,e.key)};
import Mmenu from"../../core/oncanvas/mmenu.oncanvas";import options from"./_options";import{extendShorthandOptions}from"./_options";import*as DOM from"../../_modules/dom";import{extend}from"../../_modules/helpers";Mmenu.options.setSelected=options;export default function(){var e=this,t=extendShorthandOptions(this.opts.setSelected);if(this.opts.setSelected=extend(t,Mmenu.options.setSelected),"detect"==t.current){var n=function(t){t=t.split("?")[0].split("#")[0];var i=e.node.menu.querySelector('a[href="'+t+'"], a[href="'+t+'/"]');if(i)e.setSelected(i.parentElement);else{var s=t.split("/").slice(0,-1);s.length&&n(s.join("/"))}};this.bind("initMenu:after",function(){n.call(e,window.location.href)})}else t.current||this.bind("initListview:after",function(e){DOM.children(e,".mm-listitem_selected").forEach(function(e){e.classList.remove("mm-listitem_selected")})});t.hover&&this.bind("initMenu:after",function(){e.node.menu.classList.add("mm-menu_selected-hover")}),t.parent&&(this.bind("openPanel:finish",function(t){DOM.find(e.node.pnls,".mm-listitem_selected-parent").forEach(function(e){e.classList.remove("mm-listitem_selected-parent")});for(var n=t.mmParent;n;)n.matches(".mm-listitem_vertical")||n.classList.add("mm-listitem_selected-parent"),n=(n=n.closest(".mm-panel")).mmParent}),this.bind("initMenu:after",function(){e.node.menu.classList.add("mm-menu_selected-parent")}))};
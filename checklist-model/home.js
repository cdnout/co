"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="checklist-model"),angular.module("checklist-model",[]).directive("checklistModel",["$parse","$compile",function($,k){function v(e,n,t){if(angular.isArray(e))for(var r=e.length;r--;)if(t(e[r],n))return!0;return!1}function m(e,n,t){return v(e=angular.isArray(e)?e:[],n,t)||e.push(n),e}function M(e,n,t){if(angular.isArray(e))for(var r=e.length;r--;)if(t(e[r],n)){e.splice(r,1);break}return e}function t(r,e,a){var n=a.checklistModel;a.$set("checklistModel",null),k(e)(r),a.$set("checklistModel",n);var i=$(n),t=$(a.checklistChange),o=$(a.checklistBeforeChange),c=$(a.ngModel),l=function(e,n){return isNaN(e)||isNaN(n)?angular.equals(e,n):String(e)===String(n)};if(a.hasOwnProperty("checklistComparator"))if("."==a.checklistComparator[0]){var s=a.checklistComparator.substring(1);l=function(e,n){return e[s]===n[s]}}else l=$(a.checklistComparator)(r.$parent);var u=r.$watch(a.ngModel,function(e,n){e!==n&&(o&&!1===o(r)?c.assign(r,v(i(r.$parent),h(),l)):(g(h(),e),t&&t(r)))}),p=r.$watch(h,function(e,n){if(e!=n&&angular.isDefined(n)&&!0===r[a.ngModel]){var t=i(r.$parent);i.assign(r.$parent,M(t,n,l)),i.assign(r.$parent,m(t,e,l))}},!0),f=r.$on("$destroy",function(){u(),p(),f()});function h(){return a.checklistValue?$(a.checklistValue)(r.$parent):a.value}function g(e,n){var t=i(r.$parent);angular.isFunction(i.assign)&&(!0===n?i.assign(r.$parent,m(t,e,l)):i.assign(r.$parent,M(t,e,l)))}function d(e,n){o&&!1===o(r)?g(h(),c(r)):c.assign(r,v(e,h(),l))}angular.isFunction(r.$parent.$watchCollection)?r.$parent.$watchCollection(n,d):r.$parent.$watch(n,d,!0)}return{restrict:"A",priority:1e3,terminal:!0,scope:!0,compile:function(e,n){if(!n.checklistValue&&!n.value)throw"You should provide `value` or `checklist-value`.";return n.ngModel||n.$set("ngModel","checked"),t}}}]);
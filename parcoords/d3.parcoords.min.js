d3.parcoords=function(e){function t(e,t,n){d3.keys(t).forEach(function(r){e[r]=function(i){if(!arguments.length)return t[r];"dimensions"===r&&"[object Array]"===Object.prototype.toString.call(i)&&(console.warn("pc.dimensions([]) is deprecated, use pc.dimensions({})"),i=D.applyDimensionDefaults(i));var s=t[r];return t[r]=i,X[r].call(D,{value:i,previous:s}),n[r].call(D,{value:i,previous:s}),e}})}function n(e,t){for(var n in t)e[n]=t[n];return e}function r(e,t){return t.forEach(function(t){delete e[t]}),e}function i(){return"bottom"==w.nullValueSeparator?[E()+1-w.nullValueSeparatorPadding.bottom-w.nullValueSeparatorPadding.top,1]:"top"==w.nullValueSeparator?[E()+1,1+w.nullValueSeparatorPadding.bottom+w.nullValueSeparatorPadding.top]:[E()+1,1]}function s(){if(w.brushed&&w.brushed.length!==w.data.length)return!0;var e=B.currentMode().brushState();for(var t in e)if(e.hasOwnProperty(t))return!0;return!1}function a(e){var t=d3.map(),n=d3.map();return w.data.forEach(function(t){var r=w.dimensions[e].yscale(t[e]);n.has(r)||n.set(r,0);var i=n.get(r);n.set(r,i+1)}),w.data.forEach(function(r){d3.keys(w.dimensions).map(function(i,s){var a=w.dimensions[e].yscale(r[e]);if(!t.has(a)){var o=d3.map();t.set(a,o)}t.get(a).has(i)||t.get(a).set(i,0);var l=t.get(a).get(i);l+=w.dimensions[i].yscale(r[i])/n.get(a),t.get(a).set(i,l)})}),t}function o(e){for(var t=[],n=d3.keys(w.dimensions),r=n.length,i=.5,s=0;s<r;++s){var a=A(n[s]),o=w.dimensions[n[s]].yscale(e[n[s]]);if(t.push($V([a,o])),s<r-1){var l=a+i*(A(n[s+1])-a),d=o+i*(w.dimensions[n[s+1]].yscale(e[n[s+1]])-o);if(null!==w.bundleDimension){var u=w.clusterCentroids.get(w.dimensions[w.bundleDimension].yscale(e[w.bundleDimension])).get(n[s]),c=w.clusterCentroids.get(w.dimensions[w.bundleDimension].yscale(e[w.bundleDimension])).get(n[s+1]),h=.5*(u+c);d=h+(1-w.bundlingStrength)*(d-h)}t.push($V([l,d]))}}return t}function l(e){var t=e.length,n=w.smoothness,r=[];r.push(e[0]),r.push($V([e[0].e(1)+2*n*(e[1].e(1)-e[0].e(1)),e[0].e(2)]));for(var i=1;i<t-1;++i){var s=e[i],a=e[i-1],o=e[i+1],l=a.subtract(o);r.push(s.add(l.x(n))),r.push(s),r.push(s.subtract(l.x(n)))}return r.push($V([e[t-1].e(1)+2*n*(e[t-2].e(1)-e[t-1].e(1)),e[t-1].e(2)])),r.push(e[t-1]),r}function d(e,t){var n=o(e),r=l(n);t.moveTo(r[0].e(1),r[0].e(2));for(var i=1;i<r.length;i+=3){if(w.showControlPoints)for(var s=0;s<3;s++)t.fillRect(r[i+s].e(1),r[i+s].e(2),2,2);t.bezierCurveTo(r[i].e(1),r[i].e(2),r[i+1].e(1),r[i+1].e(2),r[i+2].e(1),r[i+2].e(2))}}function u(e,t){t.beginPath(),null!==w.bundleDimension&&w.bundlingStrength>0||w.smoothness>0?d(e,t):h(e,t),t.stroke()}function c(){return"bottom"==w.nullValueSeparator?E()+1:"top"==w.nullValueSeparator?1:(console.log("A value is NULL, but nullValueSeparator is not set; set it to 'bottom' or 'top'."),E()+1)}function h(e,t){d3.entries(w.dimensions).forEach(function(n,r){0==r?t.moveTo(A(n.key),"undefined"==typeof e[n.key]?c():w.dimensions[n.key].yscale(e[n.key])):t.lineTo(A(n.key),"undefined"==typeof e[n.key]?c():w.dimensions[n.key].yscale(e[n.key]))})}function f(e,t){return null!==w.brushedColor?C.brushed.strokeStyle=d3.functor(w.brushedColor)(e,t):C.brushed.strokeStyle=d3.functor(w.color)(e,t),u(e,C.brushed)}function m(e,t){return C.foreground.strokeStyle=d3.functor(w.color)(e,t),u(e,C.foreground)}function g(e,t){return C.highlight.strokeStyle=d3.functor(w.color)(e,t),u(e,C.highlight)}function p(e){D.svg.selectAll(".dimension");D.flip(e),d3.select(this.parentElement).transition().duration(w.animationTime).call(R.scale(w.dimensions[e].yscale)).call(R.orient(w.dimensions[e].orient)).call(R.ticks(w.dimensions[e].ticks)).call(R.innerTickSize(w.dimensions[e].innerTickSize)).call(R.outerTickSize(w.dimensions[e].outerTickSize)).call(R.tickPadding(w.dimensions[e].tickPadding)).call(R.tickFormat(w.dimensions[e].tickFormat)),D.render()}function v(){if(w.rotateLabels){var e=d3.event.deltaY;e=e<0?-5:e,e=e>0?5:e,w.dimensionTitleRotation+=e,D.svg.selectAll("text.label").attr("transform","translate(0,-5) rotate("+w.dimensionTitleRotation+")"),d3.event.preventDefault()}}function y(e){return w.dimensions[e].title?w.dimensions[e].title:e}function b(e){w.brushed=e,S.brush.call(D,w.brushed),D.renderBrushed()}function x(e){if(!arguments.length)return B.predicate;if(e=String(e).toUpperCase(),"AND"!==e&&"OR"!==e)throw new Error("Invalid predicate "+e);return B.predicate=e,w.brushed=B.currentMode().selected(),D.renderBrushed(),D}function A(e){0===N.range().length&&N.rangePoints([0,M()],1);var t=T[e];return null==t?N(e):t}var w={data:[],highlighted:[],dimensions:{},dimensionTitleRotation:0,brushed:!1,brushedColor:null,alphaOnBrushed:0,mode:"default",rate:20,width:600,height:300,margin:{top:24,right:0,bottom:12,left:0},nullValueSeparator:"undefined",nullValueSeparatorPadding:{top:8,right:0,bottom:8,left:0},color:"#069",composite:"source-over",alpha:.7,bundlingStrength:.5,bundleDimension:null,smoothness:0,showControlPoints:!1,hideAxis:[],flipAxes:[],animationTime:1100,rotateLabels:!1};n(w,e),e&&e.dimensionTitles&&(console.warn("dimensionTitles passed in config is deprecated. Add title to dimension object."),d3.entries(e.dimensionTitles).forEach(function(e){w.dimensions[e.key]?w.dimensions[e.key].title=w.dimensions[e.key].title?w.dimensions[e.key].title:e.value:w.dimensions[e.key]={title:e.value}}));var P,D=function(e){return e=D.selection=d3.select(e),w.width=e[0][0].clientWidth,w.height=e[0][0].clientHeight,["marks","foreground","brushed","highlight"].forEach(function(t){z[t]=e.append("canvas").attr("class",t)[0][0],C[t]=z[t].getContext("2d")}),D.svg=e.append("svg").attr("width",w.width).attr("height",w.height).style("font","14px sans-serif").style("position","absolute").append("svg:g").attr("transform","translate("+w.margin.left+","+w.margin.top+")"),D},S=d3.dispatch.apply(this,["render","resize","highlight","brush","brushend","brushstart","axesreorder"].concat(d3.keys(w))),M=function(){return w.width-w.margin.right-w.margin.left},E=function(){return w.height-w.margin.top-w.margin.bottom},O={brushable:!1,reorderable:!1,axes:!1,interactive:!1,debug:!1},N=d3.scale.ordinal(),T={},R=(d3.svg.line(),d3.svg.axis().orient("left").ticks(5)),C={},z={},X=d3.dispatch.apply(this,d3.keys(w)).on("composite",function(e){C.foreground.globalCompositeOperation=e.value,C.brushed.globalCompositeOperation=e.value}).on("alpha",function(e){C.foreground.globalAlpha=e.value,C.brushed.globalAlpha=e.value}).on("brushedColor",function(e){C.brushed.strokeStyle=e.value}).on("width",function(e){D.resize()}).on("height",function(e){D.resize()}).on("margin",function(e){D.resize()}).on("rate",function(e){I.rate(e.value),V.rate(e.value)}).on("dimensions",function(e){w.dimensions=D.applyDimensionDefaults(d3.keys(e.value)),N.domain(D.getOrderedDimensionKeys()),D.sortDimensions(),O.interactive&&D.render().updateAxes()}).on("bundleDimension",function(e){d3.keys(w.dimensions).length||D.detectDimensions(),D.autoscale(),"number"==typeof e.value?e.value<d3.keys(w.dimensions).length?w.bundleDimension=w.dimensions[e.value]:e.value<w.hideAxis.length&&(w.bundleDimension=w.hideAxis[e.value]):w.bundleDimension=e.value,w.clusterCentroids=a(w.bundleDimension),O.interactive&&D.render()}).on("hideAxis",function(e){D.dimensions(D.applyDimensionDefaults()),D.dimensions(r(w.dimensions,e.value))}).on("flipAxes",function(e){e.value&&e.value.length&&(e.value.forEach(function(e){p(e)}),D.updateAxes(0))});D.state=w,D.flags=O,t(D,w,S),d3.rebind(D,S,"on"),D.autoscale=function(){var e={date:function(e){var t=d3.extent(w.data,function(t){return t[e]?t[e].getTime():null});return t[0]===t[1]?d3.scale.ordinal().domain([t[0]]).rangePoints(i()):d3.time.scale().domain(t).range(i())},number:function(e){var t=d3.extent(w.data,function(t){return+t[e]});return t[0]===t[1]?d3.scale.ordinal().domain([t[0]]).rangePoints(i()):d3.scale.linear().domain(t).range(i())},string:function(e){var t={},n=[];return w.data.map(function(n){void 0===n[e]&&"undefined"!==w.nullValueSeparator||(void 0===t[n[e]]?t[n[e]]=1:t[n[e]]=t[n[e]]+1)}),n=Object.getOwnPropertyNames(t).sort(function(e,n){return t[e]-t[n]}),d3.scale.ordinal().domain(n).rangePoints(i())}};d3.keys(w.dimensions).forEach(function(t){w.dimensions[t].yscale||(w.dimensions[t].yscale=e[w.dimensions[t].type](t))}),N.rangePoints([0,M()],1);var t=window.devicePixelRatio||1;return D.selection.selectAll("canvas").style("margin-top",w.margin.top+"px").style("margin-left",w.margin.left+"px").style("width",M()+2+"px").style("height",E()+2+"px").attr("width",(M()+2)*t).attr("height",(E()+2)*t),C.foreground.strokeStyle=w.color,C.foreground.lineWidth=1.4,C.foreground.globalCompositeOperation=w.composite,C.foreground.globalAlpha=w.alpha,C.foreground.scale(t,t),C.brushed.strokeStyle=w.brushedColor,C.brushed.lineWidth=1.4,C.brushed.globalCompositeOperation=w.composite,C.brushed.globalAlpha=w.alpha,C.brushed.scale(t,t),C.highlight.lineWidth=3,C.highlight.scale(t,t),this},D.scale=function(e,t){return w.dimensions[e].yscale.domain(t),this},D.flip=function(e){return w.dimensions[e].yscale.domain(w.dimensions[e].yscale.domain().reverse()),this},D.commonScale=function(e,t){var n=t||"number";"undefined"==typeof e&&(e=!0),d3.keys(w.dimensions).length||D.detectDimensions(),D.autoscale();var r=d3.keys(w.dimensions).filter(function(e){return w.dimensions[e].type==n});if(e){var i=d3.extent(r.map(function(e,t){return w.dimensions[e].yscale.domain()}).reduce(function(e,t){return e.concat(t)}));r.forEach(function(e){w.dimensions[e].yscale.domain(i)})}else r.forEach(function(e){w.dimensions[e].yscale.domain(d3.extent(w.data,function(e){return+e[k]}))});return null!==w.bundleDimension&&D.bundleDimension(w.bundleDimension),this},D.detectDimensions=function(){return D.dimensions(D.applyDimensionDefaults()),this},D.applyDimensionDefaults=function(e){var t=D.detectDimensionTypes(w.data);e=e?e:d3.keys(t);var n={},r=0;return e.forEach(function(e){n[e]=w.dimensions[e]?w.dimensions[e]:{},n[e].orient=n[e].orient?n[e].orient:"left",n[e].ticks=null!=n[e].ticks?n[e].ticks:5,n[e].innerTickSize=null!=n[e].innerTickSize?n[e].innerTickSize:6,n[e].outerTickSize=null!=n[e].outerTickSize?n[e].outerTickSize:0,n[e].tickPadding=null!=n[e].tickPadding?n[e].tickPadding:3,n[e].type=n[e].type?n[e].type:t[e],n[e].index=null!=n[e].index?n[e].index:r,r++}),n},D.getOrderedDimensionKeys=function(){return d3.keys(w.dimensions).sort(function(e,t){return d3.ascending(w.dimensions[e].index,w.dimensions[t].index)})},D.toType=function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},D.toTypeCoerceNumbers=function(e){return parseFloat(e)==e&&null!=e?"number":D.toType(e)},D.detectDimensionTypes=function(e){var t={};return d3.keys(e[0]).forEach(function(n){t[isNaN(Number(n))?n:parseInt(n)]=D.toTypeCoerceNumbers(e[0][n])}),t},D.render=function(){return d3.keys(w.dimensions).length||D.detectDimensions(),D.autoscale(),D.render[w.mode](),S.render.call(this),this},D.renderBrushed=function(){return d3.keys(w.dimensions).length||D.detectDimensions(),D.renderBrushed[w.mode](),S.render.call(this),this},D.render.default=function(){D.clear("foreground"),D.clear("highlight"),D.renderBrushed.default(),w.data.forEach(m)};var V=d3.renderQueue(m).rate(50).clear(function(){D.clear("foreground"),D.clear("highlight")});D.render.queue=function(){D.renderBrushed.queue(),V(w.data)},D.renderBrushed.default=function(){D.clear("brushed"),s()&&w.brushed.forEach(f)};var I=d3.renderQueue(f).rate(50).clear(function(){D.clear("brushed")});D.renderBrushed.queue=function(){I(s()?w.brushed:[])},D.compute_real_centroids=function(e){for(var t=[],n=d3.keys(w.dimensions),r=n.length,i=0;i<r;++i){var s=A(n[i]),a=w.dimensions[n[i]].yscale(e[n[i]]);t.push([s,a])}return t},D.shadows=function(){return O.shadows=!0,D.alphaOnBrushed(.1),D.render(),this},D.axisDots=function(e){var e=e||.1,t=D.ctx.marks,n=0,r=2*Math.PI;return t.globalAlpha=d3.min([1/Math.pow(w.data.length,.5),1]),w.data.forEach(function(i){d3.entries(w.dimensions).forEach(function(s,a){t.beginPath(),t.arc(A(s),w.dimensions[s.key].yscale(i[s]),e,n,r),t.stroke(),t.fill()})}),this},D.clear=function(e){return C[e].clearRect(0,0,M()+2,E()+2),"brushed"===e&&s()&&(C.brushed.fillStyle=D.selection.style("background-color"),C.brushed.globalAlpha=1-w.alphaOnBrushed,C.brushed.fillRect(0,0,M()+2,E()+2),C.brushed.globalAlpha=w.alpha),this},d3.rebind(D,R,"ticks","orient","tickValues","tickSubdivide","tickSize","tickPadding","tickFormat"),D.createAxes=function(){return P&&D.removeAxes(),P=D.svg.selectAll(".dimension").data(D.getOrderedDimensionKeys(),function(e){return e}).enter().append("svg:g").attr("class","dimension").attr("transform",function(e){return"translate("+N(e)+")"}),P.append("svg:g").attr("class","axis").attr("transform","translate(0,0)").each(function(e){var t=d3.select(this).call(D.applyAxisConfig(R,w.dimensions[e]));t.selectAll("path").style("fill","none").style("stroke","#222").style("shape-rendering","crispEdges"),t.selectAll("line").style("fill","none").style("stroke","#222").style("shape-rendering","crispEdges")}).append("svg:text").attr({"text-anchor":"middle",y:0,transform:"translate(0,-5) rotate("+w.dimensionTitleRotation+")",x:0,class:"label"}).text(y).on("dblclick",p).on("wheel",v),"top"==w.nullValueSeparator?D.svg.append("line").attr("x1",0).attr("y1",1+w.nullValueSeparatorPadding.top).attr("x2",M()).attr("y2",1+w.nullValueSeparatorPadding.top).attr("stroke-width",1).attr("stroke","#777").attr("fill","none").attr("shape-rendering","crispEdges"):"bottom"==w.nullValueSeparator&&D.svg.append("line").attr("x1",0).attr("y1",E()+1-w.nullValueSeparatorPadding.bottom).attr("x2",M()).attr("y2",E()+1-w.nullValueSeparatorPadding.bottom).attr("stroke-width",1).attr("stroke","#777").attr("fill","none").attr("shape-rendering","crispEdges"),O.axes=!0,this},D.removeAxes=function(){return P.remove(),P=void 0,this},D.updateAxes=function(e){"undefined"==typeof e&&(e=w.animationTime);var t=D.svg.selectAll(".dimension").data(D.getOrderedDimensionKeys());if(t.enter().append("svg:g").attr("class","dimension").attr("transform",function(e){return"translate("+A(e)+")"}).style("opacity",0).append("svg:g").attr("class","axis").attr("transform","translate(0,0)").each(function(e){var t=d3.select(this).call(D.applyAxisConfig(R,w.dimensions[e]));t.selectAll("path").style("fill","none").style("stroke","#222").style("shape-rendering","crispEdges"),t.selectAll("line").style("fill","none").style("stroke","#222").style("shape-rendering","crispEdges")}).append("svg:text").attr({"text-anchor":"middle",y:0,transform:"translate(0,-5) rotate("+w.dimensionTitleRotation+")",x:0,class:"label"}).text(y).on("dblclick",p).on("wheel",v),t.attr("opacity",0),t.select(".axis").transition().duration(e).each(function(e){d3.select(this).call(D.applyAxisConfig(R,w.dimensions[e]))}),t.select(".label").transition().duration(e).text(y).attr("transform","translate(0,-5) rotate("+w.dimensionTitleRotation+")"),t.exit().remove(),P=D.svg.selectAll(".dimension"),P.transition().duration(e).attr("transform",function(e){return"translate("+A(e)+")"}).style("opacity",1),D.svg.selectAll(".axis").transition().duration(e).each(function(e){d3.select(this).call(D.applyAxisConfig(R,w.dimensions[e]))}),O.brushable&&D.brushable(),O.reorderable&&D.reorderable(),"None"!==D.brushMode()){var n=D.brushMode();D.brushMode("None"),D.brushMode(n)}return this},D.applyAxisConfig=function(e,t){return e.scale(t.yscale).orient(t.orient).ticks(t.ticks).tickValues(t.tickValues).innerTickSize(t.innerTickSize).outerTickSize(t.outerTickSize).tickPadding(t.tickPadding).tickFormat(t.tickFormat)},D.reorderable=function(){return P||D.createAxes(),P.style("cursor","move").call(d3.behavior.drag().on("dragstart",function(e){T[e]=this.__origin__=N(e)}).on("drag",function(e){T[e]=Math.min(M(),Math.max(0,this.__origin__+=d3.event.dx)),D.sortDimensions(),N.domain(D.getOrderedDimensionKeys()),D.render(),P.attr("transform",function(e){return"translate("+A(e)+")"})}).on("dragend",function(e){for(var t=0,n=w.dimensions[e].index,r=this,i=this.parentElement;null!=(r=r.previousElementSibling);)++t;t!==n&&(S.axesreorder.call(D,D.getOrderedDimensionKeys()),t>n?i.insertBefore(this,i.children[n-1]):n+1<i.children.length?i.insertBefore(this,i.children[n+1]):i.appendChild(this)),delete this.__origin__,delete T[e],d3.select(this).transition().attr("transform","translate("+N(e)+")"),D.render()})),O.reorderable=!0,this},D.reorder=function(e){var t=D.getOrderedDimensionKeys()[0];D.sortDimensionsByRowData(e);var n=!1;if(n=t!==D.getOrderedDimensionKeys()[0]){N.domain(D.getOrderedDimensionKeys());var r=w.highlighted.slice(0);D.unhighlight(),P.transition().duration(1500).attr("transform",function(e){return"translate("+N(e)+")"}),D.render(),0!==r.length&&D.highlight(r)}},D.sortDimensionsByRowData=function(e){var t=w.dimensions,n=d3.keys(w.dimensions).sort(function(t,n){var r=w.dimensions[t].yscale(e[t])-w.dimensions[n].yscale(e[n]);return 0===r?t.localeCompare(n):r});w.dimensions={},n.forEach(function(e,n){w.dimensions[e]=t[e],w.dimensions[e].index=n})},D.sortDimensions=function(){var e=w.dimensions,t=d3.keys(w.dimensions).sort(function(e,t){return A(e)-A(t)});w.dimensions={},t.forEach(function(t,n){w.dimensions[t]=e[t],w.dimensions[t].index=n})},D.adjacent_pairs=function(e){for(var t=[],n=0;n<e.length-1;n++)t.push([e[n],e[n+1]]);return t};var B={modes:{None:{install:function(e){},uninstall:function(e){},selected:function(){return[]},brushState:function(){return{}}}},mode:"None",predicate:"AND",currentMode:function(){return this.modes[this.mode]}};return D.brushModes=function(){return Object.getOwnPropertyNames(B.modes)},D.brushMode=function(e){if(0===arguments.length)return B.mode;if(D.brushModes().indexOf(e)===-1)throw new Error("pc.brushmode: Unsupported brush mode: "+e);return e!==B.mode&&("None"!==B.mode&&D.brushReset(),B.modes[B.mode].uninstall(D),B.mode=e,B.modes[B.mode].install(),"None"===e?delete D.brushPredicate:D.brushPredicate=x),D},function(){function e(e){return!a[e].empty()}function t(){var t=d3.keys(w.dimensions).filter(e),n=t.map(function(e){return a[e].extent()});if(0===t.length)return w.data;var r={date:function(e,t,r){return"function"==typeof w.dimensions[t].yscale.rangePoints?n[r][0]<=w.dimensions[t].yscale(e[t])&&w.dimensions[t].yscale(e[t])<=n[r][1]:n[r][0]<=e[t]&&e[t]<=n[r][1]},number:function(e,t,r){return"function"==typeof w.dimensions[t].yscale.rangePoints?n[r][0]<=w.dimensions[t].yscale(e[t])&&w.dimensions[t].yscale(e[t])<=n[r][1]:n[r][0]<=e[t]&&e[t]<=n[r][1]},string:function(e,t,r){return n[r][0]<=w.dimensions[t].yscale(e[t])&&w.dimensions[t].yscale(e[t])<=n[r][1]}};return w.data.filter(function(e){switch(B.predicate){case"AND":return t.every(function(t,n){return r[w.dimensions[t].type](e,t,n)});case"OR":return t.some(function(t,n){return r[w.dimensions[t].type](e,t,n)});default:throw new Error("Unknown brush predicate "+w.brushPredicate)}})}function n(e){if("undefined"==typeof e){var e={};return d3.keys(w.dimensions).forEach(function(t){var n=a[t];if(void 0!==n&&!n.empty()){var r=n.extent();r.sort(d3.ascending),e[t]=r}}),e}var t={};return P.selectAll(".brush").each(function(e){t[e]=d3.select(this)}),d3.keys(w.dimensions).forEach(function(n){if(void 0!==e[n]){var r=a[n];void 0!==r&&(r.extent(e[n]),t[n].transition().duration(0).call(r),r.event(t[n]))}}),D.renderBrushed(),D}function r(e){var n=d3.svg.brush();return n.y(w.dimensions[e].yscale).on("brushstart",function(){null!==d3.event.sourceEvent&&(S.brushstart.call(D,w.brushed),d3.event.sourceEvent.stopPropagation())}).on("brush",function(){b(t())}).on("brushend",function(){S.brushend.call(D,w.brushed)}),a[e]=n,n}function i(e){return void 0===e?(w.brushed=!1,P&&(P.selectAll(".brush").each(function(e){d3.select(this).transition().duration(0).call(a[e].clear())}),D.renderBrushed())):P&&(P.selectAll(".brush").each(function(t){t==e&&(d3.select(this).transition().duration(0).call(a[t].clear()),a[t].event(d3.select(this)))}),D.renderBrushed()),this}function s(){P||D.createAxes();var e=P.append("svg:g").attr("class","brush").each(function(e){d3.select(this).call(r(e))});return e.selectAll("rect").style("visibility",null).attr("x",-15).attr("width",30),e.selectAll("rect.background").style("fill","transparent"),e.selectAll("rect.extent").style("fill","rgba(255,255,255,0.25)").style("stroke","rgba(0,0,0,0.6)"),e.selectAll(".resize rect").style("fill","rgba(0,0,0,0.1)"),D.brushExtents=n,D.brushReset=i,D}var a={};B.modes["1D-axes"]={install:s,uninstall:function(){P.selectAll(".brush").remove(),a={},delete D.brushExtents,delete D.brushReset},selected:t,brushState:n}}(),function(){function e(t,n){var r=D.selection.select("svg").select("g#strums"),i=t.dims.i,s=[t.p1,t.p2],a=r.selectAll("line#strum-"+i).data([t]),l=r.selectAll("circle#strum-"+i).data(s),d=d3.behavior.drag();a.enter().append("line").attr("id","strum-"+i).attr("class","strum"),a.attr("x1",function(e){return e.p1[0]}).attr("y1",function(e){return e.p1[1]}).attr("x2",function(e){return e.p2[0]}).attr("y2",function(e){return e.p2[1]}).attr("stroke","black").attr("stroke-width",2),d.on("drag",function(n,r){var i=d3.event;r+=1,t["p"+r][0]=Math.min(Math.max(t.minX+1,i.x),t.maxX),t["p"+r][1]=Math.min(Math.max(t.minY,i.y),t.maxY),e(t,r-1)}).on("dragend",o()),l.enter().append("circle").attr("id","strum-"+i).attr("class","strum"),l.attr("cx",function(e){return e[0]}).attr("cy",function(e){return e[1]}).attr("r",5).style("opacity",function(e,t){return void 0!==n&&t===n?.8:0}).on("mouseover",function(){d3.select(this).style("opacity",.8)}).on("mouseout",function(){d3.select(this).style("opacity",0)}).call(d)}function t(e){var t={i:-1,left:void 0,right:void 0};return d3.keys(w.dimensions).some(function(n,r){if(N(n)<e[0]){var i=d3.keys(w.dimensions)[D.getOrderedDimensionKeys().indexOf(n)+1];return t.i=r,t.left=n,t.right=i,!1}return!0}),void 0===t.left?(t.i=0,t.left=D.getOrderedDimensionKeys()[0],t.right=D.getOrderedDimensionKeys()[1]):void 0===t.right&&(t.i=d3.keys(w.dimensions).length-1,t.right=t.left,t.left=D.getOrderedDimensionKeys()[d3.keys(w.dimensions).length-2]),t}function n(){return function(){var e,n,r=d3.mouse(u[0][0]);r[0]=r[0]-w.margin.left,r[1]=r[1]-w.margin.top,e=t(r),n={p1:r,dims:e,minX:N(e.left),maxX:N(e.right),minY:0,maxY:E()},c[e.i]=n,c.active=e.i,n.p1[0]=Math.min(Math.max(n.minX,r[0]),n.maxX),n.p2=n.p1.slice()}}function r(){return function(){var t=d3.event,n=c[c.active];n.p2[0]=Math.min(Math.max(n.minX+1,t.x-w.margin.left),n.maxX),n.p2[1]=Math.min(Math.max(n.minY,t.y-w.margin.top),n.maxY),e(n,1)}}function i(e,t){var n=[e.p1[0]-e.minX,e.p1[1]-e.minX],r=[e.p2[0]-e.minX,e.p2[1]-e.minX],i=1-t/n[0],s=n[1]*(1-i),a=1-t/r[0],o=r[1]*(1-a);return function(e){var t=e[0],n=e[1],r=i*t+s,l=a*t+o;return n>Math.min(r,l)&&n<Math.max(r,l)}}function s(){function e(e,t){var n=c[t],r=i(n,c.width(t)),s=n.dims.left,a=n.dims.right,o=w.dimensions[s].yscale,l=w.dimensions[a].yscale,d=[o(e[s])-n.minX,l(e[a])-n.minX];return r(d)}var t=Object.getOwnPropertyNames(c),n=w.data;return t=t.filter(function(e){return!isNaN(e)}),0===t.length?n:n.filter(function(n){switch(B.predicate){case"AND":return t.every(function(t){return e(n,t)});case"OR":return t.some(function(t){return e(n,t)});default:throw new Error("Unknown brush predicate "+w.brushPredicate)}})}function a(){var e=c[c.active],t=D.selection.select("svg").select("g#strums");delete c[c.active],c.active=void 0,t.selectAll("line#strum-"+e.dims.i).remove(),t.selectAll("circle#strum-"+e.dims.i).remove()}function o(){return function(){var e=w.data,t=c[c.active];t&&t.p1[0]===t.p2[0]&&t.p1[1]===t.p2[1]&&a(c),e=s(c),c.active=void 0,w.brushed=e,D.renderBrushed(),S.brushend.call(D,w.brushed)}}function l(e){return function(){var t=Object.getOwnPropertyNames(e).filter(function(e){return!isNaN(e)});t.forEach(function(t){e.active=t,a(e)}),o(e)()}}function d(){var e=d3.behavior.drag();c.active=void 0,c.width=function(e){var t=c[e];if(void 0!==t)return t.maxX-t.minX},D.on("axesreorder.strums",function(){function e(e,t){var n=d3.keys(w.dimensions).length;return d3.keys(w.dimensions).some(function(r,i){return r===e&&(i+i<n&&w.dimensions[i+1]===t)})}var t=Object.getOwnPropertyNames(c).filter(function(e){return!isNaN(e)});t.length>0&&(t.forEach(function(t){var n=c[t].dims;c.active=t,e(n.left,n.right)||a(c)}),o(c)())}),D.selection.select("svg").append("g").attr("id","strums").attr("transform","translate("+w.margin.left+","+w.margin.top+")"),D.brushReset=l(c),e.on("dragstart",n(c)).on("drag",r(c)).on("dragend",o(c)),u=D.selection.select("svg").insert("rect","g#strums").attr("id","strum-events").attr("x",w.margin.left).attr("y",w.margin.top).attr("width",M()).attr("height",E()+2).style("opacity",0).call(e)}var u,c={};B.modes["2D-strums"]={install:d,uninstall:function(){D.selection.select("svg").select("g#strums").remove(),D.selection.select("svg").select("rect#strum-events").remove(),D.on("axesreorder.strums",void 0),delete D.brushReset,u=void 0},selected:s,brushState:function(){return c}}}(),function(){function e(e){return!a[e].empty()}function t(){var t=d3.keys(w.dimensions).filter(e),n=t.map(function(e){return a[e].extent()});if(0===t.length)return w.data;var r={date:function(e,t,n,r){return"function"==typeof w.dimensions[t].yscale.rangePoints?r[0]<=w.dimensions[t].yscale(e[t])&&w.dimensions[t].yscale(e[t])<=r[1]:r[0]<=e[t]&&e[t]<=r[1]},number:function(e,t,n,r){return"function"==typeof w.dimensions[t].yscale.rangePoints?r[0]<=w.dimensions[t].yscale(e[t])&&w.dimensions[t].yscale(e[t])<=r[1]:r[0]<=e[t]&&e[t]<=r[1]},string:function(e,t,n,r){return r[0]<=w.dimensions[t].yscale(e[t])&&w.dimensions[t].yscale(e[t])<=r[1]}};return w.data.filter(function(e){switch(B.predicate){case"AND":return t.every(function(t,i){return n[i].some(function(n){return r[w.dimensions[t].type](e,t,i,n)})});case"OR":return t.some(function(t,i){return n[i].some(function(n){return r[w.dimensions[t].type](e,t,i,n)})});default:throw new Error("Unknown brush predicate "+w.brushPredicate)}})}function n(e){if("undefined"==typeof e)return e={},d3.keys(w.dimensions).forEach(function(t){var n=a[t];if(void 0!==n&&!n.empty()){var r=n.extent();e[t]=r}}),e;var t={};return P.selectAll(".brush").each(function(e){t[e]=d3.select(this)}),d3.keys(w.dimensions).forEach(function(n){if(void 0!==e[n]){var r=a[n];void 0!==r&&(r.extent(e[n]),t[n].transition().duration(0).call(r),r.event(t[n]))}}),D.renderBrushed(),D}function r(e){var n=d3.svg.multibrush();return n.y(w.dimensions[e].yscale).on("brushstart",function(){null!==d3.event.sourceEvent&&(S.brushstart.call(D,w.brushed),d3.event.sourceEvent.stopPropagation())}).on("brush",function(){b(t())}).on("brushend",function(){b(t()),S.brushend.call(D,w.brushed)}).extentAdaption(function(e){e.style("visibility",null).attr("x",-15).attr("width",30).style("fill","rgba(255,255,255,0.25)").style("stroke","rgba(0,0,0,0.6)")}).resizeAdaption(function(e){e.selectAll("rect").attr("x",-15).attr("width",30).style("visibility",null).style("fill","rgba(0,0,0,0.1)")}),a[e]=n,n}function i(e){return w.brushed=!1,P&&(P.selectAll(".brush").each(function(e){d3.select(this).call(a[e].clear())}),D.renderBrushed()),this}function s(){P||D.createAxes();var e=P.append("svg:g").attr("class","brush").each(function(e){d3.select(this).call(r(e))});return e.selectAll("rect").style("visibility",null).attr("x",-15).attr("width",30),e.selectAll("rect.background").style("fill","transparent"),e.selectAll("rect.extent").style("fill","rgba(255,255,255,0.25)").style("stroke","rgba(0,0,0,0.6)"),e.selectAll(".resize rect").style("fill","rgba(0,0,0,0.1)"),D.brushExtents=n,D.brushReset=i,D}if("function"==typeof d3.svg.multibrush){var a={};B.modes["1D-axes-multi"]={install:s,uninstall:function(){P.selectAll(".brush").remove(),a={},delete D.brushExtents,delete D.brushReset},selected:t,brushState:n}}}(),function(){function e(t,n){var r=D.selection.select("svg").select("g#arcs"),i=t.dims.i,s=[t.p2,t.p3],a=r.selectAll("line#arc-"+i).data([{p1:t.p1,p2:t.p2},{p1:t.p1,p2:t.p3}]),o=r.selectAll("circle#arc-"+i).data(s),d=d3.behavior.drag(),u=r.selectAll("path#arc-"+i).data([t]);u.enter().append("path").attr("id","arc-"+i).attr("class","arc").style("fill","orange").style("opacity",.5),u.attr("d",t.arc).attr("transform","translate("+t.p1[0]+","+t.p1[1]+")"),a.enter().append("line").attr("id","arc-"+i).attr("class","arc"),a.attr("x1",function(e){return e.p1[0]}).attr("y1",function(e){return e.p1[1]}).attr("x2",function(e){return e.p2[0]}).attr("y2",function(e){return e.p2[1]}).attr("stroke","black").attr("stroke-width",2),d.on("drag",function(n,r){var s=d3.event,a=0;r+=2,t["p"+r][0]=Math.min(Math.max(t.minX+1,s.x),t.maxX),t["p"+r][1]=Math.min(Math.max(t.minY,s.y),t.maxY),a=3===r?h.startAngle(i):h.endAngle(i),(t.startAngle<Math.PI&&t.endAngle<Math.PI&&a<Math.PI||t.startAngle>=Math.PI&&t.endAngle>=Math.PI&&a>=Math.PI)&&(2===r?(t.endAngle=a,t.arc.endAngle(a)):3===r&&(t.startAngle=a,t.arc.startAngle(a))),e(t,r-2)}).on("dragend",l()),o.enter().append("circle").attr("id","arc-"+i).attr("class","arc"),o.attr("cx",function(e){return e[0]}).attr("cy",function(e){return e[1]}).attr("r",5).style("opacity",function(e,t){return void 0!==n&&t===n?.8:0}).on("mouseover",function(){d3.select(this).style("opacity",.8)}).on("mouseout",function(){d3.select(this).style("opacity",0)}).call(d)}function t(e){var t={i:-1,left:void 0,right:void 0};return d3.keys(w.dimensions).some(function(n,r){if(N(n)<e[0]){var i=d3.keys(w.dimensions)[D.getOrderedDimensionKeys().indexOf(n)+1];return t.i=r,t.left=n,t.right=i,!1}return!0}),void 0===t.left?(t.i=0,t.left=D.getOrderedDimensionKeys()[0],t.right=D.getOrderedDimensionKeys()[1]):void 0===t.right&&(t.i=d3.keys(w.dimensions).length-1,t.right=t.left,t.left=D.getOrderedDimensionKeys()[d3.keys(w.dimensions).length-2]),t}function n(){return function(){var e,n,r=d3.mouse(c[0][0]);r[0]=r[0]-w.margin.left,r[1]=r[1]-w.margin.top,e=t(r),n={p1:r,dims:e,minX:N(e.left),maxX:N(e.right),minY:0,maxY:E(),startAngle:void 0,endAngle:void 0,arc:d3.svg.arc().innerRadius(0)},h[e.i]=n,h.active=e.i,n.p1[0]=Math.min(Math.max(n.minX,r[0]),n.maxX),n.p2=n.p1.slice(),n.p3=n.p1.slice()}}function r(){return function(){var t=d3.event,n=h[h.active];n.p2[0]=Math.min(Math.max(n.minX+1,t.x-w.margin.left),n.maxX),n.p2[1]=Math.min(Math.max(n.minY,t.y-w.margin.top),n.maxY),n.p3=n.p2.slice(),e(n,1)}}function i(e,t){return Math.sqrt(e*e+t*t)}function s(e){var t=f(e.startAngle),n=f(e.endAngle);if(t>n){var r=t;t=n,n=r}return function(e){return e>=t&&e<=n}}function a(){function e(e,t){var n=h[t],r=s(n),a=n.dims.left,o=n.dims.right,l=w.dimensions[a].yscale,d=w.dimensions[o].yscale,u=h.width(t),c=l(e[a])-d(e[o]),f=i(u,c),m=Math.asin(c/f);return r(m)}var t=Object.getOwnPropertyNames(h),n=w.data;return t=t.filter(function(e){return!isNaN(e)}),0===t.length?n:n.filter(function(n){switch(B.predicate){case"AND":return t.every(function(t){return e(n,t)});case"OR":return t.some(function(t){return e(n,t)});default:throw new Error("Unknown brush predicate "+w.brushPredicate)}})}function o(){var e=h[h.active],t=D.selection.select("svg").select("g#arcs");delete h[h.active],h.active=void 0,t.selectAll("line#arc-"+e.dims.i).remove(),t.selectAll("circle#arc-"+e.dims.i).remove(),t.selectAll("path#arc-"+e.dims.i).remove()}function l(){return function(){var e=w.data,t=h[h.active];if(t&&t.p1[0]===t.p2[0]&&t.p1[1]===t.p2[1]&&o(h),t){var n=h.startAngle(h.active);t.startAngle=n,t.endAngle=n,t.arc.outerRadius(h.length(h.active)).startAngle(n).endAngle(n)}e=a(h),h.active=void 0,w.brushed=e,D.renderBrushed(),S.brushend.call(D,w.brushed)}}function d(e){return function(){var t=Object.getOwnPropertyNames(e).filter(function(e){return!isNaN(e)});t.forEach(function(t){e.active=t,o(e)}),l(e)()}}function u(){var e=d3.behavior.drag();h.active=void 0,h.width=function(e){var t=h[e];if(void 0!==t)return t.maxX-t.minX},angle=function(e,t){var n=e[0]-t[0],r=e[1]-t[1],s=i(n,r);return Math.asin(r/s)},h.endAngle=function(e){var t=h[e];if(void 0!==t){var n=angle(t.p1,t.p2),r=-n+Math.PI/2;return t.p1[0]>t.p2[0]&&(r=2*Math.PI-r),r}},h.startAngle=function(e){var t=h[e];
if(void 0!==t){var n=angle(t.p1,t.p3),r=-n+Math.PI/2;return t.p1[0]>t.p3[0]&&(r=2*Math.PI-r),r}},h.length=function(e){var t=h[e];if(void 0!==t){var n=t.p1[0]-t.p2[0],r=t.p1[1]-t.p2[1],s=i(n,r);return s}},D.on("axesreorder.arcs",function(){function e(e,t){var n=d3.keys(w.dimensions).length;return d3.keys(w.dimensions).some(function(r,i){return r===e&&(i+i<n&&w.dimensions[i+1]===t)})}var t=Object.getOwnPropertyNames(h).filter(function(e){return!isNaN(e)});t.length>0&&(t.forEach(function(t){var n=h[t].dims;h.active=t,e(n.left,n.right)||o(h)}),l(h)())}),D.selection.select("svg").append("g").attr("id","arcs").attr("transform","translate("+w.margin.left+","+w.margin.top+")"),D.brushReset=d(h),e.on("dragstart",n(h)).on("drag",r(h)).on("dragend",l(h)),c=D.selection.select("svg").insert("rect","g#arcs").attr("id","arc-events").attr("x",w.margin.left).attr("y",w.margin.top).attr("width",M()).attr("height",E()+2).style("opacity",0).call(e)}var c,h={},f=(function(){var e=Math.PI/180;return function(t){return t*e}}(),function(){var e=180/Math.PI;return function(t){return t*e}}(),function(e){var t=e;return e>Math.PI?(t=e-1.5*Math.PI,t=e-1.5*Math.PI):(t=e-.5*Math.PI,t=e-.5*Math.PI),-t});B.modes.angular={install:u,uninstall:function(){D.selection.select("svg").select("g#arcs").remove(),D.selection.select("svg").select("rect#arc-events").remove(),D.on("axesreorder.arcs",void 0),delete D.brushReset,c=void 0},selected:a,brushState:function(){return h}}}(),D.interactive=function(){return O.interactive=!0,this},D.xscale=N,D.ctx=C,D.canvas=z,D.g=function(){return P},D.resize=function(){return D.selection.select("svg").attr("width",w.width).attr("height",w.height),D.svg.attr("transform","translate("+w.margin.left+","+w.margin.top+")"),O.brushable&&D.brushReset(),D.autoscale(),P&&D.createAxes(),O.brushable&&D.brushable(),O.reorderable&&D.reorderable(),S.resize.call(this,{width:w.width,height:w.height,margin:w.margin}),this},D.highlight=function(e){return 0===arguments.length?w.highlighted:(w.highlighted=e,D.clear("highlight"),d3.selectAll([z.foreground,z.brushed]).classed("faded",!0),e.forEach(g),S.highlight.call(this,e),this)},D.unhighlight=function(){return w.highlighted=[],D.clear("highlight"),d3.selectAll([z.foreground,z.brushed]).classed("faded",!1),this},D.intersection=function(e,t,n,r){return{x:((e.x*t.y-e.y*t.x)*(n.x-r.x)-(e.x-t.x)*(n.x*r.y-n.y*r.x))/((e.x-t.x)*(n.y-r.y)-(e.y-t.y)*(n.x-r.x)),y:((e.x*t.y-e.y*t.x)*(n.y-r.y)-(e.y-t.y)*(n.x*r.y-n.y*r.x))/((e.x-t.x)*(n.y-r.y)-(e.y-t.y)*(n.x-r.x))}},D.mergeParcoords=function(e){var t=window.devicePixelRatio||1,n=document.createElement("canvas");n.width=D.canvas.foreground.clientWidth*t,n.height=(D.canvas.foreground.clientHeight+30)*t,n.style.width=n.width/t+"px",n.style.height=n.height/t+"px";var r=n.getContext("2d");r.fillStyle="#ffffff",r.fillRect(0,0,n.width,n.height);for(var i in D.canvas)r.drawImage(D.canvas[i],0,24*t,n.width,n.height-30*t);var s=(window.URL||window.webkitURL||window,new XMLSerializer),a=s.serializeToString(D.selection.select("svg")[0][0]),o="data:image/svg+xml;base64,"+window.btoa(a),l=new Image;l.onload=function(){r.drawImage(l,0,0,l.width*t,l.height*t),"function"==typeof e&&e(n)},l.src=o},D.version="0.7.0",D.toString=function(){return"Parallel Coordinates: "+d3.keys(w.dimensions).length+" dimensions ("+d3.keys(w.data[0]).length+" total) , "+w.data.length+" rows"},D},d3.renderQueue=function(e){var t=[],n=10,r=function(){},i=0,s=function(e){e&&s.data(e),s.invalidate(),r(),s.render()};return s.render=function(){function r(){if(!a)return!0;if(i>t.length)return!0;for(var r=Math.min(i+n,t.length),s=i;s<r;s++)e(t[s],s);i+=n}i=0;var a=!0;s.invalidate=function(){a=!1},d3.timer(r)},s.data=function(e){return s.invalidate(),t=e.slice(0),s},s.rate=function(e){return arguments.length?(n=e,s):n},s.remaining=function(){return t.length-i},s.clear=function(e){return arguments.length?(r=e,s):(r(),s)},s.invalidate=function(){},s};
//# sourceMappingURL=d3.parcoords.min.js.map
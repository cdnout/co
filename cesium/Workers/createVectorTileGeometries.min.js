define(["./Transforms-dca21951","./BoxGeometry-21bfdc37","./Matrix2-37e55508","./Color-1ca27bfa","./CylinderGeometry-95b380ef","./defaultValue-81eec7ed","./EllipsoidGeometry-d41e552e","./IndexDatatype-f1dcdf35","./createTaskProcessorWorker","./RuntimeError-8952249c","./ComponentDatatype-a15c9a19","./WebGLConstants-508b9636","./_commonjsHelpers-3aae1032-26891ab7","./combine-3c023bda","./GeometryOffsetAttribute-8c5e10db","./GeometryAttribute-cc3a5bc9","./GeometryAttributes-32b29525","./VertexFormat-a0b706b0","./CylinderGeometryLibrary-76cda53e"],function(A,M,O,L,B,E,v,w,e,t,n,r,a,i,o,s,d,c,l){"use strict";function U(e){this.offset=e.offset,this.count=e.count,this.color=e.color,this.batchIds=e.batchIds}const f=new O.Cartesian3,u=O.Matrix4.packedLength+O.Cartesian3.packedLength,h=O.Matrix4.packedLength+2,b=O.Matrix4.packedLength+O.Cartesian3.packedLength,p=O.Cartesian3.packedLength+1,y={modelMatrix:new O.Matrix4,boundingVolume:new A.BoundingSphere};function G(e,t){var n=t*u,t=O.Cartesian3.unpack(e,n,f);n+=O.Cartesian3.packedLength;n=O.Matrix4.unpack(e,n,y.modelMatrix);O.Matrix4.multiplyByScale(n,t,n);const r=y.boundingVolume;return O.Cartesian3.clone(O.Cartesian3.ZERO,r.center),r.radius=Math.sqrt(3),y}function S(e,t){var n=t*h,r=e[n++],t=e[n++],t=O.Cartesian3.fromElements(r,r,t,f),n=O.Matrix4.unpack(e,n,y.modelMatrix);O.Matrix4.multiplyByScale(n,t,n);const a=y.boundingVolume;return O.Cartesian3.clone(O.Cartesian3.ZERO,a.center),a.radius=Math.sqrt(2),y}function V(e,t){var n=t*b,t=O.Cartesian3.unpack(e,n,f);n+=O.Cartesian3.packedLength;n=O.Matrix4.unpack(e,n,y.modelMatrix);O.Matrix4.multiplyByScale(n,t,n);const r=y.boundingVolume;return O.Cartesian3.clone(O.Cartesian3.ZERO,r.center),r.radius=1,y}function T(e,t){var n=t*p,t=e[n++],n=O.Cartesian3.unpack(e,n,f),n=O.Matrix4.fromTranslation(n,y.modelMatrix);O.Matrix4.multiplyByUniformScale(n,t,n);const r=y.boundingVolume;return O.Cartesian3.clone(O.Cartesian3.ZERO,r.center),r.radius=1,y}const F=new O.Cartesian3;function R(a,i,o,s,d){if(E.defined(i)){const u=o.length,h=s.attributes.position.values,b=s.indices,p=a.positions,y=a.vertexBatchIds,x=a.indices,g=a.batchIds,m=a.batchTableColors,C=a.batchedIndices,I=a.indexOffsets,k=a.indexCounts,M=a.boundingVolumes,B=a.modelMatrix,v=a.center;let t=a.positionOffset,n=a.batchIdIndex,r=a.indexOffset;var c=a.batchedIndicesOffset;for(let e=0;e<u;++e){const E=d(i,e),s=E.modelMatrix;O.Matrix4.multiply(B,s,s);const u=o[e],w=h.length;for(let e=0;e<w;e+=3){const a=O.Cartesian3.unpack(h,e,F);O.Matrix4.multiplyByPoint(s,a,a),O.Cartesian3.subtract(a,v,a),O.Cartesian3.pack(a,p,3*t+e),y[n++]=u}var l=b.length;for(let e=0;e<l;++e)x[r+e]=b[e]+t;var f=e+c;C[f]=new U({offset:r,count:l,color:L.Color.fromRgba(m[u]),batchIds:[u]}),g[f]=u,I[f]=r,k[f]=l,M[f]=A.BoundingSphere.transform(E.boundingVolume,s),t+=w/3,r+=l}a.positionOffset=t,a.batchIdIndex=n,a.indexOffset=r,a.batchedIndicesOffset+=u}}const Z=new O.Cartesian3,D=new O.Matrix4;return e(function(e,t){var n=E.defined(e.boxes)?new Float32Array(e.boxes):void 0,r=E.defined(e.boxBatchIds)?new Uint16Array(e.boxBatchIds):void 0,a=E.defined(e.cylinders)?new Float32Array(e.cylinders):void 0,i=E.defined(e.cylinderBatchIds)?new Uint16Array(e.cylinderBatchIds):void 0,o=E.defined(e.ellipsoids)?new Float32Array(e.ellipsoids):void 0,s=E.defined(e.ellipsoidBatchIds)?new Uint16Array(e.ellipsoidBatchIds):void 0,d=E.defined(e.spheres)?new Float32Array(e.spheres):void 0,c=E.defined(e.sphereBatchIds)?new Uint16Array(e.sphereBatchIds):void 0,l=E.defined(n)?r.length:0,f=E.defined(a)?i.length:0,u=E.defined(o)?s.length:0,h=E.defined(d)?c.length:0,b=M.BoxGeometry.getUnitBox(),p=B.CylinderGeometry.getUnitCylinder(),y=v.EllipsoidGeometry.getUnitEllipsoid(),x=b.attributes.position.values,g=p.attributes.position.values,m=y.attributes.position.values,C=x.length*l;C+=g.length*f,C+=m.length*(u+h);var I=b.indices,k=p.indices,x=y.indices,g=I.length*l;g+=k.length*f,g+=x.length*(u+h);m=new Float32Array(C),I=new Uint16Array(C/3),k=w.IndexDatatype.createTypedArray(C/3,g),x=l+f+u+h,C=new Uint16Array(x),g=new Array(x),l=new Uint32Array(x),f=new Uint32Array(x),u=new Array(x);h=e.packedBuffer,x=new Float64Array(h),h=0,O.Cartesian3.unpack(x,0,Z),h+=O.Cartesian3.packedLength,O.Matrix4.unpack(x,h,D);e={batchTableColors:new Uint32Array(e.batchTableColors),positions:m,vertexBatchIds:I,indices:k,batchIds:C,batchedIndices:g,indexOffsets:l,indexCounts:f,boundingVolumes:u,positionOffset:0,batchIdIndex:0,indexOffset:0,batchedIndicesOffset:0,modelMatrix:D,center:Z};R(e,n,r,b,G),R(e,a,i,p,S),R(e,o,s,y,V),R(e,d,c,y,T);u=function(t,n,r){const a=r.length,e=2+a*A.BoundingSphere.packedLength+1+function(t){var n=t.length;let r=0;for(let e=0;e<n;++e)r+=L.Color.packedLength+3+t[e].batchIds.length;return r}(n),i=new Float64Array(e);let o=0;i[o++]=t,i[o++]=a;for(let e=0;e<a;++e)A.BoundingSphere.pack(r[e],i,o),o+=A.BoundingSphere.packedLength;var s=n.length;i[o++]=s;for(let e=0;e<s;++e){const t=n[e];L.Color.pack(t.color,i,o),o+=L.Color.packedLength,i[o++]=t.offset,i[o++]=t.count;const r=t.batchIds,a=r.length;i[o++]=a;for(let e=0;e<a;++e)i[o++]=r[e]}return i}(k.BYTES_PER_ELEMENT,g,u);return t.push(m.buffer,I.buffer,k.buffer),t.push(C.buffer,l.buffer,f.buffer),t.push(u.buffer),{positions:m.buffer,vertexBatchIds:I.buffer,indices:k.buffer,indexOffsets:l.buffer,indexCounts:f.buffer,batchIds:C.buffer,packedBuffer:u.buffer}})});
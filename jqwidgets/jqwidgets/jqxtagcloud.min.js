!function(p){p.jqx.jqxWidget("jqxTagCloud","",{}),p.extend(p.jqx._jqxTagCloud.prototype,{defineInstance:function(){var e={width:null,height:null,source:null,disabled:!1,rtl:!1,valueMember:"value",displayMember:"label",urlMember:"url",urlBase:"",autoBind:!0,takeTopWeightedItems:!1,displayLimit:null,minValueToDisplay:0,maxValueToDisplay:0,minFontSize:10,maxFontSize:24,fontSizeUnit:"px",displayValue:!1,sortBy:"none",alterTextCase:"none",sortOrder:"ascending",textColor:null,minColor:null,maxColor:null,tagRenderer:null};return this===p.jqx._jqxTagCloud.prototype||p.extend(!0,this,e),e},createInstance:function(){var e=this;e.render(),e.dataBind(e.source,!0)},dataBind:function(e,r){var t,a=this;a.records=[],!!e._source?e=(t=e)._source:(e.datafields=[{name:a.displayMember},{name:a.valueMember},{name:a.urlMember}],t=new p.jqx.dataAdapter(e,{autoBind:!0}));function i(e){e._setSourceData(t),e._raiseEvent(1,{records:e.records}),e._renderTags()}switch(void 0!==e.type&&(t._options.type=e.type),void 0!==e.formatdata&&(t._options.formatData=e.formatdata),void 0!==e.contenttype&&(t._options.contentType=e.contenttype),void 0!==e.async&&(t._options.async=e.async),e.datatype){case"local":case"array":default:null==e.localdata&&!p.isArray(e)||(t.unbindBindingUpdate(a.element.id),!a.autoBind&&(a.autoBind||r)||t.dataBind(),i(a),t.bindBindingUpdate(a.element.id,function(e){i(a)}));break;case"json":case"jsonp":case"xml":case"xhtml":case"script":case"text":case"csv":case"tab":if(null!=e.localdata)return t.unbindBindingUpdate(a.element.id),!a.autoBind&&(a.autoBind||r)||t.dataBind(),i(a),void t.bindBindingUpdate(a.element.id,function(){i(a)});var n={};t._options.data?p.extend(t._options.data,n):(e.data&&p.extend(n,e.data),t._options.data=n);t.unbindDownloadComplete(a.element.id),t.bindDownloadComplete(a.element.id,function(){i(a)}),!a.autoBind&&(a.autoBind||r)||t.dataBind()}a._raiseEvent(2,{records:a.records})},destroy:function(){var e=this;e.removeHandler(e._el,"keydown"),e.removeHandler(e._el,"click"),e.host.empty(),e.host.remove()},findTagIndex:function(e){for(var r=this,t=0;t<r.records.length;t++)if(r.records[t][r.displayMember]===e)return r.records[t].index;return-1},getHiddenTagsList:function(){return this.hiddenList.slice()},getRenderedTags:function(){return this.renderedData.slice()},getTagsList:function(){return this.records.slice()},insertAt:function(t,a){var i=this;if(a.index=t,void 0===a[this.displayMember])throw new Error("jqxTagCloud: Insert tag requires a valid displayMember field to be supplied in the parameter");var e=void 0!==a[i.valueMember]?parseFloat(a[i.valueMember]):0;if(a[i.valueMember]=isNaN(e)?0:e,i.source.insertTag&&"function"==typeof i.source.insertTag)i.source.insertTag(t,a,function(e){if(e){i.records.splice(t,0,a);for(var r=t+1;r<i.records.length;r++)i.records[r].index+=1;for(r=0;r<i.hiddenList.length;r++)i.hiddenList[r]>=t&&i.hiddenList[r]++;i._renderTags()}});else{i.records.splice(t,0,a);for(var r=t+1;r<i.records.length;r++)i.records[r].index+=1;for(r=0;r<i.hiddenList.length;r++)i.hiddenList[r]>=t&&i.hiddenList[r]++;i._renderTags()}},updateAt:function(t,r){var a=this;if(void 0===r[this.displayMember])throw new Error("jqxTagCloud: Update tag requires a valid displayMember field to be supplied in the parameter");r.index=t,r.uid=a.records[t].uid,a.source.updateTag&&"function"==typeof a.source.updateTag?a.source.updateTag(t,r,function(e){e&&(p.each(r,function(e,r){a.records[t][e]=r}),a._renderTags())}):(p.each(r,function(e,r){a.records[t][e]=r}),a._renderTags())},removeAt:function(t){var a=this;if(a.source.deleteTag&&"function"==typeof a.source.deleteTag)a.source.deleteTag(t,function(e){if(e){a.records.splice(t,1);for(var r=t;r<a.records.length;r++)--a.records[r].index;for(r=0;r<a.hiddenList.length;r++)a.hiddenList[r]>t?a.hiddenList[r]--:a.hiddenList[r]===t&&a.hiddentList.splice(t,1)}});else{a.records.splice(t,1);for(var e=t;e<a.records.length;e++)--a.records[e].index;for(e=0;e<a.hiddenList.length;e++)a.hiddenList[e]>t?a.hiddenList[e]--:a.hiddenList[e]===t&&a.hiddentList.splice(t,1)}a._renderTags()},hideItem:function(e){var r=this;if("number"==typeof e&&-1===r.hiddenList.indexOf(e)){r.hiddenList.push(e);for(var t=-1,a=0;a<r.renderedData.length;a++)r.renderedData[a].index===e&&(t=a);-1!==t&&(p(r._el).find("li")[t].style.display="none")}},showItem:function(e){var r=this;if(-1!==r.hiddenList.indexOf(e)){for(var t=-1,a=0;a<r.renderedData.length;a++)r.renderedData[a].index===e&&(t=a);-1!==t&&(p(r._el).find("li")[t].style.display=""),r.hiddenList.splice(r.hiddenList.indexOf(e),1)}},render:function(){var t=this;t._updateSize(),t.renderedData=[],t._el=p("<ul>"),t.host.addClass(t.toThemeProperty("jqx-widget jqx-tag-cloud")),t._setRtl(),t.host.append(t._el),t.focusedItem=null,t.minColor=t._parseColor(t.minColor),t.maxColor=t._parseColor(t.maxColor),t.displayLimit=parseInt(t.displayLimit),t.disabled&&t.host.addClass(t.toThemeProperty("jqx-fill-state-disabled")),t.addHandler(t._el,"click",function(e){p(document.activeElement).parents("#"+t._el[0].parentElement.id).length||(null!=t.focusedItem?p(t.focusedItem).focus():(p(t._el).find("a")[0].focus(),t.focusedItem=document.activeElement)),t.disabled&&e.preventDefault(),"a"===e.target.tagName.toLowerCase()&&(e.target.focus(),t.focusedItem=document.activeElement),"li"===e.target.tagName.toLowerCase()&&(p(e.target).find("a").focus(),t.focusedItem=document.activeElement);var r=p(e.target).closest("li").index();-1!==r&&t._raiseEvent(0,{label:t.renderedData[r][t.displayMember],url:t.renderedData[r][t.urlMember],value:t.renderedData[r][t.valueMember],visibleIndex:r,index:t.renderedData[r].index,target:p(e.target).closest("li")[0],originalEvent:e})}),t._addKeyboardSupport()},resize:function(e,r){var t=this;t.width=e,t.height=r,t._updateSize()},propertyChangedHandler:function(e,r,t,a){var i=this;"source"===r&&i.dataBind(e.source),"displayLimit"===r&&(i[r]=parseInt(a)),"minColor"!==r&&"maxColor"!==r||(i[r]=i._parseColor(a)),"rtl"!==r?"width"!==r&&"height"!==r?"textColor"!==r||i.minColor&&i.maxColor?i._renderTags():i._updateColor():i._updateSize():i._setRtl()},_alterCase:function(e){var r=this;if("none"!==r.alterTextCase)switch(r.alterTextCase){case"allLower":for(var t=0;t<e.length;t++)e[t][r.displayMember]=e[t][r.displayMember].toString().toLowerCase();break;case"allUpper":for(t=0;t<e.length;t++)e[t][r.displayMember]=e[t][r.displayMember].toString().toUpperCase();break;case"firstUpper":for(t=0;t<e.length;t++)e[t][r.displayMember]=e[t][r.displayMember].toString().toLowerCase(),e[t][r.displayMember]=e[t][r.displayMember].substr(0,1).toUpperCase()+e[t][r.displayMember].substr(1);break;case"titleCase":for(t=0;t<e.length;t++)e[t][r.displayMember]=e[t][r.displayMember].toString().replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()});break;default:throw new Error("jqxTagCloud: Invalid alterTextCase value. Possible values: 'none', 'allLower', 'allUpper', 'firstUpper', 'titleCase'")}return e},_addKeyboardSupport:function(){var r=this;r.addHandler(r._el,"keydown",function(e){39==e.keyCode&&(p("a:focus").closest("li").next().find("a").focus(),r.focusedItem=document.activeElement),37==e.keyCode&&(p("a:focus").closest("li").prev().find("a").focus(),r.focusedItem=document.activeElement)})},_renderTags:function(){var t=this,e=t.records.slice();if(p.each(t.records,function(e,r){if(void 0===r[t.displayMember])throw new Error("jqxTagCloud: 'label' property must be specified for every element.")}),e=t._filter(e),e=t._sort(e),e=t._alterCase(e),t._el.empty(),0!==e.length){for(var r=t._getMaxValue(e),a=t._getMinValue(e),i=r-a,n=0;n<e.length;n++){var d=t._prepareTag(e[n],a,i);t._el.append(d),-1!=t.hiddenList.indexOf(e[n].index)&&(d[0].style.display="none")}t.renderedData=e,t.focusedItem=null}},_prepareTag:function(e,r,t){var a=this;t=t||1;var i=p("<li>"),n="",n=null!==a.tagRenderer&&"function"==typeof a.tagRenderer?a.tagRenderer.apply(a,arguments):e[a.displayMember]+(a.displayValue?"("+e[a.valueMember]+")":"");n=p('<a rel="tag">').append(n);var d="javascript:void(0)";void 0!==e[a.urlMember]&&(d=(null!=a.urlBase?a.urlBase:"")+e[a.urlMember]),n.attr("href",d),i.append(n),i.addClass(a.toThemeProperty("jqx-tag-cloud-item"));var o,s,l,f,u,c=+a.minFontSize+(a.maxFontSize-a.minFontSize)*((e[a.valueMember]-r)/t);return i[0].style.fontSize=c+a.fontSizeUnit,a.minColor&&a.maxColor?(u=(u=a.minColor.split("(")[1].split(")")[0]).split(","),o=parseInt(u[0]),s=parseInt(u[1]),l=parseInt(u[2]),f=parseFloat(u[3]),u=(u=a.maxColor.split("(")[1].split(")")[0]).split(","),d=parseInt(u[0]),n=parseInt(u[1]),c=parseInt(u[2]),u=parseFloat(u[3]),o+=Math.floor((e[a.valueMember]-r)/t*(d-o)),s+=Math.floor((e[a.valueMember]-r)/t*(n-s)),l+=Math.floor((e[a.valueMember]-r)/t*(c-l)),f+=(e[a.valueMember]-r)/t*(u-f),i[0].style.color="rgba("+o+","+s+","+l+","+f+")",i.find("a")[0].style.color="inherit"):null!==a.textColor&&(i[0].style.color=a.textColor,i.find("a")[0].style.color="inherit"),i},_parseColor:function(e){var r,t;if("rgba"===(e=p("<span>").css("color",e).css("color")).substr(0,4))return e;if("rgb"!==e.substr(0,3))return"#"===e.substr(0,1)&&7===e.length?"rgba("+parseInt(e.substr(1,2),16)+","+parseInt(e.substr(3,2),16)+","+parseInt(e.substr(5,2),16)+",1)":"#"===e.substr(0,1)&&4===e.length?"rgba("+parseInt(e.substr(1,1)+e.substr(1,1),16)+","+parseInt(e.substr(2,1)+e.substr(2,1),16)+","+parseInt(e.substr(3,1)+e.substr(3,1),16)+",1)":(e=void 0!==(t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"})[(r=e).toLowerCase()]&&t[r.toLowerCase()])?"rgba("+parseInt(e.substr(1,2),16)+","+parseInt(e.substr(3,2),16)+","+parseInt(e.substr(5,2),16)+",1)":e;var a=(a=e.split("(")[1].split(")")[0]).split(",");return"rgba("+parseInt(a[0])+","+parseInt(a[1])+","+parseInt(a[2])+",1)"},_events:["itemClick","bindingUpdateComplete","bindingComplete"],_raiseEvent:function(e,r){e=this._events[e],e=p.Event(e);return e.args=r,this.host.trigger(e)},_filter:function(e){var t=this;if(0!=t.minValueToDisplay)for(var r=0;r<e.length;)e[r][t.valueMember]<t.minValueToDisplay?e.splice(r,1):r++;if(0!=t.maxValueToDisplay)for(r=0;r<e.length;)e[r][t.valueMember]>t.maxValueToDisplay?e.splice(r,1):r++;return null==t.displayLimit||isNaN(t.displayLimit)||(!0===t.takeTopWeightedItems?(e.sort(function(e,r){return e[t.valueMember]<r[t.valueMember]?1:e[t.valueMember]>r[t.valueMember]?-1:0}),(e=e.slice(0,t.displayLimit)).sort(function(e,r){return e.index<r.index?-1:e.index>r.index?1:0})):e=e.slice(0,t.displayLimit)),e},_sort:function(e){var t=this;if("none"===t.sortBy)return e;if("label"===t.sortBy)e.sort(function(e,r){return e[t.displayMember]<r[t.displayMember]?-1:e[t.displayMember]>r[t.displayMember]?1:0});else{if("value"!==t.sortBy)throw new Error("jqxTagCloud: sortBy option needs to be either 'none' or 'label' or 'value'");e.sort(function(e,r){return e[t.valueMember]<r[t.valueMember]?-1:e[t.valueMember]>r[t.valueMember]?1:0})}if("ascending"===t.sortOrder)return e;if("descending"===t.sortOrder)return e.reverse();throw new Error("jqxTagCloud: sortOrder option needs to be either 'ascending' or 'descending'")},_getMaxValue:function(e){for(var r=e[0][this.valueMember],t=0;t<e.length;t++)r<e[t][this.valueMember]&&(r=e[t][this.valueMember]);return r},_getMinValue:function(e){for(var r=e[0][this.valueMember],t=0;t<e.length;t++)r>e[t][this.valueMember]&&(r=e[t][this.valueMember]);return r},_setSourceData:function(e){var r=this;r.records=e.records;for(var t=0;t<r.records.length;t++){var a=void 0!==r.records[t][r.valueMember]?parseFloat(r.records[t][r.valueMember]):0;r.records[t][r.valueMember]=isNaN(a)?0:a,r.records[t].index=t}r.hiddenList=[]},_updateColor:function(){this.textColor&&p(this._el).find("li").css("color",this.textColor)},_updateSize:function(){var e=this;e.width&&e.host.width(e.width),e.height&&e.host.height(e.height)},_setRtl:function(){var e=this;e.rtl?e.host.addClass(e.toThemeProperty("jqx-rtl")):e.host.removeClass(e.toThemeProperty("jqx-rtl"))}})}(jqxBaseFramework);
!function(x){x.jqx.jqxWidget("jqxEditor","",{}),x.extend(x.jqx._jqxEditor.prototype,{defineInstance:function(){var e={width:null,height:null,disabled:!1,pasteMode:"html",editable:!0,lineBreak:"default",changeType:null,toolbarPosition:"top",fontFamily:"sans-serif",commands:{bold:{tooltip:"Bold",command:"bold",type:"toggleButton"},italic:{tooltip:"Italic",command:"italic",type:"toggleButton"},underline:{tooltip:"Underline",command:"underline",type:"toggleButton"},format:{placeHolder:"Format Block",tooltip:"Format Block",command:"formatblock",value:[{value:"p",label:"Paragraph"},{value:"h1",label:"Header 1"},{value:"h2",label:"Header 2"},{value:"h3",label:"Header 3"},{value:"h4",label:"Header 4"}],type:"list",width:120,dropDownWidth:190,height:25},font:{placeHolder:"Font",tooltip:"Font Name",command:"fontname",value:[{label:"Arial",value:"Arial, Helvetica, sans-serif"},{label:"Comic Sans MS",value:'"Comic Sans MS", cursive, sans-serif'},{label:"Courier New",value:'"Courier New", Courier, monospace'},{label:"Georgia",value:"Georgia,serif"},{label:"Impact",value:"Impact,Charcoal,sans-serif"},{label:"Lucida Console",value:"'Lucida Console',Monaco,monospace"},{label:"Tahoma",value:"Tahoma,Geneva,sans-serif"},{label:"Times New Roman",value:"'Times New Roman',Times,serif"},{label:"Trebuchet MS",value:'"Trebuchet MS",Helvetica,sans-serif'},{label:"Verdana",value:"Verdana,Geneva,sans-serif"}],type:"list",width:160,height:25,dropDownWidth:160},size:{placeHolder:"Size",tooltip:"Font Size",command:"fontsize",value:[{label:"1 (8pt)",value:"xx-small"},{label:"2 (10pt)",value:"x-small"},{label:"3 (12pt)",value:"small"},{label:"4 (14pt)",value:"medium"},{label:"5 (18pt)",value:"large"},{label:"6 (24pt)",value:"x-large"},{label:"7 (36pt)",value:"xx-large"}],type:"list",width:45,height:25,dropDownWidth:160},color:{tooltip:"Text Color",command:"forecolor",value:"#000",type:"colorPicker"},background:{tooltip:"Fill Color",command:"backcolor",value:"#fff",type:"colorPicker"},left:{tooltip:"Align Left",command:"justifyleft",type:"toggleButton"},center:{tooltip:"Align Center",command:"justifycenter",type:"toggleButton"},right:{tooltip:"Align Right",command:"justifyright",type:"toggleButton"},outdent:{tooltip:"Indent Less",command:"outdent",type:"button"},indent:{tooltip:"Indent More",command:"indent",type:"button"},ul:{tooltip:"Insert unordered list",command:"insertunorderedlist",type:"toggleButton"},ol:{tooltip:"Insert ordered list",command:"insertorderedlist",type:"toggleButton"},image:{tooltip:"Insert image",command:"insertimage",type:"button"},link:{tooltip:"Insert link",command:"createlink",type:"toggleButton"},html:{tooltip:"View source",command:"viewsource",type:"toggleButton"},clean:{tooltip:"Remove Formatting",command:"removeformat",type:"button"}},createCommand:null,defaultLocalization:{bold:"Bold",italic:"Italic",underline:"Underline",format:"Format Block",font:"Font Name",size:"Font Size",color:"Text Color",background:"Fill Color",left:"Align Left",center:"Align Center",right:"Align Right",outdent:"Indent Less",indent:"Indent More",ul:"Insert unordered list",ol:"Insert ordered list",image:"Insert image",link:"Insert link",html:"View source",clean:"Remove Formatting",Remove:"Remove",Ok:"Ok",Cancel:"Cancel",Change:"Change","Go to link":"Go to link","Open in a new window/tab":"Open in a new window/tab",Align:"Align",VSpace:"VSpace",HSpace:"HSpace",Width:"Width",Height:"Height",Title:"Title",URL:"URL","Insert Image":"Insert Image","Insert Link":"Insert Link","Alt Text":"Alt Text","not set":"&ltnot set&gt",Left:"Left",Right:"Right",Paragraph:"Paragraph",Header:"Header",Arial:"Arial","Comic Sans MS":"Comic Sans MS","Courier New":"Courier New",Georgia:"Georgia",Impact:"Impact","Lucida Console":"Lucida Console",Tahoma:"Tahoma","Times New Roman":"Times New Roman","Trebuchet MS":"Trebuchet MS",Verdana:"Verdana"},localization:null,tools:"bold italic underline | format font size | color background | left center right | outdent indent | ul ol | image | link | clean | html",readOnly:!1,stylesheets:new Array,rtl:!1,colorPickerTemplate:'<div class="jqx-editor-color-picker"><div role="grid"><table class="jqx-editor-color-picker-table" cellspacing="0" cellpadding="0"><tbody><tr><td aria-label="RGB (0, 0, 0)"><div title="RGB (0, 0, 0)" style="background-color: rgb(0, 0, 0);"></div></td><td aria-label="RGB (68, 68, 68)"><div title="RGB (68, 68, 68)" style="background-color: rgb(68, 68, 68);"></div></td><td aria-label="RGB (102, 102, 102)"><div title="RGB (102, 102, 102)" style="background-color: rgb(102, 102, 102);"></div></td><td aria-label="RGB (153, 153, 153)"><div title="RGB (153, 153, 153)" style="background-color: rgb(153, 153, 153);"></div></td><td aria-label="RGB (204, 204, 204)"><div title="RGB (204, 204, 204)" style="background-color: rgb(204, 204, 204);"></div></td><td aria-label="RGB (238, 238, 238)"><div title="RGB (238, 238, 238)" style="background-color: rgb(238, 238, 238);"></div></td><td aria-label="RGB (243, 243, 243)"><div title="RGB (243, 243, 243)" style="background-color: rgb(243, 243, 243);"></div></td><td aria-label="RGB (255, 255, 255)"><div title="RGB (255, 255, 255)" style="background-color: rgb(255, 255, 255);"></div></td></tr></tbody></table></div><div role="grid"><table class="jqx-editor-color-picker-table" cellspacing="0" cellpadding="0"><tbody><tr><td aria-label="RGB (255, 0, 0)"><div title="RGB (255, 0, 0)" style="background-color: rgb(255, 0, 0);"></div></td><td aria-label="RGB (255, 153, 0)"><div title="RGB (255, 153, 0)" style="background-color: rgb(255, 153, 0);"></div></td><td aria-label="RGB (255, 255, 0)"><div title="RGB (255, 255, 0)" style="background-color: rgb(255, 255, 0);"></div></td><td aria-label="RGB (0, 255, 0)"><div title="RGB (0, 255, 0)" style="background-color: rgb(0, 255, 0);"></div></td><td aria-label="RGB (0, 255, 255)"><div title="RGB (0, 255, 255)" style="background-color: rgb(0, 255, 255);"></div></td><td aria-label="RGB (0, 0, 255)"><div title="RGB (0, 0, 255)" style="background-color: rgb(0, 0, 255);"></div></td><td aria-label="RGB (153, 0, 255)"><div title="RGB (153, 0, 255)" style="background-color: rgb(153, 0, 255);"></div></td><td aria-label="RGB (255, 0, 255)"><div title="RGB (255, 0, 255)" style="background-color: rgb(255, 0, 255);"></div></td></tr></tbody></table></div><div role="grid"><table class="jqx-editor-color-picker-table" cellspacing="0" cellpadding="0"><tbody><tr><td aria-label="RGB (244, 204, 204)"><div title="RGB (244, 204, 204)" style="background-color: rgb(244, 204, 204);"></div></td><td aria-label="RGB (252, 229, 205)"><div title="RGB (252, 229, 205)" style="background-color: rgb(252, 229, 205);"></div></td><td aria-label="RGB (255, 242, 204)"><div title="RGB (255, 242, 204)" style="background-color: rgb(255, 242, 204);"></div></td><td aria-label="RGB (217, 234, 211)"><div title="RGB (217, 234, 211)" style="background-color: rgb(217, 234, 211);"></div></td><td aria-label="RGB (208, 224, 227)"><div title="RGB (208, 224, 227)" style="background-color: rgb(208, 224, 227);"></div></td><td aria-label="RGB (207, 226, 243)"><div title="RGB (207, 226, 243)" style="background-color: rgb(207, 226, 243);"></div></td><td aria-label="RGB (217, 210, 233)"><div title="RGB (217, 210, 233)" style="background-color: rgb(217, 210, 233);"></div></td><td aria-label="RGB (234, 209, 220)"><div title="RGB (234, 209, 220)" style="background-color: rgb(234, 209, 220);"></div></td></tr><tr><td id="T-Kw-Jn88" aria-label="RGB (234, 153, 153)"><div title="RGB (234, 153, 153)" style="background-color: rgb(234, 153, 153);"></div></td><td aria-label="RGB (249, 203, 156)"><div title="RGB (249, 203, 156)" style="background-color: rgb(249, 203, 156);"></div></td><td aria-label="RGB (255, 229, 153)"><div title="RGB (255, 229, 153)" style="background-color: rgb(255, 229, 153);"></div></td><td aria-label="RGB (182, 215, 168)"><div title="RGB (182, 215, 168)" style="background-color: rgb(182, 215, 168);"></div></td><td aria-label="RGB (162, 196, 201)"><div title="RGB (162, 196, 201)" style="background-color: rgb(162, 196, 201);"></div></td><td aria-label="RGB (159, 197, 232)"><div title="RGB (159, 197, 232)" style="background-color: rgb(159, 197, 232);"></div></td><td aria-label="RGB (180, 167, 214)"><div title="RGB (180, 167, 214)" style="background-color: rgb(180, 167, 214);"></div></td><td aria-label="RGB (213, 166, 189)"><div title="RGB (213, 166, 189)" style="background-color: rgb(213, 166, 189);"></div></td></tr><tr><td aria-label="RGB (224, 102, 102)"><div title="RGB (224, 102, 102)" style="background-color: rgb(224, 102, 102);"></div></td><td aria-label="RGB (246, 178, 107)"><div title="RGB (246, 178, 107)" style="background-color: rgb(246, 178, 107);"></div></td><td aria-label="RGB (255, 217, 102)"><div title="RGB (255, 217, 102)" style="background-color: rgb(255, 217, 102);"></div></td><td aria-label="RGB (147, 196, 125)"><div title="RGB (147, 196, 125)" style="background-color: rgb(147, 196, 125);"></div></td><td aria-label="RGB (118, 165, 175)"><div title="RGB (118, 165, 175)" style="background-color: rgb(118, 165, 175);"></div></td><td aria-label="RGB (111, 168, 220)"><div title="RGB (111, 168, 220)" style="background-color: rgb(111, 168, 220);"></div></td><td aria-label="RGB (142, 124, 195)"><div title="RGB (142, 124, 195)" style="background-color: rgb(142, 124, 195);"></div></td><td aria-label="RGB (194, 123, 160)"><div title="RGB (194, 123, 160)" style="background-color: rgb(194, 123, 160);"></div></td></tr><tr><td id="T-Kw-Jn104" aria-label="RGB (204, 0, 0)"><div title="RGB (204, 0, 0)" style="background-color: rgb(204, 0, 0);"></div></td><td aria-label="RGB (230, 145, 56)"><div title="RGB (230, 145, 56)" style="background-color: rgb(230, 145, 56);"></div></td><td aria-label="RGB (241, 194, 50)"><div title="RGB (241, 194, 50)" style="background-color: rgb(241, 194, 50);"></div></td><td aria-label="RGB (106, 168, 79)"><div title="RGB (106, 168, 79)" style="background-color: rgb(106, 168, 79);"></div></td><td aria-label="RGB (69, 129, 142)"><div title="RGB (69, 129, 142)" style="background-color: rgb(69, 129, 142);"></div></td><td aria-label="RGB (61, 133, 198)"><div title="RGB (61, 133, 198)" style="background-color: rgb(61, 133, 198);"></div></td><td aria-label="RGB (103, 78, 167)"><div title="RGB (103, 78, 167)" style="background-color: rgb(103, 78, 167);"></div></td><td aria-label="RGB (166, 77, 121)"><div title="RGB (166, 77, 121)" style="background-color: rgb(166, 77, 121);"></div></td></tr><tr><td aria-label="RGB (153, 0, 0)"><div title="RGB (153, 0, 0)" style="background-color: rgb(153, 0, 0);"></div></td><td aria-label="RGB (180, 95, 6)"><div title="RGB (180, 95, 6)" style="background-color: rgb(180, 95, 6);"></div></td><td aria-label="RGB (191, 144, 0)"><div title="RGB (191, 144, 0)" style="background-color: rgb(191, 144, 0);"></div></td><td aria-label="RGB (56, 118, 29)"><div title="RGB (56, 118, 29)" style="background-color: rgb(56, 118, 29);"></div></td><td aria-label="RGB (19, 79, 92)"><div title="RGB (19, 79, 92)" style="background-color: rgb(19, 79, 92);"></div></td><td aria-label="RGB (11, 83, 148)"><div title="RGB (11, 83, 148)" style="background-color: rgb(11, 83, 148);"></div></td><td aria-label="RGB (53, 28, 117)"><div title="RGB (53, 28, 117)" style="background-color: rgb(53, 28, 117);"></div></td><td aria-label="RGB (116, 27, 71)"><div title="RGB (116, 27, 71)" style="background-color: rgb(116, 27, 71);"></div></td></tr><tr><td aria-label="RGB (102, 0, 0)"><div title="RGB (102, 0, 0)" style="background-color: rgb(102, 0, 0);"></div></td><td aria-label="RGB (120, 63, 4)"><div title="RGB (120, 63, 4)" style="background-color: rgb(120, 63, 4);"></div></td><td aria-label="RGB (127, 96, 0)"><div title="RGB (127, 96, 0)" style="background-color: rgb(127, 96, 0);"></div></td><td aria-label="RGB (39, 78, 19)"><div title="RGB (39, 78, 19)" style="background-color: rgb(39, 78, 19);"></div></td><td aria-label="RGB (12, 52, 61)"><div title="RGB (12, 52, 61)" style="background-color: rgb(12, 52, 61);"></div></td><td aria-label="RGB (7, 55, 99)"><div title="RGB (7, 55, 99)" style="background-color: rgb(7, 55, 99);"></div></td><td aria-label="RGB (32, 18, 77)"><div title="RGB (32, 18, 77)" style="background-color: rgb(32, 18, 77);"></div></td><td aria-label="RGB (76, 17, 48)"><div title="RGB (76, 17, 48)" style="background-color: rgb(76, 17, 48);"></div></td></tr></tbody></table></div></div>',touchMode:!1,keyPressed:null,events:["change"]};return this===x.jqx._jqxEditor.prototype||(x.extend(!0,this,e),this.localization=this.defaultLocalization),e},createInstance:function(e){var n=this;n.textArea=n.host;var t=n.host.attr("contenteditable");if(n.host.addClass(n.toThemeProperty("jqx-widget")),1==t||"true"==t){n.inline=!0,n.widget=n.host,n.editorDocument=document,n.selection=new d(n.editorDocument);t=x("<div class='jqx-editor-toolbar-container' unselectable='on' aria-label='Formatting options' role='toolbar'><div class='jqx-editor-toolbar'></div>");t.insertBefore(n.host),n.toolbarContainer=t,n.toolbar=t.find(".jqx-editor-toolbar"),n.editor=n.host,n.contentEditableElement=n.element}else{var r=x("<div class='jqx-editor'><div class='jqx-editor-container'><div class='jqx-editor-toolbar-container' aria-label='Formatting options' role='toolbar'><div class='jqx-editor-toolbar'></div></div><div class='jqx-editor-content'><iframe  src='javascript:\"<html></html>\"' allowtransparency='true' frameborder='0'></iframe></div></div></div>");n.widget=r,n.widget[0].className=n.widget[0].className+" "+n.element.className;try{n.widget[0].style=n.element.style}catch(e){}var a=x.trim(n.host.html())+"&#8203;";"default"==n.lineBreak||"div"==n.lineBreak?a="<div>"+a+"</div>":"p"==n.lineBreak&&(a="<p>"+a+"</p>"),a=(a=a.replace(/&lt;/gi,"<")).replace(/&gt;/gi,">"),n.host.css("display","none"),n.host.after(r),r.find("iframe").after(n.host),n.container=r.find(".jqx-editor-container"),n.toolbarContainer=r.find(".jqx-editor-toolbar-container"),n.toolbar=r.find(".jqx-editor-toolbar"),n.iframe=r.find("iframe"),n.content=r.find(".jqx-editor-content");var l=function(){n.editorDocument=n.iframe[0].contentWindow.document,n.selection=new d(n.editorDocument);var e=0;n.addHandler(n.iframe,"load",function(){1<++e&&(n.iframe.off("load"),n.content.find("iframe").remove(),x("<iframe  src='javascript:\"<html></html>\"' allowtransparency='true' frameborder='0'></iframe>").appendTo(n.content),n.iframe=r.find("iframe"),l())}),x.jqx.browser.mozilla||(n.editorDocument.designMode="On"),n.editorDocument.open();var t,o=n.rtl?"direction:rtl;":"",i=x.jqx.browser.msie?"::selection{color: #fff; background: #328EFD;};::-moz-selection{color: #fff; background: #328eD;};::selection:window-inactive {background: #c7c7c7; color: #000;}::-moz-selection:window-inactive {background: #c7c7c7; color: #000;}html{font-size:13px; height:100%;}body{padding-top:1px;margin-top:-1px; padding-right: 1px; overflow-x: hidden;word-wrap: break-word;-webkit-nbsp-mode: space;-webkit-line-break: after-white-space;":"";n.editorDocument.write("<!DOCTYPE html><html><head><meta charset='utf-8' /><style>html,body{padding:0; margin:0; font-size: 13px; font-family: "+n.fontFamily+"; background:#fff; min-height:100%; "+o+"}"+i+"}h1{font-size:2em;margin:.67em 0}h2{font-size: 1.5em; margin: .75em 0}h3{font-size: 1.17em; margin: .83em 0}h4{font-size:1em; margin: 1.12em 0 }h5{font-size: .83em; margin: 1.5em 0}h6{font-size: .75em; margin: 1.67em 0}p{margin: 0px;padding:0 .2em}ul,ol{padding-left:2.5em}a{color:#00a}code{font-size:1.23em}.jqx-editor-paste-element {position: absolute; left: -1000px; height: 1px; overflow: hidden; top: -1000px;}.jqx-editor-focus {border: 1px solid #aaa !important;}</style>"+x.map(n.stylesheets,function(e){return"<link rel='stylesheet' href='"+e+"'>"}).join("")+"</head><body autocorrect='off' contenteditable='true'></body></html>"),n.contentEditableElement=n.editorDocument.body,n.host.is("textarea")?(n._textArea=n.element,(t=n.host.data()).jqxEditor.host=r,t.jqxEditor.element=r[0],n.element=r[0],r[0].id=n._textArea.id,n._textArea.id=n._textArea.id+"TextArea",x(n.element).addClass(n.toThemeProperty("jqx-widget"))):((t=n.host.data()).jqxEditor.host=r,t.jqxEditor.element=r[0],n.element=r[0]),n.host=x(n.element),n.host.data(t);try{n.editorDocument.execCommand("useCSS",!1,!1),n.editorDocument.execCommand("enableInlineTableEditing",null,!1)}catch(e){}try{n.editorDocument.execCommand("styleWithCSS",0,!0)}catch(e){}n.editorDocument.close(),n.editor=x(n.editorDocument.body),n.editor.html(a).attr("spellcheck",!1).attr("autocorrect","off")};l(),x.jqx.utilities.resize(n.host,function(){n.widget.css("width",n.width),n.widget.css("height",n.height),n._arrange()})}},focus:function(){var e=this;x.jqx.browser.mozilla&&(e.focused||(e.iframe&&e.iframe.focus(),e.selection.selectNode(e.editor[0].firstChild,!0),e.selection.getRange().collapse(!0))),e.editor.focus();var t=null!=e.range?e.range:e.getRange();e.selectRange(t)},print:function(){var e=window.open("","_blank","width=450,height=470,left=400,top=100,menubar=yes,toolbar=no,location=no,scrollbars=yes");e.document.open(),e.document.write('<!doctype html><html><head><title>Print</title></head><body onload="print();">'+this.val()+"</body></html>"),e.document.close()},refresh:function(e){var v=this;x.each(this.defaultLocalization,function(e,t){v.localization[e]||(v.localization[e]=t)}),v._removeHandlers(),v.toolbar.addClass(v.toThemeProperty("jqx-widget-header")),v.content?(v.widget.css("width",v.width),v.widget.css("height",v.height),v.widget.addClass(v.toThemeProperty("jqx-editor")),v.widget.addClass(v.toThemeProperty("jqx-widget")),v.widget.addClass(v.toThemeProperty("jqx-rc-all")),v.widget.addClass(v.toThemeProperty("jqx-widget-header")),v.content.addClass(v.toThemeProperty("jqx-widget-content")),v.container.addClass(v.toThemeProperty("jqx-editor-container"))):(v.toolbarContainer.addClass(v.toThemeProperty("jqx-widget-header")),v.toolbarContainer.addClass(v.toThemeProperty("jqx-editor-toolbar-inline")),v.toolbarContainer.addClass(v.toThemeProperty("jqx-widget")),v.toolbarContainer.addClass(v.toThemeProperty("jqx-rc-all")),v.toolbarContainer.hide(),v.toolbarContainer.css("position","absolute"),v.editor.addClass(v.toThemeProperty("jqx-editor-inline")),v.toolbarContainer.css("width",v.host.outerWidth()+"px"));var t=v.toolbarContainer.index();if("top"==v.toolbarPosition&&0!=t||"bottom"==v.toolbarPosition&&1!=t)switch(v.toolbarPosition){case"bottom":v.toolbarContainer.insertAfter(v.content);break;case"top":default:v.toolbarContainer.insertBefore(v.content)}t=v.tools;if(!1!==t){function o(f,b){x.each(b,function(e,t){var d=v.commands[this];if(d)v.createCommand&&(r=v.createCommand(this.toString()),d=x.extend(d,r));else{if(!v.createCommand)return!0;if(!(d=v.createCommand(this.toString())))return!0;v.commands[this]||(v.commands[this]=d)}switch(v.localization[this]&&(d.tooltip=v.localization[this]),d.type){case"list":d.widget&&d.widget.jqxDropDownList("destroy");var o="formatblock"==d.command||"fontname"==d.command||"fontsize"==d.command,i=d.value||[],n=new Array,r=d.placeHolder||"Please Choose:";"fontname"==d.command?x.each(i,function(){var e=v.localization[this.label];n.push({label:e,value:this.value})}):"formatblock"==d.command?(r=v.localization.format,x.each(i,function(){var e;e=0<=this.label.indexOf("Header")?this.label.replace("Header",v.localization.Header):v.localization[this.label],n.push({label:e,value:this.value})})):n=i;r={enableBrowserBoundsDetection:!0,touchMode:v.touchMode,width:d.width||100,height:d.height||25,dropDownWidth:d.dropDownWidth||"auto",autoDropDownHeight:(d.value&&d.value.length)<12,placeHolder:r,source:n,theme:v.theme,hint:!1,keyboardSelection:!1,focusable:!1,disabled:v.disabled,rtl:v.rtl,selectionRenderer:"fontsize"==d.command?function(){return"<div unselectable='on' style='margin-top: 0px; padding:0px;' class='"+(v.toThemeProperty("jqx-editor-toolbar-icon")+" "+v.toThemeProperty("jqx-editor-toolbar-icon-"+d.command))+"'></div>"}:null,renderer:o?function(e,t,o){return"formatblock"==d.command?"<"+o+' unselectable="on" style="padding: 0px; margin: 0px;">'+t+"</"+o+">":"fontname"==d.command?'<span unselectable="on" style="font-family: '+o+';">'+t+"<span>":"fontsize"==d.command?'<span unselectable="on" style="font-size: '+o+';">'+t+"<span>":void 0}:null},o="jqx-disableselect "+v.toThemeProperty("jqx-editor-dropdownlist")+" "+v.toThemeProperty("jqx-editor-toolbar-item");(m=x("<div unselectable='on' class='"+o+"'></div>")).appendTo(f),m.jqxDropDownList(r),d.init&&d.init(m);var t=null,a=null,l="";v.addHandler(m,"mousedown",function(e){var t;0<x(".jqx-editor-dropdownpicker").length&&x(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),0<x(".jqx-editor-dropdownlist").length&&(t=x(".jqx-editor-dropdownlist"),x.each(t,function(e,t){t!=m[0]&&x(t).jqxDropDownList("close")}))}),v.addHandler(m,"open",function(e){v.focused||v.focus(),v.updating=!0,v.activeElement=m,t=m.val(),l=""}),v.addHandler(m,"change",function(e){v.updating=!1,v.activeElement=null,a=m.val(),l=e.args.type,x.jqx.browser.msie&&x.jqx.browser.version<9&&v.focus()}),v.addHandler(m,"close",function(e){v.updating=!1,v.activeElement=null,t!=a&&("mouse"!=l&&"keyboard"!=l||v._refreshTools())}),v._addCommandHandler(m,"change",d.command,null,d);break;case"colorPicker":d.widget&&(x(d.colorPicker).remove(),d.widget.jqxDropDownButton("destroy"));var s=x('<div unselectable="on" style="padding-top: 4px;"></div>').attr("id","picker-"+d.command),o="jqx-disableselect "+v.toThemeProperty("jqx-editor-dropdownpicker")+" "+v.toThemeProperty("jqx-editor-toolbar-item");(m=x("<div unselectable='on' class='"+o+"'></div>")).appendTo(f),m.append(s),m.jqxDropDownButton({hint:!1,touchMode:v.touchMode,disabled:v.disabled,enableBrowserBoundsDetection:!0,width:d.width||45,height:d.height||25,rtl:v.rtl,focusable:!1,theme:v.theme});var c=x('<div unselectable="on" style="z-index: 55;">'),u=v.toThemeProperty("jqx-editor-toolbar-icon")+" "+v.toThemeProperty("jqx-editor-toolbar-icon-"+d.command),g=x("<div unselectable='on' class='"+u+"'></div>");c.append(g);var p=x('<div unselectable="on" class="jqx-editor-color-bar">').attr("id","bar-"+d.command).css("background-color",d.value);c.append(p),m.jqxDropDownButton("setContent",c),s.append(x(v.colorPickerTemplate)),d.colorPicker=s,d.init&&d.init(m),s.find("tr").attr("role","row").attr("unselectable","on"),s.find("td").attr("role","gridcell").attr("unselectable","on").css("-webkit-user-select","none"),s.find("div").attr("unselectable","on"),v.addHandler(m,"mousedown",function(e){var t;0<x(".jqx-editor-dropdownlist").length&&x(".jqx-editor-dropdownlist").jqxDropDownList("close"),0<x(".jqx-editor-dropdownpicker").length&&(t=x(".jqx-editor-dropdownpicker"),x.each(t,function(e,t){t!=m[0]&&x(t).jqxDropDownButton("close")}))}),v.addHandler(m,"open",function(){v.focused||v.focus(),v.updating=!0,v.activeElement=s}),v.addHandler(m,"close",function(e){v.updating=!1,v.activeElement=null,t!=a&&("mouse"!=l&&"keyboard"!=l||v._refreshTools())}),v.addHandler(s,"keydown",function(e){var t=e.keyCode,o=x(s).find(".jqx-editor-color-picker-selected-cell"),i=s.find("tr"),n=i.length,r=o.parent().children().length,e=o.index(),a=-999,l=o.parent();switch(x.each(i,function(e,t){if(this==l[0])return a=e,!1}),t){case 27:m.jqxDropDownButton("close");break;case 13:x(o).trigger("mousedown");break;case 38:a--;break;case 40:a++;break;case 39:e++;break;case 37:e--}0<=a&&a<=n&&0<=e&&e<=r&&(l=s.find("tr")[a],e=x(l).children()[e],e=x(e).children().css("background-color"),d.val(e))});var h=x(s).find("td");d.val=function(e){var t=v._rgbToHex(e);x.each(h,function(){var e=x(this).children().css("background-color");if(v._rgbToHex(e)==t)return h.removeClass("jqx-editor-color-picker-selected-cell"),x(this).addClass("jqx-editor-color-picker-selected-cell"),x("#bar-"+d.command).css("background",e),!1})},d.val(d.value),v._addCommandHandler(h,"mousedown",d.command,null,d);break;case"button":case"toggleButton":default:d.widget&&("button"==d.type?d.widget.jqxButton("destroy"):d.widget.jqxToggleButton("destroy"));var p=d.command,c=d.action,u=v.toThemeProperty("jqx-editor-toolbar-icon")+" "+v.toThemeProperty("jqx-editor-toolbar-icon-"+p),g=x("<div unselectable='on' class='"+u+"'></div>"),m=x("<div unselectable='on'></div>").addClass("jqx-disableselect").addClass(v.toThemeProperty("jqx-editor-toolbar-button"));(!d.init||p)&&m.append(g),m.appendTo(f),"button"==d.type?m.jqxButton({disabled:v.disabled,rtl:v.rtl,theme:v.theme}):"toggleButton"==d.type&&m.jqxToggleButton({disabled:v.disabled,rtl:v.rtl,uiToggle:!1,theme:v.theme}),d.init&&d.init(m),d.toggled=!1,d.toggle=function(){d.toggled=!d.toggled},v.addHandler(m,"mousedown",function(e){return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}),x.jqx.mobile.isTouchDevice()?v._addCommandHandler(m,"mousedown",p,c,d):v._addCommandHandler(m,"click",p,c,d)}if(d.widget=m){try{""!=d.tooltip&&(d.widget.attr("title",d.tooltip),d.widget.attr("data-tooltip",d.tooltip)),d.command&&d.widget.attr("data-command",d.command),d.widget.attr("aria-label",d.tooltip)}catch(e){}"button"!=d.type&&"toggleButton"!=d.type||(2<b.length&&(0==e?(m.css("border-right-radius","0px"),m.addClass(v.toThemeProperty("jqx-rc-l"))):e==b.length-1&&(m.css("border-left-radius","0px"),m.addClass(v.toThemeProperty("jqx-rc-r"))),m.removeClass(v.toThemeProperty("jqx-rc-all"))),0!=e&&e!=b.length-1&&2<b.length?(m.css("border-left-radius","0px"),m.css("border-right-radius","0px"),m.removeClass(v.toThemeProperty("jqx-rc-all"))):2==b.length?(0==e?(m.css("border-right-radius","0px"),m.addClass(v.toThemeProperty("jqx-rc-l"))):(m.css("border-left-radius","0px"),m.addClass(v.toThemeProperty("jqx-rc-r"))),m.removeClass(v.toThemeProperty("jqx-rc-all"))):1==b.length&&m.css("margin-right","0px"))}})}var i=t.split(" "),n=t.split(" | ");if(v.toolbar.css("direction",this.rtl?"rtl":"ltr"),0==n.length)o(v.toolbar,i);else{for(var r=0;r<n.length;r++){var i=n[r].split(" "),a=v.toThemeProperty("jqx-editor-toolbar-group")+" "+v.toThemeProperty("jqx-fill-state-normal"),a=x("<div class='"+a+"'></div>");a.addClass(v.toThemeProperty("jqx-rc-all")),v.toolbar.append(a),o(a,i)}for(var l=v.toolbar.find(".jqx-editor-toolbar-group"),d=l.length,r=0;r<d;r++)0==x(l[r]).children().length&&x(l[r]).remove()}x.jqx.browser.msie&&x.jqx.browser.version<8&&(x(".jqx-editor-toolbar-group").css("float","left"),x(".jqx-editor-toolbar-group").children().css("float","left"),x(".jqx-editor-toolbar-group").css("zoom","1"),x(".jqx-editor-toolbar-group").children().css("zoom","1"))}v._arrange(),v._addHandlers()},_arrange:function(){var e=this;e.content&&(""==e.tools||0==e.tools?(e.content.height(e.container.outerHeight()-parseInt(e.container.css("padding-top"))-parseInt(e.container.css("padding-bottom"))-6),e.content.css("margin-top","4px"),e.toolbar.hide()):(e.toolbar.show(),e.content.css("margin-top","0px"),e.content.height(e.container.outerHeight()-e.toolbar.outerHeight()-parseInt(e.container.css("padding-top"))-parseInt(e.container.css("padding-bottom"))-2),"top"!=e.toolbarPosition&&(e.content.css("margin-top","4px"),e.content.css("margin-bottom","0px"))),x.jqx.browser.msie&&x.jqx.browser.version<8&&(e.content.css("margin-top","4px"),e.content.height(e.container.height()-e.toolbar.outerHeight()-2*parseInt(e.container.css("padding-bottom"))-10),e.content.width(e.container.width()-2*parseInt(e.container.css("padding-left"))-2)),e.editor.height()<e.content.height()&&e.editor.height(e.content.height()))},propertyChangedHandler:function(e,t,o,i){null!=e.isInitialized&&0!=e.isInitialized&&"pasteMode"!=t&&"lineBreak"!=t&&"editable"!=t&&("disabled"==t&&e._refreshTools(),"width"!=t&&"height"!=t&&"toolbarPosition"!=t?("theme"==t&&x.jqx.utilities.setTheme(o,i,e.host),e.refresh()):e._arrange())},selectRange:function(e){e=e||this.getRange(),this.selection.selectRange(e)},getRange:function(){return this.selection.getRange()},getSelectedElement:function(){try{if(this.editorDocument.getSelection){var e,t=this.editorDocument.getSelection(),o=(e=t.getRangeAt(t.rangeCount-1)).startContainer,i=e.endContainer,n=e.commonAncestorContainer;return"#text"==o.nodeName&&(n=n.parentNode),"#text"==o.nodeName&&(o=o.parentNode),"body"==o.nodeName.toLowerCase()&&(o=o.firstChild),"#text"==i.nodeName&&(i=i.parentNode),"body"==i.nodeName.toLowerCase()&&(i=i.lastChild),o==i&&(n=o),i}if(this.editorDocument.selection){if(!(e=this.editorDocument.selection.createRange()).duplicate)return null;n=e.parentElement();var r=e.duplicate(),t=e.duplicate();return r.collapse(!0),t.moveToElementText(r.parentElement()),t.setEndPoint("EndToStart",r),o=r.parentElement(),r=e.duplicate(),(t=e.duplicate()).collapse(!1),r.moveToElementText(t.parentElement()),r.setEndPoint("StartToEnd",t),i=t.parentElement(),"body"==o.nodeName.toLowerCase()&&(o=o.firstChild),"body"==i.nodeName.toLowerCase()&&(i=i.lastChild),o==i&&(n=o),i}}catch(e){return null}return null},_addHandlers:function(){var d=this;d.addHandler(d.toolbar,"mousedown.editor"+d.element.id,function(e){return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1});function t(){d._textArea&&(d.updating||(d._textArea.value=d.val())),d.changed&&(d._raiseEvent("change"),d.changed=!1),d.focused=!1,d.inline&&(d.host.removeClass(d.toThemeProperty("jqx-fill-state-focus")),d.host.removeClass(d.toThemeProperty("jqx-editor-inline-focus")),""!=d.tools&&null!=d.tools&&d.toolbarContainer.fadeOut("fast"))}function a(){var e;d.focused=!0,d.inline&&(d.host.addClass(d.toThemeProperty("jqx-fill-state-focus")),d.host.addClass(d.toThemeProperty("jqx-editor-inline-focus")),d.host.addClass(d.toThemeProperty("jqx-rc-all")),""!=d.tools&&null!=d.tools&&(d.toolbarContainer.fadeIn("fast"),e=d.host.coord(),"bottom"!=d.toolbarPosition?d.toolbarContainer.offset({left:e.left,top:e.top-d.toolbarContainer.outerHeight()-5}):d.toolbarContainer.offset({left:e.left,top:e.top+5+d.host.height()})))}x.jqx.browser.mozilla&&this.addHandler(x(document),"mousedown.editor"+d.element.id,function(e){t()}),d.addHandler(d.editor,"blur.editor"+d.element.id,function(e){t()}),d.addHandler(d.editor,"focus.editor"+d.element.id,function(e){a()}),d.addHandler(d.editor,"beforedeactivate.editor"+d.element.id,function(e){d.range=d.getRange()}),d.addHandler(d.editor,"mousedown.editor"+d.element.id,function(e){e.target.href||d.linkPopup&&d.linkPopup.remove(),d.range=d.getRange(),x.jqx.browser.mozilla&&(a(),e.stopPropagation()),0<x(".jqx-editor-dropdownpicker").length&&x(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),0<x(".jqx-editor-dropdownlist").length&&x(".jqx-editor-dropdownlist").jqxDropDownList("close"),d.inline&&d.editor.focus()}),x.jqx.mobile.isTouchDevice()&&(d.addHandler(x(d.editorDocument),"selectionchange.editor"+d.element.id,function(){d.editorDocument.activeElement!=d.editor[0]&&setTimeout(function(){d.iframe&&d.iframe[0].contentWindow.focus()},500)}),d.addHandler(x(d.editorDocument),"touchstart.editor"+d.element.id,function(){setTimeout(function(){d.iframe&&d.iframe[0].contentWindow.focus()},500)})),d.addHandler(d.editor,"mouseup.editor"+d.element.id,function(e){return"source"==d._documentMode||(d.range=d.getRange(),void d._refreshTools(null,!0))}),d.addHandler(d.editor,"keydown.editor"+d.element.id,function(e){if(d.keyPressed&&d.keyPressed(e),"source"==d._documentMode)return!0;if(x.jqx.browser.mozilla&&(d.focused||a()),d.changeType="keyboard",d.disabled)return e.preventDefault&&e.preventDefault(),!1;if(d.updating)return d.activeElement&&(i=x.Event("keydown"),x.extend(i,e),d.activeElement.trigger(i)),e.preventDefault&&e.preventDefault(),!1;var t=e||window.event,o=t.keyCode,i=String.fromCharCode(o).toLowerCase();if(d.editable||(n=[9,33,34,35,36,37,38,39,40,40,45],-1!=x.inArray(t.keyCode,n)||t.ctrlKey&&"c"==i||t.ctrlKey&&"a"==i||e.preventDefault()),(0<d.selection.getText().length||d.linkPopup)&&(n=[8,9,13,33,34,35,36,37,38,39,40,40,45,46],-1==!x.inArray(t.keyCode,n)&&(65!=t.keyCode||!t.ctrlKey||t.altKey||t.shiftKey)||(d._refreshToolsTimer&&clearTimeout(d._refreshToolsTimer),d._refreshToolsTimer=setTimeout(function(){d._refreshTools(null,!0,t.keyCode)},10))),13==o&&"default"!=d.lineBreak){var n=d.getSelectedElement();if(n){switch(n.nodeName.toLowerCase()){case"pre":case"li":case"ul":case"ol":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return!0}for(var r=n;null!=r;){if("#document"==r.nodeName){r=d.editorDocument.body;break}if(r.parentNode==d.editorDocument.body||r==d.editorDocument.body)break;r=r.parentNode}}if(r){o=d.getRange();"<div></div>"==d.editorDocument.body.innerHTML&&"br"!=d.lineBreak&&d.selection.insertContent("&#8203;"),"div"==d.lineBreak?r==d.editorDocument.body?x(r).append("<div>&#8203;</div><span id='INSERTION_MARKER'>&nbsp;</span>"):x("<div>&#8203;</div><span id='INSERTION_MARKER'>&nbsp;</span>").insertAfter(r):"p"==d.lineBreak?r==d.editorDocument.body?x(r).append("<p>&#8203;</p><span id='INSERTION_MARKER'>&nbsp;</span>"):x("<p>&#8203;</p><span id='INSERTION_MARKER'>&nbsp;</span>").insertAfter(r):d.execute("insertHTML","<br/>&#8203;<span id='INSERTION_MARKER'>&nbsp;</span>"),d.selectRange(o);n=x(d.editorDocument).find("#INSERTION_MARKER");return"br"!=d.lineBreak?d.selection.selectNode(x(n).prev()[0],!0):(d.selection.selectNode(n[0],!0),d.getRange().setStartAfter&&d.getRange().setStartAfter(n[0])),n.remove(),d.selection.collapse(!1),r&&r.nodeName&&"br"==d.lineBreak&&"#text"!=r.nodeName.toLowerCase()&&(d.selection.selectNode(r,!0),d.getRange().setStartAfter&&d.getRange().setStartAfter(r),d.selection.collapse(!1)),"br"!=d.lineBreak&&(o=d.getRange()).select&&o.select(),e.preventDefault&&e.preventDefault(),!1}}if(t.ctrlKey&&("k"==i||"u"==i||"b"==i||"i"==i)){e.preventDefault&&e.preventDefault();e=null;switch(i){case"k":e="link";break;case"u":e="underline";break;case"b":e="bold";break;case"i":e="italic"}return d.commands[e].widget&&d.commands[e].widget.trigger("click"),!1}}),d.addHandler(d.editor,"paste.editor"+d.element.id,function(e){if("source"==d._documentMode)return!0;if(d.readOnly)return!0;d.updating=!0,d.readOnly=!0;try{var l=d.getRange();"text"!=d.pasteMode||x.jqx.browser.mozilla?d.selection.insertContent('<div class="jqx-editor-paste-element">&nbsp;</div>'):d.selection.insertContent('<textarea cols="50" contenteditable="false" class="jqx-editor-paste-element"></textarea>');var t,o=x(window).scrollTop(),i=x(d.editorDocument).find(".jqx-editor-paste-element");i.css("top",o+"px"),d.editor[0].createTextRange?(e.preventDefault(),(t=d.editor[0].createTextRange()).moveToElementText(i[0]),t.execCommand("Paste")):((t=d.editorDocument.createRange()).selectNodeContents(i[0]),d.selectRange(t)),"text"!=d.pasteMode||x.jqx.browser.mozilla||i.select(),d.marker=i,setTimeout(function(){d.selectRange(l);function e(e){var t=d.editorDocument.createElement("div"),o=d.editorDocument.createDocumentFragment();for(t.innerHTML=e;t.firstChild;)o.appendChild(t.firstChild);return o}if("text"!=d.pasteMode){var t=e(d.marker.html());if(t.firstChild&&"jqx-editor-paste-element"===t.firstChild.className){for(var o=[],i=0,n=t.childNodes.length;i<n;i++)o.push(t.childNodes[i].innerHTML);t=e(o.join("<br />"))}var r=document.createElement("div");r.appendChild(t.cloneNode(!0));var a=r.innerHTML}else{a=d.marker.val();""!=d.marker.html()&&-1==d.marker.val().indexOf("\n")&&(a=(a=(a=(a=(a=(a=d.marker.html()).replace(/&nbsp;/gm,"")).replace(/\n\n/gm,"\n")).replace(/<br[^>]*>/gi,"\n")).replace(/<li[^>]*>/gi,"\n")).replace(/<p[^>]*>/gi,"\n"),d.marker.html(a),a=d.marker.text())}r=a,a="text"==d.pasteMode,r=r=a?d.paragraphise?(r=(r="<p>"+r+"</p>").replace(/\n/g,"</p><p>")).replace(/<p>\s<\/p>/gi,""):r.replace(/\n/g,"<br />"):((r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=r.replace(/<html[^>]*?>(.*)/gim,"$1")).replace(/<\/html>/gi,"")).replace(/<body[^>]*?>(.*)/gi,"$1")).replace(/<\/body>/gi,"")).replace(/<style[^>]*?>[\s\S]*?<\/style[^>]*>/gi,"")).replace(/<(?:meta|link)[^>]*>\s*/gi,"")).replace(/<\\?\?xml[^>]*>/gi,"")).replace(/<w:[^>]*>[\s\S]*?<\/w:[^>]*>/gi,"")).replace(/<o:p>\s*<\/o:p>/g,"")).replace(/<o:p>[\s\S]*?<\/o:p>/g,"&nbsp;")).replace(/<\/?\w+:[^>]*>/gi,"")).replace(/<\!--[\s\S]*?-->/g,"")).replace(/<\!\[[\s\S]*?\]>/g,"")).replace(/\s*mso-[^:]+:[^;"']+;?/gi,"")).replace(/<(\w[^>]*) style='([^\']*)'([^>]*)/gim,"<$1$3")).replace(/<(\w[^>]*) style="([^\"]*)"([^>]*)/gim,"<$1$3")).replace(/\s*margin: 0cm 0cm 0pt\s*;/gi,"")).replace(/\s*margin: 0cm 0cm 0pt\s*"/gi,'"')).replace(/\s*text-indent: 0cm\s*;/gi,"")).replace(/\s*text-indent: 0cm\s*"/gi,'"')).replace(/\s*text-align: [^\s;]+;?"/gi,'"')).replace(/\s*page-break-before: [^\s;]+;?"/gi,'"')).replace(/\s*font-variant: [^\s;]+;?"/gi,'"')).replace(/\s*tab-stops:[^;"']*;?/gi,"")).replace(/\s*tab-stops:[^"']*/gi,"")).replace(/\s*face="[^"']*"/gi,"")).replace(/\s*face=[^ >]*/gi,"")).replace(/\s*font-family:[^;"']*;?/gi,"")).replace(/\s*font-size:[^;"']*;?/gi,"")).replace(/<(\w[^>]*) class=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/<(\w+)[^>]*\sstyle="[^"']*display\s?:\s?none[\s \S]*?<\/\1>/gi,"")).replace(/\s*style='\s*'/gi,"")).replace(/\s*style="\s*"/gi,"")).replace(/<span\s*[^>]*>\s*&nbsp;\s*<\/span>/gi,"&nbsp;")).replace(/<span\s*[^>]*><\/span>/gi,"")).replace(/<(\w[^>]*) align=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/<span([^>]*)>([\s\S]*?)<\/span>/gi,"$2")).replace(/<font\s*>([\s\S]*?)<\/font>/gi,"$1")).replace(/<(u|i|strike)>&nbsp;<\/\1>/gi,"&nbsp;")).replace(/<h\d>\s*<\/h\d>/gi,"")).replace(/<(\w[^>]*) language=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/<(\w[^>]*) onmouseover="([^\"']*)"([^>]*)/gi,"<$1$3")).replace(/<(\w[^>]*) onmouseout="([^\"']*)"([^>]*)/gi,"<$1$3")).replace(/<h(\d)([^>]*)>/gi,"<h$1>")).replace(/<(h\d)><font[^>]*>([\s\S]*?)<\/font><\/\1>/gi,"<$1>$2</$1>")).replace(/<(h\d)><em>([\s\S]*?)<\/em><\/\1>/gi,"<$1>$2</$1>")).replace(/<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1</strong>")).replace(/<i\b[^>]*>(.*?)<\/i[^>]*>/gi,"<em>$1</em>")).replace(/<\s+[^>]*>/gi,"")).replace(/<span>([\s\S]*?)<\/span>/gi,"$1")).replace(/<span>([\s\S]*?)<\/span>/gi,"$1")).replace(/<div>([\s\S]*?)<\/div>/gi,"$1")).replace(/<div>([\s\S]*?)<\/div>/gi,"$1")).replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"")).replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"")).replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"")).trim&&(r=r.trim()),d.paragraphise?"<p"!==r.substr(0,2)&&(r=(r=(r="<p>"+r+"</p>").replace(/\n/g,"</p><p>")).replace(/<br[^>]*>/gi,"</p><p>")):(r.replace(/<p>/gi,"<br />"),r.replace(/<\/p>/gi,"")),(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=r.replace(/<br>/gi,"<br />")).replace(/<br[^>]*><\/p>/gim,"</p>")).replace(/<p>&nbsp;<\/p>/gi,"")).replace(/<p>\s<\/p>/gi,"")).replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"")).replace(/MsoNormal/gi,"")).replace(/<\/?meta[^>]*>/gi,"")).replace(/<\/?xml[^>]*>/gi,"")).replace(/<\?xml[^>]*\/>/gi,"")).replace(/<!--(.*)-->/gi,"")).replace(/<!--(.*)>/gi,"")).replace(/<!(.*)-->/gi,"")).replace(/<w:[^>]*>(.*)<\/w:[^>]*>/gi,"")).replace(/<w:[^>]*\/>/gi,"")).replace(/<\/?w:[^>]*>/gi,"")).replace(/<m:[^>]*\/>/gi,"")).replace(/<m:[^>]>(.*)<\/m:[^>]*>/gi,"")).replace(/<o:[^>]*>(.*)<\/o:[^>]*>/gi,"")).replace(/<o:[^>]*\/>/gi,"")).replace(/<\/?m:[^>]*>/gi,"")).replace(/style=\"([^>]*)\"/gi,"")).replace(/style=\'([^>]*)\'/gi,"")).replace(/class=\"(.*)\"/gi,"")).replace(/class=\'(.*)\'/gi,"")).replace(/<b>/gi,"<strong>")).replace(/<\/b>/gi,"</strong>")).replace(/<p[^>]*>/gi,"<p>")).replace(/<\/p[^>]*>/gi,"</p>")).replace(/<span[^>]*>/gi,"")).replace(/<\/span[^>]*>/gi,"")).replace(/<st1:[^>]*>/gi,"")).replace(/<\/st1:[^>]*>/gi,"")).replace(/<font[^>]*>/gi,"")).replace(/<\/font[^>]*>/gi,"")).replace("  ","")).replace(/<strong><\/strong>/gi,"")).replace(/<p><\/p>/gi,"")).replace(/\/\*(.*)\*\//gi,"")).replace(/<!--/gi,"")).replace(/-->/gi,"")).replace(/<style[^>]*>[^<]*<\/style[^>]*>/gi,"")).trim()),d.getRange();d.selection.insertContent(r+"<span id='INSERTION_MARKER'>&nbsp;</span>"),d.marker.remove();r=x(d.editorDocument).find("#INSERTION_MARKER");d.selection.selectNode(r[0],!0),d.getRange().setStartAfter&&d.getRange().setStartAfter(r[0]),r.remove(),d.selection.collapse(!1),r.removeAttr("id"),d._refreshTools(),d.changed=!0},100),d.updating=!1,d.readOnly=!1}catch(e){console&&console.log(e)}}),d.addHandler(d.editor,"keyup.editor"+d.element.id,function(e){if("source"==d._documentMode)return!0;if(d.updating||d.disabled||!d.editable)return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1;d.range=d.getRange(),d.changed=!0;e=e||window.event,e.keyCode;-1==x.inArray(e.keyCode,[8,9,13,33,34,35,36,37,38,39,40,40,45,46])&&(65!=e.keyCode||!e.ctrlKey||e.altKey||e.shiftKey)||d._refreshTools(null,!0,e.keyCode)}),d.addHandler(d.editor,"click.editor"+d.element.id,function(e){return"source"==d._documentMode||(d.editImage&&(x(d.editImage).removeClass("jqx-editor-focus"),d.editImage=null),void("img"==e.target.tagName.toLowerCase()&&(e=e.target,d.editImage=e,x(d.editImage).addClass("jqx-editor-focus"))))}),d.addHandler(d.editor,"dblclick.editor"+d.element.id,function(e){return"source"==d._documentMode||void("img"==e.target.tagName.toLowerCase()&&(e=e.target,0<x("#imageWindow"+this.element.id).length&&(d.editImage=e,d._updateImageWindow())))})},_updateLinkWindow:function(){var e=this,t=x("#linkWindow"+this.element.id);t.jqxWindow({position:{center:e.widget}}),t.jqxWindow("open");var o=t.find("input"),i=t.find(".jqx-editor-link-checkbox"),n=t.find("button:first"),t=x(t.find("button")[1]);e.editLink&&e.editLink.href?(o[0].value=e.editLink.href||"",o[1].value=x(e.editLink).text()||e.editLink.href,i.val("_blank"==x(e.editLink).attr("target")),t.show()):(o[0].value="",o[1].value="",e.selection.isCollapsed()||((e=e.selection.getText()).match(/^(?!:\/\/)([a-zA-Z0-9]+\.)?[a-zA-Z0-9][a-zA-Z0-9-]+\.[a-zA-Z]{2,6}?$/i)?o[0].value=e:o[1].value=e),i.val(!1),t.hide()),0<o[0].value.length?n.jqxButton({disabled:!1}):n.jqxButton({disabled:!0})},_updateImageWindow:function(){var e=(e=this.editImage)||x("<img>")[0],t=x("#imageWindow"+this.element.id);t.jqxWindow({position:{center:this.widget}}),t.jqxWindow("open");var o=t.find("input"),i=x(t.find("button")[1]);this.editImage?i.show():i.hide(),o[0].value=e.src,""==o[0].value&&(o[0].value=""),o[1].value=e.alt,"auto"!=e.style.width?o[2].value=e.style.width:o[2].value="","auto"!=e.style.height?o[3].value=e.style.height:o[3].value="",e.style.marginLeft&&"0px"!=e.style.marginLeft?o[4].value=e.style.marginLeft:o[4].value="",e.style.marginTop&&"0px"!=e.style.marginTop?o[5].value=e.style.marginTop:o[5].value="";t=t.find(".jqx-editor-align"),e=x(e).css("float");"left"==e?t.jqxDropDownList({selectedIndex:1}):"right"==e?t.jqxDropDownList({selectedIndex:2}):t.jqxDropDownList({selectedIndex:0})},_removeHandlers:function(){var e=this;e.editor&&(e.removeHandler(e.editor,"paste.editor"+e.element.id),e.removeHandler(e.editor,"blur.editor"+e.element.id),e.removeHandler(e.editor,"focus.editor"+e.element.id),e.removeHandler(e.editor,"click.editor"+e.element.id),e.removeHandler(e.editor,"mousedown.editor"+e.element.id),e.removeHandler(e.editor,"mouseup.editor"+e.element.id),e.removeHandler(e.editor,"keyup.editor"+e.element.id),e.removeHandler(e.editor,"keydown.editor"+e.element.id),e.removeHandler(e.editor,"beforedeactivate.editor"+e.element.id),e.removeHandler(e.editor,"dblclick.editor"+e.element.id)),e.toolbar&&e.removeHandler(e.toolbar,"mousedown.editor"+e.element.id)},getParentByTag:function(e,t){var t=t.toLowerCase(),o=e;do{if(""==t||o.nodeName.toLowerCase()==t)return o}while(o=o.parentNode);return e},isStyleProperty:function(e,t,o,i){var t=t.toLowerCase(),n=e;do{if(n.nodeName.toLowerCase()==t&&n.style[o]==i)return!0}while(n=n.parentNode);return!1},setStyleProperty:function(e,t){this.style[t]=!1;var o=this.getParentByTag(e,t);o&&o.tagName.toLowerCase()==t&&(this.style[t]=!0),"del"==t&&this.getParentByTag(e,"strike")&&"strike"==this.getParentByTag(e,"strike").tagName.toLowerCase()&&(this.style.del=!0)},updateStyle:function(e){var t,o,i=this;if((e=i.getSelectedElement()?i.getSelectedElement():e)&&i.setStyleProperty)try{window.getComputedStyle?("#text"==e.nodeName.toLowerCase()&&(e=i.editor[0]),t=401==(o=window.getComputedStyle(e,null)).getPropertyValue("font-weight")?700:o.getPropertyValue("font-weight"),i.style={fontStyle:o.getPropertyValue("font-style"),fontSize:o.getPropertyValue("font-size"),textDecoration:o.getPropertyValue("text-decoration"),fontWeight:t,fontFamily:o.getPropertyValue("font-family"),textAlign:o.getPropertyValue("text-align"),color:i._rgbToHex(o.color),backColor:i._rgbToHex(o.backgroundColor)},i.style.fontStyle=o.getPropertyValue("font-style"),i.style.vAlign=o.getPropertyValue("vertical-align"),i.style.del=i.isStyleProperty(e,"span","textDecoration","line-through"),i.style.u=i.isStyleProperty(e,"span","textDecoration","underline"),i.style.backColor||(i.style.backColor=i._rgbToHex(function(e){for(var t="transparent";e&&(window.getComputedStyle(e).backgroundColor==t||"rgba(0, 0, 0, 0)"==window.getComputedStyle(e).backgroundColor);)e=e.parentNode;return e?window.getComputedStyle(e).backgroundColor:t}(e)))):(o=e.currentStyle,i.style={fontStyle:o.fontStyle,fontSize:o.fontSize,textDecoration:o.textDecoration,fontWeight:o.fontWeight,fontFamily:o.fontFamily,textAlign:o.textAlign,color:i._rgbToHex(o.color),backColor:i._rgbToHex(o.backgroundColor)}),i.setStyleProperty(e,"h1"),i.setStyleProperty(e,"h2"),i.setStyleProperty(e,"h3"),i.setStyleProperty(e,"h4"),i.setStyleProperty(e,"h5"),i.setStyleProperty(e,"h6"),i.setStyleProperty(e,"del"),i.setStyleProperty(e,"sub"),i.setStyleProperty(e,"sup"),i.setStyleProperty(e,"u"),"a"==e.nodeName.toLowerCase()&&"underline"==i.style.textDecoration&&(i.style.u=!0),(i.style.h1||i.style.h2||i.style.h3||i.style.h4||i.style.h5||i.style.h6)&&(i.style.heading=!0)}catch(e){return null}},_refreshTools:function(p,h,e){var m=this;if(!m.updating&&((p=m.getSelectedElement()?m.getSelectedElement():p)&&m.setStyleProperty)){m.updateStyle(p);var t=m.readOnly;if(!(m.readOnly=!0)!==m.tools){function o(e){x.each(e,function(e,t){var o=m.commands[this];if(!o)return!0;switch(o.type){case"list":o.widget.jqxDropDownList("clearSelection"),o.widget.jqxDropDownList({disabled:m.disabled});break;case"colorPicker":o.val(o.value),o.widget.jqxDropDownButton({disabled:m.disabled});break;case"toggleButton":o.widget.jqxToggleButton("unCheck"),o.widget.jqxToggleButton({disabled:m.disabled});break;case"button":default:o.widget.jqxButton({disabled:m.disabled})}})}var i=m.tools.split(" "),n=m.tools.split(" | ");if(0==n.length)o(i);else for(var r=0;r<n.length;r++)o(i=n[r].split(" "));if(m.style){function a(e){x.each(e,function(e,t){var o,i=m.commands[this];if(!i)return!0;if(i.refresh)return i.refresh(i.widget,m.style),!0;switch(i.type){case"list":if("fontname"==i.command){for(var n=-1,r=999,a=0;a<i.value.length;a++){var t=i.value[a].label.toLowerCase(),l=m.style.fontFamily.toLowerCase().indexOf(t);0<=l&&(l<r&&(n=a),r=Math.min(r,l))}i.widget.jqxDropDownList("selectIndex",n)}else if("formatblock"==i.command){t=null;m.style.h1?t="h1":m.style.h2?t="h2":m.style.h3?t="h3":m.style.h4?t="h4":m.style.h5?t="h5":m.style.h6&&(t="h6"),i.widget.jqxDropDownList("selectItem",t)}else if("fontsize"==i.command){var d="xx-small,x-small,small,medium,large,x-large,xx-large".split(","),s=-1;try{-1==(s=p.getAttribute("size")-1)&&(s=m.editorDocument.queryCommandValue(i.command)-1)}catch(e){}d=d[s];i.widget.val(d)}break;case"colorPicker":var c="number"!=typeof(o=m.editorDocument.queryCommandValue(i.command))?o:"rgb("+(255&o)+", "+((65280&o)>>8)+", "+((16711680&o)>>16)+")";"backcolor"==i.command&&null==m.style.backColor&&(c="#FFFFFF");var u=m._rgbToHex(c);u?i.val(u):"forecolor"==i.command?i.val(m.style.color):"backcolor"==i.command&&i.val(m.style.backColor);break;case"toggleButton":if("viewsource"==i.command)return;if(!i.command)return;var g=!1,d=m.editorDocument.queryCommandState(i.command)&&m.editorDocument.queryCommandEnabled(i.command);"createlink"==i.command&&"a"==p.nodeName.toLowerCase()&&(c=!0,-1==x(p).text().indexOf(m.selection.getText())&&""!=m.selection.getText()&&(c=!1),c&&(m.linkPopup&&m.linkPopup.remove(),d=!0,m.linkPopup=x("<div class='jqx-editor-link-popup' contentEditable='false' style='overflow: hidden; white-space: nowrap; padding: 5px; height: 17px; font-size: 12px; color: #222222; background: #F5F5F5; position: absolute; z-index: 9999;'>"+m.localization["Go to link"]+": <a target='_blank' style='color:#222222;' href='"+p.href+"'>"+p.href+"</a> - <a style='color:#222222;' href='#change'>"+m.localization.Change+"</a> - <a style='color:#222222;' href='#remove'>"+m.localization.Remove+"</a></div>").appendTo(m.editor),c=(u=x(p).coord()).left,u.left+m.linkPopup.width()>m.editor.width()&&(c=m.editor.width()-m.linkPopup.width()-15),m.linkPopup.offset({top:x(p).height()+u.top+5,left:c}),m.addHandler(m.linkPopup,"mousedown",function(e){if(e.target&&e.target.href)switch(x(e.target).index()){case 1:m.editor.focus(),m.selection.selectNode(p,!0),m.commands.link.widget.trigger("click");break;case 2:try{m.editor.focus(),m.selection.selectNode(p),m.execute("unlink"),m.commands.underline.toggled=!1,m.selection.collapse(!1),m._refreshTools()}catch(e){}break;default:window.open(e.target.href,"_blank")}return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}))),"bold"==i.command?(m.style.fontWeight&&(600<=m.style.fontWeight||"bold"==m.style.fontWeight)&&(g=!0),m.selection.isCollapsed()?i.toggled=d:i.toggled=d||g,d=i.toggled):"italic"==i.command?(m.style.fontStyle&&"italic"==m.style.fontStyle&&(g=!0),h?i.toggled=d:d=i.toggled):"underline"==i.command?(m.style.u&&(g=!0),h?i.toggled=d:d=i.toggled):"justifyleft"==i.command?"left"==m.style.textAlign&&(g=!0):"justifyright"==i.command?"right"==m.style.textAlign&&(g=!0):"justifycenter"==i.command?"center"==m.style.textAlign&&(g=!0):"justifyfull"==i.command?"justify"==m.style.textAlign&&(g=!0):x.each(m.style,function(e,t){i.command==e.toLowerCase()&&(g=!0)});d=d;(g&&-1!=i.command.indexOf("justify")||d||g&&!1===m.range.collapsed||x.jqx.browser.msie&&x.jqx.browser.version<9&&g&&!m.selection.isCollapsed())&&i.widget.jqxToggleButton("check");break;case"button":default:i.refresh&&i.refresh(i.widget,m.style)}})}if(0==n.length)a(i);else for(r=0;r<n.length;r++)a(i=n[r].split(" "))}}m.readOnly=t}},_rgbToHex:function(e){if(e){if("#"===e.substr(0,1))return 4!=e.length?e:"#"+(t=e.substr(1,1))+t+(o=e.substr(2,1))+o+(i=e.substr(3,1))+i;e=/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/i.exec(e);if(!e)return null;var t=parseInt(e[2],10).toString(16),o=parseInt(e[3],10).toString(16),i=parseInt(e[4],10).toString(16);return"#"+((1==t.length?"0"+t:t)+(1==o.length?"0"+o:o)+(1==i.length?"0"+i:i))}return null},_preventDefault:function(e,t){!1!==t&&(0<x(".jqx-editor-dropdownpicker").length&&x(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),0<x(".jqx-editor-dropdownlist").length&&x(".jqx-editor-dropdownlist").jqxDropDownList("close")),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1},_addCommandHandler:function(e,t,i,o,n){var r,a=this;switch(!i&&n.init&&(i="custom"),i){case"custom":switch(n.type){case"list":r=function(e){"source"!=a._documentMode&&"none"!=e.args.type&&(n.value=x(this).val(),a.execute("custom",n),a.readOnly||a._refreshTools()),a._preventDefault(e,!1)};break;case"colorPicker":r=function(e){var o;return"source"!=a._documentMode&&(x(n.colorPicker).find("td").removeClass("jqx-editor-color-picker-selected-cell"),"div"==e.target.nodeName.toLowerCase()?(o=x(e.target).css("background-color"),x(e.target).parent().addClass("jqx-editor-color-picker-selected-cell")):(o=x(e.target).find("div").css("background-color"),x(e.target).addClass("jqx-editor-color-picker-selected-cell")),x("#bar-"+i).css("background",o),n.widget.val=function(){var e,t="number"!=typeof(e=o)?e:"rgb("+(255&e)+", "+((65280&e)>>8)+", "+((16711680&e)>>16)+")";return a._rgbToHex(t)},n.widget.jqxDropDownButton("close"),a.execute("custom",n)),a._preventDefault(e),!1};break;case"button":case"toggleButton":default:r=function(e){0<x(".jqx-editor-dropdownpicker").length&&x(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),0<x(".jqx-editor-dropdownlist").length&&x(".jqx-editor-dropdownlist").jqxDropDownList("close"),a._preventDefault(e);x(this).attr("data-command");return"source"!=a._documentMode&&(n.toggle&&n.toggle(),a.execute("custom",n),a._refreshTools()),!1}}break;case"formatblock":r=function(e){"source"!=a._documentMode&&"none"!=e.args.type&&(a.execute(x(this).attr("data-command"),"<"+x(this).val()+">",n),a.readOnly||(a.commands.bold.toggled=!1,a._refreshTools())),a._preventDefault(e,!1)};break;case"fontsize":r=function(e){var t,o,i;"source"!=a._documentMode&&"none"!=e.args.type&&(t=x(this).val(),o="xx-small,x-small,small,medium,large,x-large,xx-large".split(","),i=x(this).jqxDropDownList("getSelectedIndex")+1,i=1+o.indexOf(t),a.execute(x(this).attr("data-command"),i,n)),a._preventDefault(e,!1)};break;case"fontname":r=function(e){var t;"source"!=a._documentMode&&"none"!=e.args.type&&(t=x(this).val(),a.execute(x(this).attr("data-command"),t,n)),a._preventDefault(e,!1)};break;case"forecolor":case"backcolor":r=function(e){var t;return"source"!=a._documentMode&&(x(n.colorPicker).find("td").removeClass("jqx-editor-color-picker-selected-cell"),"div"==e.target.nodeName.toLowerCase()?(t=x(e.target).css("background-color"),x(e.target).parent().addClass("jqx-editor-color-picker-selected-cell")):(t=x(e.target).find("div").css("background-color"),x(e.target).addClass("jqx-editor-color-picker-selected-cell")),x("#bar-"+i).css("background",t),n.widget.jqxDropDownButton("close"),a.execute(i,t,n)),a._preventDefault(e),!1};break;case"viewsource":r=function(e){return a.linkPopup&&a.linkPopup.remove(),n.toggle(),a.setMode(n.toggled),0<x(".jqx-editor-dropdownpicker").length&&x(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),0<x(".jqx-editor-dropdownlist").length&&x(".jqx-editor-dropdownlist").jqxDropDownList("close"),a._preventDefault(e),!1};break;case"insertimage":r=function(e){a._insertImageAction(e,a,n)};break;case"createlink":r=function(e){a._createLinkAction(e,a,n)};break;default:r=function(e){0<x(".jqx-editor-dropdownpicker").length&&x(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),0<x(".jqx-editor-dropdownlist").length&&x(".jqx-editor-dropdownlist").jqxDropDownList("close"),a._preventDefault(e);var t=x(this).attr("data-command");if("source"!=a._documentMode){if("underline"==t&&a.getSelectedElement()){e=a.getSelectedElement();if(e&&"a"==e.nodeName.toLowerCase())return n.toggled?x(e).css("text-decoration","none"):x(e).css("text-decoration","underline"),n.toggle(),a._refreshTools(),!1}n.toggle&&n.toggle(),a.execute(t,x(this).val(),n),a._refreshTools()}return!1}}return a.addHandler(e,t,r),!1},_createLinkAction:function(e,i,n){if("source"!=(i=this)._documentMode){i.focused||i.editor.focus(),i.range=i.getRange();var t=i.getSelectedElement();if("a"==t.nodeName.toLowerCase()?i.editLink=t:i.editLink=null,0<x("#linkWindow"+this.element.id).length)return i.editLink&&i.selection.selectNode(t,!0),i._updateLinkWindow(),i._preventDefault(e),!1;var r=x("<div class='jqx-editor-window jqx-editor-link-window'><div>"+i.localization["Insert Link"]+"</div><div><table style='border-collapse: separate; border-spacing: 2px;'><tr><td align='right'>"+i.localization.URL+":</td><td><input style='width: 200px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+i.localization.Title+":</td><td><input style='width: 200px; height: 23px;' value=''/></td><tr/><tr><td align='right'></td><td><div class='jqx-editor-link-checkbox'>"+i.localization["Open in a new window/tab"]+"</div></td><tr/><tr><td align='right'></td><td align='right'><button>Ok</button><button style='margin-left: 5px;'>Remove</button><button style='margin-left: 5px;'>Cancel</button></td><tr/></table></div></div>");r[0].id="linkWindow"+this.element.id;var o=r.find("input");o.addClass(i.toThemeProperty("jqx-widget")),o.addClass(i.toThemeProperty("jqx-widget-content")),o.addClass(i.toThemeProperty("jqx-input"));var a=r.find(".jqx-editor-link-checkbox").jqxCheckBox({theme:i.theme,height:23,width:180}),l=r.find("button:first").jqxButton({theme:i.theme,disabled:!0}),t=x(r.find("button")[1]).jqxButton({theme:i.theme}),d=r.find("button:last").jqxButton({theme:i.theme});l.val(i.localization.Ok),d.val(i.localization.Cancel),t.val(i.localization.Remove),i.addHandler(d,x.jqx.mobile.isTouchDevice()?x.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){i.editor.focus(),i.selectRange(i.range),i._refreshTools(),i._preventDefault(e)}),i.editLink&&(!i.editLink||i.editLink.href)||t.hide();var s=!1;return i.addHandler(x(o[0]),"focus",function(){s=""==o[1].value||o[1].value==o[0].value}),i.addHandler(x(o[1]),"keyup",function(e){e.keyCode&&(13==e.keyCode&&l.trigger("click"),27==e.keyCode&&d.trigger("click"))}),i.addHandler(x(o[0]),"keyup change",function(e){0<o[0].value.length?l.jqxButton({disabled:!1}):l.jqxButton({disabled:!0}),s&&(o[1].value=o[0].value),e.keyCode&&(13==e.keyCode&&l.trigger("click"),27==e.keyCode&&d.trigger("click"))}),i.addHandler(t,x.jqx.mobile.isTouchDevice()?x.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){r.jqxWindow("close");try{i.editor.focus(),i.selection.selectNode(i.editLink),i.execute("unlink"),i.selection.collapse(!1),i.commands.underline.toggled=!1,i._refreshTools()}catch(e){}i._preventDefault(e)}),i.addHandler(l,x.jqx.mobile.isTouchDevice()?x.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){var t=r.find("input"),o=x("<a>"+(t[1].value||t[0].value)+"</a>");a.val()&&o.attr("target","_blank"),o[0].href=x.trim(t[0].value),-1==t[0].value.indexOf("http")&&-1==t[0].value.indexOf("mailto")&&(o[0].href="http://"+x.trim(t[0].value)),i.focused||i.editor.focus(),i.range&&i.selectRange(i.range),i.editLink&&x(i.editLink).remove(),i.execute("insertHTML",o[0].outerHTML+"<span id='INSERTION_MARKER'>&nbsp;</span>",n),i.editor.focus();o=x(i.editorDocument).find("#INSERTION_MARKER");i.selection.selectNode(o[0],!0),i.getRange().setStartAfter&&i.getRange().setStartAfter(o[0]),o.remove(),i.selection.collapse(!1),i._refreshTools(),i._preventDefault(e)}),i.updating=!0,r.appendTo(document.body),i.addHandler(r,"open",function(){i.updating=!0,setTimeout(function(){i.range=i.getRange(),x(o[0]).focus()},25)}),r.jqxWindow({resizable:!1,width:280,okButton:l,cancelButton:d,theme:i.theme,isModal:!0,position:{center:i.widget}}),i.addHandler(r,"close",function(){i.updating=!1}),i.focused||(i.editor.focus(),i.selectRange(i.range)),i.editLink?(o[0].value=i.editLink.href||"",o[1].value=x(i.editLink).text(),a.val("_blank"==x(i.editLink).attr("target"))):i.selection.isCollapsed()||((t=i.selection.getText()).match(/^(?!:\/\/)([a-zA-Z0-9]+\.)?[a-zA-Z0-9][a-zA-Z0-9-]+\.[a-zA-Z]{2,6}?$/i)?o[0].value=t:o[1].value=t),0<o[0].value.length?l.jqxButton({disabled:!1}):l.jqxButton({disabled:!0}),i._preventDefault(e),!1}i._preventDefault(e)},_insertImageAction:function(e,i,n){if("source"!=i._documentMode){if(i.focused||i.editor.focus(),i.range=i.getRange(),0<x("#imageWindow"+this.element.id).length)return i._updateImageWindow(),i._preventDefault(e),!1;var r=x("<div class='jqx-editor-window jqx-editor-image-window'><div>"+i.localization["Insert Image"]+"</div><div><table style='border-collapse: separate; border-spacing: 2px;'><tr><td align='right'>"+i.localization.URL+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+i.localization["Alt Text"]+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+i.localization.Width+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+i.localization.Height+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+i.localization.HSpace+":</td><td><input style='width: 180px; height: 23px;' class='jqx-editor-hspace'/></td><tr/><tr><td align='right'>"+i.localization.VSpace+":</td><td><input style='width: 180px; height: 23px;' class='jqx-editor-vspace'/></td><tr/><tr><td align='right'>"+i.localization.Align+":</td><td><div class='jqx-editor-align'></div></td><tr/><tr><td align='right'></td><td align='right'><button>Ok</button><button style='margin-left: 5px;'>Remove</button><button style='margin-left: 5px;'>Cancel</button></td><tr/></table></div></div>");r[0].id="imageWindow"+this.element.id;var t=r.find("input");t.addClass(i.toThemeProperty("jqx-widget")),t.addClass(i.toThemeProperty("jqx-widget-content")),t.addClass(i.toThemeProperty("jqx-input")),r.find(".jqx-editor-align").jqxDropDownList({hint:!1,autoDropDownHeight:!0,selectedIndex:0,theme:i.theme,height:23,width:180,source:[i.localization["not set"],i.localization.Left,i.localization.Right]});var o=r.find("button:first").jqxButton({theme:i.theme}),a=r.find("button:last").jqxButton({theme:i.theme}),l=x(r.find("button")[1]).jqxButton({theme:i.theme});return o.val(i.localization.Ok),a.val(i.localization.Cancel),l.val(i.localization.Remove),l.hide(),i.addHandler(l,x.jqx.mobile.isTouchDevice()?x.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){x(i.editImage).removeClass("jqx-editor-focus"),x(i.editImage).remove(),i.editImage=null,i._preventDefault(e),r.jqxWindow("close"),i._raiseEvent("change")}),i.addHandler(a,x.jqx.mobile.isTouchDevice()?x.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){x(i.editImage).removeClass("jqx-editor-focus"),i.editImage=null,i._preventDefault(e)}),i.addHandler(o,x.jqx.mobile.isTouchDevice()?x.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){x(i.editImage).removeClass("jqx-editor-focus");var t=r.find("input"),o=(i.editImage?x(i.editImage):x('<img style="border: 1px solid transparent;">')).attr("src",t[0].value).attr("unselectable","on");t[1].value&&o.attr("alt",t[1].value).attr("title",t[1].value),t[2].value&&!isNaN(parseInt(t[2].value))?o.width(t[2].value):o.css("width","auto"),t[3].value&&!isNaN(parseInt(t[3].value))?o.height(t[3].value):o.css("height","auto"),t[4].value?"auto"==t[4].value.toString()?(o.css("margin-left","auto"),o.css("margin-right","auto")):-1!=t[4].value.toString().indexOf("%")?(o.css("margin-left",parseInt(t[4].value)+"%"),o.css("margin-right",parseInt(t[4].value)+"%")):(o.css("margin-left",parseInt(t[4].value)+"px"),o.css("margin-right",parseInt(t[4].value)+"px")):(o.css("margin-left","0px"),o.css("margin-right","0px")),t[5].value?"auto"==t[5].value.toString()?(o.css("margin-top","auto"),o.css("margin-bottom","auto")):-1!=t[5].value.toString().indexOf("%")?(o.css("margin-top",parseInt(t[5].value)+"%"),o.css("margin-bottom",parseInt(t[5].value)+"%")):(o.css("margin-top",parseInt(t[5].value)+"px"),o.css("margin-bottom",parseInt(t[5].value)+"px")):(o.css("margin-top","0px"),o.css("margin-bottom","0px"));t=r.find(".jqx-editor-align").jqxDropDownList("selectedIndex");1==t?o.css("float","left"):2==t?o.css("float","right"):0==t&&o.css("float","none"),o.css("resize",!1),o[0].oncontrolselect=function(){return!1},o[0].selectstart=function(){return!1},i.editImage||(i.focused||i.editor.focus(),i.range&&i.selectRange(i.range),i.execute("insertHTML",o[0].outerHTML+"<span id='INSERTION_MARKER'>&nbsp;</span>",n),i.editor.focus(),o=x(i.editorDocument).find("#INSERTION_MARKER"),i.selection.selectNode(o[0],!0),i.getRange().setStartAfter&&i.getRange().setStartAfter(o[0]),o.remove(),i.selection.collapse(!1),i._refreshTools(),i._preventDefault(e)),i.editImage=null,i._preventDefault(e)}),r.appendTo(document.body),i.updating=!0,i.addHandler(r,"open",function(){i.updating=!0,setTimeout(function(){i.range=i.getRange(),x(t[0]).focus()},25)}),r.jqxWindow({resizable:!1,width:280,okButton:o,cancelButton:a,theme:i.theme,isModal:!0,position:{center:i.widget}}),i.addHandler(r,"close",function(){i.updating=!1}),i.focused||(i.editor.focus(),i.selectRange(i.range)),i._preventDefault(e),!1}i._preventDefault(e)},editmode:function(e){var t,o,i=this;e||i.readOnly?e&&i.readOnly&&(t=i.editor.find("#sourceText").text(),i.editor.html(t),i.buttons.hasOwnProperty("html")&&i.buttons.html.removeClass("active"),i.editor.attr("contentEditable",!0),i._addHandlers()):(i._removeHandlers(),i.editor.attr("contentEditable",!1),t=document.createTextNode(i.editor.html()),(o=x("<pre>")).html(t).attr({id:"sourceText",contentEditable:!0}).css("height","100%"),i.editor.html(o),i.buttons.hasOwnProperty("html")&&i.buttons.html.addClass("active"),o.focus()),i.readOnly=!e},setMode:function(e){var t=this;t.range||(t.editor.focus(),t.range=t.getRange());var o,i,n=t.editor[0];e?(t._documentMode="source",i=(o=new r).HTMLtoXML(n.innerHTML),i=o.FormatHTML(i),o=document.createTextNode(i),n.innerHTML="",i=document.createElement("pre"),n.contentEditable=!1,i.style.height="100%",i.style.margin="0px",i.style.outline="none",i.style.display="block",i.id="sourceText",i.contentEditable=!0,i.appendChild(o),n.appendChild(i),this.readOnly=!0):(this._documentMode="html",document.all?n.innerHTML=n.innerText:n.textContent?n.innerHTML=n.textContent:((o=document.createRange()).selectNodeContents(n.firstChild),n.innerHTML=o.toString()),n.contentEditable=!0,t.readOnly=!1,t._refreshTools(),t.editor.focus(),t.selection.selectNode(t.editor[0]),t.editor.scrollTop(0),t.selection.collapse(!0)),x.each(this.commands,function(){if(this.widget&&"viewsource"!=this.command)switch(this.type){case"list":this.widget.jqxDropDownList({disabled:e});break;case"colorPicker":this.widget.jqxDropDownButton({disabled:e});break;case"button":this.widget.jqxButton({disabled:e});break;case"toggleButton":this.widget.jqxToggleButton({toggled:!1,disabled:e})}}),t.editor.focus(),x.jqx.browser.mozilla&&(n=x("<a href='#'>anchor</a>"),t.editor.prepend(n),n.focus(),n.remove(),t.selection.collapse(!0)),t.commands.html.widget&&(t.commands.html.widget.jqxToggleButton({toggled:"source"==e||1==e}),t.commands.html.toggled="source"==e||1==e)},execute:function(t,o,e){var i=this;if(!i.readOnly){var n=i.editorDocument;if("source"!=i._documentMode){i.changeType="mouse",i.linkPopup&&i.linkPopup.remove(),i.editor.focus(),x.jqx.browser.mozilla,x.jqx.mobile.isTouchDevice()&&setTimeout(function(){},25);function r(e){try{if(e.command&&"inserthtml"==e.command.toLowerCase()){var t=i.getRange(),o=e.value;-1==o.toString().indexOf("<")&&(o="<span>"+e.value+"</span>"),i.selection.insertContent(o+"<span id='INSERTION_MARKER'>&nbsp;</span>"),i.selectRange(t),setTimeout(function(){var e=x(i.editorDocument).find("#INSERTION_MARKER");i.selection.selectNode(x(e).prev()[0],!0),e.remove(),i.selection.collapse(!1)},10)}else if(e.command){if(!n.queryCommandEnabled(e.command))return!1;n.execCommand(e.command,!1,e.value)}else{if(!n.queryCommandEnabled(e))return!1;n.execCommand(e,!1,e)}}catch(e){}}var a;if("custom"==t)(a=o.action(o.widget,i.editor))&&r(a);else try{if(e&&e.action)r(a=e.action(e.widget,i.editor));else if(n.queryCommandEnabled(t))n.execCommand(t,!1,o);else{if("insertHTML"!=t)return!1;i.selection.insertContent(o)}}catch(e){if("insertHTML"!=t)return!1;i.selection.insertContent(o)}x.jqx.mobile.isTouchDevice()&&setTimeout(function(){i.iframe&&i.iframe[0].contentWindow.focus()},500),i._raiseEvent("change",{command:t,args:o}),i.changed=!0,i.range=i.getRange()}}},destroy:function(){var i=this;i._removeHandlers();var e=i.tools.split(" "),t=i.tools.split(" | ");x.jqx.utilities.resize(this.host,null,!0);function o(e){x.each(e,function(e,t){var o=i.commands[this];if(!o)return!0;switch(o.type){case"list":o.widget.jqxDropDownList("destroy");break;case"colorPicker":o.colorPicker.remove(),o.widget.jqxDropDownButton("destroy");break;case"toggleButton":o.widget.jqxToggleButton("destroy");break;case"custom":i.destroyTool&&i.destroyTool(this);break;case"button":default:o.widget.jqxToggleButton("destroy"),"insertimage"===o.command?0<x("#imageWindow"+i.element.id).length&&(x("#imageWindow"+i.element.id).find(".jqx-editor-align").jqxDropDownList("destroy"),x("#imageWindow"+i.element.id).find("button").jqxButton("destroy")):"createlink"===o.command&&0<x("#linkWindow"+i.element.id).length&&(x("#linkWindow"+i.element.id).find(".jqx-editor-align").jqxDropDownList("destroy"),x("#linkWindow"+i.element.id).find("button").jqxButton("destroy"),x("#linkWindow"+i.element.id).find(".jqx-editor-link-checkbox").jqxCheckBox("destroy"))}})}if(0==t.length)o(e);else for(var n=0;n<t.length;n++)o(e=t[n].split(" "));var r=x("#linkWindow"+this.element.id),a=x("#imageWindow"+this.element.id);r&&0<r.length&&r.jqxWindow("destroy"),a&&0<a.length&&a.jqxWindow("destroy"),i.inline?i.toolbar.remove():(i.widget.remove(),i.host.remove()),i.iframe.remove(),i.iframe=null,i.selection=null,i.editorDocument=null,i.contentEditableElement=null},val:function(e){if(void 0===e||"source"!==e)return null!=e&&"object"!=typeof e&&this.editor.html(e),("source"===this._documentMode?this.editor.find("pre:first"):this.editor).html();var t=this.editor[0];"source"===this._documentMode&&(t=this.editor.find("pre:first")[0]);e=new r,t=e.HTMLtoXML(t.innerHTML);return t=e.FormatHTML(t)},_raiseEvent:function(e,t){if(null==t&&(t={owner:null}),"source"==this._documentMode)return!0;var o=e;t.type=this.changeType,this.changeType=null;e=t;e.owner=this;o=new x.Event(o);return o.owner=this,o.args=e,e=(this._textArea?x(this._textArea):this.host).trigger(o),t=o.args,e}});var d=function(o){var e={initialize:function(e){this.document=e},getSelection:function(){return this.document.getSelection?this.document.getSelection():this.document.selection},getRange:function(){var e=this.getSelection();if(!e)return null;try{return 0<e.rangeCount?e.getRangeAt(0):(this.document.createRange?this.document:this.document.selection).createRange()}catch(e){return this.document.body.createTextRange()}},selectRange:function(e){var t;e.select?e.select():(t=this.getSelection()).addRange&&(t.removeAllRanges(),t.addRange(e))},selectNode:function(e,t){var o=this.getRange(),i=this.getSelection();if(o.moveToElementText)o.moveToElementText(e),o.select();else if(i.addRange)try{t?o.selectNodeContents(e):o.selectNode(e),i.removeAllRanges(),i.addRange(o)}catch(e){}else i.setBaseAndExtent(e,0,e,1);return e},isCollapsed:function(){var e=this.getRange();return!e.item&&(0==e.boundingWidth||this.getSelection().isCollapsed)},collapse:function(e){var t=this.getRange(),o=this.getSelection();t.select?(t.collapse(e),t.select()):e?o.collapseToStart():o.collapseToEnd()},getContent:function(){var e=this.getRange(),t=x("<div>")[0];return this.isCollapsed()?"":(e.cloneContents?t.appendChild(e.cloneContents()):null!=e.item||null!=e.htmlText?x(t).html(e.item?e.item(0).outerHTML:e.htmlText):x(t).html(e.toString()),x(t).html())},getText:function(){var e=this.getRange(),t=this.getSelection();return this.isCollapsed()?"":e.text||(t.toString?t.toString():"")},getNode:function(){var e=this.getRange();if(!x.jqx.browser.msie||9<=x.jqx.browser.version){var t=null;if(e)for(t=e.commonAncestorContainer,e.collapsed||e.startContainer==e.endContainer&&e.startOffset-e.endOffset<2&&e.startContainer.hasChildNodes()&&(t=e.startContainer.childNodes[e.startOffset]);"element"!=typeof t;)t=t.parentNode;return o.id(t)}return o.id(e.item?e.item(0):e.parentElement())},insertContent:function(e){var t,o,i=this.getRange();i.pasteHTML?(i.pasteHTML(e),i.collapse(!1),i.select()):i.insertNode&&(i.deleteContents(),i.createContextualFragment?i.insertNode(i.createContextualFragment(e)):(t=(o=this.document).createDocumentFragment(),o=o.createElement("div"),t.appendChild(o),o.outerHTML=e,i.insertNode(t)))}};return e.initialize(o),e},r=function(){var d=/^<([-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,s=/^<\/([-A-Za-z0-9_]+)[^>]*>/,c=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,u=e("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),g=e("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),p=e("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),h=e("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),m=e("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),f=e("script,style"),t=this.HTMLParser=function(e,r){var t,o,a=[];for(a.last=function(){return this[this.length-1]};e;){var i=!0;a.last()&&f[a.last()]?(e=e.replace(new RegExp("(.*)</"+a.last()+"[^>]*>"),function(e,t){return t=t.replace(/<!--(.*?)-->/g,"$1").replace(/<!\[CDATA\[(.*?)]]>/g,"$1"),r.chars&&r.chars(t),""}),l(0,a.last())):(0==e.indexOf("\x3c!--")?0<=(t=e.indexOf("--\x3e"))&&(r.comment&&r.comment(e.substring(4,t)),e=e.substring(t+3),i=!1):0==e.indexOf("</")?(o=e.match(s))&&(e=e.substring(o[0].length),o[0].replace(s,l),i=!1):0==e.indexOf("<")&&(o=e.match(d))&&(e=e.substring(o[0].length),o[0].replace(d,n),i=!1),i&&(i=(t=e.indexOf("<"))<0?e:e.substring(0,t),e=t<0?"":e.substring(t),r.chars&&r.chars(i))),0}function n(e,t,o,i){if(t=t.toLowerCase(),g[t])for(;a.last()&&p[a.last()];)l(0,a.last());var n;h[t]&&a.last()==t&&l(0,t),(i=u[t]||!!i)||a.push(t),r.start&&(n=[],o.replace(c,function(e,t){var o=arguments[2]||arguments[3]||arguments[4]||(m[t]?t:"");n.push({name:t,value:o,escaped:o.replace(/(^|[^\\])"/g,'$1\\"')})}),r.start&&r.start(t,n,i))}function l(e,t){if(t)for(o=a.length-1;0<=o&&a[o].toLowerCase()!=t.toLowerCase();o--);else var o=0;if(0<=o){for(var i=a.length-1;o<=i;i--)r.end&&r.end(a[i]);a.length=o}}l()};function e(e){for(var t={},o=e.split(","),i=0;i<o.length;i++)t[o[i]]=!0;return t}this.HTMLtoXML=function(e){var n="";return e=(e=e.replace(/\r/gi,"")).replace(/\n/gi,""),t(e,{start:function(e,t,o){n+="<"+e;for(var i=0;i<t.length;i++)n+=" "+t[i].name+'="'+t[i].escaped+'"';n+=(o?"/":"")+">"},end:function(e){n+="</"+e+">\r\n"},chars:function(e){n+=e},comment:function(e){n+="\x3c!--"+e+"--\x3e"}}),n},this.FormatHTML=function(e,t){var o,i,n,r,d;for(i=(t=t||{}).indent_size||4,n=t.indent_char||" ",r=t.brace_style||"collapse",d=t.unformatted||["a","span","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"],(o=new function(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.Utils={whitespace:"\n\r\t ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(e,t){for(var o=0;o<t.length;o++)if(e===t[o])return!0;return!1}},this.get_content=function(){for(var e,t=[],o=!1;"<"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return t.length?t.join(""):["","TK_EOF"];if(e=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(e,this.Utils.whitespace))t.length&&(o=!0),this.line_char_count--;else{if(o){if(this.line_char_count>=this.max_char){t.push("\n");for(var i=0;i<this.indent_level;i++)t.push(this.indent_string);this.line_char_count=0}else t.push(" "),this.line_char_count++;o=!1}t.push(e)}}return t.length?t.join(""):""},this.get_contents_to=function(e){if(this.pos==this.input.length)return["","TK_EOF"];var t="",e=new RegExp("</"+e+"\\s*>","igm");e.lastIndex=this.pos;e=e.exec(this.input),e=e?e.index:this.input.length;return this.pos<e&&(t=this.input.substring(this.pos,e),this.pos=e),t},this.record_tag=function(e){this.tags[e+"count"]?this.tags[e+"count"]++:this.tags[e+"count"]=1,this.tags[e+this.tags[e+"count"]]=this.indent_level,this.tags[e+this.tags[e+"count"]+"parent"]=this.tags.parent,this.tags.parent=e+this.tags[e+"count"]},this.retrieve_tag=function(e){if(this.tags[e+"count"]){for(var t=this.tags.parent;t&&e+this.tags[e+"count"]!==t;)t=this.tags[t+"parent"];t&&(this.indent_level=this.tags[e+this.tags[e+"count"]],this.tags.parent=this.tags[t+"parent"]),delete this.tags[e+this.tags[e+"count"]+"parent"],delete this.tags[e+this.tags[e+"count"]],1==this.tags[e+"count"]?delete this.tags[e+"count"]:this.tags[e+"count"]--}},this.get_tag=function(){var e,t="",o=[],i=!1;do{if(this.pos>=this.input.length)return o.length?o.join(""):["","TK_EOF"]}while(t=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(t,this.Utils.whitespace)?(i=!0,this.line_char_count--):("'"!==t&&'"'!==t||o[1]&&"!"===o[1]||(t+=this.get_unformatted(t),i=!0),"="===t&&(i=!1),o.length&&"="!==o[o.length-1]&&">"!==t&&i&&(this.line_char_count>=this.max_char?(this.print_newline(!1,o),this.line_char_count=0):(o.push(" "),this.line_char_count++),i=!1),"<"===t&&(e=this.pos-1),o.push(t)),">"!==t);var n,r=o.join(""),a=-1!=r.indexOf(" ")?r.indexOf(" "):r.indexOf(">"),l=r.substring(1,a).toLowerCase();return"/"===r.charAt(r.length-2)||this.Utils.in_array(l,this.Utils.single_token)?this.tag_type="SINGLE":"script"===l?(this.record_tag(l),this.tag_type="SCRIPT"):"style"===l?(this.record_tag(l),this.tag_type="STYLE"):this.Utils.in_array(l,d)?(n=this.get_unformatted("</"+l+">",r),o.push(n),0<e&&this.Utils.in_array(this.input.charAt(e-1),this.Utils.whitespace)&&o.splice(0,0,this.input.charAt(e-1)),a=this.pos-1,this.Utils.in_array(this.input.charAt(1+a),this.Utils.whitespace)&&o.push(this.input.charAt(1+a)),this.tag_type="SINGLE"):"!"===l.charAt(0)?-1!=l.indexOf("[if")?(-1!=r.indexOf("!IE")&&(n=this.get_unformatted("--\x3e",r),o.push(n)),this.tag_type="START"):-1!=l.indexOf("[endif")?(this.tag_type="END",this.unindent()):(n=-1!=l.indexOf("[cdata[")?this.get_unformatted("]]>",r):this.get_unformatted("--\x3e",r),o.push(n),this.tag_type="SINGLE"):("/"===l.charAt(0)?(this.retrieve_tag(l.substring(1)),this.tag_type="END"):(this.record_tag(l),this.tag_type="START"),this.Utils.in_array(l,this.Utils.extra_liners)&&this.print_newline(!0,this.output)),o.join("")},this.get_unformatted=function(e,t){if(t&&-1!=t.indexOf(e))return"";var o,i="",n=!0;do{if(this.pos>=this.input.length)return i;if(o=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(o,this.Utils.whitespace)){if(!n){this.line_char_count--;continue}if("\n"===o||"\r"===o){i+="\n",this.line_char_count=0;continue}}i+=o,this.line_char_count++,n=!0}while(-1==i.indexOf(e));return i},this.get_token=function(){if("TK_TAG_SCRIPT"!==this.last_token&&"TK_TAG_STYLE"!==this.last_token)return"CONTENT"===this.current_mode?"string"!=typeof(e=this.get_content())?e:[e,"TK_CONTENT"]:"TAG"===this.current_mode?"string"!=typeof(e=this.get_tag())?e:[e,"TK_TAG_"+this.tag_type]:void 0;var e,t=this.last_token.substr(7);return"string"!=typeof(e=this.get_contents_to(t))?e:[e,"TK_"+t]},this.get_full_indent=function(e){return(e=this.indent_level+e||0)<1?"":Array(e+1).join(this.indent_string)},this.printer=function(e,t,o,i,n){this.input=e||"",this.output=[],this.indent_character=t,this.indent_string="",this.indent_size=o,this.brace_style=n,this.indent_level=0,this.max_char=i;for(var r=this.line_char_count=0;r<this.indent_size;r++)this.indent_string+=this.indent_character;this.print_newline=function(e,t){if(this.line_char_count=0,t&&t.length){if(!e)for(;this.Utils.in_array(t[t.length-1],this.Utils.whitespace);)t.pop();t.push("\n");for(var o=0;o<this.indent_level;o++)t.push(this.indent_string)}},this.print_token=function(e){this.output.push(e)},this.indent=function(){this.indent_level++},this.unindent=function(){0<this.indent_level&&this.indent_level--}},this}).printer(e,n,i,1/0,r);;){var a,l,s=o.get_token();if(o.token_text=s[0],o.token_type=s[1],"TK_EOF"===o.token_type)break;switch(o.token_type){case"TK_TAG_START":o.print_newline(!1,o.output),o.print_token(o.token_text),o.indent(),o.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":o.print_newline(!1,o.output),o.print_token(o.token_text),o.current_mode="CONTENT";break;case"TK_TAG_END":"TK_CONTENT"===o.last_token&&""===o.last_text&&(l=o.token_text.match(/\w+/)[0],null!==(a=o.output[o.output.length-1].match(/<\s*(\w+)/))&&a[1]===l||o.print_newline(!0,o.output)),o.print_token(o.token_text),o.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var c=o.token_text.match(/^\s*<([a-z]+)/i);c&&o.Utils.in_array(c[1],d)||o.print_newline(!1,o.output),o.print_token(o.token_text),o.current_mode="CONTENT";break;case"TK_CONTENT":""!==o.token_text&&o.print_token(o.token_text),o.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":""!==o.token_text&&(o.output.push("\n"),s=o.token_text,a="keep"==t.indent_scripts?0:"separate"==t.indent_scripts?-o.indent_level:1,l=o.get_full_indent(a),c=s.match(/^\s*/)[0].match(/[^\n\r]*$/)[0].split(o.indent_string).length-1,c=o.get_full_indent(a-c),(s=s.replace(/^\s*/,l).replace(/\r\n|\r|\n/g,"\n"+c).replace(/\s*$/,""))&&(o.print_token(s),o.print_newline(!0,o.output))),o.current_mode="TAG"}o.last_token=o.token_type,o.last_text=o.token_text}return o.output.join("")}}}(jqxBaseFramework);
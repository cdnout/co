!function(h){h.extend(h.jqx._jqxGrid.prototype,{getcolumnindex:function(e){e=this.getcolumn(e);return this.columns.records.indexOf(e)},setcolumnindex:function(e,o,r){var t,n,s,l,i,d,c,u=this.getcolumn(e);u.pinned||u.hidden||u.checkboxcolumn||u.grouped||(t=this.columns.records.indexOf(u),this.columns.records.splice(t,1),this.columns.records.splice(o,0,u),n=0,s=this.headerZIndex,this.columnsrow.children().detach(),l=this.toThemeProperty("jqx-grid-cell"),l+=" "+this.toThemeProperty("jqx-grid-cell-pinned"),this.filterrow&&(h(this.filterrow.children()[0]).children().detach(),this.filterrow[0].cells=[]),(d=null)!=(i=this).filterrow&&(d=h(i.filterrow.children()[0])),c=!(this.columnsrow[0].cells=[]),h.each(this.columns.records,function(e,o){var r=this.uielement;i.columnsrow.append(r),i.rtl?r.css("z-index",s++):r.css("z-index",s--);var t=this.width;r.css("left",n),i.columnsrow[0].cells[i.columnsrow[0].cells.length]=r[0],i.filterrow&&(r=h('<div style="overflow: hidden; position: absolute; height: 100%;" class="'+l+'"></div>'),d.append(r),r.css("left",n),r.css("z-index",s+1),r.width(this.width),r[0].left=n,r.append(this._filterwidget),i.filterrow[0].cells[i.filterrow[0].cells.length]=r[0]),this.hidden&&(c=!0),this.hidden&&this.hideable||(n+=t)}),!this.groupable||0<(e=this.groups.length)&&0<=t-e&&(t-=e,o-=e),this.rowdetails&&0<=t-1&&(t--,o--),"checkbox"==this.selectionmode&&0<=t-1&&(t--,o--),u=this._columns[t],this._columns.splice(t,1),this._columns.splice(o,0,u),this._raiseEvent(24,{columntext:u.text,datafield:u.datafield,oldindex:t,newindex:o}),0!=r&&(!c&&"checkbox"!=u.columntype||(this.prerenderrequired=!0,this.rendergridcontent(!0,!1)),this._updatecolumnwidths(),this._updatecellwidths(),this._updatefilterrowui&&this.filterable&&this.showfilterrow&&this._updatefilterrowui(),this.showeverpresentrow&&this._updateaddnewrowui(),this._rendercolumngroups(),this._renderrows(this.virtualsizeinfo)))},_pinnedColumnsLength:function(){var e=0;return h.each(this.columns.records,function(){this.pinned&&e++,this.grouped&&e++}),"checkbox"==this.selectionmode&&e++,e},_handlecolumnsreorder:function(){var e,o,r,i,d=this,c=-1,u=!1;d.columnsreorder&&(e="mousemove.reorder"+this.element.id,o="mousedown.reorder"+this.element.id,r="mouseup.reorder"+this.element.id,i=!1,this.isTouchDevice()&&!0!==this.touchmode&&(i=!0,e=h.jqx.mobile.getTouchEventName("touchmove")+".reorder"+this.element.id,o=h.jqx.mobile.getTouchEventName("touchstart")+".reorder"+this.element.id,r=h.jqx.mobile.getTouchEventName("touchend")+".reorder"+this.element.id),this.removeHandler(h(document),e),this.addHandler(h(document),e,function(e){if(d.resizing)return!0;if(null!=d.reordercolumn){var o=parseInt(e.pageX),r=parseInt(e.pageY);!i||null!=(l=d.getTouches(e)[0])&&(o=parseInt(l.pageX),r=parseInt(l.pageY));var t=d.host.coord(),n=parseInt(t.left),s=parseInt(t.top);null!=d.dragmousedownoffset&&null!=d.dragmousedownoffset||(d.dragmousedownoffset={left:0,top:0});var l=parseInt(o)-parseInt(d.dragmousedownoffset.left),t=parseInt(r)-parseInt(d.dragmousedownoffset.top);if(d.reordercolumn.css({left:l+"px",top:t+"px"}),u=!1,n<=o&&o<=n+d.host.width()&&s<=r&&r<=s+d.host.height()&&(u=!0),c=-1,u?(d.reordercolumnicon.removeClass(d.toThemeProperty("jqx-grid-dragcancel-icon")),d.reordercolumnicon.addClass(d.toThemeProperty("jqx-grid-drag-icon")),s=(n=d.columnsheader.coord()).top+d.columnsheader.height(),null!=d.columnsdropline&&(r>=n.top&&r<=s?c=d._handlereordercolumnsdroplines(o):d.columnsdropline.fadeOut("slow"))):(null!=d.columnsdropline&&d.columnsdropline.fadeOut("slow"),d.reordercolumnicon.removeClass(d.toThemeProperty("jqx-grid-drag-icon")),d.reordercolumnicon.addClass(d.toThemeProperty("jqx-grid-dragcancel-icon"))),i)return e.preventDefault(),e.stopPropagation(),!1}}),this.columnsbounds=new Array,this.removeHandler(h(document),o),this.addHandler(h(document),o,function(e){if(d.resizing)return!0;d.columnsbounds=new Array;var t=d.host.coord().left,n=d.host.coord().top;d.showtoolbar&&(n+=d.toolbarheight),d.groupable&&d.showgroupsheader&&(n+=d.groupsheaderheight);var s=0;h.each(d.columns.records,function(e){var o=this;if(o.hidden)return d.columnsbounds[d.columnsbounds.length]={top:n,column:o,left:t,width:0,height:2+d.rowsheight},!0;0==s&&(t=d.rtl?"hidden"!=d.hScrollBar.css("visibility")?parseInt(d.host.coord().left)-d.hScrollInstance.max+d.hScrollInstance.value:"hidden"==d.vScrollBar.css("visibility")?h(o.element).coord().left:h(o.element).coord().left-d.vScrollBar.width()-d.host.offset().left:parseInt(d.host.coord().left)-d.hScrollInstance.value),s++;var r=2+d.columnsheight;d.columnshierarchy&&(n=h(o.uielement).coord().top,r=h(o.uielement).height()),d.columnsbounds[d.columnsbounds.length]={top:n,column:o,left:t,width:o.width,height:r},t+=o.width})}),this.removeHandler(h(document),r),this.addHandler(h(document),r,function(e){if(d.resizing)return!0;d.__drag=!1,h(document.body).removeClass("jqx-disableselect");parseInt(e.pageX),parseInt(e.pageY);i&&(t=d.getTouches(e)[0],parseInt(t.pageX),parseInt(t.pageY));var o=d.host.coord(),r=(parseInt(o.left),parseInt(o.top));d.groupsheader.height();if(d.showtoolbar&&(r+=d.toolbarheight),d.columndragstarted=!1,(d.dragmousedown=null)!=d.reordercolumn){var e=h.data(d.reordercolumn[0],"reorderrecord"),t=d.columns.records.indexOf(d.getcolumn(e));d.reordercolumn.remove(),d.reordercolumn=null;o=0;if(o+=d._pinnedColumnsLength(),null!=e){if(u&&-1!=c){r=c.index;if(o<=r){o=d.columns.records[r];if(null!=o){r=d.columns.records.indexOf(d.getcolumn(o.datafield));if(null==o.datafield&&(r=d.columns.records.indexOf(d.getcolumnbytext(o.text))),d.columngroups){o=o;if(t<r&&"before"==c.position&&(o=d.columns.records[r-1]),o.columngroup!=d.getcolumn(e).columngroup)return void(null!=d.columnsdropline&&(d.columnsdropline.remove(),d.columnsdropline=null))}t<r?"before"==c.position?d.setcolumnindex(e,r-1):d.setcolumnindex(e,r):r<t&&d.setcolumnindex(e,r),d.autosavestate&&d.savestate&&d.savestate()}}}null!=d.columnsdropline&&(d.columnsdropline.remove(),d.columnsdropline=null)}}}))},getcolumnbytext:function(e){var o=null;return this.columns.records&&h.each(this.columns.records,function(){if(this.text==e)return o=this,!1}),o},_handlereordercolumnsdroplines:function(o){var r=this,t=-1,n=r._pinnedColumnsLength(),s=parseInt(r.host.coord().left)+r.host.width(),l="hidden"!=r.vScrollBar.css("visibility")?19:0;return r.rtl||(l=0),h.each(r.columnsbounds,function(e){if(n<=e){if(0==this.width)return!0;if(o<=this.left+this.width/2)return s<o?(r.columnsdropline.fadeOut(),!1):(r.columnsdropline.css("left",l+parseInt(this.left)+"px"),r.columnsdropline.css("top",parseInt(this.top)+"px"),r.columnsdropline.height(this.height),r.columnsdropline.fadeIn("slow"),!(t={index:e,position:"before"}));if(o>=this.left+this.width/2){if(this.left+this.width>s)return r.columnsdropline.fadeOut(),!1;r.columnsdropline.css("left",l+1+this.left+this.width),r.columnsdropline.css("top",this.top),r.columnsdropline.height(this.height),r.columnsdropline.fadeIn("slow"),t={index:e,position:"after"}}}}),t},_createreordercolumn:function(e,o,r){var t=this,n=o;t.reordercolumn&&t.reordercolumn.remove(),t.columnsdropline&&t.columnsdropline.remove(),t.reordercolumn=h("<div></div>");var s=e.clone();t.reordercolumn.css("z-index",999999),s.css("border-width","1px"),s.css("opacity","0.4");o=h(s.find("."+t.toThemeProperty("jqx-grid-column-menubutton")));0<o.length&&o.css("display","none");o=h(s.find(".jqx-icon-close"));0<o.length&&o.css("display","none"),t.reordercolumnicon=h('<div style="z-index: 9999; position: absolute; left: 100%; top: 50%; margin-left: -18px; margin-top: -7px;"></div>'),t.reordercolumnicon.addClass(t.toThemeProperty("jqx-grid-drag-icon")),t.reordercolumn.css("float","left"),t.reordercolumn.css("position","absolute");t.host.coord();s.width(e.width()+16),t.reordercolumn.append(s),t.reordercolumn.height(e.height()),t.reordercolumn.width(s.width()),t.reordercolumn.append(t.reordercolumnicon),h(document.body).append(t.reordercolumn),s.css("margin-left",0),s.css("left",0),s.css("top",0),t.reordercolumn.css("left",n.left+t.dragmousedown.left),t.reordercolumn.css("top",n.top+t.dragmousedown.top),null!=r&&r&&(t.columnsdropline=h('<div style="z-index: 9999; display: none; position: absolute;"></div>'),t.columnsdropline.width(2),t.columnsdropline.addClass(t.toThemeProperty("jqx-grid-group-drag-line")),h(document.body).append(t.columnsdropline))},_handlecolumnsdragreorder:function(n,t){this.reordercolumn&&this.reordercolumn.remove(),this.columnsdropline&&this.columnsdropline.remove(),this.dragmousedown=null,this.dragmousedownoffset=null,this.columndragstarted=!1,this.reordercolumn=null;var s=this,l=!1;this.isTouchDevice()&&!0!==this.touchmode&&(l=!0);var e="mousedown.drag",i="mousemove.drag";l?(e=h.jqx.mobile.getTouchEventName("touchstart")+".drag",i=h.jqx.mobile.getTouchEventName("touchmove")+".drag"):this.addHandler(t,"dragstart",function(e){return!1}),this.addHandler(t,e,function(e){if(0==n.draggable)return!0;if(s.resizing)return!0;s.__drag=!0;var o,r=e.pageX,t=e.pageY;l&&(r=(o=s.getTouches(e)[0]).pageX,t=o.pageY),s.dragmousedown={left:r,top:t};e=h(e.target).coord();return s.dragmousedownoffset={left:parseInt(r)-parseInt(e.left),top:parseInt(t-e.top)},!0}),this.addHandler(t,i,function(e){return!n.draggable||(null==n.datafield||(!!n.pinned||(!!s.resizing||void(s.dragmousedown&&(o=e.pageX,r=e.pageY,!l||null!=(e=s.getTouches(e)[0])&&(o=e.pageX,r=e.pageY),i={left:o,top:r},s.columndragstarted||null!=s.reordercolumn||(o=Math.abs(i.left-s.dragmousedown.left),r=Math.abs(i.top-s.dragmousedown.top),(3<o||3<r)&&(s._createreordercolumn(t,i,!0),h(document.body).addClass("jqx-disableselect"),h.data(s.reordercolumn[0],"reorderrecord",n.datafield))))))));var o,r})}})}(jqxBaseFramework);
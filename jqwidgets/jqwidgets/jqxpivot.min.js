!function(u){u.jqx.pivot=function(t,e){var s=this;s.dataAdapter=t,s.rows=[],s.columns=[],s.values=[],s.filters=[],s.pivotValuesOnRows=!1,s.totals={rows:{subtotals:!1,grandtotals:!1},columns:{subtotals:!1,grandtotals:!1}},s.localization=null,s.aggregationFunctions={},s._initSettings={},u.extend(s.aggregationFunctions,s._defaultFunctions),e&&(s._initSettings=e,s.columns=e.columns||[],s.rows=e.rows||[],s.values=e.values||[],s.filters=e.filters||[],s.pivotValuesOnRows=e.pivotValuesOnRows||!1,s.totals=e.totals,s.localization=e.localization,u.extend(s.aggregationFunctions,e.customAggregationFunctions||{})),0===s.rows.length&&0<s.columns.length&&!1===s.pivotValuesOnRows&&(s.pivotValuesOnRows=!0),0===s.columns.length&&0<s.rows.length&&!1!==s.pivotValuesOnRows&&(s.pivotValuesOnRows=!1)},u.jqx.pivot.prototype={_clear:function(){this._pivot={rows:[],columns:[],values:[],groups:[],filters:[]},this._rowsHierarchy={items:{},valueItems:{}},this._columnsHierarchy={items:{},valueItems:{}},this._hashPivotItemsToTableRows={},this._hashRefItems={},this._hierarchyItemKeyIndex=0},_contains:function(t,e,s){if(!t)return!1;for(var a=0;a<t.length;a++)if(s?t[a]===e:t[a].dataField===e)return!0;return!1},_getFieldIndex:function(t,e){if(!t)return-1;for(var s=0;s<t.length&&t[s].name!==e;s++);return s===t.length?-1:s},dataBind:function(){if(this._clear(),this.dataAdapter){this.dataAdapter.dataBind();var t,e=["columns","rows","values","filters"];for(t in e)for(var s=e[t],a=0;a<this[s].length;a++){var i=this[s][a];if(i){var r=!1;if("values"!==s&&"filters"!==s){for(var o in e){var n=e[o];if(s===n&&(r=this._contains(this._pivot[n],i.dataField)))break}if(r)continue}this._pivot[s].push(i)}}this._createPivot()}},_isRowSkipped:function(t){for(var e in this.filters){var s=this.filters[e];if(u.isFunction(s.filterFunction)&&(s.dataField&&void 0!==t[s.dataField]&&s.filterFunction(t[s.dataField])))return!0}return!1},getItemsFilterStatus:function(t){for(var e={},s=this.dataAdapter.records,a=0;a<s.length;a++){var i=s[a][t];if(!e[i])for(var r in this.filters){var o=this.filters[r];o.dataField===t&&(o=u.isFunction(o.filterFunction)&&o.filterFunction(i),e[i]=o)}}return e},_createPivot:function(){if(0<this._pivot.values.length&&(0<this._pivot.rows.length||0<this._pivot.columns.length)){var t={},e={};this.hashSummaryPrefixes={};for(var s=this.dataAdapter.records,a=0;a<s.length;a++){var i=s[a];this._isRowSkipped(i)||(i=this.dataAdapter._source.datafields,this._appendPivotHierarchy(a,t,this._rowsHierarchy,i,this._pivot.rows,this.pivotValuesOnRows?this._pivot.values:null),this._appendPivotHierarchy(a,e,this._columnsHierarchy,i,this._pivot.columns,this.pivotValuesOnRows?null:this._pivot.values))}this._setupTotals(this._columnsHierarchy),this._setupTotals(this._rowsHierarchy)}},_setupTotals:function(t){var e;this.totals&&(!(e=t===this._columnsHierarchy?this.totals.columns:this.totals.rows)||!0!==e.subtotals&&!0!==e.grandtotals||(this._addTotals(t.items,!1,e),t===this._columnsHierarchy==!this.pivotValuesOnRows&&this._addvalueItemsToTotals(t.items)))},_addvalueItemsToTotals:function(t){for(var e in t){var s=t[e];if(s.isTotal){if(this._hashRefItems[s.key]){for(var a=this._hashRefItems[s.key].refItems,i=[],e=0;e<a.length;e++){for(var r=this._hashPivotItemsToTableRows[a[e].key],o=0;o<r.length;o++)i.push(r[o]);if(0===e)for(var n in s.valueItems={},a[e].valueItems){var d=a[e].valueItems[n],d={text:d.text,boundField:d.boundField,isTotal:!0,key:this._hierarchyItemKeyIndex++};s.valueItems[n]=d}}for(n in i.sort(function(t,e){return t-e}),s.valueItems)this._hashPivotItemsToTableRows[s.valueItems[n].key]=i;delete this._hashRefItems[s.key]}}else this._addvalueItemsToTotals(s.items)}},_clearTotals:function(t){for(var e in t){var s=t[e];s.isTotal?delete t[s]:this._clearTotals(t[e].items)}},_addTotals:function(t,e,s){if(void 0!==t){this._clearTotals(t);var a=[],i=0;for(l in t){var r=t[l];!0===s.subtotals&&this._addTotals(r.items,!0,s),a.push(r),i++}if(0!==i&&(e||1==s.grandtotals)){var o="_"+(e?"SubTotal":"Total")+"_",n=e?"SubTotal":"Total",d=this.localization;d&&(n=e?u.jqx.getByPriority([d.subtotalstring,d.SubTotalString,n]):u.jqx.getByPriority([d.grandtotalstring,d.GrandTotalString,n]));for(var d=this._hierarchyItemKeyIndex++,n=t[o]={text:n,key:d},y=[],l=0;l<a.length;l++)for(var _=0;_<this._hashPivotItemsToTableRows[a[l].key].length;_++)y.push(this._hashPivotItemsToTableRows[a[l].key][_]);this._hashRefItems[d]={item:n,refItems:a},this._hashPivotItemsToTableRows[d]=y.sort(function(t,e){return t-e}),n.isTotal=!0}}},_appendPivotHierarchy:function(t,e,s,a,i,r){var o=[],n="",d=this.dataAdapter.records[t];if(!this._getBoundFieldsValues(d,i,o))return!1;n.substring(0,n.length);var y=null;if(0==o.length&&null!=r)return this._attachValueFieldAsSummaryItem(t,e,y,n,r),!0;for(var l=0;l<o.length;l++){n+="!_$%^&_";var _=o[l];e[n+=_]?y=e[n]:(y=null==y?s.items[_]={text:_}:(this._addSourceRecordToPivotItem(y.key,t),y.items||(y.items={}),y.items[_]={text:_}),this._applyBoundFieldProperties(i[l],y),(e[n]=y).key=this._hierarchyItemKeyIndex++),null==r||0==r.length?this._addSourceRecordToPivotItem(y.key,t):(this._addSourceRecordToPivotItem(y.key,t),null!=r&&this._attachValueFieldAsSummaryItem(t,e,y,n,r))}return!0},_attachValueFieldAsSummaryItem:function(t,e,s,a,i){for(var r=0;r<i.length;r++){var o=i[r],n=null,d=a+o.dataField+r;e[d]?n=e[d]:(n=null!=s?(s.valueItems||(s.valueItems={}),s.valueItems[o.dataField+r]={text:o.text||o.dataField}):(this.pivotValuesOnRows?this._rowsHierarchy:this._columnsHierarchy).valueItems[o.dataField+r]={text:o.text||o.dataField},(e[d]=n).key=this._hierarchyItemKeyIndex++),this._applyBoundFieldProperties(o,n),this._addSourceRecordToPivotItem(n.key,t)}},_applyBoundFieldProperties:function(t,e){(e.boundField=t).text&&(e.boundFieldText=t.text)},_addSourceRecordToPivotItem:function(t,e){var s=null;0<(s=this._hashPivotItemsToTableRows[t]||(this._hashPivotItemsToTableRows[t]=[])).length&&s[s.length-1]==e||s.push(e)},_sortedArrayIntersectAndDedup:function(t,e){for(var s=[],a=0,i=0;a<t.length&&i<e.length;)t[a]<e[i]?a++:(t[a]>e[i]||(0!=s.length&&s[s.length-1]==t[a]||s.push(t[a]),a++),i++);return s},_getBoundFieldValue:function(t,e){return null==e?null:t[e]},_getBoundFieldsValues:function(t,e,s){for(var a=0;a<e.length;a++){var i=t[e[a].dataField];void 0!==i&&s.push(i)}return!0},_internalDrillThroughPivotCell:function(t,e,s){t=this._hashPivotItemsToTableRows[t]||[],e=this._hashPivotItemsToTableRows[e]||[];return 0==t.length||0==e.length?[]:this._sortedArrayIntersectAndDedup(t,e)},drillThroughPivotCell:function(t,e){if(!t||void 0===t.key||!e||void 0===e.key)return[];var s=t.isTotal||e.isTotal;return this._internalDrillThroughPivotCell(t.key,e.key,s)},getFunctions:function(){return this.aggregationFunctions},_defaultFunctions:{count:function(t){return t.length},sum:function(t){for(var e=0,s=0;s<t.length;s++)e+=t[s];return e},min:function(t){for(var e=1/0,s=0;s<t.length;s++)t[s]<e&&(e=t[s]);return e},max:function(t){for(var e=-1/0,s=0;s<t.length;s++)t[s]>e&&(e=t[s]);return e},average:function(t){var e=u.jqx.pivot.prototype._defaultFunctions.count(t);return 0==e?0:u.jqx.pivot.prototype._defaultFunctions.sum(t)/e},product:function(t){for(var e=0,s=0;s<t.length;s++)0==s?e=t[s]:e*=t[s];return e}},getCellValue:function(t,e){var s=this._getCellValueFromDataSource(t,e);if(isNaN(s))return"";e=(this.pivotValuesOnRows?t:e).boundField;return{value:s,formattedValue:this._formatValue(s,e.formatSettings,e.formatFunction)}},getCellFormatSettings:function(t,e){e=(this.pivotValuesOnRows?t:e).boundField;if(e)return e.formatSettings},_getCellValueFromDataSource:function(t,e){if(null==t)throw"Invalid rowItem";if(null==e)throw"Invalid columnItem";var s=t.isTotal||e.isTotal,a=this._internalDrillThroughPivotCell(t.key,e.key,s);if(0==a.length)return"";var i=(this.pivotValuesOnRows?t:e).boundField;if(null!=i){var r=i.function||"count";"String"==typeof r&&(r=r.toLowerCase());try{for(var o=[],n=0;n<a.length;n++){var d=a[n],d=this.dataAdapter.records[d],d=this._getBoundFieldValue(d,i.dataField);o.push(parseFloat(d))}if("string"==typeof r&&(r=this.aggregationFunctions[r]),"function"==typeof r)return r(o)}catch(t){return NaN}return NaN}},_formatValue:function(t,e,s){if(null==t)return"";if(this._isObject(t)&&!this._isDate(t)&&!s)return"";if(s){if(!u.isFunction(s))return t.toString();try{return s(t)}catch(t){return t.message}}return this._isNumber(t)?this._formatNumber(t,e):this._isDate(t)?this._formatDate(t,e):e?(e.prefix||"")+t.toString()+(e.sufix||""):t.toString()},_isNumberAsString:function(t){if("string"!=typeof t)return!1;t=u.trim(t);for(var e=0;e<t.length;e++){var s=t.charAt(e);if(!("0"<=s&&s<="9"||","==s||"."==s)&&(("-"!=s||0!=e)&&!("("==s&&0==e||")"==s&&e==t.length-1)))return!1}return!0},_castAsDate:function(t,e){if(t instanceof Date&&!isNaN(t))return t;if("string"==typeof t){var s;if(e&&(s=u.jqx.dataFormat.parsedate(t,e),this._isDate(s)))return s;if(this._autoDateFormats){for(var a=0;a<this._autoDateFormats.length;a++)if(s=u.jqx.dataFormat.parsedate(t,this._autoDateFormats[a]),this._isDate(s))return s}else this._autoDateFormats=[];e=this._detectDateFormat(t);return e&&(s=u.jqx.dataFormat.parsedate(t,e),this._isDate(s))?(this._autoDateFormats.push(e),s):(s=new Date(t),this._isDate(s)&&-1==t.indexOf(":")&&s.setHours(0,0,0,0),s)}},_castAsNumber:function(t){return t instanceof Date&&!isNaN(t)?t.valueOf():("string"==typeof t&&(this._isNumber(t)?t=parseFloat(t):/[a-zA-Z]/.test(t)||null!=(e=new Date(t))&&(t=e.valueOf())),t);var e},_isNumber:function(t){return"string"==typeof t&&this._isNumberAsString(t)&&(t=parseFloat(t)),"number"==typeof t&&isFinite(t)},_isDate:function(t){return t instanceof Date&&!isNaN(t.getDate())},_isBoolean:function(t){return"boolean"==typeof t},_isObject:function(t){return t&&("object"==typeof t||u.isFunction(t))||!1},_formatDate:function(t,e){var s=t.toString();return e&&(e.dateFormat&&(s=u.jqx.dataFormat.formatDate(t,e.dateFormat)),s=(e.prefix||"")+s+(e.sufix||"")),s},_formatNumber:function(t,e){if(!this._isNumber(t))return t;e=e||{};var s=".",a="",i=this;i.localization&&(s=i.localization.decimalSeparator||i.localization.decimalseparator||s,a=i.localization.thousandsSeparator||i.localization.thousandsseparator||a),e.decimalSeparator&&(s=e.decimalSeparator),e.thousandsSeparator&&(a=e.thousandsSeparator);var r=e.prefix||"",i=e.sufix||"",o=e.decimalPlaces;isNaN(o)&&(o=this._getDecimalPlaces([t],void 0,3));var n=e.negativeWithBrackets||!1,d=t<0;d&&n&&(t*=-1);var y,l=t.toString(),e=Math.pow(10,o),l=(Math.round(t*e)/e).toString();if(isNaN(l)&&(l=""),y=l.lastIndexOf("."),0<o)for(y<0?y=(l+=s).length-1:"."!==s&&(l=l.replace(".",s));l.length-1-y<o;)l+="0";y=-1<(y=l.lastIndexOf(s))?y:l.length;for(var _=l.substring(y),u=0,h=y;0<h;h--,u++)u%3==0&&h!==y&&(!d||1<h||d&&n)&&(_=a+_),_=l.charAt(h-1)+_;return l=_,d&&n&&(l="("+l+")"),r+l+i},_getDecimalPlaces:function(t,e,s){var a=0;isNaN(s)&&(s=10);for(var i=0;i<t.length;i++){var r=void 0===e?t[i]:t[i][e];if(!isNaN(r)){for(var o=r.toString(),n=0;n<o.length;n++)if((o[n]<"0"||"9"<o[n])&&0<=(a=o.length-(n+1)))return Math.min(a,s);for(0<a&&(r*=Math.pow(10,a));Math.round(r)!=r&&a<s;)a++,r*=10}}return a},_defaultNumberFormat:{prefix:"",sufix:"",decimalSeparator:".",thousandsSeparator:",",decimalPlaces:2,negativeWithBrackets:!1},_detectDateFormat:function(t,e){var s={en_US_d:"M/d/yyyy",en_US_D:"dddd, MMMM dd, yyyy",en_US_t:"h:mm tt",en_US_T:"h:mm:ss tt",en_US_f:"dddd, MMMM dd, yyyy h:mm tt",en_US_F:"dddd, MMMM dd, yyyy h:mm:ss tt",en_US_M:"MMMM dd",en_US_Y:"yyyy MMMM",en_US_S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",en_CA_d:"dd/MM/yyyy",en_CA_D:"MMMM-dd-yy",en_CA_f:"MMMM-dd-yy h:mm tt",en_CA_F:"MMMM-dd-yy h:mm:ss tt",ISO:"yyyy-MM-dd hh:mm:ss",ISO2:"yyyy-MM-dd HH:mm:ss",d1:"dd.MM.yyyy",d2:"dd-MM-yyyy",zone1:"yyyy-MM-ddTHH:mm:ss-HH:mm",zone2:"yyyy-MM-ddTHH:mm:ss+HH:mm",custom:"yyyy-MM-ddTHH:mm:ss.fff",custom2:"yyyy-MM-dd HH:mm:ss.fff",de_DE_d:"dd.MM.yyyy",de_DE_D:"dddd, d. MMMM yyyy",de_DE_t:"HH:mm",de_DE_T:"HH:mm:ss",de_DE_f:"dddd, d. MMMM yyyy HH:mm",de_DE_F:"dddd, d. MMMM yyyy HH:mm:ss",de_DE_M:"dd MMMM",de_DE_Y:"MMMM yyyy",fr_FR_d:"dd/MM/yyyy",fr_FR_D:"dddd d MMMM yyyy",fr_FR_t:"HH:mm",fr_FR_T:"HH:mm:ss",fr_FR_f:"dddd d MMMM yyyy HH:mm",fr_FR_F:"dddd d MMMM yyyy HH:mm:ss",fr_FR_M:"d MMMM",fr_FR_Y:"MMMM yyyy",it_IT_d:"dd/MM/yyyy",it_IT_D:"dddd d MMMM yyyy",it_IT_t:"HH:mm",it_IT_T:"HH:mm:ss",it_IT_f:"dddd d MMMM yyyy HH:mm",it_IT_F:"dddd d MMMM yyyy HH:mm:ss",it_IT_M:"dd MMMM",it_IT_Y:"MMMM yyyy",ru_RU_d:"dd.MM.yyyy",ru_RU_D:"d MMMM yyyy '?.'",ru_RU_t:"H:mm",ru_RU_T:"H:mm:ss",ru_RU_f:"d MMMM yyyy '?.' H:mm",ru_RU_F:"d MMMM yyyy '?.' H:mm:ss",ru_RU_Y:"MMMM yyyy",cs_CZ_d:"d.M.yyyy",cs_CZ_D:"d. MMMM yyyy",cs_CZ_t:"H:mm",cs_CZ_T:"H:mm:ss",cs_CZ_f:"d. MMMM yyyy H:mm",cs_CZ_F:"d. MMMM yyyy H:mm:ss",cs_CZ_M:"dd MMMM",cs_CZ_Y:"MMMM yyyy",he_IL_d:"dd MMMM yyyy",he_IL_D:"dddd dd MMMM yyyy",he_IL_t:"HH:mm",he_IL_T:"HH:mm:ss",he_IL_f:"dddd dd MMMM yyyy HH:mm",he_IL_F:"dddd dd MMMM yyyy HH:mm:ss",he_IL_M:"dd MMMM",he_IL_Y:"MMMM yyyy",hr_HR_d:"d.M.yyyy.",hr_HR_D:"d. MMMM yyyy.",hr_HR_t:"H:mm",hr_HR_T:"H:mm:ss",hr_HR_f:"d. MMMM yyyy. H:mm",hr_HR_F:"d. MMMM yyyy. H:mm:ss",hr_HR_M:"d. MMMM",hu_HU_d:"yyyy.MM.dd.",hu_HU_D:"yyyy. MMMM d.",hu_HU_t:"H:mm",hu_HU_T:"H:mm:ss",hu_HU_f:"yyyy. MMMM d. H:mm",hu_HU_F:"yyyy. MMMM d. H:mm:ss",hu_HU_M:"MMMM d.",hu_HU_Y:"yyyy. MMMM",jp_JP_d:"gg y/M/d",jp_JP_D:"gg y'?'M'?'d'?'",jp_JP_t:"H:mm",jp_JP_T:"H:mm:ss",jp_JP_f:"gg y'?'M'?'d'?' H:mm",jp_JP_F:"gg y'?'M'?'d'?' H:mm:ss",jp_JP_M:"M'?'d'?'",jp_JP_Y:"gg y'?'M'?'",lt_LT_d:"yyyy.MM.dd",lt_LT_D:"yyyy 'm.' MMMM d 'd.'",lt_LT_t:"HH:mm",lt_LT_T:"HH:mm:ss",lt_LT_f:"yyyy 'm.' MMMM d 'd.' HH:mm",lt_LT_F:"yyyy 'm.' MMMM d 'd.' HH:mm:ss",lt_LT_M:"MMMM d 'd.'",lt_LT_Y:"yyyy 'm.' MMMM",sa_IN_d:"dd-MM-yyyy",sa_IN_D:"dd MMMM yyyy dddd",sa_IN_t:"HH:mm",sa_IN_T:"HH:mm:ss",sa_IN_f:"dd MMMM yyyy dddd HH:mm",sa_IN_F:"dd MMMM yyyy dddd HH:mm:ss",sa_IN_M:"dd MMMM",basic_y:"yyyy",basic_ym:"yyyy-MM",basic_d:"yyyy-MM-dd",basic_dhm:"yyyy-MM-dd hh:mm",basic_bhms:"yyyy-MM-dd hh:mm:ss",basic2_ym:"MM-yyyy",basic2_d:"MM-dd-yyyy",basic2_dhm:"MM-dd-yyyy hh:mm",basic2_dhms:"MM-dd-yyyy hh:mm:ss",basic3_ym:"yyyy/MM",basic3_d:"yyyy/MM/dd",basic3_dhm:"yyyy/MM/dd hh:mm",basic3_bhms:"yyyy/MM/dd hh:mm:ss",basic4_ym:"MM/yyyy",basic4_d:"MM/dd/yyyy",basic4_dhm:"MM/dd/yyyy hh:mm",basic4_dhms:"MM/dd/yyyy hh:mm:ss"};e&&(s=u.extend({},s,e));var a=[];for(o in u.isArray(t)?a=t:a.push(t),s)s[o]={format:s[o],count:0};for(var i=0;i<a.length;i++){var r=a[i];if(null!=r&&null!=r)for(var o in s)null!=u.jqx.dataFormat.parsedate(r,s[o].format)&&s[o].count++}var n={key:void 0,count:0};for(o in s)s[o].count>n.count&&(n.key=o,n.count=s[o].count);return n.key?s[n.key].format:""}}}(jqxBaseFramework);
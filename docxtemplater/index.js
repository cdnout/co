window.docxtemplater=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)}([function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var a=r(9),i=a.DOMParser,s=a.XMLSerializer,u=r(1).throwXmlTagNotFound,l=r(3),c=l.last,p=l.first;function f(e,t,r){for(var n=r;n>=0;n--)for(var o=e[n],a=0,i=t.length;a<i;a++){var s=t[a];if(T(o.value,s))return a}return null}function h(e,t,r){for(var n=r,o=e.length;n<o;n++)for(var a=e[n],i=0,s=t.length;i<s;i++){var u=t[i];if(w(a.value,u))return i}return-1}function d(e,t){if(0===t.length)return-1;for(var r=0,n=t.length;r<n;r++){var o=t[r],a=t[r+1];if(o.i<e&&(!a||e<a.i)&&"start"===o.part.position)return r}return-1}function g(e,t){if(0===t.length)return-1;for(var r=0,n=t.length;r<n;r++){var o=t[r],a=t[r-1];if(e<o.i&&(!a||a.i<e)&&"end"===o.part.position)return r}return-1}var v={paragraphLoop:!1,nullGetter:function(e){return e.module?(e.module,""):"undefined"},xmlFileNames:[],parser:function(e){return{get:function(t){return"."===e?t:t[e]}}},linebreaks:!1,fileTypeConfig:null,delimiters:{start:"{",end:"}"}};var y=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"]];function m(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var x=y.map((function(e){var t=n(e,2),r=t[0],o=t[1];return{rstart:new RegExp(m(o),"g"),rend:new RegExp(m(r),"g"),start:o,end:r}}));var b=new RegExp(String.fromCharCode(160),"g");function w(e,t){return e==="</"+t+">"}function T(e,t){return 0===e.indexOf("<"+t)&&-1!==[">"," "].indexOf(e[t.length+1])}function P(e,t,r){"string"==typeof t&&(t=[t]);for(var n=1,o=r,a=e.length;o<a;o++)for(var i=e[o],s=0,u=t.length;s<u;s++){var l=t[s];if(w(i.value,l)&&n--,T(i.value,l)&&n++,0===n)return o}return null}function O(e,t,r){"string"==typeof t&&(t=[t]);for(var n=1,o=r;o>=0;o--)for(var a=e[o],i=0,s=t.length;i<s;i++){var u=t[i];if(T(a.value,u)&&n--,w(a.value,u)&&n++,0===n)return o}return null}function E(e,t){var r=t.type,n=t.tag,o=t.position;return"tag"===r&&n===e&&"start"===o}function j(e,t){var r=t.type,n=t.tag,o=t.position;return"tag"===r&&n===e&&"end"===o}var C=/[\x00-\x08\x0B\x0C\x0E-\x1F]/;e.exports={endsWith:function(e,t){return-1!==e.indexOf(t,e.length-t.length)},startsWith:function(e,t){return e.substring(0,t.length)===t},getNearestLeft:function(e,t,r){var n=f(e,t,r);return-1!==n?t[n]:null},getNearestRight:function(e,t,r){var n=h(e,t,r);return-1!==n?t[n]:null},getNearestLeftWithCache:function(e,t){var r=d(e,t);return-1!==r?t[r].part.tag:null},getNearestRightWithCache:function(e,t){var r=g(e,t);return-1!==r?t[r].part.tag:null},getNearestLeftIndex:f,getNearestRightIndex:h,getNearestLeftIndexWithCache:d,getNearestRightIndexWithCache:g,buildNearestCache:function(e,t){return e.reduce((function(e,r,n){return"tag"===r.type&&-1!==t.indexOf(r.tag)&&e.push({i:n,part:r}),e}),[])},isContent:function(e){return"placeholder"===e.type||"content"===e.type&&"insidetag"===e.position},isParagraphStart:function(e){return E("w:p",e)||E("a:p",e)},isParagraphEnd:function(e){return j("w:p",e)||j("a:p",e)},isTagStart:E,isTagEnd:j,isTextStart:function(e){return"tag"===e.type&&"start"===e.position&&e.text},isTextEnd:function(e){return"tag"===e.type&&"end"===e.position&&e.text},unique:function(e){for(var t={},r=[],n=0,o=e.length;n<o;++n)t.hasOwnProperty(e[n])||(t[e[n]]=!0,r.push(e[n]));return r},chunkBy:function(e,t){return e.reduce((function(e,r){var n=c(e),o=t(r);return 0===n.length?(n.push(r),e):("start"===o?e.push([r]):"end"===o?(n.push(r),e.push([])):n.push(r),e)}),[[]]).filter((function(e){return e.length>0}))},last:c,first:p,mergeObjects:function(){for(var e,t,r={},n=0;n<arguments.length;n+=1){e=arguments[n],t=Object.keys(e);for(var o=0;o<t.length;o+=1)r[t[o]]=e[t[o]]}return r},xml2str:function(e){return(new s).serializeToString(e).replace(/xmlns(:[a-z0-9]+)?="" ?/g,"")},str2xml:function(e){return 65279===e.charCodeAt(0)&&(e=e.substr(1)),(new i).parseFromString(e,"text/xml")},getRightOrNull:P,getRight:function(e,t,r){var n=P(e,t,r);if(null!==n)return n;u({position:"right",element:t,parsed:e,index:r})},getLeftOrNull:O,getLeft:function(e,t,r){var n=O(e,t,r);if(null!==n)return n;u({position:"left",element:t,parsed:e,index:r})},pregMatchAll:function(e,t){for(var r,n=[];null!=(r=e.exec(t));)n.push({array:r,offset:r.index});return n},convertSpaces:function(e){return e.replace(b," ")},escapeRegExp:m,charMapRegexes:x,hasCorruptCharacters:function(e){return C.test(e)},defaults:v,wordToUtf8:function(e){for(var t,r=x.length-1;r>=0;r--)t=x[r],e=e.replace(t.rstart,t.end);return e},utf8ToWord:function(e){var t;"string"!=typeof e&&(e=e.toString());for(var r=0,n=x.length;r<n;r++)t=x[r],e=e.replace(t.rend,t.start);return e},concatArrays:function(e){for(var t=[],r=0;r<e.length;r++)for(var n=e[r],o=0,a=n.length;o<a;o++)t.push(n[o]);return t},invertMap:function(e){return Object.keys(e).reduce((function(t,r){var n=e[r];return t[n]=t[n]||[],t[n].push(r),t}),{})},charMap:y}},function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r(3),i=a.last,s=a.first;function u(e){this.name="GenericError",this.message=e,this.stack=new Error(e).stack}function l(e){this.name="TemplateError",this.message=e,this.stack=new Error(e).stack}function c(e){this.name="RenderingError",this.message=e,this.stack=new Error(e).stack}function p(e){this.name="ScopeParserError",this.message=e,this.stack=new Error(e).stack}function f(e){this.name="InternalError",this.properties={explanation:"InternalError"},this.message=e,this.stack=new Error(e).stack}function h(e){this.name="APIVersionError",this.properties={explanation:"APIVersionError"},this.message=e,this.stack=new Error(e).stack}u.prototype=Error.prototype,l.prototype=new u,c.prototype=new u,p.prototype=new u,f.prototype=new u,h.prototype=new u,e.exports={XTError:u,XTTemplateError:l,XTInternalError:f,XTScopeParserError:p,XTAPIVersionError:h,RenderingError:c,XTRenderingError:c,getClosingTagNotMatchOpeningTag:function(e){var t=e.tags,r=new l("Closing tag does not match opening tag");return r.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'.concat(t[0].value,'" is closed by the tag "').concat(t[1].value,'"'),openingtag:s(t).value,offset:[s(t).offset,i(t).offset],closingtag:i(t).value},r},getLoopPositionProducesInvalidXMLError:function(e){var t=e.tag,r=e.offset,n=new l('The position of the loop tags "'.concat(t,'" would produce invalid XML'));return n.properties={tag:t,id:"loop_position_invalid",explanation:'The tags "'.concat(t,'" are misplaced in the document, for example one of them is in a table and the other one outside the table'),offset:r},n},getScopeCompilationError:function(e){var t=e.tag,r=e.rootError,n=e.offset,o=new p("Scope parser compilation failed");return o.properties={id:"scopeparser_compilation_failed",offset:n,tag:t,explanation:'The scope parser for the tag "'.concat(t,'" failed to compile'),rootError:r},o},getScopeParserExecutionError:function(e){var t=e.tag,r=e.scope,n=e.error,o=e.offset,a=new p("Scope parser execution failed");return a.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag ".concat(t," failed to execute"),scope:r,offset:o,tag:t,rootError:n},a},getUnclosedTagException:function(e){var t=new l("Unclosed tag");return t.properties={xtag:s(e.xtag.split(" ")).substr(1),id:"unclosed_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" is unclosed')},t},getUnopenedTagException:function(e){var t=new l("Unopened tag");return t.properties={xtag:i(e.xtag.split(" ")),id:"unopened_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" is unopened')},t},getUnmatchedLoopException:function(e){var t=e.location,r="start"===t?"unclosed":"unopened",n=new l("".concat("start"===t?"Unclosed":"Unopened"," loop")),o=e.part.value;return n.properties={id:"".concat(r,"_loop"),explanation:'The loop with tag "'.concat(o,'" is ').concat(r),xtag:o,offset:e.part.offset},n},getDuplicateCloseTagException:function(e){var t=new l("Duplicate close tag, expected one close tag");return t.properties={xtag:s(e.xtag.split(" ")),id:"duplicate_close_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag ending with "'.concat(e.xtag.substr(0,10),'" has duplicate close tags')},t},getDuplicateOpenTagException:function(e){var t=new l("Duplicate open tag, expected one open tag");return t.properties={xtag:s(e.xtag.split(" ")),id:"duplicate_open_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" has duplicate open tags')},t},getCorruptCharactersException:function(e){var t=e.tag,r=e.value,n=e.offset,o=new c("There are some XML corrupt characters");return o.properties={id:"invalid_xml_characters",xtag:t,value:r,offset:n,explanation:"There are some corrupt characters for the field ${tag}"},o},getUnbalancedLoopException:function(e,t){var r=new l("Unbalanced loop tag"),n=t[0].part.value,o=t[1].part.value,a=e[0].part.value,i=e[1].part.value;return r.properties={id:"unbalanced_loop_tags",explanation:"Unbalanced loop tags {#".concat(n,"}{/").concat(o,"}{#").concat(a,"}{/").concat(i,"}"),offset:[t[0].part.offset,e[1].part.offset],lastPair:{left:t[0].part.value,right:t[1].part.value},pair:{left:e[0].part.value,right:e[1].part.value}},r},throwApiVersionError:function(e,t){var r=new h(e);throw r.properties=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:"api_version_error"},t),r},throwContentMustBeString:function(e){var t=new f("Content must be a string");throw t.properties.id="xmltemplater_content_must_be_string",t.properties.type=e,t},throwFileTypeNotHandled:function(e){var t=new f('The filetype "'.concat(e,'" is not handled by docxtemplater'));throw t.properties={id:"filetype_not_handled",explanation:'The file you are trying to generate is of type "'.concat(e,'", but only docx and pptx formats are handled'),fileType:e},t},throwFileTypeNotIdentified:function(){var e=new f("The filetype for this file could not be identified, is this file corrupted ?");throw e.properties={id:"filetype_not_identified"},e},throwLocationInvalid:function(e){throw new f('Location should be one of "start" or "end" (given : '.concat(e.location,")"))},throwMalformedXml:function(e){var t=new f("Malformed xml");throw t.properties={part:e,id:"malformed_xml"},t},throwMultiError:function(e){var t=new l("Multi error");throw t.properties={errors:e,id:"multi_error",explanation:"The template has multiple errors"},t},throwExpandNotFound:function(e){var t=e.part,r=t.value,n=t.offset,o=e.id,a=void 0===o?"raw_tag_outerxml_invalid":o,i=e.message,s=void 0===i?"Raw tag not in paragraph":i,u=e.part,c=e.explanation,p=void 0===c?'The tag "'.concat(r,'" is not inside a paragraph'):c;"function"==typeof p&&(p=p(u));var f=new l(s);throw f.properties={id:a,explanation:p,rootError:e.rootError,xtag:r,offset:n,postparsed:e.postparsed,expandTo:e.expandTo,index:e.index},f},throwRawTagShouldBeOnlyTextInParagraph:function(e){var t=new l("Raw tag should be the only text in paragraph"),r=e.part.value;throw t.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The raw tag "'.concat(r,'" should be the only text in this paragraph. This means that this tag should not be surrounded by any text or spaces.'),xtag:r,offset:e.part.offset,paragraphParts:e.paragraphParts},t},throwUnimplementedTagType:function(e,t){var r='Unimplemented tag type "'.concat(e.type,'"');e.module&&(r+=' "'.concat(e.module,'"'));var n=new l(r);throw n.properties={part:e,index:t,id:"unimplemented_tag_type"},n},throwXmlTagNotFound:function(e){var t=new l('No tag "'.concat(e.element,'" was found at the ').concat(e.position)),r=e.parsed[e.index];throw t.properties={id:"no_xml_tag_found_at_".concat(e.position),explanation:'No tag "'.concat(e.element,'" was found at the ').concat(e.position),offset:r.offset,part:r,parsed:e.parsed,index:e.index,element:e.element},t},throwXmlInvalid:function(e,t){var r=new l("An XML file has invalid xml");throw r.properties={id:"file_has_invalid_xml",content:e,offset:t,explanation:"The docx contains invalid XML, it is most likely corrupt"},r},throwResolveBeforeCompile:function(){var e=new f("You must run `.compile()` before running `.resolveData()`");throw e.properties={id:"resolve_before_compile"},e},throwRenderInvalidTemplate:function(){var e=new f("You should not call .render on a document that had compilation errors");throw e.properties={id:"render_on_invalid_template"},e}}},function(e,t){function r(){}function n(e){return e}e.exports=function(e){var t={set:r,parse:r,render:r,getTraits:r,getFileType:r,nullGetter:r,optionsTransformer:n,postrender:n,errorsTransformer:n,getRenderedMap:n,preparse:n,postparse:n,on:r,resolve:r};if(Object.keys(t).every((function(t){return!e[t]})))throw new Error("This module cannot be wrapped, because it doesn't define any of the necessary functions");return Object.keys(t).forEach((function(r){e[r]=e[r]||t[r]})),e}},function(e,t){e.exports={last:function(e){return e[e.length-1]},first:function(e){return e[0]}}},function(e,t,r){function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u=r(0),l=u.getRightOrNull,c=u.getRight,p=u.getLeft,f=u.getLeftOrNull,h=u.chunkBy,d=u.isTagStart,g=u.isTagEnd,v=u.isContent,y=u.last,m=u.first,x=r(1),b=x.XTTemplateError,w=x.throwExpandNotFound,T=x.getLoopPositionProducesInvalidXMLError;function P(e,t){if(0===e.length)return!1;var r=y(e).tag.substr(1),n=t.substr(2,t.length-3);return 0===r.indexOf(n)}function O(e,t){return e.push({tag:t}),e}function E(e,t,r,n){var o,s,u=e.expandTo||n.expandTo;if(!u)return r;try{s=p(r,u,t),o=c(r,u,t)}catch(o){throw o instanceof b&&w(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({part:e,rootError:o,postparsed:r,expandTo:u,index:t},n.error)),o}var l=r.slice(s,t),f=r.slice(t+1,o+1),h=n.getInner({postparse:n.postparse,index:t,part:e,leftParts:l,rightParts:f,left:s,right:o,postparsed:r});return h.length||(h.expanded=[l,f],h=[h]),{left:s,right:o,inner:h}}e.exports={expandToOne:function(e,t){var r=[];e.errors&&(r=e.errors,e=e.postparsed);for(var o=[],a=0,i=e.length;a<i;a++){var s=e[a];if("placeholder"===s.type&&s.module===t.moduleName)try{var u=E(s,a,e,t);a=u.right,o.push(u)}catch(e){if(!(e instanceof b))throw e;r.push(e)}}for(var l=[],c=0,p=0,f=e.length;p<f;p++){var h=e[p],d=o[c];d&&d.left===p?(l.push.apply(l,n(o[c].inner)),c++,p=d.right):l.push(h)}return{postparsed:l,errors:r}},getExpandToDefault:function(e,t,r){var n=function(e){for(var t,r=e.filter((function(e){return"tag"===e.type})),n=[],o=0;o<r.length;o++)"/"===(t=r[o].value)[1]?P(n,t)?n.pop():n=O(n,t):"/"!==t[t.length-2]&&(n=O(n,t));return n}(e.slice(t[0].offset,t[1].offset));if(n.filter((function(e){return"/"===e.tag[1]})).length!==n.filter((function(e){var t=e.tag;return"/"!==t[1]&&"/"!==t[t.length-2]})).length)return{error:T({tag:m(t).part.value,offset:[m(t).part.offset,y(t).part.offset]})};for(var o=function(o,a){var i=r[o],s=i.contains,u=i.expand,c=i.onlyTextInTag;if(function(e,t){for(var r=0;r<t.length;r++){if(0===t[r].tag.indexOf("<".concat(e)))return!0}return!1}(s,n)){if(c){var p=f(e,s,t[0].offset),x=l(e,s,t[1].offset);if(null===p||null===x)return"continue";var b=h(e.slice(p,x),(function(e){return d(s,e)?"start":g(s,e)?"end":null}));if(b.length<=2)return"continue";var w=m(b),T=y(b),P=w.filter(v),O=T.filter(v);if(1!==P.length||1!==O.length)return"continue"}return{v:{value:u}}}},a=0,i=r.length;a<i;a++){var u=o(a);if("continue"!==u&&"object"===s(u))return u.v}return!1}}},function(e,t){var r={docx:["application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","application/vnd.ms-word.document.macroEnabled.main+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml","application/vnd.ms-word.template.macroEnabledTemplate.main+xml"],pptx:["application/vnd.openxmlformats-officedocument.presentationml.slide+xml"]};e.exports=r},function(e,t,r){function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var a=r(1),i=a.getUnclosedTagException,s=a.getUnopenedTagException,u=a.getDuplicateOpenTagException,l=a.getDuplicateCloseTagException,c=a.throwMalformedXml,p=a.throwXmlInvalid,f=r(0),h=f.concatArrays,d=f.isTextStart,g=f.isTextEnd;function v(e,t){return e[0]<=t.offset&&t.offset<e[1]}function y(e,t){return d(e)?(t&&c(e),!0):g(e)?(t||c(e),!1):t}function m(e){var t="",r=1,n=e.indexOf(" ");return"/"===e[e.length-2]?(t="selfclosing",-1===n&&(n=e.length-2)):"/"===e[1]?(r=2,t="end",-1===n&&(n=e.length-1)):(t="start",-1===n&&(n=e.length-1)),{tag:e.slice(r,n),position:t}}function x(e,t){return-1===e&&-1===t?-2:e===t?0:-1===e||-1===t?t<e?-1:1:e<t?-1:1}function b(e){var t=e.split(" ");if(2!==t.length)throw new Error("New Delimiters cannot be parsed");var r=n(t,2),o=r[0],a=r[1];if(0===o.length||0===a.length)throw new Error("New Delimiters cannot be parsed");return[o,a]}function w(e,t){var r=e.map((function(e){return e.value})).join(""),o=function(e,t){for(var r=[],o=t.start,a=t.end,i=-1,s=!1;;){var u=e.indexOf(o,i+1),l=e.indexOf(a,i+1),c=null,p=void 0,f=x(u,l);if(-2===f)return r;if(0===f&&(f=s?1:-1),1===f&&(s=!1,i=l,c="end",p=a.length),-1===f&&(s=!0,i=u,c="start",p=o.length),"start"!==c||"="!==e[i+o.length])r.push({offset:i,position:c,length:p});else{r.push({offset:u,position:"start",length:o.length,changedelimiter:!0});var h=e.indexOf("=",i+o.length+1),d=e.indexOf(a,h+1);r.push({offset:d,position:"end",length:a.length,changedelimiter:!0});var g=n(b(e.substr(i+o.length+1,h-i-o.length-1)),2);o=g[0],a=g[1],i=d}}}(r,t),a=0,c=e.map((function(e){return{offset:(a+=e.value.length)-e.value.length,lIndex:e.lIndex}})),p=function(e,t,r){if(0===e.length)return[];var n,o=[],a=!1,c={offset:0},p=0;e.forEach((function(e){for(;r[p+1]&&!(r[p+1].offset>e.offset);)p++;n=t.substr(c.offset,e.offset-c.offset),"start"===e.position&&a||"end"===e.position&&!a?"start"===e.position?(c.offset+c.length===e.offset?(n=t.substr(c.offset,e.offset-c.offset+c.length+4),o.push(u({xtag:n,offset:c.offset}))):o.push(i({xtag:n,offset:c.offset})),e.error=!0):(c.offset+c.length===e.offset?(n=t.substr(c.offset-4,e.offset-c.offset+4+c.length),o.push(l({xtag:n,offset:c.offset}))):o.push(s({xtag:n,offset:e.offset})),e.error=!0):a=!a,c=e}));var f={offset:t.length};return n=t.substr(c.offset,f.offset-c.offset),a&&(o.push(i({xtag:n,offset:c.offset})),f.error=!0),o}(o,r,c),f=0,h=0;return{parsed:c.map((function(t,r){for(var n=t.offset,a=[n,n+e[r].value.length],i=e[r].value,s=[];h<o.length&&v(a,o[h]);)s.push(o[h]),h++;var u,l=[],c=0;f>0&&(c=f,f=0),s.forEach((function(e){var t=i.substr(c,e.offset-n-c);if(t.length>0){if(u)return void(e.changedelimiter&&(c=e.offset-n+e.length,u="start"===e.position));l.push({type:"content",value:t,offset:c+n}),c+=t.length}var r={type:"delimiter",position:e.position,offset:c+n};if(e.error&&(r.error=e.error),e.changedelimiter)return u="start"===e.position,void(c=e.offset-n+e.length);l.push(r),c=e.offset-n+e.length})),f=c-i.length;var p=i.substr(c);return p.length>0&&l.push({type:"content",value:p,offset:n}),l}),this),errors:p}}e.exports={parseDelimiters:w,parse:function(e,t){var r=!1,n=w(function(e){var t=!1,r=[];return e.forEach((function(e){(t=y(e,t))&&"content"===e.type&&r.push(e)})),r}(e),t),o=n.parsed,a=n.errors,i=[],s=0;return e.forEach((function(e){r=y(e,r),"content"===e.type&&(e.position=r?"insidetag":"outsidetag"),r&&"content"===e.type?(Array.prototype.push.apply(i,o[s].map((function(e){return"content"===e.type&&(e.position="insidetag"),e}))),s++):i.push(e)})),{errors:a,lexed:i=i.map((function(e,t){return e.lIndex=t,e}))}},xmlparse:function(e,t){var r=function(e,t,r){for(var n=0,o=e.length,a=h([t.map((function(e){return{tag:e,text:!0}})),r.map((function(e){return{tag:e,text:!1}}))]).reduce((function(e,t){return e[t.tag]=t.text,e}),{}),i=[];n<o&&-1!==(n=e.indexOf("<",n));){var s=n,u=e.indexOf("<",n+1);(-1===(n=e.indexOf(">",n))||-1!==u&&n>u)&&p(e,s);var l=e.slice(s,n+1),c=m(l),f=c.tag,d=c.position,g=a[f];null!=g&&i.push({type:"tag",position:d,text:g,offset:s,value:l,tag:f})}return i}(e,t.text,t.other),n=0,o=r.reduce((function(t,r){var o=e.substr(n,r.offset-n);return o.length>0&&t.push({type:"content",value:o}),n=r.offset+r.value.length,delete r.offset,r.value.length>0&&t.push(r),t}),[]),a=e.substr(n);return a.length>0&&o.push({type:"content",value:a}),o}}},function(e,t,r){"use strict";var n=r(0).pregMatchAll;e.exports=function(e,t){var r={};r.content=e,r.tagsXmlArray=t,r.tagsXmlArrayJoined=r.tagsXmlArray.join("|");var o=new RegExp("(?:(<(?:".concat(r.tagsXmlArrayJoined,")[^>]*>)([^<>]*)</(?:").concat(r.tagsXmlArrayJoined,")>)|(<(?:").concat(r.tagsXmlArrayJoined,")[^>]*/>)"),"g");return r.matches=n(o,r.content),function(e){function t(){var t={array:Array.prototype.slice.call(arguments)};t.array.shift();var r=t.array[0]+t.array[1];t.array.unshift(r),t.array.pop();var n=t.array.pop();t.offset=n,t.first=!0,e.matches.unshift(t)}-1===e.content.indexOf("<")&&-1===e.content.indexOf(">")&&e.content.replace(/^()([^<>]*)$/,t);var r=new RegExp("^()([^<]+)</(?:".concat(e.tagsXmlArrayJoined,")>"));return e.content.replace(r,t),r=new RegExp("(<(?:".concat(e.tagsXmlArrayJoined,")[^>]*>)([^>]+)$")),e.content.replace(r,(function(){var t={array:Array.prototype.slice.call(arguments)};t.array.pop();var r=t.array.pop();t.offset=r,t.last=!0,-1===t.array[0].indexOf("/>")&&e.matches.push(t)})),e}(r)}},function(e,t,r){"use strict";function n(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=r(0);i.traits=r(4),i.moduleWrapper=r(2);var s=r(10),u=r(1),l=u.throwMultiError,c=u.throwResolveBeforeCompile,p=u.throwRenderInvalidTemplate,f=r(11),h=r(12),d=r(6),g=i.defaults,v=i.str2xml,y=i.xml2str,m=i.moduleWrapper,x=i.utf8ToWord,b=i.concatArrays,w=i.unique,T=r(1),P=T.XTInternalError,O=T.throwFileTypeNotIdentified,E=T.throwFileTypeNotHandled,j=T.throwApiVersionError,C=[3,25,0],k=function(){function e(t){var r=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=a.modules,s=void 0===i?[]:i,u=n(a,["modules"]);if(o(this,e),!Array.isArray(s))throw new Error("The modules argument of docxtemplater's constructor must be an array");if(this.scopeManagers={},this.compiled={},this.modules=[h()],this.setOptions(u),s.forEach((function(e){r.attachModule(e)})),arguments.length>0){if(!t||!t.files||"function"!=typeof t.file)throw new Error("The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)");this.loadZip(t),this.modules=this.modules.filter((function(e){if(e.supportedFileTypes){if(!Array.isArray(e.supportedFileTypes))throw new Error("The supportedFileTypes field of the module must be an array");var t=-1!==e.supportedFileTypes.indexOf(r.fileType);return t||e.on("detached"),t}return!0})),this.compile(),this.v4Constructor=!0}}var t,r,u;return t=e,(r=[{key:"getModuleApiVersion",value:function(){return C.join(".")}},{key:"verifyApiVersion",value:function(e){return 3!==(e=e.split(".").map((function(e){return parseInt(e,10)}))).length&&j("neededVersion is not a valid version",{neededVersion:e,explanation:"the neededVersion must be an array of length 3"}),e[0]!==C[0]&&j("The major api version do not match, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:C,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(C.join("."))}),e[1]>C[1]&&j("The minor api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:C,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(C.join("."))}),e[1]===C[1]&&e[2]>C[2]&&j("The patch api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:C,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(C.join("."))}),!0}},{key:"setModules",value:function(e){this.modules.forEach((function(t){t.set(e)}))}},{key:"sendEvent",value:function(e){this.modules.forEach((function(t){t.on(e)}))}},{key:"attachModule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.v4Constructor)throw new Error("attachModule() should not be called manually when using the v4 constructor");if(e.requiredAPIVersion&&this.verifyApiVersion(e.requiredAPIVersion),!0===e.attached)throw new Error('Cannot attach a module that was already attached : "'.concat(e.name,'". Maybe you are instantiating the module at the root level, and using it for multiple instances of Docxtemplater'));e.attached=!0;var r=t.prefix;r&&(e.prefix=r);var n=m(e);return this.modules.push(n),n.on("attached"),this}},{key:"setOptions",value:function(e){var t=this;if(this.v4Constructor)throw new Error("setOptions() should not be called manually when using the v4 constructor");if(!e)throw new Error("setOptions should be called with an object as first parameter");return e.delimiters&&(e.delimiters.start=x(e.delimiters.start),e.delimiters.end=x(e.delimiters.end)),this.options={},Object.keys(g).forEach((function(r){var n=g[r];t.options[r]=null!=e[r]?e[r]:n,t[r]=t.options[r]})),this.zip&&this.updateFileTypeConfig(),this}},{key:"loadZip",value:function(e){if(e.loadAsync)throw new P("Docxtemplater doesn't handle JSZip version >=3, please use pizzip");return this.zip=e,this.updateFileTypeConfig(),this.modules=b([this.fileTypeConfig.baseModules.map((function(e){return e()})),this.modules]),this}},{key:"compileFile",value:function(e){this.compiled[e].parse()}},{key:"precompileFile",value:function(e){var t=this.createTemplateClass(e);t.preparse(),this.compiled[e]=t}},{key:"getScopeManager",value:function(e,t,r){return this.scopeManagers[e]||(this.scopeManagers[e]=s({tags:r||{},parser:this.parser,cachedParsers:t.cachedParsers})),this.scopeManagers[e]}},{key:"resolveData",value:function(e){var t=this,r=[];return Object.keys(this.compiled).length||c(),Promise.resolve(e).then((function(e){return t.setData(e),t.setModules({data:t.data,Lexer:d}),t.mapper=t.modules.reduce((function(e,t){return t.getRenderedMap(e)}),{}),Promise.all(Object.keys(t.mapper).map((function(e){var n=t.mapper[e],o=n.from,a=n.data;return Promise.resolve(a).then((function(n){var a=t.compiled[o];return a.filePath=e,a.scopeManager=t.getScopeManager(e,a,n),a.scopeManager.resolved=[],a.resolveTags(n).then((function(e){return a.scopeManager.finishedResolving=!0,e}),(function(e){r=r.concat(e)}))}))}))).then((function(e){return 0!==r.length&&l(r),b(e)}))}))}},{key:"compile",value:function(){var e=this;return Object.keys(this.compiled).length||(this.options=this.modules.reduce((function(t,r){return r.optionsTransformer(t,e)}),this.options),this.options.xmlFileNames=w(this.options.xmlFileNames),this.xmlDocuments=this.options.xmlFileNames.reduce((function(t,r){var n=e.zip.files[r].asText();return t[r]=v(n),t}),{}),this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments}),this.getTemplatedFiles(),this.setModules({compiled:this.compiled}),this.templatedFiles.forEach((function(t){null!=e.zip.files[t]&&e.precompileFile(t)})),this.templatedFiles.forEach((function(t){null!=e.zip.files[t]&&e.compileFile(t)})),S(this)),this}},{key:"updateFileTypeConfig",value:function(){var t,r=this;this.zip.files.mimetype&&(t="odt");var n=this.zip.files["[Content_Types].xml"];this.targets=[];var o=n?v(n.asText()):null,a=o?o.getElementsByTagName("Override"):null,s=o?o.getElementsByTagName("Default"):null;return o&&(this.filesContentTypes=f(a,s,this.zip),this.invertedContentTypes=i.invertMap(this.filesContentTypes),this.setModules({contentTypes:this.contentTypes,invertedContentTypes:this.invertedContentTypes})),this.modules.forEach((function(e){t=e.getFileType({zip:r.zip,contentTypes:n,contentTypeXml:o,overrides:a,defaults:s,doc:r})||t})),"odt"===t&&E(t),t||O(),this.fileType=t,this.fileTypeConfig=this.options.fileTypeConfig||this.fileTypeConfig||e.FileTypeConfig[this.fileType](),this}},{key:"render",value:function(){var e=this;return this.compile(),this.errors.length>0&&p(),this.setModules({data:this.data,Lexer:d}),this.mapper=this.modules.reduce((function(e,t){return t.getRenderedMap(e)}),{}),this.fileTypeConfig.tagsXmlLexedArray=w(this.fileTypeConfig.tagsXmlLexedArray),this.fileTypeConfig.tagsXmlTextArray=w(this.fileTypeConfig.tagsXmlTextArray),Object.keys(this.mapper).forEach((function(t){var r=e.mapper[t],n=r.from,o=r.data,a=e.compiled[n];a.setTags(o),a.scopeManager=e.getScopeManager(t,a,o),a.render(t),e.zip.file(t,a.content,{createFolders:!0})})),S(this),this.sendEvent("syncing-zip"),this.syncZip(),this}},{key:"syncZip",value:function(){var e=this;Object.keys(this.xmlDocuments).forEach((function(t){e.zip.remove(t);var r=y(e.xmlDocuments[t]);return e.zip.file(t,r,{createFolders:!0})}))}},{key:"setData",value:function(e){return this.data=e,this}},{key:"getZip",value:function(){return this.zip}},{key:"createTemplateClass",value:function(e){var t=this.zip.files[e].asText();return this.createTemplateClassFromContent(t,e)}},{key:"createTemplateClassFromContent",value:function(t,r){var n=this,o={filePath:r,contentType:this.filesContentTypes[r]};return Object.keys(g).concat(["filesContentTypes","fileTypeConfig","modules"]).forEach((function(e){o[e]=n[e]})),new e.XmlTemplater(t,o)}},{key:"getFullText",value:function(e){return this.createTemplateClass(e||this.fileTypeConfig.textPath(this)).getFullText()}},{key:"getTemplatedFiles",value:function(){var e=this;return this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip),this.targets.forEach((function(t){e.templatedFiles.push(t)})),this.templatedFiles}}])&&a(t.prototype,r),u&&a(t,u),e}();function S(e){var t=e.compiled,r=[];Object.keys(t).forEach((function(e){var n=t[e];r=b([r,n.allErrors])})),e.errors=r,0!==r.length&&l(r)}k.DocUtils=i,k.Errors=r(1),k.XmlTemplater=r(13),k.FileTypeConfig=r(20),k.XmlMatcher=r(7),e.exports=k},function(e,t){e.exports={XMLSerializer:window.XMLSerializer,DOMParser:window.DOMParser,XMLDocument:window.XMLDocument}},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=r(1).getScopeParserExecutionError,s=r(3).last,u=r(0).concatArrays;function l(e,t){for(var r,n=e.length>>>0,o=0;o<n;o++)if(r=e[o],t.call(this,r,o,e))return r}function c(e,t,r){var n,o,a=this,s=this.scopeList[r];if(this.root.finishedResolving){var u=this.resolved;return this.scopePath.forEach((function(e,t){var r=a.scopeLindex[t];u=(u=l(u,(function(e){return e.lIndex===r}))).value[a.scopePathItem[t]]})),[this.scopePath.length-1,l(u,(function(e){return t.part.lIndex===e.lIndex})).value]}o=this.cachedParsers&&t.part?this.cachedParsers[t.part.lIndex]?this.cachedParsers[t.part.lIndex]:this.cachedParsers[t.part.lIndex]=this.parser(e,{scopePath:this.scopePath}):this.parser(e,{scopePath:this.scopePath});try{n=o.get(s,this.getContext(t,r))}catch(r){throw i({tag:e,scope:s,error:r,offset:t.part.offset})}return null==n&&r>0?c.call(this,e,t,r-1):[r,n]}function p(e,t,r){var n,o=this,a=this.scopeList[r];return n=this.cachedParsers&&t.part?this.cachedParsers[t.part.lIndex]?this.cachedParsers[t.part.lIndex]:this.cachedParsers[t.part.lIndex]=this.parser(e,{scopePath:this.scopePath}):this.parser(e,{scopePath:this.scopePath}),Promise.resolve().then((function(){return n.get(a,o.getContext(t,r))})).catch((function(r){throw i({tag:e,scope:a,error:r,offset:t.part.offset})})).then((function(n){return null==n&&r>0?p.call(o,e,t,r-1):n}))}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.root=t.root||this,this.scopePath=t.scopePath,this.scopePathItem=t.scopePathItem,this.scopePathLength=t.scopePathLength,this.scopeList=t.scopeList,this.scopeLindex=t.scopeLindex,this.parser=t.parser,this.resolved=t.resolved,this.cachedParsers=t.cachedParsers}var t,r,o;return t=e,(r=[{key:"loopOver",value:function(e,t,r,n){return this.loopOverValue(this.getValue(e,n),t,r)}},{key:"functorIfInverted",value:function(e,t,r,n,o){return e&&t(r,n,o),e}},{key:"isValueFalsy",value:function(e,t){return null==e||!e||"[object Array]"===t&&0===e.length}},{key:"loopOverValue",value:function(e,t,r){this.root.finishedResolving&&(r=!1);var n=Object.prototype.toString.call(e);if(this.isValueFalsy(e,n))return this.functorIfInverted(r,t,s(this.scopeList),0,1);if("[object Array]"===n){for(var o=0;o<e.length;o++)this.functorIfInverted(!r,t,e[o],o,e.length);return!0}return"[object Object]"===n?this.functorIfInverted(!r,t,e,0,1):this.functorIfInverted(!r,t,s(this.scopeList),0,1)}},{key:"getValue",value:function(e,t){var r=n(c.call(this,e,t,this.scopeList.length-1),2),o=r[0],a=r[1];return this.num=o,a}},{key:"getValueAsync",value:function(e,t){return p.call(this,e,t,this.scopeList.length-1)}},{key:"getContext",value:function(e,t){return{num:t,meta:e,scopeList:this.scopeList,resolved:this.resolved,scopePath:this.scopePath,scopePathItem:this.scopePathItem,scopePathLength:this.scopePathLength}}},{key:"createSubScopeManager",value:function(t,r,n,o,a){return new e({root:this.root,resolved:this.resolved,parser:this.parser,cachedParsers:this.cachedParsers,scopeList:u([this.scopeList,[t]]),scopePath:u([this.scopePath,[r]]),scopePathItem:u([this.scopePathItem,[n]]),scopePathLength:u([this.scopePathLength,[a]]),scopeLindex:u([this.scopeLindex,[o.lIndex]])})}}])&&a(t.prototype,r),o&&a(t,o),e}();e.exports=function(e){return e.scopePath=[],e.scopePathItem=[],e.scopePathLength=[],e.scopeLindex=[],e.scopeList=[e.tags],new f(e)}},function(e,t){e.exports=function(e,t,r){for(var n={},o=0,a=e.length;o<a;o++){var i=e[o],s=i.getAttribute("ContentType"),u=i.getAttribute("PartName").substr(1);n[u]=s}for(var l=function(e,o){var a=t[e],i=a.getAttribute("ContentType"),s=a.getAttribute("Extension");r.file(/./).map((function(e){var t=e.name;".xml"!==t.slice(t.length-s.length-1)||n[t]||"[Content_Types].xml"===t||(n[t]=i)}))},c=0,p=t.length;c<p;c++)l(c);return n}},function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(2),a=r(0).concatArrays,i=r(5),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="Common"}var t,r,o;return t=e,(r=[{key:"set",value:function(e){var t=e.invertedContentTypes;t&&(this.invertedContentTypes=t)}},{key:"getFileType",value:function(e){var t=e.doc,r=this.invertedContentTypes;if(this.invertedContentTypes)for(var n=Object.keys(i),o=0,s=n.length;o<s;o++)for(var u=n[o],l=i[u],c=0,p=l.length;c<p;c++){var f=l[c];if(r[f])return t.targets=a([t.targets,r[f]]),u}}}])&&n(t.prototype,r),o&&n(t,o),e}();e.exports=function(){return o(new s)}},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=r(0),i=a.wordToUtf8,s=a.convertSpaces,u=a.defaults,l=r(7),c=r(1).throwContentMustBeString,p=r(6),f=r(14),h=r(16),d=r(17),g=r(18),v=r(19);e.exports=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.filePath=r.filePath,this.cachedParsers={},this.modules=r.modules,this.fileTypeConfig=r.fileTypeConfig,this.contentType=r.contentType,Object.keys(u).map((function(e){this[e]=null!=r[e]?r[e]:u[e]}),this),this.setModules({inspect:{filePath:this.filePath}}),this.load(t)}var t,r,a;return t=e,(r=[{key:"load",value:function(e){"string"!=typeof e&&c(n(e)),this.content=e}},{key:"setTags",value:function(e){return this.tags=null!=e?e:{},this}},{key:"resolveTags",value:function(e){var t=this;this.tags=null!=e?e:{};var r=this.getOptions();return r.scopeManager=this.scopeManager,r.resolve=g,g(r).then((function(e){var n=e.resolved,o=e.errors;if(o.forEach((function(e){e.properties=e.properties||{},e.properties.file=t.filePath})),0!==o.length)throw o;return Promise.all(n).then((function(e){return r.scopeManager.finishedResolving=!0,r.scopeManager.resolved=e,t.setModules({inspect:{resolved:e}}),e}))}))}},{key:"getFullText",value:function(){return e=this.content,t=this.fileTypeConfig.tagsXmlTextArray,r=l(e,t).matches.map((function(e){return e.array[2]})),i(s(r.join("")));var e,t,r}},{key:"setModules",value:function(e){this.modules.forEach((function(t){t.set(e)}))}},{key:"preparse",value:function(){this.allErrors=[],this.xmllexed=p.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray}),this.setModules({inspect:{xmllexed:this.xmllexed}});var e=p.parse(this.xmllexed,this.delimiters),t=e.lexed,r=e.errors;this.allErrors=this.allErrors.concat(r),this.lexed=t,this.setModules({inspect:{lexed:this.lexed}});var n=this.getOptions();f.preparse(this.lexed,this.modules,n)}},{key:"parse",value:function(){this.setModules({inspect:{filePath:this.filePath}});var e=this.getOptions();this.parsed=f.parse(this.lexed,this.modules,e),this.setModules({inspect:{parsed:this.parsed}});var t=f.postparse(this.parsed,this.modules,e),r=t.postparsed,n=t.errors;return this.postparsed=r,this.setModules({inspect:{postparsed:this.postparsed}}),this.allErrors=this.allErrors.concat(n),this.errorChecker(this.allErrors),this}},{key:"errorChecker",value:function(e){var t=this;e.length&&(e.forEach((function(e){e.properties=e.properties||{},e.properties.file=t.filePath})),this.modules.forEach((function(t){e=t.errorsTransformer(e)})))}},{key:"baseNullGetter",value:function(e,t){var r=this,n=this.modules.reduce((function(n,o){return null!=n?n:o.nullGetter(e,t,r)}),null);return null!=n?n:this.nullGetter(e,t)}},{key:"getOptions",value:function(){return{compiled:this.postparsed,cachedParsers:this.cachedParsers,tags:this.tags,modules:this.modules,parser:this.parser,contentType:this.contentType,baseNullGetter:this.baseNullGetter.bind(this),filePath:this.filePath,fileTypeConfig:this.fileTypeConfig,linebreaks:this.linebreaks}}},{key:"render",value:function(e){this.filePath=e;var t=this.getOptions();t.resolved=this.scopeManager.resolved,t.scopeManager=this.scopeManager,t.render=h,t.joinUncorrupt=v;var r=h(t),n=r.errors,o=r.parts;return this.allErrors=n,this.errorChecker(n),n.length>0||(this.content=d(o,t),this.setModules({inspect:{content:this.content}})),this}}])&&o(t.prototype,r),a&&o(t,a),e}()},function(e,t,r){function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=r(0),s=i.wordToUtf8,u=i.concatArrays,l=r(15),c=l.match,p=l.getValue,f=l.getValues;var h={preparse:function(e,t,r){function n(e,r){return t.forEach((function(t){t.preparse(e,r)}))}return{preparsed:n(e,r)}},postparse:function(e,t,r){function n(e,r){return t.map((function(t){return t.getTraits(e,r)}))}var a=[];return{postparsed:function e(r,i){return t.reduce((function(t,r){var s=r.postparse(t,o(o({},i),{},{postparse:function(t,r){return e(t,o(o({},i),r))},getTraits:n}));return null==s?t:s.errors?(a=u([a,s.errors]),s.postparsed):s}),r)}(e,r),errors:a}},parse:function(e,t,r){var n,a=!1,i="",u=[];return e.reduce((function(e,l){return"delimiter"===l.type?(a="start"===l.position,"end"===l.position&&(i=s(i),r.parse=function(e){return function(e,t){var r,n=t.modules,o=t.startOffset,a=t.lIndex;t.offset=o,t.lIndex=a,t.match=c,t.getValue=p,t.getValues=f;for(var i=0,s=n.length;i<s;i++){if(r=n[i].parse(e,t))return r.offset=o,r.endLindex=a,r.lIndex=a,r.raw=e,r}return{type:"placeholder",value:e,offset:o,endLindex:a,lIndex:a}}(e,o(o(o({},r),l),{},{startOffset:n,modules:t}))},e.push(r.parse(i)),Array.prototype.push.apply(e,u),u=[]),"start"===l.position&&(u=[],n=l.offset),i="",e):a?"content"!==l.type||"insidetag"!==l.position?(u.push(l),e):(i+=l.value,e):(e.push(l),e)}),[])}};e.exports=h},function(e,t){e.exports={match:function(e,t){return"string"==typeof e?t.substr(0,e.length)===e:e instanceof RegExp?e.test(t):void 0},getValue:function(e,t){return"string"==typeof e?t.substr(e.length):e instanceof RegExp?t.match(e)[1]:void 0},getValues:function(e,t){if(e instanceof RegExp)return t.match(e)}}},function(e,t,r){"use strict";var n=r(0).concatArrays,o=r(1).throwUnimplementedTagType;e.exports=function(e){var t=e.baseNullGetter,r=e.compiled,a=e.scopeManager;e.nullGetter=function(e,r){return t(e,r||a)},e.prefix||(e.prefix=""),e.index&&(e.prefix=e.prefix+e.index+"-");var i=[],s=r.map((function(t,r){e.index=r;var a=function(e,t){for(var r,n=0,o=t.modules.length;n<o;n++){if(r=t.modules[n].render(e,t))return r}return!1}(t,e);return a?(a.errors&&(i=n([i,a.errors])),a.value):"content"===t.type||"tag"===t.type?t.value:void o(t,r)}));return{errors:i,parts:s}}},function(e,t,r){"use strict";e.exports=function(e,t){for(var r=0,n=t.modules.length;r<n;r++){e=t.modules[r].postrender(e,t)}return t.joinUncorrupt(e,t)}},function(e,t,r){"use strict";function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}e.exports=function(e){var t=[],r=e.baseNullGetter,o=e.compiled,a=e.scopeManager;e.nullGetter=function(e,t){return r(e,t||a)},e.resolved=t;var i=[];return Promise.all(o.filter((function(e){return-1===["content","tag"].indexOf(e.type)})).reduce((function(r,o){var s,u=function(e,t){for(var r,n=0,o=t.modules.length;n<o;n++){if(r=t.modules[n].resolve(e,t))return r}return!1}(o,e);if(u)s=u.then((function(e){t.push({tag:o.value,value:e,lIndex:o.lIndex})}));else{if("placeholder"!==o.type)return;s=a.getValueAsync(o.value,{part:o}).then((function(r){return null==r&&(r=e.nullGetter(o)),t.push({tag:o.value,value:r,lIndex:o.lIndex}),r}))}return r.push(s.catch((function(e){e.length>1?i.push.apply(i,n(e)):i.push(e)}))),r}),[])).then((function(){return{errors:i,resolved:t}}))}},function(e,t,r){var n=r(0),o=n.endsWith,a=n.startsWith,i=r(5);e.exports=function(e,t){var r=t.fileTypeConfig.tagShouldContain||[],n="",s=-1;return t.basePart||-1===i.docx.indexOf(t.contentType)||(e=function(e){for(var t=!1,r=e.length-1;r>=0;r--){var n=e[r];if(a(n,"<w:sectPr")&&(t=!0),t){var i=n.trim();if(o(i,"</w:tbl>"))return e.splice(r+1,0,"<w:p><w:r><w:t></w:t></w:r></w:p>"),e;if(o(i,"</w:p>"))return e}}return e}(e)),e.reduce((function(e,t){for(var o=0,a=r.length;o<a;o++){var i=r[o],u=i.tag,l=i.shouldContain,c=i.value,p=new RegExp("^(<(".concat(u,")[^>]*>)$"),"g");if(s===o){if(t==="</".concat(u,">"))return s=-1,e+n+c+t;n+=t;for(var f=0,h=l.length;f<h;f++){var d=l[f];if(-1!==t.indexOf("<".concat(d," "))||-1!==t.indexOf("<".concat(d,">")))return s=-1,e+n}return e}if(-1===s&&p.test(t))return"/"===t[t.length-2]||(s=o,n=t),e}return e+t}),"")}},function(e,t,r){"use strict";var n=r(21),o=r(22),a=r(23),i=r(24),s=r(26);e.exports={docx:function(){return{getTemplatedFiles:function(e){return e.file(/word\/(header|footer)\d+\.xml/).map((function(e){return e.name})).concat(["docProps/core.xml","docProps/app.xml","word/settings.xml"])},textPath:function(e){return e.targets[0]},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","w:t","m:t","vt:lpstr"],tagsXmlLexedArray:["w:proofState","w:tc","w:tr","w:table","w:p","w:r","w:br","w:rPr","w:pPr","w:spacing","w:sdtContent","w:sectPr","w:headerReference","w:footerReference"],expandTags:[{contains:"w:tc",expand:"w:tr"}],onParagraphLoop:[{contains:"w:p",expand:"w:p",onlyTextInTag:!0}],tagRawXml:"w:p",tagTextXml:"w:t",baseModules:[n,o,i,a,s],tagShouldContain:[{tag:"w:tc",shouldContain:["w:p"],value:"<w:p></w:p>"},{tag:"w:sdtContent",shouldContain:["w:p","w:r"],value:"<w:p></w:p>"}]}},pptx:function(){return{getTemplatedFiles:function(e){return e.file(/ppt\/(slideMasters)\/(slideMaster)\d+\.xml/).map((function(e){return e.name})).concat(["ppt/presentation.xml","docProps/app.xml","docProps/core.xml"])},textPath:function(){return"ppt/slides/slide1.xml"},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","a:t","m:t","vt:lpstr"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:table","a:p","a:r","a:rPr","p:txBody","a:txBody"],expandTags:[{contains:"a:tc",expand:"a:tr"}],onParagraphLoop:[{contains:"a:p",expand:"a:p",onlyTextInTag:!0}],tagRawXml:"p:sp",tagTextXml:"a:t",baseModules:[n,i,a,s],tagShouldContain:[{tag:"p:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"},{tag:"a:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"}]}}}},function(e,t,r){function n(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=r(0),f=p.mergeObjects,h=p.chunkBy,d=p.last,g=p.isParagraphStart,v=p.isParagraphEnd,y=p.isContent,m=p.startsWith,x=r(2);function b(e){var t=function(e){for(var t=0,r=e.length;t<r;t++)if("content"!==e[t].type)return e[t];return null}(e.subparsed);return null!=t&&"w:t"!==t.tag}function w(e){return e.hasPageBreak&&b(e)?'<w:p><w:r><w:br w:type="page"/></w:r></w:p>':""}function T(e){return e.some((function(e){return y(e)}))?0:e.length}function P(e){return e.some((function(e){if("w:br"===e.tag&&-1!==e.value.indexOf('w:type="page"'))return!0}))}var O=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="LoopModule",this.totalSectPr=0,this.prefix={start:"#",end:"/",dash:/^-([^\s]+)\s(.+)$/,inverted:"^"}}var t,r,o;return t=e,(r=[{key:"parse",value:function(e,t){var r=t.match,n=t.getValue,o=t.getValues,a="placeholder",i=this.prefix,u=i.start,l=i.inverted,c=i.dash,p=i.end;if(r(u,e))return{type:a,value:n(u,e),expandTo:"auto",module:"loop",location:"start",inverted:!1};if(r(l,e))return{type:a,value:n(l,e),expandTo:"auto",module:"loop",location:"start",inverted:!0};if(r(p,e))return{type:a,value:n(p,e),module:"loop",location:"end"};if(r(c,e)){var f=s(o(c,e),3),h=f[1];return{type:a,value:f[2],expandTo:h,module:"loop",location:"start",inverted:!1}}return null}},{key:"getTraits",value:function(e,t){if("expandPair"===e)return t.reduce((function(e,t,r){return"placeholder"===t.type&&"loop"===t.module&&null==t.subparsed&&e.push({part:t,offset:r}),e}),[])}},{key:"postparse",value:function(e,t){var r=t.basePart;if(r&&(r.sectPrCount=function(e){var t=!1,r=0;return e.forEach((function(e){"w:sectPr"===e.tag&&"start"===e.position&&(t=!0),t&&("w:headerReference"!==e.tag&&"w:footerReference"!==e.tag||(r++,t=!1)),"w:sectPr"===e.tag&&"end"===e.position&&(t=!1)})),r}(e),r.sectPrIndex=this.totalSectPr,this.totalSectPr+=r.sectPrCount),!r||"auto"!==r.expandTo||"loop"!==r.module||!function(e){return 0!==e.length&&g(e[0])&&v(d(e))}(e))return e;var n=0,o=h(e,(function(e){return g(e)&&1==++n?"start":v(e)&&0==--n?"end":null}));if(o.length<=2)return e;var a=o[0],i=d(o),s=T(a),u=T(i);return r.hasPageBreak=P(i),r.hasPageBreakBeginning=P(a),0===s||0===u?e:e.slice(s,e.length-u)}},{key:"render",value:function(e,t){if("placeholder"!==e.type||"loop"!==e.module)return null;var r,n=[],o=[];try{r=t.scopeManager.loopOver(e.value,(function(r,a,i){var s=t.scopeManager.createSubScopeManager(r,e.value,a,e,i),u=t.render(f({},t,{compiled:e.subparsed,tags:{},scopeManager:s}));e.hasPageBreak&&a===i-1&&b(e)&&function(e){for(var t=!1,r=e.parts.length-1,n=e.parts.length-1;r>=0;r--)if("</w:p>"===e.parts[n]&&!t){t=!0,e.parts.splice(n,0,'<w:r><w:br w:type="page"/></w:r>');break}t||e.parts.push('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}(u),s.scopePathItem.some((function(e){return 0!==e}))&&(1===e.sectPrCount&&(u.parts=u.parts.filter((function(e){return!m(e,"<w:headerReference")&&!m(e,"<w:footerReference")}))),0===e.sectPrIndex&&(u.parts=function(e){var t=!1,r=!1;return e.reduce((function(e,n){return!1===t&&m(n,"<w:sectPr")&&(r=!0),r&&(m(n,"<w:type")&&(t=!0),!1===t&&m(n,"</w:sectPr")&&e.push('<w:type w:val="continuous"/>')),e.push(n),e}),[])}(u.parts))),e.hasPageBreakBeginning&&b(e)&&function(e){e.parts.unshift('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}(u),n=n.concat(u.parts),o=o.concat(u.errors||[])}),e.inverted,{part:e})}catch(e){return o.push(e),{errors:o}}return!1===r?{value:w(e)||"",errors:o}:{value:t.joinUncorrupt(n,a(a({},t),{},{basePart:e})),errors:o}}},{key:"resolve",value:function(e,t){if("placeholder"!==e.type||"loop"!==e.module)return null;var r=t.scopeManager,o=r.getValueAsync(e.value,{part:e}),a=[];function i(n,o,i){var s=r.createSubScopeManager(n,e.value,o,e,i);a.push(t.resolve({filePath:t.filePath,modules:t.modules,baseNullGetter:t.baseNullGetter,resolve:t.resolve,compiled:e.subparsed,tags:{},scopeManager:s}))}var s=[];return o.then((function(t){return r.loopOverValue(t,i,e.inverted),Promise.all(a).then((function(e){return e.map((function(e){var t=e.resolved,r=e.errors;return r.length>0&&s.push.apply(s,n(r)),t}))})).then((function(e){if(s.length>0)throw s;return e}))}))}}])&&c(t.prototype,r),o&&c(t,o),e}();e.exports=function(){return x(new O)}},function(e,t,r){var n=r(2),o=r(0),a=o.isTextStart,i=o.isTextEnd,s=o.endsWith,u=o.startsWith,l='<w:t xml:space="preserve">'.length,c="</w:t>".length;function p(e,t){var r=e[t].value;return"</w:t>"===e[t+1].value||-1!==r.indexOf('xml:space="preserve"')?r:r.substr(0,r.length-1)+' xml:space="preserve">'}var f={name:"SpacePreserveModule",postparse:function(e,t){var r=[],n=!1,o=0,s=0;var u=e.reduce((function(e,u){return function(e){return a(e)&&"w:t"===e.tag}(u)&&(n=!0,s=r.length),n?(r.push(u),function(e,t){return e&&e.basePart&&t.length>1}(t,r)&&(o=t.basePart.endLindex,r[0].value=p(r,0)),function(e,t){return!o&&"placeholder"===e.type&&(!e.module||"loop"===e.module)&&t.length>1}(u,r)&&(o=u.endLindex,r[0].value=p(r,0)),i(u)&&u.lIndex>o&&(0!==o&&(r[s].value=p(r,s)),Array.prototype.push.apply(e,r),r=[],n=!1,o=0,s=0),e):(e.push(u),e)}),[]);return Array.prototype.push.apply(u,r),u},postrender:function(e){var t="",r=0;return e.reduce((function(e,n,o){return""===n?(e.push(n),e):(-1!==n.indexOf('<w:t xml:space="preserve"></w:t>')&&(n=n.replace(/<w:t xml:space="preserve"><\/w:t>/g,"<w:t/>")),s(t,'<w:t xml:space="preserve">')&&u(n,"</w:t>")&&(e[r]=t.substr(0,t.length-l)+"<w:t/>",n=n.substr(c)),t=n,r=o,e.push(n),e)}),[])}};e.exports=function(){return n(f)}},function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(4),a=r(0).isContent,i=r(1).throwRawTagShouldBeOnlyTextInParagraph,s=r(2);function u(e){var t=e.part,r=e.left,n=e.right,o=e.postparsed,s=e.index,u=o.slice(r+1,n);return u.forEach((function(e,n){n!==s-r-1&&a(e)&&i({paragraphParts:u,part:t})})),t}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="RawXmlModule",this.prefix="@"}var t,r,a;return t=e,(r=[{key:"optionsTransformer",value:function(e,t){return this.fileTypeConfig=t.fileTypeConfig,e}},{key:"parse",value:function(e,t){var r=t.match,n=t.getValue;return r(this.prefix,e)?{type:"placeholder",value:n(this.prefix,e),module:"rawxml"}:null}},{key:"postparse",value:function(e){return o.expandToOne(e,{moduleName:"rawxml",getInner:u,expandTo:this.fileTypeConfig.tagRawXml,error:{message:"Raw tag not in paragraph",id:"raw_tag_outerxml_invalid",explanation:function(e){return'The tag "'.concat(e.value,'" is not inside a paragraph, putting raw tags inside an inline loop is disallowed.')}}})}},{key:"render",value:function(e,t){if("rawxml"!==e.module)return null;var r,n=[];try{null==(r=t.scopeManager.getValue(e.value,{part:e}))&&(r=t.nullGetter(e))}catch(e){return n.push(e),{errors:n}}return r?{value:r}:{value:""}}},{key:"resolve",value:function(e,t){return"placeholder"!==e.type||"rawxml"!==e.module?null:t.scopeManager.getValueAsync(e.value,{part:e}).then((function(r){return null==r?t.nullGetter(e):r}))}}])&&n(t.prototype,r),a&&n(t,a),e}();e.exports=function(){return s(new l)}},function(e,t,r){function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var a=r(25),i=r(0),s=i.getLeft,u=i.getRight,l=r(2),c=r(4).getExpandToDefault,p=r(1),f=p.getUnmatchedLoopException,h=p.getClosingTagNotMatchOpeningTag,d=p.throwLocationInvalid,g=p.getUnbalancedLoopException;function v(e){switch(e.location){case"start":return 1;case"end":return-1;default:d(e)}}var y={name:"ExpandPairTrait",optionsTransformer:function(e,t){return this.expandTags=t.fileTypeConfig.expandTags.concat(t.options.paragraphLoop?t.fileTypeConfig.onParagraphLoop:[]),e},postparse:function(e,t){var r=this,o=t.getTraits,i=t.postparse,l=o("expandPair",e);l=l.map((function(e){return e||[]}));var p,d=function e(t){var r=[],o=[];if(0===t.length)return{pairs:o,errors:r};var a=1,i=n(t,1)[0];if("start"===i.part.location)for(var s=1;s<t.length;s++){var u=t[s];if(0===(a+=v(u.part))){var l=e(t.slice(s+1));return u.part.value!==i.part.value&&""!==u.part.value?r.push(h({tags:[i.part,u.part]})):o=[[i,u]],{pairs:o.concat(l.pairs),errors:r.concat(l.errors)}}}var c=i.part;r.push(f({part:c,location:c.location}));var p=e(t.slice(1));return{pairs:p.pairs,errors:r.concat(p.errors)}}(l=a(l)),y=d.pairs,m=d.errors,x=0,b=null,w=y.map((function(t){var n,o,a=t[0].part.expandTo;if("auto"===a){var i=c(e,t,r.expandTags);i.error&&m.push(i.error),a=i.value}if(!a){var l=t[0].offset,p=t[1].offset;return l<x&&m.push(g(t,b)),b=t,x=p,[l,p]}try{n=s(e,a,t[0].offset)}catch(e){m.push(e)}try{o=u(e,a,t[1].offset)}catch(e){m.push(e)}return n<x&&m.push(g(t,b)),x=o,b=t,[n,o]})),T=0;return{postparsed:e.reduce((function(t,r,n){var o=T<y.length&&w[T][0]<=n&&n<=w[T][1],a=y[T],s=w[T];if(!o)return t.push(r),t;if(s[0]===n&&(p=[]),a[0].offset!==n&&a[1].offset!==n&&p.push(r),s[1]===n){var u=e[a[0].offset];u.subparsed=i(p,{basePart:u}),delete u.location,delete u.expandTo,t.push(u),T++}return t}),[]),errors:m}}};e.exports=function(){return l(y)}},function(e,t){function r(e,t){for(var r=-1,n=0,o=e.length;n<o;n++)t[n]>=e[n].length||(-1===r||e[n][t[n]].offset<e[r][t[r]].offset)&&(r=n);if(-1===r)throw new Error("minIndex negative");return r}e.exports=function(e){var t=e.reduce((function(e,t){return e+t.length}),0);e=e.filter((function(e){return e.length>0}));for(var n=new Array(t),o=e.map((function(){return 0})),a=0;a<=t-1;){var i=r(e,o);n[a]=e[i][o[i]],o[i]++,a++}return n}},function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(2),a=r(1).getScopeCompilationError,i=r(0),s=i.utf8ToWord,u=i.hasCorruptCharacters,l=r(1).getCorruptCharactersException,c={docx:"w",pptx:"a"},p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="Render",this.recordRun=!1,this.recordedRun=[]}var t,r,o;return t=e,(r=[{key:"set",value:function(e){e.compiled&&(this.compiled=e.compiled),null!=e.data&&(this.data=e.data)}},{key:"getRenderedMap",value:function(e){var t=this;return Object.keys(this.compiled).reduce((function(e,r){return e[r]={from:r,data:t.data},e}),e)}},{key:"optionsTransformer",value:function(e,t){return this.parser=t.parser,this.fileType=t.fileType,e}},{key:"postparse",value:function(e,t){var r=this,n=[];return e.forEach((function(e){if("placeholder"===e.type){var o=e.value;try{t.cachedParsers[e.lIndex]=r.parser(o,{tag:e})}catch(t){n.push(a({tag:o,rootError:t,offset:e.offset}))}}})),{postparsed:e,errors:n}}},{key:"recordRuns",value:function(e){e.tag==="".concat(c[this.fileType],":r")?(this.recordRun=!1,this.recordedRun=[]):e.tag==="".concat(c[this.fileType],":rPr")?("start"===e.position&&(this.recordRun=!0,this.recordedRun=[e.value]),"end"===e.position&&(this.recordedRun.push(e.value),this.recordRun=!1)):this.recordRun&&this.recordedRun.push(e.value)}},{key:"render",value:function(e,t){var r=t.scopeManager,n=t.linebreaks,o=t.nullGetter;if(n&&this.recordRuns(e),"placeholder"===e.type&&!e.module){var a;try{a=r.getValue(e.value,{part:e})}catch(e){return{errors:[e]}}return null==a&&(a=o(e)),u(a)?{errors:[l({tag:e.value,value:a,offset:e.offset})]}:("string"!=typeof a&&(a=a.toString()),n?this.renderLineBreaks(a):{value:s(a)})}}},{key:"renderLineBreaks",value:function(e){var t=c[this.fileType],r="docx"===this.fileType?"<w:r><w:br/></w:r>":"<a:br/>",n=e.split("\n"),o=this.recordedRun.join("");return{value:n.map((function(e){return s(e)})).join("</".concat(t,":t></").concat(t,":r>").concat(r,"<").concat(t,":r>").concat(o,"<").concat(t,":t").concat("docx"===this.fileType?' xml:space="preserve"':"",">"))}}}])&&n(t.prototype,r),o&&n(t,o),e}();e.exports=function(){return o(new p)}}]);
var XMLHttpRequest=function(){var _channel=java.nio.channels.AsynchronousSocketChannel.open(),_method=null,_address=null,_path=null,_headers={"User-Agent":"dyn.xhr/0.0.1"},_encoder=java.nio.charset.Charset.forName("US-ASCII").newEncoder();_encoder.reset(),this.readyState=0,this.onreadystatechange=function(){},this.open=function(method,url,async){_method=method;var uri=new java.net.URI(url),port=-1===uri.getPort()?80:uri.getPort();_address=new java.net.InetSocketAddress(uri.getHost(),port),_path=uri.getPath()},this.setRequestHeader=function(key,value){_headers[key]=value};var _buildRequest=function(data){var request=_method+" "+_path+" HTTP/1.1\r\n";_headers["Content-Length"]=data.length,_headers.Accept="*/*",_headers.Host="localhost:8080";for(var k in _headers)request+=k+": "+_headers[k]+"\r\n";return request+="\r\n"+data},_parseResponse=function(data){var resp=data.split("\r\n");that.status=resp[0].split(" ")[1]};this.status=0;var that=this;this.send=function(data){var req=_buildRequest(data),cb=java.nio.CharBuffer.wrap(req),bb=_encoder.encode(cb);_channel.connect(_address,null,new java.nio.channels.CompletionHandler({completed:function(result,attachment){that.readyState=1,_channel.write(bb,null,new java.nio.channels.CompletionHandler({completed:function(result,attachment){var bb=java.nio.ByteBuffer.allocate(4096);_channel.read(bb,null,new java.nio.channels.CompletionHandler({completed:function(result,attachment){var str=new java.lang.String(bb.array());_parseResponse(str);_channel.close(),that.readyState=4,that.onreadystatechange()}}))},failed:function(err,attachment){print(err),_channel.close()}}))},failed:function(err,attachment){print(err),_channel.close()}}))}}(function(root,factory){"function"==typeof define&&define.amd?define([root],factory):"object"==typeof exports?module.exports=factory(root):root.LE=factory(root)}(this,function(window){"use strict";function LogStream(options){var _traceCode=(Math.random()+Math.PI).toString(36).substring(2,10),_doTrace=options.trace,_pageInfo=options.page_info,_token=options.token,_print=options.print,_endpoint="js.logentries.com/v1",_shouldCall=!0,_SSL=function(){return"undefined"==typeof XDomainRequest?options.ssl:"https:"===window.location.protocol?!0:!1}(),_backlog=[],_active=!1,_sentPageInfo=!1;if(options.catchall){var oldHandler=window.onerror,newHandler=function(msg,url,line){return _rawLog({error:msg,line:line,location:url}).level("ERROR").send(),oldHandler?oldHandler(msg,url,line):!1};window.onerror=newHandler}var _agentInfo=function(){var nav=window.navigator||{doNotTrack:void 0},screen=window.screen||{},location=window.location||{};return{url:location.pathname,referrer:document.referrer,screen:{width:screen.width,height:screen.height},window:{width:window.innerWidth,height:window.innerHeight},browser:{name:nav.appName,version:nav.appVersion,cookie_enabled:nav.cookieEnabled,do_not_track:nav.doNotTrack},platform:nav.platform}},_getEvent=function(){var raw=null,args=Array.prototype.slice.call(arguments);if(0===args.length)throw new Error("No arguments!");return raw=1===args.length?args[0]:args},_rawLog=function(msg){var event=_getEvent.apply(this,arguments),data={event:event};return"never"!==_pageInfo&&(_sentPageInfo&&"per-entry"!==_pageInfo||(_sentPageInfo=!0,"undefined"==typeof event.screen&&"undefined"==typeof event.browser&&_rawLog(_agentInfo()).level("PAGE").send())),_doTrace&&(data.trace=_traceCode),{level:function(l){if(_print&&"undefined"!=typeof console&&"PAGE"!==l)try{console[l.toLowerCase()].call(console,data)}catch(ex){console.log(data)}return data.level=l,{send:function(){var cache=[],serialized=JSON.stringify(data,function(key,value){var _indexOf=function(array,obj){for(var i=0;i<array.length;i++)if(obj===array[i])return i;return-1};if("undefined"==typeof value)return"undefined";if("object"==typeof value&&null!==value){if(-1!==_indexOf(cache,value))return"<?>";cache.push(value)}return value});_active?_backlog.push(serialized):_apiCall(_token,serialized)}}}}};this.log=_rawLog;var _apiCall=function(token,data){_active=!0;var _getAjaxObject=function(){return"undefined"!=typeof XDomainRequest?new XDomainRequest:new XMLHttpRequest},request=_getAjaxObject();if(_shouldCall){request.constructor===XMLHttpRequest?request.onreadystatechange=function(){4===request.readyState&&(request.status>=400?(console.error("Couldn't submit events."),410===request.status&&console.warn("This version of le_js is no longer supported!")):(301===request.status&&console.warn("This version of le_js is deprecated! Consider upgrading."),_backlog.length>0?_apiCall(token,_backlog.shift()):_active=!1))}:request.onload=function(){_backlog.length>0?_apiCall(token,_backlog.shift()):_active=!1};var uri=(_SSL?"https://":"http://")+_endpoint+"/logs/"+_token;request.open("POST",uri,!0),request.constructor===XMLHttpRequest&&(request.setRequestHeader("X-Requested-With","XMLHttpRequest"),request.setRequestHeader("Content-type","text/json")),request.send(data)}}}function Logger(options){var logger,dict={ssl:!0,catchall:!1,trace:!0,page_info:"never",print:!1,token:null};if("object"!=typeof options)throw new Error("Invalid parameters for createLogStream()");for(var k in options)dict[k]=options[k];if(null===dict.token)throw new Error("Token not present.");logger=new LogStream(dict);var _log=function(msg){if(logger)return logger.log.apply(this,arguments);throw new Error("You must call LE.init(...) first.")};return{log:function(){_log.apply(this,arguments).level("LOG").send()},warn:function(){_log.apply(this,arguments).level("WARN").send()},error:function(){_log.apply(this,arguments).level("ERROR").send()},info:function(){_log.apply(this,arguments).level("INFO").send()}}}var loggers={},_getLogger=function(name){if(!loggers.hasOwnProperty(name))throw new Error("Invalid name for logStream");return loggers[name]},_createLogStream=function(options){if("string"!=typeof options.name)throw new Error("Name not present.");if(loggers.hasOwnProperty(options.name))throw new Error("Alrready exist this name for a logStream");return loggers[options.name]=new Logger(options),!0},_deprecatedInit=function(options){var dict={name:"default"};if("object"==typeof options)for(var k in options)dict[k]=options[k];else{if("string"!=typeof options)throw new Error("Invalid parameters for init()");dict.token=options}return _createLogStream(dict)};return{init:_deprecatedInit,createLogStream:_createLogStream,to:_getLogger,log:function(){for(var k in loggers)loggers[k].log.apply(this,arguments)},warn:function(){for(var k in loggers)loggers[k].warn.apply(this,arguments)},error:function(){for(var k in loggers)loggers[k].error.apply(this,arguments)},info:function(){for(var k in loggers)loggers[k].info.apply(this,arguments)}}}));
!function(n){function o(e){if(n.facebox.settings.inited)return!0;var o;n.facebox.settings.inited=!0,n(document).trigger("init.facebox"),(o=n.facebox.settings).loadingImage=o.loading_image||o.loadingImage,o.closeImage=o.close_image||o.closeImage,o.imageTypes=o.image_types||o.imageTypes,o.faceboxHtml=o.facebox_html||o.faceboxHtml;var c=n.facebox.settings.imageTypes.join("|");n.facebox.settings.imageTypesRegexp=new RegExp(".("+c+")$","i"),e&&n.extend(n.facebox.settings,e),n("body").append(n.facebox.settings.faceboxHtml);var a=[new Image,new Image];a[0].src=n.facebox.settings.closeImage,a[1].src=n.facebox.settings.loadingImage,n("#facebox").find(".b:first, .bl").each(function(){a.push(new Image),a.slice(-1).src=n(this).css("background-image").replace(/url\((.+)\)/,"$1")}),n("#facebox .close").click(n.facebox.close),n("#facebox .close_image").attr("src",n.facebox.settings.closeImage)}function c(e,o){if(e.match(/#/)){var c=window.location.href.split("#")[0],a=e.replace(c,"");if("#"==a)return;n.facebox.reveal(n(a).html(),o)}else e.match(n.facebox.settings.imageTypesRegexp)?t(e,o):i(e,o)}function t(e,o){var c=new Image;c.onload=function(){n.facebox.reveal('<div class="image"><img src="'+c.src+'" /></div>',o)},c.src=e}function i(e,o){n.get(e,function(e){n.facebox.reveal(e,o)})}function e(){return 0==n.facebox.settings.overlay||null===n.facebox.settings.opacity}n.facebox=function(e,o){n.facebox.loading(),e.ajax?i(e.ajax,o):e.image?t(e.image,o):e.div?c(e.div,o):n.isFunction(e)?e.call(n):n.facebox.reveal(e,o)},n.extend(n.facebox,{settings:{opacity:.2,overlay:!0,loadingImage:"/facebox/loading.gif",closeImage:"/facebox/closelabel.png",imageTypes:["png","jpg","jpeg","gif"],faceboxHtml:'    <div id="facebox" style="display:none;">       <div class="popup">         <div class="content">         </div>         <a href="#" class="close"><img src="/facebox/closelabel.png" title="close" class="close_image" /></a>       </div>     </div>'},loading:function(){if(o(),1==n("#facebox .loading").length)return!0;!function(){if(e())return;0==n("#facebox_overlay").length&&n("body").append('<div id="facebox_overlay" class="facebox_hide"></div>');n("#facebox_overlay").hide().addClass("facebox_overlayBG").css("opacity",n.facebox.settings.opacity).click(function(){n(document).trigger("close.facebox")}).fadeIn(200)}(),n("#facebox .content").empty(),n("#facebox .body").children().hide().end().append('<div class="loading"><img src="'+n.facebox.settings.loadingImage+'"/></div>'),n("#facebox").css({top:function(){var e,o;self.pageYOffset?(o=self.pageYOffset,e=self.pageXOffset):document.documentElement&&document.documentElement.scrollTop?(o=document.documentElement.scrollTop,e=document.documentElement.scrollLeft):document.body&&(o=document.body.scrollTop,e=document.body.scrollLeft);return new Array(e,o)}()[1]+function(){var e;self.innerHeight?e=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?e=document.documentElement.clientHeight:document.body&&(e=document.body.clientHeight);return e}()/10,left:n(window).width()/2-205}).show(),n(document).bind("keydown.facebox",function(e){return 27==e.keyCode&&n.facebox.close(),!0}),n(document).trigger("loading.facebox")},reveal:function(e,o){n(document).trigger("beforeReveal.facebox"),o&&n("#facebox .content").addClass(o),n("#facebox .content").append(e),n("#facebox .loading").remove(),n("#facebox .body").children().fadeIn("normal"),n("#facebox").css("left",n(window).width()/2-n("#facebox .popup").width()/2),n(document).trigger("reveal.facebox").trigger("afterReveal.facebox")},close:function(){return n(document).trigger("close.facebox"),!1}}),n.fn.facebox=function(e){if(0!=n(this).length)return o(e),this.bind("click.facebox",function(){n.facebox.loading(!0);var e=this.rel.match(/facebox\[?\.(\w+)\]?/);return e&&(e=e[1]),c(this.href,e),!1})},n(document).bind("close.facebox",function(){n(document).unbind("keydown.facebox"),n("#facebox").fadeOut(function(){n("#facebox .content").removeClass().addClass("content"),n("#facebox .loading").remove(),n(document).trigger("afterClose.facebox")}),function(){if(!e())n("#facebox_overlay").fadeOut(200,function(){n("#facebox_overlay").removeClass("facebox_overlayBG"),n("#facebox_overlay").addClass("facebox_hide"),n("#facebox_overlay").remove()})}()})}(jQuery);
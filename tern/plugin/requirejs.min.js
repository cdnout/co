!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../lib/infer"),require("../lib/tern")):"function"==typeof define&&define.amd?define(["../lib/infer","../lib/tern"],e):e(tern,tern)}(function(h,c){"use strict";function u(e){if(!/(^|\/)(\.\/|[^\/]+\/\.\.\/)/.test(e))return e;for(var r=e.split("/"),t=0;t<r.length;++t)"."!=r[t]&&r[t]?t&&".."==r[t]&&(r.splice(t-1,2),t-=2):r.splice(t--,1);return r.join("/")}function g(e){var r=new h.Obj(!0,"exports");return y(e.currentFile,e).addType(r,q),r}function m(e,r){if(r.options.override&&Object.prototype.hasOwnProperty.call(r.options.override,e)){var t=r.options.override[e];if("string"==typeof t&&"="==t.charAt(0))return h.def.parsePath(t.slice(1));if("object"==typeof t){if(i=n(e,r))return i;var o=r.interfaces[d(e)]=new h.Obj(null,d(e));return h.def.load(t,o),o}e=t}var i;return/^(https?:|\/)|\.js$/.test(e)||(e=function(e,r){var t=e.indexOf("!");-1<t&&(e=e.slice(0,t));var o=r.options,i=/\.js$/.test(e);if(i||/^(?:\w+:|\/)/.test(e))return e+(i?"":".js");var n=o.baseURL||"";if(n&&"/"!=n.charAt(n.length-1)&&(n+="/"),o.paths){if(s=o.paths[e])return u(n+s+".js");var s,a=e.match(/^([^\/]+)(\/.*)$/);if(a)if(s=o.paths[a[1]])return u(n+s+a[2]+".js")}return u(n+e+".js")}(e,r)),(i=n(e=u(e),r))||(i=y(e,r),r.server.addFile(e,null,r.currentFile)),i}function n(e,r){return r.interfaces[d(e)]}function y(e,r){var t=n(e,r);return t||((t=r.interfaces[d(e)]=new h.AVal).origin=e),t}var q=50;function d(e){return e.replace(/\.js$/,"")}var v={dirname:function(e){var r=e.lastIndexOf("/");return-1==r?"":e.slice(0,r)},relative:function(e,r){return 0==r.indexOf(e)?r.slice(e.length):r},join:function(e,r){return r&&"."!=r.charAt(0)?r:e&&r?e+"/"+r:(e||"")+(r||"")}};function s(e,r,t,o){var i,s,a,u=e.mod.requireJS,n=[];function l(e){return"require"==e?((o=u).require||(o.require=new h.Fn("require",h.ANull,[h.cx().str],["module"],new h.AVal),o.require.computeRet=function(e,r,t){return t.length&&"Literal"==t[0].type&&"string"==typeof t[0].value?m(v.join(v.dirname(o.currentFile),t[0].value),o):h.ANull}),o.require):"exports"==e?s=s||g(u):"module"==e?a||(r=u,t=s=s||g(u),i=new h.Obj(h.cx().definitions.requirejs.module,"module"),(n=i.defProp("exports")).propagate(y(r.currentFile,r)),t.propagate(n,q),a=i):m(e,u);var o,r,t,i,n}if(t&&1<r.length){var c=t[2==r.length?0:1],d=v.relative(e.projectDir,v.dirname(c.sourceFile.name));if("Literal"==c.type&&"string"==typeof c.value)c.required=l(v.join(d,c.value)),n.push(c.required);else if("ArrayExpression"==c.type)for(var p=0;p<c.elements.length;++p){var f=c.elements[p];"Literal"==f.type&&"string"==typeof f.value&&(f.required=l(v.join(d,f.value)),n.push(f.required))}}else t&&1==r.length&&/FunctionExpression/.test(t[0].type)&&t[0].params.length&&(n.push(l("require"),l("exports"),l("module")),i=r[0]);return i||(i=r[Math.min(r.length-1,2)]).isEmpty()||i.getFunctionType()||(i=null),i?(i.propagate(new h.IsCallee(h.ANull,n,null,o||h.ANull)),o&&(o.originNode=i.originNode)):o&&r[0].propagate(o),h.ANull}function l(e){switch(e.type){case"ArrayExpression":return e.elements.map(l);case"Literal":return e.value;case"ObjectExpression":var t={};return e.properties.forEach(function(e){var r=e.key.name||e.key.value;t[r]=l(e.value)}),t}}function t(e){var r=h.cx().parent.mod.requireJS.interfaces,t=e.roots["!requirejs"]=new h.Obj(null);for(var o in r){var i=t.defProp(o.replace(/\./g,"`"));r[o].propagate(i),i.origin=r[o].origin}}function o(e){var r=h.cx(),t=r.definitions[e["!name"]]["!requirejs"];e=r.parent.mod.requireJS;if(t)for(var o in t.props)t.props[o].propagate(m(o,e))}function i(e,r,t,o){if(!t||"Literal"!=t.node.type||"string"!=typeof t.node.value||!t.node.required)return o;o=Object.create(o);var i=t.node.required;return o.origin=i.origin,o.originNode=i.originNode,i.doc&&(o.doc=i.doc),i.url&&(o.url=i.url),o}function a(e,r){var t=c.resolvePos(e,r.end),o=h.findExpressionAround(e.ast,null,t,e.scope,"CallExpression");if(o){var i=o.node;if(!("Identifier"!=i.callee.type||"define"!=i.callee.name&&"require"!=i.callee.name&&"requirejs"!=i.callee.name||i.arguments.length<1||"ArrayExpression"!=i.arguments[0].type)){var n=function(e,r){for(var t=0;t<e.length;t++){var o=e[t];if("Literal"==o.type&&"string"==typeof o.value&&o.start<r&&o.end>r)return o}}(i.arguments[0].elements,t);if(n){var s=n.raw.slice(1,t-n.start),a=n.raw.charAt(0);s&&s.charAt(s.length-1)==a&&(s=s.slice(0,s.length-1));var u=function(e,r,t){var o=h.cx().parent.mod.requireJS,i=d(t),n=o.options.baseURL||"";n&&"/"!=n.charAt(n.length-1)&&(n+="/");e.caseInsensitive&&(r=r.toLowerCase());var s=[],a=o.interfaces;for(var u in a)if(u!=i&&a[u].getType()){var l=u.substring(n.length,u.length);!l||!1!==e.filter&&r&&0!==(e.caseInsensitive?l.toLowerCase():l).indexOf(r)||c.addCompletion(e,s,l,a[u])}return s}(r,s,e.name);return n.end==t+1&&e.text.charAt(t)==a&&++t,{start:c.outputPos(r,e,n.start),end:c.outputPos(r,e,t),isProperty:!1,isObjectKey:!1,completions:u.map(function(e){var r="string"==typeof e?e:e.name,t=JSON.stringify(r);return"'"==a&&(t=a+t.slice(1,t.length-1).replace(/'/g,"\\'")+a),"string"==typeof e?t:(e.displayName=r,e.name=t,e)})}}}}}h.registerFunction("requirejs_define",function(e,r,t){if(!r.length)return h.ANull;var o=h.cx().parent,i=o.mod.requireJS;return s(o,r,t,y(i.currentFile,i))}),h.registerFunction("requirejs_require",function(e,r,t){return r.length?s(h.cx().parent,r,t):h.ANull}),h.registerFunction("requirejs_config",function(e,r,t){var o=h.cx().parent,i=o&&o.mod.requireJS;if(i&&t&&t.length&&"ObjectExpression"==t[0].type){var n=l(t[0]);for(var s in n)if(n.hasOwnProperty(s)){var a=n[s];if(i.options[s]){if("paths"==s)for(var u in a)a.hasOwnProperty(u)&&!i.options.paths[u]&&(i.options.paths[u]=a[u])}else i.options[s]=a}}return h.ANull}),c.registerPlugin("requirejs",function(e,r){e.mod.requireJS={interfaces:Object.create(null),options:r||{},currentFile:null,server:e},e.on("beforeLoad",function(e){this.mod.requireJS.currentFile=e.name}),e.on("reset",function(){this.mod.requireJS.interfaces=Object.create(null),this.mod.requireJS.require=null}),e.on("preCondenseReach",t),e.on("postLoadDef",o),e.on("typeAt",i),e.on("completion",a),e.addDefs(p)});var p={"!name":"requirejs","!define":{module:{id:"string",uri:"string",config:"fn() -> ?"},config:{"!url":"http://requirejs.org/docs/api.html#config",baseUrl:{"!type":"string","!doc":"the root path to use for all module lookups","!url":"http://requirejs.org/docs/api.html#config-baseUrl"},paths:{"!type":"?","!doc":"path mappings for module names not found directly under baseUrl. The path settings are assumed to be relative to baseUrl, unless the paths setting starts with a '/' or has a URL protocol in it ('like http:').","!url":"http://requirejs.org/docs/api.html#config-paths"},shim:{"!type":"?","!doc":"Configure the dependencies, exports, and custom initialization for older, traditional 'browser globals' scripts that do not use define() to declare the dependencies and set a module value.","!url":"http://requirejs.org/docs/api.html#config-shim"},map:{"!type":"?","!doc":"For the given module prefix, instead of loading the module with the given ID, substitute a different module ID.","!url":"http://requirejs.org/docs/api.html#config-map"},config:{"!type":"?","!doc":"There is a common need to pass configuration info to a module. That configuration info is usually known as part of the application, and there needs to be a way to pass that down to a module. In RequireJS, that is done with the config option for requirejs.config(). Modules can then read that info by asking for the special dependency 'module' and calling module.config().","!url":"http://requirejs.org/docs/api.html#config-moduleconfig"},packages:{"!type":"?","!doc":"configures loading modules from CommonJS packages. See the packages topic for more information.","!url":"http://requirejs.org/docs/api.html#config-packages"},nodeIdCompat:{"!type":"?","!doc":"Node treats module ID example.js and example the same. By default these are two different IDs in RequireJS. If you end up using modules installed from npm, then you may need to set this config value to true to avoid resolution issues.","!url":"http://requirejs.org/docs/api.html#config-nodeIdCompat"},waitSeconds:{"!type":"number","!doc":"The number of seconds to wait before giving up on loading a script. Setting it to 0 disables the timeout. The default is 7 seconds.","!url":"http://requirejs.org/docs/api.html#config-waitSeconds"},context:{"!type":"number","!doc":"A name to give to a loading context. This allows require.js to load multiple versions of modules in a page, as long as each top-level require call specifies a unique context string. To use it correctly, see the Multiversion Support section.","!url":"http://requirejs.org/docs/api.html#config-context"},deps:{"!type":"?","!doc":"An array of dependencies to load. Useful when require is defined as a config object before require.js is loaded, and you want to specify dependencies to load as soon as require() is defined. Using deps is just like doing a require([]) call, but done as soon as the loader has processed the configuration. It does not block any other require() calls from starting their requests for modules, it is just a way to specify some modules to load asynchronously as part of a config block.","!url":"http://requirejs.org/docs/api.html#config-deps"},callback:{"!type":"fn()","!doc":"A function to execute after deps have been loaded. Useful when require is defined as a config object before require.js is loaded, and you want to specify a function to require after the configuration's deps array has been loaded.","!url":"http://requirejs.org/docs/api.html#config-callback"},enforceDefine:{"!type":"bool","!doc":"If set to true, an error will be thrown if a script loads that does not call define() or have a shim exports string value that can be checked. See Catching load failures in IE for more information.","!url":"http://requirejs.org/docs/api.html#config-enforceDefine"},xhtml:{"!type":"bool","!doc":"If set to true, document.createElementNS() will be used to create script elements.","!url":"http://requirejs.org/docs/api.html#config-xhtml"},urlArgs:{"!type":"string","!doc":"Extra query string arguments appended to URLs that RequireJS uses to fetch resources. Most useful to cache bust when the browser or server is not configured correctly.","!url":"http://requirejs.org/docs/api.html#config-urlArgs"},scriptType:{"!type":"string","!doc":"Specify the value for the type='' attribute used for script tags inserted into the document by RequireJS. Default is 'text/javascript'. To use Firefox's JavaScript 1.8 features, use 'text/javascript;version=1.8'.","!url":"http://requirejs.org/docs/api.html#config-scriptType"},skipDataMain:{"!type":"bool","!doc":"Introduced in RequireJS 2.1.9: If set to true, skips the data-main attribute scanning done to start module loading. Useful if RequireJS is embedded in a utility library that may interact with other RequireJS library on the page, and the embedded version should not do data-main loading.","!url":"http://requirejs.org/docs/api.html#config-skipDataMain"}},RequireJSError:{prototype:{"!proto":"Error.prototype",requireType:{"!type":"string","!doc":"A string value with a general classification, like 'timeout', 'nodefine', 'scripterror'.","!url":"http://requirejs.org/docs/api.html#errors"},requireModules:{"!type":"[string]","!doc":"An array of module names/URLs that timed out.","!url":"http://requirejs.org/docs/api.html#errors"}}}},requirejs:{"!type":"fn(deps: [string], callback: fn(), errback?: fn(err: +RequireJSError)) -> !custom:requirejs_require",onError:{"!type":"fn(err: +RequireJSError)","!doc":"To detect errors that are not caught by local errbacks, you can override requirejs.onError()","!url":"http://requirejs.org/docs/api.html#requirejsonerror"},load:{"!type":"fn(context: ?, moduleName: string, url: string)"},config:"fn(config: config) -> !custom:requirejs_config",version:"string",isBrowser:"bool"},require:"requirejs",define:{"!type":"fn(deps: [string], callback: fn()) -> !custom:requirejs_define",amd:{jQuery:"bool"}}}});
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../lib/infer"),require("../lib/tern"),require("./commonjs"),require):"function"==typeof define&&define.amd?define(["../lib/infer","../lib/tern","./commonjs"],e):e(tern,tern)}(function(l,e,n,r){"use strict";function t(e,n){var r=i(e,n);return r&&l.cx().parent.normalizeFilename(r)}var i,u,c,o,s=function(){};r?(u=r("module"),c=r("path"),o=r("fs"),i=function(e,n){var r=l.cx().parent.projectDir,t=c.resolve(r,n),i=c.dirname(t);/^\.\.?\//.test(e)&&(e=c.resolve(r,i,e));var o={id:t,paths:u._nodeModulePaths(i).concat(u.globalPaths)};try{return u._resolveFilename(e,o)}catch(e){return null}},s=function(e,r){var n=function(e){for(;;){try{return JSON.parse(o.readFileSync(c.resolve(e,"package.json")))}catch(e){}var n=c.dirname(e);if(n==e)return null;e=n}}(e);if(!n)return null;function t(e){for(var n in e)n in r||(r[n]=null)}t(n.dependencies),t(n.devDependencies),t(n.peerDependencies)}):i=function(e,n){return/^\.\.?\//.test(e)?function(e,n){if("/"==n[0])return n;var r,t=e.lastIndexOf("/");for(0<=t&&(n=e.slice(0,t+1)+n);r=/[^\/]*[^\/\.][^\/]*\/\.\.\//.exec(n);)n=n.slice(0,r.index)+n.slice(r.index+r[0].length);return n.replace(/(^|[^\.])\.\//g,"$1")}(n,e):e},e.registerPlugin("node_resolve",function(e){e.loadPlugin("commonjs"),e.mod.modules.resolvers.push(t),s(e.projectDir,e.mod.modules.knownModules)})});
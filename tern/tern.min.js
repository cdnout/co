!function(e,t){"object"==typeof exports&&"object"==typeof module?t(exports,require("./infer"),require("./signal"),require("acorn"),require("acorn-walk")):"function"==typeof define&&define.amd?define(["exports","./infer","./signal","acorn/dist/acorn","acorn-walk/dist/walk"],t):t(e.tern||(e.tern={}),tern,tern.signal,acorn,acorn.walk)}(this,function(e,O,t,j,F){"use strict";var i=Object.create(null);e.registerPlugin=function(e,t){i[e]=t};var r=e.defaultOptions={debug:!1,async:!1,getFile:function(e,t){this.async&&t(null,null)},normalizeFilename:function(e){return e},defs:[],plugins:{},fetchTimeout:1e3,dependencyBudget:2e4,reuseInstances:!0,stripCRs:!1,ecmaVersion:9,projectDir:"/",parent:null},l={completions:{takesFile:!0,run:function(o,s,e){if(null==s.end)throw k("missing .query.end field");var t=o.signalReturnFirst("completion",e,s);if(t)return t;var n=C(e,s.end),r=n,i=e.text;for(;n&&j.isIdentifierChar(i.charCodeAt(n-1));)--n;if(!1!==s.expandWordForward)for(;r<i.length&&j.isIdentifierChar(i.charCodeAt(r));)++r;var a,f,l,u,p=i.slice(n,r),c=[];s.caseInsensitive&&(p=p.toLowerCase());function d(e,t,n,r){if((!g&&!1===s.omitObjectPrototype||t!=o.cx.protos.Object||p)&&!(!1!==s.filter&&p&&0!==(s.caseInsensitive?e.toLowerCase():e).indexOf(p)||a&&a.props[e])){var i=D(s,c,e,t&&t.props[e],n);r&&i&&"string"!=typeof i&&r(i)}}var h,g,y=O.findExpressionAround(e.ast,null,n,e.scope);if(y){var v=y.node;if(!1===s.inLiteral&&"Literal"===v.type&&("string"==typeof v.value||v.regex))return{start:T(s,e,n),end:T(s,e,r),completions:[]};if("MemberExpression"==v.type&&v.object.end<n)h=y;else if(function(e,t,n){return"Literal"==e.type&&"string"==typeof e.value&&e.start==t-1&&e.end<=n+1}(v,n,r)){var m=O.parentNode(v,e.ast);"MemberExpression"==m.type&&m.property==v&&(h={node:m,state:y.state})}else if("ObjectExpression"==v.type){var x=M(v,r);x?(g=y,F=u=x.key.name||x.key.value):p||/:\s*$/.test(e.text.slice(0,n))||(g=y,F=u=!0)}}if(g)l=O.typeFromContext(e.ast,g),a=g.node.objType;else if(h)F="Literal"==(F=h.node.property).type?F.value.slice(1):F.name,h.node=h.node.object,l=O.expressionType(h);else if("."==i.charAt(n-1)){for(var b=n-1;b&&("."==i.charAt(b-1)||j.isIdentifierChar(i.charCodeAt(b-1)));)b--;var w=i.slice(b,n-1);w&&(l=O.def.parsePath(w,e.scope).getObjType(),F=p)}if(null!=F){if(o.cx.completingProperty=F,l&&O.forAllPropertiesOf(l,d),!c.length&&!1!==s.guess&&l&&l.guessProperties&&l.guessProperties(function(e,t,n){e!=F&&"âœ–"!=e&&"<i>"!=e&&d(e,t,n)}),!c.length&&2<=p.length&&!1!==s.guess)for(var F in o.cx.props)d(F,o.cx.props[F][0],0);f="memberCompletion"}else O.forAllLocalsAt(e.ast,n,e.scope,d),s.includeKeywords&&(6<=o.options.ecmaVersion?N:q).forEach(function(e){d(e,null,0,function(e){e.isKeyword=!0})}),f="variableCompletion";o.signal(f,e,n,r,d),!1!==s.sort&&c.sort(E);return o.cx.completingProperty=null,{start:T(s,e,n),end:T(s,e,r),isProperty:!!F,isObjectKey:!!u,completions:c}}},properties:{run:function(e,t){var n=t.prefix,r=[];for(var i in e.cx.props)"<i>"==i||n&&0!==i.indexOf(n)||r.push(i);!1!==t.sort&&r.sort(E);return{completions:r}}},type:{takesFile:!0,run:function(e,t,n){var r,i,o,s=L(n,t),a=$(e,t,n,s);(r=a[0])||(s=R(n,t),a=$(e,t,n,s),r=a[0]);i=a[1],o=a[2];var f={guess:O.didGuess(),type:O.toString(o,t.depth),name:r&&r.name,exprName:i,doc:o.doc,url:o.url};r&&V(t,r,f);return b(f)}},documentation:{takesFile:!0,run:function(e,t,n){var r=L(n,t),i=G(e,t,n,r),o=i.getType();o||(r=R(n,t),i=G(e,t,n,r),o=i.getType());var s={url:i.url,doc:B(t,i.doc),type:O.toString(i)};o&&V(t,o,s);return b(s)}},definition:{takesFile:!0,run:function(e,t,n){var r=L(n,t),i=G(e,t,n,r);if(O.didGuess())return{};var o=K(i),s={url:i.url,doc:B(t,i.doc),origin:i.origin};if(i.types)for(var a=i.types.length-1;0<=a;--a){var f=i.types[a];V(t,f,s),o=o||K(f)}if(o&&o.node){var l=o.node.sourceFile||e.fileMap[o.origin],u=T(t,l,o.node.start),p=T(t,l,o.node.end);s.start=u,s.end=p,s.file=o.origin;var c=Math.max(0,o.node.start-50);s.contextOffset=o.node.start-c,s.context=l.text.slice(c,c+50)}else o&&(s.file=o.origin,Z(e,t,o,s));return b(s)}},refs:{takesFile:!0,fullFile:!0,run:function(e,t,n){var r=S(n,t,!0);{if(r&&"Identifier"==r.node.type)return H(e,t,n,r);if(r&&"MemberExpression"==r.node.type&&!r.node.computed){var i=r.node.property;return r.node=r.node.object,Q(e,t,n,r,i)}if(r&&"ObjectExpression"==r.node.type)for(var o=C(n,t.end),s=0;s<r.node.properties.length;++s){var a=r.node.properties[s].key;if(a.start<=o&&a.end>=o)return Q(e,t,n,r,a)}else if(r&&"MethodDefinition"==r.node.type){i=r.node.key;return Q(e,t,n,r,i)}}throw k("Not at a variable or property name.")}},rename:{takesFile:!0,fullFile:!0,run:function(e,t,n){if("string"!=typeof t.newName)throw k(".query.newName should be a string");var r=S(n,t);if(!r||"Identifier"!=r.node.type)throw k("Not at a variable.");var i=H(e,t,n,r,t.newName),o=i.refs;delete i.refs,i.files=e.files.map(function(e){return e.name});for(var s=i.changes=[],a=0;a<o.length;++a){var f=o[a];f.isShorthand?f.text=r.node.name+": "+t.newName:f.text=t.newName,s.push(f)}return i}},files:{run:function(e){return{files:e.files.map(function(e){return e.name})}}}};function s(e,t){this.name=e,this.parent=t,this.scope=this.text=this.ast=this.lineOffsets=null}function A(e,t){var n={directSourceFile:t,allowReturnOutsideFunction:!0,allowImportExportEverywhere:!0,ecmaVersion:e.options.ecmaVersion,allowHashBang:!0},r=e.signalReturnFirst("preParse",t.text,n)||t.text,i=O.parse(r,n);return e.signal("postParse",i,r),i}e.defineQueryType=function(e,t){l[e]=t},s.prototype.asLineChar=function(e){return x(this,e)};var o=/[\uD800-\uDBFF]/g;function a(e,t,n){e.text=n.options.stripCRs?t.replace(/\r\n/g,"\n"):t,e.hasAstral=o.test(e.text),O.withContext(n.cx,function(){e.ast=A(n,e)}),e.lineOffsets=null}function u(e,t){return O.withContext(e.cx,function(){t.scope=e.cx.topScope,e.signal("beforeLoad",t),O.analyze(t.ast,t.name,t.scope),e.signal("afterLoad",t)}),t}function p(n,e,t,r){var i=n.findFile(e);if(i)return null!=r&&(i.scope&&(n.needsPurge.push(e),O.clearScopes(i.ast),i.scope=null),a(i,r,n)),void(h(n,i.parent)>h(n,t)&&(i.parent=t,i.excluded&&(i.excluded=null)));var o=new s(e,t);n.files.push(o),n.fileMap[e]=o,null!=r?a(o,r,n):n.options.async?(n.startAsyncAction(),n.options.getFile(e,function(e,t){a(o,t||"",n),n.finishAsyncAction(e)})):a(o,n.options.getFile(e)||"",n)}function c(e,t,n){var r=function(){e.off("everythingFetched",r),clearTimeout(i),d(e,t,n)};e.on("everythingFetched",r);var i=setTimeout(r,e.options.fetchTimeout)}function d(n,e,t){if(n.pending)return c(n,e,t);var r=n.fetchError;if(r)return n.fetchError=null,t(r);0<n.needsPurge.length&&O.withContext(n.cx,function(){O.purge(n.needsPurge),n.needsPurge.length=0});for(var i=!0,o=0;o<n.files.length;){for(var s=[];o<n.files.length;++o){null==(f=n.files[o]).text?i=!1:null!=f.scope||f.excluded||s.push(f)}s.sort(function(e,t){return h(n,e.parent)-h(n,t.parent)});for(var a=0;a<s.length;a++){var f;if((f=s[a]).parent&&!g(n,f))f.excluded=!0;else if(e){var l=+new Date;try{O.withTimeout(e[0],function(){u(n,f)})}catch(r){if(r instanceof O.TimedOut)return t(r);throw r}e[0]-=new Date-l}else u(n,f)}}i?t():c(n,e,t)}function P(e){for(var t=0;e;++t,e=e.prev);return t}function k(e){var t=new Error(e);return t.name="TernError",t}function h(e,t){for(var n=0;t;)t=e.fileMap[t].parent,++n;return n}function g(e,t){var n,r,i=function(e,t){for(;;){var n=e.fileMap[t.parent];if(!n.parent)break;t=n}return t.name}(e,t),o=(n=t.ast,r=0,F.simple(n,{Expression:function(){++r}}),r),s=e.budgets[i];return null==s&&(s=e.budgets[i]=e.options.dependencyBudget),!(s<o)&&(e.budgets[i]=s-o,1)}function f(e){return"number"==typeof e||"object"==typeof e&&"number"==typeof e.line&&"number"==typeof e.ch}(e.Server=function(e){for(var t in this.cx=null,this.options=e||{},r)e.hasOwnProperty(t)||(e[t]=r[t]);for(var n in this.projectDir=e.projectDir.replace(/\\/g,"/"),/\/$/.test(this.projectDir)||(this.projectDir+="/"),this.parent=e.parent,this.handlers=Object.create(null),this.files=[],this.fileMap=Object.create(null),this.needsPurge=[],this.budgets=Object.create(null),this.uses=0,this.pending=0,this.asyncError=null,this.mod={},this.defs=e.defs.slice(0),this.plugins=Object.create(null),e.plugins)e.plugins.hasOwnProperty(n)&&this.loadPlugin(n,e.plugins[n]);this.reset()}).prototype=t.mixin({addFile:function(e,t,n){!n||n in this.fileMap||(n=null),e in this.fileMap||(e=this.normalizeFilename(e)),p(this,e,n,t)},delFile:function(e){var t=this.findFile(e);if(t){this.needsPurge.push(t.name);for(var n=0;n<this.files.length;n++)this.files[n]==t?this.files.splice(n--,1):this.files[n].parent==e&&(this.files[n].parent=null);delete this.fileMap[t.name]}},reset:function(){this.signal("reset"),this.cx=new O.Context(this.defs,this),this.uses=0,this.budgets=Object.create(null);for(var e=0;e<this.files.length;++e){var t=this.files[e];t.scope&&(O.clearScopes(t.ast),t.scope=null)}this.signal("postReset")},request:function(e,n){var t=function(e){if(e.query){if("string"!=typeof e.query.type)return".query.type must be a string";if(e.query.start&&!f(e.query.start))return".query.start must be a position";if(e.query.end&&!f(e.query.end))return".query.end must be a position"}if(e.files){if(!Array.isArray(e.files))return"Files property must be an array";for(var t=0;t<e.files.length;++t){var n=e.files[t];if("object"!=typeof n)return".files[n] must be objects";if("string"!=typeof n.name)return".files[n].name must be a string";if("delete"!=n.type){if("string"!=typeof n.text)return".files[n].text must be a string";if("part"==n.type){if(!f(n.offset)&&"number"!=typeof n.offsetLines)return".files[n].offset must be a position"}else if("full"!=n.type)return'.files[n].type must be "full" or "part"'}}}}(e);if(t)return n(t);var r=this;!function(r,e,i){if(e.query&&!l.hasOwnProperty(e.query.type))return i("No query type '"+e.query.type+"' defined");var o=e.query;o||i(null,{});var t=e.files||[];t.length&&++r.uses;for(var n=0;n<t.length;++n){var s=t[n];s.name=r.normalizeFilename(s.name),"delete"==s.type?r.delFile(s.name):p(r,s.name,null,"full"==s.type?s.text:null)}var a="number"==typeof e.timeout?[e.timeout]:null;if(!o)return d(r,a,function(){});var f=l[o.type];if(f.takesFile){if("string"!=typeof o.file)return i(".query.file must be a string");/^#/.test(o.file)||p(r,o.file,null)}d(r,a,function(e){if(e)return i(e);var n=f.takesFile&&function(h,e,t){var n=t.match(/^#(\d+)$/);if(!n)return h.findFile(t);var g=e[n[1]];if(!g||"delete"==g.type)throw k("Reference to unknown file "+t);if("full"==g.type)return h.fileMap[g.name];var y,v,m=g.backing=h.fileMap[g.name],r=C(m,null==g.offsetLines?g.offset:{line:g.offsetLines,ch:0},!0),x=function(e){var t=e.indexOf("\n");return t<0?e:e.slice(0,t)}(g.text),b=function(e,t,n){var r=Math.max(0,n-500),i=null;if(!/^\s*$/.test(e))for(;;){var o=t.indexOf(e,r);if(o<0||n+500<o)break;(null==i||Math.abs(i-n)>Math.abs(o-n))&&(i=o),r=o+e.length}return i}(x,m.text,r),w=null==b?Math.max(0,m.text.lastIndexOf("\n",r)):b;return O.withContext(h.cx,function(){O.purge(g.name,w,w+g.text.length);var e,t=g.text;if(e=t.match(/(?:"([^"]*)"|([\w$]+))\s*:\s*function\b/)){var n=F.findNodeAround(g.backing.ast,w,"ObjectExpression");n&&n.node.objType&&(y={type:n.node.objType,prop:e[2]||e[1]})}if(b&&(e=x.match(/^(.*?)\bfunction\b/))){for(var r=e[1].length,i="",o=0;o<r;++o)i+=" ";g.text=i+t.slice(r),v=!0}var s=O.scopeAt(m.ast,w,m.scope),a=O.scopeAt(m.ast,w+t.length,m.scope),f=g.scope=P(s)<P(a)?a:s;g.ast=A(h,g),O.analyze(g.ast,g.name,f);e:if(y||v){var l=O.scopeAt(g.ast,x.length,s);if(!l.fnType)break e;if(y)y.type.getProp(y.prop).addType(l.fnType);else if(v){var u=O.scopeAt(m.ast,w+x.length,m.scope);if(u==s||!u.fnType)break e;var p=u.fnType,c=l.fnType;if(!c||c.name!=p.name&&p.name)break e;o=0;for(var d=Math.min(p.args.length,c.args.length);o<d;++o)p.args[o].propagate(c.args[o]);p.self.propagate(c.self),c.retval.propagate(p.retval)}}}),g}(r,t,o.file);if(f.fullFile&&"part"==n.type)return i("Can't run a "+o.type+" query on a file fragment");O.resetGuessing(),O.withContext(r.cx,function(){function e(){t=f.run(r,o,n)}var t;try{a?O.withTimeout(a[0],e):e()}catch(e){return r.options.debug&&"TernError"!=e.name&&console.error(e.stack),i(e)}i(null,t)})})}(this,e,function(e,t){n(e,t),40<r.uses&&(r.reset(),d(r,null,function(){}))})},findFile:function(e){return this.fileMap[this.normalizeFilename(e)]},flush:function(t){var n=this.cx;d(this,null,function(e){if(e)return t(e);O.withContext(n,t)})},startAsyncAction:function(){++this.pending},finishAsyncAction:function(e){e&&(this.asyncError=e),0==--this.pending&&this.signal("everythingFetched")},addDefs:function(e,t){t?this.defs.unshift(e):this.defs.push(e),this.cx&&this.reset()},deleteDefs:function(e){for(var t=0;t<this.defs.length;t++)if(this.defs[t]["!name"]==e)return this.defs.splice(t,1),void(this.cx&&this.reset())},loadPlugin:function(e,t){if(1==arguments.length&&(t=this.options.plugins[e]||!0),!(e in this.plugins)&&e in i&&t){this.plugins[e]=!0;var n=i[e](this,t);if(n&&(n.defs&&this.addDefs(n.defs,n.loadFirst),n.passes))for(var r in n.passes)n.passes.hasOwnProperty(r)&&this.on(r,n.passes[r])}},normalizeFilename:function(e){var t=this.options.normalizeFilename(e).replace(/\\/g,"/");return 0==t.indexOf(this.projectDir)&&(t=t.slice(this.projectDir.length)),t}});var y=25;function v(e,t,n){var r,i=t+n;if(e.hasAstral)for(o.lastIndex=t;(r=o.exec(e.text))&&r.index<i;)i++;return i}var C=e.resolvePos=function(e,t,n){if("number"!=typeof t){var r=function(e,t){var n=e.text,r=e.lineOffsets||(e.lineOffsets=[0]),i=0,o=0,s=Math.min(Math.floor(t/y),r.length-1);for(i=r[s],o=s*y;o<t;){if(++o,0===(i=n.indexOf("\n",i)+1))return null;o%y==0&&r.push(i)}return i}(e,t.line);if(null==r){if(!n)throw k("File doesn't contain a line "+t.line);t=e.text.length}else t=v(e,r,t.ch)}else t=v(e,0,t);if(t>e.text.length){if(!n)throw k("Position "+t+" is outside of file.");t=e.text.length}return t};function m(e,t,n){var r,i=n-t;if(e.hasAstral)for(o.lastIndex=t;(r=o.exec(e.text))&&r.index<n;)i--;return i}function x(e,t){if(!e)return{line:0,ch:0};for(var n,r,i=e.lineOffsets||(e.lineOffsets=[0]),o=e.text,s=i.length-1;0<=s;--s)i[s]<=t&&(n=s*y,r=i[s]);for(;;){var a=o.indexOf("\n",r);if(t<=a||a<0)break;r=a+1,++n}return{line:n,ch:m(e,r,t)}}var T=e.outputPos=function(e,t,n){if(e.lineCharPositions){var r=x(t,n);return"part"==t.type&&(r.line+=null!=t.offsetLines?t.offsetLines:x(t.backing,t.offset).line),r}return m(t,0,n)+("part"==t.type?t.offset:0)};function b(e){for(var t in e)null==e[t]&&delete e[t];return e}function w(e,t,n){null!=n&&(e[t]=n)}function E(e,t){"string"!=typeof e&&(e=e.name,t=t.name);var n=/^[A-Z]/.test(e);return n==/^[A-Z]/.test(t)?e<t?-1:e==t?0:1:n?1:-1}function M(e,t){for(var n=0;n<e.properties.length;n++){var r=e.properties[n];if(r.key&&r.key.start<=t&&r.key.end>=t)return r}}var q="break do instanceof typeof case else new var catch finally return void continue for switch while debugger function this with default if throw delete in try".split(" "),N=q.concat("export class extends const super yield import let static".split(" ")),D=e.addCompletion=function(e,t,n,r,i){for(var o=e.types||e.docs||e.urls||e.origins,s=o||e.depths,a=0;a<t.length;++a){var f=t[a];if((s?f.name:f)==n)return}var l=s?{name:n}:n;if(t.push(l),r&&o){O.resetGuessing();var u=r.getType();l.guess=O.didGuess(),e.types&&(l.type=O.toString(r)),e.docs&&w(l,"doc",B(e,r.doc||u&&u.doc)),e.urls&&w(l,"url",r.url||u&&u.url),e.origins&&w(l,"origin",r.origin||u&&u.origin)}return e.depths&&(l.depth=i||0),l};function I(e,t){var n,r,i=e.body;return i&&(r=Array.isArray(i)?(n=i[0].start,i[i.length-1].end):(n=i.start,i.end),n<=t&&t<=r)}var L=e.findQueryExpr=function(e,t,n){if(null==t.end)throw k("missing .query.end field");if(t.variable){var r=O.scopeAt(e.ast,C(e,t.end),e.scope);return{node:{type:"Identifier",name:t.variable,start:t.end,end:t.end+1},state:r}}var i=t.start&&C(e,t.start),o=C(e,t.end),s=O.findExpressionAt(e.ast,i,o,e.scope);if(!s){var a=O.findClosestExpression(e.ast,i,o,e.scope);a&&!I(a.node,o)&&(n||(null==i?o:i)-a.node.start<20||a.node.end-o<20)&&(s=a)}if(!s){var f=O.findExpressionAround(e.ast,i,o,e.scope);f&&!I(f.node,o)&&("ObjectExpression"==f.node.type||n||(null==i?o:i)-f.node.start<20||f.node.end-o<20)&&(s=f)}return s};function R(e,t,n){var r=t.start&&C(e,t.start),i=C(e,t.end),o=null,s=O.findExpressionAround(e.ast,r,i,e.scope);return s&&!I(s.node,i)&&("ObjectExpression"==s.node.type||n||(null==r?i:r)-s.node.start<20||s.node.end-i<20)&&(o=s),o}function S(e,t,n){var r=L(e,t,n);if(r)return r;throw k("No expression at the given position.")}function z(e){return(e=e&&e.getType())&&e instanceof O.Obj?e:null}function G(e,t,n,r){var i;r&&(O.resetGuessing(),i=O.expressionType(r));var o,s=e.hasHandler("typeAt");if(s)for(var a=C(n,t.end),f=0;f<s.length;f++)i=s[f](n,a,r,i);if(!i)throw k("No type found at the given position.");if("ObjectExpression"==r.node.type&&null!=t.end&&(o=M(r.node,C(n,t.end)))){var l=o.key.name,u=z(O.typeFromContext(n.ast,r));if(u&&u.hasProp(l))i=u.hasProp(l);else{var p=z(i);p&&p.hasProp(l)&&(i=p.hasProp(l))}}return i}function $(e,t,n,r){var i,o=G(e,t,n,r),s=o;if(o=t.preferFunction&&o.getFunctionType()||o.getType(),r&&("Identifier"==r.node.type?i=r.node.name:"MemberExpression"!=r.node.type||r.node.computed?"MethodDefinition"!=r.node.type||r.node.computed||(i=r.node.key.name):i=r.node.property.name),null!=t.depth&&"number"!=typeof t.depth)throw k(".query.depth must be a number");return[o,i,s]}function B(e,t){if(!t)return null;if("full"==e.docFormat)return t;var n=/.\n[\s@\n]/.exec(t);if(n&&(t=t.slice(0,n.index+1)),(t=t.replace(/\n\s*/g," ")).length<100)return t;var r=/[\.!?] [A-Z]/g;r.lastIndex=80;var i=r.exec(t);return i&&(t=t.slice(0,i.index+1)),t}function V(e,t,n){n.url||(n.url=t.url),n.doc||(n.doc=B(e,t.doc)),n.origin||(n.origin=t.origin);var r,i=O.cx().protos;!n.url&&!n.doc&&t.proto&&(r=t.proto.hasCtor)&&t.proto!=i.Object&&t.proto!=i.Function&&t.proto!=i.Array&&(n.url=r.url,n.doc=B(e,r.doc))}var K=e.getSpan=function(e){if(e.origin){if(e.originNode){var t=e.originNode;return/^Function/.test(t.type)&&t.id&&(t=t.id),{origin:e.origin,node:t}}return e.span?{origin:e.origin,span:e.span}:void 0}},Z=e.storeSpan=function(e,t,n,r){if(r.origin=n.origin,n.span){var i=/^(\d+)\[(\d+):(\d+)\]-(\d+)\[(\d+):(\d+)\]$/.exec(n.span);r.start=t.lineCharPositions?{line:Number(i[2]),ch:Number(i[3])}:Number(i[1]),r.end=t.lineCharPositions?{line:Number(i[5]),ch:Number(i[6])}:Number(i[4])}else{var o=e.fileMap[n.origin];r.start=T(t,o,n.node.start),r.end=T(t,o,n.node.end)}};function H(e,f,t,n,l){for(var u=n.node.name,p=n.state;p&&!(u in p.props);p=p.prev);if(!p)throw k("Could not find a definition for "+u);var r,c=[];function i(a){return function(e,t,n){var r={file:a.name,start:T(f,a,e.start),end:T(f,a,e.end)};if(l){for(var i=t;i!=p;i=i.prev){var o=i.hasProp(l);if(o)throw k("Renaming `"+u+"` to `"+l+"` would make a variable at line "+(x(a,e.start).line+1)+" point to the definition at line "+(x(a,o.name.start).line+1))}var s=n[n.length-2];s&&"Property"==s.type&&s.key==s.value&&(r.isShorthand=!0)}c.push(r)}}if(p.originNode){if(r="local",l){for(var o=p.prev;o&&!(l in o.props);o=o.prev);o&&O.findRefs(p.originNode,p,l,o,function(e){throw k("Renaming `"+u+"` to `"+l+"` would shadow the definition used at line "+(x(t,e.start).line+1))})}O.findRefs(p.originNode,p,u,p,i(t))}else if(r="global",f.onlySourceFile)O.findRefs(t.ast,t.scope,u,p,i(t));else for(var s=0;s<e.files.length;++s){var a=e.files[s];O.findRefs(a.ast,a.scope,u,p,i(a))}return{refs:c,type:r,name:u}}function Q(e,n,t,r,i){var o=O.expressionType(r);"MethodDefinition"==r.node.type&&(o=o.propertyOf);var s=o.getObjType();if(!s)throw k("Couldn't determine type of base object.");var a=[];function f(t){return function(e){a.push({file:t.name,start:T(n,t,e.start),end:T(n,t,e.end)})}}if(n.onlySourceFile)O.findPropRefs(t.ast,t.scope,s,i.name,f(t));else for(var l=0;l<e.files.length;++l){var u=e.files[l];O.findPropRefs(u.ast,u.scope,s,i.name,f(u))}return{refs:a,name:i.name}}e.version="0.24.3"});